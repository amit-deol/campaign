<package author="Administrator (admin)" buildDate="2017-01-20 02:39:28.759Z" buildNumber="8705" buildVersion="6.1" img="xtk:installedPackage.png" label="data backup" name="localData" namespace="ami" vendor="">
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" library="true" name="serverOptions" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration name="mechanism">
        <value label="Plain text password" name="plain" value="plain"/>
        <value label="Encrypted password (md5)" name="md5" value="md5"/>
        <value label="Plain text password (TLS/SSL)" name="lds" value="tls"/>
        <value label="NTLM (Windows NT LAN Manager)" name="ntlm" value="ntlm"/>
        <value label="DPA (Distributed Password Authentication)" name="dpa" value="dpa"/>
      </enumeration>
      <enumeration name="scope">
        <value label="Limited to the base" name="base" value="base"/>
        <value label="Limited to the first sublevel of the base" name="onelevel" value="onelevel"/>
        <value label="Recursive" name="subtree" value="subtree"/>
      </enumeration>
      <enumeration default="none" name="frontalServersMode">
        <value label="Local" name="none" value="none"/>
        <value label="Tracking server(s)" name="tracking" value="tracking"/>
        <value label="Other Adobe Campaign server(s)" name="other" value="other"/>
      </enumeration>
      <element name="serverOptions">
        <compute-string expr="$(instanceName)"/>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <element name="baseOption">
          <element desc="Authentication using an LDAP directory" label="LDAP authentication" name="ldap">
            <attribute default="0" desc="LDAP authentication activation state" label="Enabled" name="active" sqlname="XtkLdap_Active" type="boolean"/>
            <attribute desc="DNS alias (and optional port) of the directory server" label="LDAP server" name="server" sqlname="XtkLdap_Server" type="string"/>
            <attribute desc="Unique identifier (Distinguished Name)" label="Distinguished Name (DN)" name="dn" sqlname="XtkLdap_DN" type="string"/>
            <attribute default="0" label="Automatic creation of operators" name="autoOperator" sqlname="XtkLdap_AutoOperator" type="boolean"/>
            <attribute default="'md5'" desc="Mechanism to use to authenticate on the LDAP server" enum="mechanism" label="Authentication method" name="mechanism" sqlname="XtkLdap_Mechanism" type="string"/>
            <attribute default="0" desc="Search of the identifier in the LDAP directory activated" label="Search for the identifier (DN)" name="dnSearch" sqlname="XtkLdap_DNSearch" type="boolean"/>
            <attribute desc="Unique identifier of the base used for searches" label="Base identifier" name="dnBase" sqlname="XtkLdap_DNSearchBase" type="string"/>
            <attribute default="'subtree'" desc="Scope of the searches in the directory (Base, One level, Recursive)" enum="scope" label="Search scope" name="dnScope" sqlname="XtkLdap_DNSearchScope" type="string"/>
            <attribute desc="Search filter in the LDAP directory, using the $(login) variable" label="Filter" name="dnFilter" sqlname="XtkLdap_DNSearchFilter" type="string"/>
            <attribute desc="Identifier used by the application when performing authentication against the server for searches" label="Application level DN used for the search" name="appDN" sqlname="XtkLdap_AppLogin" type="string"/>
            <attribute desc="Password of the application level identifier used for searches" label="Password of the application login" name="appPwd" sqlname="XtkLdap_AppPassword" type="string"/>
            <attribute desc="Load the list of user rights from the LDAP directory" label="Load user rights" name="rights" sqlname="XtkLdap_Rights" type="boolean"/>
            <attribute desc="Unique identifier of the base used for searches" label="Base identifier" name="rightBase" sqlname="XtkLdap_RightsBase" type="string"/>
            <attribute default="'subtree'" desc="Scope of the searches in the directory (Base, One level, Recursive)" enum="scope" label="Search scope" name="rightScope" sqlname="XtkLdap_RightsScope" type="string"/>
            <attribute desc="Search filter in the LDAP directory, using the $(login) variable" label="Rights search filter" name="rightFilter" sqlname="XtkLdap_RightsFilter" type="string"/>
            <attribute desc="Attribute describing the named right associated to the user" label="Attribute containing the right name" name="rightName" sqlname="XtkLdap_RightsAttr" type="string"/>
            <attribute desc="Regular expression used to extract the name of the Adobe Campaign right corresponding to the LDAP group name" label="Association mask" name="rightMask" sqlname="XtkLdap_RightsMask" type="string"/>
          </element>
          <element label="Public resources" name="fileRes">
            <attribute desc="Start of the new publish resource file URL" label="New URL for public resource files" name="publicURL" sqlname="XtkFileRes_Public_URL" type="string"/>
          </element>
          <element label="Configuration of frontal servers for web applications" name="webFormServersOptions">
            <attribute default="'none'" desc="Option that lets you specify the invalidation mode of web forms: local by default, uses tracking servers if the option is 'tracking' and uses a personalized list with the 'other server(s)' option." enum="frontalServersMode" label="Publication mode" name="publishing" sqlname="XtkWebForm_ServersMode" type="string"/>
            <attribute desc="Personalized address list of servers to be contacted for web form invalidation (Other 'server(s) mode')." label="Internal URLs of the frontal servers" name="internalURLs" sqlname="XtkWebForm_ServersURLs" type="string"/>
            <attribute desc="Name of the instance to be used for web form invalidation in 'other server(s)' mode" label="Instance name" name="instance" sqlname="XtkWebForm_Instance" type="string"/>
            <attribute desc="Password of the instance defined for web form invalidation in 'other server(s)' mode" edit="PasswordEdit" label="Password" name="password" sqlname="XtkWebForm_Password" type="string"/>
          </element>
          <element label="Instance configuration for package production" name="packageServersOptions">
            <attribute desc="Prefix added to internal names generated automatically" label="Prefix of instance objects" name="instancePrefix" sqlname="XtkInstancePrefix" type="string"/>
          </element>
        </element>
        <element name="serverConf" ref="xtk:serverConf:serverConf"/>
      </element>
      <methods>
        <method name="LoadOptions" static="true">
          <parameters>
            <param desc="Select XPaths of options to load" name="select" type="DOMElement"/>
            <param desc="Update options document" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="SaveOptions" static="true">
          <parameters>
            <param desc="Content to update" name="diff" type="DOMElement"/>
          </parameters>
        </method>
        <method name="AddInstance" static="true">
          <parameters>
            <param desc="Name of the instance to create" name="instanceName" type="string"/>
            <param desc="DNS masks associated with the instance" name="hosts" type="string"/>
            <param desc="Instance language" name="lang" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Sessions to the application server" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Sessions to the application server" labelSingular="Session" library="true" mappingType="xmlFile" name="session" namespace="xtk" xtkschema="xtk:srcSchema">
      <interface async="true" label="Persistence" name="persist">
        <method name="NewInstance"></method>
        <method name="Duplicate">
          <parameters>
            <param desc="Primary key of the source document" name="pk" type="primarykey"/>
          </parameters>
        </method>
        <method name="DuplicateWithMappingId">
          <parameters>
            <param desc="Primary key of the source document" name="pk" type="primarykey"/>
            <param desc="ID mapping" inout="out" name="mapping" type="DOMElement"/>
          </parameters>
        </method>
        <method name="DuplicateTo">
          <parameters>
            <param desc="Primary key of the source document" name="pk" type="primarykey"/>
            <param desc="Primary key of the destination folder" name="folder" type="primarykey"/>
          </parameters>
        </method>
        <method name="ApplyDuplicateRules"></method>
        <method name="SetDefaults"></method>
        <method name="SetDefaultValues">
          <parameters>
            <param desc="XPath" name="xpath" type="string"/>
          </parameters>
        </method>
        <method name="Load">
          <parameters>
            <param desc="Primary key" name="pk" type="primarykey"/>
          </parameters>
        </method>
        <method name="LoadIfExists">
          <parameters>
            <param desc="Primary key" name="pk" type="primarykey"/>
            <param desc="Shows if entity exists" inout="out" name="Exists" type="boolean"/>
          </parameters>
        </method>
        <method name="LoadAsText" static="true">
          <parameters>
            <param desc="Primary key" name="pk" type="primarykey"/>
            <param desc="Entity content" inout="out" name="Content" type="string"/>
          </parameters>
        </method>
        <method hidden="true" name="Store"></method>
        <method name="Remove" pkonly="true"></method>
        <method const="true" name="GetPkList" pkonly="true">
          <parameters>
            <param desc="Primary keys" inout="out" name="pkList" type="primarykeylist"/>
          </parameters>
        </method>
        <method name="Write" static="true">
          <parameters>
            <param desc="Document of difference" name="doc" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="WriteCollection" static="true">
          <parameters>
            <param desc="Document of differences gathering" name="doc" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="DeleteCollection" static="true">
          <parameters>
            <param desc="Entity schema" name="schema" type="string"/>
            <param desc="Delete condition" name="where" type="DOMElement"/>
            <param desc="Ignore deleteStatus" name="ignoreDeleteStatus" type="boolean"/>
          </parameters>
        </method>
        <method name="ImportCollection" static="true">
          <parameters>
            <param desc="Data document" name="doc" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetImages" static="true">
          <parameters>
            <param desc="Primary keys" name="pkList" type="string"/>
            <param desc="Result" inout="out" name="doc" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetEntityIfMoreRecent" static="true">
          <parameters>
            <param desc="Primary key" name="pk" type="string"/>
            <param desc="MD5 key" name="md5" type="string"/>
            <param desc="Result" inout="out" name="doc" type="DOMDocument"/>
            <param name="mustExist" type="boolean"/>
          </parameters>
        </method>
        <method name="GetDirtyCacheEntities" static="true">
          <parameters>
            <param desc="List of cached entities" name="cacheEntities" type="DOMDocument"/>
            <param desc="List of dirty entities" inout="out" name="dirtyEntities" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetActiveApplicationMenus" static="true">
          <parameters>
            <param desc="Result" inout="out" name="doc" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetDefaultEntity" static="true">
          <parameters>
            <param desc="Entity schema" name="schema" type="string"/>
            <param desc="Result" inout="out" name="doc" type="DOMDocument"/>
          </parameters>
        </method>
      </interface>
      <element desc="Information on server version" label="Version" name="serverInfo">
        <attribute desc="Major version number" label="Major number" name="majNumber" type="short"/>
        <attribute desc="Minor version number" label="Minor number" name="minNumber" type="short"/>
        <attribute label="Service pack number" name="servicePack" type="short"/>
        <attribute desc="Technical minor version number" label="Technical minor version" name="minNumberTechnical" type="short"/>
        <attribute label="Build number" name="buildNumber" type="short"/>
        <attribute desc="Minimum client build number to be compatible with the connected server" label="Minimum client build number" name="minClientBuildNumber" type="short"/>
        <attribute desc="Recommended client build number to be compatible with the connected server" label="Recommended client build number" name="advisedClientBuildNumber" type="short"/>
        <attribute desc="Default namespace used when creating a new entity" label="Default namespace" name="defaultNameSpace" type="string"/>
        <attribute desc="GMT time of server" label="Server date" name="serverDate" type="datetime"/>
        <attribute desc="Identifier of database" label="Database identifier" name="databaseId" type="string"/>
        <attribute desc="Wizard to launch when connecting" label="Wizard to launch" name="wizardToLaunch" type="string"/>
        <attribute label="Instance name" name="instanceName" type="string"/>
        <attribute label="Duration before sessions expire." name="sessionTimeOut" type="timespan"/>
        <attribute label="Security token validity period" name="securityTimeOut" type="timespan"/>
        <attribute label="SQLDATA authorized" name="allowSQL" type="boolean"/>
      </element>
      <element desc="Information on current session" label="Parameters" name="userInfo">
        <attribute desc="Identifier of session login" label="Id" name="loginId" type="long"/>
        <attribute desc="Compute string of session login" label="Compute string" name="loginCS" type="string"/>
        <attribute desc="Name (login) of the operator connected" label="Name (login)" name="login" type="string"/>
        <attribute desc="Regional parameters used" label="Regional parameters" name="locale" type="string"/>
        <attribute label="Regional settings of the instance" name="instanceLocale" type="string"/>
        <attribute desc="Session login time zone" label="Time zone" name="timezone" type="string"/>
        <attribute label="Save entities in the database" name="datakitInDatabase" type="boolean"/>
        <attribute desc="Graphical appearance (skin, or theme)" label="Theme" name="theme" type="string"/>
        <attribute desc="Access from the client console denied" label="No access using from rich client" name="noConsoleCnx" type="boolean"/>
        <attribute desc="Filter based on folder" label="User root folder" name="homeDir" type="string"/>
        <attribute desc="Identifier of the organizational entity" label="Id" name="orgUnitId" type="long"/>
        <element name="login-group" unbound="true">
          <attribute desc="Identifier of group associated to login" label="Recipient group Id" name="id" type="string"/>
        </element>
        <element name="login-right" unbound="true">
          <attribute desc="Name of the named right associated with login" label="Right" name="right" type="string"/>
        </element>
        <element name="installed-package" unbound="true">
          <attribute desc="Name of the installed package" label="Name" name="name" type="string"/>
          <attribute desc="Namespace of the installed package" label="Namespace" name="namespace" type="string"/>
        </element>
      </element>
      <element name="session">
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <attribute desc="User account" label="Account" name="login" type="string"/>
        <attribute desc="Connection settings" label="Parameters" name="parameters" type="string"/>
        <element name="info">
          <element name="serverInfo" ref="serverInfo"/>
          <element name="userInfo" ref="userInfo"/>
        </element>
      </element>
      <methods>
        <method access="anonymous" name="Logon" static="true">
          <parameters>
            <param desc="User account" name="login" type="string"/>
            <param desc="Password associated with user login" name="password" type="string"/>
            <param desc="Connection settings" name="parameters" type="DOMElement"/>
            <param desc="Session token" inout="out" name="sessionToken" type="string"/>
            <param desc="Session parameters" inout="out" name="sessionInfo" namespace="session" type="sessionInfo"/>
            <param desc="Security token" inout="out" name="securityToken" optional="true" type="string"/>
          </parameters>
        </method>
        <method access="anonymous" name="BearerTokenLogon" static="true">
          <parameters>
            <param desc="token" name="bearerToken" type="string"/>
            <param desc="Session token" inout="out" name="sessionToken" type="string"/>
            <param desc="Session parameters" inout="out" name="sessionInfo" namespace="session" type="sessionInfo"/>
            <param desc="Security token" inout="out" name="securityToken" optional="true" type="string"/>
          </parameters>
        </method>
        <method access="anonymous" name="GetUserInfo" static="true">
          <parameters>
            <param desc="User parameters" inout="out" name="userInfo" type="sessionUserInfo"/>
          </parameters>
        </method>
        <method name="Logoff" static="true"></method>
        <method access="admin" name="KillSession" static="true">
          <parameters>
            <param desc="Login or session ID" name="Id" type="string"/>
          </parameters>
        </method>
        <method name="TestCnx" static="true"></method>
        <method name="ChangePassword" static="true">
          <parameters>
            <param desc="Old password" name="oldPassword" type="string"/>
            <param desc="New password" name="newPassword" type="string"/>
          </parameters>
        </method>
        <method access="anonymous" name="GetServerTime" static="true">
          <parameters>
            <param inout="out" name="serverTime" type="datetime"/>
          </parameters>
        </method>
        <method access="admin" name="ServerShutdown" static="true"></method>
        <method name="GetOption" static="true">
          <parameters>
            <param label="Option name" name="name" type="string"/>
            <param desc="Option value as a string" inout="out" label="Option value" name="value" type="string"/>
            <param inout="out" label="Data type" name="type" type="byte"/>
          </parameters>
        </method>
        <method name="GetNewIds" static="true">
          <parameters>
            <param desc="Number of identifiers that this method should return" inout="in" label="Number of identifiers" name="count" type="long"/>
            <param desc="Comma separated list of identifiers" inout="out" label="List of identifiers" name="idList" type="string"/>
          </parameters>
        </method>
        <method name="GetNewIdsEx" static="true">
          <parameters>
            <param desc="Number of identifiers that this method should return" inout="in" label="Number of identifiers" name="count" type="long"/>
            <param desc="Name of the sequence to increment" inout="in" label="Sequence name" name="sequence" type="string"/>
            <param desc="Comma separated list of identifiers" inout="out" label="List of identifiers" name="idList" type="string"/>
          </parameters>
        </method>
        <method name="GetCnxInfo" static="true">
          <parameters>
            <param desc="Returned document" inout="out" name="cnxInfo" type="DOMDocument"/>
          </parameters>
        </method>
        <method access="anonymous" name="FormatDataPolicy" static="true">
          <parameters>
            <param inout="in" label="Name of the data policy to apply" name="dataPolicy" type="string"/>
            <param inout="in" label="Value to transform" name="value" type="string"/>
            <param inout="out" label="Result of the application of the data policy" name="result" type="string"/>
          </parameters>
        </method>
        <method name="Encrypt" static="true">
          <parameters>
            <param inout="in" label="Text to encrypt" name="decrypted" type="string"/>
            <param inout="out" label="Encrypted text" name="encrypted" type="string"/>
          </parameters>
        </method>
        <method name="EncryptServerPassword" static="true">
          <parameters>
            <param inout="in" label="Text to encrypt" name="decrypted" type="string"/>
            <param inout="out" label="Encrypted text" name="encrypted" type="string"/>
          </parameters>
        </method>
        <method name="HashPassword" static="true">
          <parameters>
            <param inout="in" label="Password to encrypt" name="decrypted" type="string"/>
            <param inout="out" label="Encrypted password" name="encrypted" type="string"/>
          </parameters>
        </method>
        <method name="Diff" static="true">
          <parameters>
            <param desc="Primary key of the document" inout="in" name="pk" type="primarykey"/>
            <param inout="out" label="The original document in text format" name="original" type="string"/>
            <param inout="out" label="The current document in text format" name="current" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="xtk:sessionInfo.png" implements="xtk:persist" label="Session information" name="sessionInfo" namespace="xtk" xtkschema="xtk:srcSchema">
      <element img="xtk:sessionInfo.png" label="Session information" name="sessionInfo" pkgStatus="never">
        <sysFilter name="readAccess">
          <condition enabledIf="$(loginId)!=0" expr="FALSE"/>
        </sysFilter>
        <sysFilter name="writeAccess">
          <condition enabledIf="$(loginId)!=0" expr="FALSE"/>
        </sysFilter>
        <key name="token">
          <keyfield xpath="@token"/>
        </key>
        <attribute label="Session token" length="40" name="token" type="string"/>
        <attribute label="Account ID" length="64" name="login" type="string"/>
        <attribute label="Remote IP address" length="50" name="remoteAddr" type="string"/>
        <attribute label="Expiry date" name="expiration" type="datetime"/>
        <attribute label="Session information signature" length="512" name="key" type="string"/>
        <attribute label="IMS session token" length="2000" name="imsToken" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Package content definition" entitySchema="xtk:srcSchema" img="xtk:specfile.png" implements="xtk:persist" label="Package definitions" labelSingular="Package definition" mappingType="xmlFile" name="specFile" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="user" name="type">
        <value img="xtk:pkgUser64.png" label="User" name="user" value="0"/>
        <value img="xtk:pkgPlatform64.png" label="Platform" name="platform" value="1"/>
        <value img="xtk:pkgAdmin64.png" label="Admin" name="admin" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="element" name="exclusionType">
        <value label="Element" name="element" value="0"/>
        <value label="Folder" name="folder" value="1"/>
      </enumeration>
      <element dataSource="file" name="specFile" sqltable="XtkEntity">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <compute-string expr="@label+' ('+@name+')'"/>
        <key name="id">
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute name="label" template="xtk:common:label"/>
        <attribute default="'xtk:installedPackage.png'" name="img" type="string"/>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <attribute default="GetOption('XtkInstancePrefix')+'PKG'+CounterValue('xtkSpecFile')" name="name"/>
        <element length="2000" name="desc" template="xtk:common:desc"/>
        <attribute desc="Package supplier" label="Distributor" name="vendor" type="string"/>
        <attribute default="true" label="Include the definition" name="includeSpec" type="boolean"/>
        <attribute default="false" label="Include an installation script" name="includeInstallScript" type="boolean"/>
        <attribute label="Create a compressed archive" name="archive" type="boolean"/>
        <attribute enum="type" label="Package type" name="type" type="byte"/>
        <attribute default="false" label="Include default values" name="includeDefaultValues" type="boolean"/>
        <element label="Entity export definition" name="definition" ordered="true" unbound="true">
          <attribute label="Name of entity schema" name="schema" type="string"/>
          <attribute default="false" label="Definition built by an automatic process" name="automaticDefinition" type="boolean"/>
          <attribute default="5000" desc="Maximum number of entities to export" label="Maximum count to export" name="lineCountMax" type="long"/>
          <element name="where" ref="xtk:queryDef:where" xml="true"/>
          <element name="exclusions" ref="xtk:queryDef:where" xml="true"/>
          <element name="orderBy" ref="xtk:queryDef:orderBy"/>
        </element>
        <element desc="Package installation javascript code" label="javascript code" name="installScript" type="string"/>
        <element label="Execution results" name="execution">
          <attribute label="Package generation date" name="buildDate" type="datetime"/>
          <attribute desc="Output file size (in bytes)" label="File size" name="fileSize" type="long"/>
          <attribute desc="File name with extension" label="File name" name="fileName" type="string"/>
          <attribute desc="Full file path on the server" label="File path" name="filePath" type="string" xml="true"/>
          <attribute desc="Number of objects exported during package execution" label="Number of objects" name="objectCount" type="long"/>
        </element>
      </element>
      <methods>
        <method const="true" name="Generate"></method>
        <method const="true" name="GenerateDoc">
          <parameters>
            <param desc="Output XML document" inout="out" name="package" type="DOMDocument"/>
          </parameters>
        </method>
        <method hidden="true" library="xtk:package.js" name="genDefinitions" static="true">
          <parameters>
            <param desc="Content type (platform=1, admin=2)." inout="in" name="type" type="byte"/>
            <param desc="Definition collection" inout="out" name="definitions" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="xtk:package.js" name="addInPackage" static="true">
          <parameters>
            <param desc="Package identification (ns:name)" inout="in" name="package" type="string"/>
            <param desc="Schema of the entities to add" inout="in" name="schema" type="string"/>
            <param desc="Selection condition of the entities to add" inout="in" name="where" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="xtk:package.js" name="exportSelection" static="true">
          <parameters>
            <param desc="Schema of the entities to add" inout="in" name="schema" type="string"/>
            <param desc="Selection condition of the entities to add" inout="in" name="where" type="DOMElement"/>
            <param desc="Output XML document" inout="out" name="package" type="DOMDocument"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Scripts containing SQL commands" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:sql.png" implements="xtk:persist" label="SQL scripts" labelSingular="SQL script" mappingType="textFile" name="sql" namespace="xtk" xtkschema="xtk:srcSchema">
      <element img="xtk:sql.png" name="sql" pkgPlatform="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsResName" name="nsName"/>
        <element label="Script" name="data" type="string"/>
      </element>
      <methods>
        <method access="sql" name="Execute" static="true">
          <parameters>
            <param desc="SQL script identifier (&lt;namespace>:&lt;name>)" inout="in" name="id" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="SQL structure schemas for databases" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Database schemas" labelSingular="Database schema" mappingType="xmlFile" name="sqlSchema" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="sql" name="exprType">
        <value label="SQL field" name="sql"/>
        <value label="Non SQL field" name="xml"/>
        <value label="SQL calculated field" name="calculatedSQL"/>
        <value label="Non SQL calculated field" name="calculatedXML"/>
        <value label="Feature field" name="feature"/>
      </enumeration>
      <enumeration basetype="string" name="fieldType">
        <value label="Text string" name="string"/>
        <value label="8-bit integer (boolean)" name="boolean"/>
        <value label="8-bit integer (byte)" name="byte"/>
        <value label="16-bit integer (short)" name="short"/>
        <value label="32-bit integer (long)" name="long"/>
        <value label="64-bit integer (int64)" name="int64"/>
        <value label="Floating point number (float)" name="float"/>
        <value label="Double precision number (double)" name="double"/>
        <value label="Date" name="date"/>
        <value label="Date and time (with time zone)" name="datetimetz"/>
        <value label="Date and time (without time zone)" name="datetimenotz"/>
        <value label="Time" name="time"/>
        <value label="Duration" name="timespan"/>
        <value label="Long text field (memo)" name="memo"/>
        <value label="Variable length binary field (blob)" name="blob"/>
        <value label="Link" name="link"/>
        <value label="Free memo (CDATA)" name="CDATA"/>
      </enumeration>
      <enumeration basetype="string" name="tableType">
        <value desc="Standard SQL table" label="Standard" name="standard"/>
        <value desc="Temporary SQL table" label="Temporary" name="temporary"/>
      </enumeration>
      <enumeration basetype="string" name="diffStatus">
        <value img="xtk:tableadd.png" label="Added" name="added"/>
        <value img="xtk:tabledel.png" label="Deleted" name="removed"/>
        <value img="xtk:table.png" label="Updated" name="updated"/>
        <value img="xtk:tablelight.png" label="Not changed" name="unchanged"/>
      </enumeration>
      <enumeration basetype="string" default="link11" name="linkType">
        <value img="xtk:xtklink1.png" label="1..1 link" name="link11"/>
        <value img="xtk:xtklinkn.png" label="1..n link" name="link1n"/>
      </enumeration>
      <element name="field">
        <key internal="true" name="id">
          <keyfield xpath="@id"/>
        </key>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute label="SQL name" name="name" type="string"/>
        <attribute desc="Calculated field expression" label="Expression" name="expr" type="string"/>
        <attribute enum="fieldType" label="Type" name="type" type="string"/>
        <attribute label="Size" name="length" type="string"/>
        <attribute default="false" label="AutoIncrement" name="autoIncrement" type="boolean"/>
        <attribute default="false" label="Not Null" name="notNull" type="boolean"/>
        <attribute label="SQL level default value (for NotNull)" name="sqlDefault" type="string"/>
        <attribute enum="fieldType" label="Previous datatype" name="oldType" type="string"/>
        <attribute label="Previous size" name="oldLength" type="string"/>
        <attribute label="Label" name="label" type="string"/>
        <attribute label="Description" name="desc" type="string"/>
        <attribute label="Relative path" name="relXPath" type="string"/>
        <attribute label="Default value" name="default" type="string"/>
        <attribute label="Mandatory" name="required" type="boolean"/>
        <attribute label="Advanced" name="advanced" type="boolean"/>
        <attribute name="dataPolicy" template="xtk:common:dataPolicy"/>
        <attribute desc="Last schema which overloaded the field definition (if empty, it is the same schema as the one of the table)" name="belongsTo" type="string"/>
        <attribute default="true" desc="Synchronize logical description for this element from the physical database." label="Synchronize" name="commitDiff" type="boolean"/>
        <attribute enum="diffStatus" name="diffStatus" type="string"/>
        <attribute label="Enumeration" name="enum" type="string"/>
        <attribute label="Identifier" name="id" type="short"/>
        <attribute label="SQL field" name="sql" type="boolean"/>
        <attribute label="User field" name="user" type="boolean"/>
        <attribute label="Operation" name="_operation" type="string"/>
        <attribute enum="exprType" label="Field type" name="exprType" type="string"/>
        <attribute label="Add a history date" name="featureDate" type="boolean"/>
        <attribute label="Authorize multiple values" name="featureUnbound" type="boolean"/>
        <attribute label="Feature type" name="featureType" type="string"/>
      </element>
      <element name="dbindex">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Name" name="name" type="string"/>
        <attribute label="Unique" name="unique" type="boolean"/>
        <attribute label="Index cluster" name="clustered" type="boolean"/>
        <element name="field" ref="field" unbound="true" xml="true"/>
        <attribute desc="Last schema which overloaded the index definition (if empty, it is the same schema as the one of the table)" name="belongsTo" type="string"/>
        <attribute default="true" desc="Synchronize logical description for this element from the physical database." label="Synchronize" name="commitDiff" type="boolean"/>
        <attribute default="'added'" enum="diffStatus" name="diffStatus" type="string"/>
      </element>
      <element name="table">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="namespace" template="xtk:common:namespace"/>
        <attribute label="SQL name" name="name" template="xtk:common:name"/>
        <attribute label="Auto-generated key" name="autopk" type="boolean"/>
        <attribute enum="tableType" label="Type" name="type" type="string"/>
        <attribute label="User tablespace" name="tableSpace" type="string"/>
        <attribute label="Index tablespace" name="tableSpaceIndex" type="string"/>
        <attribute label="Label" name="label" type="string"/>
        <attribute label="Description" name="desc" type="string"/>
        <attribute label="Relative path" name="relXPath" type="string"/>
        <attribute default="true" desc="Synchronize logical description for this element from the physical database." label="Synchronize" name="commitDiff" type="boolean"/>
        <attribute enum="diffStatus" name="diffStatus" type="string"/>
        <attribute desc="Schema containing the initial definition of the table" label="Schema the table belongs to" name="hostSchema" type="string"/>
        <attribute desc="Last schema which overloaded the table definition (if empty, it is hostSchema)" name="belongsTo" type="string"/>
        <attribute label="Operation" name="_operation" type="string"/>
        <attribute desc="Recreate the table and re-import data" label="Recreate table" name="create" type="boolean"/>
        <element name="dbindex" ref="dbindex" unbound="true" xml="true"/>
        <element name="field" ref="field" unbound="true" xml="true"/>
      </element>
      <element name="dbLink">
        <key name="dbLink">
          <keyfield xpath="@srcTable"/>
          <keyfield xpath="@srcField"/>
        </key>
        <attribute enum="linkType" label="Link type" name="linkType" type="string"/>
        <attribute desc="Relation start table" label="Source table" name="srcTable" required="true" type="string"/>
        <attribute desc="Relation destination table" label="Destination table" name="dstTable" required="true" type="string"/>
        <attribute desc="SQL name in source table for foreign key field" label="Source field" name="srcField" required="true" type="string"/>
        <attribute desc="Destination field SQL name" label="Destination field" name="dstField" required="true" type="string"/>
        <attribute desc="Path relative to the source table in schema" label="Relative path" name="srcRelXPath" required="true" type="string"/>
        <attribute desc="Path relative to the destination table in schema" label="Relative path" name="dstRelXPath" required="true" type="string"/>
        <attribute desc="Label of relation as seen from source table" label="Label" name="srcLabel" type="string"/>
        <attribute desc="Label of relation as seen from destination table" label="Label" name="dstLabel" type="string"/>
        <attribute desc="Description of the relation as seen from source table" label="Description" name="srcDesc" type="string"/>
        <attribute desc="Description of the relation as seen from destination table" label="Description" name="dstDesc" type="string"/>
        <attribute desc="Relation integrity type from source table" enum="xtk:srcSchema:integrity" label="Integrity type" name="srcIntegrity" type="string"/>
        <attribute desc="Relation integrity type from destination table" enum="xtk:srcSchema:integrity" label="Integrity type" name="dstIntegrity" type="string"/>
        <attribute default="true" desc="Synchronize logical description for this element from the physical database." label="Synchronize" name="commitDiff" type="boolean"/>
        <attribute default="'added'" enum="diffStatus" name="diffStatus" type="string"/>
      </element>
      <element label="SQL schema" name="sqlSchema" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <attribute name="userNamespace" template="xtk:common:namespace"/>
        <attribute label="Type" name="provider" type="string"/>
        <element name="table" ref="table" unbound="true" xml="true"/>
        <element name="dbLinkConfig">
          <element name="dbLink" ref="dbLink" unbound="true" xml="true"/>
        </element>
        <element name="createdbParameters" ref="xtk:builder:createdbParameters"/>
        <element name="dbcnx" template="xtk:serverConf:dataSource/dbcnx" xml="true">
          <attribute enum="xtk:builder:creationProvider" name="provider"/>
        </element>
        <element name="sqlDiffParam">
          <attribute label="Associated namespace" name="userNamespace" type="string"/>
          <attribute label="Look for new tables" name="searchNewTables" type="boolean"/>
          <attribute desc="Namespaces filter" label="Ignore" name="namespaceFilter" type="string"/>
          <attribute label="Associated namespace" name="defaultNamespace" type="string"/>
          <attribute desc="Filter on table names" label="'NOT LIKE'" name="whereFilter" type="string"/>
          <attribute label="Take SQL fields naming conventions into account" name="useNamingConventions" type="boolean"/>
        </element>
      </element>
      <methods>
        <method name="Generate"></method>
        <method const="true" name="PatchSrcSchemas">
          <parameters>
            <param desc="Output document" inout="out" name="output" type="DOMElement"/>
          </parameters>
        </method>
        <method name="UpdateFieldProp" static="true">
          <parameters>
            <param desc="Content" name="content" type="DOMElement"/>
          </parameters>
        </method>
        <method name="UpdateSchema" static="true">
          <parameters>
            <param desc="Content" name="content" type="DOMElement"/>
          </parameters>
        </method>
        <method name="BuildTableList" static="true">
          <parameters>
            <param desc="ID of the data source" name="dataSource" type="string"/>
            <param desc="Mask for the table name" name="tablePattern" type="string"/>
            <param desc="lists of existing tables" inout="out" name="tableList" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="BuildSqlSchema" static="true">
          <parameters>
            <param desc="ID of the data source" name="dataSource" type="string"/>
            <param desc="Table name" name="tableName" type="string"/>
            <param desc="Generated schema" inout="out" name="schema" type="DOMDocument"/>
          </parameters>
        </method>
        <method library="xtk:schema.js" name="BuildAndInstallSchemas" static="true">
          <parameters>
            <param desc="ID of the data source" name="dataSource" type="string"/>
            <param desc="Namespace" name="namespace" type="string"/>
            <param desc="List of selected tables" name="tableList" type="DOMDocument"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Source schemas for managed entities" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Source schemas of entities" labelSingular="Source schema" mappingType="xmlFile" name="srcSchema" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="sql" name="mappingType">
        <value label="Database mapping" name="sql"/>
        <value label="Text file mapping" name="textFile"/>
        <value label="XML text file mapping" name="xmlFile"/>
        <value label="Binary file mapping" name="binaryFile"/>
      </enumeration>
      <enumeration basetype="string" name="integrity">
        <value label="Do nothing when link is deleted" name="neutral"/>
        <value label="Reset foreign keys when the link is deleted" name="normal"/>
        <value label="Do not delete entity if it is referenced from the link" name="define"/>
        <value label="Deleting the entity also deletes entities referenced through the link." name="own"/>
        <value label="Deleting the entity also deletes entities referenced through the link. Duplicating the entity also duplicates entities referenced through the link." name="owncopy"/>
      </enumeration>
      <enumeration basetype="string" name="cardinality">
        <value label="Type 11 simple link" name="single"/>
        <value label="Type 1N collection link" name="unbound"/>
      </enumeration>
      <enumeration basetype="string" name="pkgStatus">
        <value name="default"/>
        <value name="never"/>
        <value name="always"/>
        <value name="preCreate"/>
      </enumeration>
      <enumeration basetype="string" name="fieldType">
        <value label="integer (8 bits)" name="byte"/>
        <value label="integer (16 bits)" name="short"/>
        <value label="integer (32 bits)" name="long"/>
        <value label="integer (64 bits)" name="int64"/>
        <value label="date" name="date"/>
        <value label="date+time" name="datetime"/>
        <value label="period" name="timespan"/>
        <value label="floating number" name="float"/>
        <value label="floating number (double precision)" name="double"/>
        <value label="string" name="string"/>
      </enumeration>
      <enumeration basetype="string" desc="Write operation type" label="Operation" name="operation">
        <value desc="Find element without updating it, or generate an error if it does not exist" label="Reconciliation only" name="none"/>
        <value desc="Update element or create it if it does not exist" label="Update or insert" name="insertOrUpdate"/>
        <value desc="Insert element without checking if it already exists" label="Insertion" name="insert"/>
        <value desc="Update element or generate an error if element does not exist" label="Update" name="update"/>
        <value desc="Find and delete element" label="Deletion" name="delete"/>
      </enumeration>
      <enumeration basetype="string" name="featureType">
        <value desc="The content is stored in a shared table" label="Shared" name="shared"/>
        <value desc="The content is stored in a dedicated table" label="Dedicated" name="dedicated"/>
      </enumeration>
      <element label="Help" localizable="true" name="help" type="ANY"/>
      <element img="xtk:enum.png" name="sysEnum">
        <key internal="true" name="enum">
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label + ' (' + @name + ')'"/>
        <attribute default="NewName()" edit="NamePkEdit" label="Name" name="name" required="true" type="string"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute desc="Description" label="Description" localizable="true" name="desc" type="string"/>
        <element name="help" ref="help"/>
        <attribute name="basetype" type="string"/>
        <attribute label="Default value" name="default" type="string"/>
        <attribute name="template" type="string"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <element name="value" ordered="true" unbound="true">
          <key internal="true" name="name">
            <keyfield xpath="@name"/>
          </key>
          <compute-string expr="@name"/>
          <attribute desc="Value once in memory" label="Name" name="name" type="string"/>
          <attribute desc="Label displayed to user" label="Label" localizable="true" name="label" type="string"/>
          <attribute desc="Stored value" label="Value" name="value" type="string"/>
          <attribute desc="Description" label="Description" localizable="true" name="desc" type="string"/>
          <element name="help" ref="help"/>
          <attribute label="Image" name="img" type="string"/>
          <attribute name="enabledIf" type="string"/>
          <attribute name="applicableIf" type="string"/>
          <attribute enum="operation" name="_operation" type="string"/>
        </element>
      </element>
      <element name="sysFilter">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Name" name="name" type="string"/>
        <attribute label="Filter always active on main queries." name="inline" type="boolean"/>
        <element name="condition" template="xtk:queryDef:condition" unbound="true">
          <key name="condition">
            <keyfield xpath="@expr"/>
          </key>
          <attribute label="Sub-query for IN and NOT IN set operators" name="subQuery" type="string"/>
        </element>
      </element>
      <element name="attribute">
        <key name="names">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="name" required="true" type="MNTOKEN"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <attribute name="ref" type="string"/>
        <attribute name="type" type="MNTOKEN"/>
        <attribute label="Visibility expression" name="visibleIf" type="string"/>
        <attribute name="default" type="string"/>
        <attribute localizable="true" name="translatedDefault" type="string"/>
        <attribute name="defOnDuplicate" type="boolean"/>
        <attribute enum="pkgStatus" name="pkgStatus" type="string"/>
        <attribute label="Mandatory" name="required" type="boolean"/>
        <attribute name="target" type="MNTOKEN"/>
        <attribute name="localizable" type="boolean"/>
        <attribute name="length" type="string"/>
        <attribute name="autoIncrement" type="boolean"/>
        <attribute name="notNull" type="boolean"/>
        <attribute name="sqlDefault" type="string"/>
        <attribute name="enum" type="string"/>
        <attribute name="dbEnum" type="string"/>
        <attribute name="userEnum" type="string"/>
        <attribute name="template" type="string"/>
        <attribute name="inout" type="string"/>
        <attribute label="Description" localizable="true" name="desc" type="string"/>
        <attribute name="sqlname" type="string"/>
        <attribute name="sqltable" type="string"/>
        <attribute name="xml" type="boolean"/>
        <attribute name="belongsTo" type="string"/>
        <attribute name="applicableIf" type="string"/>
        <attribute name="sql" type="boolean"/>
        <attribute name="edit" type="string"/>
        <attribute name="img" type="string"/>
        <attribute enum="featureType" name="feature" type="string"/>
        <attribute name="featureDate" type="boolean"/>
        <attribute label="Constraint(s)" name="dataPolicy" type="string"/>
        <attribute desc="Expression for calculated fields" label="Expression" name="expr" type="string"/>
        <attribute desc="Translatable expression for calculated fields" label="Expression" localizable="true" name="translatedExpr" type="string"/>
        <attribute label="Advanced" name="advanced" type="boolean"/>
        <attribute label="User" name="user" type="boolean"/>
        <element name="help" ref="help"/>
      </element>
      <element name="keyfield">
        <key name="xpath">
          <keyfield xpath="@xpath"/>
        </key>
        <key name="xlink">
          <keyfield xpath="@xlink"/>
        </key>
        <attribute name="xpath" type="MNTOKEN"/>
        <attribute name="xlink" type="MNTOKEN"/>
      </element>
      <element name="key">
        <key name="names">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="name" required="true" type="MNTOKEN"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <attribute label="Internal" name="internal" type="boolean"/>
        <attribute label="Total" name="global" type="boolean"/>
        <attribute name="noDbIndex" type="boolean"/>
        <attribute name="clustered" type="boolean"/>
        <attribute name="allowEmptyPart" type="boolean"/>
        <attribute name="applicableIf" type="string"/>
        <element label="Key" name="keyfield" ref="keyfield" unbound="true"/>
      </element>
      <element name="join">
        <key name="join">
          <keyfield xpath="@xpath-src"/>
        </key>
        <attribute name="xpath-src" type="string"/>
        <attribute name="xpath-dst" type="string"/>
        <attribute name="dstFilterExpr" type="string"/>
      </element>
      <element name="dbindex">
        <key name="names">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="name" required="true" type="MNTOKEN"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <attribute name="unique" type="boolean"/>
        <attribute name="clustered" type="boolean"/>
        <attribute name="belongsTo" type="string"/>
        <attribute name="applicableIf" type="string"/>
        <element name="keyfield" ref="keyfield" unbound="true"/>
      </element>
      <element name="param">
        <key name="names">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="namespace" type="MNTOKEN"/>
        <attribute name="name" required="true" type="MNTOKEN"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <attribute label="Type" name="type" type="string"/>
        <attribute label="System enumeration associated with the value" name="enum" type="string"/>
        <attribute label="Description" localizable="true" name="desc" type="string"/>
        <attribute name="inout" type="string"/>
        <attribute desc="Specifies whether the parameter is optional or not. Only works for the last parameters." label="Optional parameter" name="optional" type="boolean"/>
        <attribute name="localizable" type="string"/>
        <element name="help" ref="help"/>
      </element>
      <element name="parameters">
        <element name="param" ref="param" unbound="true"/>
      </element>
      <element name="method">
        <key name="names">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="name" required="true" type="MNTOKEN"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute label="JavaScript library implementing the method (if empty, then the method is native)." name="library" type="string"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <attribute name="static" type="boolean"/>
        <attribute name="pkonly" type="boolean"/>
        <attribute name="const" type="boolean"/>
        <attribute name="hidden" type="boolean"/>
        <attribute name="dom" type="boolean"/>
        <attribute label="Rights necessary to access method" name="access" type="string"/>
        <element name="help" ref="help"/>
        <element name="description" ref="help"/>
        <element name="example" ref="help"/>
        <element name="parameters" ref="parameters"/>
      </element>
      <element name="methods">
        <attribute name="async" type="boolean"/>
        <element name="method" ref="method" unbound="true"/>
      </element>
      <element name="interface">
        <key name="names">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="name" required="true" type="MNTOKEN"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute name="async" type="boolean"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <element name="method" ref="method" unbound="true"/>
      </element>
      <element name="element">
        <key name="names">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="name" required="true" type="MNTOKEN"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute localizable="true" name="labelSingular" type="string"/>
        <attribute enum="integrity" name="integrity" type="string"/>
        <attribute enum="operation" name="_operation" type="string"/>
        <attribute name="doesNotSupportDiff" type="boolean"/>
        <element name="compute-string">
          <attribute label="Expression" name="expr" type="string"/>
        </element>
        <attribute name="type" type="MNTOKEN"/>
        <attribute label="Visibility expression" name="visibleIf" type="string"/>
        <element name="default" type="string"/>
        <element localizable="true" name="translatedDefault" type="string"/>
        <attribute name="default" type="string"/>
        <attribute localizable="true" name="translatedDefault" type="string"/>
        <attribute name="defOnDuplicate" type="boolean"/>
        <attribute enum="pkgStatus" name="pkgStatus" type="string"/>
        <attribute label="Mandatory" name="required" type="boolean"/>
        <attribute name="localizable" type="boolean"/>
        <attribute name="length" type="string"/>
        <attribute name="enum" type="string"/>
        <attribute name="dbEnum" type="string"/>
        <attribute name="userEnum" type="string"/>
        <attribute name="template" type="string"/>
        <attribute name="inout" type="string"/>
        <attribute label="Description" localizable="true" name="desc" type="string"/>
        <attribute name="sqlname" type="string"/>
        <attribute name="enumImage" type="string"/>
        <attribute name="expandSchemaTarget" type="string"/>
        <attribute name="xmlChildren" type="boolean"/>
        <attribute name="belongsTo" type="string"/>
        <attribute name="applicableIf" type="string"/>
        <attribute label="Aggregate referenced content" name="aggregate" type="string"/>
        <attribute name="filterPath" type="string"/>
        <attribute name="externalJoin" type="boolean"/>
        <attribute label="Constraint(s)" name="dataPolicy" type="string"/>
        <attribute desc="Expression for calculated fields" label="Expression" name="expr" type="string"/>
        <attribute desc="Translatable expression for calculated fields" label="Expression" localizable="true" name="translatedExpr" type="string"/>
        <attribute label="Advanced" name="advanced" type="boolean"/>
        <attribute label="User" name="user" type="boolean"/>
        <attribute enum="featureType" name="feature" type="string"/>
        <attribute name="featureDate" type="boolean"/>
        <attribute desc="Expression used to filter objects automatically exported into the Platform package" label="Expression of the Platform package" name="pkgPlatform" type="string"/>
        <attribute desc="Expression used to filter objects exported automatically into the Administration platform" label="Expression of the Administration package" name="pkgAdmin" type="string"/>
        <attribute desc="Expression to calculate conversion date for currency fields" label="Expression" name="convDate" type="string"/>
        <attribute name="hierarchical" type="boolean"/>
        <attribute name="hierarchicalPath" type="string"/>
        <element name="sysFilter" ref="sysFilter" unbound="true"/>
        <attribute name="unbound" type="boolean"/>
        <attribute name="ordered" type="boolean"/>
        <attribute name="fullLoad" type="boolean"/>
        <attribute name="folderModel" type="string"/>
        <attribute name="folderLink" type="string"/>
        <attribute name="folderProcess" type="string"/>
        <attribute name="emptyKeyValue" type="string"/>
        <attribute name="dataSource" type="string"/>
        <attribute name="img" type="string"/>
        <attribute name="edit" type="string"/>
        <attribute name="ref" type="string"/>
        <attribute name="sqltable" type="string"/>
        <attribute name="xml" type="boolean"/>
        <attribute name="sql" type="boolean"/>
        <attribute name="overflowtable" type="boolean"/>
        <attribute name="autopk" type="boolean"/>
        <attribute name="noKey" type="boolean"/>
        <attribute desc="Name of the sequence to use for the primary key (autopk). If not populated will use the default sequence 'XtkNewId'." name="pkSequence" type="string"/>
        <attribute desc="Temporary SQL table. The table will not be created during the database creation." name="temporaryTable" type="boolean"/>
        <attribute name="tableSpace" type="string"/>
        <attribute name="tableSpaceIndex" type="string"/>
        <attribute name="ownedBy" type="string"/>
        <attribute desc="Do not create an index for the key generated for this link" name="noDbIndex" type="boolean"/>
        <attribute name="target" type="MNTOKEN"/>
        <attribute desc="Name of the reverse link in the destination schema. If the value is '_NONE_', then no reverse link is created in the destination schema." label="reverse link" name="revLink" type="string"/>
        <attribute name="revTarget" type="string"/>
        <attribute localizable="true" name="revLabel" type="string"/>
        <attribute localizable="true" name="revDesc" type="string"/>
        <attribute enum="integrity" name="revIntegrity" type="string"/>
        <attribute enum="cardinality" name="revCardinality" type="string"/>
        <attribute enum="pkgStatus" name="revPkgStatus" type="string"/>
        <attribute name="revExternalJoin" type="boolean"/>
        <attribute name="revAdvanced" type="boolean"/>
        <attribute label="Visibility expression of the reverse link" name="revVisibleIf" type="string"/>
        <attribute label="Always display as a field" name="displayAsField" type="boolean"/>
        <element name="join" ref="join" unbound="true"/>
        <element name="help" ref="help"/>
        <element name="element" ref="element" unbound="true"/>
        <element name="attribute" ref="attribute" unbound="true"/>
        <element name="dbindex" ref="dbindex" unbound="true"/>
        <element name="key" ref="key" unbound="true"/>
      </element>
      <element dataSource="file" doesNotSupportDiff="true" img="xtk:schema.png" name="srcSchema" pkgPlatform="@namespace NOT IN ('xtk','nl','nms','ncm','crm')" template="xtk:entity">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key name="id">
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute default="DefaultNameSpace()" label="Namespace" length="16" name="namespace" required="true" sql="true" type="string"/>
        <attribute default="NewName()" edit="NamePkEdit" label="Name" name="name" required="true" sql="true" type="string"/>
        <element default="CurrentUser()" label="Created by" name="createdBy" sql="true" target="xtk:operator" type="link">
          <join xpath-dst="@id" xpath-src="@createdBy-id"/>
        </element>
        <attribute label="Foreign key of link 'Created by' ('id' field)" name="createdBy-id" sql="true" type="long"/>
        <element label="Modified by" name="modifiedBy" target="xtk:operator" type="link">
          <join xpath-dst="@id" xpath-src="@modifiedBy-id"/>
        </element>
        <attribute label="Foreign key of link 'Modified by' ('id' field)" name="modifiedBy-id" sql="true" type="long"/>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" sql="true" type="datetime"/>
        <attribute desc="Modification date" label="Last modified" name="lastModified" sql="true" type="datetime"/>
        <attribute enum="mappingType" name="mappingType" type="string"/>
        <attribute name="xtkschema" type="string"/>
        <attribute name="implements" type="string"/>
        <attribute name="genAccessors" type="string"/>
        <attribute name="mergeable" type="boolean"/>
        <attribute default="NewLabel()" localizable="true" name="label" type="string"/>
        <attribute label="Label (singular)" localizable="true" name="labelSingular" type="string"/>
        <attribute label="Description" localizable="true" name="desc" type="string"/>
        <attribute label="Use the schema as library instead as an entity" name="library" type="boolean"/>
        <attribute label="Use the schema as a SQL view" name="view" type="boolean"/>
        <attribute label="Post deletion recycling management" name="useRecycleBin" type="boolean"/>
        <attribute name="extendedSchema" type="string"/>
        <element name="help" ref="help"/>
        <attribute name="doNotPersist" type="boolean"/>
        <attribute desc="List of schemas that this schema depends on to be generated (automatically deduced)." name="dependingSchemas" type="string"/>
        <element name="enumeration" ref="sysEnum" unbound="true"/>
        <element name="attribute" ref="attribute" unbound="true"/>
        <element name="element" ref="element" unbound="true"/>
        <element name="methods" ref="methods"/>
        <element name="interface" ref="interface"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Text strings groups" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:comment.png" implements="xtk:persist" label="Text resources" labelSingular="Text resource" mappingType="xmlFile" name="strings" namespace="xtk" xtkschema="xtk:srcSchema">
      <element img="xtk:comment.png" name="strings">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <element desc="Messages list" name="message" unbound="true">
          <key name="id">
            <keyfield xpath="@name"/>
          </key>
          <attribute desc="Message ID" name="name"/>
          <attribute desc="Message text" localizable="true" name="text"/>
        </element>
        <element desc="Error messages list" name="error" unbound="true">
          <key name="id">
            <keyfield xpath="@name"/>
          </key>
          <attribute desc="Error message ID" name="name"/>
          <attribute desc="Error message text" localizable="true" name="text"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Workflows definitions" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:workflow.png" implements="xtk:persist" label="Workflows" labelSingular="Workflow" name="workflow" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="init" name="workflowStatus">
        <value desc="The instance is not running." label="Not started" name="init" value="0"/>
        <value desc="The instance is currently being executed." label="In progress" name="running" value="1"/>
        <value desc="The instance is suspended." label="Suspended" name="suspended" value="3"/>
        <value desc="The tasks are currently being stopped." label="Stop in progress" name="stopping" value="4"/>
        <value desc="The instance is finished." label="Finished" name="stopped" value="5"/>
      </enumeration>
      <enumeration basetype="byte" default="normal" name="criticalLevel">
        <value label="Normal" name="normal" value="0"/>
        <value label="Production" name="production" value="1"/>
        <value label="Critical" name="critical" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="edit" name="workflowState">
        <value img="xtk:workflow/status-edit.png" label="Being edited" name="edit" value="0"/>
        <value img="xtk:workflow/status-started.png" label="Request to start in simulation mode" name="testing" value="9"/>
        <value img="xtk:workflow/status-started.png" label="Start requested" name="starting" value="10"/>
        <value img="xtk:workflow/status-started.png" label="Started" name="started" value="11"/>
        <value img="xtk:workflow/status-pause.png" label="Pause requested" name="pausing" value="12"/>
        <value img="xtk:workflow/status-pause.png" label="Paused" name="paused" value="13"/>
        <value img="xtk:workflow/status-pause.png" label="Resume requested" name="resuming" value="14"/>
        <value img="xtk:workflow/status-started.png" label="Stop requested" name="stopping" value="15"/>
        <value img="xtk:workflow/status-waiting.png" label="Stop in progress" name="stopping2" value="16"/>
        <value img="xtk:workflow/status-waiting.png" label="Restart requested" name="restarting" value="17"/>
        <value img="xtk:workflow/status-waiting.png" label="Restarting" name="restarting2" value="18"/>
        <value img="xtk:workflow/status-finished.png" label="Finished" name="stopped" value="20"/>
      </enumeration>
      <enumeration basetype="byte" default="start" name="timeoutType">
        <value label="Delay after task start" name="start" value="0"/>
        <value label="Delay after a given date" name="after" value="1"/>
        <value label="Delay before a given date" name="before" value="2"/>
        <value label="Expiration calculated by script" name="script" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="multiple" name="taskCollision">
        <value label="Multiple tasks authorized" name="multiple" value="0"/>
        <value label="The current task has priority" name="cancel" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="suspend" name="behaviorOnError">
        <value label="Suspend the process" name="suspend" value="0"/>
        <value label="Ignore" name="ignore" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="none" name="activityMask">
        <value desc="Task is activated and executed normally" label="Normal" name="none" value="0"/>
        <value desc="Task is not activate (task is lost)" label="Do not activate" name="disable" value="1"/>
        <value desc="Task is activated but not executed (waiting for a switch to normal execution)" label="Do not execute" name="suspend" value="2"/>
        <value desc="The task is active but has a configuration error" label="Active" name="warning" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="group" name="assigneeType">
        <value img="xtk:group.png" label="Group" name="group" value="0"/>
        <value img="xtk:operator.png" label="Operator" name="operator" value="1"/>
        <value img="xtk:filter.png" label="Filter" name="filter" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="sh" name="scriptLanguage">
        <value label="Shell script" name="sh" value="sh"/>
        <value label="DOS Batch" name="batch" value="batch"/>
        <value label="Visual Basic script" name="vbs" value="vbs"/>
        <value label="Perl" name="perl" value="perl"/>
        <value label="Python" name="python" value="python"/>
        <value label="Ruby" name="ruby" value="ruby"/>
        <value label="Other..." name="other" value="other"/>
      </enumeration>
      <element label="Affinity" length="40" name="affinity" type="string" userEnum="affinity"/>
      <element label="Machine where processed" length="64" name="hostname" type="string"/>
      <element label="Activity name" length="64" name="activityName" type="string"/>
      <element name="transition">
        <compute-string expr="@label+' ('+@name+')'"/>
        <attribute default="ColName()" label="Name" length="40" name="name" type="string"/>
        <attribute name="label" required="false" template="xtk:common:label"/>
        <attribute label="Destination" name="target" type="string"/>
        <attribute name="x" type="long"/>
        <attribute name="y" type="long"/>
        <attribute default="true" label="Enabled" name="enabled" type="boolean"/>
        <element name="comment" template="xtk:common:comment"/>
      </element>
      <element label="Expiration" name="timeout" template="transition">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="ColLabel()" name="label"/>
        <attribute enum="timeoutType" label="Expiration type" name="type" type="byte"/>
        <attribute default="3600" label="Delay" name="delay" type="timespan"/>
        <attribute label="Date" name="date" type="datetime"/>
        <element edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <attribute default="false" label="Do not terminate the task" name="keepActive" type="boolean"/>
      </element>
      <element name="forkTransition" template="transition">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="ColLabel()" name="label"/>
      </element>
      <element name="doneAndError">
        <element name="done" template="transition">
          <attribute name="label" translatedDefault="'Ok'"/>
          <attribute default="true" name="enabled"/>
        </element>
        <element name="error" template="transition">
          <attribute name="label" translatedDefault="'Error'"/>
          <attribute default="false" name="enabled"/>
        </element>
      </element>
      <element name="activity">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute dataPolicy="identifier" default="ColName()" label="Name" length="64" name="name" type="string"/>
        <attribute label="Display form" length="64" name="form" type="string"/>
        <attribute default="ColLabel()" label="Label" localizable="true" name="label" type="string"/>
        <attribute advanced="true" default="'xtk:workflow/exec.png'" label="Image" name="img" type="string"/>
        <element name="comment" template="xtk:common:comment"/>
        <element defOnDuplicate="true" label="Configuration errors" name="errors" template="xtk:common:comment"/>
        <attribute advanced="true" name="x" type="long"/>
        <attribute advanced="true" name="y" type="long"/>
        <attribute advanced="true" name="affinity" template="xtk:workflow:affinity"/>
        <attribute advanced="true" label="Edit path for the target when editing externally" name="xpathEditTarget" type="string"/>
        <attribute advanced="true" enum="activityMask" label="Execution" name="mask" type="byte"/>
        <attribute advanced="true" label="In simulation mode: execute" name="runOnSimulation" type="boolean"/>
        <attribute advanced="true" desc="Behavior when a running task is activated again" enum="taskCollision" label="Behavior" name="collision" type="byte"/>
        <attribute desc="Period of execution after which the task is considered to have an error" label="Max. execution duration" name="maxExecutionTime" type="timespan"/>
        <element advanced="true" desc="Initialization script" edit="jsedit" label="Initialization script" name="initScript" type="memo" xml="true"/>
        <attribute desc="Behavior when an unprocessed error occurs" enum="behaviorOnError" label="In case of error" name="onError" type="byte"/>
        <attribute desc="Maximum number of consecutive errors" label="Consecutive errors" name="errorLimit" type="long"/>
        <attribute name="timezone" template="xtk:common:timezone"/>
        <element name="transitions" xml="true"/>
      </element>
      <element img="xtk:activities/start.png" label="Start" name="start" template="activity">
        <attribute default="'xtk:activities/start.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element name="transitions">
          <element name="initial" ref="transition"/>
        </element>
      </element>
      <element img="xtk:activities/end.png" label="End" name="end" template="activity">
        <attribute default="'xtk:activities/end.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute label="Stop all tasks in progress" name="stop" type="boolean"/>
      </element>
      <element img="xtk:activities/fork.png" label="Fork" name="fork" template="activity">
        <attribute default="'xtk:activities/fork.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element name="transitions">
          <element name="transition" ordered="true" ref="forkTransition" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <default>&lt;transition name="transition1" enabled="true"/&gt;
          &lt;transition name="transition2" enabled="true"/&gt;</default>
          </element>
        </element>
      </element>
      <element img="xtk:activities/andjoin.png" label="AND-join" name="andjoin" template="activity">
        <attribute default="'xtk:activities/andjoin.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <element name="transitions">
          <element name="transition" ref="transition"/>
        </element>
      </element>
      <element img="xtk:activities/clock.png" label="Scheduler" name="schedule" template="activity">
        <attribute default="'xtk:activities/clock.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo" xml="true"/>
        <element name="transitions">
          <element name="transition" ref="transition"/>
          <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
        </element>
      </element>
      <element img="xtk:activities/hourglass.png" label="Wait" name="wait" template="activity">
        <attribute default="'xtk:activities/hourglass.png'" name="img"/>
        <attribute desc="Wait delay" label="Duration" name="delay" required="true" type="timespan"/>
        <attribute default="true" name="runOnSimulation"/>
        <element name="transitions">
          <element name="transition" ref="transition"/>
        </element>
      </element>
      <element img="xtk:activities/hourglass.png" label="Time constraint" name="timefilter" template="activity">
        <attribute default="'xtk:activities/hourglass.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute desc="Start of execution period" label="Start" name="runnableStart" type="time"/>
        <attribute desc="End of execution period" label="End" name="runnableEnd" type="time"/>
        <attribute label="Try again later if outside of execution period" name="retryLater" type="boolean"/>
        <element name="transitions">
          <element name="transition" ref="transition"/>
        </element>
      </element>
      <element img="xtk:activities/workflowjob.png" label="Sub-workflow" name="subworkflow" template="activity">
        <attribute default="'xtk:activities/workflowjob.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element label="Workflow template" name="workflow" target="xtk:workflow" type="link"/>
        <attribute default="1" label="Start jump" name="jumpStart" type="long"/>
        <attribute default="2" label="End jump" name="jumpStop" type="long"/>
        <element name="start" unbound="true">
          <attribute name="activity" type="string"/>
          <attribute name="jump" type="string"/>
        </element>
        <element label="Parameter" name="param" unbound="true">
          <attribute label="Parameter destination" name="xpath" type="string"/>
          <attribute label="Parameter value" name="value" type="string"/>
          <attribute label="Value label" localizable="true" name="valueLabel" type="string"/>
        </element>
        <element advanced="true" edit="jsedit" label="Initialization script" name="startScript" type="memo"/>
        <element label="Temporary schema linked to the activity" name="extension" type="ANY"/>
        <element name="transitions">
          <element name="transition" ordered="true" ref="forkTransition" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
          </element>
        </element>
      </element>
      <element img="xtk:activities/jump-1.png" label="Jump (start point)" name="jumpin" template="activity">
        <attribute default="'xtk:activities/jump-1.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="1" label="Jump number" name="number" type="long"/>
      </element>
      <element img="xtk:activities/jump-1.png" label="Jump (end point)" name="jumpout" template="activity">
        <attribute default="'xtk:activities/jump-1.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="1" label="Jump number" name="number" type="long"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <element name="transitions">
          <element name="transition" ref="transition"/>
        </element>
        <element label="Temporary schema linked to the activity" name="extension" type="ANY"/>
      </element>
      <element img="xtk:activities/signal.png" label="External signal" name="signal" template="activity">
        <attribute default="'xtk:activities/signal.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element name="transitions">
          <element name="done" ref="transition"/>
          <element name="timeout" ref="timeout" unbound="true"/>
        </element>
      </element>
      <element img="xtk:activities/execsql.png" label="SQL code" name="sql" template="activity">
        <attribute default="'xtk:activities/execsql.png'" name="img"/>
        <attribute desc="The SQL code is contained in an entity stored in the database" label="Use a SQL entity" name="useEntity" type="boolean"/>
        <element label="Data source to use" name="dataSource" type="string"/>
        <element label="SQL entity" name="sql" target="xtk:sql" type="link"/>
        <element label="SQL script" name="script" type="memo" xml="true"/>
        <element name="transitions" template="doneAndError"/>
      </element>
      <element img="xtk:activities/script.png" label="JavaScript code" name="js" template="activity">
        <attribute default="'xtk:activities/script.png'" name="img"/>
        <element desc="Script" edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <element label="Temporary schema linked to the activity" name="extension" type="ANY"/>
        <element name="transitions" template="doneAndError"/>
      </element>
      <element img="xtk:activities/script.png" label="Advanced JavaScript code" name="jsx" template="activity">
        <attribute default="'xtk:activities/script.png'" name="img"/>
        <element desc="First call" edit="jsedit" label="First call" name="call" type="memo" xml="true">
          <default>'return 0'</default>
        </element>
        <element desc="Next calls" edit="jsedit" label="Next calls" name="recall" type="memo" xml="true">
          <default>'return 0'</default>
        </element>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo"/>
        <element label="Temporary schema linked to the activity" name="extension" type="ANY"/>
        <element name="transitions">
          <element name="transition" ordered="true" ref="forkTransition" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <default>&lt;transition name="ok" label="Ok" enabled="true"/&gt;</default>
          </element>
        </element>
      </element>
      <element img="xtk:activities/condition.png" label="Test" name="jstest" template="activity">
        <attribute default="'xtk:activities/condition.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element name="transitions">
          <element name="test" ordered="true" template="transition" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <translatedDefault>&lt;test name="transition1" label="True" enabled="true"/&gt;</translatedDefault>
            <element edit="jsedit" label="Condition" name="condition" type="CDATA"/>
            <attribute default="ColLabel()" name="label"/>
          </element>
          <element name="default" template="transition">
            <attribute name="label" translatedDefault="'False'"/>
            <attribute default="true" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="xtk:activities/shell.png" label="External task" name="extern" template="activity">
        <attribute default="'xtk:activities/shell.png'" name="img"/>
        <attribute default="true" desc="Wait until the end of execution before continuing" label="Wait until the end of execution before continuing" name="wait" type="boolean"/>
        <attribute desc="Name of the command to execute" label="Command" name="command" required="true" type="string"/>
        <element desc="Command extra arguments" label="Arguments" name="additionnalArgs" type="CDATA"/>
        <attribute desc="Working directory for the command" label="Working directory" name="workingDirectory" type="string"/>
        <element name="transitions" template="doneAndError"/>
      </element>
      <element img="xtk:activities/multiscript.png" label="Script" name="multiscript" template="activity">
        <attribute default="'xtk:activities/multiscript.png'" name="img"/>
        <attribute desc="Language" enum="scriptLanguage" label="Language" name="language" type="string"/>
        <attribute desc="Name of the command to execute" label="Command" name="command" type="string"/>
        <element desc="Script" edit="jstedit" label="Script" name="script" required="true" type="memo" xml="true"/>
        <element name="transitions" template="doneAndError"/>
      </element>
      <element img="xtk:activities/txt.png" label="File collector" name="directorywatcher" template="activity">
        <attribute default="'xtk:activities/txt.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute desc="Directory to watch" label="Directory" name="directory" type="string"/>
        <attribute desc="Pattern of files to grab" label="Filter" name="pattern" type="string"/>
        <attribute desc="Stop as soon as a file has been processed" label="Process a single file" name="stopAfterFirst" type="boolean"/>
        <attribute default="true" label="Plan execution" name="usePeriod" type="boolean"/>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo">
          <default>"m_abDay='7' m_abDay[0]='0' m_abDay[1]='0' m_abDay[2]='0' m_abDay[3]='0' m_abDay[4]='0' m_abDay[5]='0' m_abDay[6]='0' m_abMonth='12' m_abMonth[0]='0' m_abMonth[10]='0' m_abMonth[11]='0' m_abMonth[1]='0' m_abMonth[2]='0' m_abMonth[3]='0' m_abMonth[4]='0' m_abMonth[5]='0' m_abMonth[6]='0' m_abMonth[7]='0' m_abMonth[8]='0' m_abMonth[9]='0' m_iDayMode='1' m_iMaxIter='0' m_iMonthDay='0' m_iMonthMode='0' m_iPosDay='0' m_iSpanDay='0' m_iSpanWeek='0' m_iTimeMode='3' m_iValidMode='1' m_iWeekDay='0' m_iWeekMode='0' m_tmFixedDay='' m_tmFixedTime='00:00:00.000' m_tmIterDate='' m_tmIterTime='00:00:00.000' m_tmOrgDate='' m_tmSpanTime='30mn' m_tmStartDate='0001/01/01' m_tmStartTime='' m_tmStopDate='0001/01/01' m_tmStopTime='' m_vtmTime='0'"</default>
        </element>
        <attribute desc="Temporary storage directory" label="Storage directory" name="tmpDirectory" type="string"/>
        <attribute default="true" desc="Use a specific storage directory for this activity, calculated  by default" label="Use a default storage directory" name="useDefault" type="boolean"/>
        <attribute default="100" desc="Maximum number of files to keep in the storage directory. No check if number is zero." label="Number of files" name="maxFiles" type="long"/>
        <attribute desc="Maximum storage space size in megabytes. No check if size is zero." label="Maximum size (in MB)" name="maxSizeMo" type="long"/>
        <element name="transitions">
          <element name="transition" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Ok'"/>
          </element>
          <element name="noFile" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'No file'"/>
            <attribute default="false" name="enabled"/>
          </element>
          <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="event" name="importType">
        <value label="Specified in the transition" name="event" value="0"/>
        <value label="Explicit" name="script" value="1"/>
      </enumeration>
      <element img="xtk:activities/import.png" label="Import (v4 compatibility)" name="import" template="activity">
        <attribute default="'xtk:activities/import.png'" name="img"/>
        <attribute desc="Specify the file name computation type" enum="importType" label="File" name="importType" type="byte"/>
        <attribute desc="Filename" label="File Name" name="file" type="string"/>
        <element label="Template" name="model" target="xtk:dataTransfer" type="link"/>
        <element desc="Script" edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <element name="transitions" template="doneAndError"/>
      </element>
      <enumeration basetype="byte" default="export" name="exportTargetSel">
        <value label="Specified in the export template" name="export" value="0"/>
        <value label="Specified by the inbound events" name="event" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="model" name="controlJobSel">
        <value label="Specified in the transition" name="event" value="0"/>
        <value label="Explicit" name="explicit" value="1"/>
        <value label="Calculated by a script" name="script" value="2"/>
        <value label="New, created from a template" name="model" value="3"/>
        <value label="Specified in the activity" name="inline" value="4"/>
      </enumeration>
      <element img="xtk:activities/export.png" label="Export (v4 compatibility)" name="export" template="activity">
        <attribute default="'xtk:activities/export.png'" name="img"/>
        <attribute desc="Filename" label="Destination file" name="file" type="string"/>
        <attribute enum="exportTargetSel" label="Content to export" name="targetSel" type="byte"/>
        <element label="Template" name="model" target="xtk:dataTransfer" type="link"/>
        <element edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <element label="Export" name="export" target="xtk:dataTransfer" type="link"/>
        <element desc="Calculation script for the export identifier" label="Script" name="exportIdScript" type="CDATA"/>
        <attribute desc="Specifies which export to work on" enum="controlJobSel" label="Export" name="exportSel" type="byte"/>
        <element label="Extraction definition" name="extraction" xml="true">
          <element name="source" ref="xtk:dataTransfer:source"/>
          <element name="destination" ref="xtk:dataTransfer:destination"/>
        </element>
        <element name="transitions" template="doneAndError"/>
      </element>
      <element img="xtk:activities/buildAggregate.png" label="Update aggregate" name="buildAggregate" template="xtk:workflow:activity ">
        <attribute default="'xtk:activities/buildAggregate.png'" name="img"/>
        <attribute default="false" name="runOnSimulation" type="boolean"/>
        <attribute default="'xtk:olapCube.js'" name="library" type="string"/>
        <attribute default="true" name="andJoin" type="boolean"/>
        <attribute default="false" name="distributable" type="boolean"/>
        <attribute default="3" name="syncMode" type="byte"/>
        <element label="Cube" name="cube" revLink="_NONE_" target="xtk:olapCube" type="link"/>
        <element label="Aggregate" name="aggregate" revLink="_NONE_" target="xtk:olapAggregate" type="link"/>
        <element desc="Condition for determining the data to update" label="Condition" name="where" ref="xtk:queryDef:where"/>
        <attribute label="Schema used temporarily" length="50" name="schema" type="string"/>
        <element name="transitions">
          <element name="done" ref="transition"/>
        </element>
      </element>
      <element autopk="true" folderModel="xtkWorkflow,xtkWorkflowModel" img="xtk:workflow.png" name="workflow" pkgAdmin="@id != 0 AND @isModel = 1">
        <compute-string expr="@label+' ('+@internalName+')'"/>
        <key name="name">
          <keyfield xpath="@internalName"/>
        </key>
        <dbindex name="label">
          <keyfield xpath="@label"/>
        </dbindex>
        <attribute default="GetOption('XtkInstancePrefix')+'WKF'+CounterValue('xtkWorkflow')" name="internalName" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <element length="2000" name="desc" template="xtk:common:desc"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element label="Supervisor(s)" name="supervisor" revLabel="Workflows supervised" revLink="workflows" target="xtk:group" type="link"/>
        <attribute name="timezone" template="xtk:common:timezone"/>
        <attribute label="Default affinity" name="affinity" template="xtk:workflow:affinity" xml="true"/>
        <attribute advanced="true" desc="Execute the instance in the engine process (else, start a sub-process)" label="Execute inside the engine" name="inProcess" type="boolean"/>
        <attribute default="30" desc="History retention time" label="History in days" name="history" type="long"/>
        <attribute desc="Behavior when an unprocessed error occurs" enum="behaviorOnError" label="In case of error" name="onError" type="byte"/>
        <attribute desc="Maximum number of consecutive errors" label="Consecutive errors" name="errorLimit" type="long"/>
        <attribute default="'xtk:backgrounds/neolane.png'" label="Background image" name="background" type="string" xml="true"/>
        <attribute advanced="true" label="Log SQL queries in the journal" name="showSQL" type="boolean" xml="true"/>
        <attribute advanced="true" desc="Keep the result of interim populations between two executions" label="Keep interim results" name="keepResult" pkgStatus="never" type="boolean" xml="true"/>
        <attribute default="getOption('Nms_DefaultRcpSchema')" desc="Targeting dimension to which the split applies" label="Targeting dimension" length="64" name="schema" type="string" xml="true"/>
        <attribute desc="Specifies the link from which foreign keys are used as output values" label="Target link" name="recipientLink" type="string" xml="true"/>
        <element desc="Global script" edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <element aggregate="xtk:job:modelSupport" name="modelSupport"/>
        <attribute advanced="true" label="List+Detail form" length="80" name="form" type="string"/>
        <element defOnDuplicate="true" default="iif(@isModel, DefaultFolder('xtkWorkflowModel', [@_folder-id]), DefaultFolder('xtkWorkflow', [@_folder-id]))" img="xtk:model.png" label="Folder" name="folder" required="true" revDesc="Workflows contained in this folder" revIntegrity="define" revLabel="Workflows" revLink="workflowFolder" revTarget="xtk:workflow" target="xtk:folder" type="link"/>
        <element defOnDuplicate="true" default="iif (@isModel, DefaultFolder('xtkWorkflow', [@_folderProcess-id]), 0)" img="xtk:execute.png" label="Execution folder" name="folderProcess" required="true" revDesc="Workflow templates generating instances in this folder" revIntegrity="define" revLabel="Workflow templates" revLink="workflowFolderProcess" revTarget="xtk:workflow" target="xtk:folder" type="link"/>
        <element name="activities" xml="true">
          <element name="start" ref="start" unbound="true"/>
          <element name="end" ref="end" unbound="true"/>
          <element name="fork" ref="fork" unbound="true"/>
          <element name="andjoin" ref="andjoin" unbound="true"/>
          <element name="schedule" ref="schedule" unbound="true"/>
          <element name="wait" ref="wait" unbound="true"/>
          <element name="timefilter" ref="timefilter" unbound="true"/>
          <element name="subworkflow" ref="subworkflow" unbound="true"/>
          <element name="jumpin" ref="jumpin" unbound="true"/>
          <element name="jumpout" ref="jumpout" unbound="true"/>
          <element name="signal" ref="signal" unbound="true"/>
          <element name="extern" ref="extern" unbound="true"/>
          <element name="jstest" ref="jstest" unbound="true"/>
          <element name="js" ref="js" unbound="true"/>
          <element name="jsx" ref="jsx" unbound="true"/>
          <element name="sql" ref="sql" unbound="true"/>
          <element name="multiscript" ref="multiscript" unbound="true"/>
          <element name="directorywatcher" ref="directorywatcher" unbound="true"/>
          <element name="import" ref="import" unbound="true"/>
          <element name="export" ref="export" unbound="true"/>
          <element name="buildAggregate" ref="buildAggregate" unbound="true"/>
        </element>
        <attribute advanced="true" desc="Execute in simulation mode" label="Simulation" name="simulation" type="boolean" xml="true"/>
        <attribute defOnDuplicate="true" desc="Date of the last start" label="Last start" name="lastStart" pkgStatus="never" type="datetime"/>
        <attribute defOnDuplicate="true" desc="Next process date" label="Next processing" name="nextProcessingDate" pkgStatus="never" type="datetime"/>
        <attribute defOnDuplicate="true" label="Affinity of the next task" name="nextProcessingAfn" pkgStatus="never" template="xtk:workflow:affinity"/>
        <attribute defOnDuplicate="true" label="Next processing host" name="nextProcessingHost" pkgStatus="never" template="hostname"/>
        <attribute defOnDuplicate="true" desc="Real process status" enum="workflowStatus" label="Real status" name="status" pkgStatus="never" type="byte"/>
        <attribute defOnDuplicate="true" enum="criticalLevel" label="Severity" name="production" type="byte"/>
        <attribute advanced="true" defOnDuplicate="true" label="Number of the next event" name="eventCount" pkgStatus="never" type="long" xml="true"/>
        <attribute advanced="true" defOnDuplicate="true" label="Number of the next task" name="taskCount" pkgStatus="never" xml="true"/>
        <attribute advanced="true" defOnDuplicate="true" label="Restart requested" name="queryRestart" pkgStatus="never" type="boolean" xml="true"/>
        <attribute defOnDuplicate="true" label="Failed" name="failed" pkgStatus="never" type="boolean"/>
        <element advanced="true" label="Instance variables" name="variables" pkgStatus="never" type="ANY" xml="true"/>
        <attribute defOnDuplicate="true" desc="Number of times the instance has been automatically unlocked since last manual intervention" label="Unlocked count" name="unlockedCount" pkgStatus="never" type="long"/>
        <attribute desc="Number of consecutive errors" label="Consecutive errors" name="errorCount" pkgStatus="never" type="long" xml="true"/>
        <attribute label="Last activity with error" name="errorActivity" pkgStatus="never" type="string" xml="true"/>
        <attribute defOnDuplicate="true" desc="Process status" enum="workflowState" label="Status" name="state" pkgStatus="never" type="byte"/>
        <attribute advanced="true" defOnDuplicate="true" desc="Creation date of the operating system process managing this instance" label="Last processing" name="processDate" pkgStatus="never" type="datetime"/>
        <attribute advanced="true" defOnDuplicate="true" desc="Process identifier (at the operating system level, pid) executing this instance" label="Process (PID)" name="processId" pkgStatus="never" type="long"/>
        <attribute advanced="true" defOnDuplicate="true" desc="Server processing this instance" label="Execution server" name="hostname" pkgStatus="never" template="hostname"/>
        <attribute advanced="true" defOnDuplicate="true" desc="Port number to receive signals" label="Port" name="port" pkgStatus="never" type="long"/>
        <element advanced="true" defOnDuplicate="true" label="Visual status" name="visualState" pkgStatus="never" type="CDATA"/>
      </element>
      <methods>
        <method name="Start" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="Pause" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="Stop" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="Kill" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="Restart" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="Cleanup" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="Simulate" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="Wakeup" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
          </parameters>
        </method>
        <method name="WakeupTask" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="taskIdentifier" type="string"></param>
            <param inout="in" name="activityName" type="string"></param>
          </parameters>
        </method>
        <method name="RestartTask" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param desc="Name of activity(ies) to restart" inout="in" name="activityName" type="string"/>
          </parameters>
        </method>
        <method name="DeleteResult" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param desc="Name of activity(ies) whose results you want to erase" inout="in" name="activityName" type="string"/>
          </parameters>
        </method>
        <method name="Execute" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param desc="Execution simulation." inout="in" name="simulationMode" type="boolean"/>
            <param desc="Keep interim results." inout="in" name="keepResult" type="boolean"/>
            <param desc="Is it necessary to save a trace of SQL orders?" inout="in" name="logSQL" type="boolean"/>
            <param desc="The execution result." inout="out" name="workflow" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ExecuteInstance">
          <parameters>
            <param desc="Execution simulation." inout="in" name="simulationMode" type="boolean"/>
            <param desc="Keep interim results." inout="in" name="keepResult" type="boolean"/>
            <param desc="Is it necessary to save a trace of SQL orders?" inout="in" name="logSQL" type="boolean"/>
          </parameters>
        </method>
        <method name="GetValidationParameters" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="taskIdentifier" type="string"></param>
            <param inout="out" name="content" type="DOMDocument"></param>
          </parameters>
        </method>
        <method name="Reply" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="taskIdentifier" type="string"></param>
            <param inout="in" name="response" type="string"></param>
            <param inout="in" name="choice" type="string"></param>
          </parameters>
        </method>
        <method name="StartWithParameters" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="parameters" type="DOMElement"></param>
          </parameters>
        </method>
        <method name="SimulateWithParameters" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="parameters" type="DOMElement"></param>
          </parameters>
        </method>
        <method name="SpawnWithParameters" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow template." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="parameters" type="DOMElement"></param>
            <param desc="Identifier of the instance created from the template." inout="out" name="instanceId" type="long"/>
          </parameters>
        </method>
        <method name="SpawnWithParametersEx" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow template." inout="in" name="workflowId" type="string"/>
            <param desc="If true, the newly created wotkflow is started in simulation mode." inout="in" name="simulation" type="boolean"/>
            <param inout="in" name="parameters" type="DOMElement"></param>
            <param desc="Identifier of the instance created from the template." inout="out" name="instanceId" type="long"/>
          </parameters>
        </method>
        <method name="Spawn" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow template." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="patch" type="DOMElement"></param>
            <param desc="Identifier of the instance created from the template." inout="out" name="instanceId" type="long"/>
          </parameters>
        </method>
        <method name="PostEvent" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param desc="The name of the activity from which the event starts" inout="in" name="activity" type="string"/>
            <param inout="in" name="transition" type="string"></param>
            <param inout="in" name="parameters" type="DOMElement"></param>
            <param inout="in" name="complete" type="boolean"></param>
          </parameters>
        </method>
        <method name="GetLogin" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param inout="out" name="id" type="long"></param>
            <param inout="out" name="login" type="string"></param>
            <param inout="out" name="cs" type="string"></param>
          </parameters>
        </method>
        <method name="SetLogin" static="true">
          <parameters>
            <param desc="Identifier or internal name of the workflow." inout="in" name="workflowId" type="string"/>
            <param inout="in" name="login" type="string"></param>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Message triggering the workflow tasks" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Events" labelSingular="Event" name="workflowEvent" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="pending" name="eventStatus">
        <value desc="The event is pending processing." img="xtk:workflow/status-pending.png" label="Pending" name="pending" value="0"/>
        <value desc="The event could not be executed." img="xtk:workflow/status-failed.png" label="Failed" name="failed" value="1"/>
        <value desc="The event is being processed." img="xtk:workflow/status-finished.png" label="In progress" name="running" value="2"/>
        <value desc="The event has been processed." img="xtk:workflow/status-finished.png" label="Finished" name="completed" value="3"/>
        <value desc="The event has been lost." img="xtk:workflow/status-dropped.png" label="Dropped" name="dropped" value="4"/>
      </enumeration>
      <element autopk="true" name="workflowEvent" pkgStatus="never">
        <compute-string expr="@id"/>
        <key name="evId">
          <keyfield xpath="@eventIdentifier"/>
          <keyfield xpath="@workflow-id"/>
        </key>
        <attribute label="Identifier" name="eventIdentifier" type="long"/>
        <attribute label="Creation date" name="creationDate" type="datetime"/>
        <attribute label="Processing date" name="processingDate" type="datetime"/>
        <attribute label="Next process date" name="nextProcessingDate" type="datetime"/>
        <attribute name="activity" template="xtk:workflow:activityName"/>
        <attribute enum="eventStatus" label="Status" name="status" type="byte"/>
        <attribute default="[workflow/@keepResult]" name="keepResult" sql="true" type="boolean"/>
        <attribute label="Transition" length="64" name="transition" type="string"/>
        <element label="Variables" name="variables" type="ANY" xml="true"/>
        <element integrity="neutral" label="Workflow" name="workflow" revIntegrity="own" revLabel="Events" revLink="event" target="xtk:workflow" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Workflows in waiting state" entitySchema="xtk:srcSchema" img="xtk:workflowJob.png" implements="xtk:persist" label="Workflows in waiting state" labelSingular="Workflow in waiting state" name="workflowJob" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="default" name="jobCommand">
        <value desc="The command is deduced from the status." label="Default processing" name="default" value="0"/>
        <value desc="The instance receives an external event." label="Issue an event" name="postEvent" value="1"/>
        <value desc="Start an instance with parameters." label="Start an instance" name="start" value="2"/>
        <value desc="Start an instance in simulation mode" label="Start in simulation mode" name="startSimulation" value="3"/>
        <value desc="Resume a paused instance." label="Resume" name="resume" value="4"/>
        <value desc="Pause an instance." label="Pause" name="suspend" value="5"/>
        <value desc="Terminate an instance." label="Stop" name="stop" value="6"/>
        <value desc="Restart an instance." label="Restart" name="restart" value="7"/>
        <value desc="Force an immediate wakeup" label="Wakeup" name="wakeup" value="8"/>
      </enumeration>
      <element autopk="true" img="xtk:workflowJob.png" name="workflowJob" pkgStatus="never">
        <attribute desc="Operation to perform" enum="jobCommand" label="Command" name="command" type="byte"/>
        <element label="Workflow" name="workflow" required="true" revDesc="Next jobs for the instance" revLabel="Process pending" target="xtk:workflow" type="link"/>
        <attribute desc="Next process date" label="Next processing" name="nextProcessingDate" type="datetime"/>
        <attribute name="affinity" template="xtk:workflow:affinity"/>
        <attribute name="hostname" template="xtk:workflow:hostname"/>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" type="datetime"/>
        <element default="CurrentUser()" label="Operator" name="login" required="true" revLink="_NONE_" target="xtk:operator" type="link"/>
        <attribute default="CurrentLoginCS()" desc="Login description string" label="Login description string" length="128" name="loginCS" type="string"/>
        <attribute label="Activity" name="activity" type="string" xml="true"/>
        <attribute label="Transition" name="transition" type="string" xml="true"/>
        <element label="Parameters" name="variables" type="ANY" xml="true"/>
        <attribute desc="Finish the current tasks of the activity" label="Finish the tasks" name="complete" type="boolean" xml="true"/>
        <attribute label="Task" name="taskIdentifier" type="long" xml="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Logs associated with the workflow instances" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Workflow logs" labelSingular="Workflow log" name="workflowLog" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="short" default="error" label="Log type" name="logType">
        <value img="xtk:logerr.png" label="Error" name="error" value="0"/>
        <value img="xtk:logwarn.png" label="Warning" name="warning" value="1"/>
        <value img="xtk:loginfo.png" label="Info" name="info" value="2"/>
        <value img="xtk:logmsg.png" label="Status" name="status" value="3"/>
        <value img="xtk:logmsg.png" label="Verbose" name="verbose" value="4"/>
      </enumeration>
      <element autopk="true" desc="Logs generated by a workflow" enumImage="@logType" label="Log list" name="workflowLog" pkgStatus="never" sqltable="XtkWorkflowLog">
        <dbindex name="logDate">
          <keyfield xpath="@workflow-id"/>
          <keyfield xpath="@logDate"/>
        </dbindex>
        <attribute label="Workflow instance identifier" name="workflow-id" type="long"/>
        <attribute label="Task identifier" name="taskId" type="long"/>
        <attribute name="activity" template="xtk:workflow:activityName"/>
        <attribute enum="logType" label="Log type" name="logType" type="short"/>
        <attribute label="Date" name="logDate" type="datetime"/>
        <attribute label="Error code" name="error" type="long"/>
        <attribute label="Message" length="512" name="message" type="string"/>
        <element integrity="neutral" label="Workflow" name="workflow" revIntegrity="own" revLabel="Messages" revLink="log" target="xtk:workflow" type="link"/>
        <element integrity="neutral" label="Workflow task" name="task" revLabel="Messages" revLink="log" target="xtk:workflowTask" type="link">
          <join xpath-dst="@taskIdentifier" xpath-src="@taskId"/>
          <join xpath-dst="@workflow-id" xpath-src="@workflow-id"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Accounts associated with the workflow instances" entitySchema="xtk:srcSchema" genAccessors="false" label="Workflow logins" labelSingular="Workflow login" name="workflowLogin" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" desc="Login associated with a workflow" label="List of logins" name="workflowLogin" pkgStatus="never">
        <attribute label="Workflow instance identifier" name="workflow-id" type="long"/>
        <attribute label="Operator" length="64" name="login" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Elementary workflow task" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:task.png" implements="xtk:persist" label="Elementary tasks" labelSingular="Elementary task" name="workflowTask" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="pending" name="taskStatus">
        <value desc="The tasks is currently being executed." img="xtk:workflow/status-pending.png" label="Pending" name="pending" value="0"/>
        <value desc="The task is completed." img="xtk:workflow/status-finished.png" label="Finished" name="completed" value="1"/>
        <value desc="The task has been aborted." img="xtk:workflow/status-dropped.png" label="Aborted" name="aborted" value="2"/>
        <value desc="The task could not be executed." img="xtk:workflow/status-failed.png" label="Failed" name="failed" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="notAborted" name="abortReason">
        <value desc="The task has not been aborted" label="Not aborted" name="notAborted" value="0"/>
        <value desc="The task could not be aborted because it was already restarting." label="Restart" name="restarted" value="1"/>
        <value desc="Task has been interrupted because the process has been stopped." label="Stopped" name="stopped" value="2"/>
        <value desc="The task has expired." label="Expired" name="expired" value="3"/>
      </enumeration>
      <element autopk="true" img="xtk:task.png" name="workflowTask" pkgStatus="never">
        <compute-string expr="@taskIdentifier"/>
        <key name="taskIdentifier">
          <keyfield xpath="@taskIdentifier"/>
          <keyfield xpath="@workflow-id"/>
        </key>
        <dbindex name="creation">
          <keyfield xpath="@creationDate"/>
        </dbindex>
        <attribute label="Identifier" name="taskIdentifier" type="long"/>
        <attribute label="Creation date" name="creationDate" type="datetime"/>
        <attribute label="last execution" name="processingDate" type="datetime"/>
        <attribute label="Running" name="runningDate" type="datetime"/>
        <attribute label="Number of executions" name="processingCount" type="long"/>
        <attribute label="Next execution" name="nextProcessingDate" type="datetime"/>
        <attribute label="Machine where executed" name="hostname" template="xtk:workflow:hostname"/>
        <attribute name="activity" template="xtk:workflow:activityName"/>
        <attribute enum="taskStatus" label="Status" name="status" type="byte"/>
        <attribute desc="Error code of the last execution" label="Last error" name="lastErrorCode" type="long"/>
        <attribute enum="abortReason" label="Abort reason" name="abortReason" type="byte"/>
        <attribute label="Expiration date" name="timeout" type="datetime" xml="true"/>
        <attribute label="Completion date" name="completionDate" type="datetime"/>
        <attribute desc="Period of execution after which the task is considered to have an error" label="Max. execution duration" name="maxExecutionTime" type="timespan"/>
        <attribute desc="Duration of the job" expr="SecondsDiff(Coalesce(@completionDate, GetDate()), Coalesce(@runningDate, Coalesce(@processingDate, Coalesce(@completionDate, GetDate()))))" label="Duration" name="duration" type="timespan"/>
        <element label="Events" name="events" xml="true">
          <element name="event" unbound="true">
            <attribute name="id" type="long"/>
          </element>
        </element>
        <element label="Variables" name="variables" type="ANY" xml="true"/>
        <element label="Event variables" name="eventVariables" type="ANY" xml="true"/>
        <element integrity="neutral" label="Workflow" name="workflow" revIntegrity="own" revLabel="Tasks" revLink="task" target="xtk:workflow" type="link"/>
        <attribute label="Object" name="objectId" type="long"/>
        <attribute label="Object schema" name="objectSchema" type="string"/>
        <attribute label="Title" name="title" type="string"/>
        <element name="message" type="CDATA" xml="true"/>
        <element integrity="neutral" label="Assignment" name="assignee" required="true" revLabel="Tasks" revLink="task" target="xtk:group" type="link"/>
        <element integrity="neutral" label="Assignment" name="operator" required="true" revLabel="Tasks" revLink="taskOperator" target="xtk:operator" type="link"/>
        <attribute label="Assignment" name="assigneeFilter" required="true" type="string"/>
        <attribute enum="xtk:workflow:assigneeType" label="Assignment type" name="assigneeType" type="byte"/>
        <element label="Answers" name="responses" xml="true">
          <element name="response" unbound="true">
            <key name="id">
              <keyfield xpath="@operatorId"/>
            </key>
            <attribute label="Operator identifier" name="operatorId" type="long"/>
            <attribute label="Choice" name="choice" type="string"/>
            <attribute label="Processed" name="processed" type="boolean"/>
            <element label="Comments" name="comment" type="CDATA"/>
          </element>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:xslt.png" implements="xtk:persist" label="XSL style sheets" labelSingular="XSL stylesheet" mappingType="textFile" name="xslt" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="html" name="format">
        <value img="xtk:html.png" label="HTML" name="html"/>
        <value img="xtk:text.png" label="Text" name="text"/>
        <value img="xtk:xml.png" label="XML" name="xml"/>
        <value img="xtk:rtf.png" label="MS-Word (RTF)" name="rtf"/>
      </enumeration>
      <element img="xtk:xslt.png" name="xslt" pkgAdmin="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsResName" name="nsName"/>
        <element default="&lt;xsl:stylesheet xmlns:xsl='http://www.w3.org/1999/XSL/Transform' version='1.0'/>" label="Content of style sheet" name="data" type="string"/>
        <attribute enum="format" label="Output format" name="format" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Reference table for countries" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:world.png" implements="xtk:persist" label="Country" labelSingular="Country" name="country" namespace="nms" xtkschema="xtk:srcSchema">
      <element fullLoad="true" img="nms:world.png" name="country" pkgAdmin="@isoA2 != '' AND @isoA3 != ''">
        <compute-string expr="@label"/>
        <key name="isoA2">
          <keyfield xpath="@isoA2"/>
        </key>
        <dbindex name="isoA3" unique="true">
          <keyfield xpath="@isoA3"/>
        </dbindex>
        <dbindex name="labelfr" unique="true">
          <keyfield xpath="@labelFR"/>
        </dbindex>
        <dbindex name="labelen" unique="true">
          <keyfield xpath="@labelEN"/>
        </dbindex>
        <dbindex name="labelde" unique="true">
          <keyfield xpath="@labelDE"/>
        </dbindex>
        <attribute expr="Iif($(language)='fra', @labelFR, Iif($(language)='deu', @labelDE, @labelEN))" label="Label" name="label" type="string"/>
        <attribute desc="ISO 3166-1 Alpha 2 code" label="ISO A2 code" length="2" name="isoA2" required="true" type="string"/>
        <attribute desc="ISO 3166-1 Alpha 3 code" label="ISO A3 code" length="3" name="isoA3" required="true" type="string"/>
        <attribute desc="UN/ISO number code" label="Number code" name="isoNum" required="true" type="long"/>
        <attribute label="ISO label (English)" length="80" name="labelISO" required="true" type="string"/>
        <attribute label="French label" length="80" name="labelFR" required="true" type="string"/>
        <attribute label="English label" length="80" name="labelEN" required="true" type="string"/>
        <attribute label="German label" length="80" name="labelDE" required="true" type="string"/>
        <attribute desc="Internet IANA extension" label="Internet extension" length="2" name="iana" type="string"/>
        <attribute desc="Telephone prefix (ITU)" label="Telephone prefix" length="4" name="itu" type="string"/>
        <attribute desc="Formatting filter for the phone numbers of the country (by default all digits are grouped)" label="Phone-number formatting" length="50" name="phoneFormat" type="string"/>
        <attribute label="International phone prefix" length="5" name="phoneExit" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="States, provinces, regions and other geographical entities" entitySchema="xtk:srcSchema" img="nms:world.png" implements="xtk:persist" label="States/Provinces" labelSingular="State/Province" name="state" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="short" default="unknown" label="Territorial status" name="type">
        <value label="(N/A)" name="unknown" value="0"/>
        <value label="US State" name="usstate" value="1"/>
        <value label="DC" name="dc" value="2"/>
        <value label="Canadian province" name="caprovince" value="3"/>
        <value label="Canadian territory" name="caterritory" value="4"/>
        <value label="US Forces overseas" name="usarmy" value="5"/>
      </enumeration>
      <enumeration basetype="short" default="unknown" label="US region" name="region">
        <value label="(N/A)" name="unknown" value="0"/>
        <value label="Northeast" name="northeast" value="1"/>
        <value label="Midwest" name="midwest" value="2"/>
        <value label="South" name="south" value="3"/>
        <value label="West" name="west" value="4"/>
        <value label="Other" name="other" value="5"/>
      </enumeration>
      <element fullLoad="true" img="nms:world.png" name="state" pkgAdmin="@code!= ''">
        <compute-string expr="@label"/>
        <key name="code">
          <keyfield xpath="@code"/>
          <keyfield xpath="@countryCode"/>
        </key>
        <dbindex name="labelfr" unique="true">
          <keyfield xpath="@labelFR"/>
        </dbindex>
        <dbindex name="labelen" unique="true">
          <keyfield xpath="@labelEN"/>
        </dbindex>
        <dbindex name="labelde" unique="true">
          <keyfield xpath="@labelDE"/>
        </dbindex>
        <attribute expr="Iif(@code='','',@code+' - ')+Iif($(language)='fra', @labelFR, Iif($(language)='deu', @labelDE, @labelEN))" label="Label" name="label" type="string"/>
        <attribute desc="ISO code" label="ISO code" length="3" name="code" required="true" type="string"/>
        <attribute advanced="true" label="Country code" length="2" name="countryCode" type="string"/>
        <attribute label="French label" length="80" name="labelFR" required="true" type="string"/>
        <attribute label="English label" length="80" name="labelEN" required="true" type="string"/>
        <attribute label="German label" length="80" name="labelDE" required="true" type="string"/>
        <attribute enum="nms:state:type" label="Territorial status" name="type" type="short"/>
        <attribute enum="nms:state:region" label="US region" name="region" type="short"/>
        <element externalJoin="true" label="Country" name="country" revLink="state" target="nms:country" type="link">
          <join xpath-dst="@isoA2" xpath-src="@countryCode"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Application server status" mappingType="xmlFile" name="monitoring" namespace="nl" xtkschema="xtk:srcSchema">
      <element name="monitoring" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <attribute name="buildNumber" type="long"/>
        <attribute name="productVersion" type="string"/>
        <attribute name="date" type="datetime"/>
        <attribute desc="Name of the instance accessing the monitoring service" name="instanceName"/>
        <element desc="Scheduled tasks list" name="scheduledTask" unbound="true">
          <attribute desc="Task name" name="taskName" type="string"/>
          <attribute desc="Task instance" name="instance" type="string"/>
          <attribute desc="Task description" name="taskDesc" type="string"/>
          <attribute desc="Date of next start for the task" name="nextRunDate" type="datetime"/>
          <attribute desc="Date of last execution of task" name="lastRunDate" type="datetime"/>
          <attribute desc="Last execution duration" name="lastExecutionTime" type="timespan"/>
          <attribute desc="Task activated" name="active" type="boolean"/>
          <attribute desc="Specify if the last run of the task has ended on an error" name="status" type="boolean"/>
          <attribute desc="Command to execute" name="command" type="string"/>
          <attribute desc="Command arguments" name="args" type="string"/>
        </element>
        <element desc="Started processes list" name="process" unbound="true">
          <attribute name="name" type="string"/>
          <attribute name="command" type="string"/>
          <attribute name="status" type="string"/>
          <attribute name="pid" type="long"/>
          <attribute name="dead" type="boolean"/>
          <attribute name="threadId" type="long"/>
          <attribute name="parentPid" type="long"/>
          <attribute name="startDate" type="datetime"/>
          <attribute name="runTime" type="timespan"/>
          <attribute name="lastAlive" type="datetime"/>
          <attribute name="lifeTime" type="timespan"/>
          <attribute name="restartPeriod" type="timespan"/>
          <attribute name="restartDelay" type="timespan"/>
        </element>
        <element desc="Missing processes list" name="missingProcess" unbound="true">
          <attribute name="name" type="string"/>
        </element>
      </element>
      <methods>
        <method name="DumpInstanceState" static="true">
          <parameters>
            <param desc="Mask for instances to consider" name="mask" type="string"/>
            <param desc="Add list of dead processes" name="includeDead" type="boolean"/>
            <param inout="out" name="monitoring" type="DOMElement"/>
          </parameters>
        </method>
        <method name="DumpInstanceStateEx" static="true">
          <parameters>
            <param desc="Mask for instances to consider" name="mask" type="string"/>
            <param desc="Add list of dead processes" name="includeDead" type="boolean"/>
            <param desc="Does not check alerts from database objects" name="noDatabaseCheck" type="boolean"/>
            <param desc="Filters severity of returned alerts" name="criticalLevel" type="long"/>
            <param inout="out" name="monitoring" type="DOMElement"/>
          </parameters>
        </method>
        <method name="DumpCurrentInstanceState" static="true">
          <parameters>
            <param inout="out" name="monitoring" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetMissingProcesses" static="true">
          <parameters>
            <param inout="out" name="processList" type="DOMElement"/>
          </parameters>
        </method>
        <method access="admin" hidden="true" library="xtk:readLogFile.js" name="GetLogFileContent" static="true">
          <parameters>
            <param inout="in" name="process" type="string"/>
            <param inout="in" name="filterType" type="string"/>
            <param inout="in" name="filterValue" type="string"/>
            <param inout="in" name="sortValue" type="string"/>
            <param inout="in" name="startDateTime" type="string"/>
            <param inout="in" name="endDateTime" type="string"/>
            <param inout="in" name="startLine" type="int"/>
            <param inout="in" name="maxLineCount" type="int"/>
            <param inout="out" name="result" type="string"/>
          </parameters>
        </method>
        <method access="admin" hidden="true" library="xtk:readLogFile.js" name="GetLogFileList" static="true">
          <parameters>
            <param inout="out" name="result" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" extendedSchema="xtk:serverConf" label="Server configuration" library="true" name="serverConf" namespace="nl" xtkschema="xtk:srcSchema">
      <element label="DNS configuration" name="dnsConfig">
        <attribute desc="Comma separated list of domain name servers (DNS)." label="DNS server" name="nameServers" type="string"></attribute>
        <attribute desc="Default domain name. Used by the SMTP HELO command." label="Domain name" name="localDomain" type="string"></attribute>
      </element>
      <element desc="Proxy information" label="Proxy" name="proxy">
        <attribute desc="Address of proxy server" label="Address" name="address" type="string"/>
        <attribute desc="Proxy server port" label="Port" name="port" type="short"/>
        <attribute desc="Login for the connection to proxy server" label="Login" name="login" type="string"/>
        <attribute desc="Password for the connection with proxy server" label="Password" name="password" type="string"/>
      </element>
      <element desc="Configuration of proxy parameters" label="Proxy" name="proxyConfig">
        <attribute default="false" desc="Use a proxy server" label="Enabled" name="enabled" type="boolean"/>
        <attribute default="false" desc="Use the same configuration for all types of proxy" label="Unique proxy server" name="useSingleProxy" type="boolean"/>
        <attribute default="'localhost*'" desc="List of addresses for which proxy parameters shall be ignored." label="Exceptions" name="override" type="string"/>
        <element label="HTTP Proxy" name="proxyHTTP" ref="proxy"/>
        <element label="Secure proxy" name="proxyHTTPS" ref="proxy"/>
      </element>
      <element desc="Configuration of the SMTP server" label="SMTP server" name="mailExchanger">
        <attribute desc="IP address of SMTP server for the transfer of emails." label="SMTP server" name="mxAddress" type="string"/>
        <attribute default="25" desc="TCP port of SMTP server used for the Email transfer." label="Port" name="mxPort" type="short"/>
      </element>
      <element desc="Monitoring service configuration" label="Monitoring" name="monitoring">
        <attribute default="3600" desc="Duration in seconds after which a delivery action should no longer be in preparation" label="Maximum preparation time" name="maxPreparationJobsSec" type="long"/>
        <attribute desc="Unix script ran by the monitoring service" label="Unix Script" name="unixScript" type="string"/>
        <attribute desc="Windows script to be executed by the monitoring service" label="Windows script" name="winScript" type="string"/>
      </element>
      <element label="Configuration of the document conversion server" name="ooconv">
        <attribute default="'http://localhost:8080/nl/jsp/ooconv.jsp'" desc="URL of the document conversion server" label="URL of server" name="url" type="string"/>
        <attribute default="8101-8110" desc="Interval of ports on which the OpenOffice servers are listening" label="Port" name="portRange" type="string"/>
        <attribute default="1000" desc="Maximum number of conversions which an OpenOffice server is allowed to perform. Beyond this number, the server is restarted." label="Maximum number of conversions" name="maxConversions" type="long"/>
        <attribute default="7200" desc="Maximum idle time of OpenOffice server before forced closing." label="Max. idle time" name="maxServerIdleSec" type="long"/>
      </element>
      <element label="Configuration of the service for converting web pages into PDF documents" name="htmlToPdf">
        <attribute default="'phantomjs'" desc="Tool to use for the conversion (phantomjs|wkhtmltopdf|other|disabled)" label="Mode" name="mode" type="string"/>
        <attribute desc="Command line for running the conversion (in 'other' mode) example for phantomjs phantomjs --ignore-ssl-errors=true '$(XTK_INSTALL_DIR)/bin/htmlToPdf.js' '-out:{outPdf}' '-post:{postFile}' '-url:{originUrl}' -sessiontoken:{sessiontoken} -format:{format} -orientation:{orientation} -marginTop:{marginTop} -marginLeft:{marginLeft} -marginRight:{marginRight} -marginBottom:{marginBottom}" label="Command line" name="command" type="string"/>
        <attribute default="120" desc="Maximum conversion time in seconds. Beyond this threshold, the conversion process is stopped and an error is raised." label="Timeout for a conversion" name="timeout" type="long"/>
        <attribute default="5" desc="Max. number of conversion processes allowed at a time on one machine." label="Max. number of processes" name="maxProcessusCount" type="long"/>
        <attribute default="15" desc="Delay in seconds, when all processes are used at the same time and when waiting for a process to free up. If this delay is exceeded, conversion is stopped and an error is raised." label="Delay when waiting for a process" name="waitTime" type="long"/>
        <attribute default="false" desc="Start in verbose mode to diagnose possible errors." label="Verbose mode" name="verbose" type="boolean"/>
      </element>
      <element desc="Workflow process configuration" label="Workflow process" name="wfserver" template="xtk:serverConf:serverTask">
        <attribute default="20" label="Period" name="dataBasePoolPeriodSec" type="long"/>
        <attribute label="Affinity" name="affinity" type="string"/>
        <attribute desc="HostName:Port enabling relay of notifications" label="Notification relay" name="notifRelay" type="string"/>
      </element>
      <element desc="Configuration of the Web Module" label="Web module" name="web" template="xtk:serverConf:serverTask">
        <attribute default="false" desc="Start the SOAP router in module mode." label="SOAP router" name="startSoapRouterInModule" type="boolean"/>
        <attribute default="50" desc="Maximum number of SubmitDelivery SOAP calls that can be queued." label="Size of the queue for SubmitDelivery calls" name="maxDeliveryQueueSize" type="long"/>
        <attribute desc="HostName:Port enabling relay of notifications" label="Notification relay" name="notifRelay" type="string"/>
        <element desc="Parameters used by the JSPs" label="JSPs" name="jsp">
          <attribute default="'http://jni'" desc="URL of SOAP router (http://myserver/xxx, http://jni or mailto:xxx)" label="SOAP router" name="soapRouter" type="string"/>
          <attribute desc="Execution of JSP in debug mode or not" label="Debug mode" name="debug" type="boolean"/>
          <attribute desc="Path of .fo file." label="File .fo" name="foFileName" type="string"/>
          <attribute default="'$(XTK_INSTALL_DIR)/datakit/nl/fra/jsp'" desc="Download path of installation programs for the client consoles." label="Download folder" name="downloadPath" type="string"/>
          <element desc="Class Path to use when starting JVM" label="Class Path" name="classpath" type="string">
            <default>'$(XTK_INSTALL_DIR)/tomcat-7/bin/bootstrap.jar
          $(XTK_INSTALL_DIR)/tomcat-7/bin/tomcat-juli.jar
          $(XTK_INSTALL_DIR)/tomcat-7/lib/tomcat-coyote.jar
          $(XTK_INSTALL_DIR)/tomcat-7/lib/tomcat-util.jar
          $(XTK_INSTALL_DIR)/tomcat-7/lib/tomcat-api.jar
          $(XTK_INSTALL_DIR)/tomcat-7/lib/servlet-api.jar
          $(XTK_INSTALL_DIR)/tomcat-7/lib/jsp-api.jar
          $(XTK_INSTALL_DIR)/tomcat-7/lib/el-api.jar
          $(XTK_INSTALL_DIR)/java/lib/log4j-1.2.11.jar
          $(XTK_INSTALL_DIR)/java/lib/PDFBox-0.7.3.jar
          $(XTK_INSTALL_DIR)/java/lib/FontBox-0.1.0.jar
          $(XTK_INSTALL_DIR)/java/lib/AGJavaEndpoint.22.jar
          $(XTK_INSTALL_DIR)/java/lib/NSGConstants.jar
          $(XTK_INSTALL_DIR)/java/lib/smpp.jar
          $(XTK_INSTALL_DIR)/java/lib/nlweb.jar
          $(XTK_INSTALL_DIR)/java/lib/weka.jar
          $(XTK_INSTALL_DIR)/java/lib/KxCommonInterf.jar
          $(XTK_INSTALL_DIR)/java/lib/KxJni.jar
          $(XTK_INSTALL_DIR)/java/lib/KxJniInterf.jar
          $(XTK_INSTALL_DIR)/java/lib/KxUtils.jar
          $(XTK_INSTALL_DIR)/java/lib/jcaptcha-all.jar
          $(XTK_INSTALL_DIR)/java/lib/apns-1.0.0.Beta4-jar-with-dependencies.jar
          $(XTK_INSTALL_DIR)/java/lib/commons-collections-3.2.jar
          $(XTK_INSTALL_DIR)/java/lib/jcommon-1.0.16.jar
          $(XTK_INSTALL_DIR)/java/lib/jfreechart-1.0.13.jar
          $(XTK_INSTALL_DIR)/java/lib/barcode4j-light.jar
          $(XTK_INSTALL_DIR)/java/lib/zxing.jar
          $(XTK_INSTALL_DIR)/java/lib/raztec.jar
          $(OOO_URE_INSTALL_DIR)/java/juh.jar
          $(OOO_URE_INSTALL_DIR)/java/ridl.jar
          $(OOO_URE_INSTALL_DIR)/java/jurt.jar
          $(OOO_BASIS_INSTALL_DIR)/program/classes/unoil.jar
          $(OOO_INSTALL_DIR)/classes/juh.jar
          $(OOO_INSTALL_DIR)/classes/ridl.jar
          $(OOO_INSTALL_DIR)/classes/unoil.jar
          $(OOO_INSTALL_DIR)/classes/jurt.jar'</default>
          </element>
        </element>
        <element desc="Parameters used by the JSSPs" label="JSSP" name="jssp">
          <attribute default="1000" desc="Maximum number of pages served by a JavaScript context." label="Maximum number of pages served." name="timeToLive" type="long"/>
          <attribute default="true" desc="Enables the garbage collector of the JavaScript context after each query." label="Enable the garbage collector" name="collectsGarbageAfterRequest" type="boolean"/>
        </element>
      </element>
      <element desc="Log management module." label="Module Syslogd" name="syslogd" template="xtk:serverConf:serverTask">
        <attribute default="10" desc="Maximum size in Mb for a log file" label="Maximum size (Mb)" name="maxFileSizeMb" type="long"/>
      </element>
      <element desc="MTA statistics module" label="Stat module" name="stat" template="xtk:serverConf:serverTask">
        <attribute desc="Server listening port" label="Port" name="port" type="short"/>
      </element>
      <element name="nmac">
        <attribute default="false" desc="Use HTTP proxy defined in shared/proxyHTTP" label="Use HTTP proxy" name="useHTTPProxy" type="boolean"/>
      </element>
      <element name="serverConf">
        <element name="shared">
          <element name="dnsConfig" ref="dnsConfig"/>
          <element name="mailExchanger" ref="mailExchanger"/>
          <element name="proxyConfig" ref="proxyConfig"/>
          <element name="monitoring" ref="monitoring"/>
          <element name="ooconv" ref="ooconv"/>
          <element name="htmlToPdf" ref="htmlToPdf"/>
        </element>
        <element name="wfserver" ref="wfserver"/>
        <element name="web" ref="web"/>
        <element name="syslogd" ref="syslogd"/>
        <element name="stat" ref="stat"/>
        <element name="nmac" ref="nmac"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Status of Email/SMS/IM addresses (quarantine management)" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Address" labelSingular="Address" name="address" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="status">
        <value img="nms:unknown.png" label="Unknown" name="unknown" value="0"/>
        <value img="nms:addrerror.png" label="With errors" name="error" value="1"/>
        <value img="nms:valid.png" label="Valid" name="valid" value="2"/>
        <value img="nms:blacklisted.png" label="Blacklisted" name="blacklisted" value="3"/>
        <value img="nms:quarantine.png" label="Quarantine" name="quarantine" value="4"/>
        <value img="nms:valid.png" label="Whitelisted" name="whitelisted" value="5"/>
      </enumeration>
      <element autopk="true" enumImage="@status" name="address" pkgStatus="never">
        <compute-string expr="@address"/>
        <key name="address">
          <keyfield xpath="@address"/>
          <keyfield xpath="@type"/>
        </key>
        <dbindex name="orderList">
          <keyfield xpath="@lastModified"/>
          <keyfield xpath="@status"/>
        </dbindex>
        <attribute label="Address" length="192" name="address" type="string"/>
        <attribute desc="Domain part of the email" expr="GetEmailDomain(@address)" label="Email domain" name="domain"/>
        <attribute desc="Address type" enum="nms:delivery:messageType" label="Type" name="type" type="byte"/>
        <attribute desc="Address status" enum="status" label="Status" name="status" type="byte"/>
        <attribute desc="Reason of the last error" enum="nms:ruleSet:failureReason" label="Error reason" name="quarantineReason" type="byte"/>
        <element desc="Text of the last error" label="Error text" length="255" name="quarantineText" type="CDATA"/>
        <attribute desc="Number of consecutive errors" label="Number of errors" name="consecutiveError" type="long"/>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" type="datetime"/>
        <attribute desc="Date of the last status update" label="Update status" name="lastModified" type="datetime"/>
        <attribute desc="Last error date" label="Last error" name="lastErrorDate" type="datetime"/>
        <element desc="Last delivery action which used this address" externalJoin="true" integrity="neutral" label="Delivery action" name="delivery" revLabel="Address" target="nms:delivery" type="link"/>
      </element>
      <methods async="true">
        <method name="GetQuarantines" static="true">
          <parameters>
            <param desc="Retrieve the quarantines modified since this date. When empty, the pointer value is used." inout="in" name="startDate" type="datetime"/>
            <param desc="Retrieve the quarantines modified since this pointer (optional)." inout="in" name="pointerName" type="string"/>
            <param desc="Maximum number of quarantines to retrieve, provided they were not updated during the same second." inout="in" name="quarantineCount" type="long"/>
            <param desc="Caller reference date. Lets you modify the quarantine date referential (optional)." inout="in" name="callerDate" type="datetime"/>
            <param desc="Output document, list of quarantines." inout="out" name="result" type="DOMDocument"/>
            <param desc="Date of the first non-retrieved quarantine (strictly higher than startDate)." inout="out" name="nextDate" type="datetime"/>
            <param desc="If so, there are still quarantines to retrieve." inout="out" name="hasMore" type="boolean"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Application usage reports" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Usage reports" labelSingular="Usage report" name="billing" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="true" name="billing" pkgStatus="never">
        <compute-string expr="@name"/>
        <attribute label="Name" length="128" name="name" type="string"/>
        <attribute label="Data" name="data" type="blob"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Log messages for the follow-up of the deliveries" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:broadLog.png" implements="xtk:persist" label="Delivery logs" labelSingular="Delivery log" library="true" name="broadLog" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="deliveryStatus">
        <value img="xtk:loginfo.png" label="Non applicable" name="notApplicable" value="127"/>
        <value img="xtk:logwarn.png" label="Ignored" name="ignored" value="0"/>
        <value img="nms:finished.png" label="Sent" name="sent" value="1"/>
        <value img="xtk:logerr.png" label="Failed" name="failed" value="2"/>
        <value img="nms:started.png" label="Taken into account by the service provider" name="sendPending" value="3"/>
        <value img="nms:finished.png" label="Received on mobile" name="received" value="5"/>
        <value img="nms:waiting.png" label="Pending" name="toSend" value="6"/>
        <value img="nms:notSent.png" label="Delivery canceled" name="notSent" value="7"/>
        <value img="nms:prepare.png" label="Prepared" name="prepared" value="8"/>
        <value img="nms:started.png" label="Sent to the service provider" name="handedOver" value="9"/>
      </enumeration>
      <enumeration basetype="byte" name="failureReason">
        <value label="Not defined" name="Undefined" value="0"/>
        <value label="User unknown" name="UnknownUser" value="1"/>
        <value label="Invalid domain" name="InvalidDomain" value="2"/>
        <value label="Unreachable" name="Unreachable" value="3"/>
        <value label="Account disabled" name="Disabled" value="4"/>
        <value label="Mailbox full" name="MailboxFull" value="5"/>
        <value label="Not connected" name="NotConnected" value="6"/>
        <value label="Refused" name="Refused" value="20"/>
        <value desc="Error ignored since address is whitelisted" label="Error ignored" name="ErrorIgnored" value="25"/>
        <value desc="The recipient address is not specified" label="Address not specified" name="AddressUndefined" value="7"/>
        <value desc="The recipient was blacklisted when the delivery was performed" label="Blacklisted address" name="Blacklisted" value="8"/>
        <value desc="The recipient address was in quarantine when the delivery was performed" label="Address in quarantine" name="Quarantine" value="9"/>
        <value desc="The address of the recipient is already referenced for this delivery" label="Double" name="Duplicate" value="10"/>
        <value desc="Recipient has been excluded by a typology rule of type 'SQL'" label="Excluded by a SQL rule" name="TypologyRule" value="11"/>
        <value desc="Recipient has been excluded by an 'arbitration' typology rule" label="Excluded after arbitration" name="BusinessRanking" value="12"/>
        <value desc="A personalization script has canceled delivery of this message" label="Delivery canceled" name="Cancelled" value="13"/>
        <value desc="The postal address quality rating is too low" label="Bad-quality address" name="Quality" value="14"/>
        <value desc="The postal address has not been qualified" label="Unqualified address" name="Unchecked" value="15"/>
        <value desc="The recipient was excluded as not eligible for the offers in the delivery outline" label="Not eligible for the offers" name="OfferMissing" value="16"/>
        <value desc="The recipient was excluded because the maximum delivery size was reached" label="Target limited in size" name="OverDeliveryLimit" value="17"/>
        <value desc="The address is part of the control group" label="Control address" name="ControlGroup" value="127"/>
      </enumeration>
      <element autopk="true" enumImage="@status" img="nms:broadLog.png" name="broadLog" pkSequence="NmsBroadLogId" pkgStatus="never">
        <dbindex name="delivery">
          <keyfield xpath="@delivery-id"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <dbindex name="lastModified">
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <compute-string expr="@address + ' ('+[delivery/@label]+')'"/>
        <attribute name="id" sqlname="iBroadLogId" type="long"/>
        <attribute desc="Address of the delivery log" label="Address" length="512" name="address" sqlname="sAddress" type="string"></attribute>
        <attribute expr="Line(@address, 1)" name="line1" template="nms:common:postalAddress/@line1" xml="true"/>
        <attribute expr="Line(@address, 2)" name="line2" template="nms:common:postalAddress/@line2" xml="true"/>
        <attribute expr="Line(@address, 3)" name="line3" template="nms:common:postalAddress/@line3" xml="true"/>
        <attribute expr="Line(@address, 4)" name="line4" template="nms:common:postalAddress/@line4" xml="true"/>
        <attribute expr="Line(@address, 5)" name="line5" template="nms:common:postalAddress/@line5" xml="true"/>
        <attribute expr="Line(@address, 6)" name="line6" template="nms:common:postalAddress/@line6" xml="true"/>
        <attribute expr="Line(@address, 7)" name="line7" template="nms:common:postalAddress/@line7" xml="true"/>
        <attribute advanced="true" desc="Domain part of the email" expr="GetEmailDomain([@address])" label="Email domain" name="domain"/>
        <attribute desc="Message status" enum="deliveryStatus" label="Status" name="status" sqlname="iStatus" type="byte"/>
        <attribute desc="Extended message flags (Quarantine, Proof group member, Seed address)" label="Extended message flags" name="flags" sqlname="iFlags" type="byte"/>
        <attribute desc="Address moved to quarantine" expr="IsBitSet(@flags, 1)" label="Quarantine" name="quarantine" type="boolean"/>
        <attribute desc="Message for a proof group member" expr="Iif(IsBitSet(@flags, 2)=2, 1, 0)" label="Proof group member" name="FCPMember" type="boolean"/>
        <attribute desc="Message intended for a seed address" expr="Iif(IsBitSet(@flags, 4)=4, 1, 0)" label="Seed" name="seedMember" type="boolean"/>
        <attribute desc="Control group member (no message sent)" expr="Iif(IsBitSet(@flags, 8)=8, 1, 0)" label="Control population" name="controlGroupMember" type="boolean"/>
        <element integrity="neutral" label="Message" name="msg" noDbIndex="true" revIntegrity="neutral" revLabel="Delivery logs" target="nms:broadLogMsg" type="link"/>
        <attribute desc="Date of the last event" label="Event date" name="eventDate" sqlname="tsEvent" type="datetime"/>
        <attribute desc="Last modification date of the log" label="Last modified" name="lastModified" sqlname="tsLastModified" type="datetime"/>
        <element integrity="normal" label="Delivery" name="delivery" noDbIndex="true" revIntegrity="normal" revLabel="Delivery logs" target="nms:delivery" type="link"/>
        <element applicableIf="HasPackage('nms:webAnalytics')" integrity="own" label="Triggering event" name="triggeringWebEvent" revCardinality="single" revLabel="Triggering delivery logs" target="nms:webEvent" type="link">
          <join xpath-dst="@broadLogRemkt-id" xpath-src="@id"/>
        </element>
        <element applicableIf="HasPackage('nms:webAnalytics')" integrity="own" label="Triggered event" name="webEventGenerated" revLabel="Source delivery logs" target="nms:webEvent" type="link" unbound="true">
          <join xpath-dst="@broadLogSrc-id" xpath-src="@id"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:broadLog.png" implements="xtk:persist" label="Recipient delivery logs" labelSingular="Recipient delivery log" name="broadLogRcp" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="broadLogRcp" template="nms:broadLog">
        <dbindex name="recipient">
          <keyfield xpath="@recipient-id"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <element name="delivery" revLabel="Recipient delivery logs"/>
        <attribute label="Foreign key of the recipient" name="recipient-id" type="long"/>
        <attribute label="Foreign key of the service" name="service-id" type="long"/>
        <element integrity="normal" label="Recipient" name="recipient" noDbIndex="true" revIntegrity="normal" revLabel="Recipient delivery logs" revLink="broadLog" target="nms:recipient" type="link">
          <join xpath-dst="@id" xpath-src="@recipient-id"/>
        </element>
        <element applicableIf="HasPackage('nms:midReceiver')==false" label="Service" name="service" noDbIndex="true" revIntegrity="neutral" revLink="broadLog" target="nms:service" type="link">
          <join xpath-dst="@id" xpath-src="@service-id"/>
        </element>
        <element applicableIf="HasPackage('nms:midReceiver')==false" label="Subscription" name="subscription" noDbIndex="true" revIntegrity="neutral" revLink="broadLog" target="nms:subscription" type="link">
          <join xpath-dst="@recipient-id" xpath-src="@recipient-id"/>
          <join xpath-dst="@service-id" xpath-src="@service-id"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:broadLog.png" implements="xtk:persist" label="Visitor delivery logs" labelSingular="Visitor delivery log" name="broadLogVisitor" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="broadLogVisitor" template="nms:broadLog">
        <dbindex name="visitor">
          <keyfield xpath="@visitor-id"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <element name="delivery" revLabel="Visitor delivery logs"/>
        <attribute label="Foreign key of the visitor" name="visitor-id" type="long"/>
        <element integrity="normal" label="Visitor" name="visitor" noDbIndex="true" revIntegrity="normal" revLabel="Visitor delivery logs" revLink="broadLog" target="nms:visitor" type="link">
          <join xpath-dst="@id" xpath-src="@visitor-id"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="File resource stored on the server or in the database" entitySchema="xtk:srcSchema" img="xtk:textfile.png" implements="xtk:persist" label="File resources" labelSingular="File resource" name="fileRes" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="database" desc="Storage type of a file resource" label="Storage type" name="storageType">
        <value desc="the content of the file is stored temporarily in the download directory - No trace in the database." label="In memory" name="memory" value="255"/>
        <value desc="The content of the file is stored in the database." label="Database" name="database" value="0"/>
        <value desc="The file is stored in the download directory with an 'md5' type name." label="Download folder" name="uploadDir" value="1"/>
        <value desc="The file is stored in a working directory of the instance." label="Working directory" name="workspace" value="2"/>
        <value desc="The file is stored in the export directory of the instance." label="Export directory" name="export" value="3"/>
        <value desc="The file is stored in the image directory of the server (shared by all instances)." label="Image directory" name="image" value="4"/>
        <value desc="The file is stored in folders available on Internet." label="Published on frontal servers" name="publicWeb" value="5"/>
        <value desc="The file is stored in a publications folder of the instance." label="Publications folder" name="publishing" value="6"/>
      </enumeration>
      <enumeration basetype="byte" name="userContentType">
        <value img="nl:sryimage.png" label="Image" name="image" value="0"/>
        <value img="nms:word.png" label="Word" name="word" value="1"/>
        <value img="xtk:excel.png" label="Excel" name="excel" value="2"/>
        <value img="nms:pdf.png" label="PDF" name="pdf" value="3"/>
        <value img="nms:powerpoint.png" label="PowerPoint" name="powerPoint" value="4"/>
        <value img="xtk:html.png" label="HTML" name="html" value="5"/>
        <value img="xtk:text.png" label="Text" name="text" value="6"/>
        <value img="nms:mms.png" label="MMS" name="mms" value="7"/>
        <value img="nms:tracking.png" label="URL" name="url" value="8"/>
        <value img="ncm:content.png" label="Content Management" name="contentMgt" value="9"/>
        <value img="nms:video.png" label="Video" name="video" value="10"/>
        <value img="nms:audio.png" label="Audio" name="audio" value="11"/>
        <value img="xtk:file.png" label="Other" name="other" value="20"/>
      </enumeration>
      <enumeration basetype="string" name="imageTypeFilter">
        <value label="All types" name="all"/>
        <value label="PNG" name="png" value="image/png"/>
        <value label="JPEG" name="jpeg" value="image/jpeg"/>
        <value label="GIF" name="gif" value="image/gif"/>
        <value label="BMP" name="bmp" value="image/bmp"/>
      </enumeration>
      <element autopk="true" enumImage="@userContentType" folderLink="folder" folderModel="xtkFileRes" img="xtk:textfile.png" name="fileRes">
        <compute-string expr="@label"/>
        <dbindex name="lastModified">
          <keyfield xlink="folder"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <key name="name">
          <keyfield xpath="@internalName"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'RES'+CounterValue('xtkResource')" name="internalName" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute dbEnum="fileResNature" label="Document nature" length="64" name="nature" type="string"/>
        <attribute enum="userContentType" expr="Iif(SubString(@contentType, 0, 6) = 'image/', 0, Iif(SubString(@contentType, 0, 5) = 'text/', Decode(SubString(@contentType, 5), 'html', 5, 6), Decode(SubString(@contentType, 12), 'pdf', 3, 'vnd.ms-excel', 2, 'msword', 1, 'vnd.ms-powerpoint', 4, 20)))" label="Type" name="userContentType" type="byte" xml="true"/>
        <attribute expr="IIf(IndexOf(@originalName, '\\')>-1, ExtractRight(@originalName, '\\'), @originalName)" name="name" type="string" xml="true"/>
        <attribute desc="Original name of the local file." label="Original name" name="originalName" type="string"/>
        <attribute desc="MIME Content-Type" label="Content-Type" length="100" name="contentType" type="string" userEnum="contentType"/>
        <attribute desc="Codepage associated with the resource" enum="xtk:common:codepage" name="codepage" type="long"/>
        <attribute advanced="true" default="5" desc="Storage type of resource content" enum="storageType" label="Storage type" name="storageType" type="byte"/>
        <attribute advanced="true" desc="Path and file name on the server relative to the working directory." label="File name" length="255" name="fileName" type="string"/>
        <attribute advanced="true" desc="Name of the server that initially accepted the file." label="Server name" length="255" name="originalServer" type="string"/>
        <attribute advanced="true" desc="MD5 key of the content" name="md5" template="xtk:common:md5"/>
        <attribute default="true" desc="Name the file using md5 and the contents so that it is unique" label="Unique file name" name="useMd5AsFilename" type="boolean"/>
        <attribute advanced="true" expr="Iif(@storageType=0 and @md5!='',@md5,'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx')" label="Foreign key of the linked content" name="md5FileResData"/>
        <element advanced="true" label="Database content" name="fileResData" revIntegrity="normal" revLabel="File resources" target="xtk:fileResData" type="link">
          <join xpath-dst="@md5" xpath-src="@md5FileResData"/>
        </element>
        <element integrity="own" label="History" name="history" revLink="fileRes" target="xtk:fileResHistory" type="link" unbound="true">
          <join xpath-dst="@fileRes-id" xpath-src="@id"/>
        </element>
        <attribute desc="The file is loaded on the server" expr="iif(@storageType=0 or @storageType=1, iif(@md5='' or @md5='xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx',0,1), iif(@fileName='',0,1))" label="File loaded" name="loaded" type="boolean"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkFileRes', [@_folder-id])" label="Folder" name="folder" revDesc="File resources associated with this folder" revIntegrity="define" revLabel="File resources" target="xtk:folder" type="link"/>
        <attribute label="Document version" length="20" name="version" type="string"/>
        <element label="Comment" name="comment" template="xtk:common:comment"/>
        <element label="Delivery (attachments)" name="container" revIntegrity="own" revLabel="Attached files" target="nms:delivery" type="link"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="0" label="Width" name="width" type="long"/>
        <attribute default="0" label="Height" name="height" type="long"/>
        <attribute label="Substitute text" length="64" name="alt" type="string"/>
        <attribute desc="Publish the file on the media servers (will be available on the Web)" label="Publish file" name="publish" type="boolean"/>
        <attribute advanced="true" expr="Iif(SubString(@contentType, 1, 6) = 'image/', 1, 0)" label="Is an image" name="isImage" type="boolean"/>
      </element>
      <methods async="true">
        <method name="GetServerFileName">
          <parameters>
            <param desc="Full name of file on server (empty if file not found)." inout="out" name="serverFileName" type="string"/>
          </parameters>
        </method>
        <method name="PostUpload">
          <parameters>
            <param desc="Additional parameters." inout="in" name="params" type="DOMDocument"></param>
          </parameters>
        </method>
        <method name="PreDownload"></method>
        <method name="WebPostUpload">
          <parameters>
            <param desc="Additional parameters." inout="in" name="params" type="DOMDocument"></param>
          </parameters>
        </method>
        <method name="PublishIfNeeded"></method>
        <method name="PublishIfNeededFromId" static="true">
          <parameters>
            <param desc="File ID" name="fileResId" type="string"/>
          </parameters>
        </method>
        <method name="FilePublishing" static="true">
          <parameters>
            <param desc="List of files (name and md5)" inout="inout" name="fileList" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetPublicFileResURL" static="true">
          <parameters>
            <param inout="out" name="url" type="string"/>
          </parameters>
        </method>
        <method name="GetURL">
          <parameters>
            <param inout="out" name="url" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Contents of files stored in the database" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Contents of files" labelSingular="File content" name="fileResData" namespace="xtk" xtkschema="xtk:srcSchema">
      <element emptyKeyValue="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" name="fileResData">
        <compute-string expr="@md5"/>
        <key internal="true">
          <keyfield xpath="@md5"/>
        </key>
        <attribute desc="MD5 key of the content" name="md5" template="xtk:common:md5"/>
        <attribute desc="Resource length in bytes" label="Size in bytes" name="size" type="long"/>
        <element desc="Resource content" label="Content" name="content" type="blob"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Resource history" labelSingular="History line of the resource" name="fileResHistory" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="other" label="Resource access type" name="activityType">
        <value img="xtk:parameters.png" label="Other" name="other" value="0"/>
        <value img="xtk:download.png" label="Download" name="download" value="1"/>
        <value img="xtk:upload.png" label="Send" name="upload" value="2"/>
      </enumeration>
      <element autopk="true" desc="Logs generated during the execution of a job" enumImage="@activityType" label="Log list" name="fileResHistory" pkgStatus="never" sqltable="XtkFileResHistory">
        <dbindex name="logDate">
          <keyfield xpath="@fileRes-id"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <attribute label="Resource identifier" name="fileRes-id" type="long"/>
        <attribute enum="activityType" label="Activity type" name="activityType" type="byte"/>
        <attribute name="lastModified" template="xtk:common:auditTrail/@lastModified"/>
        <element name="modifiedBy" template="xtk:common:modifiedBy"/>
        <attribute name="md5" template="xtk:fileRes:fileRes/@md5"/>
        <attribute desc="Version of the resource when historized" name="version" template="xtk:fileRes:fileRes/@version"/>
        <attribute label="Description" name="description" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Folders in the navigation hierarchy" entitySchema="xtk:srcSchema" img="xtk:folder.png" implements="xtk:persist" label="Folders" labelSingular="Folder" name="folder" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" fullLoad="true" hierarchical="true" hierarchicalPath="@label" img="xtk:folder.png" name="folder" pkgPlatform="@id != 0 AND @builtIn = 0" sqltable="XtkFolder">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label"/>
        <dbindex name="schemaEntity">
          <keyfield xpath="@entity"/>
        </dbindex>
        <dbindex name="order">
          <keyfield xpath="@order"/>
        </dbindex>
        <attribute name="id" sqlname="iFolderId" type="long"/>
        <attribute default="GetOption('XtkInstancePrefix')+'Folder'+CounterValue('xtkFolder')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute advanced="true" defOnDuplicate="true" default="false" label="Native application folder" name="builtIn" type="boolean"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute advanced="true" desc="Form to launch to initialize the folder" label="Initialization call" name="callToInit" type="string" xml="true"/>
        <attribute desc="Folder template" label="Template" length="64" name="model" type="string"/>
        <attribute advanced="true" label="Unselectable folder" name="unSelected" type="boolean"/>
        <attribute advanced="true" desc="Do not share this folder" label="Do not share this folder" name="noShared" type="boolean" xml="true"/>
        <element desc="Folder image" label="Image" name="image" revLink="folderIcon" revTarget="xtk:folder" target="xtk:image" type="link"/>
        <element default="iif ([@parent-id]!='', GetOrgUnit([@parent-id]), 0)" desc="Organizational entity to which the folder belongs" label="Organizational entity" name="orgUnit" revLabel="Folders associated with this organizational entity" revLink="linkedFolders" target="nms:localOrgUnit" type="link"/>
        <element name="comment" template="xtk:common:comment"/>
        <element advanced="true" name="where" template="xtk:queryDef:where" xml="true">
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
        </element>
        <attribute label="Schema of associated list" name="schema" type="string" xml="true"/>
        <attribute label="Schema of entity of folder" length="64" name="entity" type="string"/>
        <attribute advanced="true" label="Number of child nodes" name="childcount" pkgStatus="never" type="short"/>
        <attribute advanced="true" label="Node position" name="order" type="short"/>
        <attribute advanced="true" desc="Folder configuration name. If empty, the folder shares the configuration with all the folders having the same template." label="Configuration" name="configName" type="string" xml="true"/>
        <attribute advanced="true" label="This folder is a view" name="isView" type="boolean"/>
        <attribute advanced="true" label="Sort the sub-folders by alphabetical order" name="sort" type="boolean" xml="true"/>
        <attribute advanced="true" label="System folder" name="system" type="boolean"/>
        <attribute advanced="true" label="Identifier of the offer environment" name="env-id" type="long"/>
        <element advanced="true" name="context" xml="true">
          <element name="parameter" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute label="Name" name="name" type="string"/>
            <attribute label="Value" name="value" type="string"/>
          </element>
        </element>
      </element>
      <methods async="true">
        <method name="LoadChildren" static="true">
          <parameters>
            <param desc="Parent key" name="parentKey" type="string"/>
            <param desc="Filter on folders" name="folderFilter" type="string"/>
            <param desc="The folder returned must be writable" name="writeAccess" type="boolean"/>
            <param desc="Full name of selected node" name="fullName" type="string"/>
            <param desc="Sort by alphabetical order" name="sort" type="boolean"/>
            <param desc="Result document" inout="out" name="result" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="LoadChildrenWithPath" static="true">
          <parameters>
            <param desc="Parent key" name="parentKey" type="string"/>
            <param desc="Filter on folders" name="folderFilter" type="string"/>
            <param desc="The folder returned must be writable" name="writeAccess" type="boolean"/>
            <param desc="Full name of selected node" name="fullName" type="string"/>
            <param desc="Full name of selected node" name="path" type="string"/>
            <param desc="Sort by alphabetical order" name="sort" type="boolean"/>
            <param desc="Result document" inout="out" name="result" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="FindFirstAuthorized" static="true">
          <parameters>
            <param desc="Filter on folders" name="folderFilter" type="string"/>
            <param desc="The folder returned must be writable" name="writeAccess" type="boolean"/>
            <param desc="The folder returned must be compatible with the specified organizational entity" name="orgUnit" type="long"/>
            <param desc="Returns the associated folder entity (null is no folder found)" inout="out" name="folderEntity" type="DOMElement"/>
          </parameters>
        </method>
        <method name="MoveNode" static="true">
          <parameters>
            <param desc="Node key" name="key" type="string"/>
            <param desc="Parent key" name="parentKey" type="string"/>
            <param desc="New node index" name="order" type="short"/>
            <param desc="Full name (not empty to change parent in the tree)" name="fullName" type="string"/>
          </parameters>
        </method>
        <method name="MoveSelection" static="true">
          <parameters>
            <param desc="Selection schema Id" name="schemaId" type="string"/>
            <param desc="Id of the destination folder" name="entityFolder" type="string"/>
            <param desc="Selection to move" name="selectionList" type="DOMElement"/>
            <param desc="Node key" name="key" type="string"/>
          </parameters>
        </method>
        <method name="NewFolder" static="true">
          <parameters>
            <param desc="Parent key" name="parentKey" type="string"/>
            <param desc="Schema" name="schema" type="string"/>
            <param desc="Entity" name="entity" type="string"/>
            <param desc="Template" name="model" type="string"/>
            <param desc="Template label" name="label" type="string"/>
            <param desc="Image key" name="img" type="string"/>
            <param desc="Result document" inout="out" name="result" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="HasFolderWriteRight" static="true">
          <parameters>
            <param desc="Folder identifier" name="folderId" type="string"/>
            <param desc="Result" inout="out" name="result" type="boolean"/>
          </parameters>
        </method>
        <method name="CheckEntityWriteRight" static="true">
          <parameters>
            <param desc="Entity schema identifier" name="schema" type="string"/>
            <param desc="Value of the entity primary key" name="key" type="string"/>
            <param desc="Result" inout="out" name="result" type="boolean"/>
          </parameters>
        </method>
        <method name="InheritParentFolderRights" static="true">
          <parameters>
            <param desc="Folder" name="folder" type="DOMElement"/>
            <param desc="Result" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method library="xtk:folder.js" name="DropSelection" static="true">
          <parameters>
            <param desc="Selection schema Id" name="schema" type="string"/>
            <param desc="Id of the destination folder" name="entityFolder" type="string"/>
            <param desc="Selection to move" name="selectionList" type="DOMElement"/>
            <param desc="Destination folder" name="folderDestId" type="long"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Input forms" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:form.png" implements="xtk:persist" label="Forms" labelSingular="Form" mappingType="xmlFile" name="form" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" name="type">
        <value label="Console screen" name="default"/>
        <value label="Content Management" name="contentForm"/>
        <value label="Wizard" name="wizard"/>
        <value label="Iconbox" name="iconbox"/>
        <value label="Notebook" name="notebook"/>
        <value label="Vertical pane" name="vpaned"/>
        <value label="Horizontal pane" name="hpaned"/>
      </enumeration>
      <enumeration basetype="string" name="align">
        <value label="Left" name="left"/>
        <value label="Centered" name="center"/>
        <value label="Right" name="right"/>
      </enumeration>
      <element name="margin">
        <attribute name="left" type="string"/>
        <attribute name="right" type="string"/>
        <attribute name="top" type="string"/>
        <attribute name="bottom" type="string"/>
      </element>
      <element name="xcopy">
        <attribute name="src" type="string"/>
        <attribute name="dst" type="string"/>
      </element>
      <element name="closeForm">
        <attribute name="modalReturn" type="short"/>
      </element>
      <element name="set" type="ANY">
        <attribute name="xpath" type="string"/>
        <attribute name="value" type="string"/>
        <attribute name="expr" type="string"/>
        <attribute localizable="true" name="translatedExpr" type="string"/>
        <attribute name="var" type="string"/>
        <attribute name="expand" type="boolean"/>
        <attribute name="xml" type="boolean"/>
      </element>
      <element name="setSchema" type="ANY">
        <attribute name="xpath" type="string"/>
        <attribute name="expr" type="string"/>
      </element>
      <element name="copyElement">
        <attribute name="xpathSrc" type="string"/>
        <attribute name="exprSrc" type="string"/>
        <attribute name="xpathDst" type="string"/>
        <attribute name="exprDst" type="string"/>
        <attribute name="list" type="boolean"/>
        <attribute name="nodeName" type="string"/>
        <attribute name="filter" type="string"/>
      </element>
      <element localizable="true" name="static" type="ANY">
        <attribute name="style" type="string"/>
        <attribute name="width" type="short"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute name="img" type="string"/>
        <attribute name="valign" type="string"/>
        <attribute name="align" type="string"/>
        <attribute name="name" type="string"/>
        <attribute name="border-width" type="string"/>
        <attribute name="background-color" type="string"/>
        <attribute name="font-weight" type="string"/>
        <attribute name="text-align" type="string"/>
        <attribute name="colspan" type="short"/>
        <attribute name="rowspan" type="short"/>
        <attribute name="fontBold" type="boolean"/>
        <attribute name="bold" type="boolean"/>
        <attribute name="color" type="string"/>
        <attribute name="backcolor" type="string"/>
        <attribute name="type" type="string"/>
      </element>
      <element name="menu">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute localizable="true" name="label" type="string"/>
        <attribute name="name" type="string"/>
        <attribute name="element" type="string"/>
        <attribute name="form" type="string"/>
        <attribute name="visibleIf" type="string"/>
        <attribute name="applicableIf" type="string"/>
        <element name="menu" ref="menu" unbound="true"/>
      </element>
      <element name="command">
        <attribute name="form" type="string"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute name="name" type="string"/>
        <element name="enter" ref="enrichContext"/>
      </element>
      <element name="input">
        <attribute name="xpath" type="string"/>
        <attribute name="xpath-values" type="string"/>
        <attribute name="ignoreXPath" type="boolean"/>
        <attribute name="nolabel" type="boolean"/>
        <attribute name="refresh" type="boolean"/>
        <attribute name="type" type="string"/>
        <attribute name="key" type="string"/>
        <attribute name="name" type="string"/>
        <attribute name="internalName" type="string"/>
        <attribute name="colspan" type="short"/>
        <attribute name="rowspan" type="short"/>
        <attribute name="notitle" type="boolean"/>
        <attribute name="readOnly" type="boolean"/>
        <attribute name="required" type="boolean"/>
        <attribute name="sharedUserConfig" type="boolean"/>
        <attribute desc="Relative user-configuration Path of control (uses the name of the control if not specified)." name="userConfigPath" type="string"/>
        <attribute name="dataType" type="string"/>
        <attribute name="keepDefColors" type="string"/>
        <attribute name="alias" type="string"/>
        <attribute name="applicableIf" type="string"/>
        <attribute name="default" type="string"/>
        <attribute name="margin-top" type="string"/>
        <attribute name="margin-bottom" type="string"/>
        <attribute name="margin-left" type="string"/>
        <attribute name="margin-right" type="string"/>
        <attribute name="margin" type="string"/>
        <attribute name="maxLabelWidth" type="short"/>
        <attribute name="unbound-width" type="boolean"/>
        <attribute name="sortable" type="boolean"/>
        <attribute name="configurable" type="boolean"/>
        <attribute name="toolbar" type="boolean"/>
        <attribute name="size" type="short"/>
        <attribute name="valign" type="string"/>
        <attribute name="align" type="string"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute name="ordered" type="boolean"/>
        <attribute name="editable" type="boolean"/>
        <attribute name="exprEditable" type="string"/>
        <attribute name="columnIndex" type="boolean"/>
        <attribute name="catchReturnKey" type="boolean"/>
        <attribute name="blankIfEmpty" type="boolean"/>
        <attribute name="disabled" type="boolean"/>
        <attribute name="onChange" type="string"/>
        <attribute name="onClick" type="string"/>
        <attribute name="line-count" type="short"/>
        <attribute name="style" type="string"/>
        <attribute name="cols" type="string"/>
        <attribute name="rows" type="string"/>
        <attribute name="contentType" type="string"/>
        <attribute name="img" type="string"/>
        <attribute localizable="true" name="title" type="string"/>
        <attribute localizable="true" name="desc" type="string"/>
        <attribute name="screen" type="string"/>
        <attribute name="zoom" type="boolean"/>
        <attribute name="exprZoom" type="string"/>
        <attribute name="lineCount" type="short"/>
        <attribute name="col-size" type="short"/>
        <attribute name="schema" type="string"/>
        <attribute name="enumName" type="string"/>
        <attribute name="ref" type="string"/>
        <attribute name="computeStringKey" type="boolean"/>
        <attribute name="text" type="string"/>
        <attribute name="defaultValue" type="string"/>
        <attribute name="hidden" type="boolean"/>
        <attribute name="form" type="string"/>
        <attribute name="formOnAdd" type="string"/>
        <attribute name="formName" type="string"/>
        <attribute name="modeless" type="boolean"/>
        <attribute name="modelessExpr" type="string"/>
        <attribute name="xpathLink" type="string"/>
        <attribute name="publishingFilter" type="string"/>
        <attribute name="createMode" type="string"/>
        <attribute name="computeStringExpr" type="string"/>
        <attribute name="computeStringAlias" type="string"/>
        <attribute name="entityPath" type="string"/>
        <attribute name="expandXPath" type="boolean"/>
        <attribute name="xpathSelect" type="string"/>
        <attribute name="xpathColumn" type="string"/>
        <attribute name="xpathExpr" type="string"/>
        <attribute name="xpathSchema" type="string"/>
        <attribute name="schemaExpr" type="string"/>
        <attribute name="xpathConstant" type="string"/>
        <attribute name="xpathContentType" type="string"/>
        <attribute name="xpathSchemaView" type="string"/>
        <attribute name="xpathGroupBy" type="string"/>
        <attribute name="xpathHaving" type="string"/>
        <attribute name="xpathStartPath" type="string"/>
        <attribute name="xpathActivityName" type="string"/>
        <attribute name="activityName" type="string"/>
        <attribute name="startPath" type="string"/>
        <attribute name="useTreeView" type="boolean"/>
        <attribute name="addChildButton" type="boolean"/>
        <attribute name="xpathHasMemoData" type="string"/>
        <attribute name="xpathCurrentLookupPath" type="string"/>
        <attribute name="xpathGroupOption" type="boolean"/>
        <attribute name="xpathSearchPath" type="string"/>
        <attribute name="notifyPathList" type="string"/>
        <attribute name="notifyPathExpr" type="string"/>
        <attribute name="notifyFolderKeyPath" type="string"/>
        <attribute name="loadPathList" type="string"/>
        <attribute name="xpathEditTarget" type="string"/>
        <attribute localizable="true" name="labelFormChoice" type="string"/>
        <attribute name="filterFormChoice" type="string"/>
        <attribute name="filterEditFormChoice" type="string"/>
        <attribute name="orderFormChoice" type="string"/>
        <attribute name="folderFilterChoice" type="string"/>
        <attribute name="folderLink" type="string"/>
        <attribute name="xpathLoadContent" type="string"/>
        <attribute name="useInlineXML" type="boolean"/>
        <attribute name="xpathToIgnore" type="string"/>
        <attribute name="xpathError" type="string"/>
        <attribute name="xpathSchemaName" type="string"/>
        <attribute name="xpathComputeString" type="string"/>
        <attribute name="hideEditButtons" type="boolean"/>
        <attribute name="hideDownloadFileEdit" type="boolean"/>
        <attribute name="hideEditButtonsExpr" type="string"/>
        <attribute name="disableEditButtonsExpr" type="string"/>
        <attribute name="textAlignTooltip" type="boolean"/>
        <attribute name="textAlign" type="string"/>
        <attribute name="boldLineExpr" type="string"/>
        <attribute name="noSaveFilter" type="boolean"/>
        <attribute name="transaction" type="boolean"/>
        <attribute name="noSerialize" type="boolean"/>
        <attribute name="hideComboList" type="boolean"/>
        <attribute name="noEdition" type="boolean"/>
        <attribute name="addEmptyValue" type="string"/>
        <attribute name="disableEnabledIf" type="boolean"/>
        <attribute name="checkModify" type="boolean"/>
        <attribute name="noBorder" type="boolean"/>
        <attribute name="nextPage" type="string"/>
        <attribute localizable="true" name="nextButtonLabel" type="string"/>
        <attribute name="enabledButtonLabelIf" type="string"/>
        <attribute name="showAll" type="boolean"/>
        <attribute name="showXml" type="boolean"/>
        <attribute name="showMemo" type="boolean"/>
        <attribute name="showAdvancedMemo" type="boolean"/>
        <attribute name="firstActivatedIf" type="string"/>
        <attribute name="readOnlyIf" type="string"/>
        <attribute name="xpathWhere" type="string"/>
        <attribute name="alwaysActiveFirstPage" type="boolean"/>
        <attribute name="hideImage" type="boolean"/>
        <attribute name="noPropagateImg" type="boolean"/>
        <attribute name="fullLoad" type="boolean"/>
        <attribute name="noDefaultValue" type="boolean"/>
        <attribute name="xpathMandatory" type="string"/>
        <attribute name="mandatory" type="boolean"/>
        <attribute name="neverEmpty" type="boolean"/>
        <attribute name="xpathEditFromType" type="string"/>
        <attribute name="mode" type="string"/>
        <attribute name="writeAccess" type="boolean"/>
        <attribute name="noToolbar" type="boolean"/>
        <attribute name="multiSelectionActive" type="boolean"/>
        <attribute name="monoSelection" type="boolean"/>
        <attribute name="selectionPath" type="string"/>
        <attribute name="choicePath" type="string"/>
        <attribute name="keyName" type="string"/>
        <attribute name="keyPath" type="string"/>
        <attribute name="buttonClass" type="string"/>
        <attribute localizable="true" name="toolbarCaption" type="string"/>
        <attribute name="enumImg" type="string"/>
        <attribute name="toolbarAlign" type="string"/>
        <attribute name="noTransaction" type="boolean"/>
        <attribute name="noZoom" type="boolean"/>
        <attribute name="choiceButton" type="boolean"/>
        <attribute name="addButton" type="boolean"/>
        <attribute name="delButton" type="boolean"/>
        <attribute name="enableButtonIf" type="string"/>
        <attribute name="keepHiddenCols" type="boolean"/>
        <attribute name="loadEntityOnChange" type="boolean"/>
        <attribute name="loadLinkEntityOnChange" type="boolean"/>
        <attribute name="enableLoadLinkEntityOnChangeIf" type="boolean"/>
        <attribute name="newFromModelOnChange" type="boolean"/>
        <attribute name="setFormEditModeExpr" type="boolean"/>
        <attribute name="xpathToRemoveFromModel" type="string"/>
        <attribute name="linkEntityPath" type="string"/>
        <attribute name="defaultModel" type="string"/>
        <attribute name="defaultModelSearchExpr" type="string"/>
        <attribute name="defaultModelExpr" type="string"/>
        <attribute name="defaultModelXPath" type="string"/>
        <attribute name="wrap" type="boolean"/>
        <attribute name="noEditCollection" type="boolean"/>
        <attribute name="zoomOnAdd" type="boolean"/>
        <attribute name="noZoomOnAdd" type="boolean"/>
        <attribute name="choiceFormOnAdd" type="boolean"/>
        <attribute name="navTreeUnSelected" type="boolean"/>
        <attribute name="xpathFilterbyType" type="string"/>
        <attribute name="hideCheckButtonIf" type="string"/>
        <attribute name="selectAllOnStart" type="string"/>
        <attribute name="dblClickAction" type="string"/>
        <attribute name="clickAction" type="string"/>
        <attribute name="order" type="string"/>
        <attribute name="folderFilter" type="string"/>
        <attribute name="newEntityFormChoice" type="boolean"/>
        <attribute name="newEntityFormChoicePathList" type="string"/>
        <attribute name="fontBold" type="boolean"/>
        <attribute name="color" type="string"/>
        <attribute name="backcolor" type="string"/>
        <attribute localizable="true" name="promptDeleteLabel" type="string"/>
        <attribute localizable="true" name="promptStopLabel" type="string"/>
        <attribute name="setDefault" type="boolean"/>
        <attribute name="commandName" type="string"/>
        <attribute name="entitySchema" type="string"/>
        <attribute name="computeType" type="string"/>
        <attribute name="resourceSchema" type="string"/>
        <attribute name="addButtonResourceMenu" type="boolean"/>
        <attribute name="menuId" type="string"/>
        <attribute name="options" type="string"/>
        <attribute name="isIncludeView" type="boolean"/>
        <attribute name="externalKey" type="boolean"/>
        <attribute name="selectFirstFilter" type="boolean"/>
        <attribute name="xpathFilterList" type="string"/>
        <attribute name="disableFilter" type="boolean"/>
        <attribute name="uncollapseAllNodes" type="boolean"/>
        <attribute name="disableDefaultFilter" type="boolean"/>
        <attribute name="menuFilterList" type="string"/>
        <attribute name="action" type="string"/>
        <attribute name="xpathRecipientLink" type="string"/>
        <attribute name="notifyLinkPaths" type="string"/>
        <attribute desc="Default value computation expression. Updates the control as long as the user has not entered a value." name="exprDefault" type="string"/>
        <attribute name="exprDefaultAlwaysActive" type="boolean"/>
        <attribute name="exprDefaultXPath" type="string"/>
        <attribute desc="Number of decimal places to display" name="digitCount" type="long"/>
        <attribute desc="Minimum value" name="minValue" type="long"/>
        <attribute desc="Maximum value" name="maxValue" type="long"/>
        <element name="select" ref="xtk:queryDef:select" unbound="true"/>
        <element name="input" ref="input" unbound="true"/>
        <element name="command" ref="command" unbound="true"/>
        <element name="queryDef" ref="xtk:queryDef:queryDef"/>
        <element name="filter" ref="xtk:queryDef:filter"/>
        <element name="sysFilter" ref="xtk:queryDef:filter"/>
        <element name="form" ref="form" unbound="true"/>
        <element name="soapCall" ref="soapCall" unbound="true"/>
        <attribute name="prebuildSubForm" type="boolean"/>
        <attribute name="useTablePath" type="boolean"/>
        <attribute name="useLink11Path" type="boolean"/>
        <attribute name="xpathRefresh" type="string"/>
        <attribute name="xpathOutNbLines" type="string"/>
        <attribute name="xpathRefreshToInsertOrDelete" type="string"/>
        <attribute name="xpathsContext" type="string"/>
        <attribute name="exprsContext" type="string"/>
        <attribute name="valuesContext" type="string"/>
        <attribute name="discardReadOnly" type="boolean"/>
        <attribute name="needWriteAccess" type="boolean"/>
        <attribute name="showLink1N" type="string"/>
        <attribute name="xpathSchemaMd5" type="string"/>
        <element name="enter" ref="enrichContext"/>
        <element name="leave" ref="enrichContext"/>
        <attribute desc="Expression is evaluated even if the container to which it belongs is not visible." name="alwaysActive" type="boolean"/>
        <attribute localizable="true" name="translatedExpr" type="string"/>
        <attribute name="format" type="string"/>
        <attribute name="urlMode" type="boolean"/>
        <attribute name="setCurrentOnShow" type="boolean"/>
        <attribute name="xpath-label" type="string"/>
        <attribute desc="Disable the validity period tab of the schedule" name="disableValidityPage" type="boolean"/>
        <element name="container" ref="container" unbound="true"/>
        <attribute desc="Node folded by default" name="collapsed" type="boolean"/>
        <attribute name="visibleIf" type="string"/>
        <attribute desc="Label computation script for a collection element." name="exprLabel" type="string"/>
        <attribute desc="Expression calculating the help text displayed in the status bar for a node of a collection element." name="exprHelp" type="string"/>
        <attribute desc="Specify if the node value can change after the document has been loaded." name="dynamic" type="boolean"/>
        <attribute desc="Do not display images" name="noImage" type="boolean"/>
        <attribute name="colSize" type="short"/>
        <attribute name="enum" type="string"/>
        <attribute name="noInvalidErr" type="boolean"/>
        <attribute name="defaultIfInvalid" type="string"/>
        <attribute name="useDesc" type="boolean"/>
        <attribute name="wzNextOnDblClick" type="boolean"/>
        <attribute localizable="true" name="filters" type="string"/>
        <attribute name="defExt" type="string"/>
        <attribute name="xpathCopyName" type="string"/>
        <attribute desc="Path where the selected file size (in bytes) is written." name="xpathCopySize" type="string"/>
        <attribute name="xpathType" type="string"/>
        <attribute name="loadContent" type="boolean"/>
        <attribute name="dlgType" type="string"/>
        <attribute name="resetForm" type="boolean"/>
        <attribute name="hideFilterBtn" type="boolean"/>
        <attribute name="hideRefreshBtn" type="boolean"/>
        <attribute name="xpathFilterLabel" type="string"/>
        <attribute name="serialize" type="boolean"/>
        <attribute name="noAutoComplete" type="boolean"/>
        <attribute name="extraColumns" type="string"/>
        <attribute name="replaceEntityOnChange" type="boolean"/>
        <attribute name="accessWrite" type="boolean"/>
        <attribute name="enumImage" type="string"/>
        <attribute name="xpathId" type="string"/>
        <attribute name="xpathOut" type="string"/>
        <attribute name="xpathChoiceTarget" type="string"/>
        <attribute name="xpathObjectId" type="string"/>
        <attribute name="xpathObjectSchema" type="string"/>
        <attribute name="xpathObjectForm" type="string"/>
        <attribute name="propagateXPathToCtx" type="string"/>
        <attribute name="propagateXPathToCtxOnAdd" type="string"/>
        <attribute name="xpathConfig" type="string"/>
        <element name="orderBy" ref="xtk:queryDef:orderBy"/>
        <element name="node" unbound="true">
          <attribute name="xpath" type="string"/>
        </element>
        <attribute name="xpathFilter" type="string"/>
        <attribute name="xpathQueryLabel" type="string"/>
        <attribute desc="Disallow stacking more than one filter" name="noStacking" type="boolean"/>
        <attribute desc="Disables validation by double-click" name="noDblClickAction" type="boolean"/>
        <attribute name="mustHaveSelected" type="boolean"/>
        <attribute name="xpathOutId" type="string"/>
        <attribute name="xpathOutFN" type="string"/>
        <attribute name="xpathOutFN2" type="string"/>
        <attribute name="xpathOutCS" type="string"/>
        <attribute localizable="true" name="exprOutCS" type="string"/>
        <attribute name="setOnClick" type="boolean"/>
        <attribute name="xpathNodeFullName" type="string"/>
        <attribute name="crypt" type="boolean"/>
        <attribute name="reversible" type="boolean"/>
        <attribute desc="Encrypts the password with the server key" name="serverPassword" type="boolean"/>
        <attribute desc="Menu uses a template (inserts '&lt;%' and '%>' tags)" name="jst" type="boolean"/>
        <attribute name="xpathCalcFields" type="string"/>
        <attribute desc="Expression used to determine whether the edited script is a template." name="isJstExpr" type="string"/>
        <attribute desc="Indicates if the menu must be recomputed each time the form is opened." name="dynamicMenu" type="boolean"/>
        <attribute desc="Path where definition of exported 1..n links are stored." name="xpathCondLinks" type="string"/>
        <attribute name="xpathDataSourceConfig" type="string"/>
        <attribute name="xpathCalculatedFields" type="string"/>
        <attribute name="xpathMapping" type="string"/>
        <attribute name="xpathRejectId" type="string"/>
        <attribute name="xpathLogField" type="string"/>
        <attribute name="xpathAutoDetect" type="string"/>
        <attribute name="xpathUploadFile" type="string"/>
        <attribute name="xpathLastParsed" type="string"/>
        <attribute name="xpathCalcFieldResult" type="string"/>
        <attribute name="xpathCalcFieldName" type="string"/>
        <attribute name="xpathCalcFieldLogs" type="string"/>
        <attribute name="importList" type="boolean"/>
        <attribute desc="Display the preview of an export calculated field." name="calcFieldMode" type="boolean"/>
        <attribute desc="Path where errors for the selected line are written." name="xpathErrorLogs" type="string"/>
        <attribute name="xpathColumns" type="string"/>
        <attribute name="xpathCalcField" type="string"/>
        <attribute name="prefixPath" type="string"/>
        <attribute name="prefixPathExpr" type="string"/>
        <attribute name="xpathFormat" type="string"/>
        <attribute name="xpathTmp" type="string"/>
        <attribute name="subxpathIndex" type="string"/>
        <attribute name="subxpathDisplay" type="string"/>
        <attribute name="subxpathMaykey" type="string"/>
        <attribute name="subxpathKeys" type="string"/>
        <attribute name="subxpathSourceField" type="string"/>
        <attribute name="checkedValue" type="string"/>
        <attribute name="unCheckedValue" type="string"/>
        <attribute name="xpathRef" type="string"/>
        <attribute name="uniqueInParent" type="boolean"/>
        <attribute name="uniqueAlsoInXPath" type="string"/>
        <attribute name="xpathIndex" type="string"/>
        <attribute name="xpathHelp" type="string"/>
        <attribute name="xpathFilterByTypes" type="string"/>
        <attribute name="xpathLastSelection" type="string"/>
        <attribute name="xpathShowLink1N" type="string"/>
        <attribute name="useUnboundPath" type="boolean"/>
        <attribute name="hideUnboundPath" type="boolean"/>
        <attribute name="hideMappedAsXml" type="boolean"/>
        <attribute name="removeNodupPath" type="string"/>
        <attribute name="hideCalculated" type="boolean"/>
        <attribute name="hideLinks" type="boolean"/>
        <attribute name="hideMainFilters" type="boolean"/>
        <attribute name="hideFormFilters" type="boolean"/>
        <attribute name="showLinks1" type="boolean"/>
        <attribute name="showCollections" type="boolean"/>
        <attribute name="choiceType" type="string"/>
        <attribute name="xpathChoiceType" type="string"/>
        <attribute name="xpathHideMappedAsXml" type="string"/>
        <attribute name="xpathHideCalculated" type="string"/>
        <attribute name="xpathUseTablePath" type="string"/>
        <attribute name="xpathSchemaData" type="string"/>
        <attribute name="checkDuplicates" type="boolean"/>
        <attribute name="xpathUseAEM" type="string"/>
        <attribute name="xpathSchemaForm" type="string"/>
        <attribute name="xpathName" type="string"/>
        <attribute name="sqlObjType" type="string"/>
        <attribute name="xpathSqlParent" type="string"/>
        <attribute name="xpathSqlParentName" type="string"/>
        <attribute name="xpathNextRun" type="string"/>
        <attribute name="htmlMode" type="boolean"/>
        <attribute name="bodyMode" type="boolean"/>
        <attribute name="bodyModeExpr" type="string"/>
        <attribute name="viewSourceBtn" type="boolean"/>
        <attribute name="fullToolbar" type="boolean"/>
        <attribute name="uploadImages" type="boolean"/>
        <attribute name="localImages" type="boolean"/>
        <attribute name="xpathImageConfig" type="boolean"/>
        <attribute name="xpathInsert" type="string"/>
        <attribute name="xpathUrl" type="string"/>
        <attribute name="xpathSelectCode" type="string"/>
        <attribute name="xpathTidy" type="string"/>
        <attribute name="refBtn" type="string"/>
        <attribute name="flatMode" type="boolean"/>
        <attribute name="xpathSelection" type="string"/>
        <attribute name="xpathSelectionType" type="string"/>
        <attribute name="xpathToolbarHierarchy" type="string"/>
        <attribute name="disableRootMenu" type="boolean"/>
        <attribute name="width" type="short"/>
        <attribute name="insertAfter" type="string"/>
        <attribute desc="Display recipient fields in the menu" name="recipientFields" type="boolean"/>
        <attribute desc="Temporary path specifying if HTML specific commands must be displayed." name="xpathHtmlMode" type="string"/>
        <attribute name="xpathNotif" type="string"/>
        <attribute name="xpathZoomSchema" type="string"/>
        <attribute name="xpathZoomStartPath" type="string"/>
        <attribute name="xpathInsertLabel" type="string"/>
        <attribute name="expr" type="string"/>
        <attribute name="startSchema" type="string"/>
        <attribute name="xpathTargetPart" type="string"/>
        <attribute name="xpathSqlRequest" type="string"/>
        <attribute name="xpathParams" type="string"/>
        <attribute name="xpathEntityId" type="string"/>
        <attribute name="xpathPreviewCtx" type="string"/>
        <attribute desc="Path where information loaded for the recipient preview is written." name="xpathRcpQuery" type="string"/>
        <attribute desc="Name of the toolbar in the parent container." name="toolbarName" type="string"/>
        <attribute desc="Path used to find the delivery target parts definition to display them in the recipient selection menu." name="xpathTargets" type="string"/>
        <attribute name="xpathTargetSchema" type="string"/>
        <attribute desc="Path of the control containing the definitions of the forms used to select a recipient in a target." name="refForForms" type="string"/>
        <attribute name="xpathFile" type="string"/>
        <attribute name="saveBefore" type="boolean"/>
        <attribute name="executeCmdName" type="boolean"/>
        <attribute localizable="true" name="promptLabel" type="string"/>
        <attribute name="xpathLabel" type="string"/>
        <attribute desc="Data type." name="xpathBaseType" type="string"/>
        <attribute desc="Associated enumeration" name="xpathEnum" type="string"/>
        <attribute desc="Associated user enumeration." name="xpathUserEnum" type="string"/>
        <attribute desc="'Unbound' property of the field." name="xpathUnbound" type="string"/>
        <attribute desc="Field 'DataPolicy' property." name="xpathDataPolicy" type="string"/>
        <attribute name="xpathAlias" type="string"/>
        <attribute name="xpathDynamicSchema" type="string"/>
        <attribute name="xpathDynamicType" type="string"/>
        <attribute name="nsEditXPath" type="string"/>
        <attribute name="editFileXPath" type="string"/>
        <attribute name="enabledIf" type="string"/>
        <attribute name="width-percent" type="short"/>
        <attribute name="height-percent" type="short"/>
        <attribute desc="Path of the property storing the selected activity" name="xpathSelectedActivity" type="string"/>
        <attribute desc="Path storing the visibility (true/false) of the workflow palette" name="xpathHidePalette" type="string"/>
        <attribute desc="Path containing the calculation expression of the start button image" name="xpathStartButtonImg" type="string"/>
        <attribute desc="XPath containing the calculation expression for the name of the start button" name="xpathStartButtonCmd" type="string"/>
        <attribute desc="XPath containing the expression to enable the start button" name="xpathStartButtonEnable" type="string"/>
        <attribute desc="Path of the list of source columns" name="xpathSource" type="string"/>
        <attribute name="urlExpr" type="string"/>
        <attribute name="sessionToken" type="boolean"/>
        <attribute name="postXPath" type="string"/>
        <attribute name="utf8EncodePostXPath" type="boolean"/>
        <attribute name="forceNavigate" type="string"/>
        <attribute name="entityRefresh" type="string"/>
        <attribute name="addSelectionInPost" type="boolean"/>
        <attribute name="imgExpr" type="string"/>
        <attribute name="labelExpr" type="string"/>
        <attribute name="filename" type="string"/>
        <attribute name="xslt" type="string"/>
        <attribute name="xpathXslt" type="string"/>
        <attribute desc="XML file containing language-dependent strings." name="strings" type="string"/>
        <attribute name="xpathJSTMenu" type="string"/>
        <attribute name="typeJSTMenu" type="string"/>
        <attribute name="xpath-link" type="string"/>
        <attribute name="allowNone" type="boolean"/>
        <attribute name="optional" type="string"/>
        <attribute name="enumXPath" type="string"/>
        <attribute name="checkSiblingNodes" type="string"/>
        <attribute desc="global, selection, folder or filter" name="context" type="string"/>
        <attribute desc="Displays a single report only" name="monoReport" type="boolean"/>
        <attribute desc="Target context of the report" name="reportContext" type="string"/>
        <attribute name="refSchema" type="string"/>
        <attribute name="xpathRefSchema" type="string"/>
        <attribute name="xpathWhereCond" type="string"/>
        <attribute name="locationName" type="string"/>
        <attribute desc="does not display the browser bar in the console" name="noNavigation" type="boolean"/>
        <element name="xcopy" ref="xcopy" unbound="true"/>
        <element name="menu" ref="menu" unbound="true"/>
        <attribute name="exprContent" type="string"/>
        <attribute name="exprFormat" type="string"/>
        <attribute name="filter" type="string"/>
        <attribute name="collection" type="string"/>
        <attribute name="xpathMultipart" type="string"/>
        <attribute name="processExprParams" type="boolean"/>
        <attribute name="recurse" type="boolean"/>
        <attribute name="xpathTimeZone" type="string"/>
      </element>
      <element name="action">
        <attribute name="action" type="string"/>
        <attribute name="type" type="string"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute name="href" type="string"/>
        <attribute name="img" type="string"/>
        <attribute enum="align" name="align" type="string"/>
        <attribute name="target" type="string"/>
        <attribute name="width" type="short"/>
      </element>
      <element name="img">
        <key name="img">
          <keyfield xpath="@pk"/>
        </key>
        <attribute name="pk" type="string"/>
        <attribute name="valign" type="string"/>
        <attribute name="align" type="string"/>
      </element>
      <element name="reset">
        <attribute name="xpath" type="string"/>
        <attribute name="delete" type="boolean"/>
        <attribute name="expr" type="string"/>
      </element>
      <element name="refresh">
        <attribute name="xpath" type="string"/>
      </element>
      <element name="param">
        <attribute name="name" type="string"/>
        <attribute name="xpath" type="string"/>
        <attribute name="type" type="string"/>
        <attribute name="inout" type="string"/>
        <attribute name="default" type="string"/>
        <attribute name="exprIn" type="string"/>
        <attribute name="xpathOut" type="string"/>
      </element>
      <element name="if">
        <attribute name="expr" type="string"/>
        <element name="forEach" ref="if" unbound="true"/>
        <attribute name="xpath" type="string"/>
        <element name="set" ref="set" unbound="true"/>
        <element name="copyElement" ref="copyElement" unbound="true"/>
        <element name="xcopy" ref="xcopy" unbound="true"/>
        <element name="soapCall" ref="soapCall" unbound="true"/>
        <element name="if" ref="if" unbound="true"/>
        <element name="switch" ref="switch" unbound="true"/>
        <element name="check" ref="check" unbound="true"/>
        <element name="saveView" unbound="true"/>
        <element name="closeForm" ref="closeForm" unbound="true"/>
        <element name="msgBox" ref="msgBox" unbound="true"/>
        <element name="reset" ref="reset" unbound="true"/>
        <element name="refresh" ref="refresh" unbound="true"/>
        <element name="setClean" unbound="true"/>
        <element name="setModified" unbound="true"/>
        <element name="checkModified" unbound="true"/>
        <element name="discardReadOnly" unbound="true"/>
        <element name="setNotifySaved" ref="setNotifySaved" unbound="true"/>
        <element name="urlCall" ref="urlCall"/>
        <element name="reload" unbound="true"/>
      </element>
      <element name="switch">
        <element name="case" ref="if" unbound="true"/>
        <element name="default" ref="enrichContext"/>
      </element>
      <element desc="Document context modification expression (referenced from enter, if, switch/case...)" name="enrichContext">
        <attribute name="name" type="string"/>
        <attribute name="applicableIf" type="string"/>
        <attribute name="ref" type="string"/>
        <attribute localizable="true" name="onSuccess" type="string"/>
        <element name="set" ref="set" unbound="true"/>
        <element name="copyElement" ref="copyElement" unbound="true"/>
        <element name="xcopy" ref="xcopy" unbound="true"/>
        <element name="soapCall" ref="soapCall" unbound="true"/>
        <element name="setSchema" ref="setSchema" unbound="true"/>
        <element name="if" ref="if" unbound="true"/>
        <element name="forEach" ref="if" unbound="true"/>
        <element name="switch" ref="switch" unbound="true"/>
        <element name="check" ref="check" unbound="true"/>
        <element name="saveView" unbound="true"/>
        <element name="closeForm" ref="closeForm" unbound="true"/>
        <element name="msgBox" ref="msgBox" unbound="true"/>
        <element name="reset" ref="reset" unbound="true"/>
        <element name="refresh" ref="refresh" unbound="true"/>
        <element name="setClean" unbound="true"/>
        <element name="setModified" unbound="true"/>
        <element name="checkModified" unbound="true"/>
        <element name="discardReadOnly" unbound="true"/>
        <element name="setNotifySaved" ref="setNotifySaved" unbound="true"/>
        <element name="urlCall" ref="urlCall"/>
        <element name="reload" unbound="true"/>
      </element>
      <element name="value">
        <attribute name="xpath" type="string"/>
        <attribute name="nolabel" type="boolean"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute name="style" type="string"/>
        <attribute name="type" type="string"/>
        <attribute name="name" type="string"/>
        <attribute name="visibleIf" type="string"/>
        <attribute name="expr" type="string"/>
        <attribute localizable="true" name="translatedExpr" type="string"/>
        <attribute name="colspan" type="short"/>
        <attribute name="rowspan" type="short"/>
        <attribute name="valign" type="string"/>
        <attribute name="align" type="string"/>
        <attribute name="dataType" type="string"/>
        <attribute name="width" type="short"/>
        <attribute name="height" type="long"/>
        <attribute name="enum" type="string"/>
        <attribute name="bold" type="boolean"/>
        <attribute name="margin-top" type="string"/>
        <attribute name="margin-bottom" type="string"/>
        <attribute name="margin-left" type="string"/>
        <attribute name="margin-right" type="string"/>
        <attribute name="margin" type="string"/>
        <attribute name="fontBold" type="boolean"/>
        <attribute name="color" type="string"/>
        <attribute name="backcolor" type="string"/>
        <attribute desc="Path used to write the current progression value" name="xpathCur" type="string"/>
        <attribute desc="Path used to write the maximum progression value" name="xpathMax" type="string"/>
        <attribute desc="Path used to write the elapsed time since the progression start (if specified)" name="xpathElapsed" type="string"/>
        <attribute desc="Path used to write the estimated remaining time (if specified)" name="xpathRemaining" type="string"/>
        <attribute name="hidden" type="boolean"/>
        <attribute name="format" type="string"/>
        <attribute name="sum" type="string"/>
        <attribute name="alias" type="string"/>
        <attribute name="prefix" type="string"/>
        <attribute name="suffix" type="string"/>
        <attribute name="noXmlEscaping" type="boolean"/>
      </element>
      <element name="check">
        <attribute name="expr" type="string"/>
        <element localizable="true" name="error" type="string"/>
        <attribute localizable="true" name="error" type="string"/>
      </element>
      <element name="msgBox">
        <attribute name="expr" type="string"/>
        <attribute name="xpathOut" type="string"/>
        <attribute name="type" type="string"/>
        <attribute localizable="true" name="translatedExpr" type="string"/>
        <attribute name="focusOn" type="string"/>
      </element>
      <element name="setNotifySaved">
        <attribute name="schema" type="string"/>
      </element>
      <element name="container">
        <attribute name="colcount" type="short"/>
        <attribute name="rowcount" type="short"/>
        <attribute name="col-width" type="string"/>
        <attribute name="cols-width" type="string"/>
        <attribute name="width" type="short"/>
        <attribute name="cellspacing" type="short"/>
        <attribute name="colspan" type="short"/>
        <attribute name="rowspan" type="short"/>
        <attribute name="style" type="string"/>
        <attribute name="type" type="string"/>
        <attribute name="align" type="string"/>
        <attribute name="valign" type="string"/>
        <attribute name="name" type="string"/>
        <attribute name="xpath" type="string"/>
        <attribute localizable="true" name="title" type="string"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute localizable="true" name="desc" type="string"/>
        <attribute name="cellpadding" type="short"/>
        <attribute name="padding-left" type="short"/>
        <attribute name="padding-right" type="short"/>
        <attribute name="padding-top" type="short"/>
        <attribute name="padding-bottom" type="short"/>
        <attribute name="padding" type="short"/>
        <attribute name="group" type="string"/>
        <attribute name="input" type="string"/>
        <attribute name="xpath-input" type="string"/>
        <attribute name="test-value" type="string"/>
        <attribute name="hide" type="boolean"/>
        <attribute name="img" type="string"/>
        <attribute name="height" type="string"/>
        <attribute name="text-align" type="string"/>
        <attribute name="border-width" type="string"/>
        <attribute name="background-color" type="string"/>
        <attribute name="nolabel" type="boolean"/>
        <attribute name="sharedUserConfig" type="boolean"/>
        <attribute desc="User configuration XPath of control (relative to parent control, uses the name of the control if not specified)." name="userConfigPath" type="string"/>
        <attribute name="schema" type="string"/>
        <attribute name="maxLabelWidth" type="short"/>
        <attribute name="xpathsToLoad" type="string"/>
        <attribute name="xpathsToLoadCus" type="string"/>
        <attribute name="xpathsToLoadOpt" type="string"/>
        <attribute name="namespace" type="string"/>
        <attribute name="hideEditButtons" type="boolean"/>
        <attribute name="checkModify" type="boolean"/>
        <attribute name="folderModel" type="string"/>
        <attribute name="access" type="string"/>
        <attribute name="backcolor" type="string"/>
        <attribute name="margin-top" type="string"/>
        <attribute name="margin-bottom" type="string"/>
        <attribute name="margin-left" type="string"/>
        <attribute name="margin-right" type="string"/>
        <attribute name="margin" type="string"/>
        <attribute name="width-percent" type="short"/>
        <attribute name="height-percent" type="short"/>
        <attribute name="vertSpacing" type="short"/>
        <attribute name="horzSpacing" type="short"/>
        <attribute name="font-size" type="string"/>
        <attribute name="grid" type="boolean"/>
        <attribute name="readOnly" type="boolean"/>
        <attribute desc="read-only access if operator does not have the specified right" name="readOnlyAccess" type="string"/>
        <attribute desc="If expression is true during initial load, all the child controlsare displayed in read-only mode" name="readOnlyExpr" type="string" xml="true"/>
        <attribute name="required" type="boolean"/>
        <attribute name="xpath-label" type="string"/>
        <attribute localizable="true" name="toolbarCaption" type="string"/>
        <attribute name="toolbarAlign" type="string"/>
        <attribute name="propagateConstraints" type="boolean"/>
        <attribute name="ref" type="string"/>
        <attribute name="applicableIf" type="string"/>
        <attribute name="visibleIf" type="string"/>
        <attribute name="enabledIf" type="string"/>
        <attribute name="firstActivatedIf" type="string"/>
        <attribute name="activatedIf" type="string"/>
        <attribute name="readOnlyIf" type="string"/>
        <attribute name="showIconsIf" type="string"/>
        <attribute name="notifyPathList" type="string"/>
        <attribute name="propagateXPathToCtxOnAdd" type="string"/>
        <attribute name="xpathValue" type="string"/>
        <attribute name="visibleValue" type="string"/>
        <attribute name="xpathCheck" type="string"/>
        <attribute name="alwaysActive" type="boolean"/>
        <attribute name="xpathIndex" type="string"/>
        <attribute name="xpathSelection" type="string"/>
        <attribute name="xpathSelectionType" type="string"/>
        <attribute name="filter" type="string"/>
        <attribute name="methodName" type="string"/>
        <attribute name="refreshPeriod" type="long"/>
        <attribute desc="Path used to write the job status (if not specified, does not update status)" name="xpathStatus" type="string"/>
        <attribute desc="Path where indicators gathered when querying the server on the job progress are written" name="xpathProperties" type="string"/>
        <attribute name="askConfirmation" type="boolean"/>
        <attribute name="formKeyPath" type="string"/>
        <attribute name="formSchemaPath" type="string"/>
        <attribute name="xpathImageConfig" type="boolean"/>
        <attribute name="xpathSourceName" type="string"/>
        <attribute name="xpathDestName" type="string"/>
        <attribute desc="Path used to write the current progression value (for file download/upload)" name="xpathCurProgress" type="string"/>
        <attribute desc="Path used to write the maximum progression value (for file download/upload)" name="xpathMaxProgress" type="string"/>
        <attribute name="getFileNameFromProp" type="boolean"/>
        <attribute name="xpathMethodName" type="string"/>
        <attribute name="onlyDownloadMode" type="boolean"/>
        <attribute desc="Path where the local file name to upload is saved" name="xpathFile" type="string"/>
        <attribute desc="Expression computing the file transfer type (true for an upload, false for a download)" name="exprTransferType" type="string"/>
        <attribute desc="Use the MD5 hash as resource key (otherwise use the internal identifier)" name="keyIsMd5" type="boolean"/>
        <attribute desc="List of XPaths where the key of the resource uploaded on the server is written." name="xpathOutList" type="string"/>
        <attribute name="xpathNotResTable" type="string"/>
        <attribute desc="Do not add the resource to the database." name="notResTable" type="boolean"/>
        <attribute desc="Execute a SOAP call" name="noJobSubmit" type="boolean"/>
        <attribute desc="'upload' or 'download'" name="transferType" type="string"/>
        <attribute desc="Storage type (cf. enumeration xtk:fileRes:storageType)" name="storageType" type="string"/>
        <attribute desc="Automatically start transfer" name="autoStart" type="boolean"/>
        <attribute desc="Display the log list in case of error only" name="showLogOnError" type="boolean"/>
        <attribute desc="Default character encoding for the resource (if empty, the encoding is detected automatically)" name="codepage" template="xtk:common:codepage"/>
        <attribute desc="Allow file update (for upload)." name="allowUpdate" type="boolean"/>
        <attribute desc="Warns when uploading if an existing field will be overwritten (download only)." name="checkOverwrite" type="boolean"/>
        <attribute desc="The file selection widget will by default use the local name of the original file." name="setOriginalAsDefault" type="boolean"/>
        <attribute desc="XPath of the MD5 hash of the content" name="xpathMd5" type="string"/>
        <attribute desc="XPath containing the size of the contents" name="xpathSize" type="string"/>
        <attribute desc="Path containing the contentType" name="xpathContentType" type="string"/>
        <attribute desc="Path containing the encoding used" name="xpathCodepage" type="string"/>
        <attribute desc="XPath containing the name of the file used for the upload" name="xpathOriginal" type="string"/>
        <attribute desc="XPath containing the file name in the working directory" name="xpathServerName" type="string"/>
        <attribute desc="XPath of the storage type used by the uploaded file" name="xpathStorageType" type="string"/>
        <attribute name="xpathElement" type="string"/>
        <attribute desc="Display transfer logs" name="showList" type="boolean"/>
        <attribute desc="Display progress bar" name="showProgress" type="boolean"/>
        <attribute desc="Display time elapsed and estimated time remaining" name="showElapsed" type="boolean"/>
        <attribute desc="Display help text" name="showHelp" type="boolean"/>
        <attribute desc="Display the file name in the working directory" name="showServerName" type="boolean"/>
        <attribute desc="Display the previous file name (read only)" name="showPreviousName" type="boolean"/>
        <attribute desc="Display advanced parameters" name="showAdvanced" type="boolean"/>
        <element desc="Actions to perform once transfer is complete" name="onTransferComplete" ref="enrichContext"/>
        <attribute desc="Form used to edit the target entity" name="editFormTarget" type="string"/>
        <attribute desc="Form used to create the target entity" name="newFormTarget" type="string"/>
        <attribute desc="Label of the target edit menu" localizable="true" name="targetMenuLabel" type="string"/>
        <attribute name="zoom" type="boolean"/>
        <attribute name="zoomOnAdd" type="boolean"/>
        <attribute name="noTabs" type="boolean"/>
        <attribute name="noToolbar" type="boolean"/>
        <attribute name="xpathRefresh" type="string"/>
        <attribute name="defaultColumns" type="string"/>
        <attribute name="filterEditField" type="string"/>
        <attribute name="nodeModel" type="string"/>
        <attribute name="xpathOut1" type="string"/>
        <attribute localizable="true" name="exprOut1" type="string"/>
        <attribute name="xpathOut2" type="string"/>
        <attribute localizable="true" name="exprOut2" type="string"/>
        <attribute name="xpathOut3" type="string"/>
        <attribute localizable="true" name="exprOut3" type="string"/>
        <attribute name="xpathOut4" type="string"/>
        <attribute localizable="true" name="exprOut4" type="string"/>
        <attribute name="xpathOut5" type="string"/>
        <attribute name="exprOut5" type="string"/>
        <attribute name="xpathFolder" type="string"/>
        <attribute name="dblClickAction" type="string"/>
        <attribute name="setOnClick" type="boolean"/>
        <attribute name="newEntityFormChoice" type="boolean"/>
        <attribute name="multiSelection" type="boolean"/>
        <attribute name="dataType" type="byte"/>
        <attribute desc="Node folded by default" name="collapsed" type="boolean"/>
        <attribute name="xpathFilesToDownload" type="string"/>
        <attribute desc="Add option 'Do not interpret memo'" name="allowUnexpandMemo" type="boolean"/>
        <attribute desc="Add 'Handle groupings' option" name="allowGroupBy" type="boolean"/>
        <attribute desc="Add option 'Distinct results'" name="allowDistinct" type="boolean"/>
        <attribute desc="Do not display one to many relations." name="hideUnboundPath" type="boolean"/>
        <attribute name="showCollections" type="boolean"/>
        <attribute name="extraColumns" type="string"/>
        <attribute desc="Overload the type of output field list." name="columnListType" type="string"/>
        <attribute name="xpathName" type="string"/>
        <attribute name="xpathOut" type="string"/>
        <attribute name="objectName" type="string"/>
        <attribute desc="In this mode, each notebook page represents the preview of a content of the delivery." name="onlyPreview" type="boolean"/>
        <attribute name="prepareRights" type="string"/>
        <attribute name="validateRights" type="string"/>
        <attribute name="buildQueryXPath" type="string"/>
        <attribute name="menuId" type="string"/>
        <attribute name="isIncludeView" type="boolean"/>
        <attribute name="addSchemaMenu" type="string"/>
        <attribute name="addSchemaMenuXPath" type="string"/>
        <attribute name="autoAddForms" type="string"/>
        <attribute name="prefix" type="string"/>
        <attribute name="isE4X" type="boolean"/>
        <attribute name="xpathAutoDetect" type="string"/>
        <attribute name="xpathLastParsed" type="string"/>
        <attribute name="xpathUploadFile" type="string"/>
        <attribute name="reloadConfig" type="boolean"/>
        <attribute name="noReentrant" type="boolean"/>
        <attribute name="importList" type="boolean"/>
        <attribute name="modeSource" type="string"/>
        <element name="form" ref="form"/>
        <attribute name="useUnboundPath" type="boolean"/>
        <attribute name="enabledButtonLabelIf" type="string"/>
        <attribute localizable="true" name="nextButtonLabel" type="string"/>
        <attribute name="nextButtonImg" type="string"/>
        <attribute localizable="true" name="prevButtonLabel" type="string"/>
        <attribute name="prevButtonImg" type="string"/>
        <attribute name="nextPage" type="string"/>
        <attribute name="alwaysActiveFirstPage" type="boolean"/>
        <element name="static" ref="static" unbound="true"/>
        <element name="input" ref="input" unbound="true"/>
        <element name="action" ref="action"/>
        <element name="if" ref="if" unbound="true"/>
        <element name="switch" ref="switch" unbound="true"/>
        <element name="value" ref="value" unbound="true"/>
        <element name="img" ref="img" unbound="true"/>
        <element name="container" ref="container" unbound="true"/>
        <element name="enter" ref="enrichContext"/>
        <element name="leave" ref="enrichContext"/>
        <element name="set" ref="set" unbound="true"/>
        <element name="copyElement" ref="copyElement" unbound="true"/>
        <element name="xcopy" ref="xcopy" unbound="true"/>
        <element name="soapCall" ref="soapCall" unbound="true"/>
        <element name="sysFilter" ref="xtk:queryDef:filter"/>
        <attribute localizable="true" name="titleExpr" type="string"/>
        <attribute localizable="true" name="descExpr" type="string"/>
        <attribute name="xpathId" type="string"/>
        <attribute name="propagateXPathToCtx" type="string"/>
        <attribute name="form" type="string"/>
        <attribute name="prebuildSubForm" type="boolean"/>
        <attribute name="collection" type="string"/>
        <attribute name="xpathEnum" type="string"/>
      </element>
      <element name="soapCall">
        <attribute name="name" type="string"/>
        <attribute name="service" type="string"/>
        <attribute name="encoding" type="string"/>
        <attribute label="Do not refresh observers after the call completes" name="noRefresh" type="boolean"/>
        <element name="param" ref="param" unbound="true"/>
      </element>
      <element name="urlCall">
        <attribute name="method" type="string"/>
        <attribute name="url" type="string"/>
        <attribute name="xpathOut" type="string"/>
        <element name="param" ref="param" unbound="true"/>
      </element>
      <element dataSource="file" doesNotSupportDiff="true" img="xtk:form.png" name="form" pkgPlatform="data!=''" sqltable="XtkEntity">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key name="id">
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <key name="name">
          <keyfield xpath="@entitySchema"/>
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <dbindex name="modifiedById">
          <keyfield xpath="@modifiedBy-id"/>
        </dbindex>
        <dbindex name="createdById">
          <keyfield xpath="@createdBy-id"/>
        </dbindex>
        <compute-string expr="@label + ' (' + @namespace + ')'"/>
        <attribute name="applicableIf" type="string"/>
        <attribute default="DefaultNameSpace()" label="Namespace" length="16" name="namespace" required="true" sqlname="sNamespace" type="string" xml="true"/>
        <attribute default="NewName()" edit="NamePkEdit" label="Name" length="80" name="name" required="true" sqlname="sName" type="string" xml="true"/>
        <attribute desc="Entity schema" label="Schema" length="80" name="entitySchema" sqlname="sEntitySchema" type="string"/>
        <attribute default="'xtk:form.png'" label="Entity image" length="80" name="img" sqlname="sImg" type="string"/>
        <element default="CurrentUser()" label="Created by" name="createdBy" target="xtk:operator" type="link">
          <join xpath-dst="@id" xpath-src="@createdBy-id"/>
        </element>
        <attribute label="Foreign key of link 'Created by' ('id' field)" name="createdBy-id" sqlname="iCreatedById" type="long"/>
        <element label="Modified by" name="modifiedBy" target="xtk:operator" type="link">
          <join xpath-dst="@id" xpath-src="@modifiedBy-id"/>
        </element>
        <attribute label="Foreign key of link 'Modified by' ('id' field)" name="modifiedBy-id" sqlname="iModifiedById" type="long"/>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" sqlname="tsCreated" type="datetime"/>
        <attribute desc="Modification date" label="Last modified" name="lastModified" sqlname="tsLastModified" type="datetime"/>
        <element label="Entity content" name="data" sqlname="mData" type="memo"/>
        <attribute advanced="true" desc="MD5 key of the content of the entity" label="MD5 key" length="32" name="md5" pkgStatus="never" sqlname="sMd5" type="string"/>
        <attribute label="Description" localizable="true" name="desc" type="string" xml="true"/>
        <attribute name="xtkschema" type="string" xml="true"/>
        <attribute label="Label" length="128" localizable="true" name="label" sqlname="sLabel" type="string"/>
        <attribute label="Background image to present the detail" name="background" type="string" xml="true"/>
        <attribute desc="Decoration type for the edit window: 'form' (add a menu and a toolbar) or 'dialog' (add OK/Cancel or Save/Close buttons)" label="Decoration type" name="editionMode" type="string" xml="true"/>
        <attribute name="decorate" type="boolean" xml="true"/>
        <attribute name="mode" type="string" xml="true"/>
        <attribute name="entity-schema" type="string" xml="true"/>
        <attribute name="entity-binding" type="string" xml="true"/>
        <attribute name="anonymous" type="boolean" xml="true"/>
        <attribute name="colcount" type="short" xml="true"/>
        <attribute name="rowcount" type="short" xml="true"/>
        <attribute enum="type" name="type" type="string" xml="true"/>
        <attribute name="xpath" type="string" xml="true"/>
        <attribute name="screen" type="string" xml="true"/>
        <attribute name="_decorated" type="boolean" xml="true"/>
        <attribute name="blankBorder" type="boolean" xml="true"/>
        <attribute name="style" type="string" xml="true"/>
        <attribute name="nothingToSave" type="boolean" xml="true"/>
        <attribute name="nothingToSaveExpr" type="string" xml="true"/>
        <attribute name="nothingToEdit" type="boolean" xml="true"/>
        <attribute name="noNewInstance" type="boolean" xml="true"/>
        <attribute localizable="true" name="leftButtonType" type="string" xml="true"/>
        <attribute localizable="true" name="saveButtonLabel" type="string" xml="true"/>
        <attribute name="maxLabelWidth" type="short"/>
        <attribute desc="If expression is true during initial load, the form is displayed in read-only mode" name="readOnlyExpr" type="string" xml="true"/>
        <attribute desc="read-only access if operator does not have the specified right" name="readOnlyAccess" type="string"/>
        <attribute name="xpathsToLoad" type="string"/>
        <attribute name="xpathsToLoadOpt" type="string"/>
        <attribute name="xpathsToLoadCus" type="string"/>
        <attribute name="alwaysActiveFirstPage" type="boolean"/>
        <attribute name="forceToSaveEntity" type="boolean"/>
        <attribute name="closeOnCancel" type="boolean"/>
        <attribute name="showIconsIf" type="string"/>
        <attribute name="disableExplicitSave" type="boolean"/>
        <attribute name="margin-top" type="string"/>
        <attribute name="margin-bottom" type="string"/>
        <attribute name="margin-left" type="string"/>
        <attribute name="margin-right" type="string"/>
        <attribute name="margin" type="string"/>
        <attribute name="ref" type="string"/>
        <element name="enter" ref="enrichContext" xml="true"/>
        <element name="leave" ref="enrichContext" xml="true"/>
        <element name="postSave" ref="enrichContext" xml="true"/>
        <attribute localizable="true" name="title" type="string"/>
        <element name="container" ref="container" unbound="true" xml="true"/>
        <element name="input" ref="input" unbound="true" xml="true"/>
        <element name="set" ref="set" unbound="true" xml="true"/>
        <element name="copyElement" ref="copyElement" unbound="true"/>
        <element name="xcopy" ref="xcopy" unbound="true"/>
        <element name="if" ref="if" unbound="true" xml="true"/>
        <element name="switch" ref="switch" unbound="true"/>
        <element name="static" ref="static" unbound="true" xml="true"/>
        <element name="action" ref="action" unbound="true"/>
        <element name="value" ref="value" xml="true"/>
        <element name="form" ref="form"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="xtk:formrendering.png" implements="xtk:persist" label="Form rendering" labelSingular="Form rendering" name="formRendering" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="header" label="Logo position" name="logoPosition">
        <value label="Hidden" name="hidden" value="0"/>
        <value label="In the header" name="header" value="1"/>
        <value label="In the page" name="page" value="2"/>
        <value label="Outside the page" name="body" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="body" label="Element disposition" name="position">
        <value label="Hidden" name="hidden" value="0"/>
        <value label="Outside the page" name="body" value="1"/>
        <value label="In the page" name="page" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="inherited" label="Element disposition" name="rowPosition">
        <value label="Hidden" name="hidden" value="0"/>
        <value label="Outside the page" name="body" value="1"/>
        <value label="In the page" name="page" value="2"/>
        <value label="Inherited" name="inherited" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="none" label="Integrating Adobe Campaign browsing" name="displayNavigation">
        <value label="Never" name="none" value="0"/>
        <value label="Outside Adobe Campaign (web access)" name="web" value="1"/>
        <value label="In Adobe Campaign" name="console" value="2"/>
        <value label="All the time" name="both" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="footer" label="Page header text" name="footerPosition">
        <value label="Hidden" name="hidden" value="0"/>
        <value label="In the page" name="page" value="1"/>
        <value label="In the footer" name="footer" value="2"/>
        <value label="Outside the page" name="body" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="page" label="Errors disposition" name="errorsPosition">
        <value label="Outside the page" name="body" value="0"/>
        <value label="In the page" name="page" value="1"/>
      </enumeration>
      <enumeration basetype="string" label="Format" name="format">
        <value label="WEB" value="web"/>
        <value enabledIf="@type=1" label="PDF" value="pdf"/>
        <value enabledIf="@type=1" label="Excel" value="excel"/>
      </enumeration>
      <enumeration basetype="byte" default="form" label="Type" name="type">
        <value label="Form" name="form" value="0"/>
        <value label="Report" name="report" value="1"/>
      </enumeration>
      <element label="Cell" name="cell">
        <element label="Text" localizable="true" name="text" type="CDATA"/>
      </element>
      <element label="Line" name="row" xml="true">
        <attribute default="gid()" label="Identifier" name="id" type="long"/>
        <element name="font" ref="xtk:report:font"/>
        <element name="left" ref="cell"/>
        <element name="right" ref="cell"/>
        <element label="Borders" name="border">
          <element label="Left" name="left" ref="xtk:report:border"/>
          <element label="Top" name="top" ref="xtk:report:border"/>
          <element label="Right" name="right" ref="xtk:report:border"/>
          <element label="Bottom" name="bottom" ref="xtk:report:border"/>
        </element>
        <attribute label="Hide in Adobe Campaign browsing mode" name="hideIfDashboard" type="boolean"/>
        <attribute label="Hide when in decoration-free mode" name="hideIfNoDecorated" type="boolean"/>
        <attribute label="Hide when in decoration mode" name="hideIfDecorated" type="boolean"/>
        <attribute enum="rowPosition" label="Position" name="position" type="byte"/>
      </element>
      <element autopk="true" folderModel="xtkFormRendering" fullLoad="true" img="xtk:formrendering.png" name="formRendering" pkgAdmin="@id != 0">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@internalName"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'FRG'+CounterValue('xtkFormRendering')" name="internalName" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute label="Preview" name="preview" type="string" xml="true"/>
        <element name="comment" template="xtk:common:comment"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkFormRendering', [@_folder-id])" label="Folder" name="folder" revIntegrity="define" target="xtk:folder" type="link"/>
        <attribute enum="type" label="Type" name="type" type="byte"/>
        <element label="Headers" name="header" ordered="true" template="row" unbound="true"/>
        <element label="Footers" name="footer" ordered="true" template="row" unbound="true"/>
        <attribute enum="displayNavigation" label="Adding Adobe Campaign browsing" name="displayNavigation" type="byte"/>
        <attribute label="Browsing label" name="navigationLabel" type="string"/>
        <attribute default="false" label="Display a border around the page" name="pageBorder" type="boolean"/>
        <element label="Logo" name="logo" xml="true">
          <attribute label="URL" name="src" type="string"/>
          <attribute desc="Logo position" enum="logoPosition" label="Position" name="position" type="byte"/>
          <attribute label="Height" name="height" type="long"/>
          <attribute label="Width" name="width" type="long"/>
        </element>
        <element desc="Elements disposition" label="Disposition" name="layout" xml="true">
          <attribute enum="position" label="Header" name="header" type="byte"/>
          <attribute enum="position" label="Page footer" name="footer" type="byte"/>
          <attribute enum="footerPosition" label="Page footer text" name="footertext" type="byte"/>
          <attribute enum="errorsPosition" label="Errors" name="errors" type="byte"/>
        </element>
        <element label="Format" name="format" unbound="true" xml="true">
          <default>&lt;format name="web" defaultFontSize="10" css="/nl/webForms/defaultWebApp.css"/&gt;</default>
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute enum="format" label="Format" name="name" type="string" xml="true"/>
          <attribute default="10" label="Default font size" name="defaultFontSize" type="short"/>
          <element label="Generation XSL" name="stylesheet" revLink="_NONE_" target="xtk:xslt" type="link"/>
          <attribute default="'/nl/webForms/defaultWebApp.css'" desc="URL of the root CSS." label="CSS" name="css" type="string" xml="true"/>
          <element label="Overloads the standard CSS" name="cssOverloading" translatedDefault="'/* Enter here anything loaded over the CSS */'" type="CDATA" xml="true"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="SQL functions definition" mappingType="xmlFile" name="funcList" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="all" name="providerPartEncoding">
        <value label="All encoding types" name="all"/>
        <value label="Non Unicode database" name="nonUnicode"/>
        <value label="Unicode database" name="unicode"/>
      </enumeration>
      <element name="funcList" pkgAdmin="@namespace NOT IN ('xtk','nl','nms','ncm','crm')" pkgPlatform="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <element desc="Function groups" label="Group" name="group" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute desc="Group name" label="Name" name="name" type="string"/>
          <attribute name="label" template="xtk:common:label"/>
          <element desc="List of functions" label="Function" name="function" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute desc="Function name" label="Name" name="name" type="string"/>
            <attribute desc="Function return type" label="Type" name="type" type="string"/>
            <attribute desc="Arguments passed as parameters" label="Arguments" localizable="true" name="args" type="string"/>
            <attribute desc="Function help" label="Help" localizable="true" name="help" type="string"/>
            <attribute desc="Display text for function" label="View" localizable="true" name="display" type="string"/>
            <attribute default="false" desc="Can be used server side only" label="Advanced" localizable="true" name="advanced" type="boolean"/>
            <attribute label="Minimum number of arguments" name="minArgs" type="short"/>
            <attribute label="Maximum number of arguments" name="maxArgs" type="short"/>
            <element desc="Engine description" label="Engines" name="providerPart" unbound="true">
              <key allowEmptyPart="true" name="provider">
                <keyfield xpath="@provider"/>
                <keyfield xpath="@encoding"/>
                <keyfield xpath="@version"/>
              </key>
              <attribute label="List of database engines" name="provider" type="string"/>
              <attribute enum="providerPartEncoding" label="Encoding type" name="encoding" type="string"/>
              <attribute label="Compatible versions" name="version" type="string"/>
              <attribute label="Function body" name="body" type="string"/>
            </element>
          </element>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" mappingType="xmlFile" name="fusion" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="merge">
        <attribute label="Label" name="label" type="string"/>
        <attribute label="Source1" name="xpath" type="string"/>
        <attribute label="Source1" name="source1" type="string"/>
        <attribute label="Source2" name="source2" type="string"/>
        <attribute label="Result" name="destination" type="string"/>
      </element>
      <element name="fusion" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <attribute label="Identifier" name="id" type="long"/>
        <element label="Source" name="source">
          <attribute label="ComputeString" name="_cs" type="string"/>
          <element label="Element to delete" name="delete" type="ANY"/>
        </element>
        <element label="Destination" name="destination">
          <attribute label="ComputeString" name="_cs" type="string"/>
          <element label="Merge content" name="merge" type="ANY"/>
        </element>
        <element name="conflict" ref="merge" unbound="true"/>
        <element name="other" ref="merge" unbound="true"/>
      </element>
      <methods>
        <method name="PrepareFusion" static="true">
          <parameters>
            <param desc="Schema" inout="in" name="schema" type="string"/>
            <param desc="Priority (source1 / source2)" inout="in" name="priority" type="boolean"/>
            <param desc="Selection" inout="in" name="selection" type="DOMElement"/>
            <param desc="Preparation results" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ProcessFusion" static="true">
          <parameters>
            <param desc="Schema" inout="in" name="schema" type="string"/>
            <param desc="Merge context" inout="in" name="context" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Application operator groups" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:group.png" implements="xtk:persist" label="Operator groups" labelSingular="Operator group" name="group" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" enumImage="@type" folderLink="folder" folderModel="xtkGroup" fullLoad="true" img="xtk:group.png" label="Group" name="group" pkgAdmin="@id != 0" sqltable="XtkOperator">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@type"/>
          <keyfield xpath="@name"/>
        </key>
        <dbindex name="label">
          <keyfield xpath="@type"/>
          <keyfield xpath="@label"/>
        </dbindex>
        <attribute name="id" sqlname="iOperatorId" type="long"/>
        <attribute default="1" enum="xtk:operator:opType" label="Type" name="type" pkgStatus="always" type="short"/>
        <attribute defOnDuplicate="true" default="GetOption('XtkInstancePrefix')+Iif(@type=0, 'LOGIN', Iif(@type=1, 'GRP', 'RIGHT'))+CounterValue('xtkOperator')" label="Name" length="64" name="name" required="true" type="string"/>
        /&gt;
        <attribute name="label" template="xtk:common:label"/>
        <element name="desc" template="xtk:common:desc"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkGroup', [@_folder-id])" label="Group folder" name="folder" required="true" revDesc="Operator groups contained in this folder" revIntegrity="define" revLabel="Operator groups" target="xtk:folder" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" implements="xtk:persist" label="Images" labelSingular="Image" mappingType="binaryFile" name="image" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="bmp" name="imageType">
        <value img="xtk:bitmap.png" label="Image bitmap" name="bmp"/>
        <value img="xtk:icon.png" label="Icon" name="ico"/>
      </enumeration>
      <element enumImage="@type" label="Image" name="image" pkgPlatform="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsResName" name="nsName"/>
        <attribute desc="Image type" enum="imageType" label="Type" name="type" type="string"/>
        <element label="Encoded image" name="data" type="blob"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:javascript.png" implements="xtk:persist" label="JavaScripts" labelSingular="JavaScript code" mappingType="textFile" name="javascript" namespace="xtk" xtkschema="xtk:srcSchema">
      <element img="xtk:javascript.png" name="javascript" pkgPlatform="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsResName" name="nsName"/>
        <element label="Script" name="data" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Batch jobs executed on the application server" entitySchema="xtk:srcSchema" img="xtk:job.png" implements="xtk:jobInterface" label="Batch jobs" labelSingular="Batch job" name="job" namespace="xtk" xtkschema="xtk:srcSchema">
      <interface async="true" label="Job interface" name="jobInterface">
        <method const="true" name="Execute">
          <parameters>
            <param desc="Name of the method to call on entity" inout="in" name="methodName" type="string"/>
            <param desc="Identifier of the job created (returned even of the job has failed if created in the database)" inout="out" name="id" type="string"/>
          </parameters>
        </method>
        <method const="true" name="Submit">
          <parameters>
            <param desc="Name of the method to call on entity" inout="in" name="methodName" type="string"/>
            <param desc="Identifier of job just created" inout="out" name="id" type="string"/>
          </parameters>
        </method>
        <method const="true" name="SubmitSoapCall">
          <parameters>
            <param desc="Method to call for the entity" inout="in" name="soapCall" type="DOMElement"/>
            <param desc="Identifier of job just created" inout="out" name="id" type="string"/>
          </parameters>
        </method>
        <method name="SubmitFromModel" static="true">
          <parameters>
            <param desc="Job template schema" inout="in" name="schema" type="string"/>
            <param desc="Template selection expression" inout="in" name="where" type="string"/>
            <param desc="Name of the method to call" inout="in" name="methodName" type="string"/>
            <param desc="XML content to add to the template" inout="in" name="diff" type="DOMElement"/>
            <param desc="Perform an asynchronous job submission" inout="in" name="async" type="boolean"/>
            <param desc="Identifier of job just created" inout="out" name="jobId" type="long"/>
          </parameters>
        </method>
        <method name="Cancel" static="true">
          <parameters>
            <param desc="Job identifier" inout="in" name="id" type="string"/>
          </parameters>
        </method>
        <method name="WaitJobCancelled" static="true">
          <parameters>
            <param desc="Job identifier" inout="in" name="id" type="string"/>
            <param desc="Maximum wait (in seconds)" inout="in" name="timeout" type="long"/>
          </parameters>
        </method>
        <method name="Pause" static="true">
          <parameters>
            <param desc="Job identifier" inout="in" name="id" type="string"/>
          </parameters>
        </method>
        <method name="CheckIfJobInProcess" static="true">
          <parameters>
            <param desc="Job identifier" inout="in" name="pid" type="long"/>
            <param desc="Name of the machine on which the job has been started" inout="in" name="hostName" type="string"/>
            <param desc="Result" inout="out" name="result" type="boolean"/>
          </parameters>
        </method>
        <method name="GetJobsInProcess" static="true">
          <parameters>
            <param desc="Returned document" inout="out" name="jobInfo" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetStatus" static="true">
          <parameters>
            <param desc="Job identifier" inout="in" name="id" type="string"/>
            <param desc="Identifier of the last log entry returned in the previous call" inout="in" name="lastLogId" type="long"/>
            <param desc="Maximum number of log entries to send" inout="in" name="maxLogCount" type="long"/>
            <param desc="Job status" enum="xtk:jobLog:logType" inout="out" name="status" type="short"/>
            <param desc="Log messages" inout="out" name="returnLogs" type="DOMElement"/>
            <param desc="Properties (progress...)" inout="out" name="properties" type="DOMElement"/>
          </parameters>
        </method>
        <method name="HasWarning" static="true">
          <parameters>
            <param desc="Job identifier" inout="in" name="id" type="string"/>
            <param desc="Returns 'true' if there has been at least one warning or error message" inout="out" name="hasWarning" type="boolean"/>
          </parameters>
        </method>
        <method name="FilesExist" static="true">
          <parameters>
            <param desc="List of files (@name) and their MD5 keys (@md5) and Boolean indicating if it can be a resource (@checkResource)." inout="in" name="files" type="DOMDocument"/>
            <param desc="List of results (@md5 and @exists)" inout="out" name="exist" type="DOMDocument"/>
          </parameters>
        </method>
      </interface>
      <enumeration basetype="short" default="edit" label="Job status" name="jobStatus">
        <value img="xtk:scprop.png" label="Being edited" name="edit" value="0"/>
        <value img="xtk:runtask.png" label="Execution in progress" name="running" value="2"/>
        <value img="xtk:canceled.png" label="Cancel in progress" name="canceling" value="3"/>
        <value img="xtk:canceled.png" label="Canceled" name="canceled" value="4"/>
        <value img="xtk:finished.png" label="Finished" name="finished" value="5"/>
        <value img="xtk:logerr.png" label="Finished with errors" name="error" value="6"/>
        <value img="nms:pause.png" label="Pause in progress" name="pausePending" value="7"/>
        <value img="nms:pause.png" label="Paused" name="pause" value="8"/>
        <value img="nms:canceled.png" label="Server shutdown in progress" name="purgePending" value="9"/>
      </enumeration>
      <enumeration basetype="string" label="Job type" name="jobType">
        <value img="xtk:import.png" label="Import" name="import"/>
        <value img="xtk:export.png" label="Export" name="export"/>
        <value img="nms:setofservices.png" label="Subscription to services" name="registerService"/>
        <value img="nms:rcpgroup.png" label="Subscription of groups" name="registerGroup"/>
        <value img="nms:campaign.png" label="Delivery" name="delivery"/>
      </enumeration>
      <element name="modelSupport">
        <attribute advanced="true" defOnDuplicate="true" default="false" desc="Application built-in template, or instance created from a built-in template." label="Application built-in template" name="builtIn" type="boolean"/>
        <attribute advanced="true" default="false" desc="This record is a job template" label="Template" name="isModel" type="boolean"/>
        <attribute advanced="true" desc="Name of the template used to create this instance" label="Template name" name="modelName" type="string" xml="true"/>
      </element>
      <element autopk="true" enumImage="@status" folderModel="xtkJobInstance,xtkJobModel" img="xtk:job.png" name="job" pkgAdmin="@id != 0 AND @isModel = 1" sqltable="XtkJob">
        <key name="internalName">
          <keyfield xpath="@internalName"/>
        </key>
        <dbindex name="label">
          <keyfield xpath="@builtIn"/>
          <keyfield xpath="@label"/>
        </dbindex>
        <compute-string expr="@label + ' (' + [folder/@label] + ')'"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="desc" template="xtk:common:desc"/>
        <attribute label="Internal name" length="100" name="internalName" required="true" type="string"/>
        <attribute advanced="true" default="false" desc="No trace of this job is saved in the database" label="Do not historize this job" name="doNotPersist" type="boolean" xml="true"/>
        <attribute defOnDuplicate="true" desc="Start date" label="Start date" name="startDate" type="datetime"/>
        <attribute defOnDuplicate="true" desc="End date" label="End date" name="endDate" type="datetime"/>
        <attribute defOnDuplicate="true" enum="jobStatus" label="Status" name="status" type="short"/>
        <attribute enum="jobType" label="Job type" length="32" name="jobType" type="string"/>
        <attribute advanced="true" label="Schema" length="80" name="xtkschema" type="string"/>
        <attribute label="Image" length="80" name="img" type="string"/>
        <element aggregate="xtk:job:modelSupport" name="modelSupport"/>
        <attribute advanced="true" label="List+Detail form" length="80" name="form" type="string"/>
        <attribute advanced="true" label="Data entry form in external window" length="80" name="editForm" type="string"/>
        <attribute advanced="true" default="false" label="Start job in a detached process" name="outOfProcess" type="boolean" xml="true"/>
        <attribute advanced="true" label="Name of the module to launch" name="module" type="string" xml="true"/>
        <attribute advanced="true" desc="Name of computer where the job is processed" label="Name of the processing computer" name="hostName" type="string" xml="true"/>
        <attribute advanced="true" desc="Process identifier (PID) on the computer where the job is executed" label="Process identifier" name="pid" type="long" xml="true"/>
        <attribute advanced="true" desc="Operator login to use to start the job" label="Operator login" name="runAs" type="string" xml="true"/>
        <attribute advanced="true" label="Warnings found in the  log messages" name="hasWarning" type="boolean" xml="true"/>
        <attribute advanced="true" defOnDuplicate="true" desc="Resume requested" label="Retry" name="retry" type="boolean" xml="true"/>
        <attribute advanced="true" defOnDuplicate="true" desc="Number of times the job was restarted." label="Number of successive tries" name="retryCount" type="short" xml="true"/>
        <attribute desc="Duration of the job" expr="SecondsDiff(Coalesce(@endDate, GetDate()), @startDate)" label="Duration" name="duration" type="timespan"/>
        <attribute advanced="true" label="Job id for propagation of logs" name="targetLogId" type="string" xml="true"/>
        <element defOnDuplicate="true" default="iif(@isModel, DefaultFolder('xtkJobModel', [@_folder-id]), DefaultFolder('xtkJobInstance', [@_folder-id]))" img="xtk:model.png" label="template folder" name="folder" required="true" revDesc="Jobs in the folder" revIntegrity="define" revLabel="Jobs" revLink="job-folder" revTarget="xtk:job" target="xtk:folder" type="link"/>
        <element defOnDuplicate="true" default="iif (@isModel, DefaultFolder('xtkJobInstance', [@_folderProcess-id]), 0)" img="xtk:execute.png" label="Execution folder" name="folderProcess" required="true" revDesc="Job templates in this folder" revIntegrity="define" revLabel="Job templates" revLink="job-folderProcess" revTarget="xtk:job" target="xtk:folder" type="link"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element integrity="own" name="log" revLink="job" target="xtk:jobLog" type="link" unbound="true"/>
        <element advanced="true" desc="Template parameters to specify for delivery" label="Variables" name="variables" xml="true">
          <element name="var" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute label="Name" name="name" template="xtk:common:name"/>
            <element label="Description" name="desc" type="string"/>
            <element aggregate="xtk:common:variant" name="variant"/>
            <attribute default="false" desc="The value of the parameter is the result of an expression evaluated during the analysis of the delivery." label="Value is the result of an expression." name="calculated" type="boolean"/>
            <element desc="Value computation expression" label="Expression" name="expr" type="string"/>
            <attribute desc="Expression value computed during last analysis (or last simulation)." label="Expression result" name="exprResult" type="string"/>
            <attribute default="false" desc="The parameter value must be specified before delivery analysis." label="Mandatory" name="required" type="boolean"/>
          </element>
        </element>
        <element advanced="true" defOnDuplicate="true" label="Properties" name="properties" xml="true">
          <attribute advanced="true" default="false" desc="The execution of the job has generated warnings." name="warning" type="boolean"/>
          <element advanced="true" name="progress">
            <attribute name="current" type="long"/>
            <attribute name="max" type="long"/>
          </element>
          <element advanced="true" name="filesToDownload">
            <attribute label="Specifies that the job only download files" name="onlyDownloadMode" type="boolean"/>
            <attribute label="Root folder where files are stored locally" name="containingFolder" type="string"/>
            <element name="file" unbound="true">
              <attribute desc="Fully qualified local file name (related to the containingFolder attribute if it is defined.)" label="Local name" name="originalName" type="string"/>
              <attribute desc="Server file name (without path part)" label="Server name" name="serverName" type="string"/>
              <attribute desc="Identifier of the enumeration value from xtk:FileRes (eg. 'uploadDir'). Empty means export directory. 'workspace' and 'database' mean from var/instance/workspace and from the database respectively." enum="xtk:fileRes:storageType" label="Directory" name="storageType" type="byte"/>
              <attribute label="Modification date" name="lastModified" type="datetime"/>
              <attribute label="Size" name="size" type="string"/>
              <attribute label="MD5 key of the content" name="md5" type="string"/>
              <attribute desc="File description" label="Description" name="label" type="string"/>
              <attribute desc="File type" label="Type" name="type" type="string"/>
              <attribute label="Download" name="active" type="boolean"/>
            </element>
          </element>
          <element advanced="true" name="filesNotToDownload">
            <element name="fileImpossible" unbound="true">
              <attribute desc="Server file name" label="Server name" name="serverName" type="string"/>
              <attribute desc="File description" label="Description" name="desc" type="string"/>
              <attribute desc="File type" label="Type" name="type" type="string"/>
              <attribute desc="Reason why this file cannot by downloaded" label="Reason" name="reason" type="string"/>
            </element>
          </element>
        </element>
        <element advanced="true" name="userArgs" type="ANY" xml="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Logs for batch jobs executed on the server" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Batch job logs" labelSingular="Batch job logs" name="jobLog" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="short" default="error" label="Log type" name="logType">
        <value img="xtk:logerr.png" label="Error" name="error" value="0"/>
        <value img="xtk:logwarn.png" label="Warning" name="warning" value="1"/>
        <value img="xtk:loginfo.png" label="Info" name="info" value="2"/>
        <value img="xtk:logmsg.png" label="Status" name="status" value="3"/>
        <value img="xtk:logmsg.png" label="Verbose" name="verbose" value="4"/>
      </enumeration>
      <element autopk="true" desc="Logs generated during the execution of a job" enumImage="@logType" label="Log list" name="jobLog" pkSequence="XtkJobLogId" pkgStatus="never" sqltable="XtkJobLog">
        <dbindex name="logDate">
          <keyfield xpath="@job-id"/>
          <keyfield xpath="@id"/>
        </dbindex>
        <attribute label="Job identifier" name="job-id" type="long"/>
        <attribute enum="logType" label="Log type" name="logType" type="short"/>
        <attribute label="Date" name="logDate" type="datetime"/>
        <attribute label="Error code" name="error" type="long"/>
        <attribute label="Source" name="object" type="string"/>
        <attribute label="Message" length="512" name="message" type="string"/>
        <element integrity="neutral" label="Job" name="job" target="xtk:job" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:javascript.png" implements="xtk:persist" label="Dynamic JavaScript pages" labelSingular="Dynamic JavaScript page" mappingType="textFile" name="jssp" namespace="xtk" xtkschema="xtk:srcSchema">
      <element img="xtk:javascript.png" name="jssp" pkgPlatform="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsResName" name="nsName"/>
        <element label="Script" name="data" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:jst.png" implements="xtk:persist" label="JavaScript templates" labelSingular="JavaScript Template" mappingType="xmlFile" name="jst" namespace="xtk" xtkschema="xtk:srcSchema">
      <element img="xtk:jst.png" label="JavaScript" name="jst">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <compute-string expr="@namespace + ':' + @name"/>
        <element aggregate="xtk:common:nsResName" name="nsName"/>
        <attribute label="Schema" name="schema" type="string"/>
        <element label="Script" name="code" type="CDATA"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nl:folders.png" implements="xtk:persist" label="Navigation hierarchies" labelSingular="Navigation hierarchy" mappingType="xmlFile" name="navtree" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" name="encoding">
        <value name="SOAP_ENCODING_NATIVE"/>
        <value name="SOAP_ENCODING_XML"/>
      </enumeration>
      <enumeration basetype="string" default="view" name="viewType">
        <value label="View" name="view"/>
        <value label="Report" name="report"/>
        <value label="Overview" name="overview"/>
        <value label="Detail" name="detail"/>
        <value label="Creation" name="creation"/>
      </enumeration>
      <enumeration basetype="string" default="view" name="blockViewType">
        <value label="List of views" name="view"/>
        <value label="AJAX list" name="list"/>
      </enumeration>
      <element label="Order" name="command">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'CMD'+CounterValue('xtkCommand')" label="Name" name="name" type="string"/>
        <attribute label="Label" length="128" localizable="true" name="label" required="true" type="string"/>
        <attribute label="Description" localizable="true" name="desc" type="string"/>
        <attribute label="Identifier of form" name="form" type="string"/>
        <attribute label="Expression used to compute form identifier" name="formExpr" type="string"/>
        <attribute label="Expression used to compute the schema identifier" name="schemaExpr" type="string"/>
        <attribute desc="List of rights required to execute command" label="Rights" name="rights" type="string"/>
        <attribute label="Confirmation label" localizable="true" name="promptLabel" type="string"/>
        <attribute label="Message displayed in status bar" localizable="true" name="statusLabel" type="string"/>
        <attribute label="Single-selection allowed" name="monoSelection" type="boolean"/>
        <attribute label="Load selected entity in the form context" name="loadEntity" type="boolean"/>
        <attribute label="Force creation of entity" name="forceNewEntity" type="boolean"/>
        <attribute label="Load the entity from the specified template key" name="loadEntityModelFromKey" type="string"/>
        <attribute label="Load the selected template in the context of the form" name="loadEntityModel" type="boolean"/>
        <attribute label="XPath of the key" name="formKeyPath" type="string"/>
        <attribute label="Current schema XPath" name="formSchemaPath" type="string"/>
        <attribute label="Label for current selection (mono selection)" name="formLabelPath" type="string"/>
        <attribute label="XPath of current folder" name="formFolderLabelPath" type="string"/>
        <attribute label="Image" name="img" type="string"/>
        <attribute label="Activation script" name="enabledIf" type="string"/>
        <attribute label="Text align" name="textAlign" type="string"/>
        <attribute label="Non contextual command" name="notContextual" type="boolean"/>
        <attribute label="Command contextual to a folder" name="folderContextual" type="boolean"/>
        <attribute label="Command not visible when sub-form" name="notVisibleInForm" type="boolean"/>
        <attribute label="Ignores the noNewInstance defined in the form used" name="alwaysNewInstance" type="boolean"/>
        <attribute label="Override built-in command" name="overrideBuiltIn" type="string"/>
        <attribute label="Modal form" name="modal" type="boolean"/>
        <attribute label="Activation based on selection" name="enabledSelCount" type="short"/>
        <attribute label="Create a new instance for the referenced schema" name="newEntitySchema" type="string"/>
        <attribute label="Contextual command" name="contextual" type="boolean"/>
        <attribute label="Refresh view" name="refreshView" type="boolean"/>
        <attribute label="Form class being edited" name="formClass" type="string"/>
        <attribute label="Function launched client side" name="clientFunction" type="string"/>
        <attribute label="Open in the application main window" name="dock" type="boolean"/>
        <attribute desc="Only one window of this type can be opened." label="Unique window" name="single" type="boolean"/>
        <attribute desc="Starts a job that will not be saved in the database." label="Job not saved in the database" name="nonPersistJob" type="boolean"/>
        <attribute name="loadExtraXPath" type="string"/>
        <attribute name="loadExtraXPathOpt" type="string"/>
        <attribute label="Library command which can be referenced" name="lib" type="boolean"/>
        <attribute label="References a command defined in the library" name="ref" type="string"/>
        <attribute label="Visible only on some clients" name="device" type="string"/>
        <attribute label="External URL of a page to load" name="href" type="string"/>
        <attribute desc="Name of the view containing the content definition to display" label="View name" name="view" type="string"/>
        <attribute enum="viewType" label="View type" name="viewType" type="string"/>
        <element label="Report" name="report" target="xtk:report" type="link"/>
        <attribute label="Internal name of the report" name="reportName" type="string"/>
        <attribute label="Target report" name="reportTarget" type="string"/>
        <attribute label="Position in the menu" name="order" type="short"/>
        <attribute label="Enabling condition" name="applicableIf" type="string"/>
        <attribute label="Separator" name="separator" type="boolean"/>
        <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
        <element name="soapCall" ref="xtk:form:soapCall" type="ANY"/>
        <element name="enter" ref="xtk:form:enrichContext" type="ANY"/>
        <element name="command" ref="command" unbound="true"/>
      </element>
      <element label="Template definition" name="model">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Namespace" name="namespace" type="string"/>
        <attribute label="Label" localizable="true" name="label" type="string"/>
        <attribute label="Name" name="name" type="string"/>
        <attribute label="Position in the menu" name="order" type="short"/>
        <attribute label="Image" name="img" type="string"/>
        <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
        <element label="Node template definition" name="nodeModel" ordered="true" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute label="Name" name="name" type="string"/>
          <attribute label="Label" localizable="true" name="label" type="string"/>
          <attribute label="Visibility namespace for folder" name="namespace" type="string"/>
          <attribute label="Image" name="img" type="string"/>
          <attribute label="Position in the menu" name="order" type="short"/>
          <attribute label="List of non-visible system commands" name="hiddenCommands" type="string"/>
          <attribute label="Name of the folders enforcing the list of hidden system commands" name="hiddenCommandsFromFolderName" type="string"/>
          <attribute label="Folder schema ('folder' subclass)" name="schema" type="string"/>
          <attribute label="Filter on the folder link " name="folderLink" type="string"/>
          <attribute label="Detail form used for a folder" name="form" type="string"/>
          <attribute label="List of authorized folder templates for drag&amp;drop" name="dropModelNameList" type="string"/>
          <attribute label="List of folder templates allowed when creating a new folder" name="newFolderShortCuts" type="string"/>
          <attribute label="Hide the shortcut menu of the folder" name="hideCurrentFolderMenu" type="boolean"/>
          <attribute label="List of XPaths to inherit from the parent folder" name="inheritParentXpaths" type="string"/>
          <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
          <element label="Contextual command" name="command" ref="command" unbound="true"/>
          <element label="Description of a view associated with template" name="view" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute label="Name" name="name" required="true" type="MNTOKEN"/>
            <attribute enum="viewType" label="View type" name="type" type="string"/>
            <attribute label="Schema associated to view" name="schema" type="string"/>
            <attribute label="Form to use when displaying the view" name="form" type="string"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
            <attribute label="Label (singular)" localizable="true" name="labelSingular" type="string"/>
            <attribute label="Image enumeration XPath" name="enumImage" type="string"/>
            <attribute label="Disable insertion into view" name="noInsert" type="boolean"/>
            <attribute label="No form defined for this view" name="noForm" type="boolean"/>
            <attribute label="List of screens to activate" name="screen" type="string"/>
            <attribute label="Display elements flagged to delete" name="ignoreDeleteStatus" type="boolean"/>
            <attribute label="Bold line if expression returns true" name="boldLineExpr" type="string"/>
            <attribute label="Refresh the detail after its content has been modified" name="forceToRefresh" type="string"/>
            <attribute label="Image" name="img" type="string"/>
            <attribute label="Link title" localizable="true" name="urlTitle" type="string"/>
            <attribute desc="List of rights required to access the view" label="Rights" name="rights" type="string"/>
            <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
            <element label="Description of columns of the list" name="columns" type="ANY"/>
            <element label="System filter" name="sysFilter" type="ANY"/>
            <element label="Sort" name="orderBy" type="ANY"/>
          </element>
        </element>
        <element name="model" ordered="true" ref="model" unbound="true"/>
      </element>
      <element label="Definition of a view" name="view">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute desc="Unique identifier of the view" label="Name" name="name" type="string"/>
        <attribute label="Label" localizable="true" name="label" type="string"/>
        <attribute label="Image" name="img" type="string"/>
        <attribute label="URL to display" name="url" type="string"/>
        <attribute label="Forces the token session" name="sessionToken" type="boolean"/>
        <attribute desc="Unique identifier of the view defined in a nodeModel" label="View to display" name="view" type="string"/>
        <attribute label="Optional settings to display in the URL" name="parameters" type="string"/>
        <attribute label="Report to display" name="report" type="string"/>
        <attribute label="JSSP to display" name="jssp" type="string"/>
        <attribute label="Edit form" name="editForm" type="string"/>
        <attribute label="Edit schema" name="editSchema" type="string"/>
        <attribute desc="Parameters to be reproduced during form editing (in the console only)" label="Edit parameters" name="editParam" type="string"/>
        <attribute desc="Name of the universe which this view is linked to." label="Navigation universes" name="universe" type="string"/>
        <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
        <attribute desc="By default, the entity is loaded when the form is launched. If set to true, loading is prevented." label="Load the entity" name="noEntityLoad" type="boolean"/>
        <attribute label="Link title" localizable="true" name="urlTitle" type="string"/>
        <element desc="Additional parameter for a report" name="parameter">
          <attribute desc="Unique identifier of the view" label="Name" name="name" type="string"/>
          <attribute desc="Unique identifier of the view" label="Name" name="expr" type="string"/>
        </element>
        <attribute label="Web application to display" name="webApp" type="string"/>
        <attribute label="Enabling condition" name="applicableIf" type="string"/>
        <attribute label="Accepted folder templates" name="folderModel" type="string"/>
        <element name="reportList">
          <attribute name="name" type="string"/>
          <attribute name="report" type="string"/>
          <attribute name="label" type="string"/>
          <attribute name="context" type="string"/>
          <attribute name="schema" type="string"/>
          <attribute name="displayingSchema" type="string"/>
          <attribute name="selection" type="string"/>
          <attribute name="whereCond" type="string"/>
          <attribute name="monoReport" type="string"/>
          <attribute name="reportContext" type="string"/>
        </element>
      </element>
      <element label="Navigation universes" name="universe" unbound="true">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute desc="Internal name" label="Name" name="name" type="string"/>
        <attribute label="Label" localizable="true" name="label" type="string"/>
        <element label="Browsing block" name="blockView" ordered="true" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute desc="Internal name" label="Name" name="name" type="string"/>
          <attribute label="Label" localizable="true" name="label" type="string"/>
          <attribute label="Image" name="img" type="string"/>
          <attribute enum="blockViewType" label="Type" name="type" type="string"/>
          <attribute label="Enabling condition" name="applicableIf" type="string"/>
          <attribute label="Rights" name="rights" type="string"/>
          <attribute desc="Name of the dynamic list displayed in the drop-down panel" label="Dynamic list" name="otherList" type="string"/>
          <element label="View" name="view" ordered="true" ref="view" unbound="true"/>
        </element>
      </element>
      <element doesNotSupportDiff="true" img="nl:folders.png" name="navtree" pkgPlatform="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <attribute label="Depends on" name="dependsOn" type="string"/>
        <element label="Rights" name="rights">
          <element label="Rights on template" name="rightModel" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute label="Right name" name="name" type="string"/>
            <attribute label="Right description" localizable="true" name="label" type="string"/>
            <attribute name="global" type="boolean"/>
            <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
          </element>
        </element>
        <element label="Generic commands" name="commands">
          <element name="command" ref="command" unbound="true"/>
        </element>
        <element name="model" ref="model" unbound="true"/>
        <element name="node">
          <attribute label="Name" name="name" type="string"/>
          <attribute label="Label" localizable="true" name="label" type="string"/>
          <attribute label="Image" name="img" type="string"/>
        </element>
        <element label="View definition" name="views">
          <element label="View" name="view" ref="view" unbound="true"/>
        </element>
        <element label="Dashboard universes" name="universes">
          <element label="Navigation universes" name="universe" ref="universe" unbound="true"/>
        </element>
        <element label="Menu definition" name="menu" ordered="true" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute desc="Internal name of the menu" label="Name" name="name" type="string"/>
          <attribute label="Label" localizable="true" name="label" type="string"/>
          <element label="Order" name="command" ref="command" unbound="true"/>
          <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
        </element>
        <element name="windows">
          <element label="Definition of a page" name="window" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute label="Forces the token session" name="sessionToken" type="boolean"/>
            <attribute label="Name" name="name" type="string"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
            <attribute label="Welcome message" localizable="true" name="title" type="string"/>
            <attribute label="Image" name="img" type="string"/>
            <attribute label="Form to display" name="form" type="string"/>
            <attribute label="URL to display" name="url" type="string"/>
            <attribute label="Additional style sheet" name="css" type="string"/>
            <attribute enum="xtk:srcSchema:operation" name="_operation" type="string"/>
            <element label="Page footer" localizable="true" name="footer" type="CDATA"/>
          </element>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" label="empty" library="true" name="none" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="none"/>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="xtk:olapAggregate.png" label="Aggregates" labelSingular="Aggregate" name="olapAggregate" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" img="xtk:olapAggregate.png" label="Aggregate" name="olapAggregate">
        <key name="name">
          <keyfield xlink="cube"/>
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label+' ('+@name+')'"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="GetOption('XtkInstancePrefix')+'AGG'+CounterValue('xtkOlapAggregate')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label" translatedDefault="'New aggregate'"/>
        <element label="Description" name="description" type="memo"/>
        <attribute defOnDuplicate="true" label="Up to date" name="valid" type="boolean"/>
        <element label="Dimension" name="dimension" unbound="true" xml="true">
          <element label="Dimension" name="dimension" pkgStatus="preCreate" target="xtk:olapDimension" type="link"/>
          <attribute label="Level" name="level" type="string"/>
          <attribute label="Level label" name="levelLabel" type="string"/>
          <attribute label="Create an index for this dimension" name="useIndex" type="boolean"/>
        </element>
        <element label="Cube" name="cube" revIntegrity="owncopy" revLink="aggregate" target="xtk:olapCube" type="link"/>
      </element>
      <methods>
        <method name="FillWorkflow" static="true">
          <parameters>
            <param desc="The workflow" inout="in" name="workflow" type="DOMElement"/>
            <param desc="The aggregate" inout="in" name="aggregate" type="DOMElement"/>
            <param desc="The finished workflow" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="InvalidAggregate" static="true">
          <parameters>
            <param desc="The aggregate" inout="in" name="aggregate" type="DOMElement"/>
            <param desc="The modified aggregate" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="xtk:olapCube.png" implements="xtk:persist" label="Cubes" labelSingular="Cube" name="olapCube" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="schema" name="factType">
        <value label="Schema" name="schema" value="0"/>
        <value label="List" name="list" value="1"/>
      </enumeration>
      <element autopk="true" folderLink="folder" img="xtk:olapCube.png" label="Cube" name="olapCube" pkgAdmin="@id != 0">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label + ' (' + @name + ')'"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="GetOption('XtkInstancePrefix')+'CUBE'+CounterValue('xtkOlapCube')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label" translatedDefault="'New cube'"/>
        <attribute default="0" desc="Authorize or not automatic updates of the cube data" label="Automatically refresh data" name="autoRefresh" type="boolean"/>
        <element label="Description" name="description" type="memo"/>
        <element label="Fact list" name="list" revIntegrity="define" target="nms:group" type="link"/>
        <element label="Fact" name="fact">
          <attribute enum="factType" label="Type" name="type" sqlname="iFactType" type="byte"/>
          <attribute label="Fact schema" length="100" name="schema" type="string"/>
          <element desc="Filter to apply to the data in the fact schema" label="Filter" name="where" template="xtk:queryDef:where" xml="true">
            <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          </element>
        </element>
        <attribute label="Calculation time zone" name="timezone" template="xtk:common:timezone" xml="true"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkOlapCube', [@_folder-id])" label="Folder" name="folder" required="true" revDesc="Cubes contained in this folder" revIntegrity="define" revLabel="Cubes" target="xtk:folder" type="link"/>
      </element>
      <methods>
        <method name="GetCubeSchema" static="true">
          <parameters>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="Include dimensions" inout="in" name="withDimensions" type="boolean"/>
            <param desc="Schema" inout="out" name="schema" type="DOMElement"/>
          </parameters>
        </method>
        <method name="LoadCube" static="true">
          <parameters>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="Cube" inout="out" name="cube" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetPivotData" static="true">
          <parameters>
            <param desc="Cube identifier. Can be set to 0 if the cube is passed as a parameter." inout="in" name="cubeId" type="long"/>
            <param desc="XML describing the cube." inout="in" name="cube" type="DOMElement"/>
            <param desc="List of queries" inout="in" name="queries" type="DOMElement"/>
            <param desc="Result" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetReportData" static="true">
          <parameters>
            <param desc="Cube identifier. Can be set to 0 if the cube is passed as a parameter." inout="in" name="cubeId" type="long"/>
            <param desc="QueryDef defined in the report" inout="in" name="queryDef" type="string"/>
            <param desc="Select all" inout="in" name="selectAll" type="boolean"/>
            <param desc="Enable aggregate use" inout="in" name="useAggregates" type="boolean"/>
            <param desc="XML describing the cube." inout="in" name="cube" type="DOMElement"/>
            <param desc="Result" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetAggregateSchema" static="true">
          <parameters>
            <param desc="buildAggregate box of a workflow" inout="in" name="buildAggregate" type="DOMElement"/>
            <param desc="Result" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="InvalidAggregates" static="true">
          <parameters>
            <param desc="The cube" inout="in" name="cube" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ComputeAggregate" static="true">
          <parameters>
            <param desc="The ID of the cube that contains the aggregate" name="cubeId" type="long"/>
            <param desc="Aggregate" name="aggregate" type="DOMElement"/>
            <param desc="Filter" name="filter" type="DOMElement"/>
            <param desc="Show SQL" name="showSQL" type="boolean"/>
          </parameters>
        </method>
        <method name="GetExportPossibilities" static="true">
          <parameters>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="Serialized XML describing the cube." inout="in" name="cube" type="DOMElement"/>
            <param desc="List of possibilities" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="CreateExportList" static="true">
          <parameters>
            <param desc="Label of the list" inout="in" name="label" type="string"/>
            <param desc="ID of the folder which the list will be created in (0 to use the default folder)." inout="in" name="folderId" type="long"/>
            <param desc="ID of the newly created list" inout="out" name="listId" type="long"/>
          </parameters>
        </method>
        <method name="PrepareListExport" static="true">
          <parameters>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="Serialized XML describing the cube." inout="in" name="cube" type="DOMElement"/>
            <param desc="List of selections" inout="in" name="conditions" type="DOMElement"/>
            <param desc="Conditions on the fact schema" inout="out" name="translatedConditions" type="DOMElement"/>
          </parameters>
        </method>
        <method name="CountListExport" static="true">
          <parameters>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="Serialized XML describing the cube." inout="in" name="cube" type="DOMElement"/>
            <param desc="List of selections" inout="in" name="conditions" type="DOMElement"/>
            <param desc="Path to the elements to be exported" inout="in" name="path" type="string"/>
            <param desc="Number of elements to be exported" inout="out" name="result" type="long"/>
          </parameters>
        </method>
        <method name="GetLinkLevels" static="true">
          <parameters>
            <param desc="Field used" inout="in" name="field" type="DOMElement"/>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="Levels" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="UpdateBinningClass" static="true">
          <parameters>
            <param desc="Current binning" inout="in" name="binning" type="DOMElement"/>
            <param desc="Level expression type" inout="in" name="exprType" type="string"/>
            <param desc="Binning updated" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetTopN" static="true">
          <parameters>
            <param desc="Existing binning" inout="in" name="binning" type="DOMElement"/>
            <param desc="Fact description" inout="in" name="fact" type="DOMElement"/>
            <param desc="Level expression" inout="in" name="expr" type="string"/>
            <param desc="Expression type" inout="in" name="exprType" type="string"/>
            <param desc="Number of values to generate" inout="in" name="count" type="long"/>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="New binning" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetQuantiles" static="true">
          <parameters>
            <param desc="Existing binning" inout="in" name="binning" type="DOMElement"/>
            <param desc="Fact description" inout="in" name="fact" type="DOMElement"/>
            <param desc="Level expression" inout="in" name="expr" type="string"/>
            <param desc="Expression type" inout="in" name="exprType" type="string"/>
            <param desc="Number of values to generate" inout="in" name="count" type="long"/>
            <param desc="Cube identifier" inout="in" name="cubeId" type="long"/>
            <param desc="New binning" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="xtk:olapDimension.png" label="Dimensions" labelSingular="Dimension" name="olapDimension" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="inherit" name="viewType">
        <value label="Year" name="year" value="year"/>
        <value label="Quarter" name="quarter" value="quarter"/>
        <value label="Month" name="month" value="month"/>
        <value label="Week" name="week" value="week"/>
        <value label="Day" name="day" value="day"/>
        <value label="Time" name="hour" value="hour"/>
        <value label="Integer" name="integer" value="integer"/>
        <value label="String" name="string" value="string"/>
        <value label="Inherited" name="inherit" value="inherit"/>
      </enumeration>
      <element autopk="true" img="xtk:olapDimension.png" label="Dimensions" name="olapDimension">
        <key name="name">
          <keyfield xlink="cube"/>
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label+' ('+@name+')'"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="GetOption('XtkInstancePrefix')+'DIM'+CounterValue('xtkOlapDimension')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label" translatedDefault="'New dimension'"/>
        <element label="Description" name="description" type="memo"/>
        <element label="Level" name="level" ordered="true" unbound="true" xml="true">
          <compute-string expr="@label+' ('+@name+')'"/>
          <key internal="true" name="levelName">
            <keyfield xpath="@name"/>
          </key>
          <attribute default="GetOption('XtkInstancePrefix')+'LVL'+CounterValue('xtkOlapLevel')" name="name" template="xtk:common:name"/>
          <attribute name="label" template="xtk:common:label"/>
          <element label="Description" name="description" type="memo"/>
          <attribute label="Expression" name="expr" type="string"/>
          <attribute advanced="true" label="Expression type" name="exprType" type="string"/>
          <attribute advanced="true" label="Expression enumeration" name="exprSysEnum" type="string"/>
          <attribute advanced="true" enum="viewType" label="Field layout" name="viewType" type="string"/>
          <attribute advanced="true" enum="viewType" label="Temporal field layout (obsolete)" name="exprDateType" type="string"/>
          <element label="Binning" name="binning" xml="true">
            <attribute desc="Use binning" label="Activate" name="enable" type="boolean"/>
            <attribute label="Dynamic binning" name="dynamic" type="boolean"/>
            <element desc="Enumeration used for binning" label="Enumeration" name="enum" target="xtk:enum" type="link"/>
            <element label="Rating" name="class" ordered="true" unbound="true">
              <attribute default="GetOption('XtkInstancePrefix')+'CL'+CounterValue('xtkOlapClass')" label="Internal name" name="name" type="string"/>
              <attribute label="Label" name="label" translatedDefault="'New bin'" type="string"/>
              <attribute label="Condition" name="condition" type="string"/>
              <element label="Value" name="value" unbound="true">
                <key allowEmptyPart="true" internal="true" name="value">
                  <keyfield xpath="@value"/>
                  <keyfield xpath="@sqlMask"/>
                </key>
                <attribute label="Value" name="value" type="string"/>
                <attribute default="false" label="Use an SQL mask" name="sqlMask" type="boolean"/>
              </element>
              <attribute label="Minimum (strict)" name="minValue" type="string"/>
              <attribute label="Maximum (large)" name="maxValue" type="string"/>
            </element>
            <attribute desc="Label of the other values" label="Others" localizable="true" name="otherLabel" translatedDefault="'Others'" type="string"/>
          </element>
          <element label="Formatting" name="format" xml="true">
            <element label="Link formatting" name="formatLink" unbound="true">
              <attribute label="Label" name="label" type="string"/>
              <attribute label="Expression" name="expr" type="string"/>
              <attribute default="GetOption('XtkInstancePrefix')+'FO'+CounterValue('xtkOlapClass')" label="Internal name" name="name" type="string"/>
            </element>
          </element>
        </element>
        <element label="Cube" name="cube" revIntegrity="owncopy" revLink="dimension" target="xtk:olapCube" type="link"/>
      </element>
      <methods>
        <method name="GenerateTimeDimension" static="true">
          <parameters>
            <param desc="Dimension to enter" inout="in" name="dimension" type="DOMElement"/>
            <param desc="Field or expression used" inout="in" name="field" type="DOMElement"/>
            <param desc="Date description" inout="in" name="dates" type="DOMElement"/>
            <param desc="Entered dimension" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GenerateLinkDimension" static="true">
          <parameters>
            <param desc="Dimension to enter" inout="in" name="dimension" type="DOMElement"/>
            <param desc="Available levels" inout="in" name="linklevels" type="DOMElement"/>
            <param desc="Entered dimension" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GenerateSingleLevelDimension" static="true">
          <parameters>
            <param desc="Dimension to enter" inout="in" name="dimension" type="DOMElement"/>
            <param desc="Field or expression used" inout="in" name="field" type="DOMElement"/>
            <param desc="Entered dimension" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="UpdateLevelName" static="true">
          <parameters>
            <param desc="Level to modify" inout="in" name="level" type="DOMElement"/>
            <param desc="Parent dimension of the level" inout="in" name="dimension" type="DOMElement"/>
            <param desc="Modified level" inout="out" name="result" type="DOMElement"/>
          </parameters>
        </method>
        <method name="InvalidAggregates" static="true">
          <parameters>
            <param desc="The dimension" inout="in" name="dimension" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="xtk:olapMeasure.png" label="Measures" labelSingular="Measure" name="olapMeasure" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="count" name="operator">
        <value label="Count" name="count" value="1"/>
        <value label="Distinct count" name="distinctCount" value="2"/>
        <value label="Sum" name="sum" value="3"/>
        <value label="Minimum" name="min" value="4"/>
        <value label="Maximum" name="max" value="5"/>
        <value label="Standard deviation" name="stdDev" value="6"/>
        <value label="Average" name="average" value="101"/>
        <value label="Weighted average" name="weightedAverage" value="102"/>
      </enumeration>
      <enumeration basetype="string" default="number" name="format">
        <value label="Number" name="number" value="number"/>
        <value label="Percentage" name="percentage" value="percentage"/>
      </enumeration>
      <enumeration basetype="byte" default="after" name="unitFormat">
        <value label="After the value, with a space" name="after" value="0"/>
        <value label="After the value, without a space" name="afterNoSpace" value="1"/>
        <value label="Before the value, with a space" name="before" value="2"/>
        <value label="Before the value, without a space" name="beforeNoSpace" value="3"/>
      </enumeration>
      <element autopk="true" img="xtk:olapMeasure.png" label="Measure" name="olapMeasure">
        <key name="name">
          <keyfield xlink="cube"/>
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label+' ('+@name+')'"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="GetOption('XtkInstancePrefix')+'MES'+CounterValue('xtkOlapMeasure')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label" translatedDefault="'New measure'"/>
        <attribute enum="format" label="Measure formatting" name="format" type="string" xml="true"/>
        <attribute label="Measure unit" length="20" name="unit" type="string"/>
        <attribute enum="unitFormat" label="Unit formatting" name="unitFormat" type="byte" xml="true"/>
        <element label="Description" name="description" type="memo"/>
        <element label="Filters data specific to this measure" name="filter" xml="true">
          <attribute name="schema" type="string"/>
          <element desc="Filter to apply to data" label="Filter" name="where" template="xtk:queryDef:where">
            <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          </element>
        </element>
        <element label="Formula" name="formula" xml="true">
          <attribute enum="operator" label="Operator" name="operator" type="byte"/>
          <attribute label="Left-hand value" name="leftValue" type="string"/>
          <attribute label="Right-hand value" name="rightValue" type="string"/>
        </element>
        <element label="Computed measure" name="computed" xml="true">
          <attribute label="Computed" name="computed" type="boolean"/>
          <attribute label="Formula" name="formula" type="string"/>
        </element>
        <element label="Cube" name="cube" revIntegrity="owncopy" revLink="measure" target="xtk:olapCube" type="link"/>
      </element>
      <methods>
        <method name="InvalidAggregates" static="true">
          <parameters>
            <param desc="The measure" inout="in" name="masure" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Operators of the application" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:operator.png" implements="xtk:persist" label="Operators" labelSingular="Operator" name="operator" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="Mr" name="mr-mrs">
        <value label="Mr" name="Mr"/>
        <value label="Mrs" name="Mme"/>
        <value label="Miss" name="Ms"/>
      </enumeration>
      <enumeration basetype="short" default="operator" name="opType">
        <value img="xtk:operator.png" label="Operator" name="operator" value="0"/>
        <value img="xtk:group.png" label="Security group" name="group" value="1"/>
        <value img="xtk:grpright.png" label="Named rights" name="right" value="2"/>
      </enumeration>
      <enumeration default="none" name="imagePublishing">
        <value label="None" name="none" value="none"/>
        <value label="Tracking server(s)" name="tracking" value="tracking"/>
        <value label="Other Adobe Campaign server(s)" name="list" value="list"/>
        <value label="Manual publication script" name="script" value="script"/>
      </enumeration>
      <enumeration default="encrypt" name="encryptionFilterAction">
        <value label="Encrypt" name="encrypt" value="encrypt"/>
        <value label="Decrypt" name="decrypt" value="decrypt"/>
        <value label="Delete" name="remove" value="remove"/>
        <value label="Write" name="set" value="set"/>
      </enumeration>
      <enumeration name="encryptionStep">
        <value label="Approvals" name="AppendDeliveryPart_deliveryPart_message" value="AppendDeliveryPart_deliveryPart_message"/>
        <value label="GetMidBroadLog/broadLog" name="GetMidBroadLog_broadLog" value="GetMidBroadLog_broadLog"/>
        <value label="SubmitMidSourcing/delivery" name="SubmitMidSourcing_delivery" value="SubmitMidSourcing_delivery"/>
      </enumeration>
      <element name="encryptionStep">
        <attribute name="enabled" type="boolean"/>
        <element name="action" ordered="true" unbound="true" xml="true">
          <key internal="true" name="encryptionStepActionId">
            <keyfield xpath="@xpath"/>
          </key>
          <attribute name="xpath" type="string"/>
          <attribute enum="encryptionFilterAction" name="action" type="string"/>
          <attribute name="value" type="string"/>
        </element>
      </element>
      <element name="operatorAssignee" xml="true">
        <element label="Approval" name="validation" ref="nms:common:validation"/>
        <element label="Reminder" name="reminder" ordered="true" ref="nms:common:reminder" unbound="true" xml="true"/>
        <element label="Reviewer" name="primaryAssignee" revLink="_NONE_" target="xtk:opsecurity" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@primaryAssignee-id"/>
        </element>
        <attribute advanced="true" label="Foreign key of the 'Reviewer' link (field 'id')" name="primaryAssignee-id" type="long" xml="true"/>
        <attribute label="Compute-string of 'primaryAssignee' link" name="primaryAssignee-cs" type="string" xml="true"/>
        <attribute advanced="true" label="Reviewer type (operator/group)" name="primaryAssignee-type" type="byte" xml="true"/>
        <element label="List of additional reviewers" name="assignee" unbound="true" xml="true">
          <compute-string expr="@id"/>
          <key internal="true" name="assigneeId">
            <keyfield xpath="@id"/>
          </key>
          <attribute default="Gid()" label="Primary key" name="id" type="string" xml="true"/>
          <element label="Operator" name="operator" revLink="_NONE_" target="xtk:operator" type="link" xml="true">
            <join xpath-dst="@id" xpath-src="@operator-id"/>
          </element>
          <attribute advanced="true" label="Foreign key of the 'Operator' link (field 'id')" name="operator-id" type="long" xml="true"/>
          <attribute label="Compute-string of the 'operator' link" name="operator-cs" type="string" xml="true"/>
        </element>
      </element>
      <element autopk="true" enumImage="@type" folderLink="folder" folderModel="xtkOperator" fullLoad="true" img="xtk:operator.png" label="Operator" name="operator" pkgAdmin="@id != 0">
        <compute-string expr="@label + ' (' + @name + ')'"/>
        <key name="name">
          <keyfield xpath="@type"/>
          <keyfield xpath="@name"/>
        </key>
        <dbindex name="label">
          <keyfield xpath="@type"/>
          <keyfield xpath="@label"/>
        </dbindex>
        <attribute default="false" desc="Disable account" label="Account disabled" name="disable" type="boolean"/>
        <attribute enum="opType" label="Type" name="type" pkgStatus="always" type="short"/>
        <attribute defOnDuplicate="true" default="GetOption('XtkInstancePrefix')+Iif(@type=0, 'LOGIN', Iif(@type=1, 'GRP', 'RIGHT'))+CounterValue('xtkOperator')" label="Name" length="64" name="name" required="true" type="string"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute label="External identifier" length="64" name="externalId" type="string"/>
        <element name="desc" template="xtk:common:desc"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute advanced="true" desc="Graphical theme for the operator" label="Theme" length="64" name="theme" type="string" userEnum="theme"/>
        <attribute name="email" template="xtk:common:email"/>
        <attribute name="mobilePhone" template="xtk:common:mobilePhone"/>
        <attribute label="Department" length="80" name="department" type="string" userEnum="department"/>
        <element label="Depends on" name="reportsTo" target="xtk:operator" type="link"/>
        <element applicableIf="HasPackage('nms:core')" label="Organizational entity" name="localOrgUnit" revIntegrity="define" revLabel="Operators" target="nms:localOrgUnit" type="link"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkOperator', [@_folder-id])" label="Operator folder" name="folder" required="true" revDesc="Operators contained in this folder" revIntegrity="define" revLabel="Operators" target="xtk:folder" type="link"/>
        <element label="Dashboard" name="dashboard" revIntegrity="define" target="xtk:dashboard" type="link"/>
        <attribute dbEnum="securityZone" default="'vpn'" label="Authorized connection zone" length="64" name="securityZone" type="string"/>
        <element label="Access" name="access">
          <attribute label="Password" length="128" name="password" type="string"/>
          <attribute default="false" desc="Forbid access from the rich client" label="No access using from rich client" name="noConsoleCnx" type="boolean" xml="true"/>
          <attribute dbEnum="authenticationType" default="'native'" label="Authentication type" length="6" name="authenticationType" type="string"/>
          <element label="Root folder" name="homeDir" type="string" xml="true">
            <attribute default="false" label="Enabled" name="activated" type="boolean"/>
            <attribute label="Folder full name" localizable="true" name="fullName" type="string"/>
          </element>
          <element label="Trusted IP addresses" name="trustedIP" unbound="true" xml="true">
            <attribute desc="Mask. E.g. 192.168.1.0/24" label="Mask" length="18" name="mask" type="string"/>
          </element>
        </element>
        <element applicableIf="hasPackage('nms:exchangeSynchronization')" label="MS Exchange synchronization" name="ExchangeSynchronization" xml="true">
          <attribute label="MS Exchange identifier" name="login" type="string"/>
          <attribute label="Password" name="password" type="string"/>
          <attribute label="MS Exchange email" name="email" type="string"/>
        </element>
        <element applicableIf="HasPackage('nms:midReceiver')" name="tracking" xml="true">
          <attribute label="Tracking instance" length="32" name="instance" type="string"/>
          <attribute label="Tracking password" length="64" name="password" type="string"/>
          <attribute label="Internal URLs of the tracking servers" name="servers" type="string"/>
        </element>
        <element applicableIf="HasPackage('nms:midReceiver')" name="imagePublishing" xml="true">
          <attribute enum="imagePublishing" label="Publication mode" name="method" type="string"/>
          <attribute label="Publication script" name="script" type="string"/>
          <attribute label="List of hosting server URLs" name="mediaServers" type="string"/>
          <attribute label="Hosting instance" length="32" name="mediaInstance" type="string"/>
          <attribute label="Password" length="64" name="mediaPwd" type="string"/>
        </element>
        <element applicableIf="HasPackage('nms:midReceiver')" name="encryption" xml="true">
          <attribute label="AES key" name="aeskey" type="string"/>
          <attribute label="Active" name="active" type="boolean"/>
          <element label="deliveryPart_message" name="AppendDeliveryPart_deliveryPart_message" ref="xtk:operator:encryptionStep"/>
          <element advanced="true" label="broadLog" name="GetMidBroadLog_broadLog" ref="xtk:operator:encryptionStep"/>
          <element advanced="true" label="delivery" name="SubmitMidSourcing_delivery" ref="xtk:operator:encryptionStep"/>
        </element>
        <attribute default="'_server_'" desc="Operator time zone" name="timezone" template="xtk:common:timezone"/>
        <attribute dbEnum="dictionaryLocale" desc="Regional settings used for number and date formatting" label="Regional settings" length="64" name="locale" type="string"/>
      </element>
      <methods>
        <method name="CheckRights" static="true">
          <parameters>
            <param desc="List of group IDs (comma separated)" name="groupList" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:group.png" implements="xtk:persist" label="Operator and group associations" labelSingular="Association of operator and group" name="operatorGroup" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="false" enumImage="group/@type" name="operatorGroup">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key internal="true" name="id">
          <keyfield xlink="group"/>
          <keyfield xlink="operator"/>
        </key>
        <element integrity="neutral" label="Group" name="group" revIntegrity="owncopy" revLabel="Operators in the group" target="xtk:group" type="link"/>
        <element integrity="neutral" label="Operator" name="operator" revIntegrity="owncopy" revLabel="Operator groups" target="xtk:operator" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Application operators or operator groups" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:operator.png" implements="xtk:persist" label="Operators or groups" labelSingular="Operator or group" name="opsecurity" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" enumImage="@type" folderLink="folder" folderModel="xtkOperator, xtkGroup" fullLoad="true" img="xtk:operator.png" label="Operators or groups" name="opsecurity" sqltable="XtkOperator">
        <compute-string expr="@label + ' (' + @name + ')'"/>
        <key name="name">
          <keyfield xpath="@type"/>
          <keyfield xpath="@name"/>
        </key>
        <dbindex name="label">
          <keyfield xpath="@type"/>
          <keyfield xpath="@label"/>
        </dbindex>
        <attribute name="id" sqlname="iOperatorId" type="long"/>
        <attribute enum="xtk:operator:opType" label="Type" name="type" pkgStatus="always" type="short"/>
        <attribute defOnDuplicate="true" label="Name" length="64" name="name" required="true" type="string"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="desc" template="xtk:common:desc"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkOperator', [@_folder-id])" label="Folder" name="folder" required="true" revDesc="Operators and groups contained in this folder" revIntegrity="define" revLabel="Operators and groups" target="xtk:folder" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Application options" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:option.png" implements="xtk:persist" label="Options" labelSingular="Option" name="option" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="user" label="Option type" name="type">
        <value label="User" name="user" value="0"/>
        <value label="System" name="system" value="1"/>
      </enumeration>
      <element autopk="true" img="xtk:option.png" name="option" pkgAdmin="@type = 0 AND @id != 0" pkgPlatform="@type = 1 AND @id != 0">
        <compute-string expr="@name"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute dataPolicy="none" length="128" name="name" template="xtk:common:name"/>
        <attribute enum="type" label="Option type" name="type" type="byte"/>
        <element edit="memo" label="Description" length="512" localizable="true" name="desc" type="string"/>
        <element aggregate="xtk:common:variant" name="variant"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Data package" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:installedPackage.png" implements="xtk:persist" label="Packages" labelSingular="Package" mappingType="xmlFile" name="package" namespace="xtk" xtkschema="xtk:srcSchema">
      <element dataSource="file" name="package" pkgStatus="never" sqltable="XtkEntity">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <compute-string expr="@label"/>
        <key name="id">
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute name="label" template="xtk:common:label"/>
        <attribute default="'xtk:installedPackage.png'" name="img" type="string"/>
        <attribute label="Installation date" name="installDate" type="datetime"/>
        <attribute label="Installation type" name="installTypes" type="string"/>
        <attribute label="Hidden package" name="hidden" type="boolean"/>
        <attribute label="Display sequence" name="order" type="long"/>
        <attribute label="Force invalidation of schemas" name="forceInvalidateSchemas" type="boolean"/>
        <attribute label="Do not update the physical structure of the database" name="noDbStructureUpdate" type="boolean"/>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <element length="2000" name="desc" template="xtk:common:desc"/>
        <attribute desc="Package supplier" label="Distributor" name="vendor" type="string"/>
        <element label="Entity collection" name="entities" ordered="true" type="ANY" unbound="true">
          <attribute name="label" template="xtk:common:label"/>
          <attribute label="Name of entity schema" name="schema" type="string"/>
          <attribute label="Name of the package that must be activated in order to take into account these entities to be imported" name="ifHasPackage" type="string"/>
        </element>
        <element label="Extension collection" name="patch" ordered="true" type="ANY" unbound="true">
          <attribute label="Entity name" name="id" type="string"/>
          <attribute label="Entity schema" name="schema" type="string"/>
        </element>
        <element name="strings" ref="xtk:strings:strings"/>
        <element name="depends" unbound="true">
          <key name="package">
            <keyfield xpath="@package"/>
          </key>
          <attribute name="package" type="string"/>
        </element>
        <element name="preSql" unbound="true">
          <key name="id">
            <keyfield xpath="@datakitId"/>
          </key>
          <attribute name="datakitId" type="string"/>
          <attribute name="engine" type="string"/>
        </element>
        <element name="postSql" unbound="true">
          <key name="id">
            <keyfield xpath="@datakitId"/>
          </key>
          <attribute name="datakitId" type="string"/>
          <attribute name="engine" type="string"/>
        </element>
        <element desc="Package installation javascript code" label="javascript code" name="installScript" type="string"/>
        <element label="Datakit schema" name="entity" unbound="true">
          <attribute label="Schema XPath" name="id" type="string"/>
          <attribute label="Entity schema" name="schema" type="string"/>
          <attribute label="Expression using 'HasPackages' to take these entities to import into account" name="applicableIf" type="string"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Import one or more packages" entitySchema="xtk:srcSchema" img="xtk:installedPackage.png" implements="xtk:persist" label="Package imports" labelSingular="Import packages" name="packageInstall" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" name="packageInstall" pkgStatus="never">
        <compute-string expr="@name"/>
        <attribute default="'PI'+CounterValue('xtkpackageInstall')" desc="Installation identifier" label="Identifier" length="16" name="name" type="string"/>
        <attribute desc="Installation description" label="Description" length="80" name="label" type="string"/>
        <attribute default="GetDate()" label="Installation date" name="installDate" type="datetime"/>
        <element integrity="own" label="Installation log" name="log" revLink="job" target="xtk:jobLog" type="link" unbound="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Contents of installation packages" labelSingular="Package installation relation" name="pkgInstRel" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="pkgInstRel" pkgStatus="never">
        <key internal="true" name="id">
          <keyfield xlink="packageInstall"/>
          <keyfield xlink="package"/>
        </key>
        <element integrity="neutral" label="Package" name="package" revIntegrity="own" revLabel="Installations" revLink="installations" target="xtk:package" type="link"/>
        <element integrity="neutral" label="Installation" name="packageInstall" revIntegrity="own" revLabel="Packages" revLink="packages" target="xtk:packageInstall" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="" implements="xtk:persist" label="Definition of queries" mappingType="xmlFile" name="queryDef" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" name="boolOperator">
        <value label="And" name="AND"/>
        <value label="Or" name="OR"/>
      </enumeration>
      <enumeration basetype="string" name="operation">
        <value name="get"/>
        <value name="getIfExists"/>
        <value name="select"/>
        <value name="count"/>
      </enumeration>
      <enumeration basetype="string" name="setOperator">
        <value name="EXISTS"/>
        <value name="NOT EXISTS"/>
        <value name="COUNT"/>
        <value name="SUM"/>
        <value name="AVG"/>
        <value name="MIN"/>
        <value name="MAX"/>
        <value name="IN"/>
        <value name="NOT IN"/>
      </enumeration>
      <enumeration basetype="boolean" name="rowConditionType">
        <value label="All rows" name="allRows" value="-1"/>
        <value label="Limit the line count" name="multiple" value="0"/>
        <value label="Single row (expert user)" name="singleRow" value="1"/>
        <value label="Aggregates" name="aggregate" value="2"/>
        <value enabledIf="'$(entityPath)'='/workflow'" label="Merge" name="merge" value="3"/>
      </enumeration>
      <element name="rowsConditionLink">
        <attribute label="Lines to retrieve" name="lineCount" type="long"/>
        <attribute desc="Fetch a single row for a collection (optimized mode)" label="Fetch a single row" name="singleRow" type="boolean"/>
        <attribute desc="Calculate aggregates on all collection rows" label="Group by" name="groupBy" type="boolean"/>
        <attribute label="Internal value used to identify the conditionLink element" name="conditionLink" type="boolean"/>
      </element>
      <element name="node">
        <key allowEmptyPart="true" name="node">
          <keyfield xpath="@expr"/>
          <keyfield xpath="@alias"/>
        </key>
        <attribute label="Expression" name="expr" type="string"/>
        <attribute label="Native SQL expression" name="sql" type="string"/>
        <attribute label="Hidden field" name="hidden" type="boolean"/>
        <attribute label="Size" name="colSize" type="short"/>
        <attribute label="Formatting" name="displayFormat" type="string"/>
        <attribute label="Type" name="type" type="string"/>
        <attribute label="Descending sort" name="sortDesc" type="boolean"/>
        <attribute label="Alias" name="alias" type="string"/>
        <attribute label="Label" localizable="true" name="label" type="string"/>
        <attribute label="Type" name="dataType" type="string"/>
        <attribute label="No SQL binding on expression constants" name="noSqlBind" type="boolean"/>
        <attribute label="Group" name="groupBy" type="boolean"/>
        <attribute label="Ignore expression" name="ignore" type="boolean"/>
        <attribute label="Action" name="action" type="string"/>
        <attribute label="Reference for describing the expected column result" name="ref" type="string"/>
        <attribute label="Non sortable node" name="noSortable" type="boolean"/>
        <attribute label="Node of type any" name="anyType" type="boolean"/>
        <attribute label="Editable field" name="editable" type="boolean"/>
        <attribute label="Sort" name="sort" type="boolean"/>
        <attribute name="_init" pkgStatus="never" type="boolean"/>
        <attribute name="noComputeString" type="boolean"/>
        <element aggregate="xtk:queryDef:rowsConditionLink" name="rowsConditionLink"/>
        <attribute label="Force the use of an index on the table associated with the node" name="forceIndexHint" type="string"/>
        <attribute label="Enabling script" name="enabledIf" type="string"/>
        <attribute default="false" desc="Data analysis mode (displays labels instead of values)" label="Data analysis mode" name="analyze" type="boolean"/>
        <attribute label="Value" name="value" type="string"/>
        <attribute label="Label" name="valueLabel" type="string"/>
        <element name="node" ordered="true" ref="node" unbound="true"/>
        <element name="where" ref="where"/>
      </element>
      <element name="select">
        <attribute name="name" type="string"/>
        <attribute name="ref" type="string"/>
        <attribute label="Alias" name="alias" type="string"/>
        <element name="node" ordered="true" ref="xtk:queryDef:node" unbound="true"/>
      </element>
      <element name="filter" type="ANY"/>
      <element name="condition">
        <key internal="true" name="internalId">
          <keyfield xpath="@internalId"/>
        </key>
        <key name="condition">
          <keyfield xpath="@expr"/>
        </key>
        <attribute label="Expression" name="expr" type="string"/>
        <attribute label="Reference path" name="xpath" type="string"/>
        <attribute defOnDuplicate="true" default="Gid()" label="Auto-generated identifier" name="internalId" type="string"/>
        <attribute enum="xtk:queryDef:boolOperator" label="Operator" name="boolOperator" type="string"/>
        <attribute enum="xtk:queryDef:setOperator" label="Set operator" name="setOperator" type="string"/>
        <attribute label="Ignore condition" name="ignore" type="boolean"/>
        <attribute label="Composite key" name="compositeKey" type="string"/>
        <attribute label="Dependency key" name="dependkey" type="string"/>
        <attribute label="Enabling script" name="enabledIf" type="string"/>
        <attribute label="No SQL binding on expression constants" name="noSqlBind" type="boolean"/>
        <attribute label="Native SQL expression" name="sql" type="string"/>
        <attribute advanced="true" label="String representing the XML of the subQuery element" name="subQuery" type="string"/>
        <attribute label="Table Alias in the FROM clause" name="aliasSqlTable" type="string"/>
        <attribute label="Name of the predefined filter" name="filter-name" type="string" xml="true"/>
        <attribute label="Predefined filter label" name="filterLabel" type="string"/>
        <element name="condition" ordered="true" ref="xtk:queryDef:condition" unbound="true"/>
        <element name="subQuery" ref="xtk:queryDef:queryDef"/>
      </element>
      <element name="conditionLink">
        <key allowEmptyPart="true" name="xpath">
          <keyfield xpath="@xpath"/>
          <keyfield xpath="@alias"/>
        </key>
        <attribute label="Link path" name="xpath" type="string"/>
        <attribute label="Collection alias" name="alias" type="string"/>
        <attribute label="Link label" name="label" type="string"/>
        <attribute label="Schema of the link" name="schema" type="string"/>
        <element aggregate="xtk:queryDef:rowsConditionLink" name="rowsConditionLink"/>
        <element name="where" ref="xtk:queryDef:where"/>
        <element name="orderBy" ref="xtk:queryDef:orderBy"/>
      </element>
      <element name="where">
        <attribute label="Filtering" localizable="true" name="displayFilter" pkgStatus="never" type="string"/>
        <attribute label="Schema to extend" name="extendedSchema" type="string"/>
        <attribute label="Include an optimizer hint" name="forceHint" type="string"/>
        <attribute label="Filter name" name="filterName" type="string" xml="true"/>
        <element name="condition" ordered="true" ref="xtk:queryDef:condition" unbound="true"/>
        <element name="ctx" type="ANY"/>
      </element>
      <element name="sysFilter" unbound="true">
        <key name="sysFilter">
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Filtering" name="displayFilter" pkgStatus="never" type="string"/>
        <attribute label="Include an optimizer hint" name="forceHint" type="string"/>
        <attribute label="Filter name" name="name" type="string"/>
        <attribute label="Deactivate filter" name="inactive" type="boolean"/>
        <element name="condition" ordered="true" ref="condition" unbound="true"/>
      </element>
      <element name="having">
        <element name="condition" ordered="true" ref="condition" unbound="true"/>
      </element>
      <element name="orderBy">
        <attribute label="Sort" name="displayOrder" type="string"/>
        <element name="node" ordered="true" ref="node" unbound="true"/>
      </element>
      <element name="groupBy">
        <attribute label="Grouping" name="displayGroup" type="string"/>
        <element name="node" ordered="true" ref="node" unbound="true"/>
      </element>
      <element name="queryDef" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key name="querydef">
          <keyfield xpath="@schema"/>
        </key>
        <attribute name="xtkschema" type="string"/>
        <attribute desc="Schema name" label="Schema" name="schema" type="string"/>
        <attribute label="Initial path" name="startPath" type="string"/>
        <attribute enum="operation" label="Operation" name="operation" type="string"/>
        <element label="Temporary execution schema" name="tempSchemas" type="ANY"/>
        <element label="Execution context" name="ctx" type="ANY"/>
        <attribute label="Starting line" name="startLine" type="long"/>
        <attribute label="Lines to retrieve" name="lineCount" type="long"/>
        <attribute label="Take 0 ID records into account" name="noChangeOnAutoPkLineCount" type="boolean"/>
        <attribute label="Sort on column number" name="sortCol" type="short"/>
        <attribute label="Force indexes" name="firstRows" type="boolean"/>
        <attribute label="Keep the order of the expression in the Select statement" name="forceExprOrder" type="boolean"/>
        <attribute label="Full load of document" name="fullLoad" type="boolean"/>
        <attribute label="Delete doubles" name="distinct" type="boolean"/>
        <attribute label="Recompute automatic key" name="newAutoPk" type="boolean"/>
        <attribute label="Display elements flagged to delete" name="ignoreDeleteStatus" type="boolean"/>
        <attribute label="Returns data memo as a 'data' element" name="unExpandMemoData" type="boolean"/>
        <attribute default="false" label="Returns generated SQL queries in a 'dataSQL' sub-element" name="showSQL" type="boolean"/>
        <attribute label="No SELECT clause" name="hideSelect" type="boolean"/>
        <attribute label="No WHERE clause" name="hideWhere" type="boolean"/>
        <attribute label="No ORDER BY clause" name="hideOrderby" type="boolean"/>
        <attribute label="Force entity loading from database" name="loadEntity" type="boolean"/>
        <attribute label="Id of the filtered folder" name="folderFilter" type="long"/>
        <attribute default="false" label="Checks whether or not the query contains active 'enabledIf' conditions" name="checkActiveEnabledIf" type="boolean"/>
        <attribute label="Apply the data extension" name="expandParam" type="boolean"/>
        <attribute default="false" desc="Data analysis mode (displays labels instead of values)" label="Data analysis mode" name="analyze" type="boolean"/>
        <attribute default="false" label="Returns the foreign keys for links" name="externalKey" type="boolean"/>
        <attribute default="0" label="Automatically exports up to N owned links." name="exportOwnedDepth" type="short"/>
        <attribute desc="Limit the maximum execution time of a request." label="Timeout" name="timeout" type="timespan"/>
        <attribute default="false" label="Disable the restriction condition for the connected operator" name="disableFolderCond" type="boolean"/>
        <attribute label="Add a data grouping clause" name="activeHaving" type="boolean"/>
        <attribute label="Do not limit the number of lines returned by the query" name="noLineCount" type="boolean"/>
        <element name="select" ref="select"/>
        <element name="conditionLink" ref="conditionLink" unbound="true"/>
        <element name="where" ref="where"/>
        <element name="groupBy" ref="groupBy"/>
        <element name="having" ref="having"/>
        <element name="orderBy" ref="orderBy"/>
        <element name="filter" ref="filter"/>
        <element name="sysFilter" ref="sysFilter" unbound="true"/>
      </element>
      <methods async="true">
        <method name="SelectAll">
          <parameters>
            <param desc="Specifies whether we are duplicating, in which case adds all OwnCopy elements." inout="in" name="duplicate" type="boolean"/>
          </parameters>
        </method>
        <method const="true" name="ExecuteQuery">
          <parameters>
            <param desc="Output XML document" inout="out" name="output" type="DOMDocument"/>
          </parameters>
        </method>
        <method const="true" name="GetInstanceFromModel">
          <parameters>
            <param desc="Output XML document" inout="out" name="output" type="DOMDocument"/>
            <param desc="Instance schema" inout="in" name="schema" type="string"/>
          </parameters>
        </method>
        <method name="CreateInstanceFromModel" static="true">
          <parameters>
            <param desc="Instance schema" inout="in" name="schema" type="string"/>
            <param desc="ID of the template" inout="in" name="modelId" type="long"/>
            <param desc="XML patch to apply to the template" inout="in" name="diff" type="DOMElement"/>
            <param desc="ID of the created instance" inout="out" name="output" type="long"/>
          </parameters>
        </method>
        <method const="true" name="BuildQuery">
          <parameters>
            <param desc="Output query" inout="out" name="sql" type="string"/>
          </parameters>
        </method>
        <method const="true" name="BuildQueryEx">
          <parameters>
            <param desc="Output query" inout="out" name="sql" type="string"/>
            <param desc="Format string, compatible with the sqlSelect() JavaScript function." inout="out" name="format" type="string"/>
          </parameters>
        </method>
        <method name="Update" static="true">
          <parameters>
            <param desc="Context" inout="in" name="context" type="DOMElement"/>
          </parameters>
        </method>
        <method name="EvaluateExpr" static="true">
          <parameters>
            <param desc="Expression" inout="in" name="expr" type="string"/>
            <param desc="Result" inout="out" name="result" type="string"/>
          </parameters>
        </method>
        <method name="DisplayCondition" static="true">
          <parameters>
            <param desc="Full schema name" inout="in" name="schema" type="string"/>
            <param desc="The query filter" inout="in" name="where" type="DOMElement"/>
            <param desc="Result" inout="out" name="result" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Definition of application filters" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:filter.png" implements="xtk:persist" label="Predefined filters" labelSingular="Predefined filter" name="queryFilter" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="all" name="behaviorType">
        <value label="All recipients" name="all"/>
        <value label="Recipients associated with messages successfully sent" name="sent"/>
        <value label="Recipients who have opened or clicked (email)" name="open"/>
        <value label="Recipients who have clicked (email)" name="click"/>
        <value label="Recipients associated with failed messages" name="error"/>
        <value label="Recipients who have not opened or clicked (email)" name="notOpen"/>
        <value label="Recipients who have not clicked (email)" name="notClick"/>
      </enumeration>
      <element autopk="true" folderModel="xtkQueryFilter" img="xtk:filter.png" name="queryFilter" pkgAdmin="@id != 0">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'FLT'+CounterValue('xtkFilter')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="true" desc="Filter shared with other operators" label="Shared" name="shared" type="boolean"/>
        <attribute default="getOption('Nms_DefaultRcpSchema')" desc="Document types on which the filter applies" label="Document type" length="64" name="schema" required="true" type="string"/>
        <attribute desc="SQL table to which the filter applies" label="SQL table" length="64" name="sqlTable" type="string"/>
        <attribute default="'/'" label="Initial path" length="64" name="startPath" type="string"/>
        <attribute desc="Default filter for the associated document type" label="Default filter" name="default" type="boolean"/>
        <attribute desc="Main filter of the entity" label="Main filter" name="main" type="boolean"/>
        <attribute desc="This option prevents you from restricting the filter" label="Do not restrict the filter" name="noStack" type="boolean" xml="true"/>
        <attribute default="'xtk:filter.png'" desc="Filter image" label="Image" length="64" name="img" type="string"/>
        <element label="Condition" name="where" template="xtk:queryDef:where" xml="true">
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
        </element>
        <attribute default="false" desc="Use parameter entry form" label="Data entry form" name="hasForm" type="boolean"/>
        <attribute desc="Keyboard shortcut used to launch the filter" label="Keyboard shortcut" name="shortCut" type="short" xml="true"/>
        <element label="Data entry form definition" name="form" ref="xtk:form:form" type="ANY" xml="true"/>
        <element name="desc" template="xtk:common:desc"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkQueryFilter', [@_folder-id])" label="Folder" name="folder" required="true" revDesc="Filters in the folder" revIntegrity="define" revLabel="Filters" target="xtk:folder" type="link"/>
        <attribute advanced="true" desc="Visibility context schema" label="Visibility context" length="64" name="visibleFilterSchema" type="string" xml="true"/>
        <attribute advanced="true" label="Visibility expression" name="visibleFilterExpr" type="string" xml="true"/>
        <element applicableIf="HasPackage('nms:interaction')" label="Environment" name="env" revLink="_NONE_" target="nms:offerEnv" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Defines all the report parameters" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:report.png" implements="xtk:persist" label="Reports" labelSingular="Report" mergeable="true" name="report" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration name="cellType">
        <value _operation="delete" name="subscription"/>
        <value _operation="delete" name="captcha"/>
        <value img="xtk:form/constant.png" label="Value" name="value"/>
        <value img="xtk:form/pagebreak.png" label="Page break" name="pageBreak"/>
        <value img="xtk:form/kpi.png" label="KPI" name="kpi"/>
      </enumeration>
      <enumeration name="inputType">
        <value _operation="delete" name="subscription"/>
        <value _operation="delete" name="captcha"/>
        <value _operation="delete" name="file"/>
        <value _operation="delete" name="password"/>
        <value _operation="delete" name="textarea"/>
        <value _operation="delete" name="richTextArea"/>
        <value _operation="delete" name="constant"/>
      </enumeration>
      <enumeration basetype="string" default="qualitative" name="analysisModel">
        <value label="Distribution of n qualitative variables" name="qualitative"/>
        <value label="Quantitative distribution" name="quantitative"/>
      </enumeration>
      <enumeration basetype="string" default="full" name="reportType">
        <value label="Descriptive analysis" name="descriptiveAnalysis"/>
        <value label="Extended report" name="full"/>
      </enumeration>
      <enumeration basetype="string" default="portrait" name="paperOrientation">
        <value label="Portrait" name="portrait"/>
        <value label="Landscape" name="landscape"/>
      </enumeration>
      <enumeration basetype="string" default="A4" name="paperFormat">
        <value label="A3" name="A3"/>
        <value label="A4" name="A4"/>
        <value label="A5" name="A5"/>
        <value label="US Letter" name="usLetter"/>
        <value label="US Legal" name="usLegal"/>
      </enumeration>
      <enumeration basetype="string" default="width" name="scalingMode">
        <value label="None" name="none"/>
        <value label="To width" name="width"/>
        <value label="To page" name="page"/>
      </enumeration>
      <enumeration basetype="string" name="contextType">
        <value label="Selection" name="selection"/>
        <value label="Global" name="global"/>
      </enumeration>
      <enumeration basetype="string" name="quantitativeOperator" template="xtk:abstractForm:operator">
        <value label="Number of missing values" name="missingCount"/>
        <value label="Decile distribution" name="decile"/>
        <value label="Custom distribution" name="distribution"/>
      </enumeration>
      <element autopk="true" folderModel="xtkReport" img="xtk:report.png" name="report" pkgAdmin="@id != 0" template="xtk:abstractForm">
        <compute-string expr="@label + ' (' + @internalName + ')'"/>
        <key name="name">
          <keyfield xpath="@internalName"/>
        </key>
        <attribute default="false" label="Ad hoc report" name="adHocReport" type="boolean"/>
        <element name="cubeExplorer" template="xtk:abstractForm:cubeExplorer" xml="true"/>
        <element desc="Extension schemas used on executing the report" doesNotSupportDiff="true" label="Extension schemas" name="schemasExtension" type="ANY" xml="true"/>
        <attribute default="'xtk:report'" name="entitySchema"/>
        <attribute default="GetOption('XtkInstancePrefix')+'RPT'+counterValue('xtkReport')" name="internalName"/>
        <attribute default="'xtk:backgrounds/report.png'" name="background"/>
        <attribute default="0" name="accessControl"/>
        <attribute length="80" name="schema" xml="false"/>
        <attribute length="80" name="schemaLink" xml="false"/>
        <attribute default="false" label="Disable history" name="noHistory" type="boolean" xml="true"/>
        <attribute default="true" desc="Report shared with other operators" label="Shared" name="shared" type="boolean"/>
        <attribute default="Iif(@type='descriptiveAnalysis', 'xtk:report/thumbs/descriptiveAnalysis.png',Iif(@adHocReport=1, 'xtk:report/thumbs/nmx.png', 'xtk:report/thumbs/default.png'))" desc="Report image" label="Image" length="64" name="img" type="string"/>
        <attribute label="Category" length="128" localizable="true" name="category" type="string" userEnum="reportCategory"/>
        <attribute default="0" desc="Display order" label="Order" name="order" type="long"/>
        <attribute default="false" desc="Displays the reports in the main dashboard" label="Preferred" name="prefered" type="boolean"/>
        <attribute desc="Calculation formula used for the history description" label="History description" length="128" localizable="true" name="historyComputeString" type="string"/>
        <attribute default="true" label="Single-selection" name="monoselection" type="boolean"/>
        <attribute default="true" label="Multiple selection" name="multiselection" type="boolean"/>
        <attribute default="iif([@targetReport-id] = 0, true, false)" label="Global" name="isGlobal" type="boolean"/>
        <attribute advanced="true" label="Expression for label calculation" localizable="true" name="labelExpr" sql="true" type="string"/>
        <attribute label="Link key" length="80" name="link" type="string"/>
        <attribute label="Overload folder filter" name="folderFilter" type="boolean"/>
        <element name="linkFilter">
          <element name="where" template="xtk:queryDef:where" xml="true">
            <attribute expr="[../../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          </element>
        </element>
        <element label="visibility condition" name="visibleIf" template="xtk:queryDef:where" xml="true">
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
        </element>
        <element advanced="true" desc="SQL query to be executed when testing report visibility based on the selected entity. (Calculated during report publishing)" label="generated visibility condition" name="visibleIfSql" pkgStatus="never" type="memo"/>
        <attribute advanced="true" desc="Expression to be executed when testing its visibility based on display context. (Calculated during report publication)" label="visibility condition" name="visibleIfExpr" pkgStatus="never"/>
        <element label="Target report" name="targetReport" revLabel="Associated links" revLink="links" target="xtk:report" type="link"/>
        <element defOnDuplicate="true" default="iif(@isModel, DefaultFolder('xtkReportModel', [@_folder-id]), DefaultFolder('xtkReport', [@_folder-id]))" name="folder" revDesc="Reports contained in this folder" revLabel="Reports" revLink="reports" revTarget="xtk:report"/>
        <element label="Activities" name="activities" xml="true">
          <element name="start" template="xtk:abstractForm:start" unbound="true"/>
          <element doesNotSupportDiff="true" name="page" template="xtk:abstractForm:page" unbound="true">
            <element autopk="true" label="Page break" name="pageBreak" template="xtk:abstractForm:cell" unbound="true" xml="true">
              <attribute localizable="true" name="label" translatedDefault="'Page break '+ColIndex()"/>
            </element>
            <element label="Data analysis" name="analysis" unbound="true" xml="true">
              <attribute enum="analysisModel" length="16" name="model" type="string"/>
              <attribute default="true" label="Chart" name="hasChart" type="boolean"/>
              <attribute default="true" label="Array" name="hasTable" type="boolean"/>
              <element name="chart" ref="chart"/>
              <element name="table" ref="table"/>
              <element name="data" ref="data"/>
            </element>
            <attribute default="true" label="Exportable" name="exportable" type="boolean"/>
            <attribute default="false" label="Allow large data export" name="exportAllData" type="boolean"/>
            <attribute enum="paperOrientation" label="Orientation" name="paperOrientation" type="string"/>
            <attribute enum="paperFormat" label="Format" localizable="true" name="paperFormat" type="string"/>
            <attribute enum="scalingMode" label="Adjust" name="scalingMode" type="string"/>
            <attribute default="0.75" desc="Size of top margin in cm" label="Top margin" name="marginTop" type="float"/>
            <attribute default="1.91" desc="Size of the bottom margin in cm" label="Bottom margin" name="marginBottom" type="float"/>
            <attribute default="0.75" desc="Size of the left margin in cm" label="Left margin" name="marginLeft" type="float"/>
            <attribute default="0.75" desc="Size of the right margin in cm" label="Right margin" name="marginRight" type="float"/>
            <attribute default="0.76" desc="Size of the header in cm" label="Size of the header" name="headerSize" type="float"/>
            <attribute default="0.76" desc="Size of the footer in cm" label="Size of the footer" name="footerSize" type="float"/>
            <attribute default="7" label="Minimum number of columns" name="minColCount" type="int"/>
          </element>
          <element name="test" ref="xtk:abstractForm:test" unbound="true"/>
          <element name="script" ref="xtk:abstractForm:script" unbound="true"/>
          <element name="query" template="xtk:abstractForm:query" unbound="true"/>
          <element name="jump" template="xtk:abstractForm:jump" unbound="true">
            <element label="Target report" name="externalTarget" revLabel="Reports using this" revLink="links" target="xtk:report" type="link"/>
          </element>
        </element>
        <element aggregate="xtk:job:modelSupport" name="modelSupport"/>
        <element defOnDuplicate="true" default="DefaultFolder('xtkReport', [@_folderProcess-id])" img="xtk:execute.png" label="Instances folder" name="folderProcess" required="true" revDesc="Report templates generating instances in this folder" revIntegrity="define" revLabel="Report templates" revLink="reportFolderProcess" revTarget="xtk:report" target="xtk:folder" type="link"/>
        <attribute enum="reportType" label="Report type" length="20" name="type" type="string"/>
      </element>
      <methods async="true">
        <method name="GetDescriptiveAnalysisData" static="true">
          <parameters>
            <param desc="XML document describing the chart" inout="in" name="entity" type="DOMElement"/>
            <param desc="XML context used to filter the data" inout="in" name="context" type="DOMDocument"/>
            <param desc="Data in XML format" inout="out" name="data" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="DisplayDescriptiveAnalysis" static="true">
          <parameters>
            <param desc="Definition of the analysis." inout="in" name="entity" type="DOMDocument"/>
            <param inout="in" name="serverUrl" type="string"/>
            <param desc="HTML source of the page to display the result of the analysis." inout="out" name="html" type="string"/>
          </parameters>
        </method>
        <method name="DisplayDescriptiveAnalysisEx" static="true">
          <parameters>
            <param desc="Definition of the analysis." inout="in" name="entity" type="DOMElement"/>
            <param desc="Execution context." inout="in" name="execContext" type="DOMElement"/>
            <param inout="in" name="serverUrl" type="string"/>
            <param desc="HTML source of the page to display the result of the analysis." inout="out" name="html" type="string"/>
          </parameters>
        </method>
        <method name="GenerateAnalysisWidget" static="true">
          <parameters>
            <param desc="XML document describing the widget" inout="in" name="entity" type="DOMDocument"/>
            <param desc="Unique ID of the widget" inout="in" name="javascriptId" type="string"/>
            <param desc="XML document containing the data" inout="in" name="queryResult" type="DOMDocument"/>
            <param desc="Widget creation JavaScript" inout="out" name="javascript" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="RegisterTransientSchema" static="true">
          <parameters>
            <param desc="Schema name" inout="in" name="name" type="string"/>
            <param desc="Schema label" inout="in" name="label" type="string"/>
            <param desc="SQL name of the table" inout="in" name="sqltable" type="string"/>
            <param desc="Query definition" inout="in" name="query" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ExecuteTransientQuery" static="true">
          <parameters>
            <param desc="Schema name" inout="in" name="name" type="string"/>
            <param desc="Schema label" inout="in" name="label" type="string"/>
            <param desc="SQL name of the table" inout="in" name="sqltable" type="string"/>
            <param desc="Query definition" inout="in" name="query" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetReportList" static="true">
          <parameters>
            <param desc="Active context (selection, global)" inout="in" name="activeContext" type="string"/>
            <param desc="Schema involved" inout="in" name="schema" type="string"/>
            <param inout="in" name="selection" type="string"/>
            <param inout="in" name="locationName" type="string"/>
            <param desc="List of eligible reports" inout="out" name="reports" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetAvailableReports" static="true">
          <parameters>
            <param desc="Active context (selection, global)" inout="in" name="activeContext" type="string"/>
            <param desc="Schema involved" inout="in" name="schema" type="string"/>
            <param inout="in" name="selection" type="string"/>
            <param inout="in" name="locationName" type="string"/>
            <param inout="in" name="filter" type="string"/>
            <param desc="List of eligible reports" inout="out" name="reports" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetAvailableReportsEx" static="true">
          <parameters>
            <param desc="Active context (selection, global)" inout="in" name="activeContext" type="string"/>
            <param desc="Schema involved" inout="in" name="schema" type="string"/>
            <param desc="IDs of the selected entities, separated by ','" inout="in" name="selection" type="string"/>
            <param desc="Filtering 'where' node" inout="in" name="where" type="DOMDocument"/>
            <param desc="Sorting 'orderBy' node" inout="in" name="orderBy" type="DOMDocument"/>
            <param desc="During editing, non-published reports are also visible" inout="in" name="editionMode" type="long"/>
            <param desc="Number of reports to collect" inout="in" name="lineCount" type="long"/>
            <param desc="Offset to apply for page numbering" inout="in" name="startLine" type="long"/>
            <param inout="in" name="locationName" type="string"/>
            <param desc="List of eligible reports" inout="out" name="reports" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="Save" static="true">
          <parameters>
            <param desc="Data used by the reports" inout="in" name="data" type="DOMElement"/>
            <param desc="Internal name of the report" inout="in" name="reportName" type="string"/>
            <param desc="Unique identifier and record date" inout="out" name="result" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="Publish" static="true">
          <parameters>
            <param desc="Selection" inout="in" name="where" type="DOMElement"/>
          </parameters>
        </method>
        <method name="DictionaryCheck" static="true">
          <parameters>
            <param desc="Selection." inout="in" name="where" type="DOMElement"/>
            <param desc="Translation statistics." inout="out" name="stats" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GenerateAndSaveReport" static="true">
          <parameters>
            <param desc="Internal name of the report" inout="in" name="reportName" type="string"/>
            <param desc="Report configuration" inout="in" name="context" type="DOMDocument"/>
            <param desc="Unique identifier and record date" inout="out" name="result" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GenerateFlatReport" static="true">
          <parameters>
            <param desc="Internal name of the report" inout="in" name="reportName" type="string"/>
            <param inout="in" name="context" type="DOMDocument"/>
            <param inout="out" name="flatReport" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="ExportDescriptiveAnalysis" static="true">
          <parameters>
            <param desc="Definition of the descriptive analysis" inout="in" name="entity" type="DOMDocument"/>
            <param desc="Execution context." inout="in" name="execContext" type="DOMDocument"/>
            <param desc="Export format" inout="in" name="exportFormat" type="string"/>
            <param desc="Export format" inout="out" name="fileName" type="string"/>
          </parameters>
        </method>
        <method name="Export" static="true">
          <parameters>
            <param desc="Internal name of the report" inout="in" name="reportName" type="string"/>
            <param desc="Execution context." inout="in" name="context" type="DOMDocument"/>
            <param desc="Export format" inout="in" name="exportFormat" type="string"/>
            <param desc="Output file name" inout="in" name="fileName" type="string"/>
            <param desc="Specifies whether the export concerns an ad hoc report" inout="in" name="isAdHoc" optional="true" type="boolean"/>
          </parameters>
        </method>
        <method hidden="true" library="xtk:exportReport.js" name="export" static="true">
          <parameters>
            <param desc="Internal name of the report" inout="in" name="reportName" type="string"/>
            <param inout="in" name="context" type="DOMDocument"/>
            <param desc="Export format" inout="in" name="exportFormat" type="string"/>
            <param desc="Output file name" inout="in" name="fileName" type="string"/>
            <param desc="Specifies whether the export concerns an ad hoc report" inout="in" name="isAdHoc" optional="true" type="boolean"/>
          </parameters>
        </method>
        <method library="xtk:exportReport.js" name="exportSaved" static="true">
          <parameters>
            <param desc="Report history ID" inout="in" name="reportHistoryId" type="string"/>
            <param desc="Export format" inout="in" name="exportFormat" type="string"/>
            <param desc="Output file name" inout="in" name="fileName" type="string"/>
          </parameters>
        </method>
        <method name="GetUsedLanguagesEnum" static="true">
          <parameters>
            <param desc="Design language" inout="in" name="designLanguage" type="string"/>
            <param desc="Default language" inout="in" name="defaultLanguage" type="string"/>
            <param desc="Other languages" inout="in" name="additionalLanguages" type="DOMElement"/>
            <param desc="Enumeration with the languages used" inout="out" name="enum" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Stores historized report data" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:report.png" implements="xtk:persist" label="Historized reports" labelSingular="Historized report" name="reportHistory" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" name="context">
        <value label="Global" name="global" value="global"/>
        <value label="Folder" name="folder" value="folder"/>
        <value label="Selection" name="selection" value="selection"/>
      </enumeration>
      <element autopk="true" img="xtk:report.png" name="reportHistory" pkgStatus="never">
        <compute-string expr="[report/@label] + ' (' + @created + ')'"/>
        <dbindex name="report">
          <keyfield xpath="@reportName"/>
          <keyfield xpath="@context"/>
          <keyfield xpath="@created"/>
        </dbindex>
        <dbindex name="created">
          <keyfield xpath="@created"/>
        </dbindex>
        <attribute label="Name of the source report" name="reportName" type="string"/>
        <attribute enum="context" label="Display context" length="64" name="context" type="string"/>
        <attribute label="Entity schema" name="entitySchema" type="string"/>
        <attribute label="Active selection" name="selection" type="string"/>
        <attribute label="Description" name="desc" type="string"/>
        <attribute default="true" desc="Shared with other operators" label="Shared" name="shared" type="boolean"/>
        <element label="Content" name="content" type="CDATA"/>
        <element name="createdBy" template="xtk:common:createdBy"/>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" type="datetime"/>
        <element label="Report" name="report" revIntegrity="own" revLink="history" target="xtk:report" type="link">
          <join xpath-dst="@internalName" xpath-src="@reportName"/>
        </element>
        <element label="JavaScript (web)" name="webJavascript" revLabel="Used by" revLink="usedBy" target="xtk:reportHistory" type="link">
          <join xpath-dst="@id" xpath-src="@webJavascript-id"/>
        </element>
        <element label="JavaScript (office)" name="officeJavascript" revLabel="Used by" revLink="usedBy" target="xtk:reportHistory" type="link">
          <join xpath-dst="@id" xpath-src="@officeJavascript-id"/>
        </element>
        <attribute label="Used" name="used" sql="true" type="boolean"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Operator access rights on reports" labelSingular="Operator access right on reports" name="reportRights" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="reportRights">
        <key internal="true" name="id">
          <keyfield xlink="operator"/>
          <keyfield xlink="report"/>
        </key>
        <element desc="Report associated with right" label="Report" name="report" revIntegrity="owncopy" revLabel="Rights" revLink="rights" target="xtk:report" type="link"/>
        <element label="Operators or groups" name="operator" revIntegrity="own" target="xtk:opsecurity, xtk:operator" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Menus for XML/XSLT resources" mappingType="xmlFile" name="resourceMenu" namespace="xtk" xtkschema="xtk:srcSchema">
      <element desc="List of menus" label="Menu" name="menu" unbound="true">
        <key>
          <keyfield xpath="@name"/>
        </key>
        <attribute desc="Internal name of the menu" label="Name" name="name" type="string"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute label="Path selection dialog" name="choicePathView" type="boolean"/>
        <element label="Value" name="paste" type="ANY"/>
        <element name="menu" ref="menu" unbound="true"/>
      </element>
      <element name="resourceMenu" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <element desc="List of schemas" label="Schema" name="schema" unbound="true">
          <key>
            <keyfield xpath="@name"/>
          </key>
          <attribute desc="Schema name" label="Name" name="name" type="string"/>
          <element name="menu" ref="menu" unbound="true"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Operator access rights on folders" labelSingular="Operator access right on folders" name="rights" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="rights">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('folderInsert')=false" expr="FALSE"/>
        </sysFilter>
        <key internal="true" name="id">
          <keyfield xlink="operator"/>
          <keyfield xlink="folder"/>
        </key>
        <element desc="Right associated to folder" label="Folder" name="folder" revIntegrity="own" revLabel="Rights" revLink="rights" target="xtk:folder" type="link"/>
        <element label="Operators or groups" name="operator" revIntegrity="own" revLabel="Rights" revLink="rights" target="xtk:opsecurity, xtk:operator" type="link"/>
        <attribute default="'read|write'" label="Named rights" name="rights" pkgStatus="always" type="string"/>
        <attribute desc="Created by inheritance" label="Inherited" name="inherit" pkgStatus="always" type="boolean"/>
        <attribute default="true" desc="Propagate rights on children" label="Propagate" name="propagate" pkgStatus="always" type="boolean"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Managed entities schemas" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Data schemas" labelSingular="Schema" mappingType="xmlFile" name="schema" namespace="xtk" xtkschema="xtk:srcSchema">
      <element doesNotSupportDiff="true" img="xtk:schema.png" name="schema" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <attribute name="xtkschema" type="string"/>
        <attribute name="implements" type="string"/>
        <attribute localizable="true" name="label" type="string"/>
        <attribute desc="List of depending schemas" name="dependingSchemas" type="string"/>
        <attribute label="Image" name="img" type="string"/>
        <attribute enum="xtk:srcSchema:mappingType" name="mappingType" type="string"/>
        <attribute label="Use the schema as library instead as an entity" name="library" type="boolean"/>
        <element localizable="true" name="help" type="ANY"/>
        <element name="element" ref="xtk:srcSchema:element" unbound="true"/>
        <element name="attribute" ref="xtk:srcSchema:attribute" unbound="true"/>
        <element name="enumeration" ref="xtk:srcSchema:sysEnum" unbound="true"/>
        <element name="key" ref="xtk:srcSchema:key" unbound="true"/>
        <element name="methods" ref="xtk:srcSchema:methods"/>
        <element name="interface" ref="xtk:srcSchema:interface"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Personalization script contexts" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Script contexts" labelSingular="Script context" mappingType="xmlFile" name="scriptContext" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="scriptId">
        <key name="id">
          <keyfield xpath="@name"/>
        </key>
        <attribute dataPolicy="identifier" label="Name" name="name" type="string"/>
      </element>
      <enumeration basetype="string" default="value" name="propertyType">
        <value label="Value" name="value"/>
        <value label="Object" name="object"/>
        <value label="Array" name="array"/>
        <value label="Link" name="link"/>
      </enumeration>
      <enumeration basetype="byte" default="string" name="dataType">
        <value name="byte" value="1"/>
        <value name="short" value="2"/>
        <value name="long" value="3"/>
        <value name="float" value="4"/>
        <value name="double" value="5"/>
        <value name="string" value="6"/>
        <value name="timestamp" value="7"/>
        <value name="date" value="10"/>
        <value name="time" value="11"/>
        <value name="timespan" value="14"/>
        <value name="boolean" value="15"/>
        <value name="memo" value="12"/>
      </enumeration>
      <element label="Property" name="property">
        <element aggregate="scriptId" name="scriptId"/>
        <attribute enum="propertyType" label="Property type" name="type" type="string"/>
        <attribute enum="dataType" label="Data type" name="dataType" type="byte"/>
        <attribute desc="Relative path of the property in the document" label="Path" name="xpath" type="string"/>
        <attribute advanced="true" desc="The (dynamic) declaration has not been performed" label="To declare" name="toDeclare" type="boolean"/>
        <attribute advanced="true" label="Record count" name="count" type="long"/>
        <attribute advanced="true" label="Number of empty records" name="empty" type="long"/>
        <element name="property" ref="property" unbound="true"/>
      </element>
      <element label="Object" name="object">
        <element aggregate="scriptId" name="scriptId"/>
        <attribute desc="Object class (definition of properties)" label="Class" name="class" type="string"></attribute>
        <attribute desc="Reference of a property of another object" label="Reference" name="ref" type="string"/>
        <element name="link" unbound="true">
          <attribute desc="Name of the property associated with the link" label="Name" name="name" type="string"/>
          <attribute label="Target object" name="target" type="string"/>
          <attribute desc="Target element path in the target object XML document" label="Target path" name="targetXPath" type="string"/>
        </element>
        <attribute label="Array" name="array" type="boolean"/>
        <attribute desc="The object may be modified by the script" label="Editable" name="editable" type="boolean"/>
        <attribute advanced="true" label="Only vendor namespaces" name="onlyVendorNs" type="boolean"/>
        <attribute advanced="true" desc="The object (or one of its properties) has been modified by the script" label="Modified by the script" name="dirty" type="boolean"/>
      </element>
      <element name="scriptContext" pkgStatus="never" xml="true">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="'default'" desc="Context name" label="Name" name="name" type="string"/>
        <element name="property" ref="property" unbound="true"/>
        <element name="objects">
          <element name="object" ref="object" unbound="true"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" library="true" name="serverConf" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="en_US" name="lang">
        <value label="Franais" name="fr_FR"/>
        <value label="English (UK)" name="en_GB"/>
        <value label="English (US)" name="en_US"/>
        <value label="Deutsch" name="de_DE"/>
      </enumeration>
      <enumeration basetype="string" default="Oracle" name="provider">
        <value img="xtk:oracle.png" name="Oracle"/>
        <value img="xtk:mssql.png" label="Microsoft SQL Server" name="MSSQL"/>
        <value img="xtk:pgsql.png" label="PostgreSQL, Greenplum" name="PostgreSQL"/>
        <value img="xtk:teradata.png" label="Teradata" name="Teradata"/>
        <value img="xtk:db2.png" label="DB2" name="DB2"/>
        <value img="xtk:mysql.png" label="MySQL" name="MySQL"/>
        <value img="xtk:infinidb.png" label="InfiniDB" name="InfiniDB"/>
        <value img="xtk:netezza.png" label="Netezza" name="Netezza"/>
        <value img="xtk:asterdata.png" label="AsterData" name="AsterData"/>
        <value img="xtk:saphana.png" label="SAP HANA" name="SAPHANA"/>
        <value img="xtk:redshift.png" label="Amazon Redshift" name="RedShift"/>
        <value img="xtk:odbc.png" label="ODBC (Sybase ASE, Sybase IQ)" name="ODBC"/>
        <value img="xtk:fdaoverhttp.png" label="HTTP relay to remote database" name="Relay"/>
      </enumeration>
      <element name="serverTask">
        <attribute default="false" label="Automatic start" name="autoStart" type="boolean"/>
        <attribute default="'06:00:00'" desc="Time of the day when the process is automatically restarted" label="Restart" name="processRestartTime" type="string"/>
        <attribute desc="Start-up parameters" label="Arguments" name="args" type="string"/>
        <attribute default="10" label="Priority at start" name="runLevel" type="short"></attribute>
        <attribute desc="ID of JavaScript to execute when starting the process" label="Init script" name="initScript" type="string"/>
        <attribute default="1800" desc="Alert concerning the amount of RAM consumed (in Mb) by a given process" label="Memory consumption alert" name="maxProcessMemoryAlertMb" type="long"/>
        <attribute default="1600" desc="Warning concerning the amount of RAM consumed (in Mb) by a given process" label="Memory consumption warning" name="maxProcessMemoryWarningMb" type="long"/>
      </element>
      <element label="Data source" name="dataSource">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="default" label="Name" name="name" type="string"/>
        <element label="Connection settings" name="dbcnx">
          <attribute enum="provider" label="Type" name="provider" required="true" type="string"/>
          <attribute img="xtk:server.png" label="Server" name="server" required="true" type="string"/>
          <attribute img="xtk:login.png" label="Account" name="login" required="true" type="string"/>
          <attribute name="password" template="xtk:common:password"/>
          <attribute label="Encrypted password" name="encrypted" type="boolean"/>
          <attribute label="Unicode data in the database" name="unicodeData" type="boolean"/>
          <attribute label="Unicode storage" name="NChar" type="boolean"/>
          <attribute label="Date fields with time zone" name="useTimestampTZ" type="boolean"/>
          <attribute name="timezone" template="xtk:common:timezone"/>
          <attribute label="Mass insert tool" name="bulkCopyUtility" type="string"/>
          <attribute label="Workspace" name="dbSchema" type="string"/>
        </element>
        <element label="SQL parameters" name="sqlParams">
          <attribute label="Function prefix" name="funcPrefix" type="string"/>
          <element label="SQL executed at connection time" name="postConnectSQL" type="string"/>
        </element>
        <element desc="Parameters of associated connections pool" label="Pool parameters" name="pool">
          <attribute default="0" desc="Number of free connection kept in the pool" label="Free connections" name="freeCnx" type="short"/>
          <attribute default="50" desc="Maximum number of allowed connections before refusing a new connection." label="Maximum connections" name="maxCnx" type="short"/>
          <attribute default="600" desc="Delay between connection validity checks." label="Test delay" name="aliveTestDelaySec" type="short"/>
          <attribute default="1200" desc="Maximum idle time of connection. 0 means default value" label="Automatic closure" name="maxIdleDelaySec" type="short"/>
        </element>
      </element>
      <element desc="Definition of server data sources" label="Data Sources" name="dataStore">
        <attribute default="'*'" desc="List of DNS masks that this instance serves (comma separated, can use * and ? patterns)" label="DNS masks" name="hosts" type="string"/>
        <attribute desc="Instance language" enum="lang" label="Language" name="lang" type="string"/>
        <attribute default="'$(XTK_INSTALL_DIR)/var/$(INSTANCE_NAME)/workspace/'" desc="XPath of the working directory." label="Working directory" name="workingDirectory" type="string"/>
        <attribute default="'$(XTK_INSTALL_DIR)/var/$(INSTANCE_NAME)/upload/'" desc="Path of destination directory for the uploaded data." label="Upload folder" name="uploadDirectory" type="string"/>
        <attribute default="'.+'" desc="Authorized files to be downloaded separated by ','. The string must be a valid, regular java expression." label="Authorized files to be downloaded" name="uploadWhitelist" type="string"/>
        <attribute default="'$(XTK_INSTALL_DIR)/var/$(INSTANCE_NAME)/export/'" desc="Path of destination directory for the exported data." label="Export directory" name="exportDirectory" type="string"/>
        <attribute default="600" desc="Timeout in seconds after which a cache entry is invalidated. O means that cache entries are only refreshed at publication time." label="Form cache expiration delay" name="formCacheTimeToLive" type="long"/>
        <attribute default="300" desc="Timeout in seconds after which a cache entry is invalidated. A negative value means that the cache is always invalidated. '0', empty or invalid values are considered to be 60." label="Interaction JSSP cache expiration delay" name="interactionCacheTimeToLive" type="long"/>
        <attribute default="600" desc="Timeout in seconds after which a cache entry is invalidated. A negative value means that the cache is always invalidated. '0', empty or invalid values are considered to be 60." label="Validity period of view cache" name="viewCacheTimeToLive" type="long"/>
        <element desc="URLs matching the regular expression are regenerated based on the URL defined in urlBase" name="proxyAdjust">
          <attribute desc="Regular expression to match URLs. Ex: http://server\.lan\.net.*" label="Regular expression" name="urlRegEx" type="string"/>
          <attribute desc="Base to use when generating external URLs. Ex: https://server.domain.com" label="Base to use for URLs" name="urlBase" type="string"/>
        </element>
        <element label="Data source" name="dataSource" ref="dataSource" unbound="true">
          <key name="dataSource">
            <keyfield xpath="@name"/>
          </key>
        </element>
        <element label="Virtual-directory-to-real-directory mapping." name="virtualDir" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <default>&lt;virtualDir name="images" path="$(XTK_INSTALL_DIR)/var/res/img/"/&gt;
        &lt;virtualDir name="formCache" path="$(XTK_INSTALL_DIR)/var/$(INSTANCE_NAME)/formCache/"/&gt;
        &lt;virtualDir name="publicFileRes" path="$(XTK_INSTALL_DIR)/var/res/$(INSTANCE_NAME)"/&gt;</default>
          <attribute label="Name of the virtual directory" name="name" type="string"/>
          <attribute label="Full path of the actual directory" name="path" type="string"/>
        </element>
      </element>
      <element label="Identification" name="authentication">
        <attribute default="'nl'" desc="Default identification mode" label="Mode" name="defaultMode" type="string"/>
        <attribute default="false" desc="Enable IP address checking" label="Check of IP" name="checkIPConsistent" type="boolean"/>
        <attribute default="86400" desc="Session timeout in seconds" label="Session timeout" name="sessionTimeOutSec" type="long"/>
        <attribute default="86400" desc="Security token timeout in seconds" label="Security token timeout" name="securityTimeOutSec" type="long"/>
        <attribute default="1296000" desc="Timeout of long sessions in seconds" label="Session timeout (log)" name="longSessionTimeOutSec" type="long"/>
        <attribute default="600" desc="Cache of session information in seconds" label="Cache duration" name="sessionCacheSec" type="long"/>
        <element desc="XTK authentication mode" label="XTK Authentication" name="xtk">
          <attribute desc="Password of internal account" label="Password" name="internalPassword" type="string"/>
          <attribute default="'lan'" desc="Authorized zone for the internal account" label="Internal account security zone" name="internalSecurityZone" type="string"/>
        </element>
      </element>
      <element desc="Namespaces configuration" label="Module" name="module">
        <attribute default="'cus'" desc="Default namespace used when creating a new entity" label="Default namespace" name="defaultNameSpace" template="xtk:common:namespace"/>
      </element>
      <element desc="Configuration of the thread pool" name="threadPool">
        <attribute default="10" desc="Maximum number of threads in pool." label="Maximum number" name="maxThreadCount" type="long"/>
      </element>
      <element desc="Configuring the JavaScript interpreter" name="javaScript">
        <attribute default="64" desc="Maximum size in megabytes before running the garbage collector" label="Maximum size" name="maxMB" type="long"/>
        <attribute default="8" desc="Size of each stack chunk in kilo octets" label="Stack size" name="stackSizeKB" type="long"/>
      </element>
      <element desc="Server jobs" name="xtkJobs">
        <attribute default="500" desc="Memory status refresh period of server processing (in ms)" label="Period" name="parseLogsPeriod" type="long"/>
      </element>
      <element label="Security zone" name="securityZone" unbound="true">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <default>&lt;securityZone allowDebug="false" allowHTTP="false" allowSQLInjection="false" label="Public Network" name="public"&gt;
  &lt;subNetwork name="all" label="All addresses" mask="*" proxy="127.0.0.1, ::1"/&gt;

  &lt;securityZone allowDebug="true" allowHTTP="false" allowSQLInjection="false" label="Private Network (VPN)"
                name="vpn" showErrors="true"&gt;

    &lt;securityZone allowDebug="true" allowEmptyPassword="false" allowHTTP="true" allowUserPassword="false"
                  allowSQLInjection="false" label="Private Network (LAN)" name="lan" sessionTokenOnly="true"
                  showErrors="true"&gt;
      &lt;subNetwork name="lan1" label="Lan 1" mask="192.168.0.0/16" proxy="127.0.0.1, ::1"/&gt;
      &lt;subNetwork name="lan2" label="Lan 2" mask="172.16.0.0/12" proxy="127.0.0.1, ::1"/&gt;
      &lt;subNetwork name="lan3" label="Lan 3" mask="10.0.0.0/8" proxy="127.0.0.1, ::1"/&gt;
      &lt;subNetwork name="localhost" label="Localhost" mask="127.0.0.0/8" proxy="127.0.0.1, ::1"/&gt;
      &lt;subNetwork name="lan6"  label="Lan (IPv6)" mask="fc00::/7" proxy="127.0.0.1, ::1"/&gt;
      &lt;subNetwork name="lan6b" label="Lan (IPv6)" mask="fe80::/10" proxy="127.0.0.1, ::1"/&gt;
      &lt;subNetwork name="localhost6" label="Localhost (IPv6)" mask="::1/128" proxy="127.0.0.1, ::1"/&gt;
    &lt;/securityZone&gt;

  &lt;/securityZone&gt;
&lt;/securityZone&gt;</default>
        <attribute name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute default="false" label="Authorize the use of HTTP for operator logon" name="allowHTTP" type="boolean"/>
        <attribute default="false" label="Do not use the security token" name="sessionTokenOnly" type="boolean"/>
        <attribute default="false" label="Display error details" name="showErrors" type="boolean"/>
        <attribute default="false" label="Authorize debug mode for Web applications" name="allowDebug" type="boolean"/>
        <attribute default="false" label="Authorize user/password session tokens" name="allowUserPassword" type="boolean"/>
        <attribute default="false" label="Authorize the user to use the application without a password" name="allowEmptyPassword" type="boolean"/>
        <attribute default="false" label="Authorize the use of SQLDATA in expressions" name="allowSQLInjection" type="boolean"/>
        <element label="Sub-network" name="subNetwork" unbound="true" xml="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute name="name" template="xtk:common:name"/>
          <attribute name="label" template="xtk:common:label"/>
          <attribute label="Mask or address" name="mask" type="string"/>
          <attribute default="127.0.0.1" desc="Mask or address of (reverse) proxy used by this sub-network to access the instance. In this case, the 'X-Forwarded-For' header will be tested instead of this proxy." label="Proxy mask or address" name="proxy" type="string"/>
        </element>
        <element name="securityZone" ref="securityZone" unbound="true"/>
      </element>
      <element name="serverConf">
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <element name="shared">
          <element name="dataStore" ref="dataStore"/>
          <element name="authentication" ref="authentication"/>
          <element name="module" ref="module"/>
          <element name="threadPool" ref="threadPool"/>
          <element name="xtkJobs" ref="xtkJobs"/>
          <element name="javaScript" ref="javaScript"/>
        </element>
        <element name="securityZone" ref="securityZone"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" library="true" name="abstractForm" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="accessControl">
        <value label="Standard" name="standard" value="0"/>
        <value label="Anonymous" name="anonymous" value="1"/>
        <value label="Account" name="account" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="none" name="activityMask">
        <value desc="Task is activated and executed normally" label="Normal" name="none" value="0"/>
        <value desc="Task is not activate (task is lost)" label="Do not activate" name="disable" value="1"/>
        <value desc="Task is activated but not executed (waiting for a switch to normal execution)" label="Do not execute" name="suspend" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="library" name="imageSourceType">
        <value label="Library" name="library"/>
        <value label="External" name="external"/>
      </enumeration>
      <enumeration basetype="short" default="2" name="dictionaryExportOptions">
        <value label="One file per language" name="0"/>
        <value label="One file per web application (CSV only)" name="1"/>
        <value label="One file per language and per web application" name="2"/>
        <value label="One file for all (CSV only)" name="3"/>
      </enumeration>
      <enumeration basetype="string" default="text" label="Type" name="cellType">
        <value img="nms:miniatures/mini-page.png" label="Page" name="page"/>
        <value img="xtk:form/text.png" label="Input (Text)" name="text"/>
        <value img="xtk:form/number.png" label="Input (Number)" name="numeric"/>
        <value img="xtk:form/file.png" label="Input (File)" name="file"/>
        <value img="xtk:form/password.png" label="Input (Password)" name="password"/>
        <value img="xtk:form/checkbox.png" label="Input (Checkbox)" name="checkbox"/>
        <value img="xtk:form/radio.png" label="Input (Radio button)" name="radio"/>
        <value img="xtk:form/radiolist.png" label="Input (Multiple choice)" name="radiolist"/>
        <value img="xtk:form/textarea.png" label="Textarea" name="textarea"/>
        <value img="xtk:form/textarea.png" label="Richtextarea" name="richTextArea"/>
        <value img="xtk:form/linkedit.png" label="Link editor" name="linkEdit"/>
        <value img="xtk:form/image.png" label="Image" name="image"/>
        <value img="xtk:form/select.png" label="Select" name="select"/>
        <value img="xtk:form/hsep.png" label="Horizontal Rule" name="hrule"/>
        <value img="nms:micrositeTracker.png" label="Tracking tag for Microsite" name="tracker"/>
        <value img="xtk:form/question.png" label="Question" name="question"/>
        <value img="xtk:form/container.png" label="Container" name="container"/>
        <value img="xtk:form/frame.png" label="Frame" name="frame"/>
        <value img="xtk:form/link.png" label="Link" name="link"/>
        <value img="xtk:form/link.png" label="Button" name="button"/>
        <value img="xtk:form/image.png" label="Image (link)" name="img"/>
        <value img="xtk:form/html.png" label="HTML" name="html"/>
        <value img="xtk:form/tabular.png" label="List" name="list"/>
        <value img="xtk:form/label.png" label="Label" name="label"/>
        <value img="xtk:form/constant.png" label="Constant" name="constant"/>
        <value img="xtk:form/matrix.png" label="Grid" name="matrix"/>
        <value img="xtk:form/matrixRow.png" label="Grid line" name="matrixRow"/>
        <value img="xtk:form/date.png" label="Date" name="date"/>
        <value img="xtk:form/captcha.png" label="Captcha" name="captcha"/>
        <value img="xtk:form/subscription.png" label="Subscription" name="subscription"/>
        <value img="xtk:form/script.png" label="Script" name="script"/>
        <value img="xtk:form/folder.png" label="Select folder" name="folderSelector"/>
        <value img="xtk:form/pivot.png" label="Table" name="pivot"/>
        <value img="xtk:form/distribution.png" label="Distribution" name="distribution"/>
        <value img="xtk:form/tabular.png" label="List with group" name="tabular"/>
        <value img="xtk:form/cubeExplorer.png" label="Pivot table" name="cubeExplorer"/>
        <value img="xtk:form/column.png" label="Histogram" name="column"/>
        <value img="xtk:form/pie.png" label="Pie" name="pie"/>
        <value img="xtk:form/filled.png" label="Areas" name="filled"/>
        <value img="xtk:form/radar.png" label="Radar" name="radar"/>
        <value img="xtk:form/line.png" label="Curves" name="line"/>
        <value img="xtk:form/cylinder.png" label="Cylinders" name="cylinder"/>
        <value img="xtk:form/gauge.png" label="Gauge" name="gauge"/>
        <value img="xtk:form/funnel.png" label="Funnel" name="funnel"/>
        <value applicableIf="HasPackage('nms:interaction')" img="xtk:form/offerProposition.png" label="Offer proposition" name="offerProposition"/>
      </enumeration>
      <enumeration basetype="byte" default="manual" name="useContext">
        <value label="Manual" name="manual" value="0"/>
        <value label="Via the context" name="context" value="1"/>
        <value label="Automatic via an enumeration" name="enum" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="jsCalendar" name="dateEditor">
        <value label="Date input using a calendar" name="jsCalendar"/>
        <value label="Drop-down lists" name="combo"/>
      </enumeration>
      <enumeration basetype="string" label="Date format" name="dateFormat">
        <value label="Do not display" name="none"/>
        <value label="31-12-2012" name="DDMMY4"/>
        <value label="31-12-12" name="DDMMY2"/>
        <value label="12-31-2012" name="MMDDY4"/>
        <value label="12-31-12" name="MMDDY2"/>
        <value label="12-2012" name="MMY4"/>
        <value label="12-12" name="MMY2"/>
        <value label="31/12/2012" name="DDMMY4s"/>
        <value label="31/12/12" name="DDMMY2s"/>
        <value label="12/31/2012" name="MMDDY4s"/>
        <value label="12/31/12" name="MMDDY2s"/>
        <value label="12/2012" name="MMY4s"/>
        <value label="12/12" name="MMY2s"/>
        <value label="31 December 2012" name="DDMNY4"/>
        <value label="31 December 12" name="DDMNY2"/>
        <value label="December 2012" name="MNY4"/>
        <value label="December 12" name="MNY2"/>
        <value label="December 31, 2012" name="MNDDY4"/>
        <value label="December 31, 12" name="MNDDY2"/>
        <value label="2011" name="Y4"/>
      </enumeration>
      <enumeration basetype="string" default="string" name="fieldType">
        <value label="Text" name="string"/>
        <value label="Boolean (Yes/No)" name="boolean"/>
        <value label="Integer (-128 to +127)" name="byte"/>
        <value label="Integer (~ -32000 to +32000)" name="short"/>
        <value label="Integer (~ -2 billion to +2 billion)" name="long"/>
        <value label="Integer (several billion billions)" name="int64"/>
        <value label="Floating-point number" name="float"/>
        <value label="Double-precision number" name="double"/>
        <value label="Date" name="date"/>
        <value label="Date + Time" name="datetime"/>
        <value label="Time" name="time"/>
        <value label="Duration" name="timespan"/>
        <value label="Long text" name="memo"/>
        <value label="HTML" name="CDATA"/>
        <value label="XML" name="ANY"/>
      </enumeration>
      <enumeration basetype="byte" default="edit" name="appState">
        <value img="nms:dedit.png" label="Being edited" name="edit" value="0"/>
        <value img="nms:delayed.png" label="Pending publication" name="toPublish" value="5"/>
        <value img="nms:started.png" label="Online" name="opened" value="10"/>
        <value img="nms:canceled.png" label="Closed" name="closed" value="20"/>
      </enumeration>
      <enumeration basetype="string" default="text" label="Input type" name="inputType">
        <value img="xtk:form/text.png" label="Text" name="text"/>
        <value img="xtk:form/number.png" label="Number" name="numeric"/>
        <value img="xtk:form/password.png" label="Password" name="password"/>
        <value img="xtk:form/checkbox.png" label="Checkbox" name="checkbox"/>
        <value img="xtk:form/radio.png" label="Radio button" name="radio"/>
        <value img="xtk:form/radiolist.png" label="Multiple choice" name="radiolist"/>
        <value img="xtk:form/textarea.png" label="Multi-line text" name="textarea"/>
        <value img="xtk:form/textarea.png" label="Rich multi-line text" name="richTextArea"/>
        <value img="xtk:form/select.png" label="Combo box" name="select"/>
        <value img="xtk:form/date.png" label="Date" name="date"/>
        <value img="xtk:form/constant.png" label="Constant" name="constant"/>
        <value img="xtk:form/file.png" label="File" name="file"/>
        <value img="xtk:form/captcha.png" label="Captcha" name="captcha"/>
        <value img="xtk:form/subscription.png" label="Subscription" name="subscription"/>
        <value img="xtk:form/folder.png" label="Select folder" name="folderSelector"/>
        <value img="xtk:form/linkedit.png" label="Link editor" name="linkEdit"/>
      </enumeration>
      <enumeration basetype="string" default="_blank" label="Link target" name="linkTarget">
        <value label="Create a new window" name="_blank"/>
        <value label="Parent window" name="_parent"/>
        <value label="In the same window" name="_self"/>
        <value label="In the top window" name="_top"/>
        <value label="Other window" name="name"/>
      </enumeration>
      <enumeration basetype="string" default="link" label="Representation of a link" name="linkType">
        <value label="Link" name="link"/>
        <value label="Button" name="button"/>
        <value label="Image" name="img"/>
      </enumeration>
      <enumeration basetype="string" default="none" label="Action on link or on button" name="linkAction">
        <value label="None" name="none"/>
        <value label="URL" name="url"/>
        <value label="View" name="view"/>
        <value label="Refresh page" name="refresh"/>
        <value label="Next page" name="next"/>
        <value label="Previous page" name="previous"/>
        <value label="Enable a transition" name="transition"/>
        <value label="JavaScript function" name="javascript"/>
        <value applicableIf="HasPackage('nms:social')" label="Preload with Facebook" name="socialPrefill"/>
      </enumeration>
      <enumeration basetype="string" default="none" label="Action to perform when selecting a folder" name="folderSelectAction">
        <value label="None" name="none"/>
        <value label="Refresh page" name="refresh"/>
        <value label="Enable a transition" name="transition"/>
        <value label="JavaScript function" name="javascript"/>
      </enumeration>
      <enumeration basetype="string" name="targetType"/>
      <enumeration basetype="string" default="inherit" label="Label position" name="labelPosition">
        <value label="Inherited" name="inherit"/>
        <value label="Left" name="left"/>
        <value label="Right" name="right"/>
        <value label="Above" name="top"/>
        <value label="Below" name="bottom"/>
        <value label="Hidden" name="hidden"/>
      </enumeration>
      <enumeration basetype="string" default="button" label="Navigation modes" name="navigationMode">
        <value label="Buttons" name="button"/>
        <value label="Links" name="link"/>
      </enumeration>
      <enumeration basetype="string" default="size" name="queryLimitation">
        <value label="First record" name="firstRow"/>
        <value label="Size" name="size"/>
        <value label="Percentage" name="percent"/>
      </enumeration>
      <enumeration basetype="string" default="context" name="queryOutput">
        <value label="Context" name="context"/>
        <value label="Work table" name="table"/>
      </enumeration>
      <enumeration basetype="string" default="server" name="runat">
        <value label="Server" name="server"/>
        <value label="Client" name="client"/>
        <value label="Client &amp; Server" name="both"/>
      </enumeration>
      <enumeration basetype="string" default="input" name="staticAlignment">
        <value label="Align with labels" name="label"/>
        <value label="Align with input zones" name="input"/>
      </enumeration>
      <enumeration basetype="string" label="Storage mode" name="storageMode">
        <value label="Variable" name="var"/>
        <value label="Database field" name="xpath"/>
        <value label="Library" name="library"/>
      </enumeration>
      <enumeration basetype="string" label="Time format" name="timeFormat">
        <value label="Do not display" name="none"/>
        <value label="13h00" name="H4MI"/>
        <value label="1:00 PM" name="H2MI"/>
        <value label="13h" name="H4"/>
        <value label="1 PM" name="H2"/>
      </enumeration>
      <enumeration basetype="string" label="Operator" name="xtkOperator">
        <value label="equal to" name="eq" value="="/>
        <value label="greater than" name="gt" value=">"/>
        <value label="less than" name="lt" value="&lt;"/>
        <value label="greater than or equal to" name="gteq" value=">="/>
        <value label="less than or equal to" name="lteq" value="&lt;="/>
        <value label="not equal to" name="neq" value="!="/>
        <value label="is empty" name="null" value="IS NULL"/>
        <value label="is not empty" name="notnull" value="IS NOT NULL"/>
        <value enabledIf="false" label="exist" name="exists" value="EXISTS"/>
        <value enabledIf="false" label="do not exist" name="notExists" value="NOT EXISTS"/>
      </enumeration>
      <enumeration basetype="string" label="Boolean operator" name="xtkBoolOperator">
        <value label="And" name="and" value="and"/>
        <value label="Or" name="or" value="or"/>
      </enumeration>
      <enumeration basetype="string" label="Collection operator" name="xtkCollectionOperator">
        <value label="exist" name="exists" value="EXISTS"/>
        <value label="do not exist" name="notExists" value="NOT EXISTS"/>
      </enumeration>
      <enumeration basetype="byte" default="edit" name="workflowState">
        <value img="xtk:workflow/status-edit.png" label="Being edited" name="edit" value="0"/>
        <value img="xtk:workflow/status-started.png" label="Request to start in simulation mode" name="testing" value="9"/>
        <value img="xtk:workflow/status-started.png" label="Start requested" name="starting" value="10"/>
        <value img="xtk:workflow/status-started.png" label="Started" name="started" value="11"/>
        <value img="xtk:workflow/status-pause.png" label="Pause requested" name="pausing" value="12"/>
        <value img="xtk:workflow/status-pause.png" label="Paused" name="paused" value="13"/>
        <value img="xtk:workflow/status-pause.png" label="Resume requested" name="resuming" value="14"/>
        <value img="xtk:workflow/status-started.png" label="Stop requested" name="stopping" value="15"/>
        <value img="xtk:workflow/status-waiting.png" label="Stop in progress" name="stopping2" value="16"/>
        <value img="xtk:workflow/status-waiting.png" label="Restart requested" name="restarting" value="17"/>
        <value img="xtk:workflow/status-waiting.png" label="Restarting" name="restarting2" value="18"/>
        <value img="xtk:workflow/status-finished.png" label="Finished" name="stopped" value="20"/>
      </enumeration>
      <enumeration basetype="string" name="prefillMethod">
        <value label="Adobe Campaign encryption" name="encryptedId"/>
        <value label="DES encryption" name="des"/>
        <value label="List of fields" name="keyList"/>
        <value label="Automatic" name="automatic"/>
      </enumeration>
      <enumeration basetype="string" default="neolane" name="prefillSource">
        <value label="Marketing database" name="neolane"/>
        <value applicableIf="HasPackage('nms:social')" label="Facebook" name="facebook"/>
      </enumeration>
      <enumeration basetype="string" name="onChange">
        <value label="Do nothing"/>
        <value label="Refresh page" name="refresh"/>
        <value label="Refresh an item" name="refreshData"/>
      </enumeration>
      <enumeration basetype="string" default="right" label="Alignment" name="helpAlignment">
        <value label="Hide help button" name="none" value="none"/>
        <value label="Display the button to the left of the cell" name="left" value="left"/>
        <value label="Display the button to the right of the cell" name="right" value="right"/>
      </enumeration>
      <enumeration basetype="string" label="Alignment" name="align">
        <value label="Left" name="left" value="left"/>
        <value label="Centered" name="center" value="center"/>
        <value label="Right" name="right" value="right"/>
      </enumeration>
      <enumeration basetype="string" label="Vertical alignment" name="verticalAlign">
        <value label="Top" name="top" value="top"/>
        <value label="Middle" name="middle" value="middle"/>
        <value label="Bottom" name="bottom" value="bottom"/>
      </enumeration>
      <enumeration basetype="string" label="Text formatting" name="whiteSpace">
        <value label="Carriage return" name="normal" value="normal"/>
        <value label="No word wrap" name="nowrap" value="nowrap"/>
      </enumeration>
      <enumeration basetype="string" label="Toolbar position" name="toolbarPos">
        <value label="Left" name="left" value="1"/>
        <value label="Right" name="right" value="3"/>
        <value label="Above" name="up" value="0"/>
        <value label="Below" name="down" value="2"/>
        <value label="Hidden" name="hidden" value="5"/>
      </enumeration>
      <enumeration basetype="string" default="list" name="tableClass">
        <value label="None" name="list"/>
        <value label="Simple table" name="simple"/>
        <value label="Table with group" name="tableGrp"/>
        <value label="List with group" name="listGrp"/>
      </enumeration>
      <enumeration basetype="string" default="column" name="chartRenderType">
        <value label="Pie" name="pie"/>
        <value label="Histogram" name="column"/>
        <value label="Areas" name="filled"/>
        <value label="Curves" name="line"/>
        <value label="Cylinders" name="cylinder"/>
        <value label="Radar" name="radar"/>
      </enumeration>
      <enumeration basetype="string" default="right" name="chartLegendPosition">
        <value label="Top left" name="topLeft" value="top left"/>
        <value label="Top middle" name="top" value="top"/>
        <value label="Top right" name="topRight" value="top right"/>
        <value label="Middle right" name="right" value="right"/>
        <value label="Bottom right" name="bottomRight" value="bottom right"/>
        <value label="Bottom middle" name="bottom" value="bottom"/>
        <value label="Bottom left" name="bottomLeft" value="bottom left"/>
        <value label="Middle left" name="left" value="left"/>
      </enumeration>
      <enumeration basetype="string" default="count" name="operator">
        <value label="Count" name="count"/>
        <value label="Average" name="avg"/>
        <value label="Minimum" name="min"/>
        <value label="Maximum" name="max"/>
        <value label="Sum" name="sum"/>
        <value label="Standard deviation" name="stddev"/>
      </enumeration>
      <enumeration basetype="string" name="chartOperator" template="operator">
        <value label="Percentage distribution" name="percentageTotal"/>
      </enumeration>
      <enumeration basetype="string" name="pivotOperator" template="operator">
        <value label="Row percentage distribution" name="percentageRow"/>
        <value label="Column percentage distribution" name="percentageColumn"/>
        <value label="Total percentage distribution" name="percentageTotal"/>
        <value label="Calculated field" name="userDefined"/>
      </enumeration>
      <enumeration basetype="byte" default="auto" name="classingType">
        <value label="None" name="none" value="0"/>
        <value label="Auto" name="auto" value="1"/>
        <value label="Modulo" name="steady" value="2"/>
        <value label="Manual" name="manual" value="3"/>
      </enumeration>
      <enumeration basetype="long" default="day" name="dateStepType">
        <value label="Group by second" name="second" value="1"/>
        <value label="Group by minute" name="minute" value="60"/>
        <value label="Group by hour" name="hour" value="3600"/>
        <value label="Group by day" name="day" value="86400"/>
        <value label="Group by week" name="week" value="604800"/>
        <value label="Group by month" name="month" value="-1"/>
        <value label="Group by quarter" name="quarter" value="-3"/>
        <value label="Group by year" name="year" value="-12"/>
      </enumeration>
      <enumeration default="row" name="orientation">
        <value label="By rows" name="row"/>
        <value label="By columns" name="column"/>
      </enumeration>
      <enumeration basetype="string" default="automatic" name="variableType">
        <value label="Automatic" name="automatic"/>
        <value label="Date and time" name="datetime"/>
        <value label="Date" name="date"/>
        <value label="Time" name="time"/>
        <value label="Boolean" name="boolean"/>
        <value label="Integer" name="integer"/>
        <value label="Real number" name="real"/>
        <value label="Text string" name="string"/>
      </enumeration>
      <enumeration basetype="string" default="default" name="fontStyle">
        <value label="Default" name="default" value="default"/>
        <value label="Normal" name="normal" value="normal"/>
        <value label="Italic" name="italic" value="italic"/>
        <value label="Bold" name="bold" value="bold"/>
        <value label="Bold italic" name="boldItalic" value="boldItalic"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="cellVisual">
        <value label="None" name="none" value="none"/>
        <value label="Bar graph" name="bargraph" value="bargraph"/>
        <value label="Color tab" name="color" value="color"/>
        <value label="Rating" name="rating" value="rating"/>
      </enumeration>
      <enumeration basetype="string" default="auto" name="columnWidthMode">
        <value desc="Determine automatically depending on the contents of the cells." label="Automatic" name="auto" value="auto"/>
        <value desc="Use all available space." label="Maximize" name="max" value="max"/>
        <value desc="Size set manually" label="Manual" name="manual" value="manual"/>
      </enumeration>
      <enumeration basetype="byte" default="byValueDesc" name="sortMode">
        <value label="None" name="none" value="0"/>
        <value label="By ascending values" name="byValue" value="1"/>
        <value label="By descending values" name="byValueDesc" value="2"/>
      </enumeration>
      <enumeration basetype="string" name="styleAlignement">
        <value desc="Depends on the data format." label="Automatic" name="auto" value="auto"/>
        <value label="Left" name="left" value="left"/>
        <value label="Centered" name="center" value="center"/>
        <value label="Right" name="right" value="right"/>
      </enumeration>
      <enumeration basetype="string" name="styleVerticalAlignment">
        <value label="Default" name="default" value="default"/>
        <value label="Top" name="top" value="top"/>
        <value label="Centered" name="middle" value="middle"/>
        <value label="Bottom" name="bottom" value="bottom"/>
      </enumeration>
      <enumeration basetype="string" name="cellFormat">
        <value img="xtk:textformat.png" label="Text" name="string" value="string"/>
        <value img="xtk:numberformat.png" label="Number" name="number" value="number"/>
        <value img="xtk:currencyformat.png" label="Currency" name="currency" value="currency"/>
        <value img="xtk:percentageformat.png" label="Percentage" name="percentage" value="percentage"/>
        <value img="xtk:dateformat.png" label="Date" name="date" value="date"/>
        <value img="xtk:timeformat.png" label="Time" name="time" value="time"/>
        <value img="xtk:timeformat.png" label="Duration" name="timespan" value="timespan"/>
        <value img="xtk:image.png" label="Adobe Campaign image" name="image" value="image"/>
        <value img="xtk:enum.png" label="Enumeration" name="enum" value="enum"/>
      </enumeration>
      <enumeration basetype="string" name="enumDisplayFormat">
        <value label="Label" name="label" value="label"/>
        <value label="Image" name="image" value="image"/>
        <value label="Label and image (horizontal)" name="HLabelImage" value="HLabelImage"/>
        <value label="Image and label (horizontal)" name="HImageLabel" value="HImageLabel"/>
        <value label="Label and image (vertical)" name="VLabelImage" value="VLabelImage"/>
        <value label="Image and label (vertical)" name="VImageLabel" value="VImageLabel"/>
      </enumeration>
      <enumeration basetype="string" default="default" name="defaultBoolean">
        <value label="Default" name="default" value="default"/>
        <value label="Yes" name="true" value="true"/>
        <value label="No" name="false" value="false"/>
      </enumeration>
      <enumeration basetype="string" default="default" name="borderStyle">
        <value label="Default" name="default" value="default"/>
        <value desc="No border" label="None" name="none" value="none"/>
        <value img="xtk:borderSolid.png" label="Basic" name="solid" value="solid"/>
        <value img="xtk:borderDashed.png" label="Dashes" name="dashed" value="dashed"/>
        <value img="xtk:borderDotted.png" label="Dotted" name="dotted" value="dotted"/>
        <value img="xtk:borderDouble.png" label="Double" name="double" value="double"/>
        <value img="xtk:borderMedium.png" label="Medium" name="medium" value="medium"/>
        <value img="xtk:borderDashedMedium.png" label="Medium dashes" name="dashedMedium" value="dashedMedium"/>
        <value img="xtk:borderDottedMedium.png" label="Medium dotted line" name="dottedMedium" value="dottedMedium"/>
        <value img="xtk:borderHeavy.png" label="Very wide" name="heavy" value="heavy"/>
      </enumeration>
      <enumeration basetype="string" default="query" name="dataSourceMode">
        <value label="New query" name="query"/>
        <value label="Context data" name="context"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="gaugeState">
        <value label="None" name="none"/>
        <value label="Good" name="good" value="#40EA40"/>
        <value label="Acceptable" name="satisfactory" value="#FFD42A"/>
        <value label="Bad" name="poor" value="#E91515"/>
      </enumeration>
      <enumeration basetype="byte" default="self" name="jumpTarget">
        <value label="Internal" name="self" value="0"/>
        <value label="Explicit" name="explicit" value="1"/>
        <value label="Computed by a script" name="script" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="baseTable" name="queryInputType">
        <value label="Database schema" name="baseTable" value="0"/>
        <value label="Imported list" name="importedList" value="1"/>
        <value label="Cube" name="cube" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="simple" name="htmlEditor">
        <value label="Minimalist"/>
        <value label="Basic" name="Simple"/>
        <value label="Intermediate" name="Intermediate"/>
        <value label="Advanced" name="Advanced"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="reconciliationStrategy">
        <value label="Automatic" name="auto"/>
        <value label="Manual" name="manual"/>
        <value label="None" name="none"/>
      </enumeration>
      <enumeration basetype="byte" default="postV6" name="renderingEngine">
        <value label="Version 6.0 (Flash &amp; OpenOffice)" name="preV6" value="0"/>
        <value label="Version 6.x (HTML 5 &amp; Webkit Html To Pdf)" name="postV6" value="1"/>
      </enumeration>
      <enumeration basetype="string" default="default" name="kpiMode">
        <value label="Neutral" name="default"/>
        <value label="Key" name="primary"/>
        <value label="Good" name="success"/>
        <value label="Warning" name="warning"/>
        <value label="Bad" name="error"/>
        <value label="Dynamic" name="dynamic"/>
      </enumeration>
      <enumeration basetype="string" default="button" name="kpiStyle">
        <value label="Thumbnail" name="button"/>
        <value label="Text" name="ribbon"/>
      </enumeration>
      <enumeration basetype="string" default="large" name="kpiSize">
        <value label="Normal" name="medium"/>
        <value label="Large" name="large"/>
      </enumeration>
      <enumeration basetype="string" default="count" name="kpiFormat">
        <value label="Count" name="count"/>
        <value label="Volume" name="dataSize"/>
        <value label="Percentage" name="percentage"/>
        <value label="Raw data" name="raw"/>
      </enumeration>
      <element name="activity">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="ColName()" label="Name" length="64" name="name" type="string"/>
        <attribute default="ColLabel()" label="Label" localizable="true" name="label" type="string"/>
        <attribute advanced="true" default="'xtk:workflow/exec.png'" label="Image" name="img" type="string"/>
        <element name="comment" template="xtk:common:comment"/>
        <attribute advanced="true" name="x" type="long"/>
        <attribute advanced="true" name="y" type="long"/>
        <attribute advanced="true" enum="xtk:abstractForm:activityMask" label="Execution" name="mask" type="byte"/>
        <element name="transitions" xml="true"/>
      </element>
      <element img="xtk:miniature/mini-condition.png" label="Test" name="test" template="xtk:abstractForm:activity">
        <attribute default="'xtk:activities/condition.png'" name="img"/>
        <element name="transitions">
          <element label="Condition" name="condition" ordered="true" template="xtk:abstractForm:transition" unbound="true" xml="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <translatedDefault>&lt;condition name="transition1" label="True" enabled="true"/&gt;</translatedDefault>
            <attribute default="ColLabel()" label="Label" localizable="true" name="label" type="string"/>
            <attribute label="Description" name="help" type="string"/>
            <element name="condition" ref="condition" unbound="true"/>
          </element>
          <element name="default" template="xtk:abstractForm:transition">
            <attribute name="label" translatedDefault="'False'"/>
            <attribute default="true" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="xtk:miniature/mini-script.png" label="Script" name="script" template="xtk:abstractForm:activity">
        <attribute default="'xtk:activities/script.png'" name="img"/>
        <element name="code" type="CDATA"/>
        <element name="strings" ref="strings" xml="true"/>
        <element name="transitions">
          <element name="next" ref="transition"/>
        </element>
      </element>
      <element img="xtk:miniature/mini-end.png" label="End" name="end" template="xtk:abstractForm:activity">
        <attribute default="'xtk:activities/end.png'" name="img"/>
        <element name="endPage" ref="endPage"/>
      </element>
      <element img="xtk:miniature/mini-start.png" label="Start" name="start" template="xtk:abstractForm:activity">
        <attribute default="'xtk:activities/start.png'" name="img"/>
        <element name="transitions">
          <element name="next" ref="transition"/>
        </element>
      </element>
      <element img="nms:miniatures/page.png" label="Page" name="page" template="xtk:abstractForm:activity">
        <attribute default="'page'" label="Type" name="type" type="string"/>
        <attribute default="'nms:activities/page.png'" name="img"/>
        <attribute label="Title" localizable="true" name="label"/>
        <attribute default="1" desc="Number of columns of the container" label="Number of columns" name="colcount" type="short"/>
        <attribute default="'inherit'" enum="labelPosition" label="Label position" name="labelPosition" type="string"/>
        <attribute label="Disallow returning to previous page" name="disablePreviousButton" type="boolean"/>
        <attribute label="Disable next page" name="disableNextButton" type="boolean"/>
        <attribute label="Display questions randomly" name="randomQuestions" type="boolean"/>
        <attribute default="1" label="Number of questions to display" name="randomQuestionsLimit" type="short"/>
        <element name="container" ref="container" unbound="true"/>
        <element name="input" ref="input" unbound="true"/>
        <element name="matrix" ref="matrix" unbound="true"/>
        <element name="link" ref="link" unbound="true"/>
        <element name="html" ref="html" unbound="true"/>
        <element name="label" ref="label" unbound="true"/>
        <element name="image" ref="image" unbound="true"/>
        <element name="hrule" ref="hrule" unbound="true"/>
        <element name="tracker" ref="tracker" unbound="true"/>
        <element name="javascript" ref="javascript" unbound="true"/>
        <element name="transitions">
          <element name="next" template="xtk:abstractForm:transition" unbound="true">
            <key internal="true" name="name">
              <keyfield xpath="@name"/>
            </key>
            <translatedDefault>&lt;next name="next" label="Next" enabled="true"/&gt;</translatedDefault>
          </element>
        </element>
        <element name="table" ref="table" unbound="true"/>
        <element name="chart" ref="chart" unbound="true"/>
        <element name="value" ref="value" unbound="true"/>
        <element name="gauge" ref="gauge" unbound="true"/>
        <element name="kpi" ref="kpi" unbound="true"/>
        <element name="funnel" ref="funnel" unbound="true"/>
        <element applicableIf="HasPackage('nms:interaction')" name="offerProposition" ref="offerProposition" unbound="true"/>
        <element desc="Javascript code which will be executed on the client side once the page has finished loading." name="onPageLoadScript">
          <element label="Code" name="code" type="CDATA"/>
          <element name="strings" ref="strings" xml="true"/>
        </element>
        <element desc="Additional elements to integrate into the html header of the page." name="extraHeader" type="ANY" xml="true"/>
        <element desc="Javascript code which will be executed on the client side once the page has finished loading." name="validationScript">
          <element label="Code" name="code" type="CDATA"/>
          <element name="strings" ref="strings" xml="true"/>
        </element>
      </element>
      <element img="nms:miniature/mini-writer.png" label="Storage" name="writer" template="xtk:abstractForm:activity" xml="true">
        <attribute default="'nms:activities/writer.png'" name="img"/>
        <attribute desc="Update pre-loaded record" label="Update only" name="updateOnly" type="boolean"/>
        <attribute label="Foreign key of the 'Search Folder' link" name="folder-id" type="long"/>
        <attribute label="Compute string of the 'Search Folder' link" name="folder-cs" type="string"/>
        <element label="Search folder" name="folder" revLink="_NONE_" target="xtk:folder" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@folder-id"/>
        </element>
        <attribute label="Foreign key of the 'Creation Folder' link" name="folderCreate-id" type="long"/>
        <attribute label="Compute string of the 'Creation Folder' link" name="folderCreate-cs" type="string"/>
        <element label="Creation folder" name="folderCreate" revLink="_NONE_" target="xtk:folder" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@folderCreate-id"/>
        </element>
        <element label="Key" name="key" unbound="true" xml="true">
          <key name="xpath">
            <keyfield xpath="@xpath"/>
          </key>
          <attribute default="'insertOrUpdate'" enum="xtk:srcSchema:operation" label="Operation" name="operation" type="string"/>
          <attribute label="XPath" name="xpath" type="string"/>
          <element label="Key field" name="keyfield" unbound="true" xml="true">
            <key name="xpath">
              <keyfield xpath="@xpath"/>
            </key>
            <attribute label="XPath" name="xpath" type="string"/>
          </element>
        </element>
        <element name="transitions">
          <element name="next" ref="transition"/>
        </element>
        <attribute applicableIf="HasPackage('nms:social')" label="Foreign key of the 'Mapping' link" name="reconciliationMapping-id" type="long"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Compute string of the 'Mapping' link" name="reconciliationMapping-cs" type="string"/>
        <element applicableIf="HasPackage('nms:social')" label="Mapping" name="reconciliationMapping" revLink="_NONE_" target="nms:deliveryMapping" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@reconciliationMapping-id"/>
        </element>
        <attribute applicableIf="HasPackage('nms:social')" label="Schema" name="reconciliationMappingSchema" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Foreign key of the 'Visitor Creation Folder' link" name="folderCreateVisitor-id" type="long"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Compute string of the 'Visitor Creation Folder' link" name="folderCreateVisitor-cs" type="string"/>
        <element applicableIf="HasPackage('nms:social')" label="Visitor creation folder" name="folderCreateVisitor" revLink="_NONE_" target="xtk:folder" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@folderCreateVisitor-id"/>
        </element>
        <attribute applicableIf="HasPackage('nms:social')" enum="reconciliationStrategy" label="Reconciliation mode" name="reconciliationStrategy" type="string"/>
        <element applicableIf="HasPackage('nms:social')" label="Mapping for manual reconciliation" name="manualMapping">
          <element name="mapping" unbound="true" xml="true">
            <key name="name">
              <keyfield xpath="@visitorExpr"/>
              <keyfield xpath="@contactExpr"/>
            </key>
            <attribute label="Prospect" name="visitorExpr" type="string"/>
            <attribute label="Recipient" name="contactExpr" type="string"/>
          </element>
        </element>
        <element aggregate="crm:webAppWriter:writer" applicableIf="HasPackage('crm:lead')"/>
      </element>
      <element img="nms:miniature/mini-query.png" label="Query" name="query" template="xtk:abstractForm:activity">
        <attribute default="'nms:activities/query.png'" name="img"/>
        <element name="source" ref="xtk:dataTransfer:source"/>
        <element name="tempSchemas" pkgStatus="never" ref="xtk:queryDef:queryDef/tempSchemas"/>
        <element label="Pre-calculated data" name="predefinedData" target="nms:group" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@predefinedData-id"/>
        </element>
        <element label="Data from a cube" name="cubeData" target="xtk:olapCube" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@cubeData-id"/>
        </element>
        <attribute default="true" label="Use aggregates" name="useAggregates" type="boolean"/>
        <attribute enum="queryInputType" label="Types available in query input" name="inputType" type="long"/>
        <attribute label="Foreign key of the 'Pre-calculated data' link" name="predefinedData-id" type="long"/>
        <attribute label="Compute string of the 'Pre-calculated data' link" name="predefinedData-cs" type="string"/>
        <attribute label="Foreign key of the 'Data from a cube' link" name="cubeData-id" type="long"/>
        <attribute label="Compute string of the 'Data from a cube' link" name="cubeData-cs" type="string"/>
        <attribute label="Select all fields" name="selectAll" type="boolean"/>
        <attribute label="Filter automatically with the context" name="contextFilter" type="boolean"/>
        <attribute label="Restrict to selected folder" name="folderFilter" type="boolean"/>
        <attribute label="Path in the context" name="folderVariable" type="string"/>
        <attribute desc="Link key to the main document" label="Link key" name="contextLink" type="string"/>
        <element label="Query" name="humanCond" type="string"/>
        <element desc="Limit the selected records" label="Limits" name="limiter">
          <attribute label="Enabled" name="enabled" type="boolean"/>
          <attribute enum="queryLimitation" label="Type" name="type" type="string"/>
          <attribute label="Random sort" name="random" type="boolean"/>
          <attribute label="Limit as %" name="percentValue" type="float"/>
          <attribute label="Limit as size" name="sizeValue" type="long"/>
        </element>
        <element desc="Storage of results" label="Results" name="output">
          <attribute enum="queryOutput" label="Storage" name="location" type="string"/>
          <attribute desc="Data path in the context" label="Path" name="path" type="string"/>
        </element>
        <element name="transitions">
          <element name="next" ref="transition"/>
        </element>
      </element>
      <element img="nms:miniature/mini-prefill.png" label="Preloading" name="prefill" template="xtk:abstractForm:activity">
        <attribute default="'nms:activities/prefill.png'" name="img"/>
        <attribute label="enable empty ID" name="skipIfNoId" type="boolean"/>
        <attribute label="Use tracking data" name="useUUID" type="boolean"/>
        <attribute default="'encryptedId'" enum="prefillMethod" label="Identification" name="method" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" default="'neolane'" enum="prefillSource" label="Data source" name="source" type="string"/>
        <attribute label="DES key" name="desKey" type="string"/>
        <element label="Context keys" name="contextKeys">
          <element autopk="true" name="key" ordered="true" unbound="true">
            <key internal="true" name="id">
              <keyfield xpath="@id"/>
            </key>
            <attribute default="Gid()" label="Id" name="id" type="long"/>
            <attribute label="Expression" name="expr" type="string"/>
          </element>
        </element>
        <attribute default="true" label="Autodetect" name="autodetect" type="boolean"/>
        <attribute label="Additional data" name="additionnalData" type="boolean"/>
        <element label="Additional data" name="select">
          <element label="Field" name="node" unbound="true" xml="true">
            <key internal="true" name="id">
              <keyfield xpath="@id"/>
            </key>
            <attribute label="Id" name="id" type="long"/>
            <attribute label="Expression" name="expr" type="string"/>
            <attribute label="Label" name="label" type="string"/>
            <attribute label="Alias" name="alias" type="string"/>
          </element>
        </element>
        <element applicableIf="HasPackage('nms:social')" label="Facebook fields to retrieve" name="facebook">
          <attribute label="Basic information (ID, last name, first name, gender, language)" name="profile" type="boolean"/>
          <attribute label="Email address" name="email" type="boolean"/>
          <attribute label="Date of birth" name="birthDate" type="boolean"/>
          <attribute label="Profile picture" name="picture" type="boolean"/>
          <attribute label="Interests" name="likes" type="boolean"/>
          <attribute label="Friends" name="friends" type="boolean"/>
          <attribute label="Location (city)" name="location" type="boolean"/>
        </element>
        <attribute label="I agree to comply with the conditions of use." name="acceptedLegalTerms" type="boolean"/>
        <element name="transitions">
          <element name="next" ref="transition"/>
        </element>
      </element>
      <element img="nms:miniature/mini-jump.png" label="Jump" name="jump" template="xtk:abstractForm:activity">
        <attribute default="'nms:activities/jump.png'" name="img"/>
        <attribute desc="Destination activity" label="Activity" name="target" type="string"/>
        <element name="code" type="CDATA"/>
        <element name="strings" ref="strings" xml="true"/>
        <attribute enum="xtk:abstractForm:jumpTarget" label="Target Web application" name="targetType" type="byte"/>
        <attribute desc="Variable containing the internal name of the external target" label="Variable" name="targetNameVariable" type="string"/>
      </element>
      <element name="cell" xml="true">
        <compute-string expr="@label"/>
        <key internal="true" name="@id">
          <keyfield xpath="@id"/>
        </key>
        <attribute label="Primary key" name="id" type="string"/>
        <attribute label="Label" localizable="true" name="label" type="string"/>
        <attribute desc="Component type." enum="cellType" label="Type" name="type" type="string"/>
        <attribute default="1" desc="Number of cells spanned by the component." label="Number of cells" name="colspan" type="short"/>
        <element desc="Expression defining visibility of the cell." label="Visibility" name="visibleIf" type="string">
          <attribute label="Description" name="help" type="string"/>
          <element name="condition" ref="condition" unbound="true"/>
        </element>
        <element label="View" name="rendering">
          <attribute enum="align" label="Alignment" name="align" type="string"/>
          <attribute enum="verticalAlign" label="Vertical alignment" name="verticalAlign" type="string"/>
          <attribute desc="Width (in default pixels)" label="Width" name="width" type="string"/>
          <attribute desc="Height (in default pixel)" label="Height" name="height" type="short"/>
          <attribute label="Column width" name="colWidth" type="short"/>
          <attribute desc="Maximum number of characters in an input zone." label="Max. length." name="maxLength" type="short"/>
          <attribute desc="Number of lines." label="Lines" name="rows" type="short"/>
          <attribute desc="Coincides with the html nowrap attribute applied to the label." enum="whiteSpace" label="Label format" name="whiteSpace" type="string"/>
          <attribute label="Label width" name="labelWidth" type="long"/>
          <attribute default="1" label="Style" name="styleButton" type="boolean"/>
          <attribute default="1" label="Justification" name="justifyButton" type="boolean"/>
          <attribute label="Switch to source mode" name="sourceButton" type="boolean"/>
          <attribute label="Add an image" name="imageButton" type="boolean"/>
          <attribute enum="toolbarPos" label="Toolbar position" name="toolbarPos" type="short"/>
          <attribute desc="Style name for table rendering" enum="tableClass" label="Class" name="tableClass" type="string"/>
          <attribute enum="htmlEditor" label="HTML editor" name="htmlEditor" type="string"/>
          <attribute label="Style inline" name="inlineStyle" type="string"/>
          <attribute label="Style inline" name="inlineStyleLabel" type="string"/>
          <attribute label="Style inline" name="inlineStyleValue" type="string"/>
          <attribute desc="Lets you overload the 'cellspacing' attribute of the HTML table which represents the container" label="Space between the cells" name="cellSpacing" pkgStatus="always" type="short"/>
        </element>
      </element>
      <element label="Control" name="input" template="xtk:abstractForm:cell" xml="true">
        <attribute default="'text'" name="type"/>
        <attribute name="label" translatedDefault="'Input '+ColIndex()"/>
        <attribute dataPolicy="identifier" label="Alias" name="alias" required="true" type="string"/>
        <attribute dataPolicy="identifier" desc="Alias of another control to compare with the entered value." label="Alias to compare" name="compareAlias" type="string"/>
        <attribute default="'inherit'" enum="labelPosition" label="Label position" name="labelPosition" type="string"/>
        <attribute default="'jsCalendar'" desc="Date entry style" enum="dateEditor" label="Input mode" name="dateEditor" type="string"/>
        <attribute label="Mandatory" name="required" type="boolean"/>
        <attribute default="false" label="Enabled when history" name="enabledWhenHistory" type="boolean"/>
        <element desc="Error message of if a required field is left empty." label="Log 'Required field'" localizable="true" name="requiredLog" type="html"/>
        <attribute label="Application schema" name="targetSchema" type="string"/>
        <attribute label="Path of the application schema" name="xpathTargetSchema" type="string"/>
        <attribute default="'xpath'" enum="storageMode" label="Application schema input mode" name="targetSchemaMode" type="string"/>
        <attribute default="'refresh'" enum="folderSelectAction" name="action" type="string"/>
        <attribute label="Transition" name="transition" type="string"/>
        <element label="JavaScript" name="onChangeJavascript" type="CDATA"/>
        <element name="sysFilter" ref="xtk:queryDef:sysFilter"/>
        <attribute advanced="true" label="Filter writable folders." name="writeAccessFolderFlt" type="boolean"/>
        <element label="Storage" name="storage" template="xtk:abstractForm:storage">
          <element label="Value" name="checkedValue" type="string"/>
          <element label="Empty value" name="uncheckedValue" type="string"/>
          <element desc="Default value used by Text, Textarea and RichTextarea type controls." label="Default value" name="defaultValue" type="string"/>
          <attribute desc="Score associated with the response for the survey scoring." label="Score" name="score" type="double"/>
          <attribute label="Selected" name="selected" type="boolean"/>
          <attribute desc="Uses the definition of the field to find the possible values." label="Automatic choice of values" name="useDeclaredValues" type="boolean"/>
          <attribute enum="dateFormat" label="Date format" name="dateFormat" translatedDefault="'DDMNY4'" type="string"/>
          <attribute default="'none'" enum="timeFormat" label="Time format" name="timeFormat" type="string"/>
          <attribute default="1920" desc="First year shown in the date selection zones." label="First year" name="firstYear" type="short"/>
          <attribute default="2015" desc="Last year shown in the date selection zones." label="Last year" name="lastYear" type="short"/>
          <attribute desc="XPath of label for links" label="Field used as label" name="xpathLabel" type="string"/>
          <attribute desc="Enables use of default value for numbers" label="Define a default value" name="useDefaultVal" type="boolean"/>
          <attribute desc="Enables use of minimum value for numbers" label="Define a minimum value" name="useMinVal" type="boolean"/>
          <attribute desc="Enables use of maximum value for numbers" label="Define a maximum value" name="useMaxVal" type="boolean"/>
          <attribute desc="Default value for numbers" label="Default value" name="defaultNumericVal" type="double"/>
          <attribute desc="Minimum value for numbers" label="Min value" name="minval" type="double"/>
          <attribute desc="Maximum value for numbers" label="Max value" name="maxval" type="double"/>
          <element aggregate="xtk:abstractForm:multipleChoice" name="multipleChoice"/>
          <attribute label="Foreign key of the 'Service' link" name="service-id" type="long"/>
          <attribute label="Compute string for the 'Service' link" name="service-cs" type="string"/>
          <element label="Service" name="service" revLink="_NONE_" target="nms:service" type="link" xml="true">
            <join xpath-dst="@id" xpath-src="@service-id"/>
          </element>
          <attribute label="Service name" name="serviceName" type="string"/>
          <attribute advanced="true" label="Link" name="selectLink" type="string"/>
          <attribute advanced="true" label="Allow download" name="allowDownload" type="boolean"/>
        </element>
        <attribute desc="Prefix for number" label="Prefix" name="prefix" type="string"/>
        <attribute desc="Suffix for numbers" label="Suffix" name="suffix" type="string"/>
        <element label="Initialization from the context" name="contextOptions">
          <attribute enum="useContext" label="Initialization" name="useContext" type="byte"/>
          <attribute label="Initialization from the context" name="fill" type="boolean"/>
          <attribute label="Options XPath" name="xpath" type="string"/>
          <attribute label="Labels XPath" name="xpathLabel" type="string"/>
          <attribute label="Values XPath" name="xpathValue" type="string"/>
          <attribute desc="List initialization via an enumeration field" label="Enumeration XPath" name="xpathEnum" type="string"/>
        </element>
        <attribute desc="Action to perform on value change" enum="onChange" label="On value change" name="onChange" type="string"/>
        <attribute label="Item to refresh" name="refreshTarget" type="string"/>
      </element>
      <element autopk="true" label="Container" name="container" template="xtk:abstractForm:cell" unbound="true">
        <attribute name="label" translatedDefault="'Container '+ColIndex()"/>
        <attribute default="1" desc="Number of columns of the container" label="Number of columns" name="colcount" type="short"/>
        <attribute default="'inherit'" enum="labelPosition" label="Default label position" name="labelPosition" type="string"/>
        <attribute default="'standard'" name="type" type="string"/>
        <attribute default="'container'" label="Appearance style" name="style" type="string"/>
        <attribute label="Size" name="width" type="string"/>
        <attribute label="Alternate line color" name="useAlternateBackground" type="boolean"/>
        <attribute label="Enter the title in HTML format" name="useHtmlTitle" type="boolean"/>
        <element label="Title" name="title" type="html"/>
        <element name="strings" ref="strings" xml="true"/>
        <element name="container" ref="container" unbound="true"/>
        <element name="input" ref="input" unbound="true"/>
        <element name="matrix" ref="matrix" unbound="true"/>
        <element name="link" ref="link" unbound="true"/>
        <element name="html" ref="html" unbound="true"/>
        <element name="label" ref="label" unbound="true"/>
        <element name="image" ref="image" unbound="true"/>
        <element name="table" ref="table" unbound="true"/>
        <element name="chart" ref="chart" unbound="true"/>
        <element name="value" ref="value" unbound="true"/>
        <element name="kpi" ref="kpi" unbound="true"/>
        <element name="javascript" ref="javascript" unbound="true"/>
        <element name="gauge" ref="gauge" unbound="true"/>
        <element name="funnel" ref="funnel" unbound="true"/>
        <element applicableIf="HasPackage('nms:interaction')" name="offerProposition" ref="offerProposition" unbound="true"/>
      </element>
      <element label="Grid" name="matrix" template="xtk:abstractForm:cell" xml="true">
        <attribute default="'inherit'" enum="labelPosition" label="Label position" name="labelPosition" type="string"/>
        <attribute dataPolicy="identifier" label="Alias" name="alias" required="true" type="string"/>
        <attribute dataPolicy="identifier" desc="Alias of another control to compare with the entered value." label="Alias to compare" name="compareAlias" type="string"/>
        <element aggregate="xtk:abstractForm:multipleChoice" name="multipleChoice"/>
        <element label="Grid line" name="matrixRow" template="xtk:abstractForm:cell" unbound="true">
          <attribute label="Mandatory" name="required" type="boolean"/>
          <element desc="Error message of if a required field is left empty." label="Log 'Required field'" localizable="true" name="requiredLog" type="html"/>
          <element label="Storage" name="storage" template="xtk:abstractForm:storage"/>
        </element>
      </element>
      <element autopk="true" label="Link" name="link" template="xtk:abstractForm:cell" unbound="true">
        <attribute localizable="true" name="label" translatedDefault="'Link '+ColIndex()"/>
        <attribute label="Image" name="img" type="string"/>
        <attribute default="'link'" name="type"/>
        <attribute default="'url'" enum="linkAction" label="Action" name="action" type="string"/>
        <attribute label="Transition" name="transition" type="string"/>
        <element label="JavaScript" name="linkJavascript" type="CDATA"/>
        <attribute label="URL" name="href" type="string"/>
        <attribute name="viewName" template="xtk:navtree:command/@view"/>
        <attribute desc="Additional arguments for links in console mode, which may contain information to be added to on the server side (between &lt;% and %>)" label="Console arguments" name="viewConsoleParam" type="string"/>
        <attribute desc="Additional arguments for links in web mode, which may contain information to be added to on the server side (between &lt;% and %>)" label="Web arguments" name="viewWebParam" type="string"/>
        <attribute default="'_blank'" enum="linkTarget" label="Window" name="target" type="string"/>
        <attribute label="Target name" name="targetName" type="string"/>
        <attribute label="ToolTip" localizable="true" name="tooltip" type="string"/>
        <attribute enum="staticAlignment" label="Alignment" name="staticAlignment" type="string"/>
        <attribute default="false" label="Enabled when history" name="enabledWhenHistory" type="boolean"/>
        <element name="rendering">
          <attribute label="Style" name="linkClassname" type="string"/>
        </element>
        <attribute applicableIf="HasPackage('nms:social')" label="Compute string of the 'OAuth Account' link" name="socialAccount-cs" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Identifier of the 'Seed list' link" name="socialAccount-id" type="long"/>
        <element applicableIf="HasPackage('nms:social')" label="Application" name="socialAccount" revLink="_NONE_" target="nms:extAccount" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@socialAccount-id"/>
        </element>
      </element>
      <element autopk="true" label="HTML" name="html" template="xtk:abstractForm:cell" unbound="true">
        <attribute name="label" translatedDefault="'HTML '+ColIndex()"/>
        <attribute default="'html'" name="type"/>
        <element label="Source" name="source" type="html"/>
        <element name="strings" ref="strings" xml="true"/>
        <attribute enum="staticAlignment" label="Alignment" name="staticAlignment" type="string"/>
      </element>
      <element autopk="true" label="Label" name="label" template="xtk:abstractForm:cell" unbound="true">
        <attribute name="label" translatedDefault="'Label '+ColIndex()"/>
        <attribute default="'label'" name="type"/>
        <attribute label="Text" localizable="true" name="text" type="string"/>
        <attribute enum="staticAlignment" label="Alignment" name="staticAlignment" type="string"/>
      </element>
      <element autopk="true" label="Image" name="image" template="xtk:abstractForm:cell" unbound="true">
        <attribute name="label" translatedDefault="'Image '+ColIndex()"/>
        <attribute default="'image'" name="type"/>
        <attribute enum="imageSourceType" label="Image source" name="sourceType" type="string"/>
        <attribute label="Source" localizable="true" name="src" type="string"/>
        <attribute enum="staticAlignment" label="Alignment" name="staticAlignment" type="string"/>
        <element label="Library image" name="libraryImage" target="xtk:fileRes" type="link"/>
      </element>
      <element autopk="true" label="Separation bar" name="hrule" template="xtk:abstractForm:cell" unbound="true">
        <attribute name="label" translatedDefault="'Separator '+ColIndex()"/>
        <attribute default="'hrule'" name="type"/>
        <attribute enum="staticAlignment" label="Alignment" name="staticAlignment" type="string"/>
      </element>
      <element label="Tracking tag" name="tracker" template="xtk:abstractForm:cell" unbound="true">
        <key internal="true" name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="'TRK'+CounterValue('nmsTracker')" label="Internal name" length="32" name="name" pkgStatus="never" type="string"/>
        <attribute name="label" pkgStatus="always" translatedDefault="'Tracking tag '+ColIndex()"/>
        <attribute dbEnum="trackerGoal" label="Goal" name="goal" pkgStatus="always" type="string"/>
        <attribute default="1" label="Stage" name="step" pkgStatus="always" type="byte"/>
        <attribute default="'tracker'" name="type"/>
      </element>
      <element autopk="true" label="Script" name="javascript" template="xtk:abstractForm:cell" unbound="true">
        <attribute name="label" translatedDefault="'Script '+ColIndex()"/>
        <attribute default="'script'" name="type"/>
        <attribute desc="Script execution mode." enum="runat" label="Execution" name="runat" type="string" xml="true"/>
        <attribute desc="Associate the script with a cell." label="Cell" name="cell" type="boolean"/>
        <attribute default="'inherit'" enum="labelPosition" label="Label position" name="labelPosition" type="string"/>
        <element label="Code" name="code" type="CDATA"/>
        <element name="strings" ref="strings" xml="true"/>
      </element>
      <element autopk="true" label="Gauge" name="gauge" template="xtk:abstractForm:cell" unbound="true">
        <attribute localizable="true" name="label" translatedDefault="'Gauge '+ColIndex()"/>
        <attribute name="alias" type="string"/>
        <attribute default="200" label="Width" name="width" type="short"/>
        <attribute label="Value" name="xpathValue" type="string"/>
        <attribute label="Goal" name="xpathGoal" type="string"/>
        <attribute label="Other mark" name="xpathMarker" type="string"/>
        <attribute label="Start" name="exprLowerBound" type="string"/>
        <attribute label="End" name="exprUpperBound" type="string"/>
        <attribute default="true" label="Display the value below the gauge" name="displayValue" type="boolean"/>
        <attribute label="Aperture ratio" name="spanRange" type="double"/>
        <element label="Style" name="style" ref="tablerow/cell/style"/>
        <element label="Value ranges" name="stateRange" unbound="true">
          <attribute label="Lower bound" name="lowerBound" type="string"/>
          <attribute enum="gaugeState" label="Status of the value range" name="state" type="string"/>
        </element>
      </element>
      <element autopk="true" label="KPI" name="kpi" template="xtk:abstractForm:cell" unbound="true">
        <attribute localizable="true" name="label" translatedDefault="'KPI '+ColIndex()"/>
        <attribute label="Value" name="xpathValue" type="string"/>
        <attribute label="Warning" name="xpathWarning" type="string"/>
        <attribute label="Success" name="xpathSuccess" type="string"/>
        <attribute enum="kpiMode" label="Mode" name="mode" type="string"/>
        <attribute enum="kpiStyle" label="Style" name="style" type="string"/>
        <attribute enum="kpiSize" label="Size" name="size" type="string"/>
        <attribute enum="kpiFormat" label="Format" name="format" type="string"/>
        <attribute default="2" label="Significant figures" name="significantFigures" type="short"/>
      </element>
      <element autopk="true" label="Funnel" name="funnel" template="xtk:abstractForm:cell" unbound="true">
        <attribute localizable="true" name="label" translatedDefault="'Funnel '+ColIndex()"/>
        <attribute name="alias" type="string"/>
        <attribute default="'inherit'" enum="labelPosition" label="Position of the caption" name="labelPosition" type="string"/>
        <attribute default="400" label="Width" name="width" type="short"/>
        <attribute default="300" label="Height" name="height" type="short"/>
        <attribute default="true" label="3D effect" name="perspective" type="boolean"/>
        <attribute label="Label color" name="labelColor" type="string"/>
        <attribute label="Path of the collection" name="startPath" type="string"/>
        <attribute label="Aisle" name="radiusValue" type="string"/>
        <attribute label="Height" name="heightValue" type="string"/>
        <attribute label="Label" name="labelExpr" type="string"/>
        <attribute label="Rate" name="transitionRatio" type="string"/>
        <attribute label="Time" name="transitionTime" type="string"/>
        <attribute label="Indication" name="hint" type="string"/>
        <attribute label="Color" name="color" type="string"/>
      </element>
      <element applicableIf="HasPackage('nms:interaction')" autopk="true" label="Proposition" name="offerProposition" template="xtk:abstractForm:cell" unbound="true">
        <attribute localizable="true" name="label" translatedDefault="'Offer proposition' +ColIndex()" type="string"/>
        <element label="Space" name="offerSpace" target="nms:offerSpace" type="link"/>
        <element label="Interactions schema" name="inputSchema" type="string"/>
        <attribute label="Recipient" name="targetXPath" type="string"/>
        <element label="Additional parameter" name="parameter" unbound="true">
          <compute-string expr="@name"/>
          <key internal="true" name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute desc="Attribute name" label="Name" name="name" type="string"/>
          <attribute desc="Path of the parameter value" label="Source" name="source" type="string"/>
        </element>
      </element>
      <element name="transition">
        <compute-string expr="@label"/>
        <attribute default="ColName()" label="Name" length="40" name="name" type="string"/>
        <attribute label="Label" localizable="true" name="label" type="string"/>
        <attribute label="Destination" name="target" type="string"/>
        <attribute name="x" type="long"/>
        <attribute name="y" type="long"/>
        <attribute default="true" label="Enabled" name="enabled" type="boolean"/>
        <attribute label="Ignore errors" name="ignoreErrors" type="boolean"/>
        <attribute desc="Use the transition label as a button name" label="Use the label for the display" name="useLabelAsButtonName" type="boolean"/>
        <element name="comment" template="xtk:common:comment"/>
      </element>
      <element label="Variable" name="variable">
        <compute-string expr="@label"/>
        <key internal="true" name="xpath">
          <keyfield xpath="@xpath"/>
        </key>
        <attribute label="Label" localizable="true" name="label" required="true" translatedDefault="'Variable '+ColIndex()" type="string"/>
        <attribute default="'var'+ColIndex()" label="Storage (XPath)" name="xpath" required="true" type="string"/>
        <attribute enum="fieldType" label="Type" name="type" required="true" type="string"/>
        <attribute label="Description" name="desc" type="string"/>
        <attribute label="Default value" name="default" type="string"/>
        <attribute enum="xtk:common:dataPolicy" label="Constraint(s)" name="dataPolicy" type="string"/>
      </element>
      <element label="Storage" name="storage">
        <attribute default="iif([/@entitySchema]='xtk:report', 'var', 'xpath')" enum="storageMode" label="Mode" name="mode" type="string"/>
        <attribute label="Path" name="xpath" type="string"/>
        <attribute advanced="true" enum="fieldType" label="Type" name="type" type="string"/>
        <attribute advanced="true" label="Enumeration" name="enum" type="string"/>
        <attribute advanced="true" label="User enumeration" name="userEnum" type="string"/>
        <attribute advanced="true" label="Multiple values" name="unbound" type="boolean"/>
        <element desc="Local variable" label="Variable" name="variable">
          <attribute desc="Path in the context" label="XPath" name="xpath" type="string"/>
        </element>
        <element desc="Library field" label="Field" name="field">
          <attribute desc="Path in the library" label="Field" name="xpath" type="string"/>
        </element>
      </element>
      <element label="Multiple choice" name="multipleChoice">
        <attribute desc="Allow multiple selections" label="Multiple choice" name="multipleChoice" type="boolean"/>
        <attribute desc="Last choice has text field for other" label="Other value" name="enableOtherVal" type="boolean"/>
        <attribute label="Maximum selections required" name="maxsel" type="short"/>
        <attribute label="Minimum selections required" name="minsel" type="short"/>
        <element desc="Error message displayed when there are too many selections." label="'Maximum selection' log" localizable="true" name="maxselLog" type="html"/>
        <element desc="Error message displayed when there are too few selections." label="'Minimum selection' log" localizable="true" name="minselLog" type="html"/>
        <attribute label="Use the labels as value" name="useLabelAsValue" type="boolean"/>
        <element label="Options" name="options">
          <element label="Option" name="option" ordered="true" unbound="true">
            <key internal="true" name="@id">
              <keyfield xpath="@id"/>
            </key>
            <attribute default="Gid()" label="Primary key" name="id" type="string"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
            <attribute label="Value" name="value" type="string"/>
            <attribute label="Selected" name="selected" type="boolean"/>
            <attribute label="Score" name="score" type="double"/>
            <attribute advanced="true" desc="Origin of the label; used for translation." label="Origin" name="origin" type="string"/>
            <attribute label="SQL name" name="sqlname" type="string"/>
            <attribute default="true" label="Calculate the SQL name automatically" name="autoSqlName" type="boolean"/>
          </element>
        </element>
      </element>
      <element label="End page" name="endPage" xml="true">
        <attribute label="Use an external URL" name="useExternalUrl" type="boolean"/>
        <attribute label="External URL" localizable="true" name="externalUrl" type="string"/>
        <element desc="HTML code of the page" label="Content" name="source" translatedDefault="'Enter the content of the page here'" type="CDATA"/>
        <element name="strings" ref="strings" xml="true"/>
      </element>
      <element label="Condition" name="condition" ordered="true" unbound="true" xml="true">
        <key internal="true" name="id">
          <keyfield xpath="@id"/>
        </key>
        <attribute default="Gid()" label="Primary key" name="id" type="long"/>
        <attribute enum="xtkBoolOperator" label="Boolean operator" name="boolOperator" type="string"/>
        <attribute label="Expression" name="leftExpr" type="string"/>
        <attribute enum="xtkOperator" label="Operator" name="operator" type="string"/>
        <attribute label="Value" name="rightExpr" type="string"/>
        <element name="condition" ref="condition" unbound="true"/>
      </element>
      <element label="Variable definition" name="variableDef" ordered="true" unbound="true" xml="true">
        <key name="expr">
          <keyfield xpath="@expr"/>
        </key>
        <attribute label="Expression" length="64" name="expr" type="string"/>
        <attribute label="Label" length="64" localizable="true" name="label" type="string"/>
        <element label="Description" localizable="true" name="desc" type="html"/>
        <attribute enum="helpAlignment" label="Positioning the help button" name="descImgPos" type="string"/>
        <attribute label="Alias" length="32" name="alias" type="string"/>
        <attribute enum="classingType" label="Binning type" name="classingType" type="byte"/>
        <attribute default="10" label="Number of bins" name="classCount" type="long"/>
        <attribute label="Modulo" name="stepFactor" type="double"/>
        <attribute desc="Complementary set" label="Add the complementary set" name="complementary" type="boolean"/>
        <attribute desc="Label of the complementary set" label="Label of the complement" name="complementaryLabel" translatedDefault="'Others'" type="string"/>
        <attribute enum="variableType" label="Data type" name="type" type="string"/>
        <attribute default="false" desc="The data is already aggregated" label="Aggregate value" name="isAggregated" type="boolean"/>
        <attribute default="0" label="Minimum grouping time" name="minClassDuration" type="timespan"/>
        <attribute label="The first step is a minimum" name="firstStepIsLimit" type="boolean"/>
        <attribute label="The last step is a maximum" name="lastStepIsLimit" type="boolean"/>
        <element label="Sampling unit" name="samplingSteps">
          <element label="Sampling unit" name="samplingStep" ordered="true" unbound="true">
            <key name="mark">
              <keyfield xpath="@mark"/>
            </key>
            <attribute label="Limit" name="mark" type="double"/>
          </element>
        </element>
        <element label="Selected values" name="selectedValues">
          <element label="Selected value" name="selectedValue" ordered="true" unbound="true">
            <key name="value">
              <keyfield xpath="@value"/>
            </key>
            <attribute label="Value" name="value" type="string"/>
          </element>
        </element>
        <attribute enum="dateStepType" label="Breakdown by date" name="dateStepType" type="long"/>
        <attribute default="false" desc="Only keep hour part (of a 'date and time' field)" label="Remove date" name="removeDate" type="boolean"/>
      </element>
      <element name="statistic" ordered="true" unbound="true" xml="true">
        <key>
          <keyfield xpath="@alias"/>
        </key>
        <attribute default="'@expr'+ColIndex()" desc="Alias used to store the result of the query and identify the statistic in the calculation formula" label="Alias" name="alias" type="string"/>
        <attribute default="true" label="Display in the chart" name="inChart" type="boolean"/>
        <attribute default="true" label="Display in the table" name="inTable" type="boolean"/>
        <attribute default="'count'" label="Operator" name="operator" type="string"/>
        <attribute label="Label" localizable="true" name="label" translatedDefault="'Count'" type="string"/>
        <attribute label="Field to aggregate" name="aggExpr" type="string"/>
        <attribute label="User function" name="userFunction" type="string"/>
        <attribute default="true" label="Default formatting" name="useDefaultFormat" type="boolean"/>
        <attribute default="'string'" enum="cellFormat" label="Format" name="format" type="string"/>
        <attribute default="2" label="Number of decimal places" name="decimalPlaces" type="byte"/>
        <attribute default="true" label="Thousand separator" name="use1000Sep" type="boolean"/>
        <attribute default="false" label="Use as count" name="useAsCounting" type="boolean"/>
        <element name="where" ref="xtk:queryDef:where"/>
        <element autopk="true" label="Centile" name="percentile" ordered="true" unbound="true">
          <attribute label="Threshold" name="threshold" type="double"/>
        </element>
        <element name="marker" unbound="true">
          <attribute label="Place at the end of the series" name="atTheEnd" type="boolean"/>
          <attribute label="X axis" name="abscissaExpr" type="string"/>
          <attribute default="true" label="Display a horizontal line" name="hline" type="boolean"/>
          <attribute default="true" label="Display a vertical line" name="vline" type="boolean"/>
          <attribute default="true" label="Display the label" name="isLabel" type="boolean"/>
        </element>
      </element>
      <element name="data" xml="true">
        <attribute default="'query'" enum="dataSourceMode" label="Source" name="dataSource" type="string"/>
        <attribute label="Path of the collection" name="startPath" type="string"/>
        <element name="statistic" ref="statistic" unbound="true"/>
        <element name="where" ref="xtk:queryDef:where"/>
        <element name="sysFilter" ref="xtk:queryDef:sysFilter"/>
        <element label="Variables" name="variables">
          <element label="Columns" name="column">
            <element name="var" ref="variableDef"/>
          </element>
          <element label="Lines" name="row">
            <element name="var" ref="variableDef"/>
          </element>
        </element>
        <attribute default="1" label="Variable count" name="variableCount" type="byte"/>
        <attribute default="[/@schema]" label="Schema" name="schema" type="string"/>
        <attribute default="true" desc="Filter automatically with the context" label="Contextual filtering" name="contextFilter" type="boolean"/>
        <attribute label="Restrict to selected folder" name="folderFilter" type="boolean"/>
        <attribute label="Path in the context" name="folderVariable" type="string"/>
        <element name="group" template="group">
          <attribute default="'_root'" name="name"/>
          <element desc="Define columns" label="Columns" name="columns">
            <element label="Column" name="column" ordered="true" unbound="true">
              <attribute enum="columnWidthMode" label="Width calculation" name="widthMode" type="string"/>
              <attribute default="5.5" label="Width" name="width" type="float"/>
            </element>
          </element>
        </element>
      </element>
      <element label="Grouping" name="group">
        <attribute desc="Group name" label="Name" name="name" type="string"/>
        <attribute default="true" desc="Header line at the start of group" label="Header lines" name="hasHeader" type="boolean"/>
        <attribute default="true" desc="Footer line at the end of group" label="Footer lines" name="hasFooter" type="boolean"/>
        <attribute desc="Page break at the start of the group" label="Page break at start" name="pageBreakAtStart" type="boolean"/>
        <attribute desc="Page break at the end of the group" label="Page break at the end" name="pageBreakAtEnd" type="boolean"/>
        <attribute desc="Limit the number of lines displayed for the group" label="Limit the line count" name="limit" type="boolean"/>
        <attribute desc="Maximum number of lines to display for the group." label="Limit" name="limitValue" type="long"/>
        <attribute desc="Collapse the group lines by default" label="Collapse the default grouping" name="collapse" type="boolean"/>
        <element label="Grouping on" name="groupBy">
          <element label="Condition" name="node" ordered="true" template="variableDef" unbound="true"/>
        </element>
        <element label="Header" name="header" ordered="true" ref="tablerow" unbound="true"/>
        <element label="Line" name="row" ordered="true" ref="tablerow" unbound="true"/>
        <element label="Footer" name="footer" ordered="true" ref="tablerow" unbound="true"/>
        <element name="group" ordered="true" ref="group" unbound="true"/>
      </element>
      <element label="Table row" name="tablerow">
        <attribute label="Identifier" name="id" type="string"/>
        <element label="Cell" name="cell" ordered="true" template="variableDef" unbound="true">
          <attribute label="Identifier" name="id" type="string"/>
          <attribute default="0" name="classingType"/>
          <attribute name="colspan" type="byte"/>
          <element label="Style" name="style">
            <attribute desc="Style name (unique)" label="Name" name="name" type="string"/>
            <attribute default="'auto'" enum="styleAlignement" label="Text align" name="alignment" type="string"/>
            <attribute default="'default'" enum="styleVerticalAlignment" label="Vertical alignment" name="verticalAlignment" type="string"/>
            <attribute label="Background color" name="fillColor" type="string"/>
            <attribute default="'string'" enum="cellFormat" label="Format" name="format" type="string"/>
            <attribute default="'HImageLabel'" enum="enumDisplayFormat" label="Enumeration format" name="enumFormat" type="string"/>
            <attribute enum="defaultBoolean" label="Carriage return" name="wrapText" type="string"/>
            <attribute label="Negative numbers in red" name="negativeNumberRed" type="boolean"/>
            <attribute default="2" label="Number of decimal places" name="decimalPlaces" type="byte"/>
            <attribute default="true" label="Thousand separator" name="use1000Sep" type="boolean"/>
            <attribute desc="Display date with time." label="Display time" name="useTime" type="boolean"/>
            <attribute desc="Display time with seconds." label="Display seconds" name="useSec" type="boolean"/>
            <attribute desc="Currency used for formatting." label="Currency" name="currency" type="string"/>
            <element label="Extra" name="extra">
              <attribute desc="Extra visual on the column" enum="cellVisual" label="Visual" name="visual" type="string"/>
              <attribute label="Hide the cell value" name="hideValue" type="boolean"/>
              <attribute label="Max. value" name="ratingMax" type="byte"/>
            </element>
            <element label="Font" name="font" ref="font"/>
            <element label="Borders" name="border">
              <element label="Left" name="left" ref="border"/>
              <element label="Top" name="top" ref="border"/>
              <element label="Right" name="right" ref="border"/>
              <element label="Bottom" name="bottom" ref="border"/>
            </element>
          </element>
          <element label="Click on cell" name="onclick">
            <attribute enum="linkAction" label="Action" name="action" type="string"/>
            <attribute label="Transition" name="transition" type="string"/>
            <attribute label="URL" name="href" type="string"/>
            <element label="JavaScript" name="javascript" type="CDATA"/>
            <element label="Disabling clicks..." name="notClickableIf" ref="condition" unbound="true"/>
            <attribute enum="linkTarget" label="Window" name="target" type="string"/>
            <attribute label="Target name" name="targetName" type="string"/>
            <element label="Context" name="context">
              <element label="Set a value" name="set" unbound="true">
                <attribute label="XPath" name="xpath" type="string"/>
                <attribute label="Expression" name="expr" type="string"/>
              </element>
            </element>
            <element label="Objects to refresh" name="objectTarget" unbound="true">
              <attribute label="Identifier" name="identifier" type="string"/>
            </element>
            <element label="URL parameters" name="urlParam">
              <element label="Set a value" name="param" unbound="true">
                <attribute label="Name" name="name" type="string"/>
                <attribute label="Value" name="value" type="string"/>
              </element>
            </element>
          </element>
        </element>
      </element>
      <element label="Pivot table" name="cubeExplorer">
        <element label="Cube" name="cube" revLink="_NONE_" target="xtk:olapCube" type="link"/>
        <element label="Cube data" name="cubeInfo">
          <attribute label="Cube structure" name="cubeStructure" type="string"/>
        </element>
        <element desc="Filter to apply to data" label="Filter" name="where" ref="xtk:queryDef:where"/>
        <element label="Filters" name="filters">
          <element label="Filter" name="filter" type="ANY" unbound="true"/>
        </element>
        <element label="Visual explorer configuration" name="visualConfig">
          <attribute label="Measurement orientation" name="measureOrientation" type="string"/>
          <attribute label="Measure alignment" name="measureAlignment" type="string"/>
          <attribute label="Display the measurement labels" name="showMeasureLabels" type="boolean"/>
          <attribute label="Display caption" name="showLegend" type="boolean"/>
          <attribute label="Caption" name="legend" type="string"/>
          <attribute label="Strategy used to color the pivot table cells" name="currentColorStrategy" type="long"/>
          <element label="Available strategies" name="colorStrategy" unbound="true">
            <attribute label="Measure used" name="measureName" type="string"/>
            <attribute label="Lower limit" name="minValue" type="double"/>
            <attribute label="Upper limit" name="maxValue" type="double"/>
            <attribute label="Type of coloring" name="order" type="string"/>
          </element>
          <element label="Dimension" name="dimension" unbound="true">
            <key name="dimension">
              <keyfield xpath="@dimension-id"/>
            </key>
            <element label="Dimension" name="dimension" revLink="_NONE_" target="xtk:olapDimension" type="link">
              <join xpath-dst="@id" xpath-src="@dimension-id"/>
            </element>
            <attribute label="Foreign key of 'xtk:olapDimension' link (field 'id')" name="dimension-id" type="long"/>
            <attribute label="Orientation" length="15" name="orientation" type="string"/>
            <element label="Level" name="level" unbound="true">
              <key internal="true" name="levelName">
                <keyfield xpath="@name"/>
              </key>
              <attribute label="Name" name="name" type="string"/>
              <attribute label="Level label" name="label" type="string"/>
              <attribute label="Enabled" name="active" type="boolean"/>
              <attribute label="Sort type" name="sortMode" type="string"/>
              <attribute default="null" label="Measure used for sorting" name="sortMeasureName" type="string"/>
              <attribute label="Ascending sort" name="sortAsc" type="boolean"/>
              <attribute label="Display sub-total" name="showSum" type="boolean"/>
              <attribute label="Show enumeration images" name="showEnumImages" type="boolean"/>
              <attribute label="Display the level by default" name="defaultOpen" type="boolean"/>
              <attribute label="Number of lines shown" name="lineCount" type="long"/>
              <attribute label="Format" name="linkFormat" type="string"/>
            </element>
          </element>
          <element label="Measure" name="measure" unbound="true">
            <key name="measure">
              <keyfield xpath="@measure-id"/>
            </key>
            <element label="Measure" name="measure" revLink="_NONE_" target="xtk:olapMeasure" type="link">
              <join xpath-dst="@id" xpath-src="@measure-id"/>
            </element>
            <attribute label="Foreign key of 'xtk:olapMeasure' link (field 'id')" name="measure-id" type="long"/>
            <attribute label="Name of the measure" name="name" type="string"/>
            <attribute label="Label of the measure" name="label" type="string"/>
            <attribute label="Activated" name="active" type="boolean"/>
            <attribute label="Data table" name="data" type="memo"/>
            <attribute label="Unit of the measure" length="20" name="unit" type="string"/>
            <attribute label="Unit formatting" name="unitFormat" type="byte"/>
            <attribute label="Number of decimal places" name="decimalPlaces" type="long"/>
            <attribute label="Format" name="format" type="string"/>
            <attribute label="Dynamic measure" name="isDynamic" type="boolean"/>
            <element label="Configuration of the dynamic measure formula" name="dynamicFormula">
              <attribute label="Strategy" name="strategy" type="string"/>
              <element label="Combination" name="combine">
                <attribute label="Operator" name="operator" type="string"/>
                <attribute label="First measure" name="measure1" type="string"/>
                <attribute label="Second measure" name="measure2" type="string"/>
              </element>
              <element label="Breakdown" name="rate">
                <attribute label="Measure" name="measure" type="string"/>
                <attribute label="Dimension" name="dimension" type="string"/>
                <attribute label="Level" name="level" type="string"/>
                <attribute label="Divider type" name="levelType" type="string"/>
              </element>
              <element label="Comparison" name="comparison">
                <attribute label="Measure" name="measure" type="string"/>
                <attribute label="Dimension" name="dimension" type="string"/>
                <attribute label="Level" name="level" type="string"/>
                <attribute label="Operator" name="operator" type="string"/>
                <attribute label="Level to cross" name="crossLevel" type="string"/>
              </element>
              <element label="Scattering" name="dispersion">
                <attribute label="Measure" name="measure" type="string"/>
                <attribute label="Dimension" name="dimension" type="string"/>
                <attribute label="Level" name="level" type="string"/>
                <attribute label="Operator" name="operator" type="string"/>
              </element>
            </element>
          </element>
          <element label="Tree" name="tree" unbound="true">
            <key internal="true" name="treeOrientation">
              <keyfield xpath="@orientation"/>
            </key>
            <attribute label="Orientation" length="15" name="orientation" type="string"/>
            <element label="Node" name="node" unbound="true">
              <key internal="true" name="nodeId">
                <keyfield xpath="@nodeId"/>
              </key>
              <attribute default="-1" label="Identifier" name="nodeId" type="long"/>
              <attribute default="-1" label="Parent node identifier" name="parentId" type="long"/>
              <attribute default="-1" label="Previous node identifier" name="previousDimensionId" type="long"/>
              <element label="Dimension" name="dimension" revLink="_NONE_" target="xtk:olapDimension" type="link"/>
              <attribute label="Level name" name="levelName" type="string"/>
              <attribute label="Value" name="value" type="string"/>
              <attribute label="Label" name="label" type="string"/>
              <attribute label="Opened" name="opened" type="boolean"/>
            </element>
          </element>
        </element>
      </element>
      <element autopk="true" label="Table" name="table" template="xtk:abstractForm:cell" unbound="true">
        <attribute localizable="true" name="label" translatedDefault="'Table '+ColIndex()"/>
        <attribute label="Caption" localizable="true" name="legend" type="string"/>
        <attribute default="'pivot'" name="type" type="string"/>
        <attribute default="'inherit'" enum="labelPosition" label="Position of the caption" name="labelPosition" type="string"/>
        <attribute default="false" label="Display statistics label" name="displayStatLabel" type="boolean"/>
        <attribute default="true" label="Display sub-totals" name="displaySubtotal" type="boolean"/>
        <attribute enum="orientation" label="Statistics orientation" name="statOrientation" type="string"/>
        <element name="cubeExplorer" template="xtk:abstractForm:cubeExplorer"/>
        <element name="data" ref="data"/>
        <attribute default="true" name="hasTable" type="boolean"/>
        <attribute default="false" name="hasChart" type="boolean"/>
      </element>
      <element autopk="true" label="Chart" name="chart" template="xtk:abstractForm:cell" unbound="true" xml="true">
        <attribute localizable="true" name="label" translatedDefault="'Chart '+ColIndex()"/>
        <attribute label="Caption" localizable="true" name="legend" type="string"/>
        <attribute enum="chartRenderType" name="type" type="string"/>
        <attribute default="'inherit'" enum="labelPosition" label="Position of the caption" name="labelPosition" type="string"/>
        <attribute default="600" label="Width" name="width" type="short"/>
        <attribute default="400" label="Height" name="height" type="short"/>
        <attribute default="0" desc="Inner radius (the outer radius is 1)" label="Inner radius" name="innerPieRadius" type="double"/>
        <attribute default="true" label="Filled radar" name="radarFilled" type="boolean"/>
        <attribute default="false" label="Stacked" name="stacked" type="boolean"/>
        <attribute default="false" label="Inverted stack" name="reverseStacking" type="boolean"/>
        <attribute default="false" label="Reverse display sequence" name="reverseSeries" type="boolean"/>
        <attribute default="false" label="Caption" name="hasLegend" type="boolean"/>
        <attribute default="true" label="3D effect" name="perspective" type="boolean"/>
        <attribute default="false" label="Accumulate values" name="accumulate" type="boolean"/>
        <attribute default="true" label="Display caption" name="displayLegend" type="boolean"/>
        <attribute enum="chartLegendPosition" label="Position of the caption" name="legendPosition" type="string"/>
        <attribute default="false" desc="Do not reduce the size of the chart to display the caption" label="Include in the chart" name="legendOver" type="boolean"/>
        <attribute default="true" label="Show labels" name="displayLabels" type="boolean"/>
        <attribute default="false" label="Show empty columns" name="displayEmptySamples" type="boolean"/>
        <attribute enum="sortMode" label="Sort" name="sortMode" type="byte"/>
        <attribute default="true" label="Zoom with the mouse wheel" name="zoomOnWheel" type="boolean"/>
        <attribute default="50" desc="Opacity percentage of areas." label="Opacity (%)" name="filledOpacity" type="double"/>
        <element name="data" ref="data"/>
        <attribute default="false" name="hasTable" type="boolean"/>
        <attribute default="true" name="hasChart" type="boolean"/>
        <element name="onclick">
          <attribute default="'url'" enum="linkAction" label="Action" name="action" type="string"/>
          <attribute label="Transition" name="transition" type="string"/>
          <attribute label="URL" name="href" type="string"/>
          <attribute default="'_blank'" enum="linkTarget" label="Window" name="target" type="string"/>
          <attribute label="Target name" name="targetName" type="string"/>
          <attribute default="false" label="Enabled when history" name="enabledWhenHistory" type="boolean"/>
          <element label="JavaScript" name="javascript" type="CDATA"/>
          <element label="Context" name="context">
            <element label="Set a value" name="set" unbound="true">
              <attribute label="XPath" name="xpath" type="string"/>
              <attribute label="Expression" name="expr" type="string"/>
            </element>
          </element>
          <element label="Objects to refresh" name="objectTarget" unbound="true">
            <attribute label="Identifier" name="identifier" type="string"/>
          </element>
          <element label="URL parameters" name="urlParam">
            <element label="Set a value" name="param" unbound="true">
              <attribute label="Name" name="name" type="string"/>
              <attribute label="Value" name="value" type="string"/>
            </element>
          </element>
        </element>
      </element>
      <element label="Border" name="border">
        <attribute enum="borderStyle" label="Style" name="style" type="string"/>
        <attribute label="Color" name="color" type="string"/>
      </element>
      <element label="Font" name="font">
        <attribute label="Font" name="font" type="string"/>
        <attribute enum="fontStyle" label="Style" name="style" type="string"/>
        <attribute default="'default'" enum="defaultBoolean" label="Underlined" name="underline" type="string"/>
        <attribute default="'default'" enum="defaultBoolean" label="Strikethrough" name="strikethrough" type="string"/>
        <attribute desc="Color (RGB, HEXA)" label="Color" name="color" type="string"/>
        <attribute desc="Font size in points" label="Size" name="size" type="string"/>
      </element>
      <element autopk="true" label="Value" name="value" template="xtk:abstractForm:cell" unbound="true" xml="true">
        <attribute localizable="true" name="label" translatedDefault="'Value '+ColIndex()"/>
        <attribute default="'inherit'" enum="labelPosition" label="Label position" name="labelPosition" type="string"/>
        <attribute name="xpath" type="string"/>
        <attribute name="alias" type="string"/>
        <element label="Style" name="style" ref="tablerow/cell/style"/>
      </element>
      <element folderLink="folder" name="abstractForm">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@internalName"/>
        </key>
        <attribute label="Entity schema" name="entitySchema" type="string" xml="true"/>
        <attribute advanced="true" desc="Counter for generating identifiers" label="Counter" name="idCounter" type="long"/>
        <attribute advanced="true" defOnDuplicate="true" enum="workflowState" label="Internal status" name="state" type="byte"/>
        <attribute defOnDuplicate="true" enum="appState" label="Status" name="appState" type="byte"/>
        <attribute label="Background image" name="background" type="string" xml="true"/>
        <attribute name="internalName" template="xtk:common:name"/>
        <attribute defOnDuplicate="true" desc="Form publication date" label="Publication date" name="publicationDate" pkgStatus="never" type="datetime"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute defOnDuplicate="false" enum="xtk:dictionaryString:translationStatus" label="Translation status" name="translationStatus" type="byte"/>
        <attribute name="timezone" template="xtk:common:timezone"/>
        <element name="desc" template="xtk:common:desc"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute defOnDuplicate="true" default="newUUID()" label="Security ID" name="uuid" pkgStatus="never" type="string" xml="true"/>
        <attribute dbEnum="dictionaryLocale" default="GetLocale(true)" label="Design language" localizable="true" name="designLanguage" pkgStatus="always" type="string"/>
        <attribute dbEnum="dictionaryLocale" default="GetLocale(true)" label="Default language" localizable="true" name="defaultLanguage" pkgStatus="always" type="string"/>
        <element default="DefaultFolder('xtkDictionary', [@_defaultDictionary-id])" label="Defaut dictionary" name="defaultDictionary" revLink="_NONE_" target="xtk:folder" type="link"/>
        <element label="Other languages" name="additionalLanguages" xml="true">
          <element label="Language" name="language" unbound="true">
            <key name="lang">
              <keyfield xpath="@lang"/>
            </key>
            <attribute dbEnum="dictionaryLocale" label="Language" name="lang" type="string"/>
          </element>
        </element>
        <attribute desc="Access control mode." label="Access control" name="accessControl" type="byte" xml="true"/>
        <attribute desc="Indicates whether a permalink is used for authentication." label="Permalink" name="permaLink" type="boolean" xml="true"/>
        <element label="Operator" name="operator" revLink="_NONE_" target="xtk:operator" type="link" xml="false"/>
        <element label="Folder" name="folder" required="true" revIntegrity="define" target="xtk:folder" type="link"/>
        <attribute default="getOption('Nms_DefaultRcpSchema')" label="Schema" name="schema" type="string" xml="true"/>
        <attribute default="'/'" label="Schema start path" name="startPath" type="string" xml="true"/>
        <element name="rendering" target="xtk:formRendering" type="link"/>
        <attribute advanced="true" label="Disable caching" name="disableCaching" type="boolean" xml="true"/>
        <element integrity="own" name="log" revLink="job" target="xtk:jobLog" type="link" unbound="true"/>
        <element label="Properties" name="properties" xml="true">
          <attribute desc="Window title" label="Title" localizable="true" name="windowTitle" translatedDefault="'Enter the title of the window here'" type="string"/>
          <attribute default="'left'" enum="labelPosition" label="Label position" name="labelPosition" type="string"/>
          <attribute desc="Page navigation mode (link, button, image)." enum="navigationMode" label="Navigation" name="navigationMode" type="string"/>
          <attribute default="1" enum="renderingEngine" label="Rendering engine" name="renderingEngine" pkgStatus="always" type="byte"/>
          <element desc="HTML content of the page header" label="Page header" name="header" type="html"/>
          <element desc="HTML content of the page footer" label="Page footer" name="footer" type="html"/>
          <element name="strings" ref="strings" xml="true"/>
          <attribute desc="Display frame around the page" label="Display frame" name="displayFrame" type="boolean" xml="true"/>
        </element>
        <element desc="Settings sent to the form." label="Parameters" name="parameters" xml="true">
          <element label="Parameter" name="param" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute dataPolicy="identifier" default="'p'+ColIndex()" label="Name" name="name" required="true" type="string"/>
            <attribute label="Required parameter" name="required" type="boolean"/>
            <element name="storage" ref="storage"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
            <attribute label="Type" name="type" type="string"/>
          </element>
          <attribute desc="Authorizes writing in the context from the parameters in the URL." label="Authorize XPath-type parameters" name="allowXPathParameters" type="boolean"/>
        </element>
        <element desc="Declare variables." label="Variables" name="variables" xml="true">
          <element name="variable" ref="variable" unbound="true"/>
        </element>
        <element desc="JavaScript codes used client or server side" label="Library" name="library" xml="true">
          <element label="Script" name="script" ordered="true" unbound="true">
            <key name="ref">
              <keyfield xpath="@ref-name"/>
              <keyfield xpath="@ref-namespace"/>
            </key>
            <element label="Reference" name="ref" revLink="_NONE_" target="xtk:javascript" type="link"/>
            <attribute desc="Script execution mode." enum="runat" label="Execution" name="runat" type="string" xml="true"/>
          </element>
        </element>
        <element name="resources" xml="true">
          <element enumImage="@type" label="Resource" name="resource" ordered="true" type="string" unbound="true">
            <key name="resId">
              <keyfield xpath="@id"/>
              <keyfield xpath="@lang"/>
            </key>
            <attribute label="Identifier" name="id" type="string"/>
            <attribute label="Language" name="lang" type="string"/>
            <attribute default="'string'" label="Type" name="type" type="string"/>
            <attribute label="Context" name="context" type="string"/>
            <element label="value" localizable="true" name="value" type="CDATA"/>
            <element desc="String used as the source for the translation" label="Reference string" name="ref" type="CDATA">
              <attribute label="Language" name="lang" type="string"/>
            </element>
            <attribute label="Translation approved" name="validated" type="boolean"/>
          </element>
        </element>
        <element label="Error page" name="errorPage" xml="true">
          <attribute label="Title" localizable="true" name="label" translatedDefault="'Error'" type="string"/>
          <attribute default="'errorPage'" label="Name" name="name" type="string"/>
          <element name="endPage" template="xtk:abstractForm:endPage"/>
        </element>
      </element>
      <element label="Strings" name="strings">
        <element label="String" name="string" unbound="true" xml="true">
          <key name="id">
            <keyfield xpath="@id"/>
          </key>
          <attribute label="Identifier" name="id" type="string"/>
          <attribute label="Value" localizable="true" name="value" type="string"/>
        </element>
      </element>
      <methods>
        <method name="GetSourceAsHtml" static="true">
          <parameters>
            <param desc="Report definition." inout="in" name="form" type="DOMElement"/>
            <param desc="Document type to generate." inout="in" name="renderer" type="string"/>
            <param desc="Source code." inout="out" name="source" type="CDATA"/>
            <param desc="Generation logs." inout="out" name="logs" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetSource" static="true">
          <parameters>
            <param desc="Form identifier." inout="in" name="formId" type="string"/>
            <param desc="Document type to generate." inout="in" name="target" type="string"/>
            <param desc="Recover the complete version" inout="in" name="compiled" type="boolean"/>
            <param desc="Document version to generate." inout="in" name="version" type="string"/>
            <param desc="Source code." inout="out" name="source" type="CDATA"/>
            <param desc="Generation logs." inout="out" name="logs" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetInputValues" static="true">
          <parameters>
            <param desc="Survey edit schema." inout="in" name="schema" type="string"/>
            <param desc="Input zone." inout="in" name="input" type="DOMElement"/>
            <param desc="Possible values for this input zone." inout="out" name="options" type="DOMElement"/>
          </parameters>
        </method>
        <method name="FillSteps" static="true">
          <parameters>
            <param desc="Root schema of analysis" inout="in" name="schema" type="string"/>
            <param desc="Source expression" inout="in" name="expr" type="string"/>
            <param desc="Number of bins to generate" inout="in" name="classCount" type="long"/>
            <param desc="List of steps" inout="out" name="samplingSteps" type="DOMElement"/>
          </parameters>
        </method>
        <method name="FillStepsWithFilter" static="true">
          <parameters>
            <param desc="Root schema of analysis" inout="in" name="schema" type="string"/>
            <param desc="Source expression" inout="in" name="expr" type="string"/>
            <param desc="Number of bins to generate" inout="in" name="classCount" type="long"/>
            <param desc="Filter on the schema" inout="in" name="filter" type="DOMElement"/>
            <param desc="List of steps" inout="out" name="samplingSteps" type="DOMElement"/>
          </parameters>
        </method>
        <method name="SelectTopValues" static="true">
          <parameters>
            <param desc="Root schema of analysis" inout="in" name="schema" type="string"/>
            <param desc="Source expression" inout="in" name="expr" type="string"/>
            <param desc="Number of bins to generate" inout="in" name="classCount" type="long"/>
            <param desc="List of values" inout="out" name="selectedValues" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" implements="xtk:persist" label="Generation services of the application server" mappingType="xmlFile" name="builder" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="Oracle" name="creationProvider">
        <value img="xtk:oracle.png" name="Oracle"/>
        <value img="xtk:mssql.png" label="Microsoft SQL Server" name="MSSQL"/>
        <value img="xtk:pgsql.png" label="PostgreSQL" name="PostgreSQL"/>
        <value img="xtk:db2.png" label="DB2" name="DB2"/>
        <value img="xtk:mysql.png" label="MySQL" name="MySQL"/>
      </enumeration>
      <element name="createdbParameters" xml="true">
        <attribute desc="Database name" img="xtk:dbcnx.png" label="Database name" name="dbName" required="true" type="string"/>
        <attribute default="false" label="Delete and recreate database if it already exists" name="overwriteDatabase" type="boolean"/>
        <attribute default="true" desc="Create an new user account" name="createNewAccount" type="boolean"/>
        <attribute label="User tablespace" name="tableSpaceUser" type="string"/>
        <attribute label="Indexes tablespace" name="tableSpaceIndex" type="string"/>
        <attribute label="Temporary tablespace" name="tableSpaceTemp" type="string"/>
        <attribute label="Working data tablespace" name="tableSpaceWork" type="string"/>
        <attribute label="Working index tablespace" name="tableSpaceWorkIndex" type="string"/>
        <attribute label="Unicode database (multi-lingual data support)" name="unicodeData" type="boolean"/>
        <attribute label="Unicode storage (use of NCLOB, NVARCHAR, etc. type data)" name="NChar" type="boolean"/>
        <attribute label="GMT base (date with time zone)" name="utc" type="boolean"/>
        <attribute label="Time zone" name="timezone" template="xtk:common:timezone"/>
        <attribute label="Display and edit the SQL script for creating tables" name="editSql" type="boolean"/>
        <attribute label="Delete tables if they already exist" name="overwriteTables" type="boolean"/>
        <attribute default="100" label="Database size (Mb)" name="databaseSizeMb" type="long"/>
        <element desc="SQL DDL script" name="sqlDDL" type="string"/>
        <element desc="SQL DDL scripts" name="ddl" type="string" unbound="true">
          <key>
            <keyfield xpath="@dataSource"/>
          </key>
          <attribute label="ID of the data source" name="dataSource" type="string"/>
        </element>
        <element name="creationSteps">
          <attribute default="true" label="Create the database and the user account" name="createEmptyDb" type="boolean"/>
        </element>
        <element desc="Packages to add to the database" name="packages">
          <element label="List of packages" name="package" unbound="true">
            <key internal="true" name="id">
              <keyfield xpath="@id"/>
            </key>
            <attribute default="Gid()" label="Internal key" name="id" type="string"/>
            <attribute label="Name of the packages" name="name" type="string"/>
            <attribute label="Namespace" name="namespace" type="string"/>
            <attribute default="false" label="Install" name="enabled" type="boolean"/>
            <attribute label="Package" name="label" type="string"/>
          </element>
        </element>
        <element name="dbAdminAccount">
          <attribute img="xtk:login.png" label="Account" name="login" type="string"/>
          <attribute name="password" template="xtk:common:password"/>
        </element>
        <attribute default="true" label="Set or change the password of the Adobe Campaign 'admin' application account" name="changeAdminPassword" type="boolean"/>
        <attribute label="Administrator password" name="nlAdminPassword" template="xtk:common:password"/>
      </element>
      <element name="builder" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element name="dbcnx" ref="xtk:serverConf:dataSource/dbcnx" xml="true"/>
        <element name="createdbParameters" ref="xtk:builder:createdbParameters"/>
        <element name="package" type="ANY"/>
      </element>
      <methods async="true">
        <method access="admin" name="GetDbParams" static="true">
          <parameters>
            <param desc="Data source definition" inout="out" name="dbcnx" type="DOMElement"/>
            <param desc="Update the namespaces and tablespaces." inout="out" name="dbParameters" type="DOMElement"/>
          </parameters>
        </method>
        <method access="admin" const="true" name="GenCreateDbDDL">
          <parameters>
            <param desc="SQL script" inout="out" name="sqlDDL" type="string"/>
          </parameters>
        </method>
        <method access="admin" name="CreateDb" static="true">
          <parameters>
            <param desc="Creation parameters" name="parameters" type="DOMElement"/>
          </parameters>
        </method>
        <method access="admin" hidden="true" name="GenUpdateDbDDL" static="true">
          <parameters>
            <param desc="Update parameters" name="parameters" type="DOMElement"/>
            <param desc="SQL scripts" inout="out" name="DDLStmts" type="DOMElement"/>
          </parameters>
        </method>
        <method access="admin" name="UpdateDb" static="true">
          <parameters>
            <param desc="Creation parameters" name="parameters" type="DOMElement"/>
          </parameters>
        </method>
        <method access="admin" name="InstallVendorPackages" static="true">
          <parameters>
            <param desc="Parameters" name="parameters" type="DOMElement"/>
          </parameters>
        </method>
        <method access="admin" name="InstallPackageImpl" static="true">
          <parameters>
            <param desc="XML element containing the package to import." name="parameters" type="DOMElement"/>
          </parameters>
        </method>
        <method access="admin" library="xtk:package.js" name="InstallPackage" static="true">
          <parameters>
            <param desc="XML element containing the package to import." name="parameters" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ResolvePackageReferences" static="true">
          <parameters>
            <param desc="XML element containing the package to import." name="parameters" type="DOMElement"/>
            <param desc="Processed package." inout="out" name="patchedPackage" type="DOMElement"/>
            <param desc="Number of warnings generated." inout="out" name="warningNb" type="long"/>
          </parameters>
        </method>
        <method name="BuildSchema" static="true">
          <parameters>
            <param desc="Source schema" name="source" type="DOMElement"/>
          </parameters>
        </method>
        <method name="BuildSchemaFromId" static="true">
          <parameters>
            <param desc="Schema ID" name="schemaId" type="string"/>
          </parameters>
        </method>
        <method name="BuildOutputSchema" static="true">
          <parameters>
            <param desc="Source schema" name="source" type="DOMElement"/>
            <param desc="Save schema after generation" name="saveEntity" type="boolean"/>
            <param desc="Generated schema" inout="out" name="schema" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="BuildSqlSchemaDiff" static="true">
          <parameters>
            <param desc="Extension Parameters" inout="in" name="sqlDiffParam" type="DOMElement"/>
            <param desc="Initial package" inout="in" name="package" type="DOMElement"/>
            <param desc="SqlSchemaDiff generated" inout="out" name="sqlSchemaDiff" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="BuildUpdateSchemaDiff" static="true">
          <parameters>
            <param desc="Update parameters" name="parameters" type="DOMElement"/>
            <param desc="Use SQL naming conventions to compute paths of new fields." inout="in" name="useNamingConventions" type="boolean"/>
            <param desc="Generated schema" inout="out" name="sqlSchemaDiff" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="BuildUpdateOneSchemaDiff" static="true">
          <parameters>
            <param desc="Schema identifier" inout="in" name="schemaId" type="string"/>
            <param desc="Use SQL naming conventions to compute paths of new fields." inout="in" name="useNamingConventions" type="boolean"/>
            <param desc="Generated schema" inout="out" name="sqlSchemaDiff" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GenerateNavTree" static="true"></method>
        <method name="BuildOutputNavTree" static="true">
          <parameters>
            <param desc="Source navigation tree" name="navtreeSource" type="DOMElement"/>
            <param desc="Save the result" name="save" type="boolean"/>
            <param desc="Result of the merge" inout="out" name="navtree" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetDefaultNamespace" static="true">
          <parameters>
            <param desc="Namespace" inout="out" name="namspace" type="string"/>
          </parameters>
        </method>
        <method name="RemoveSchemaLinkRef" static="true">
          <parameters>
            <param desc="Schema identifier" name="id" type="string"/>
            <param desc="Extension schema" name="extendedSchema" type="string"/>
          </parameters>
        </method>
        <method name="GenerateSchema" static="true">
          <parameters>
            <param name="parameters" type="DOMElement"/>
            <param desc="Generation parameters" name="source" type="DOMElement"/>
            <param desc="Generated schema" inout="out" name="schema" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="UpdateSchemaFromDatabase" static="true">
          <parameters>
            <param desc="Schema identifier" name="id" type="string"/>
          </parameters>
        </method>
        <method name="UpdateTempSchemasFromDatabase" static="true">
          <parameters>
            <param desc="Schema to regenerate" name="schema" type="DOMElement"/>
            <param desc="Generated schema" inout="out" name="result" type="DOMElement"/>
            <param desc="Warning" inout="out" name="warning" type="string"/>
          </parameters>
        </method>
        <method access="admin" name="ExecSql" static="true">
          <parameters>
            <param desc="Data source" name="dataSource" type="string"/>
            <param desc="SQL instruction" name="sql" type="string"/>
          </parameters>
        </method>
        <method access="admin" name="ExecSqlScript" static="true">
          <parameters>
            <param desc="Data source" name="dataSource" type="string"/>
            <param desc="SQL script" name="sql" type="string"/>
          </parameters>
        </method>
        <method name="CheckTableExists" static="true">
          <parameters>
            <param desc="Data source" name="dataSource" type="string"/>
            <param desc="Table name" name="tableName" type="string"/>
            <param desc="Result" inout="out" name="exists" type="boolean"/>
          </parameters>
        </method>
        <method access="admin" name="EvaluateJavaScript" static="true">
          <parameters>
            <param desc="Script name." inout="in" name="name" type="string"/>
            <param desc="Script code to execute." inout="in" name="script" type="string"/>
            <param desc="Execution context of the test." inout="inout" name="context" type="DOMDocument"/>
          </parameters>
        </method>
        <method access="admin" name="EvaluateJavaScriptTemplate" static="true">
          <parameters>
            <param desc="Script name." inout="in" name="name" type="string"/>
            <param desc="Document to evaluate." inout="in" name="template" type="string"/>
            <param desc="Context when evaluating the document." inout="inout" name="context" type="DOMDocument"/>
            <param desc="Document resulting from the evaluation." inout="out" name="result" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" library="true" name="common" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="yesno">
        <value label="Yes" name="yes" value="1"/>
        <value label="No" name="no" value="0"/>
      </enumeration>
      <enumeration basetype="byte" default="no" name="deleteStatus">
        <value label="No" name="no" value="0"/>
        <value label="Yes" name="yes" value="1"/>
        <value label="Recycled" name="recycled" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="string" name="dataType">
        <value label="Text" name="string" value="6"/>
        <value label="Integer" name="long" value="3"/>
        <value label="Floating point" name="double" value="5"/>
        <value label="Date+Time" name="timestamp" value="7"/>
        <value label="Long text" name="memo" value="12"/>
      </enumeration>
      <enumeration basetype="string" name="dataPolicy">
        <value label="(No value)" name="none"/>
        <value label="First letters in uppercase" name="smartCase"/>
        <value label="All in lowercase" name="lowerCase"/>
        <value label="All in uppercase" name="upperCase"/>
        <value label="Email address" name="email"/>
        <value label="Phone number" name="phone"/>
        <value label="Identifier name" name="identifier"/>
        <value label="File name" name="resIdentifier"/>
      </enumeration>
      <enumeration basetype="long" default="latin1" label="Encoding" name="codepage">
        <value label="Central Europe (1250)" name="latin2" value="1250"/>
        <value label="Cyrillic (1251)" name="cyrilic" value="1251"/>
        <value label="Latin 1 (1252)" name="latin1" value="1252"/>
        <value label="Greek (1253)" name="greek" value="1253"/>
        <value label="Turkish (1254)" name="turkish" value="1254"/>
        <value label="Hebrew (1255)" name="hebrew" value="1255"/>
        <value label="Arabic (1256)" name="arabic" value="1256"/>
        <value label="Baltic (1257)" name="baltic" value="1257"/>
        <value label="Vietnam (1258)" name="vietnam" value="1258"/>
        <value label="Thai (874)" name="thai" value="874"/>
        <value label="MS-DOS (PC-8)" name="oem" value="1"/>
        <value label="Macintosh" name="mac" value="2"/>
        <value enabledIf="'$(entityPath)'!='/workflow' AND '$(entityPath)'!='/group'" label="Japanese (Shift-JIS 932)" name="shiftjis" value="932"/>
        <value enabledIf="'$(entityPath)'!='/workflow' AND '$(entityPath)'!='/group'" label="Japanese (ISO 2022)" name="iso2022 " value="50220"/>
        <value enabledIf="'$(entityPath)'!='/workflow' AND '$(entityPath)'!='/group'" label="Traditional Chinese (Big5 950)" name="big5" value="950"/>
        <value enabledIf="'$(entityPath)'!='/workflow' AND '$(entityPath)'!='/group'" label="Simplified Chinese (GB2312)" name="gb2312" value="936"/>
        <value enabledIf="'$(entityPath)'!='/workflow' AND '$(entityPath)'!='/group'" label="Korean (EUC-Korean 51949)" name="euckorean" value="51949"/>
        <value label="UTF-8" name="utf8" value="65001"/>
        <value label="ISO Latin 1" name="isolatin1" value="28591"/>
        <value label="ISO Latin 2" name="isolatin2" value="28592"/>
        <value label="ISO Latin 9" name="isolatin9" value="28605"/>
        <value label="Unicode" name="utf16le" value="90000"/>
        <value label="Unicode big-endian" name="utf16be" value="90001"/>
      </enumeration>
      <enumeration basetype="string" default="_inherit_" label="Time zones" name="timezone">
        <value enabledIf="'$(entityPath)'='/workflow' or '$(entityPath)'='/dataTransfer' or '$(entityPath)'='/group' or '$(entityPath)'='/webApp' or '$(entityPath)'='/report' or '$(entityPath)'='/olapCube'" label="Default" name="_inherit_" value="_inherit_"/>
        <value enabledIf="'$(entityPath)'='/workflow' or '$(entityPath)'='/dataTransfer' or '$(entityPath)'='/group' or '$(entityPath)'='/webApp' or '$(entityPath)'='/report' or '$(entityPath)'='/operator' or '$(entityPath)'='/builder' or '$(entityPath)'='/extAccount' or '$(entityPath)'='/olapCube'" label="Server time zone" name="_server_" value="_server_"/>
        <value enabledIf="'$(entityPath)'='/workflow' or '$(entityPath)'='/dataTransfer' or '$(entityPath)'='/group' or '$(entityPath)'='/webApp' or '$(entityPath)'='/report' or '$(entityPath)'='/olapCube'" label="Operator time zone" name="_login_" value="_login_"/>
        <value enabledIf="'$(entityPath)'='/workflow' or '$(entityPath)'='/dataTransfer' or '$(entityPath)'='/group' or '$(entityPath)'='/webApp' or '$(entityPath)'='/report' or '$(entityPath)'='/olapCube' or '$(entityPath)'='/operator'" label="Time zone of the database" name="_wdbc_" value="_wdbc_"/>
        <value label="(GMT-11:00) Samoa" name="Pacific_Samoa" value="Pacific/Samoa"/>
        <value label="(GMT-11:00) Greenwich Mean Time minus 11 hours" name="Gmt_m11" value="Etc/GMT+11"/>
        <value label="(GMT-10:00) Hawai" name="Pacific_Honolulu" value="Pacific/Honolulu"/>
        <value label="(GMT-10:00) Greenwich Mean Time minus 10 hours" name="Gmt_m10" value="Etc/GMT+10"/>
        <value label="(GMT-09:00) Alaska" name="America_Anchorage" value="America/Anchorage"/>
        <value label="(GMT-09:00) Greenwich Mean Time minus 9 hours" name="Gmt_m9" value="Etc/GMT+9"/>
        <value label="(GMT-08:00) Pacific (United States and Canada)" name="America_Los_Angeles" value="America/Los_Angeles"/>
        <value label="(GMT-08:00) Greenwich Mean Time minus 8 hours" name="Gmt_m8" value="Etc/GMT+8"/>
        <value label="(GMT-07:00) Arizona" name="America_Phoenix" value="America/Phoenix"/>
        <value label="(GMT-07:00) Chihuahua, La Paz, Mazatlan" name="America_Chihuahua" value="America/Chihuahua"/>
        <value label="(GMT-07:00) Rocky Mountains (United States and Canada)" name="America_Denver" value="America/Denver"/>
        <value label="(GMT-07:00) Greenwich Mean Time minus 7 hours" name="Gmt_m7" value="Etc/GMT+7"/>
        <value label="(GMT-06:00) Central America" name="America_Regina" value="America/Regina"/>
        <value label="(GMT-06:00) Center (United States and Canada)" name="America_Chicago" value="America/Chicago"/>
        <value label="(GMT-06:00) Guadalajara, Mexico, Monterrey" name="America_Mexico_City" value="America/Mexico_City"/>
        <value label="(GMT-06:00) Greenwich Mean Time minus 6 hours" name="Gmt_m6" value="Etc/GMT+6"/>
        <value label="(GMT-05:00) Bogota, Lima, Quito" name="America_Bogota" value="America/Bogota"/>
        <value label="(GMT-05:00) Est (United States and Canada)" name="America_New_York" value="America/New_York"/>
        <value label="(GMT-05:00) Indiana (East)" name="America_Indianapolis" value="America/Indianapolis"/>
        <value label="(GMT-05:00) Greenwich Mean Time minus 5 hours" name="Gmt_m5" value="Etc/GMT+5"/>
        <value label="(GMT-04:30) Caracas" name="America_Caracas" value="America/Caracas"/>
        <value label="(GMT-04:00) Asuncin" name="America_Asuncion" value="America/Asuncion"/>
        <value label="(GMT-04:00) Cuiaba" name="America_Cuiaba" value="America/Cuiaba"/>
        <value label="(GMT-04:00) La Paz" name="America_La_Paz" value="America/La_Paz"/>
        <value label="(GMT-04:00) Manaus" name="America_Manaus" value="America/Manaus"/>
        <value label="(GMT-04:00) Atlantic Standard Time (Canada)" name="America_Halifax" value="America/Halifax"/>
        <value label="(GMT-04:00) Santiago" name="America_Santiago" value="America/Santiago"/>
        <value label="(GMT-04:00) Greenwich Mean Time minus 4 hours" name="Gmt_m4" value="Etc/GMT+4"/>
        <value label="(GMT-03:30) Newfoundland" name="America_St_Johns" value="America/St_Johns"/>
        <value label="(GMT-03:00) Brasi" name="America_Sao_Paulo" value="America/Sao_Paulo"/>
        <value label="(GMT-03:00) Buenos Aires, Cayenne, Fortaleza" name="America_Buenos_Aires" value="America/Buenos_Aires"/>
        <value label="(GMT-03:00) Greenland" name="America_Godthab" value="America/Godthab"/>
        <value label="(GMT-03:00) Montevideo" name="America_Montevideo" value="America/Montevideo"/>
        <value label="(GMT-03:00) Greenwich Mean Time minus 3 hours" name="Gmt_m3" value="Etc/GMT+3"/>
        <value label="(GMT-02:00) Central-Atlantic" name="Atlantic_South_Georgia" value="Atlantic/South_Georgia"/>
        <value label="(GMT-02:00) Greenwich Mean Time minus 2 hours" name="Gmt_m2" value="Etc/GMT+2"/>
        <value label="(GMT-01:00) Cape Verde islands" name="Atlantic_Cape_Verde" value="Atlantic/Cape_Verde"/>
        <value label="(GMT-01:00) The Azores" name="Atlantic_Azores" value="Atlantic/Azores"/>
        <value label="(GMT-01:00) Greenwich Mean Time minus 1 hour" name="Gmt_m1" value="Etc/GMT+1"/>
        <value label="(GMT) Casablanca" name="Africa_Casablanca" value="Africa/Casablanca"/>
        <value label="(GMT) GreenwichMean Time: Dublin, Edinburgh, Lisbon, London" name="Europe_London" value="Europe/London"/>
        <value label="(GMT) Monrovia" name="Africa_Monrovia" value="Africa/Monrovia"/>
        <value label="(GMT) Reykjavik" name="Atlantic_Reykjavik" value="Atlantic/Reykjavik"/>
        <value label="(GMT) Greenwich mean time" name="GMT" value="GMT"/>
        <value label="(GMT+01:00) Central Africa - West" name="Africa_Luanda" value="Africa/Luanda"/>
        <value label="(GMT+01:00) Amsterdam, Berlin, Berne, Rome, Stockholm, Vienna" name="Europe_Berlin" value="Europe/Berlin"/>
        <value label="(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague" name="Europe_Belgrade" value="Europe/Belgrade"/>
        <value label="(GMT+01:00) Brussels, Copenhagen, Madrid, Paris" name="Europe_Paris" value="Europe/Paris"/>
        <value label="(GMT+01:00) Sarajevo, Skoplje, Sofia, Warsaw, Zagreb" name="Europe_Sarajevo" value="Europe/Sarajevo"/>
        <value label="(GMT+01:00) Greenwich Mean Time plus 1 hour" name="Gmt_p1" value="Etc/GMT-1"/>
        <value label="(GMT+02:00) Amman" name="Asia_Amman" value="Asia/Amman"/>
        <value label="(GMT+02:00) Athens, Istanbul, Minsk" name="Europe_Athens" value="Europe/Athens"/>
        <value label="(GMT+02:00) Beirut" name="Asia_Beirut" value="Asia/Beirut"/>
        <value label="(GMT+02:00) Bucarest" name="Europe_Bucharest" value="Europe/Bucharest"/>
        <value label="(GMT+02:00) Damas" name="Asia_Damascus" value="Asia/Damascus"/>
        <value label="(GMT+02:00) Harare, Pretoria" name="Africa_Harare" value="Africa/Harare"/>
        <value label="(GMT+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius" name="Europe_Helsinki" value="Europe/Helsinki"/>
        <value label="(GMT+02:00) Jerusalem" name="Asia_Jerusalem" value="Asia/Jerusalem"/>
        <value label="(GMT+02:00) Cairo" name="Africa_Cairo" value="Africa/Cairo"/>
        <value label="(GMT+02:00) Windhoek" name="Africa_Windhoek" value="Africa/Windhoek"/>
        <value label="(GMT+02:00) Greenwich Mean Time plus 2 hours" name="Gmt_p2" value="Etc/GMT-2"/>
        <value label="(GMT+03:00) Bagdad" name="Asia_Baghdad" value="Asia/Baghdad"/>
        <value label="(GMT+03:00) Kowet, Riyad" name="Asia_Riyadh" value="Asia/Riyadh"/>
        <value label="(GMT+03:00) Moscow, St. Petersburg, Volgograd" name="Europe_Moscow" value="Europe/Moscow"/>
        <value label="(GMT+03:00) Nairobi" name="Africa_Nairobi" value="Africa/Nairobi"/>
        <value label="(GMT+03:00) Greenwich Mean Time plus 3 hours" name="Gmt_p3" value="Etc/GMT-3"/>
        <value label="(GMT+03:30) Teheran" name="Asia_Tehran" value="Asia/Tehran"/>
        <value label="(GMT+04:00) Abu Dhabi, Muscat" name="Asia_Muscat" value="Asia/Muscat"/>
        <value label="(GMT+04:00) Baku" name="Asia_Baku" value="Asia/Baku"/>
        <value label="(GMT+04:00) Caucasus, Erevan" name="Asia_Yerevan" value="Asia/Yerevan"/>
        <value label="(GMT+04:00) Port Louis" name="Indian_Mauritius" value="Indian/Mauritius"/>
        <value label="(GMT+04:00) Tbilissi" name="Asia_Tbilisi" value="Asia/Tbilisi"/>
        <value label="(GMT+04:00) Greenwich Mean Time plus 4 hours" name="Gmt_p4" value="Etc/GMT-4"/>
        <value label="(GMT+04:30) Kabul" name="Asia_Kabul" value="Asia/Kabul"/>
        <value label="(GMT+05:00) Iekaterinburg" name="Asia_Yekaterinburg" value="Asia/Yekaterinburg"/>
        <value label="(GMT+05:00) Islamabad, Karachi, Tachkent" name="Asia_Karachi" value="Asia/Karachi"/>
        <value label="(GMT+05:00) Greenwich Mean Time plus 5 hours" name="Gmt_p5" value="Etc/GMT-5"/>
        <value label="(GMT+05:30) Calcutta, Chennai, Mumbai,New Delhi" name="Asia_Calcutta" value="Asia/Calcutta"/>
        <value label="(GMT+05:30) Sri Jayawardenepura" name="Asia_Colombo" value="Asia/Colombo"/>
        <value label="(GMT+05:45) Katmandu" name="Asia_Katmandu" value="Asia/Katmandu"/>
        <value label="(GMT+06:00) Astana, Dhaka" name="Asia_Dhaka" value="Asia/Dhaka"/>
        <value label="(GMT+06:00) Novossibirsk" name="Asia_Novosibirsk" value="Asia/Novosibirsk"/>
        <value label="(GMT+06:00) Greenwich Mean Time plus 6 hours" name="Gmt_p6" value="Etc/GMT-6"/>
        <value label="(GMT+06:30) Rangoon" name="Asia_Rangoon" value="Asia/Rangoon"/>
        <value label="(GMT+07:00) Bangkok, Hanoi, Djakarta" name="Asia_Bangkok" value="Asia/Bangkok"/>
        <value label="(GMT+07:00) Krasnoarsk" name="Asia_Krasnoyarsk" value="Asia/Krasnoyarsk"/>
        <value label="(GMT+07:00) Greenwich Mean Time plus 7 hours" name="Gmt_p7" value="Etc/GMT-7"/>
        <value label="(GMT+08:00) Irkoutsk" name="Asia_Irkutsk" value="Asia/Irkutsk"/>
        <value label="(GMT+08:00) Kuala Lumpur, Singapore" name="Asia_Kuala_Lumpur" value="Asia/Kuala_Lumpur"/>
        <value label="(GMT+08:00) Oulan-Bator" name="Asia_Ulan_Bator" value="Asia/Ulan_Bator"/>
        <value label="(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi" name="Asia_Shanghai" value="Asia/Shanghai"/>
        <value label="(GMT+08:00) Perth" name="Australia_Perth" value="Australia/Perth"/>
        <value label="(GMT+08:00) Taipei" name="Asia_Taipei" value="Asia/Taipei"/>
        <value label="(GMT+08:00) Greenwich Mean Time plus 8 hours" name="Gmt_p8" value="Etc/GMT-8"/>
        <value label="(GMT+09:00) Osaka, Sapporo, Tokyo" name="Asia_Tokyo" value="Asia/Tokyo"/>
        <value label="(GMT+09:00) Seoul" name="Asia_Seoul" value="Asia/Seoul"/>
        <value label="(GMT+09:00) Yakoutsk" name="Asia_Yakutsk" value="Asia/Yakutsk"/>
        <value label="(GMT+09:00) Greenwich Mean Time plus 9 hours" name="Gmt_p9" value="Etc/GMT-9"/>
        <value label="(GMT+09:30) Adelade" name="Australia_Adelaide" value="Australia/Adelaide"/>
        <value label="(GMT+09:30) Darwin" name="Australia_Darwin" value="Australia/Darwin"/>
        <value label="(GMT+10:00) Brisbane" name="Australia_Brisbane" value="Australia/Brisbane"/>
        <value label="(GMT+10:00) Canberra, Melbourne, Sydney" name="Australia_Canberra" value="Australia/Canberra"/>
        <value label="(GMT+10:00) Guam, Port Moresby" name="Pacific_Guam" value="Pacific/Guam"/>
        <value label="(GMT+10:00) Hobart" name="Australia_Hobart" value="Australia/Hobart"/>
        <value label="(GMT+10:00) Vladivostok" name="Asia_Vladivostok" value="Asia/Vladivostok"/>
        <value label="(GMT+10:00) Greenwich Mean Time plus 10 hours" name="Gmt_p10" value="Etc/GMT-10"/>
        <value label="(GMT+11:00) Magadan, The Solomon Islands, New Caledonia" name="Pacific_Guadalcanal" value="Pacific/Guadalcanal"/>
        <value label="(GMT+11:00) Greenwich Mean Time plus 11 hours" name="Gmt_p11" value="Etc/GMT-11"/>
        <value label="(GMT+12:00) Auckland, Wellington" name="Pacific_Auckland" value="Pacific/Auckland"/>
        <value label="(GMT+12:00) Fidji" name="Pacific_Fiji" value="Pacific/Fiji"/>
        <value label="(GMT+12:00) Greenwich Mean Time plus 12 hours" name="Gmt_p12" value="Etc/GMT-12"/>
        <value label="(GMT+13:00) Nuku'alofa" name="Pacific_Tongatapu" value="Pacific/Tongatapu"/>
        <value label="(GMT+13:00) Greenwich Mean Time plus 13 hours" name="Gmt_p13" value="Etc/GMT-13"/>
      </enumeration>
      <element dataPolicy="identifier" default="DefaultNameSpace()" label="Namespace" length="16" name="namespace" required="true" type="string"/>
      <element name="nsName">
        <key name="nsName">
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute name="namespace" template="xtk:common:namespace"/>
        <attribute dataPolicy="identifier" default="NewName()" edit="NamePkEdit" label="Name" length="80" name="name" required="true" type="string"/>
      </element>
      <element name="nsResName">
        <key name="nsName">
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute name="namespace" template="xtk:common:namespace"/>
        <attribute dataPolicy="resIdentifier" default="NewName()" edit="NamePkEdit" label="Name" length="80" name="name" required="true" type="string"/>
      </element>
      <element dataPolicy="identifier" default="NewName()" label="Internal name" length="64" name="name" required="true" type="string"/>
      <element default="NewLabel()" label="Label" length="128" localizable="true" name="label" required="true" type="string"/>
      <element edit="memo" label="Help" name="help" type="CDATA"/>
      <element edit="memo" label="Description" length="512" localizable="true" name="desc" sqlname="sDesc" type="CDATA"/>
      <element label="Comment" localizable="true" name="comment" type="memo" xml="true"/>
      <element label="Color" name="color" type="string"></element>
      <element edit="passwordedit" img="xtk:passwd.png" label="Password" name="password" type="string"/>
      <element advanced="true" desc="Deleted item" enum="xtk:common:deleteStatus" label="Deleted" name="deleteStatus" type="byte"/>
      <element advanced="true" desc="Date of the record deletion" label="Delete date" name="deleteDate" type="datetime"/>
      <element defOnDuplicate="true" default="CurrentUser()" label="Created by" name="createdBy" revIntegrity="define" target="xtk:operator" type="link"/>
      <element defOnDuplicate="true" default="CurrentUser()" label="Modified by" name="modifiedBy" revIntegrity="define" target="xtk:operator" type="link"/>
      <element name="variant">
        <attribute enum="xtk:common:dataType" label="Data type" name="dataType" type="byte"/>
        <attribute desc="Value for text data" label="Value (text)" length="255" name="stringValue" type="string"/>
        <attribute default="0" desc="Value for integer data" label="Value (integer)" name="longValue" type="long"/>
        <attribute default="0" desc="Value for float data" label="Value (float)" name="doubleValue" type="double"/>
        <attribute desc="Value for date data" label="Value (date)" name="timeStampValue" type="datetime"/>
        <element desc="Value for memo data" label="Value (long text)" name="memoValue" type="memo"/>
      </element>
      <element name="auditTrail">
        <element defOnDuplicate="true" name="createdBy" template="xtk:common:createdBy"/>
        <element defOnDuplicate="true" name="modifiedBy" template="xtk:common:modifiedBy"/>
        <attribute defOnDuplicate="true" default="GetDate()" desc="Creation date" label="Creation date" name="created" type="datetime"/>
        <attribute defOnDuplicate="true" default="GetDate()" desc="Modification date" label="Last modified" name="lastModified" pkgStatus="always" type="datetime"/>
      </element>
      <element label="MD5 key" length="32" name="md5" type="string"/>
      <element enum="xtk:common:dataPolicy" label="Constraint(s)" name="dataPolicy" type="string"/>
      <element desc="Character encoding" enum="xtk:common:codepage" label="Encoding" name="codepage" type="long"/>
      <element dataPolicy="email" desc="Email address" label="Email" length="128" name="email" type="string"/>
      <element dataPolicy="phone" desc="Mobile phone number" label="Mobile" length="32" name="mobilePhone" type="string"/>
      <element enum="xtk:common:timezone" label="Time zone" length="64" name="timezone" type="string"/>
      <element name="fileToUpload">
        <element desc="File name" label="Name" name="name" required="true" type="string" xml="true"/>
        <attribute default="true" desc="Upload file on the server" label="Upload file" name="upload" type="boolean" xml="true"/>
        <attribute advanced="true" desc="MD5 key of the content of the file" name="md5" template="xtk:common:md5"></attribute>
      </element>
      <element name="schemaBase">
        <element advanced="true" integrity="neutral" label="Current operator" name="currentOperator" revLink="_NONE_" target="xtk:operator" type="link">
          <join xpath-dst="@id" xpath-src="$(loginId)"/>
        </element>
        <element integrity="neutral" label="Delivery being analyzed" name="currentDelivery" revLink="_NONE_" target="nms:delivery" type="link" visibleIf="NodeValue('/ignored/@currentDeliveryId')!=''">
          <join xpath-dst="@id" xpath-src="$long(@currentDeliveryId)"/>
        </element>
        <element applicableIf="HasPackage('nms:interaction')" integrity="neutral" label="Offer being processed" name="currentOffer" revLink="_NONE_" target="nms:offer" type="link" visibleIf="NodeValue('/ignored/@currentOfferId')!=''">
          <join xpath-dst="@id" xpath-src="$long(@currentOfferId)"/>
        </element>
        <element applicableIf="HasPackage('nms:centralLocal') and (@namespace!='nms' or @name!='delivery')" integrity="neutral" label="Current order" name="currentOrder" revLink="_NONE_" target="nms:localOrder" type="link" visibleIf="NodeValue('/ignored/@currentOrderId')!=''">
          <join xpath-dst="@id" xpath-src="$long(@currentOrderId)"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Temporary storage of the conflicting entities." entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Conflicts" labelSingular="Conflict" name="conflict" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="conflict" pkgStatus="never" sqltable="XtkConflict">
        <key allowEmptyPart="true" name="name">
          <keyfield xpath="@entitySchema"/>
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@name + ' (' + @namespace + ')'"/>
        <attribute label="Namespace" length="16" name="namespace" required="true" type="string"/>
        <attribute label="Name" length="80" name="name" required="true" type="string"/>
        <attribute label="Schema" length="80" name="entitySchema" type="string"/>
        <attribute label="Entity image" length="80" name="img" type="string"/>
        <element label="Entity content" name="xml" type="ANY" xml="true"/>
        <element label="Last version" name="new" type="ANY" xml="true"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
      </element>
      <methods>
        <method name="SetResolved" static="true">
          <parameters>
            <param desc="Conflict identifier." inout="in" name="conflictId" type="string"/>
          </parameters>
        </method>
        <method name="AcceptNew" static="true">
          <parameters>
            <param desc="Conflict identifier." inout="in" name="conflictId" type="string"/>
          </parameters>
        </method>
        <method name="AcceptCus" static="true">
          <parameters>
            <param desc="Conflict identifier." inout="in" name="conflictId" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:servermodel.png" label="Connections" labelSingular="Connection" mappingType="xmlFile" name="connections" namespace="xtk" xtkschema="xtk:srcSchema">
      <element img="xtk:server.png" label="Connection" name="cnx" unbound="true">
        <compute-string expr="@label"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute default="'http://localhost:8080'" label="URL" name="url" required="true" type="string"/>
        <attribute default="false" label="Connect with an Adobe ID" name="ims" required="true" type="boolean"/>
        <element name="comment" template="xtk:common:comment"/>
      </element>
      <element img="xtk:folder.png" label="Folder" name="folder" unbound="true">
        <compute-string expr="@label"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="comment" template="xtk:common:comment"/>
        <element label="Sub-folder" name="folder" ref="folder" unbound="true"/>
        <element label="Connection" name="cnx" ref="cnx" unbound="true"/>
      </element>
      <element img="xtk:servermodel.png" label="Connections" name="connections" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element label="Folder" name="folder" ref="folder" unbound="true"/>
        <element label="Connection" name="cnx" ref="cnx" unbound="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Counters used to generate default values" entitySchema="xtk:srcSchema" img="xtk:counter.png" implements="xtk:persist" label="Counters" labelSingular="Counter" name="counter" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" img="xtk:counter.png" name="counter" pkgPlatform="@id != 0">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute name="name" template="xtk:common:name"/>
        <attribute label="Label" length="80" name="label" required="true" type="string"/>
        <attribute defOnDuplicate="true" desc="Counter value" label="Value" name="value" type="long"/>
        <element name="comment" template="xtk:common:comment"/>
      </element>
      <methods>
        <method name="IncreaseValue" static="true">
          <parameters>
            <param desc="Counter name" label="Name" name="name" type="string"/>
            <param desc="New value of counter" inout="out" label="Value" name="value" type="long"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Definition of the application dashboards" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:dashboard.png" implements="xtk:persist" label="Dashboards" labelSingular="Dashboard" name="dashboard" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="none" name="urlPageType">
        <value label="None" name="none"/>
        <value label="Web application" name="webApp"/>
        <value label="Report" name="report"/>
        <value label="URL" name="url"/>
        <value label="Ajax" name="ajax"/>
      </enumeration>
      <enumeration basetype="string" default="one" name="colspan">
        <value label="One column" name="one"/>
        <value label="Two columns" name="all"/>
      </enumeration>
      <element name="titleImg">
        <attribute label="Display title" name="displayTitle" type="boolean"/>
        <attribute label="Title" localizable="true" name="title" type="string"/>
        <attribute label="Display a separation" name="useTitleSep" type="boolean"/>
        <element name="leftImg" ref="xtk:navtree:command"/>
      </element>
      <element label="Definition of a view" name="bloc">
        <element aggregate="xtk:dashboard:titleImg"/>
        <element label="Header" localizable="true" name="header" type="html"/>
        <element label="Page footer" localizable="true" name="footer" type="html"/>
        <attribute label="Display the refresh button" name="refresh" type="boolean"/>
        <element label="URL" name="actionLink" ordered="true" ref="xtk:navtree:command" unbound="true"/>
        <element label="URL" name="urlLink" ordered="true" ref="xtk:navtree:command" unbound="true"/>
        <attribute enum="colspan" label="Space used" name="colspan" type="string"/>
        <element name="urlPage">
          <attribute enum="urlPageType" label="Type" name="type" type="string"/>
          <element label="Web page" name="webApp" revLink="_NONE_" target="nms:webApp" type="link" xml="true">
            <join xpath-dst="@id" xpath-src="@webApp-id"/>
          </element>
          <attribute advanced="true" label="Foreign key of the 'Web page' link ('id' field)" name="webApp-id" type="long"/>
          <attribute label="Compute-string of the 'webApp' link" localizable="true" name="webApp-cs" type="string"/>
          <attribute advanced="true" desc="Update the web page when the referenced schema is altered" label="Web page schema" name="webAppSchema" type="string"/>
          <element label="Report" name="report" revLink="_NONE_" target="xtk:report" type="link" xml="true">
            <join xpath-dst="@id" xpath-src="@report-id"/>
          </element>
          <attribute advanced="true" label="Foreign key of the 'Report' link (''id' field)" name="report-id" type="long"/>
          <attribute label="Compute-string of the 'report' link" localizable="true" name="report-cs" type="string"/>
          <attribute label="Link parameters" name="urlParam" type="string"/>
          <attribute label="URL" name="url" type="string"/>
          <attribute label="Height (pixel)" name="height" type="short"/>
          <attribute label="Width (pixel)" name="width" type="short"/>
          <element label="Additional script" name="script">
            <element label="Additional script" name="script" revLink="_NONE_" target="xtk:javascript" type="link"/>
          </element>
          <element desc="Options of the asynchronous call to be made." label="Parameters" name="ajaxParameters" type="memo" xml="true"/>
          <element aggregate="xtk:dashboard:titleImg"/>
        </element>
      </element>
      <element autopk="true" folderLink="folder" folderModel="xtkDashboard" fullLoad="true" img="xtk:dashboard.png" label="Dashboard" name="dashboard" pkgPlatform="@id != 0">
        <compute-string expr="@label+' ('+@name+')'"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'DSH'+CounterValue('xtkDashboard')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="desc" template="xtk:common:desc"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute label="Default dashboard" name="default" type="boolean"/>
        <attribute defOnDuplicate="true" label="Factory-configured dashboard" name="builtIn" type="boolean"/>
        <element label="Menu parameters" name="menu" xml="true">
          <attribute default="'home'" desc="Internal name of the menu to display" label="Menu name" name="name" type="string"/>
          <attribute desc="List of order names (separated by a comma) not to be shown" label="List of hidden menus" name="hiddenMenus" type="string"/>
          <attribute desc="Internal name of the new menu (empty by default)" label="New menu" name="newMenu" type="string"/>
        </element>
        <element label="View" name="view" ordered="true" unbound="true" xml="true">
          <key>
            <keyfield xpath="@name"/>
          </key>
          <attribute default="GetOption('XtkInstancePrefix')+'VIEW'+CounterValue('xtkView')" name="name" template="xtk:common:name"/>
          <attribute name="label" template="xtk:common:label"/>
          <attribute desc="List of rights required to display the view" label="Rights" name="rights" type="string"/>
          <attribute enum="colspan" label="Space used" name="colspan" type="string"/>
          <attribute desc="Height of the view (pixel)" label="Height (pixel)" name="height" type="short"/>
          <attribute label="Do not display background image" name="hideBackground" type="boolean"/>
          <element label="Left-hand block" name="left" ref="bloc"/>
          <element label="Right-hand block" name="right" ref="bloc"/>
        </element>
        <element defOnDuplicate="true" default="DefaultFolder('xtkDashboard', [@_folder-id])" label="Dashboard folder" name="folder" required="true" revDesc="Dashboards in this folder" revIntegrity="define" revLabel="Dashboards" target="xtk:folder" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Data transfer scripts (import/export)" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Data transfer scripts" labelSingular="Data transfer script" name="dataTransfer" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="simple" name="importType">
        <value desc="Simple import" img="xtk:dataTransfer/simple.png" label="Simple import" name="simple"/>
        <value desc="Multiple import" img="xtk:dataTransfer/batch.png" label="Multiple import" name="batch"/>
      </enumeration>
      <enumeration basetype="string" default="simple" name="exportType">
        <value desc="Simple export" img="xtk:dataTransfer/simple.png" label="Simple export" name="simple"/>
        <value desc="Export batch" img="xtk:dataTransfer/batch.png" label="Multiple export" name="batch"/>
      </enumeration>
      <enumeration basetype="string" name="dataType">
        <value desc="Transfer of text file" label="Text file" name="text"/>
        <value desc="Transferring schema of entity" label="Schema" name="xtkDataStore"/>
        <value desc="Transfer of a data source" label="Data source" name="dataSource"/>
        <value desc="Transfer of XML document" label="XML document" name="xml"/>
      </enumeration>
      <enumeration basetype="string" name="connectorType">
        <value label="Database connector" name="writer"/>
        <value label="Text connector" name="textConnector"/>
        <value label="Request connector" name="query"/>
      </enumeration>
      <enumeration basetype="string" default="warning" label="Reject type for an entity path" name="rejectType">
        <value desc="Warn and empty field" label="Ignore and log a warning" name="warning"/>
        <value desc="Propagate the error to the parent level" label="Reject parent element" name="parentElement"/>
        <value desc="An error in this element triggers the rejection of the complete line in the file." label="Reject all elements" name="entity"/>
      </enumeration>
      <enumeration basetype="string" default="none" label="Log after an entity has been updated" name="updateLog">
        <value desc="Do nothing when entity does not exist" label="Do nothing" name="none"/>
        <value desc="Generate an error if the entity does not exist" label="Reject entity" name="error"/>
      </enumeration>
      <enumeration basetype="string" default="update" label="Duplicate" name="duplicate">
        <value desc="Update element if it already exists in the database." label="Update" name="update"/>
        <value desc="Generates an error if the element already exists in the database." label="Reject entity" name="reject"/>
        <value desc="Does not process element if it already exists in the database and does not generate an error." label="Ignore" name="ignore"/>
        <value desc="For a recipient multiple import the update mode depends on the origin associated with this file." label="Update or insert depending on origin" name="choose"/>
      </enumeration>
      <enumeration basetype="string" default="update" label="Double" name="double">
        <value desc="Do not check for doubles in the file(s)" label="Update" name="update"/>
        <value desc="Generate an error if the element was already present in the source files" label="Reject entity" name="reject"/>
        <value desc="Ignore element if it was already present in the source file(s)" label="Ignore" name="ignore"/>
      </enumeration>
      <enumeration basetype="string" default="warning" label="Reject type for a text column" name="rejectCol">
        <value desc="Warn and ignore column" label="Warning" name="warning"/>
        <value desc="Reject line" label="Line" name="line"/>
      </enumeration>
      <enumeration basetype="string" label="Log reject type" name="rejectLogType">
        <value desc="No reject (displayed in trace mode)" img="xtk:loginfo.png" label="Trace" name="trace"/>
        <value desc="Reject upon warning" img="xtk:logwarn.png" label="Warning" name="warning"/>
        <value desc="Reject upon error" img="xtk:logerr.png" label="Error" name="error"/>
        <value desc="Reject upon double" img="xtk:logerr.png" label="Double" name="double"/>
        <value desc="Reject upon duplicate" img="xtk:logerr.png" label="Duplicate" name="duplicate"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="transformation">
        <value label="None" name="none"/>
        <value label="Switch to lower case" name="toLowerCase"/>
        <value label="Switch to upper case" name="toUpperCase"/>
        <value label="First letter in upper case" name="toSmartCase"/>
      </enumeration>
      <enumeration basetype="string" default="left" name="align">
        <value label="Left" name="left"/>
        <value label="Right" name="right"/>
        <value label="Centered" name="center"/>
      </enumeration>
      <enumeration basetype="string" default="string" label="Column type" name="columnType">
        <value desc="Limited size text." label="string" name="string"/>
        <value desc="Integer (32 bits)." label="integer (8 bits)" name="byte"/>
        <value desc="Integer (16 bits)." label="integer (16 bits)" name="short"/>
        <value desc="Integer (32 bits)" label="integer (32 bits)" name="long"/>
        <value desc="Integer (64 bits)." label="integer (64 bits)" name="int64"/>
        <value desc="Floating point number." label="floating number" name="float"/>
        <value desc="Double precision floating point number." label="floating number (double precision)" name="double"/>
        <value desc="Date." label="date" name="date"/>
        <value desc="Hour." label="time" name="time"/>
        <value desc="Date + time." label="date + time" name="datetime"/>
        <value desc="Duration." label="period" name="timespan"/>
        <value desc="Long text." label="long text" name="memo"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="textQualifier">
        <value label="No delimiter" name="none" value="none"/>
        <value label="Double quote" name="doubleQuotes" value="doubleQuotes"/>
        <value label="Single quote" name="quotes" value="quotes"/>
      </enumeration>
      <enumeration basetype="string" name="dateFormat">
        <value label="yyyy/mm/dd" name="ymd"/>
        <value label="mm/dd/yyyy" name="mdy"/>
        <value label="dd/mm/yyyy" name="dmy"/>
        <value label="mm/yyyy/dd" name="myd"/>
        <value label="dd/yyyy/mm" name="dym"/>
        <value label="yyyy/dd/mm" name="ydm"/>
        <value label="yyyymmdd" name="ymdnosep"/>
        <value enabledIf="'$(entityPath)'='/dataTransfer'" label="dd.yyyy.mm" name="dym_de"/>
        <value enabledIf="'$(entityPath)'='/dataTransfer'" label="yyyy.mm.dd" name="ymd_de"/>
        <value label="XML (ex: aaaa-mm-jjThh:mm:ss.sssZ)" name="ymdsoap"/>
      </enumeration>
      <enumeration basetype="string" name="dateTimeFormat">
        <value label="yyyy/mm/dd hh:mm:ss" name="ymdhis"/>
        <value label="mm/dd/yyyy hh:mm:ss" name="mdyhis"/>
        <value label="dd/mm/yyyy hh:mm:ss" name="dmyhis"/>
        <value label="mm/yyyy/dd hh:mm:ss" name="mydhis"/>
        <value label="dd/yyyy/mm hh:mm:ss" name="dymhis"/>
        <value label="yyyy/dd/mm hh:mm:ss" name="ydmhis"/>
        <value label="dd.mm.yyyy hh:mm:ss" name="dmyhis_de"/>
        <value label="yyyy.mm.dd hh:mm:ss" name="ymdhis_de"/>
      </enumeration>
      <enumeration basetype="string" name="dateFormatExport">
        <value label="yyyy/mm/dd" name="ymd"/>
        <value label="mm/dd/yyyy" name="mdy"/>
        <value label="dd/mm/yyyy" name="dmy"/>
        <value label="mm/yyyy/dd" name="myd"/>
        <value label="dd/yyyy/mm" name="dym"/>
        <value label="yyyy/dd/mm" name="ydm"/>
      </enumeration>
      <enumeration basetype="string" name="timeFormat">
        <value label="13:30" name="hhmm"/>
        <value label="13:30:55" name="hhmmss"/>
      </enumeration>
      <enumeration basetype="string" name="intFormat">
        <value label="Other" name="other"/>
        <value label="1,000" name="sepComma"/>
        <value label="1 000" name="sepSpace"/>
      </enumeration>
      <enumeration basetype="string" default="sepPoint" name="numberFormat">
        <value label="Other" name="other"/>
        <value label="1,000.00" name="sepPoint"/>
        <value label="1 000,00" name="sepComma"/>
      </enumeration>
      <enumeration basetype="short" name="decimalCount">
        <value label="All" name="all" value="-1"/>
        <value name="0"/>
        <value name="1"/>
        <value name="2"/>
        <value name="3"/>
        <value name="4"/>
        <value name="5"/>
        <value name="6"/>
        <value name="7"/>
        <value name="8"/>
        <value name="9"/>
      </enumeration>
      <enumeration basetype="string" default="sepTab" name="separator">
        <value label="Tabulation" name="sepTab"/>
        <value label="Semicolon" name="sepPointComma"/>
        <value label="Comma" name="sepComma"/>
        <value label="Other" name="other"/>
      </enumeration>
      <enumeration basetype="string" default="delNone" name="delimitor">
        <value label="No delimiter" name="delNone"/>
        <value label="Double quote" name="delDoubleQuote"/>
        <value label="Single quote" name="delSimpleQuote"/>
      </enumeration>
      <enumeration basetype="string" default="duplicateDel" name="delimitorEscaping">
        <value desc="Double delimiter if it is already contained in a string (Excel behavior)." label="Double delimiter" name="duplicateDel"/>
        <value desc="Add a backslash prefix to the delimiter if it is found in a string." label="Add a back-slash prefix" name="backslash"/>
      </enumeration>
      <enumeration basetype="string" default="text" name="textFormat">
        <value img="xtk:text.png" label="Text" name="text"/>
        <value img="xtk:text.png" label="Text using fixed width columns" name="fixed"/>
        <value img="xtk:csv.png" label="CSV (Excel)" name="csv"/>
        <value img="xtk:xml.png" label="XML" name="xml"/>
      </enumeration>
      <enumeration basetype="string" default="constant" name="calcFieldType">
        <value img="xtk:xtkmemofield.png" label="Fixed string" name="constant"/>
        <value img="xtk:jst.png" label="String with JavaScript tags" name="jst"/>
        <value img="xtk:javascript.png" label="JavaScript expression" name="javascript"/>
        <value img="xtk:enum.png" label="Enumerations" name="enumeration"/>
      </enumeration>
      <enumeration basetype="byte" default="delimiter" name="colType">
        <value img="xtk:text.png" label="Delimited columns" name="delimiter" value="0"/>
        <value img="xtk:text.png" label="Fixed width columns" name="fixed" value="1"/>
        <value img="xtk:xml.png" label="XML format" name="xml" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="returnCarriage" name="lineEnd">
        <value label="Carriage return" name="returnCarriage" value="0"/>
        <value label="CR/LF" name="CR_LF" value="1"/>
        <value label="None" name="none" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="update" label="Reject type for an entity path" name="defaultEnum">
        <value label="Keep the source value" name="update"/>
        <value label="Use the following value:" name="value"/>
        <value label="Generates a warning" name="warning"/>
        <value label="Generate an error" name="error"/>
      </enumeration>
      <enumeration basetype="boolean" name="rowConditionType">
        <value label="Limit the line count" name="multiple" value="0"/>
        <value label="Single row (expert user)" name="singleRow" value="1"/>
      </enumeration>
      <element label="Configuration" name="dataSourceConfig">
        <attribute name="codepage" template="xtk:common:codepage"/>
        <attribute name="timezone" template="xtk:common:timezone"/>
        <attribute desc="Number of lines to ignore at the beginning of file." label="Lines to ignore" name="ignoredLines" type="long"/>
        <attribute desc="Defines if the first line contains the column titles. In such a case, the column title is automatically filled using this line." label="Use first line as column header" name="firstLineIsTitle" type="boolean"/>
        <attribute desc="Some records spawn multiple lines in the source file." label="Records span multiple lines" name="multiline" type="boolean"/>
        <attribute desc="If there are consecutive delimiters, it is possible to consider them as only one column by activating this option." label="Consider consecutive delimiters as one" name="consecutiveDelimiters" type="boolean"/>
        <attribute desc="The tab is a column delimiter." label="Tabulation" name="tabIsSep" type="boolean"/>
        <attribute desc="The space is a column delimiter." label="Space" name="spaceIsSep" type="boolean"/>
        <attribute desc="The semi-column is a column delimiter." label="Semicolon" name="semiColumnIsSep" type="boolean"/>
        <attribute desc="The comma is a column delimiter." label="Comma" name="commaIsSep" type="boolean"/>
        <attribute desc="Other column delimiter." label="Other" name="otherSep" type="string"/>
        <attribute desc="Defines the character to use as string delimiter. It is highly recommended to always define a string delimiter in order to avoid an error if a column contains itself the column delimiter." enum="xtk:dataTransfer:textQualifier" label="String delimiter" name="textQualifier" type="string"/>
        <attribute enum="colType" label="File type" name="colType" type="byte"/>
        <attribute desc="Characters to ignore" label="Characters to ignore" name="ignoredChar" type="long"/>
        <attribute default="false" desc="End of line using CR" label="CR" name="useCR" type="boolean"/>
        <attribute default="false" desc="End of line using LF" label="LF" name="useLF" type="boolean"/>
        <attribute advanced="true" default="false" desc="Do not perform the verification of the file format when executing the import" label="Do not perform the verification of the file format" name="ignoreConfigCheck" type="boolean"/>
        <element name="dataSourceColumn" ordered="true" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute name="name" template="xtk:common:name"/>
          <attribute name="label" template="xtk:common:label"/>
          <attribute desc="Type of data contained in column." enum="xtk:dataTransfer:columnType" label="Data type" name="type" type="string"/>
          <attribute desc="Date format" enum="xtk:dataTransfer:dateFormat" label="Format" name="dateFormat" type="string"/>
          <attribute default="'/'" label="Year, month and day separator" name="dateSep" type="string"/>
          <attribute default="' '" label="Date and time separator" name="dateTimeSep" type="string"/>
          <attribute advanced="true" desc="Date and time format" enum="xtk:dataTransfer:dateTimeFormat" label="Format" name="dateTimeFormat" type="string"/>
          <attribute desc="Hour format" enum="xtk:dataTransfer:timeFormat" label="Format" name="timeFormat" type="string"/>
          <attribute default="':'" label="Hour, minute and second separator" name="timeSep" type="string"/>
          <attribute desc="Number format" enum="xtk:dataTransfer:numberFormat" label="Format" name="numFormat" type="string"/>
          <attribute advanced="true" desc="Integer format" enum="xtk:dataTransfer:intFormat" label="Format" name="intFormat" type="string"/>
          <attribute default="','" label="Decimal symbol" name="decimalSep" type="string"/>
          <attribute default="' '" label="Grouping separator" name="thousandSep" type="string"/>
          <attribute desc="Ignore this column so that it does not appear in the mapping." label="Ignore column" name="ignore" type="boolean"/>
          <attribute enum="xtk:dataTransfer:rejectCol" label="Column reject type" name="rejectCol" type="string"/>
          <attribute desc="Column width" label="Width" name="width" type="short"/>
          <attribute desc="SQL name of the new target column" label="SQL field" name="sqlname" type="string"/>
        </element>
        <element name="sampleLines" type="ANY">
          <attribute advanced="true" desc="Codepage used when reading sample lines" name="codepage" type="long"/>
          <element name="line" type="string" unbound="true"/>
        </element>
      </element>
      <element label="Enumerations" name="calculatedEnumeration">
        <key internal="true" name="enumerationId">
          <keyfield xpath="@id"/>
        </key>
        <attribute default="Gid()" label="Primary key" name="id" type="string" xml="true"/>
        <attribute label="Source" name="source" type="string"/>
        <attribute label="Destination" name="destination" type="string"/>
      </element>
      <element name="calculatedFieldTemplate">
        <attribute name="label" template="xtk:common:label"/>
        <attribute name="name" template="xtk:common:name"/>
        <attribute enum="calcFieldType" label="Type" name="calcFieldType" type="string"/>
        <element label="Field calculation script" name="srcScript" type="string"/>
        <attribute desc="Reference path for enumerations" label="Source column" name="refPath" type="string"/>
        <attribute enum="defaultEnum" label="For the other cases:" name="defaultType" type="string"/>
        <attribute label="Default value" name="defaultValue" type="string"/>
        <element label="Enumerations" name="enumeration" ref="calculatedEnumeration" unbound="true"/>
      </element>
      <element name="calculatedFields">
        <element name="calculatedField" template="calculatedFieldTemplate" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
        </element>
      </element>
      <element name="mappingConfig">
        <element name="mapping" unbound="true">
          <key name="src">
            <keyfield xpath="@src"/>
          </key>
          <attribute label="Source" name="src" type="string"/>
          <attribute label="Destination path" name="dest" type="string"/>
          <attribute enum="transformation" label="Transformation" name="transformation" type="string"/>
        </element>
      </element>
      <element name="reconciliation">
        <element name="nodeInfo" unbound="true">
          <key name="xpath">
            <keyfield xpath="@xpath"/>
          </key>
          <attribute label="Element path" name="xpath" type="string"/>
          <attribute default="'insertOrUpdate'" enum="xtk:srcSchema:operation" label="Operation" name="operation" type="string"/>
          <attribute enum="rejectType" label="Reject type" name="rejectType" type="string"/>
          <attribute label="Update if source value is empty" name="emptyValue" type="boolean"/>
          <attribute label="Update only if destination is empty" name="nullDestValue" type="boolean"/>
          <attribute label="Update the field only when the record is inserted" name="nullInsertOp" type="boolean"/>
          <attribute enum="duplicate" label="Management of duplicates" name="duplicate" type="string"/>
          <attribute enum="double" label="Management of doubles" name="double" type="string"/>
          <attribute enum="updateLog" label="When does not exist" name="updateLog" type="string"/>
          <element name="key" ref="xtk:srcSchema:key" unbound="true"/>
        </element>
      </element>
      <element name="exportColumns">
        <element name="exportColumn" ordered="true" template="calculatedFieldTemplate" unbound="true">
          <key name="srcPath">
            <keyfield xpath="@srcPath"/>
          </key>
          <key name="calcFieldName">
            <keyfield xpath="@name"/>
          </key>
          <attribute default="true" desc="Column present in the exported file." label="Activate" name="active" type="boolean"/>
          <attribute desc="Put column label in the first line of the exported file." name="label"/>
          <attribute desc="Path of the column if the document returned by the query." label="Source path" name="srcPath" type="string"></attribute>
          <attribute enum="transformation" label="Transformation" name="transformation" type="string"/>
          <attribute desc="Column reject type" enum="rejectCol" label="Reject type" name="rejectCol" type="string"/>
          <attribute desc="Column alignment" enum="align" label="Alignment" name="align" type="string"/>
          <attribute default="10" desc="Column width" label="Width" name="width" type="short"/>
        </element>
      </element>
      <element name="exportFormat">
        <attribute label="Line length" name="lineWidth" type="long"/>
        <attribute enum="lineEnd" label="End of line" name="lineEnd" type="byte"/>
        <attribute default="true" label="Use first line as column header" name="saveTitle" type="boolean"/>
        <attribute enum="separator" label="Column separator" name="separator" type="string"/>
        <attribute desc="Other column delimiter." label="Other" name="otherSep" type="string"/>
        <attribute enum="delimitor" label="String delimiter" name="delimitor" type="string"/>
        <attribute name="codepage" template="xtk:common:codepage"/>
        <attribute name="timezone" template="xtk:common:timezone"/>
        <attribute enum="textFormat" label="Output format" name="format" type="string"/>
        <attribute enum="delimitorEscaping" label="Escape string delimiters" name="delEscaping" type="string"/>
        <attribute default="false" desc="All columns are exported as text, including string delimiters." label="Export all as text" name="allAsString" type="boolean"/>
        <element label="Data format" name="dataFormat">
          <attribute default="'/'" label="Date separator" name="sepDate" type="string"/>
          <attribute default="':'" label="Hour separator" name="sepTime" type="string"/>
          <attribute default="' '" label="Date/hour separator" name="sepDateTime" type="string"/>
          <attribute default="'ymd'" enum="dateFormat" label="Date format" name="orderDate" type="string"/>
          <attribute default="false" label="Display year with two digits" name="yearShort" type="boolean"/>
          <attribute default="true" label="Display seconds" name="showSec" type="boolean"/>
          <attribute default="false" label="Display milliseconds" name="showMs" type="boolean"/>
          <attribute default="'.'" label="Decimal symbol" length="1" name="sepNumber" type="string"/>
          <attribute default="'-1'" enum="decimalCount" label="Number of decimal places" name="decimalCount" type="short"/>
          <attribute default="false" label="Separate thousands" name="sepThousand" type="boolean"/>
          <attribute default="false" label="Keep date portion only" name="hideTime" type="boolean"/>
        </element>
        <attribute default="false" desc="Export labels instead of internal values of enumerations" label="Export labels" name="analyze" type="boolean"/>
      </element>
      <element label="Source" name="source" template="xtk:common:fileToUpload">
        <attribute enum="dataType" label="Type of data to transfer" name="type" type="string"/>
        <attribute label="Source schema" name="schema" required="true" type="string"/>
        <attribute default="'/'" label="Initial path" name="startPath" type="string"/>
        <element label="Temporary execution schema" name="tempSchemas" type="ANY"/>
        <attribute label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute label="Returns data memo as a 'data' element" name="unExpandMemoData" type="boolean"/>
        <element desc="Filter condition" name="where" unbound="true">
          <element aggregate="xtk:queryDef:where" name="where"/>
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          <attribute label="Filter name" name="filterName" type="string"/>
          <element desc="Context of the condition" label="Context" name="ctx" type="ANY"/>
        </element>
        <element name="select" ref="xtk:queryDef:select"/>
        <element name="orderBy" ref="xtk:queryDef:orderBy"/>
        <element name="groupBy" ref="xtk:queryDef:groupBy"/>
        <element name="having" ref="xtk:queryDef:having"/>
        <element desc="Collection links filtering condition" name="conditionLink" ref="xtk:queryDef:conditionLink" unbound="true"/>
        <element label="Differential export parameters" name="differential">
          <attribute desc="Activate differential export" label="Activate" name="active" type="boolean"/>
          <attribute desc="Name of the option used to save the last execution date" label="Option name" name="option" type="string"/>
          <element desc="Field containing the last modification date" label="Modification date" name="lastModified" required="true" type="CDATA"/>
          <attribute advanced="true" label="Filtering start date for this execution." name="startDate" type="datetime"/>
          <attribute advanced="true" label="Filtering end date for this execution." name="endDate" type="datetime"/>
        </element>
        <attribute default="false" label="Export rejects from text connector" name="rejectsFromTextConnector" type="boolean"/>
        <element name="rejectExportSource">
          <element name="key">
            <attribute desc="Identifier of data transfer from which rejects are exported" label="Data transfer identifier" name="value" type="string"/>
          </element>
        </element>
        <attribute label="Number of lines to export" name="lineCount" type="long"/>
        <attribute advanced="true" default="200" label="Regrouping sizes" name="batchSize" type="long"/>
        <element name="dataSourceConfig" ref="dataSourceConfig"/>
        <element name="dataSourceConfigDest" ref="dataSourceConfig"/>
        <element name="calculatedFields" ref="calculatedFields"/>
        <element name="mappingConfig" ref="mappingConfig"/>
        <element name="mappingConfigDest" ref="mappingConfig"/>
        <element name="reconciliation" ref="reconciliation"/>
        <element name="sourceFilter">
          <attribute label="Enabled" name="enabled" type="boolean"/>
          <element label="Filter script" name="srcScript" type="string"/>
        </element>
        <attribute name="lastParsedDataSource" type="string"/>
        <attribute enum="textFormat" label="Input format" name="format" type="string"/>
      </element>
      <element label="Destination" name="destination">
        <attribute enum="dataType" label="Type of data to transfer" name="type" type="string"/>
        <attribute label="Destination schema" name="schema" required="true" type="string"/>
        <attribute default="'/'" label="Initial path" name="startPath" type="string"/>
        <attribute default="20" desc="Number of records before updating progress bar." label="Records per progression" name="progressLines" type="short"/>
        <attribute default="200" desc="Number of records to process by transaction" label="Records by transaction" name="transactionLines" type="short"/>
        <attribute default="0" desc="Allows to start (or resume) the transfer from a given line of the source file" label="Start at line" name="startRecord" type="long"/>
        <attribute default="0" desc="Allows to limit the number of lines of the transferred source file (0 means all file)" label="Stop at line" name="endRecord" type="long"/>
        <attribute desc="Output data source name (file name...)" label="Data source" name="dataSourceName" type="string"/>
        <attribute default="true" label="Download the file generated on the server after the export." name="downloadDestFile" type="boolean"/>
        <element name="exportFormat" ref="exportFormat"/>
        <element name="exportColumns" ref="exportColumns"/>
        <attribute desc="Output directory where exported files are stored in case of multi-file export." label="Output directory" name="outputDirectory" type="string"/>
        <attribute default="false" label="Separate the rejects based on the 'Origin' field" name="splitOverOrigin" type="boolean"/>
        <attribute default="true" desc="Insert empty values for the source columns that have not been mapped (required to ensure compatibility with original import script)." label="Insert empty values for the unmapped column." name="putUnmappedCols" type="boolean"/>
        <attribute advanced="true" desc="Do not write the result to a file." label="Results in the context" name="storeInCtx" type="boolean"/>
      </element>
      <element name="dataTransfer" pkgAdmin="@id != 0 AND @isModel = 1" template="xtk:job">
        <sysFilter inline="true">
          <condition expr="@xtkschema='xtk:dataTransfer'"/>
        </sysFilter>
        <compute-string expr="@label"/>
        <attribute name="id" sqlname="iJobId" type="long"/>
        <attribute default="GetOption('XtkInstancePrefix')+'DTR'+CounterValue('xtkDataTransfer')" name="internalName"/>
        <attribute enum="importType" label="Import type" name="importType" type="string" xml="true"/>
        <attribute enum="exportType" label="Export type" name="exportType" type="string" xml="true"/>
        <attribute default="true" desc="Cancels job transfer if there are too many rejected lines (>50%)" label="Stop execution if there are too many rejects" name="stopIfTooManyRejects" type="boolean" xml="true"/>
        <attribute default="false" desc="Mode allowing to generate a reject for every processed line" label="Trace mode" name="traceMode" type="boolean" xml="true"/>
        <attribute default="true" name="outOfProcess"/>
        <attribute label="Do not update enumerations" name="noUpdateEnum" type="boolean" xml="true"/>
        <attribute name="timezone" template="xtk:common:timezone"/>
        <element img="xtk:dataTransfer/simple.png" name="dataTransferStep" ordered="true" unbound="true" xml="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute label="Name" name="name" required="true" type="string"/>
          <attribute default="true" label="Active" name="active" type="boolean"/>
          <element name="source" ref="source"/>
          <element name="destination" ref="destination"/>
          <element name="sqlScript">
            <attribute desc="Execute SQL scripts before/after the import." label="Execute SQL scripts" name="active" type="boolean"/>
            <element desc="SQL script to execute before the import step." label="Pre-import SQL script" name="pre" type="CDATA"/>
            <element desc="SQL script to execute after the import step." label="Post-import SQL script" name="post" type="CDATA"/>
            <attribute label="SQL script from a file (by default from an entity)" name="preFile" type="boolean"/>
            <attribute desc="Identifier of the entity or name of the file containing the SQL code of the pre-processing to perform." label="Pre-processing script" name="preScriptId" type="string"/>
            <attribute label="SQL script from a file (by default from an entity)" name="postFile" type="boolean"/>
            <attribute desc="Identifier of the entity or name of the file containing the SQL code of the post processing to perform." label="Post-processing script" name="postScriptId" type="string"/>
          </element>
        </element>
        <element autopk="true" enumImage="@rejectLogType" integrity="neutral" label="Rejected records" name="reject" sql="true" sqltable="XtkReject" unbound="true" xml="false">
          <attribute name="dataTransfer-id" sqlname="iJobId" type="long"/>
          <attribute label="Transfer phase" length="80" name="dataTransferStep" type="string"/>
          <attribute enum="connectorType" label="Connector" length="64" name="connectorType" type="string"/>
          <attribute label="Origin" length="80" name="origin" type="string"/>
          <attribute label="Entity schema" length="80" name="schema" type="string"/>
          <attribute default="'/'" label="Initial path" length="80" name="startPath" type="string"/>
          <attribute label="Log date and time" name="logDate" type="datetime"/>
          <attribute enum="rejectLogType" label="Type" length="16" name="rejectLogType" type="string"/>
          <element label="Message" name="message" type="string"/>
          <element label="Source of entity" name="entity" type="ANY" xml="true"/>
          <element label="Log message" name="logReject" unbound="true" xml="true">
            <key>
              <keyfield xpath="@logDate"/>
            </key>
            <attribute label="Log date and time" name="logDate" type="datetime"/>
            <attribute enum="xtk:jobLog:logType" label="Log type" name="logType" type="short"/>
            <attribute enum="rejectLogType" label="Type" name="rejectLogType" type="string"/>
            <attribute label="Path of element having generated the message" name="xpath" type="string"/>
            <attribute label="Error code" name="error" type="long"/>
            <element label="Message" name="message" type="string"/>
          </element>
        </element>
        <element advanced="false" name="properties" xml="true">
          <element label="Counters" name="counters" xml="true">
            <attribute desc="Total count of records to be processed" label="Total" name="total" type="long"/>
            <attribute desc="Records processed" label="Processed" name="processed" type="long"/>
            <attribute desc="Records successfully processed" label="Success" name="successes" type="long"/>
            <attribute desc="Empty records" label="Empty" name="empties" type="long"/>
            <attribute desc="Rejected records" label="Rejects" name="rejected" type="long"/>
            <attribute desc="Number of records for which a warning has occurred (but not an error) Total warning count" label="Warnings" name="warnings" type="long"/>
            <attribute desc="Number of records for which an error has occurred" label="Errors" name="errors" type="long"/>
            <attribute desc="Transactions completed" label="Transactions" name="transactions" type="long"/>
            <attribute label="Pre-processing scripts" name="sqlPreComplete" type="long"/>
            <attribute label="Post-processing scripts" name="sqlPostComplete" type="long"/>
            <attribute desc="Count of SQL 'INSERT' statements executed" label="Inserted records" name="sqlInserted" type="long"/>
            <attribute desc="Count of SQL 'UPDATE' statements executed" label="Updated records" name="sqlUpdated" type="long"/>
            <attribute desc="Count of SQL 'DELETE' statements executed" label="Deleted records" name="sqlDeleted" type="long"/>
            <attribute desc="Total count of entities created (in all tables)" label="Inserted entities" name="entityInserted" type="long"/>
            <attribute desc="Total count of updated entities (in all tables)" label="Updated entities" name="entityUpdated" type="long"/>
            <attribute desc="Total count of deleted entities (in all tables)" label="Deleted entities" name="entityDeleted" type="long"/>
            <element label="Doubles" name="doubles">
              <attribute desc="Number of doubles not imported (records found multiple time in source file(s) for all entities). This counter is relevant only if dedoubling has been enabled." label="Doubles" name="count" type="long"/>
              <element name="doubleOrigin" unbound="true">
                <key>
                  <keyfield xpath="@name"/>
                </key>
                <attribute label="Origin" name="name" type="string"/>
                <attribute label="Doubles" name="count" type="long"/>
              </element>
            </element>
            <element label="Duplicates" name="duplicates">
              <attribute desc="Number of duplicates found (records found in both the source and destination for all entities). This counter is relevant only in 'Insert of Update' or 'Update' reconciliation modes." label="Duplicates" name="count" type="long"/>
              <element name="duplicateOrigin" unbound="true">
                <key>
                  <keyfield xpath="@name"/>
                </key>
                <attribute label="Origin" name="name" type="string"/>
                <attribute label="Duplicates" name="count" type="long"/>
              </element>
            </element>
          </element>
          <element advanced="true" desc="Content of the export generated when not saved in a file." label="Generated export content" name="inCtxResult" type="CDATA"/>
        </element>
        <element applicableIf="HasPackage('nms:campaign')" label="Operation" name="operation" revIntegrity="own" revLabel="Message exports" revLink="export" target="nms:operation" type="link"/>
      </element>
      <methods async="true">
        <method name="Start"></method>
        <method name="RejectExport"></method>
        <method name="TestCalcField" static="true">
          <parameters>
            <param desc="Data transfer step where the calculated field is defined" inout="in" name="dataTransferStep" type="DOMDocument"/>
            <param desc="Calculated field to test" inout="in" name="calcFieldName" type="string"/>
            <param desc="Returns the list of values for each sample line (calcFieldValues/line) and the field name (calcFieldValues/@name)" inout="out" name="calcFieldValues" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="ExportPreview" static="true">
          <parameters>
            <param desc="Transfer step where the calculated field is defined." inout="in" name="dataTransferStep" type="DOMDocument"/>
            <param desc="Number of lines to return" inout="in" name="lineCount" type="long"/>
            <param desc="Line counting mode" inout="in" name="countMode" type="boolean"/>
            <param desc="Name of the observed calculated field. If empty, it is a global preview of the output file." inout="in" name="calcFieldName" type="string"/>
            <param desc="Returns the values of the export file columns (line/col/val, line/col/errors)." inout="out" name="resultColumns" type="DOMDocument"/>
            <param desc="Returns the output XML document of the query." inout="out" name="resultXML" type="DOMDocument"/>
            <param desc="Returns the SQL query executed." inout="out" name="resultSQLRequest" type="string"/>
          </parameters>
        </method>
        <method name="GetFilesToDownload" static="true">
          <parameters>
            <param desc="Transfer identifier" inout="in" name="jobId" type="long"/>
            <param desc="Returns the list of files which can be downloaded as an element [dataTransfer/properties/filesToDownload]" inout="out" name="filesToDownload" type="DOMElement"/>
            <param desc="Returns the list of files which cannot be downloaded as an element [dataTransfer/properties/filesNotToDownload]" inout="out" name="filesNotToDownload" type="DOMElement"/>
          </parameters>
        </method>
        <method name="AutoDetect" static="true">
          <parameters>
            <param desc="File name" name="fileName" type="string"/>
            <param desc="Character encoding" name="codepage" type="long"/>
            <param desc="Returns the first lines of the file" inout="out" name="result" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="Cleanup" static="true">
          <parameters>
            <param desc="Transfer identifier" inout="in" name="jobId" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Application module initialization parameters" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Initialization parameters" mappingType="xmlFile" name="dbInit" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="dbInit" pkgStatus="never">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <element aggregate="xtk:common:nsName" name="nsName"/>
        <element label="List of SQL scripts to execute before the table creation process" name="sqlListPre">
          <element name="sql" unbound="true">
            <attribute label="SQL script name" name="name" type="string"/>
            <attribute label="Specific to a database engine" name="engine" type="string"/>
          </element>
        </element>
        <element label="List of SQL scripts to execute after the table creation process" name="sqlListPost">
          <element name="sql" unbound="true">
            <attribute label="SQL script name" name="name" type="string"/>
            <attribute label="Specific to a database engine" name="engine" type="string"/>
          </element>
        </element>
        <element label="Entity collection" name="packageList">
          <element name="package" unbound="true">
            <attribute label="Package ID" name="id" type="string"/>
          </element>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="true" implements="xtk:persist" label="Translations" labelSingular="Translation" name="dictionaryString" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="toTranslate" label="Translation status" name="translationStatus">
        <value img="xtk:dot_red.png" label="To translate" name="toTranslate" value="0"/>
        <value img="xtk:dot_orange.png" label="Translated" name="translated" value="1"/>
        <value img="xtk:dot_green.png" label="Approved" name="validated" value="2"/>
        <value img="xtk:dot_cross.png" label="Do not translate" name="doNotTranslate" value="3"/>
      </enumeration>
      <element autopk="true" folderModel="xtkDictionary" name="dictionaryString">
        <compute-string expr="@sourceId + ' (' + @locale + ')'"/>
        <key allowEmptyPart="true" name="name">
          <keyfield xpath="@object-id"/>
          <keyfield xpath="@sourceId"/>
          <keyfield xpath="@locale"/>
        </key>
        <dbindex name="md5" unique="false">
          <keyfield xpath="@md5"/>
          <keyfield xpath="@locale"/>
        </dbindex>
        <element desc="Link to the source string" label="Source string" name="sourceString" revLink="translations" target="xtk:dictionaryString" type="link"/>
        <attribute advanced="true" desc="MD5 key of the string" name="md5" template="xtk:common:md5"/>
        <attribute default="GetOption('XtkInstancePrefix')+'STR'+CounterValue('xtkDictionaryString')" label="Source identifier" length="255" name="sourceId" type="string"/>
        <attribute dbEnum="dictionaryLocale" label="Language" length="12" localizable="true" name="locale" type="string"/>
        <attribute label="Text" length="2000" localizable="true" name="text" type="string"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute defOnDuplicate="true" enum="translationStatus" label="Status" name="status" type="byte"/>
        <attribute dbEnum="dictionaryContext" label="Context" length="32" name="context" type="string"/>
        <attribute expr="Iif([@sourceString-id]=0, 1, 0)" label="The string is a source" name="isSource" type="boolean"/>
        <element default="DefaultFolder('xtkDictionary', [@_folder-id])" label="Folder" name="folder" target="xtk:folder" type="link"/>
        <attribute advanced="true" label="Object" name="object-id" type="long"/>
        <element advanced="false" externalJoin="true" label="Web form" name="webApp" revIntegrity="owncopy" revLink="strings" target="nms:webApp" type="link" unbound="false">
          <join xpath-dst="@id" xpath-src="@object-id"/>
        </element>
        <element advanced="false" externalJoin="true" label="Report" name="report" revIntegrity="neutral" revLink="strings" target="xtk:report" type="link" unbound="false">
          <join xpath-dst="@id" xpath-src="@object-id"/>
        </element>
      </element>
      <methods>
        <method hidden="true" name="UpdateMD5TextSince" static="true">
          <parameters>
            <param desc="MD5 update from this date onwards" name="since" type="datetime"/>
          </parameters>
        </method>
        <method hidden="true" name="UpdateMD5Text" static="true"></method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Entities" labelSingular="Entity" name="entity" namespace="xtk" xtkschema="xtk:srcSchema">
      <element name="entity" pkgStatus="never" sqltable="XtkEntity">
        <key name="name">
          <keyfield xpath="@entitySchema"/>
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label + ' (' + @namespace + ')'"/>
        <attribute default="DefaultNameSpace()" label="Namespace" length="16" name="namespace" required="true" sql="true" type="string"/>
        <attribute default="NewName()" edit="NamePkEdit" label="Name" length="80" name="name" required="true" sql="true" type="string"/>
        <attribute desc="Entity schema" label="Schema" length="80" name="entitySchema" sql="true" type="string"/>
        <attribute default="'xtk:schema.png'" label="Entity image" length="80" name="img" sql="true" type="string"/>
        <attribute label="MD5 key" length="32" name="md5" pkgStatus="never" sql="true" type="string"/>
        <attribute label="Label" length="128" localizable="true" name="label" sql="true" type="string"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail" sql="true"/>
        <element label="Entity content" name="data" sql="true" type="memo"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Backup copies of the latest updates" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Backup copies of the latest updates" labelSingular="Backup copy of the last update" mappingType="xmlFile" name="entityBackupNew" namespace="xtk" xtkschema="xtk:srcSchema">
      <element dataSource="file" name="entityBackupNew" pkgStatus="never" sqltable="XtkEntity">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key name="name">
          <keyfield xpath="@entitySchema"/>
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Namespace" length="16" name="namespace" type="string"/>
        <attribute label="Name" length="255" name="name" type="string"/>
        <attribute desc="Entity schema" label="Schema" length="255" name="entitySchema" type="string"/>
        <element label="Entity content" name="content" type="ANY" xml="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Backup copies of the originals" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Backup copies of the originals" labelSingular="Backup copy of the original" mappingType="xmlFile" name="entityBackupOriginal" namespace="xtk" xtkschema="xtk:srcSchema">
      <element dataSource="file" name="entityBackupOriginal" pkgStatus="never" sqltable="XtkEntity">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key name="name">
          <keyfield xpath="@entitySchema"/>
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Namespace" length="16" name="namespace" type="string"/>
        <attribute label="Name" length="255" name="name" type="string"/>
        <attribute desc="Entity schema" label="Schema" length="255" name="entitySchema" type="string"/>
        <element label="Entity content" name="content" type="ANY" xml="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Entities before customization" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Entities before customization" labelSingular="Entity before customization" mappingType="xmlFile" name="entityOriginal" namespace="xtk" xtkschema="xtk:srcSchema">
      <element dataSource="file" name="entityOriginal" pkgStatus="never" sqltable="XtkEntity">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <key name="name">
          <keyfield xpath="@entitySchema"/>
          <keyfield xpath="@namespace"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Namespace" length="16" name="namespace" type="string"/>
        <attribute label="Name" length="255" name="name" type="string"/>
        <attribute desc="Entity schema" label="Schema" length="255" name="entitySchema" type="string"/>
        <element label="Entity content" name="content" type="ANY" xml="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Itemized values for input assistance" entitySchema="xtk:srcSchema" img="xtk:enum.png" implements="xtk:persist" label="Enumerations" labelSingular="Enumeration" name="enum" namespace="xtk" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="type">
        <value label="Closed" name="closed" value="0"/>
        <value label="Open" name="open" value="1"/>
        <value label="System" name="system" value="2"/>
      </enumeration>
      <element autopk="true" img="xtk:enum.png" name="enum" pkgAdmin="@id != 0 AND @packageAutoExport=1">
        <key name="enum">
          <keyfield xpath="@name"/>
        </key>
        <compute-string expr="@label+'('+@name+')'"/>
        <attribute default="Iif(GetOption('XtkInstancePrefix')='','',GetOption('XtkInstancePrefix')+'_')+ToIdentifier(@label)" label="Internal name" length="128" name="name" required="true" type="string"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute default="1" desc="Exported in automatic packages" label="Exported automatically" name="packageAutoExport" type="boolean"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="1" desc="Enumeration type" enum="type" label="Type" name="type" type="byte"/>
        <attribute desc="Alias cleansing." label="Alias" name="aliases" type="boolean"/>
        <attribute label="Used for binning" name="classBinning" type="boolean"/>
        <attribute defOnDuplicate="true" default="GetDate()" label="Last alias cleansing" name="lastAliasCleansing" type="datetime"/>
        <attribute defOnDuplicate="true" default="GetDate()" label="Last hit calculation" name="lastHitsComputation" type="datetime"/>
        <element integrity="own" name="log" revLink="job" target="xtk:jobLog" type="link" unbound="true"/>
      </element>
      <methods>
        <method name="AliasCleansing" static="true">
          <parameters>
            <param desc="Enumerations filter." inout="in" name="where" type="DOMElement"/>
            <param desc="Start date for survey responses." inout="in" name="fromDate" type="datetime"/>
            <param desc="Hit update." inout="in" name="refreshHit" type="boolean"/>
            <param desc="Hit update from the start." inout="in" name="resetHit" type="boolean"/>
          </parameters>
        </method>
        <method name="GetCleanedValue" static="true">
          <parameters>
            <param desc="Enumeration ID" inout="in" name="enumId" type="long"/>
            <param desc="Value to replace" inout="in" name="alias" type="string"/>
            <param desc="Cleansed value (if not found, returns the alias)" inout="out" name="value" type="string"/>
          </parameters>
        </method>
        <method name="SwitchValuesAndAliases" static="true">
          <parameters>
            <param desc="Collection of the enumerations to be converted." inout="in" name="enums" type="DOMElement"/>
            <param desc="Conversion mode: must be 'ValuesToAliases' or 'AliasesToValues'." inout="in" name="mode" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="xtk:enum.png" implements="xtk:persist" label="Alias of enumeration values" labelSingular="Alias of an enumeration value" name="enumAlias" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" img="xtk:enum.png" name="enumAlias">
        <compute-string expr="@label"/>
        <dbindex name="label">
          <keyfield xpath="@enum-id"/>
          <keyfield xpath="@label"/>
        </dbindex>
        <element label="Enumeration" name="enum" revIntegrity="own" revLabel="Alias" revLink="aliases" target="xtk:enum" type="link"/>
        <element label="value" name="enumValue" revIntegrity="own" revLabel="Alias" revLink="alias" target="xtk:enumValue" type="link"/>
        <attribute label="Label" length="255" name="label" type="string"/>
        <attribute default="getDate()" label="Last modified" name="lastModified" type="datetime"/>
        <attribute desc="Estimate of the number of alias hits in this database." label="Hits" name="hits" type="long"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Enumeration values for input help" entitySchema="xtk:srcSchema" img="xtk:enumVal.png" implements="xtk:persist" label="Enumeration values" labelSingular="Enumeration value" name="enumValue" namespace="xtk" xtkschema="xtk:srcSchema">
      <element autopk="true" img="xtk:enumVal.png" name="enumValue">
        <compute-string expr="@label"/>
        <key name="nameOnly" noDbIndex="true">
          <keyfield xpath="@name"/>
        </key>
        <dbindex name="label">
          <keyfield xpath="@enum-id"/>
          <keyfield xpath="@label"/>
        </dbindex>
        <key name="name" noDbIndex="true">
          <keyfield xpath="@enum-id"/>
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Primary key" name="id" sqlname="iValueId" type="long"/>
        <element label="Enumeration" name="enum" revIntegrity="own" revLabel="Values" revLink="value" target="xtk:enum" type="link"/>
        <attribute label="Label" length="255" localizable="true" name="label" type="string"/>
        <attribute label="Internal name" length="64" name="name" type="string"/>
        <attribute label="Image" length="128" name="img" type="string"/>
        <attribute default="getDate()" label="Last modified" name="lastModified" type="datetime"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:excludeLog.png" implements="xtk:persist" label="Recipient exclusion logs" labelSingular="Recipient exclusion log" name="excludeLogRcp" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="excludeLogRcp" template="nms:broadLog">
        <dbindex name="recipient">
          <keyfield xlink="recipient"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <element name="delivery" revLabel="Recipient exclusion logs"/>
        <element integrity="normal" label="Recipient" name="recipient" noDbIndex="true" revIntegrity="normal" revLabel="Exclusion logs" revLink="excludeLog" target="nms:recipient" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:broadLog.png" implements="xtk:persist" label="Operator delivery logs" labelSingular="Operator delivery log" name="broadLogOp" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="broadLogOp" template="nms:broadLog">
        <dbindex name="operator">
          <keyfield xlink="operator"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <element name="delivery" revLabel="Operator delivery logs"/>
        <element integrity="normal" label="Operator" name="operator" noDbIndex="true" revIntegrity="normal" revLabel="Delivery logs" revLink="broadLog" target="xtk:operator" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Delivery-message qualification" labelSingular="Delivery message qualification" name="broadLogMsg" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="toQualify" label="Qualification status" name="qualifStatus">
        <value label="To qualify" name="toQualify" value="0"/>
        <value label="Keep" name="keep" value="1"/>
        <value label="Ignore" name="ignore" value="2"/>
      </enumeration>
      <element autopk="true" name="broadLogMsg" pkgStatus="never">
        <key name="md5">
          <keyfield xpath="@md5"/>
        </key>
        <dbindex name="count">
          <keyfield xpath="@count"/>
        </dbindex>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" type="datetime"/>
        <attribute label="Message MD5" length="32" name="md5" type="string"/>
        <attribute desc="Message text" label="Text" length="512" name="text" type="string"/>
        <attribute desc="First address" label="First address" length="192" name="firstAddress" pkgStatus="never" type="string"/>
        <attribute desc="First non-normalized text" label="First text" length="512" name="firstText" pkgStatus="never" type="string"/>
        <attribute enum="nms:ruleSet:failureType" label="Failure type" name="failureType" type="byte"/>
        <attribute desc="Reason of failure" enum="nms:broadLog:failureReason" label="Reason" name="failureReason" type="byte"/>
        <attribute enum="qualifStatus" label="Qualification status" name="qualifStatus" type="byte"/>
        <attribute desc="Number of occurrences" name="count" pkgStatus="never" type="long"/>
        <attribute label="Modification date" name="lastModified" type="datetime"/>
        <element label="Typology rule" name="rule" revLabel="Exclusion messages" revLink="exclusionMessages" target="nms:typologyRule" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Mapping table to find Adobe Campaign message IDs based on external ID" entitySchema="xtk:srcSchema" implements="xtk:persist" label="External identifiers of the messages" labelSingular="External identifier of message" name="providerMsgId" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="providerMsgId" pkgStatus="never">
        <key name="id">
          <keyfield xpath="@providerId"/>
        </key>
        <dbindex name="broadLogId">
          <keyfield xpath="@broadLog-id"/>
        </dbindex>
        <dbindex name="created">
          <keyfield xpath="@created"/>
        </dbindex>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" type="datetime"/>
        <attribute name="delivery-id" type="long"/>
        <attribute name="broadLog-id" type="long"/>
        <attribute length="64" name="providerId" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Calendar used by scheduled tasks" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:scheduledtasks.png" implements="xtk:persist" label="Calendars" labelSingular="Calendar" mappingType="xmlFile" name="calendar" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="xtk:scheduledtasks.png" name="calendar" pkgAdmin="@namespace NOT IN ('xtk','nl','nms','ncm','crm')">
        <sysFilter name="writeAccess">
          <condition enabledIf="hasNamedRight('admin')=false" expr="FALSE"/>
        </sysFilter>
        <compute-string expr="@label"/>
        <element aggregate="xtk:common:nsResName" name="nsName"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="comment" template="xtk:common:comment"/>
        <element label="List of days" name="day" ordered="true" unbound="true" xml="true">
          <attribute label="Date" name="date" required="true" type="date"/>
          <attribute label="Description" name="desc" type="string"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Set of rules to apply to deliveries corresponding to the typology" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:typofolder.png" implements="xtk:persist" label="Typologies" labelSingular="Typology" name="typology" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="none" name="type">
        <value label="Standard" name="none" value="0"/>
        <value label="Filtering" name="filter" value="1"/>
      </enumeration>
      <element autopk="true" folderModel="nmsTypology" fullLoad="true" img="nms:typofolder.png" name="typology" pkgAdmin="@id != 0">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'TY'+CounterValue('nmsTypology')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="desc" template="xtk:common:desc"/>
        <attribute desc="Typology type" enum="type" label="Type" name="type" type="byte"/>
        <attribute desc="Enables you to associate the typology with an affinity for the IP addresses used to deliver the emails." label="IP affinity" length="64" name="IPAffinity" type="string" userEnum="IPAffinity"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element desc="Typology folder" label="Folder" name="folder" required="true" revDesc="Typologies contained in this folder" revIntegrity="define" revLabel="Typologies" target="xtk:folder" type="link"/>
        <element applicableIf="HasPackage('nms:centralLocal')" label="Organizational entity" name="localOrgUnit" revIntegrity="define" target="nms:localOrgUnit" type="link"/>
        <element applicableIf="HasPackage('nms:centralLocal')" label="Associated central typology" name="centralTypology" revIntegrity="define" target="nms:typology" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Rules applying to delivery actions based on typologies" entitySchema="xtk:srcSchema" img="nms:typorule.png" implements="xtk:persist" label="Typology rules" labelSingular="Typology rule" name="typologyRule" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration name="messageType" template="nms:delivery:messageType">
        <value applicableIf="HasPackage('nms:interaction')" desc="Web channel" enabledIf="@ruleType = 'propositionConsistency'" img="nms:world.png" label="Inbound Web" name="web" value="50"/>
        <value applicableIf="HasPackage('nms:interaction')" desc="Call Center channel" enabledIf="@ruleType = 'propositionConsistency'" img="nms:phone.png" label="Inbound call center" name="callCenter" value="51"/>
        <value desc="All delivery channels" enabledIf="@ruleType != 'volume'" img="nms:world.png" label="All channels" name="all" value="127"/>
      </enumeration>
      <enumeration basetype="string" default="javascript" label="Rule type" name="ruleType">
        <value desc="The rule defines a SQL recipient-exclusion query." img="xtk:filter.png" label="Filtering" name="sql"/>
        <value applicableIf="HasPackage('nms:campaignOptimization')" desc="The rule defines the settings used to manage pressure between delivery actions." img="nms:businessRanking.png" label="Pressure" name="businessRanking"/>
        <value applicableIf="HasPackage('nms:campaignOptimization')" desc="The rule defines the settings used to manage delivery capacity." img="nms:periodVolume.png" label="Capacity" name="volume"/>
        <value desc="The rule defines a control formula to apply on the delivery." img="xtk:javascript.png" label="Control" name="javascript"/>
        <value applicableIf="HasPackage('nms:interaction')" desc="The rules defines the presentation settings for offer propositions." img="nms:offer.png" label="Offer presentation" name="propositionConsistency"/>
      </enumeration>
      <enumeration basetype="byte" default="all" label="Offer-application context" name="contextType">
        <value desc="The rules is applied all of the time." label="All" name="all" value="0"/>
        <value desc="The rule is only applicable for certain outlines." label="Outline" name="compo" value="1"/>
        <value desc="The rule is only applicable for certain deliveries." label="Delivery" name="delivery" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="preTarget" label="Analysis phase" name="ruleStep">
        <value desc="Rule is applied only once when the analysis starts." label="At the start of targeting" name="preTarget"/>
        <value desc="The rule is applied after targeting and associated counts." label="After targeting" name="postTarget"/>
        <value desc="The rule is applied once when starting preparing the messages." label="At the start of personalization" name="preMessage"/>
        <value desc="The rule is applied after preparing the messages." label="At the end of the analysis" name="postMessage"/>
      </enumeration>
      <enumeration basetype="byte" default="constant" label="Threshold type" name="thresholdType">
        <value label="Constant" name="constant" value="0"/>
        <value label="Depends on the recipient" name="formula" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="sec" label="Grouping unit" name="boxingUnit">
        <value label="(no grouping)" name="sec" value="0"/>
        <value label="Grouping per day" name="day" value="1"/>
        <value label="Grouping per calendar week" name="week" value="2"/>
        <value label="Grouping per calendar month" name="month" value="3"/>
        <value label="Grouping per calendar quarter" name="quarter" value="4"/>
        <value label="Grouping per calendar year" name="year" value="5"/>
      </enumeration>
      <enumeration basetype="byte" default="all" label="Set of offers" name="offerSet">
        <value desc="Propositions for all offers" label="All offers" name="all" value="0"/>
        <value desc="Propositions for the same offer" label="Only the offer being presented" name="sameOffer" value="1"/>
        <value desc="Propositions for offers of the same category" label="Offers for the same category" name="sameCategory" value="2"/>
        <value desc="Propositions for offers of the rule (uses the 'general' tab filter)" label="Offers which the rule applies to" name="ruleOffers" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="all" label="Proposition status" name="propositionStatus">
        <value desc="All propositions regardless of their status" label="Regardless of proposition status" name="all" value="0"/>
        <value label="Accepted or rejected propositions" name="acceptedOrRefused" value="1"/>
        <value label="Accepted propositions" name="accepted" value="2"/>
        <value label="Rejected propositions" name="refused" value="3"/>
      </enumeration>
      <element autopk="true" enumImage="@messageType" folderModel="nmsTypologyRule" img="nms:typorule.png" name="typologyRule" pkgAdmin="@id != 0">
        <compute-string expr="@label + ' ' + '(' + [folder/@label] + ')'"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <dbindex name="mt">
          <keyfield xpath="@messageType"/>
        </dbindex>
        <attribute default="GetOption('XtkInstancePrefix')+'RL'+CounterValue('nmsTypologyRule')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute enum="messageType" label="Channel" name="messageType" type="byte"/>
        <attribute default="true" desc="Rule is active" label="Active" name="active" type="boolean"/>
        <attribute advanced="true" defOnDuplicate="true" label="Application built-in rule" name="builtIn" type="boolean"/>
        <attribute enum="nms:typologyRule:ruleType" label="Rule type" length="30" name="ruleType" type="string"/>
        <attribute enum="nms:typologyRule:ruleStep" label="Phase" length="16" name="ruleStep" type="string"/>
        <attribute default="50" desc="Defines execution order for all rules in the same phase (from smallest to largest value)" label="Execution order" name="order" type="long"/>
        <attribute label="Re-apply the rule at the start of personalization" name="forceOnPrepareMessage" type="boolean"/>
        <attribute desc="Defines the frequency at which the rule must be recalculated" label="Frequency" name="validity" type="timespan"/>
        <attribute desc="Severity level when the rule fails." enum="xtk:jobLog:logType" label="Level" name="level" type="byte" xml="true"/>
        <element name="desc" template="xtk:common:desc"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element desc="Source code of the rule" label="Code" name="code" type="CDATA" xml="true"/>
        <attribute default="getOption('Nms_DefaultRcpSchema')" desc="Schema to which the filtering applies" label="Targeting dimension" name="schema" required="true" xml="true"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Storage dimension for propositions" label="Storage dimension" name="propositionSchema" type="string" xml="true"/>
        <element desc="Exclusion filtering condition" name="where" unbound="true" xml="true">
          <element aggregate="xtk:queryDef:where" name="where"/>
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          <attribute label="Filter name" name="filterName" type="string"/>
          <element desc="Context of the condition" label="Context" name="ctx" type="ANY"/>
          <element label="Query label" name="humanCond" type="string"/>
        </element>
        <element label="Query" name="humanCond" type="string" xml="true"/>
        <element label="Messages to take into account" name="contextFilter" xml="true">
          <attribute enum="contextType" label="Context of application" name="contextType"/>
          <element label="Condition" name="where" template="xtk:queryDef:where">
            <attribute expr="Iif([../../@ruleType]='propositionConsistency', 'nms:offer', Iif([../@contextType]=2, 'nms:delivery', 'nms:deliveryOutline'))" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          </element>
          <element label="Query label" name="humanCond" type="string"/>
        </element>
        <element applicableIf="HasPackage('nms:interaction')" desc="Offer presentation settings" label="Offer presentation" name="propositionConsistency" xml="true">
          <attribute default="1296000" label="Period considered" name="period" type="timespan"/>
          <attribute default="1" label="Threshold" name="threshold" type="long"/>
          <attribute enum="nms:typologyRule:offerSet" label="Offers" name="offerSet"/>
          <attribute label="On the same channel only" name="sameChannel" type="boolean"/>
          <attribute enum="nms:typologyRule:propositionStatus" label="Proposition status" name="status"/>
          <element desc="Proposition count conditions" label="Propositions to count" name="propositionFilter" xml="true">
            <element label="Condition" name="where" template="xtk:queryDef:where">
              <attribute expr="[../../../@propositionSchema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
            </element>
            <element label="Query label" name="humanCond" type="string"/>
          </element>
        </element>
        <element applicableIf="HasPackage('nms:campaignOptimization')" desc="Pressure settings for delivery actions" label="Pressure" name="businessRanking" xml="true">
          <attribute desc="Take the deliveries into account in the provisional calendar" label="Take into account in the provisional calendar" name="activeForecast" type="boolean"/>
          <attribute default="1296000" label="Period considered" name="periodRanking" type="timespan"/>
          <attribute enum="boxingUnit" label="Period type" name="boxingUnit" type="byte"/>
          <attribute enum="thresholdType" label="Threshold type" name="thresholdType" type="byte"/>
          <element label="Threshold computation formula" name="thresholdFormula" type="string"/>
          <attribute default="1" label="Threshold" name="threshold" type="long"/>
          <attribute label="Grouping" name="thresholdLink" type="string"/>
          <element default="5" label="Default weight formula" name="weightFormula" type="string"/>
          <element desc="Message count condition" label="Messages to count" name="deliveryFilter" xml="true">
            <element label="Condition" name="where" template="xtk:queryDef:where">
              <attribute expr="'nms:delivery'" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
            </element>
            <element label="Query label" name="humanCond" type="string"/>
          </element>
        </element>
        <element applicableIf="HasPackage('nms:campaignOptimization')" desc="Channel pressure settings" label="Volume" name="volume" xml="true">
          <attribute label="Exclude from the target messages in excess of capacity" name="preventOverConsumption" type="boolean"/>
          <attribute label="Do not limit instantaneous delivery capacity" name="noMaxSpeed" type="boolean"/>
          <attribute applicableIf="HasPackage('nms:centralLocal')" label="Split this channel into sub-channels" name="useSubChannels" type="boolean"/>
          <element applicableIf="HasPackage('nms:centralLocal')" label="Sub-channel calculation formula" name="channelFormula" type="string"/>
        </element>
        <element label="Rule folder" name="folder" required="true" revDesc="Typology rules contained in this folder" revIntegrity="define" revLabel="Typology rules" target="xtk:folder" type="link"/>
        <element applicableIf="HasPackage('nms:centralLocal')" label="Organizational entity" name="localOrgUnit" revIntegrity="define" target="nms:localOrgUnit" type="link"/>
        <element applicableIf="HasPackage('nms:centralLocal')" desc="Association of the central typology rule" label="Associated central typology rule" name="centralTypologyRule" revIntegrity="define" target="nms:typologyRule" type="link"/>
      </element>
      <methods>
        <method name="GenerateVolumeLines" static="true">
          <parameters>
            <param desc="Rule ID" inout="in" name="ruleId" type="long"/>
            <param desc="Availability time per line" inout="in" name="lineDuration" type="timespan"/>
            <param desc="Quantity available" inout="in" name="quantity" type="double"/>
            <param desc="Generation parameters" inout="in" name="scheduling" type="string"/>
            <param desc="Logical sub-channel ID" inout="in" name="subChannel" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:typorule.png" implements="xtk:persist" label="Relation between typologies and rules" labelSingular="Relation between typology and rule" name="typologyRuleRel" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="nms:typorule.png" name="typologyRuleRel">
        <key internal="true" name="id">
          <keyfield xlink="typology"/>
          <keyfield xlink="rule"/>
        </key>
        <element integrity="neutral" label="Typology" name="typology" revIntegrity="owncopy" revLabel="Rules of the typology" revLink="rules" target="nms:typology" type="link"/>
        <element integrity="neutral" label="Typology rule" name="rule" revDesc="Typologies applying this rule" revIntegrity="own" revLabel="Typologies applying the rule" revLink="typologies" target="nms:typologyRule" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" library="true" name="common" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="i25" name="barcodeType">
        <value desc="Codabar" label="Codabar" name="cbr" value="CBR"/>
        <value label="Code 128" name="_128" value="128"/>
        <value label="GS1-128 (EAN-128)" name="ean128" value="EAN128"/>
        <value label="UPC-A" name="upca" value="UPCA"/>
        <value label="UPC-E" name="upce" value="UPCE"/>
        <value desc="ISBN and EAN13" label="ISBN" name="isbn" value="ISBN"/>
        <value label="EAN-8" name="ean8" value="EAN8"/>
        <value label="Code39" name="_39" value="39"/>
        <value label="Interleaved 2 of 5" name="i25" value="I25"/>
        <value desc="DataMatrix (ISO 16022:2000(E))" label="DataMatrix" name="datamatrix" value="DATAMATRIX"/>
        <value label="POSTNET" name="postnet" value="POSTNET"/>
        <value desc="Royal Mail Customer Bar Code" label="Royal Mail" name="royalmailcbc" value="ROYALMAILCBC"/>
        <value label="PDF417" name="pdf417" value="PDF417"/>
        <value label="QR Code" name="qrcode" value="QRCode"/>
      </enumeration>
      <enumeration basetype="string" default="_1" name="barcodeScale">
        <value label="x 1" name="_1" value="1"/>
        <value label="x 2" name="_2" value="2"/>
        <value label="x 3" name="_3" value="3"/>
        <value label="x 4" name="_4" value="4"/>
        <value label="x 5" name="_5" value="5"/>
        <value label="x 6" name="_6" value="6"/>
        <value label="x 7" name="_7" value="7"/>
        <value label="x 8" name="_8" value="8"/>
        <value label="x 9" name="_9" value="9"/>
        <value label="x 10" name="_10" value="10"/>
      </enumeration>
      <enumeration basetype="string" default="Q" name="qrcodeErrCorr">
        <value label="7%" name="L" value="L"/>
        <value label="15%" name="M" value="M"/>
        <value label="25%" name="Q" value="Q"/>
        <value label="30%" name="H" value="H"/>
      </enumeration>
      <enumeration basetype="long" default="0" desc="Quality rating of a postal address" name="addressQuality">
        <value label="0 - Incomplete address" name="0" value="0"/>
        <value label="1 - Unknown Town-PostalCode" name="1" value="1"/>
        <value label="2 - Empty street" name="2" value="2"/>
        <value label="3 - Unknown street" name="3" value="3"/>
        <value label="4 - Partially-recognized street" name="4" value="4"/>
        <value label="5 - Fully-recognized street" name="5" value="5"/>
      </enumeration>
      <enumeration basetype="byte" default="complete" label="Preparation mode" name="sandboxMode">
        <value img="nms:delivery.png" label="Target estimation and message personalization" name="complete" value="0"/>
        <value applicableIf="HasPackage('nms:campaignOptimization')" img="nms:businessRanking.png" label="Estimation and approval of the provisional target" name="sandbox" value="1"/>
        <value applicableIf="HasPackage('nms:campaign')" img="nms:simulation.png" label="Target evaluation" name="simulation" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="operationDriven" label="Delivery preparation mode" name="sandboxModeEnforcement">
        <value img="nms:operation.png" label="Defined at the campaign level" name="operationDriven" value="0"/>
        <value img="nms:broadLog.png" label="Target estimation and message personalization" name="complete" value="1"/>
        <value img="nms:businessRanking.png" label="Estimation and approval of the provisional target" name="sandbox" value="2"/>
        <value applicableIf="HasPackage('nms:campaign')" img="nms:simulation.png" label="Target evaluation" name="simulation" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="sort" label="Seed address insertion mode" name="seedInsertMode">
        <value label="Respect the sort order" name="sort" value="0"/>
        <value label="At the start of the file" name="begin" value="1"/>
        <value label="At the end of the file" name="end" value="2"/>
        <value label="Random" name="random" value="3"/>
      </enumeration>
      <element advanced="true" label="Seed addresses" name="seedList">
        <attribute desc="Insert seed addresses in the file" label="Insert seed addresses" name="active" type="boolean"/>
        <attribute desc="Seed address insertion mode" enum="nms:common:seedInsertMode" label="Insertion mode" name="insertMode" type="byte"/>
        <element desc="Seed list selection condition" name="where" ref="xtk:queryDef:where"/>
        <attribute advanced="true" label="Label of the dynamic condition" name="humanCond" type="string"/>
      </element>
      <enumeration basetype="byte" name="propositionStatus">
        <value label="Generated" name="generated" value="0"/>
        <value label="Presented" name="presented" value="1"/>
        <value label="Interested" name="interesting" value="2"/>
        <value label="Accepted" name="accepted" value="3"/>
        <value label="Scheduled" name="delayed" value="4"/>
        <value label="Rejected" name="refused" value="5"/>
        <value enabledIf="'$(entityPath)'!='/offerSpace'" label="Control group" name="control" value="99"/>
      </enumeration>
      <enumeration basetype="byte" default="delay" name="validationType">
        <value label="Delay from submission date" name="delay" value="0"/>
        <value label="Given date" name="date" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="delay" name="reminderType">
        <value label="Delay from approval deadline" name="delay" value="0"/>
        <value label="Given date" name="date" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="default" name="pop3TLSMode">
        <value desc="By default (POP3 if port 110, POP3S if port 995)" label="By default" name="default" value="0"/>
        <value desc="POP3 that switches to SSL after the sending of a STARTTLS" label="POP3 + STARTTLS (secure)" name="forceTLS" value="1"/>
        <value desc="POP3 non-secure (port 110 by default)" label="POP3 (non-secure)" name="isNoTLS" value="2"/>
        <value desc="POP3 secure above SSL (port 995 by default)" label="POP3S (secure)" name="isTLS" value="3"/>
      </enumeration>
      <element dataPolicy="phone" desc="Phone number" label="Phone" length="32" name="phone" type="string"/>
      <element dataPolicy="phone" desc="Fax number" label="Fax" length="32" name="fax" type="string"/>
      <element desc="Internet site" label="Web site" length="255" name="url" type="string"/>
      <element name="locationAggregate">
        <element desc="Information about the geographical location" label="Location" name="location">
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" desc="Address 1: recipient identification detail: door or letterbox number, floor, staircase, company name..." label="Address 1 (apartment)" length="80" name="address1" type="string"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" desc="Address 2: geographical address detail: entrance, wing, building..." label="Address 2" length="80" name="address2" type="string"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" desc="Address 3: street number and name" label="Address 3 (Number and street)" length="80" name="address3" type="string"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" desc="Address 4: county or special delivery instructions, postbox..." label="Address 4 (county)" length="80" name="address4" type="string"/>
          <attribute label="Zip/Postcode" length="20" name="zipCode" type="string"/>
          <attribute label="City" length="75" name="city" type="string" userEnum="city"/>
          <attribute label="State/Province code" length="3" name="stateCode" type="string"/>
          <attribute advanced="true" label="Country code" length="3" name="countryCode" type="string"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" desc="Address 1: recipient identification detail: door or letterbox number, floor, staircase, company name..." label="Address 1 (apartment)" length="80" name="additionalRcp" sqlname="sAddrAdditionalRcp" type="string"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" desc="Address 2: geographical address detail: entrance, wing, building..." label="Address 2" length="80" name="additionalGeo" sqlname="sAddrAdditionalGeo" type="string"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" desc="Address 3: street number and name" label="Address 3 (Number and street)" length="80" name="street" sqlname="sAddrStreet" type="string"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" desc="Address 4: county or special delivery instructions, postbox..." label="Address 4 (county)" length="80" name="special" sqlname="sAddrSpecial" type="string"/>
        </element>
      </element>
      <element desc="Normalized postal address" label="Postal address" name="postalAddress">
        <attribute desc="Recipient identity (corporate or company name)." label="Line 1" length="80" name="line1" type="string"/>
        <attribute desc="Recipient identification detail (recipient or service identity)." label="Line 2" length="80" name="line2" type="string"/>
        <attribute desc="Geographical address detail (wing, building, construction...)." label="Line 3" length="80" name="line3" type="string"/>
        <attribute desc="Number and label of street." label="Line 4" length="80" name="line4" type="string"/>
        <attribute desc="Village..." label="Line 5" length="80" name="line5" type="string"/>
        <attribute desc="ZIP/Postcode, locality and country if needed." label="Line 6" length="80" name="line6" type="string"/>
        <attribute label="Line 7" length="80" name="line7" type="string"/>
        <element desc="Concatenation of the 6 lines of the postal address." expr="@line1+'\n'+@line2+'\n'+@line3+'\n'+@line4+'\n'+@line5+'\n'+@line6+'\n'+@line7" label="Complete address" name="serialized" type="CDATA" xml="false"/>
        <attribute expr="AllNonNull2(@line1, @line6)" label="Address specified" name="addrDefined" type="boolean"/>
        <attribute desc="Address quality rating." enum="nms:common:addressQuality" label="Quality rating" name="addrQuality" type="long"/>
        <attribute desc="Last-qualification date of the address." label="Last qualification" name="addrLastCheck" type="datetime"/>
        <attribute desc="Number of consecutive errors when sending to this address." label="Number of errors" name="addrErrorCount" type="long"/>
      </element>
      <element name="freeFields">
        <attribute advanced="true" desc="User defined text field" label="Text 1" length="180" name="text1" type="string"/>
        <attribute advanced="true" desc="User defined text field" label="Text 2" length="180" name="text2" type="string"/>
        <attribute advanced="true" desc="User defined text field" label="Text 3" length="180" name="text3" type="string"/>
        <attribute advanced="true" desc="User defined text field" label="Text 4" length="180" name="text4" type="string"/>
        <attribute advanced="true" desc="User defined text field" label="Text 5" length="180" name="text5" type="string"/>
        <attribute advanced="true" desc="User defined boolean field" label="Boolean 1" name="boolean1" type="boolean"/>
        <attribute advanced="true" desc="User defined boolean field" label="Boolean 2" name="boolean2" type="boolean"/>
        <attribute advanced="true" desc="User defined boolean field" label="Boolean 3" name="boolean3" type="boolean"/>
      </element>
      <element label="Reminder" name="reminder">
        <key internal="true" name="assigneeId">
          <keyfield xpath="@id"/>
        </key>
        <attribute default="Gid()" label="Primary key" name="id" type="string" xml="true"/>
        <attribute enum="nms:common:reminderType" label="Reminder type" name="type" type="byte"/>
        <attribute default="-86400" label="Delay" name="delay" type="timespan"/>
        <attribute label="Date" name="date" type="date"/>
      </element>
      <element label="Approval" name="validation">
        <attribute default="0" enum="nms:common:validationType" label="Approval type" name="type" type="byte"/>
        <attribute default="259200" label="Delay" name="delay" type="timespan"/>
        <attribute label="Date" name="date" type="datetime"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" extendedSchema="xtk:dataTransfer" implements="xtk:persist" name="dataTransfer" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="dataTransfer">
        <element name="dataTransferStep">
          <element label="List" name="group" target="nms:group" type="link"/>
          <attribute default="false" label="Purge list" name="clearGroup" type="boolean"/>
          <element label="Folder" name="folder" target="xtk:folder" type="link"/>
          <attribute default="true" label="Default recipient folder of the operator" name="useDefaultUserRcpFolder" type="boolean"/>
          <attribute label="Origin" name="origin" type="string" userEnum="origin"/>
          <element label="Service" name="service" target="nms:service" type="link"/>
          <attribute label="Send a confirmation message" name="sendConfirmation" type="boolean"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Defines the parameters of a delivery (or of a delivery template)." entitySchema="xtk:srcSchema" img="nms:campaign.png" implements="xtk:persist" label="Deliveries" labelSingular="Delivery" name="delivery" namespace="nms" useRecycleBin="true" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="bulk" label="Delivery mode" name="deliveryMode">
        <value desc="Declaration of a delivery not performed by the platform itself." label="External" name="external" value="0"/>
        <value desc="Campaign delivery." label="Bulk delivery" name="bulk" value="1"/>
        <value desc="Description of a non-executable delivery." label="Description" name="descriptive" value="2"/>
        <value desc="Delivery through a remote Adobe Campaign platform (mid-sourcing)." label="Mid-sourcing" name="midSourcing" value="4"/>
      </enumeration>
      <enumeration basetype="byte" default="mail" label="Channel" name="messageType">
        <value desc="Email channel" img="nms:email.png" label="Email" name="mail" value="0"/>
        <value desc="Mobile channel (SMS)" img="nms:mobile.png" label="Mobile (SMS)" name="sms" value="1"/>
        <value desc="Telephone channel" img="nms:phone.png" label="Phone" name="phone" value="2"/>
        <value desc="Direct mail channel" img="nms:paper.png" label="Direct Mail" name="paper" value="3"/>
        <value desc="Fax channel" img="nms:fax.png" label="Fax" name="fax" value="4"/>
        <value applicableIf="HasPackage('nms:centralLocal')" desc="Agency channel" img="nms:agency.png" label="Agency" name="agency" value="5"/>
        <value applicableIf="HasPackage('nms:social')" desc="Facebook channel" img="nms:facebook.png" label="Facebook" name="facebook" value="20"/>
        <value applicableIf="HasPackage('nms:social')" desc="Twitter Channel" img="nms:twitter.png" label="Twitter" name="twitter" value="25"/>
        <value applicableIf="HasPackage('nms:mobileApp')" desc="iOS applications channel" img="nms:ios.png" label="iOS channel" name="ios" value="41"/>
        <value applicableIf="HasPackage('nms:mobileApp')" desc="Android applications channel" img="nms:android.png" label="Android channel" name="android" value="42"/>
        <value desc="Other channel" img="nms:other.png" label="Other" name="other" value="120"/>
      </enumeration>
      <enumeration basetype="byte" default="edition" label="Delivery status" name="deliveryState">
        <value img="nms:delivery.png" label="Being edited" name="edition" value="0"/>
        <value img="nms:prepare.png" label="Targeting pending" name="targetPrepPending" value="11"/>
        <value img="nms:prepare.png" label="Counting in progress" name="targetSelection" value="12"/>
        <value img="nms:prepare.png" label="Arbitration in progress" name="targetArbitration" value="13"/>
        <value img="nms:toprepare.png" label="Target ready" name="targetReady" value="15"/>
        <value img="nms:prepare.png" label="Personalization pending" name="messagePrepPending" value="21"/>
        <value img="nms:prepare.png" label="Personalization in progress" name="messagePreparation" value="22"/>
        <value img="nms:toprepare.png" label="Message finalized" name="messageReady" value="25"/>
        <value img="nms:error.png" label="Personalization or count failed" name="preparationError" value="37"/>
        <value img="nms:tovalidate.png" label="Ready to be delivered" name="ready" value="45"/>
        <value img="nms:started.png" label="Start pending" name="startPending" value="51"/>
        <value img="nms:started.png" label="In progress" name="started" value="55"/>
        <value img="nms:wretry.png" label="Retry pending" name="retryPending" value="61"/>
        <value img="nms:retry.png" label="Retry in progress" name="retryInProgress" value="62"/>
        <value img="nms:pause.png" label="Pause requested" name="pausePending" value="71"/>
        <value img="nms:pause.png" label="Pause in progress" name="pauseInProgress" value="72"/>
        <value img="nms:pause.png" label="Paused" name="paused" value="75"/>
        <value img="nms:canceled.png" label="Stop requested" name="cancelPending" value="81"/>
        <value img="nms:canceled.png" label="Stop in progress" name="cancelInProgress" value="82"/>
        <value img="nms:canceled.png" label="Stopped" name="cancelled" value="85"/>
        <value img="nms:error.png" label="Failed" name="failed" value="87"/>
        <value img="nms:finished.png" label="Finished" name="finished" value="95"/>
        <value img="nms:recycle.png" label="Deleted" name="deleted" value="100"/>
      </enumeration>
      <enumeration basetype="byte" default="notApplicable" label="Publication status" name="publicationStatus">
        <value img="nms:delivery.png" label="Not applicable" name="notApplicable" value="0"/>
        <value img="nms:dedit.png" label="Being edited" name="edition" value="1"/>
        <value img="nms:prepare.png" label="Published" name="deployed" value="2"/>
        <value img="nms:error.png" label="Failed" name="failed" value="3"/>
        <value img="nms:prepare.png" label="In production" name="production" value="100"/>
      </enumeration>
      <enumeration basetype="byte" default="starting" label="Analysis progress" name="analysisStep">
        <value label="Starting" name="starting" value="0"/>
        <value label="Delivery ready for analysis" name="initDelivery" value="1"/>
        <value label="Initialization finished" name="initialized" value="2"/>
        <value label="Typology rules applied" name="jsRulesApplied" value="3"/>
        <value label="Finished creating work tables for delivery analysis" name="createWorkTable" value="4"/>
        <value label="Finished preparing the delivery in the work tables" name="fillWorkTable" value="5"/>
        <value label="SQL rules applied" name="sqlRulesApplied" value="6"/>
        <value label="Limit to delivery recipients applied" name="truncateRecipient" value="7"/>
        <value label="Targeting complete" name="targetFinalized" value="8"/>
        <value label="Assembly of the main delivery target complete" name="collectDistributed" value="9"/>
        <value label="Generated propositions" name="propositionGenerated" value="10"/>
        <value label="Finalized SQL rules" name="sqlRulesFinalized" value="11"/>
        <value label="Items attached to the delivery" name="attachmentProcessed" value="12"/>
        <value label="Finished assigning coupons" name="coupons" value="13"/>
        <value label="Finished preparing delivery fragments" name="deliveryParts" value="14"/>
        <value label="Delivery logs exported" name="export" value="15"/>
        <value label="Finished preparing delivery logs" name="broadLogs" value="16"/>
        <value label="Delivery analysis finished" name="finished" value="17"/>
      </enumeration>
      <enumeration basetype="byte" default="database" label="Target Selection Mode" name="targetMode">
        <value desc="Deliver message to recipients existing in NmsRecipient table of the database." img="nms:segment.png" label="Recipients from the database" name="database" value="0"/>
        <value desc="Deliver message to recipients from in a file." img="nms:filecolumn.png" label="File based external data source." name="file" value="1"/>
        <value desc="Deliver message to recipients not existing in the database." label="List of addresses" name="address" value="2"/>
        <value label="Population resulting from inbound event(s)" name="evtDatabase" value="3"/>
        <value label="File resulting from the inbound event" name="evtFile" value="4"/>
      </enumeration>
      <enumeration basetype="byte" default="yes" label="Tracking type" name="trackingType">
        <value desc="Activate the tracking on this URL." label="Enabled" name="yes" value="0"/>
        <value desc="Do not activate the tracking of this URL." label="Not tracked" name="no" value="1"/>
        <value desc="Always activate the tracking of this URL. This information is saved so that the next time, if the URL appears again in a future document, its tracking be automatically activated." label="Always enabled" name="always" value="2"/>
        <value desc="Do never activate the tracking of this URL. This information is saved so that the next time, if the URL appears again in a future document, its tracking be automatically deactivated." label="Never tracked" name="never" value="3"/>
        <value desc="Consider this URL as an opt-out or unsubscription URL." label="Opt-out" name="optout" value="4"/>
        <value desc="Consider the URL is a mirror page URL." label="Mirror page" name="mirrorPage" value="5"/>
      </enumeration>
      <enumeration basetype="byte" default="yes" label="Include images in the email" name="multipartRelated">
        <value label="Do not embed in the email" name="no" value="0"/>
        <value label="Embed in the email" name="yes" value="1"/>
      </enumeration>
      <enumeration basetype="string" default="manual" label="Approval mode" name="validationMode">
        <value desc="Delivery will start only after a manual validation by a user." label="Manual" name="manual"/>
        <value desc="Delivery automatically starts if analysis does not generate warnings." label="Semi-automatic" name="secure"/>
        <value desc="Delivery automatically starts once analysis completed (even if it generates warnings)." label="Automatic" name="auto"/>
      </enumeration>
      <enumeration basetype="byte" default="normal" label="Priority" name="messagePriority">
        <value label="Very High" name="highest" value="32"/>
        <value label="High" name="high" value="20"/>
        <value label="Higher than normal" name="aboveNormal" value="15"/>
        <value label="Normal" name="normal" value="10"/>
        <value label="Low" name="belowNormal" value="5"/>
        <value label="Very Low" name="low" value="1"/>
      </enumeration>
      <enumeration basetype="string" default="preferences" label="Format choice" name="formatSelection">
        <value desc="Use recipient preferences" label="Recipient preferences" name="preferences"/>
        <value desc="Let recipient mail client choose the most appropriate format (multipart-alternative)" label="Multipart format" name="multipart"/>
        <value desc="Send all messages in text format." label="Text format" name="text"/>
      </enumeration>
      <enumeration basetype="byte" default="new" label="Status of images" name="imageState">
        <value desc="This image is not yet online (to send by default)" label="Not yet online" name="new" value="0"/>
        <value desc="This image is already online" label="Already online" name="onLine" value="1"/>
        <value desc="This image is not to be processed" label="Skipped (do not put online)" name="ignore" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="SIMSpecific" label="SMS mode" name="smsMode">
        <value desc="Immediate display. The message will be saved on the mobile phone." label="Flash" name="Immediate" value="0"/>
        <value desc="The message will be saved on the SIM card." label="Normal" name="SIMSpecific" value="1"/>
        <value desc="The message will be saved on the mobile." label="Saved on mobile" name="MobileSpecific" value="2"/>
        <value desc="The message will be saved on the terminal." label="Saved on terminal" name="TeminalSpecific" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="Normal" label="SMS priority" name="smsPriority">
        <value desc="The message is put at the end of the message queue." label="Normal" name="Normal" value="0"/>
        <value desc="The message is put at the end of the queue of the High priority messages. All messages of priority High are sent before the messages of priority Normal." label="High" name="Hight" value="1"/>
        <value desc="The message is put at the end of the queue of the Urgent priority messages. All messages of priority Urgent are sent before the messages of lower priority." label="Urgent" name="Urgent" value="2"/>
      </enumeration>
      <enumeration basetype="long" default="marketing" label="Communication type" name="smsAppType">
        <value label="Closed Group of Users" name="GFU" value="0"/>
        <value label="Delivery" name="Delivery" value="1"/>
        <value label="Direct Marketing" name="marketing" value="2"/>
        <value label="Mailing" name="mailing" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="sms" label="Mobile message type" name="mobileMsgType">
        <value label="SMS" name="sms" value="0"/>
        <value label="WAP Push" name="wapPush" value="1"/>
        <value label="MMS" name="mms" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="constant" label="Weight type" name="weightType">
        <value label="Constant" name="constant" value="0"/>
        <value label="Depends on the recipient" name="formula" value="1"/>
        <value label="Defined in each rule" name="rule" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="constant" label="Weight type" name="simuResponseType">
        <value label="Constant" name="constant" value="0"/>
        <value label="Depends on the recipient" name="formula" value="1"/>
      </enumeration>
      <enumeration basetype="string" default="Normal" label="Attached file type" name="attachmentType">
        <value desc="File name is specified when creating the delivery template" label="Constant file name" name="normal"/>
        <value desc="The content of the file is personalized and converted to PDF during the delivery of each message." label="Personalized PDF file" name="pdf"/>
        <value desc="The file name is computed during delivery analysis (it cannot depend on the recipient profile)." label="Computed during analysis" name="preparation"/>
        <value desc="File name is computed during delivery for each message (it can depend on the recipient profile)." label="Computed during delivery for each message" name="sending"/>
      </enumeration>
      <enumeration basetype="string" default="none" desc="Failures retrieval mode for external deliveries." label="Failures retrieval mode" name="feedbackMode">
        <value desc="Messages are considered sent after validation." label="Nothing retrieved" name="none"/>
        <value desc="A result file determines sent and failed messages." label="Result file" name="file"/>
      </enumeration>
      <enumeration basetype="string" default="normal" label="Formats for proof messages" name="fcpMailFormat">
        <value label="Single message (normal behavior)" name="normal"/>
        <value label="Send two messages (text and multipart-alternative)" name="textMultipart"/>
        <value label="Send three messages (text, HTML and multipart-alternative)" name="allFormats"/>
      </enumeration>
      <enumeration basetype="string" default="specificTarget" label="Formats for proof messages" name="fcpMode">
        <value desc="Definition of a specific proof target" label="Specific target" name="specificTarget"/>
        <value enabledIf="'$(entityPath)'='/delivery'" label="Substitution of the address" name="substituteAddress"/>
        <value label="Seed addresses" name="seedList"/>
        <value label="Specific target and Seed addresses" name="mixedMode"/>
      </enumeration>
      <enumeration basetype="string" default="default" desc="Mirror page management parameters" name="mirrorPagePolicy">
        <value desc="Generate the mirror page if a mirror link appears in the email content" name="default"/>
        <value desc="Force the generation of the mirror page" name="yes"/>
        <value desc="Do not generate the mirror page" name="no"/>
        <value desc="Generates a mirror page accessible using only the message identifier" name="fromMsgId"/>
      </enumeration>
      <enumeration basetype="byte" default="unknown" desc="Indicates of the delivery uses the mirror page" name="needMirrorPage">
        <value name="unknown" value="0"/>
        <value name="yes" value="1"/>
        <value name="no" value="2"/>
        <value name="fromMsgId" value="3"/>
      </enumeration>
      <enumeration basetype="byte" label="Update flags" name="dirtyFlags">
        <value label="Up to date" name="none" value="0"/>
        <value label="Tracking" name="tracking" value="1"/>
        <value label="Errors" name="errors" value="2"/>
        <value label="Reset tracking" name="resetTracking" value="4"/>
        <value label="Message counters" name="messageCounters" value="8"/>
      </enumeration>
      <enumeration basetype="byte" default="empty" label="URL flags" name="urlFlags">
        <value label="Empty" name="empty" value="0"/>
        <value label="Fixed label" name="fixedLabel" value="1"/>
        <value label="Fixed category" name="fixedCategory" value="2"/>
        <value label="Fixed type" name="fixedType" value="4"/>
      </enumeration>
      <enumeration basetype="long" default="utf8" label="Encoding" name="codepage">
        <value label="UTF-8" name="utf8" value="65001"/>
        <value label="Central Europe (1250)" name="latin2" value="1250"/>
        <value label="Cyrillic (1251)" name="cyrilic" value="1251"/>
        <value label="Latin 1 (1252)" name="latin1" value="1252"/>
        <value label="ISO Latin 9 (28605)" name="iso885915" value="28605"/>
        <value label="Greek (1253)" name="greek" value="1253"/>
        <value label="Turkish (1254)" name="turkish" value="1254"/>
        <value label="Hebrew (1255)" name="hebrew" value="1255"/>
        <value label="Arabic (1256)" name="arabic" value="1256"/>
        <value label="Baltic (1257)" name="baltic" value="1257"/>
        <value label="Vietnam (1258)" name="vietnam" value="1258"/>
        <value label="Thai (874)" name="thai" value="874"/>
        <value label="Japanese (Shift-JIS 932)" name="shiftjis" value="932"/>
        <value label="Japanese (ISO 2022)" name="iso2022" value="50220"/>
        <value label="Traditional Chinese (Big5 950)" name="big5" value="950"/>
        <value label="Simplified Chinese (GB2312)" name="gb2312" value="936"/>
        <value label="Korean (EUC-Korean 51949)" name="euckorean" value="51949"/>
      </enumeration>
      <enumeration basetype="byte" default="prepare" label="Execution type" name="launchType">
        <value label="Standard preparation" name="prepare" value="0"/>
        <value label="Proof preparation" name="FCP" value="1"/>
        <value label="Prepare and execute Proof" name="execFCP" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="default" label="Content editing mode" name="contentEditingMode">
        <value label="Default" name="default" value="0"/>
        <value label="DCE" name="dce" value="1"/>
        <value applicableIf="HasPackage('nms:aemIntegration')" label="AEM" name="aem" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="simple" name="paperContentType">
        <value desc="Simple content" img="xtk:dataTransfer/simple.png" label="Simple content" name="simple"/>
        <value desc="Multiple content" img="xtk:dataTransfer/batch.png" label="Multiple content" name="multiple"/>
      </enumeration>
      <enumeration basetype="string" default="print" name="compressMode">
        <value desc="75 DPI compression" label="Screen" name="screen"/>
        <value desc="300 DPI compression" label="Printing" name="print"/>
        <value desc="1200 DPI compression" label="Press" name="press"/>
      </enumeration>
      <enumeration basetype="string" default="bw" label="Color support" name="colorSupport">
        <value label="Black &amp; White" name="bw"/>
        <value label="Color" name="color"/>
      </enumeration>
      <enumeration basetype="string" default="recto" label="Double-sided" name="rectoVerso">
        <value label="Single-sided" name="recto"/>
        <value label="Double-sided" name="rectoverso"/>
      </enumeration>
      <enumeration basetype="string" default="C6SW" label="Envelop type" name="envelope">
        <value label="Auto-Detect format" name="AUTO"/>
        <value label="Large envelop; C4 format (332 x 230 mm)" name="C4"/>
        <value label="Small envelop; C6 format (229 x 114 mm) simple window" name="C6SW"/>
        <value label="Small envelop; C6 format (229 x 114 mm) double window" name="C6DW"/>
      </enumeration>
      <enumeration basetype="string" default="ownPage" label="Address position" name="addressPos">
        <value label="Add addresses on a dedicated page" name="ownPage"/>
        <value label="Add addresses on the document first page" name="firstPage"/>
      </enumeration>
      <enumeration basetype="string" default="letterPrio" label="Stamping category" name="priceCategory">
        <value label="Letter rate - first class" name="letterPrio"/>
        <value label="Bulk rate (economical)" name="ecoPli"/>
        <value label="Ecopli rate (bulk)" name="ecoPliBulk"/>
        <value label="Mechanized PostImpact rate; threshold 1 (C6 envelop)" name="postImpact1_C6"/>
        <value label="Mechanized PostImpact rate; threshold 2 (C6 envelop)" name="postImpact2_C6"/>
        <value label="Standard PostImpact rate; threshold 1 (C4 envelop)" name="postImpact1_C4"/>
        <value label="Standard PostImpact rate; threshold 2 (C4 envelop)" name="postImpact2_C4"/>
        <value label="Electronic Registered letter from La Poste (R1)" name="recom_R1"/>
      </enumeration>
      <enumeration basetype="byte" default="split" name="wavesMode">
        <value desc="Multiple waves of the same size." label="Waves" name="split" value="0"/>
        <value desc="Waves defined by a calendar." label="Calendar" name="calendar" value="1"/>
        <value desc="Average on a period." label="Averaged" name="smooth" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="segmentCodeType">
        <value desc="Do not force a segment code" label="None" name="none"/>
        <value desc="Use the fixed value specified in the target part" label="Fixed value" name="constant"/>
        <value desc="Use the computation expression specified in the target part" label="Computed value" name="calculated"/>
      </enumeration>
      <enumeration basetype="byte" default="statusWithLink" label="Type of Facebook content" name="fcbContentType">
        <value label="Status" name="status" value="1"/>
        <value label="Status with a link" name="statusWithLink" value="0"/>
        <value label="Status with a Youtube link" name="statusWithYoutubeLink" value="3"/>
        <value label="Photo album" name="photo" value="5"/>
      </enumeration>
      <element name="target">
        <attribute desc="Human serialization of the segmentation query" label="Target" name="serialization" type="string"/>
        <attribute advanced="true" default="false" desc="True if the target is not empty" label="Target is not empty" name="nonEmpty" type="boolean"/>
        <element label="Query Condition" name="targetPart" unbound="true">
          <element desc="Filtering condition for a target of type 'query'" name="where" unbound="true">
            <element aggregate="xtk:queryDef:where" name="where"/>
            <attribute expr="[../../../@filteringSchema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
            <attribute label="Filter name" name="filterName" type="string"/>
            <element desc="Context of the condition" label="Context" name="ctx" type="ANY"/>
          </element>
          <attribute desc="Condition label" label="Label" localizable="true" name="label" type="string"/>
          <attribute advanced="true" desc="label automatically computed based on the filter" label="Computed label" localizable="true" name="computedLabel" type="string"/>
          <attribute default="false" desc="Exclude recipients from this segment" label="Segments to exclude" name="exclusion" type="boolean"/>
          <attribute default="false" desc="Take in to account records flagged as deleted" name="ignoreDeleteStatus" type="boolean"/>
          <attribute enum="segmentCodeType" label="Segment code type" name="segmentCodeType" type="string"/>
          <attribute label="Segment code" length="16" name="segmentCodeVal" type="string"/>
          <attribute label="Query hint for Oracle" name="oracleHint" type="string"/>
          <element label="Segment code expression" name="segmentCodeExpr" type="CDATA"/>
          <element desc="ToolTip" label="Help" name="help" type="string"/>
        </element>
      </element>
      <element name="targetFile" template="xtk:common:fileToUpload">
        <attribute default="false" desc="If the delivery analysis is completed successfully, the document used as data source is deleted (used to make sure that a single file cannot be processed twice)." label="Delete after import" name="autoDelete" type="boolean"/>
      </element>
      <element desc="Configuration of image handling" label="Configuration of images" name="imageConfig">
        <attribute desc="Path to the source file to which images URL are relative" label="Source file path" name="startPath" type="string"/>
        <element desc="Configuration of image handling" label="Image" name="image" ordered="true" unbound="true">
          <key name="md5">
            <keyfield xpath="@md5"/>
          </key>
          <attribute desc="Image source (before patch)." label="Source" name="source" type="string"/>
          <attribute default="false" desc="The image URL is relative" label="Relative" name="isRelative" type="boolean"/>
          <attribute desc="MD5 code of the image content (not its name)" label="MD5" length="32" name="md5" type="string"/>
          <attribute desc="Defines the status of the image" enum="imageState" label="Status of image" name="state" type="byte"/>
          <attribute desc="Include the image in the email" enum="multipartRelated" label="Include image" name="multipartRelated" type="byte"/>
          <attribute default="false" desc="Do not replace this source URL with the new one" label="Do not replace" name="doNotReplace" type="boolean"/>
          <element desc="alternative source addresses found in the HTML" label="Alternative source" name="alternativeSrc" unbound="true">
            <key name="source">
              <keyfield xpath="@source"/>
            </key>
            <attribute desc="Alternative image source" label="Source" name="source" type="string"/>
            <attribute default="false" desc="Do not replace this source URL with the new one" label="Do not replace" name="doNotReplace" type="boolean"/>
          </element>
        </element>
      </element>
      <element desc="Tracking URLs configuration for one of the content of the scenario" label="Configuration of URLs" name="urlConfig">
        <element desc="Configuration of the URL tracking." label="URL" name="url" ordered="true" unbound="true">
          <key name="urlSource">
            <keyfield xpath="@source"/>
            <keyfield xpath="@occurrence"/>
          </key>
          <key name="tagId">
            <keyfield xpath="@tagId"/>
          </key>
          <attribute desc="Identifier of the URL in the database for the delivery action." label="Identifier" name="urlId" type="long"/>
          <attribute defOnDuplicate="true" desc="URL tag for the on-going job." label="Url identifier" name="tagId" type="string"/>
          <attribute desc="Identifier of URL in database." label="Template" name="urlInfoId" type="long"/>
          <attribute desc="pURL identifier which matches the current URL." label="pURL ID" name="purlId" type="long"/>
          <attribute desc="Original source text of URL (before patching)." label="Source" name="source" type="string"/>
          <attribute desc="URL occurrence index in the content (first is 1)." label="Occurrence index" name="occurrence" type="short"/>
          <attribute desc="Label associated with URL in reports." label="Label" localizable="true" name="label" type="string"/>
          <attribute desc="Label suggested by wizard." label="Automatic label" localizable="true" name="guessedLabel" type="string"/>
          <attribute desc="Category of the URL" label="Category" localizable="true" name="category" type="string" userEnum="urlCategory"/>
          <attribute desc="URL containing personalization parameters." label="URL with parameters" name="withParams" type="boolean"/>
          <attribute desc="URL not referenced in database." label="New URL" name="newUrl" type="boolean"/>
          <attribute desc="URL parameters have been modified by the user in the wizard." label="Modified URL" name="modified" type="boolean"/>
          <attribute desc="Defines how the tracking must be done for this URL." enum="trackingType" label="Tracking type" name="trackingType" type="byte"/>
          <attribute desc="Additional information on the origin of known information about the URL." enum="urlFlags" label="Additional information" name="flags" type="byte"/>
          <attribute desc="Offer ID that matches the current URL." label="Offer ID" name="offerId" type="long"/>
        </element>
      </element>
      <element desc="Definition of a content for a given message format" label="Content" name="contentDef">
        <attribute advanced="true" enum="trackingType" expr="''" label="Default URL tracking" name="trackingType" type="byte" xml="true"/>
        <attribute advanced="true" enum="nms:trackingUrlInfo:urlType" expr="''" label="Default URL types" name="urlType" type="byte" xml="true"/>
        <element desc="Content associated with this format." label="Content" localizable="true" name="source" type="CDATA"/>
        <element desc="Name of the file used the last time this content was loaded." label="File" name="sourceFile" type="string"/>
        <element label="Configuration of URLs of the content" name="urlConfig" ref="urlConfig"/>
        <element label="Configuration of images referenced in the content" name="imageConfig" ref="imageConfig"/>
      </element>
      <element label="Personalization fields definition" name="customization">
        <element desc="List of personalization fields to load" name="select" ref="xtk:queryDef:select"/>
        <element desc="List of personalization fields automatically added since referenced in contents" name="selectAuto" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" ref="xtk:queryDef:conditionLink" unbound="true"/>
      </element>
      <element label="Provisional planning" name="forecastDef">
        <attribute desc="Use the formulas to estimate answers" enum="nms:delivery:simuResponseType" label="Parameter calculation mode" name="simuResponseType" type="byte"/>
        <attribute label="Use a margin rate instead of a unit margin" name="simuMarginType" type="boolean"/>
        <attribute label="Estimated response rate as a %" name="simuResponseRate" type="double"/>
        <attribute desc="Estimated revenue per response" label="Estimated revenue" name="simuRevenue" type="double"/>
        <attribute label="Estimated margin" name="simuMargin" type="double"/>
        <element desc="Formula of the response rate estimated as a %" label="Estimated response rate as a %" name="simuResponseRateFormula" type="string"/>
        <element desc="Estimated revenue per response" label="Estimated revenue" name="simuRevenueFormula" type="string"/>
        <element label="Estimated margin" name="simuMarginFormula" type="string"/>
      </element>
      <element autopk="true" enumImage="@messageType" folderLink="folder" folderModel="nmsDelivery" folderProcess="folderProcess" img="nms:campaign.png" name="delivery" pkgAdmin="@isModel = 1 AND @id != 0" sqltable="NmsDelivery" template="xtk:job">
        <compute-string expr="@label+' ('+@internalName+')'"/>
        <dbindex name="state">
          <keyfield xpath="@state"/>
        </dbindex>
        <dbindex name="lastModifiedFlat">
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <dbindex name="lastModified">
          <keyfield xpath="@folder-id"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <dbindex name="deliveryCode">
          <keyfield xpath="@deliveryCode"/>
        </dbindex>
        <dbindex name="midModified">
          <keyfield xpath="@deliveryMode"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <attribute default="GetOption('XtkInstancePrefix')+'DM'+CounterValue('nmsDeliveryModel')" name="internalName"/>
        <attribute desc="Start date of the delivery analysis (or of the last provisional analysis)." label="Analysis start" name="startDate"/>
        <attribute desc="End date of the delivery analysis (or of the last provisional analysis)." label="Analysis completed" name="endDate"/>
        <attribute advanced="true" defOnDuplicate="true" label="Content modification date" name="contentModTime" type="datetime"/>
        <attribute defOnDuplicate="true" label="Application built-in scenario" name="builtIn"/>
        <attribute dbEnum="deliveryNature" desc="Delivery nature" label="Nature" length="64" name="nature" type="string"/>
        <attribute advanced="true" label="Analysis status" name="status"/>
        <attribute advanced="true" default="'delivery'" name="jobType"/>
        <attribute desc="This record is a delivery template." label="Template" name="isModel"/>
        <element desc="Logs of the delivery." label="Logs" name="log"/>
        <attribute expr="'prepareda'" name="module" type="string"/>
        <attribute _operation="delete" name="doNotPersist"/>
        <attribute _operation="delete" name="img"/>
        <attribute _operation="delete" name="form"/>
        <attribute _operation="delete" name="editForm"/>
        <attribute advanced="true" label="Use the new content editor ('DCE')" name="useDce" type="boolean"/>
        <attribute advanced="true" label="Use AEM as content editor or as an asset library" name="useAEM" type="boolean" xml="true"/>
        <attribute advanced="true" enum="contentEditingMode" expr="Iif(@useDce, 1, Iif(HasPackage('nms:aemIntegration') and @useAEM, 2, 0))" label="Content editing mode" name="contentEditingMode" type="byte" xml="true"/>
        <attribute advanced="true" defOnDuplicate="true" enum="analysisStep" label="Current analysis step" name="analysisStep" type="byte"/>
        <element default="LoadInstance(GetOption('NmsBroadcast_DefaultProvider'))" desc="Routing outsourcer used for delivery" label="Routing" name="deliveryProvider" required="true" target="nms:extAccount" type="link"/>
        <attribute default="[/delivery/deliveryProvider/@messageType]" desc="Type of message to send." enum="messageType" label="Channel" name="messageType" type="byte"/>
        <attribute default="[/delivery/deliveryProvider/@deliveryMode]" desc="Mode used for the delivery of messages." enum="deliveryMode" label="Mode" name="deliveryMode" type="byte"/>
        <attribute defOnDuplicate="true" desc="Delivery status" enum="deliveryState" label="Status" name="state" type="byte"/>
        <attribute defOnDuplicate="true" desc="The delivery is a proof delivery." label="Send a Proof" name="FCP" type="boolean"/>
        <attribute advanced="true" desc="The analysis of the delivery will create a proof for this delivery." enum="launchType" label="Send a proof" name="launchFCP" type="byte" xml="true"/>
        <attribute advanced="true" desc="The delivery has been submitted by a remote platform in mid-sourcing mode." label="Mid-sourcing relay" name="midSourcing" type="boolean"/>
        <attribute advanced="true" defOnDuplicate="true" desc="Submission date on the mid-sourcing server." label="Mid-sourcing submission date" name="midSubmitDate" type="datetime" xml="true"/>
        <attribute advanced="true" desc="Identifier of the delivery in the marketing database (not equal to the internal identifier only in mid-sourcing mode)." expr="Iif(@midSourcing!=0, [properties/@midRemoteId], @id)" name="idMarketing" type="long"/>
        <attribute advanced="true" desc="Delivery identifier for tracking (hexadecimal)" expr="ToHex(@idMarketing)" name="idTracking" type="string" xml="true"/>
        <attribute desc="Priority of messages in the delivery server queue." enum="messagePriority" label="Delivery priority" name="priority" type="byte"/>
        <attribute desc="External identifier for the delivery." label="Delivery code" length="36" name="deliveryCode" type="string"/>
        <attribute advanced="true" expr="Iif([properties/@midAccountUsedName]!='' and [@mapping-id]!=0, GetMirrorURL([properties/@midAccountUsedName]), Iif([deliveryProvider/@mirrorURL]!='', [deliveryProvider/@mirrorURL], GetOption('NmsServer_MirrorPageUrl')))" name="mirrorURL" type="string" xml="true"/>
        <element label="Provisional planning" name="forecast" template="nms:delivery:forecastDef" xml="true">
          <attribute enum="nms:delivery:weightType" label="Weight type" name="weightType" sql="true" type="byte" xml="false"/>
          <attribute default="5" label="Delivery weight" name="weight" sql="true" type="long" xml="false"/>
          <element advanced="true" default="GetOption('NmsForecast_MsgWeightFormula')" label="Message weight computation formula" name="weightFormula" type="string"/>
        </element>
        <element label="Capacity" name="volume">
          <attribute default="100" desc="Handled call rate for telephone channel (0 to 100%)" label="Handled call rate (in %)" name="rate" type="double"/>
          <attribute default="1" desc="Processing time per message for the telephone channel" label="Handled call duration for telephone channel" name="duration" type="double"/>
          <element label="Channel capacity" name="rule" target="nms:typologyRule" type="link" xml="true"/>
          <element label="Recipient significance computation formula" name="weightFormula" type="string" xml="true"/>
        </element>
        <element label="Filtering typologies" name="typologyFilter" ordered="true" unbound="true" xml="true">
          <element label="Typology" name="typology" target="nms:typology" type="link"/>
        </element>
        <element label="Filtering rules" name="ruleFilter" ordered="true" unbound="true" xml="true">
          <element label="Typology rule" name="rule" target="nms:typologyRule" type="link"/>
        </element>
        <element label="Delivery scheduling" name="scheduling">
          <attribute advanced="true" desc="Approval mode" enum="nms:delivery:validationMode" label="Approval mode" length="16" name="validationMode" type="string"/>
          <attribute desc="Schedule delivery start." label="Schedule delivery start" name="delayed" type="boolean"/>
          <attribute defOnDuplicate="true" desc="Start date if action is deferred or delayed, validity date otherwise." label="Contact date" name="contactDate" type="datetime"/>
          <attribute defOnDuplicate="true" default="iif([/@isModel], '', CurrentTimeZone())" name="contactDateTimeZone" template="xtk:common:timezone" xml="true"/>
          <attribute defOnDuplicate="true" label="Validity limit" name="validityDate" type="datetime"></attribute>
          <attribute defOnDuplicate="true" desc="Limit validity date for delivery online resources (mirror page, images...)" label="Validity limit date for resources" name="webValidityDate" type="datetime"/>
          <attribute advanced="true" defOnDuplicate="true" default="false" label="Online resources purged" name="webResPurged" type="boolean"/>
          <attribute defOnDuplicate="true" desc="Extraction request date" label="Extraction request" name="extraction" type="datetime"/>
          <attribute defOnDuplicate="true" default="0" desc="Maximum number of seconds before forced extraction" label="Extraction wait period" name="delayExtraction" type="timespan"/>
          <attribute defOnDuplicate="true" desc="Extraction date of the file" label="Extraction date" name="extracted" type="datetime"/>
          <attribute advanced="true" desc="Affinity to IP addresses to use during email delivery." label="IP affinity" length="64" name="IPAffinity" type="string"/>
          <element label="Waves management" name="waves" xml="true">
            <attribute desc="Send using multiple waves" label="Enabled" name="enabled" type="boolean"/>
            <attribute desc="Waves type" enum="nms:delivery:wavesMode" label="Mode" name="mode" type="byte"/>
            <attribute default="'20%'" desc="Number of messages in each wave." label="Waves size" length="10" name="splitSize" type="string"/>
            <attribute default="86400" desc="Period between two waves" label="Period" name="splitDelay" type="timespan"/>
            <element label="Calendar" name="calendar">
              <element name="calendarItem" ordered="true" unbound="true">
                <attribute desc="Delay between the start of the delivery and the start of this wave." label="Start" name="start" type="timespan"/>
                <attribute desc="Wave size." label="Size" length="10" name="size" type="string"/>
              </element>
            </element>
          </element>
        </element>
        <element advanced="true" label="Approval" name="validation">
          <attribute desc="Selected preparation mode" enum="nms:common:sandboxMode" label="Preparation mode" name="sandboxMode" sql="true" type="byte"/>
        </element>
        <element label="Delivery execution parameters" name="execution">
          <attribute defOnDuplicate="true" desc="Number of retries performed (or in progress)" label="Number of retries" name="retry" type="short"/>
          <attribute default="GetOption('NmsEmail_RetryCount')" desc="Maximum number of retries for the delivery." label="Max. number of retries" name="maxRetry" type="short"/>
          <attribute default="GetOption('NmsEmail_RetryPeriod')" desc="Period between two retries (in seconds)." label="Period of retries" name="retryPeriod" type="timespan"/>
          <attribute defOnDuplicate="true" desc="Start date of the next retry (or of the current retry)" label="Next retry" name="nextPassDate" type="datetime"/>
          <attribute defOnDuplicate="true" desc="Start date of delivery action" label="Start date" name="broadStartDate" type="datetime"/>
          <attribute defOnDuplicate="true" desc="End date of delivery" label="End date" name="broadEndDate" type="datetime"/>
          <attribute defOnDuplicate="true" desc="Start date of the last pass" label="Pass start" name="passStartDate" type="datetime"/>
        </element>
        <element default="DefaultInstance('defaultTypology')" label="Typology" name="typology" required="true" revDesc="Deliveries associated with this typology" revLabel="Deliveries" target="nms:typology" type="link"/>
        <element default="LoadInstance('mapRecipient')" label="Target mapping" name="mapping" revIntegrity="define" revLabel="Deliveries" target="nms:deliveryMapping" type="link"/>
        <element label="Delivery template parameters" name="scenario" xml="true">
          <attribute label="Compute the label during delivery analysis" name="useLabelScript" type="boolean"/>
          <element desc="Delivery label computation script" label="Label computation script" name="labelScript" required="true" type="string"></element>
          <attribute label="Compute the execution folder during the delivery analysis" name="useFolderScript" type="boolean"/>
          <element desc="Calculation script for delivery execution folder" label="Folder calculation script" name="folderScript" required="true" type="string"></element>
          <attribute label="Compute the delivery code during analysis" name="useDeliveryCodeScript" type="boolean"/>
          <element label="Delivery code computation script" name="deliveryCodeScript" required="true" type="string"/>
          <attribute advanced="true" desc="Used to explicitly set limit dates for delivery, resource validity and tracking, instead of associated durations." label="Explicitly set validity dates" name="setDirectDates" type="boolean"/>
          <attribute default="GetOption('NmsBroadcast_MsgValidityDuration')" desc="Maximum delivery duration starting at delivery validation." label="Length of delivery" name="validityDuration" type="timespan"/>
          <attribute default="GetOption('NmsBroadcast_MsgWebValidityDuration')" desc="Validity duration for delivery resources put online, starting from the delivery validation." label="Resources validity limit" name="webValidityDuration" type="timespan"/>
          <attribute desc="Used to set the tracking validity limit date if it is not specified." label="Tracking validity limit" name="trackingDuration" type="timespan"/>
        </element>
        <element advanced="true" name="fcpParameters" xml="true">
          <attribute desc="Sequence number of Proof" label="Sequence number" name="FCPNum" type="long"/>
          <attribute desc="Proof-target creation mode." enum="fcpMode" label="Proof mode" name="fcpMode" type="string"/>
          <attribute desc="Prefix to add to the proof label and to the email subject" label="Label prefix" name="labelPrefix" translatedDefault="'Proof'" type="string"/>
          <attribute enum="fcpMailFormat" label="Formats for proof messages" name="fcpMailFormat" type="string"/>
          <attribute default="true" desc="Add format in the email subject prefix" label="Add format in subject" name="addFormatInPrefix" type="boolean"/>
          <attribute default="false" desc="Otherwise, the delivery code of the proof remains empty" label="Keep the delivery code for the proof" name="keepDeliveryCode" type="boolean"/>
          <attribute default="true" desc="Keep duplicate addresses (and recipients) in the proof" label="Keep doubles" name="ignoreDeduplicate" type="boolean"/>
          <attribute default="true" desc="Keep blacklisted addresses in the proof" label="Keep blacklisted addresses" name="ignoreBlacklist" type="boolean"/>
          <attribute default="false" desc="Keep addresses in quarantine in the proof" label="Keep quarantined addresses" name="ignoreQuarantaine" type="boolean"/>
          <attribute default="false" desc="Use a specific output file for the proof" label="Specific output file" name="useSpecificOutputFile" type="boolean"/>
          <element label="Parameters of the specific output file" name="fcpOutput">
            <attribute desc="Download the generated file after the analysis of the delivery (otherwise generates it on the server)" label="Download the file generated from the server after the export." name="downloadDestFile" type="boolean"/>
            <attribute desc="Name of the file exported on the server or downloaded on the client." label="Output file" name="fileName" required="true" type="string"/>
            <element desc="Used to define the name on the server of the output file generated by the delivery." label="File name computation script" name="outputScript" required="true" type="CDATA"/>
          </element>
          <element desc="List of addresses for proof in substitution mode" label="Proof addresses" name="substitution" unbound="true">
            <attribute label="Substitution address" name="address" required="true" type="string" userEnum="fcpAddress"/>
            <attribute label="Description" name="desc" type="string"/>
            <element name="profile">
              <element name="rcp">
                <attribute label="Profile identifier" name="key" type="string"/>
                <attribute label="Profile to use" name="cs" translatedDefault="'Random'" type="string"/>
              </element>
            </element>
          </element>
          <element name="seedList" xml="true">
            <element desc="Seed list selection condition" name="where" template="xtk:queryDef:where">
              <attribute expr="'nms:seedMember'" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
            </element>
            <attribute name="humanCond" type="string"/>
          </element>
        </element>
        <element defOnDuplicate="true" label="Parent delivery" name="proofedDelivery" revIntegrity="own" revLabel="Proofs" revLink="proof" revPkgStatus="never" target="nms:delivery" type="link"/>
        <element label="Email header parameters" name="mailParameters" xml="true">
          <element desc="Message subject" label="Subject" localizable="true" name="subject" type="CDATA"/>
          <element default="GetOption('NmsEmail_FromName')" desc="Sender name" label="From" localizable="true" name="senderName" type="CDATA"/>
          <element dataPolicy="emailOrScript" default="GetOption('NmsEmail_DefaultFromAddr')" desc="Email address of sender." label="Sender address" name="senderAddress" required="true" type="CDATA"/>
          <element dataPolicy="emailOrScript" default="GetOption('NmsEmail_DefaultReplyToAddr')" desc="Reply-to email address. If not defined, the sender address will be used as reply-to address." label="Reply address" name="replyAddress" required="true" type="CDATA"/>
          <element default="GetOption('NmsEmail_ReplyToName')" label="Reply address text" localizable="true" name="replyName" type="CDATA"/>
          <element dataPolicy="emailOrScript" desc="Email address used to receive errors (mailer daemon)." label="Errors-to address" name="errorAddress" type="CDATA"/>
          <element dataPolicy="emailOrScript" desc="Address used by the inbound mail management module in order to transfer the bounces that could not been automatically processed. If not defined, the reply-to address will be used as bounce transfer address." label="Bounce address" name="bounceAddress" type="CDATA"/>
          <element advanced="true" desc="Additional SMTP headers" label="Headers" name="headers" type="CDATA"/>
          <attribute default="true" desc="Use the default error address defined for the platform" label="Default error address" name="useDefaultErrorAddress" type="boolean"/>
          <attribute desc="Mirror page management parameters." enum="nms:delivery:mirrorPagePolicy" label="Mirror page management" name="mirrorPagePolicy" type="string"/>
          <attribute defOnDuplicate="true" desc="Technical parameter indicating if the delivery uses the mirror page." enum="needMirrorPage" label="Mirror page usage" name="needMirrorPage" type="byte" xml="false"/>
        </element>
        <element label="SMS parameters" name="smsParameters" xml="true">
          <attribute desc="Transmission and storage mode of SMS on mobile terminal." enum="smsMode" label="Transmission mode" name="smsMode" type="byte"/>
          <attribute default="GetOption('NmsSMS_Priority')" desc="Information transmitted to the SMS gateway to indicate the message priority." enum="smsPriority" label="Priority" name="smsPriority" type="byte"/>
          <attribute enum="smsAppType" label="Communication type" name="smsAppType" type="long"/>
          <attribute enum="mobileMsgType" label="Message type" name="mobileMsgType" type="byte"/>
          <attribute desc="Maximum number of SMS messages chained together per message (0=default, 1 for SMS and 2 for WAP Push)." label="Maximum number of SMSs per message" name="maxSmsPerMessage" type="byte"/>
          <attribute label="Sender address" name="sourceAddress" type="string"/>
          <attribute desc="Necessary for Verizon and T-Mobile" label="mBlox service ID" name="mbloxServiceId" type="string"/>
          <attribute desc="Indicates which application service can be linked to SMS" label="Service type" length="6" name="serviceType" type="string"/>
          <element advanced="true" label="SMS content" localizable="true" name="smsContent" type="CDATA"/>
        </element>
        <element label="Direct mail parameters" name="paperParameters" xml="true">
          <element desc="Address is required when using Electronic Registered letters" name="senderAddress" template="nms:common:postalAddress">
            <attribute default="GetOption('NmsPaper_SenderLine1')" name="line1"/>
            <attribute default="GetOption('NmsPaper_SenderLine2')" name="line2"/>
            <attribute default="GetOption('NmsPaper_SenderLine3')" name="line3"/>
            <attribute default="GetOption('NmsPaper_SenderLine4')" name="line4"/>
            <attribute default="GetOption('NmsPaper_SenderLine5')" name="line5"/>
            <attribute default="GetOption('NmsPaper_SenderLine6')" name="line6"/>
            <attribute default="GetOption('NmsPaper_SenderLine7')" name="line7"/>
            <attribute _operation="delete" name="addrDefined"/>
            <attribute _operation="delete" name="addrQuality"/>
            <attribute _operation="delete" name="addrLastCheck"/>
            <attribute _operation="delete" name="addrErrorCount"/>
          </element>
          <attribute enum="colorSupport" label="Color support" name="colorSupport"/>
          <attribute enum="rectoVerso" label="Double-sided" name="rectoVerso"/>
          <attribute enum="envelope" label="Envelop type" name="envelope"/>
          <attribute enum="addressPos" label="Address position" name="addressPos"/>
          <attribute desc="Print your internal message identifier above the sender address" label="Print the internal reference" name="printInternalRef" type="boolean"/>
          <attribute label="Electronic management of undeliverables" name="handleNPAI" type="boolean"/>
          <attribute enum="priceCategory" label="Stamping category" name="priceCategory"/>
          <attribute desc="Acknowledgement" label="Ack" name="AR" type="boolean"/>
          <attribute desc="Email address to use for the electronic acknowledgement" label="Email for acknowledgements" name="emailAR"/>
        </element>
        <element label="Delivery target population" name="targets" xml="true">
          <attribute desc="Selection mode of recipients" enum="targetMode" label="Target Type" name="targetMode" pkgStatus="always" type="byte"/>
          <attribute default="GetOption('NmsBroadcast_RemoveDuplicatesRecipients')" desc="Exclude duplicate addresses during delivery" label="Deduplicate on address" name="deduplicate" type="boolean"/>
          <attribute advanced="true" default="false" desc="Use to prevent deduplication of recipients belonging to multiple target elements." label="Keep duplicate records (same identifier)" name="noRcpIdDedup" type="boolean"/>
          <attribute default="GetOption('NmsBroadcast_RemoveBlackList')" desc="Exclude recipients who no longer want to be contacted (blacklist)." label="Exclude blacklisted recipients" name="useBlackList" type="boolean"/>
          <attribute default="1" desc="Do not send any message to recipients which address has been quarantined." label="Exclude quarantined recipients" name="useQuarantine" type="boolean"/>
          <attribute default="3" desc="Maximum number of consecutive errors on the address to perform the delivery." label="Maximum number of consecutive errors" name="maxErrorCount" type="long"/>
          <attribute default="1" desc="Do not deliver to recipients with low address-quality ratings." label="Exclude bad-quality addresses" name="useQuality" type="boolean"/>
          <attribute default="3" desc="Minimum quality rating required to send to an address." enum="nms:common:addressQuality" label="Requisite quality rating" name="qualityRequired" type="long"/>
          <attribute default="true" desc="Leave recipients with unqualified postal addresses in the target." label="Allow unqualified addresses" name="allowUnchecked" type="boolean"/>
          <attribute desc="Limit number of recipients for this delivery action" label="Limit delivery" name="useDeliveryLimit" type="boolean"/>
          <attribute desc="Maximum number of messages to send for this delivery" label="Limit delivery to" name="deliveryLimit" type="long"/>
          <attribute desc="Automatically include recipients from the proof in the main target" label="Include proof target in the main target" name="addProofInTarget" type="boolean"/>
          <attribute desc="Do not create delivery logs for recipients ignored during the analysis phase (blacklists, quarantines, etc.)" label="Do not create delivery logs for ignored messages" name="skipIgnoredLogs" type="boolean"/>
          <attribute applicableIf="HasPackage('nms:coreInteraction')" default="0" desc="Don't send messages to recipients non-eligible to the offers from the delivery outline or for which the offer engine has not generated the expected number of propositions." label="Exclude non-eligible recipients" name="excludeOnMissingOffer" type="boolean"/>
          <attribute applicableIf="HasPackage('nms:coreInteraction') OR HasPackage('nms:midReceiver')" label="Do not display anything if no offers are selected." name="emptyReprForMissingOffer" type="boolean"/>
          <attribute advanced="true" desc="Expression to sort the messages to send; based on the tmpBroadcastXxx working schema. This isn't the message delivery sequence." label="Message preparation sequence" name="orderByExpr"/>
          <attribute advanced="true" expr="[../mapping/@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          <element label="Delivery target population" name="deliveryTarget" ref="target"/>
          <element label="Proof target" name="proofTarget" ref="target"/>
          <attribute desc="Overrides the mapping computation formula." label="External identifier" name="externalId" type="string"/>
          <element label="Format of the file associated with the delivery target" name="fileFormat" ref="xtk:dataTransfer:dataTransfer/dataTransferStep"/>
          <element label="Delivery target population" name="deliveryFile" ref="targetFile"/>
          <element label="Proof target" name="proofFile" ref="targetFile"/>
          <attribute default="'__db__'" desc="Field containing the address of the recipient." label="Address field" name="addressField" required="true" type="string"/>
          <attribute default="'__db__'" desc="Field containing an external identifier of the recipient." label="External identifier field" name="externalIdField" type="string"/>
          <attribute default="'__db__'" desc="Field containing the segment code of the recipient." label="Segment code field" name="segmentCodeField" type="string"/>
          <attribute default="'__db__'" desc="Field specifying if the recipient is blacklisted." label="Blacklist field" name="blackListField" type="string"/>
          <attribute default="'__db__'" desc="Field containing the email format to use for the recipient." label="Format field" name="formatField" type="string"/>
          <element label="Fields from the postal address" name="postalAddress">
            <attribute default="'__db__'" desc="Field containing the first line of the postal address." label="Line 1" name="line1Field" required="true" type="string"/>
            <attribute default="'__db__'" desc="Field containing the second line of the postal address." label="Line 2" name="line2Field" required="true" type="string"/>
            <attribute default="'__db__'" desc="Field containing the third line of the postal address." label="Line 3" name="line3Field" required="true" type="string"/>
            <attribute default="'__db__'" desc="Field containing the fourth line of the postal address." label="Line 4" name="line4Field" required="true" type="string"/>
            <attribute default="'__db__'" desc="Field containing the fifth line of the postal address." label="Line 5" name="line5Field" required="true" type="string"/>
            <attribute default="'__db__'" desc="Field containing the sixth line of the postal address." label="Line 6" name="line6Field" required="true" type="string"/>
            <attribute default="'__db__'" desc="Field containing the seventh line of the postal address." label="Line 7" name="line7Field" required="true" type="string"/>
            <attribute default="'__none__'" desc="Field indicating whether the postal address is populated." label="Address specified" name="addrDefinedField" type="string"/>
            <attribute default="'__none__'" desc="Field containing the address quality rating." label="Quality rating" name="addrQualityField" type="string"/>
            <attribute default="'__none__'" desc="Field containing the last qualification of the address." label="Last qualification" name="addrLastCheckField" type="string"/>
            <attribute default="'__none__'" desc="Field containing the number of consecutive errors when sending to this address." label="Number of errors" name="addrErrorCountField" type="string"/>
          </element>
          <attribute default="false" desc="Do not import the recipients into the database" label="No reconciliation" name="noReconciliation" type="boolean"/>
          <attribute default="false" label="Delivery from an external source" name="fromExternalSource" type="boolean"/>
          <element label="Content of the external source" name="externalSource" type="CDATA"/>
          <attribute desc="Address list of message recipients. The addresses must be separated by a semi-column ';'." label="Recipients" name="recipientList" type="string"/>
        </element>
        <attribute advanced="true" applicableIf="HasPackage('nms:coreInteraction')" defOnDuplicate="true" default="false" label="Use the offers associated with the target" name="useTargetOffers" type="boolean" xml="true"/>
        <element applicableIf="HasPackage('nms:coreInteraction')" label="Offer space" name="offerSpace" target="nms:offerSpace" type="link"/>
        <element applicableIf="HasPackage('nms:coreInteraction')" label="Category" name="offerCategory" target="nms:offerCategory" type="link"/>
        <element applicableIf="HasPackage('nms:coreInteraction')" label="Anonymous category" name="offerAnonymousCategory" target="nms:offerCategory" type="link"/>
        <attribute applicableIf="HasPackage('nms:coreInteraction')" desc="Comma-separated list of selected themes." label="Themes" length="64" name="offerThemes" type="string" xml="true"/>
        <attribute applicableIf="HasPackage('nms:coreInteraction')" default="1" label="Number of propositions per message" name="maxPropositionCount" type="long" xml="true"/>
        <element applicableIf="HasPackage('crm:lead')" label="Landing page" name="landingPage" target="crm:landingPage" type="link"/>
        <element applicableIf="HasPackage('nms:aemIntegration')" label="Parameters for remote content" name="remoteContent" xml="true">
          <attribute label="Path" name="remotePath" type="string"/>
          <attribute label="Label" name="remoteLabel" type="string"/>
          <attribute label="Last synchronized" name="lastSync" type="datetime"/>
          <attribute default="false" label="Content approved" name="remoteValidation" type="boolean"/>
        </element>
        <element applicableIf="HasPackage('nms:aemIntegration')" label="AEM account" name="cmsAccount" target="nms:extAccount" type="link">
          <sysFilter>
            <condition expr="EVal([aemInstance/@type], 'aem')"/>
          </sysFilter>
        </element>
        <element label="Content" name="content" xml="true">
          <attribute desc="Message format selection method" enum="formatSelection" label="Format choice" name="formatSelection" type="string"/>
          <attribute default="false" desc="Compressing HTML documents can reduce the size of sent messages and reduce the time required for delivery" label="HTML compression" name="htmlCompression" type="boolean"/>
          <attribute default="false" desc="Ignore personalization scripts when delivering." label="Ignore scripts" name="ignoreScripts" type="boolean"/>
          <element label="HTML content" name="html" ref="contentDef"/>
          <element label="Text content" name="text" ref="contentDef"/>
          <element label="MMS content" name="mms" ref="contentDef"/>
          <element label="SMS content" name="sms" ref="contentDef"/>
          <element default="0" label="iOS content (alert style)" name="iosNotifType" ref="contentDef"/>
          <element label="iOS content (badge)" name="iosBadge" ref="contentDef"/>
          <element label="iOS content (sound)" name="iosSound" ref="contentDef"/>
          <element label="iOS content (message)" name="iosMessage" ref="contentDef"/>
          <element label="iOS content (hide action button)" name="iosHideActionBtn" ref="contentDef"/>
          <element advanced="true" label="iOS content (checking and loading iOS push settings)" name="iosCheckParams" ref="contentDef"/>
          <element label="iOS content (personalized notification fields)" name="iosCustomFields" template="contentDef">
            <element name="source" type="ANY"/>
          </element>
          <element label="iOS content (sounds available in the selected application)" name="iosAvailableSounds" template="contentDef">
            <element name="source" type="ANY"/>
          </element>
          <element label="Android content (message)" name="androidMessage" ref="contentDef"/>
          <element label="Android content (linked service ID)" name="androidService" ref="contentDef"/>
          <element advanced="true" label="Android content (checking and loading Android push settings)" name="androidCheckParams" ref="contentDef"/>
          <element label="Android content (personalized notification fields)" name="androidCustomFields" template="contentDef">
            <element name="source" type="ANY"/>
          </element>
          <element label="Android content (collapse key)" name="androidCollapseKey" ref="contentDef"/>
          <element label="Android content (sounds available in the selected application)" name="androidAvailableSounds" template="contentDef">
            <element name="source" type="ANY"/>
          </element>
          <attribute enum="fcbContentType" label="Type of Facebook content" name="fcbContentType" type="byte"/>
          <element label="Facebook content (type)" name="facebookContentType" ref="contentDef"/>
          <element label="Facebook content (message)" name="facebookMessage" template="contentDef">
            <attribute expr="EVal('nms:delivery:contentDef/@trackingType', 'no')" name="trackingType" xml="true"/>
          </element>
          <element label="Facebook content (http link)" name="facebookLink" template="contentDef">
            <attribute expr="EVal('nms:delivery:contentDef/@urlType', 'facebookLink')" name="urlType" xml="true"/>
          </element>
          <element label="Facebook content (image link)" name="facebookPicture" template="contentDef">
            <attribute expr="EVal('nms:delivery:contentDef/@trackingType', 'no')" name="trackingType" xml="true"/>
          </element>
          <element label="Facebook content (name)" name="facebookName" ref="contentDef"/>
          <element label="Facebook content (title)" name="facebookCaption" ref="contentDef"/>
          <element label="Facebook content (description)" name="facebookDescription" template="contentDef">
            <attribute expr="EVal('nms:delivery:contentDef/@trackingType', 'no')" name="trackingType" xml="true"/>
          </element>
          <element label="Facebook content (video code)" name="facebookVideoCode" ref="contentDef"/>
          <element label="Facebook content (album name)" name="facebookAlbumName" ref="contentDef"/>
          <element label="Facebook content (album description)" name="facebookAlbumDesc" template="contentDef">
            <attribute expr="EVal('nms:delivery:contentDef/@trackingType', 'no')" name="trackingType" xml="true"/>
          </element>
          <element label="Facebook audience (country)" name="facebookCountries" ref="contentDef"/>
          <element label="Facebook audience (cities)" name="facebookCities" ref="contentDef"/>
          <element label="Facebook audience (regions)" name="facebookRegions" ref="contentDef"/>
          <element label="Facebook audience (languages)" name="facebookLocales" ref="contentDef"/>
          <element label="Facebook audience (privacy)" name="facebookPrivacy" ref="contentDef"/>
          <element label="Facebook content (Action name)" name="facebookActionName" ref="contentDef"/>
          <element label="Facebook content (Action link)" name="facebookActionLink" template="contentDef">
            <attribute expr="EVal('nms:delivery:contentDef/@urlType', 'facebookAction')" name="urlType" xml="true"/>
          </element>
          <element label="Twitter content (tweet)" name="twitterMsg" ref="contentDef">
            <attribute expr="EVal('nms:delivery:contentDef/@urlType', 'twitterLink')" name="urlType" xml="true"/>
          </element>
          <element advanced="true" label="Application key" name="twitterConsumerKey" ref="contentDef"/>
          <element advanced="true" label="Application secret" name="twitterConsumerSecret" ref="contentDef"/>
          <element advanced="true" label="Access token" name="twitterAccessToken" ref="contentDef"/>
          <element advanced="true" label="Access token secret" name="twitterAccessTokenSecret" ref="contentDef"/>
          <attribute desc="Indicates whether Adobe Campaign should make the images available online." label="Upload images" name="uploadImages" type="boolean"/>
          <attribute label="Images URL" name="publicURL" type="string"/>
          <attribute desc="Indicates whether Adobe Campaign should include the images in the email." label="Include the images in the email (multipart related)" name="multipartRelated" type="boolean"/>
          <attribute desc="Indicates whether any PDF content is associated with this delivery." label="Add PDF content" name="hasPdf" type="boolean"/>
          <attribute default="true" desc="The PDF compression reduces the size of the files to send." label="PDF Compression" name="pdfCompression" type="boolean"/>
          <attribute desc="Indicates whether you want to specify one or more PDF content files for this delivery." enum="paperContentType" label="Content type" name="pdfType" type="string"/>
          <element desc="OpenOffice files for PDF generation" label="PDF content" name="pdf" ordered="true" template="xtk:common:fileToUpload" unbound="true">
            <compute-string expr="@label"/>
            <attribute default="true" desc="Activate generation of this PDF" label="Activate" name="active" type="boolean"/>
            <attribute desc="File label" name="label" template="xtk:common:label"/>
            <attribute advanced="true" desc="File size in bytes (0 if the size is not known)." label="Size in bytes" name="size" type="long"/>
            <attribute desc="Compression mode" enum="compressMode" label="Compression" length="16" name="compressMode" type="string"/>
            <attribute default="false" desc="Enable filtering of the recipients who will receive the PDF" label="Filter" name="filterActive" type="boolean"/>
            <element desc="Script determining whether each recipient should receive the PDF" label="Filtering script" name="filterScript" type="CDATA"/>
          </element>
          <element advanced="true" desc="Definition of the personalization context" name="scriptContext" ref="xtk:scriptContext:scriptContext"/>
          <element advanced="true" label="Recipient information to load" name="customRecipient" ref="customization"/>
          <element advanced="true" label="Data to load about the target" name="customTarget" ref="customization"/>
          <element advanced="true" label="Pre-calculated target information" name="customExtention" ref="customization"/>
          <element advanced="true" applicableIf="HasPackage('nms:coupon')" label="Information on the coupons to load" name="extraCoupon">
            <element label="Information to load" name="custom" ref="customization"/>
          </element>
          <attribute desc="Add objects in the execution context of the scripts" label="Add script objects" name="addExtraObject" type="boolean"/>
          <element label="Extra objects in the script context" name="extraObject" ordered="true" unbound="true">
            <attribute label="Object schema" name="schema" required="true" type="string"/>
            <attribute default="'/'" label="Initial path" name="startPath" type="string"/>
            <attribute desc="Name of the associated JavaScript object" label="JavaScript name" name="jsName" required="true" type="string"/>
            <attribute desc="Generate a JavaScript table" label="Array" name="array" type="boolean"/>
            <element label="Information to load" name="custom" ref="customization"/>
            <element name="where" template="xtk:queryDef:where">
              <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
            </element>
            <element name="orderBy" ref="xtk:queryDef:orderBy"/>
            <attribute desc="Limit the number of records to retrieve" label="Limit the line count" name="useLineCount" type="boolean"/>
            <attribute default="3" desc="Maximum number of records to retrieve" label="Line count limit" name="lineCount" type="long"/>
          </element>
          <element advanced="true" defOnDuplicate="true" label="Preprocessing data" name="material">
            <element label="Preprocessing component" name="materialItem" unbound="true">
              <key name="id">
                <keyfield xpath="@id"/>
              </key>
              <attribute label="Component identifier" name="id" type="string"/>
              <attribute label="Do not escape the content" name="noEscaping" type="boolean"/>
              <element desc="Content at the time of analysis if the component is of 'text' type" label="Text content" name="dataString" type="CDATA"/>
              <element desc="Content at the time of analysis if the component is of 'XML' type" label="XML content" name="dataXml" type="ANY"/>
            </element>
          </element>
        </element>
        <element applicableIf="HasPackage('ncm:content')" label="Publication template" name="publishing" revIntegrity="define" target="ncm:publishing" type="link"/>
        <element name="content">
          <element applicableIf="HasPackage('ncm:content')" label="Content" name="content" type="ANY"/>
        </element>
        <element label="Output files" name="output" xml="true">
          <element name="seedList" template="nms:common:seedList"/>
          <attribute desc="Download the generated file after the analysis of the delivery (otherwise generates it on the server)" label="Download the file generated from the server after the export." name="downloadDestFile" type="boolean"/>
          <attribute desc="Name of the file exported on the server or downloaded on the client." label="Output file" name="fileName" required="true" type="string"/>
          <element desc="Used to define the name on the server of the output file generated by the delivery." label="File name computation script" name="outputScript" type="CDATA"/>
          <element label="Extraction definition" name="extraction" xml="true">
            <element name="source" ref="xtk:dataTransfer:source"/>
            <element name="destination" ref="xtk:dataTransfer:destination"/>
          </element>
          <attribute enum="feedbackMode" label="Retrieval mode" name="feedbackMode" type="string"/>
          <element desc="Configuration of results and behaviors gathered after delivery." label="Results and behaviors after delivery" name="urlConfig" ref="urlConfig"/>
        </element>
        <element label="Tracking parameters" name="tracking" xml="true">
          <attribute default="true" label="Activate tracking" name="enabled" pkgStatus="always" type="boolean"/>
          <attribute default="true" desc="Activate the tracking of message opening." label="Opens tracking" name="openEnabled" pkgStatus="always" type="boolean"/>
          <attribute desc="Expiration date. Sets the date after which redirection is no longer performed." label="Validity limit" name="expiration" type="datetime"/>
          <attribute desc="URL of Web page used by the redirection server when destination URLs have expired." label="Substitution URL for expired URLs" name="errorUrl" type="string"/>
          <element advanced="true" default="'&lt;%@ include option=\'NmsTracking_ClickFormula\' %>'" desc="JavaScript code defining the URL to use for the tracking of recipient clicks. Using this element allows to apply any patching formula to the URL contained in the sent messages. If you already have our own tracking system, you can customize the tracking formula in order to reuse our existing system." label="Clicks tracking formula" name="clickFormula" type="CDATA"/>
          <element advanced="true" desc="JavaScript Code for defining the URL to be used for recipient click tracking." label="Click tracking formula to be used when the delivery is executed" name="rtClickFormula" type="CDATA"/>
          <element advanced="true" default="'&lt;%@ include option=\'NmsTracking_OpenFormula\' %>'" desc="JavaScript code defining the URL to use for the open detection of the HTML messages. Using this element allows you to add any text at the end of the messages sent to the recipients. If you already have our own tracking system, you can customize the tracking formula in order to reuse our existing system." label="Opens tracking formula" name="openFormula" type="CDATA"/>
        </element>
        <element label="Advanced parameters" name="advancedParameters" xml="true">
          <attribute default="false" label="Start job in a detached process" name="outOfProcessMode" type="boolean"/>
          <attribute defOnDuplicate="true" desc="Number of messages per delivery part" label="Message batch quantity" name="splitValue" type="long"></attribute>
          <attribute default="false" desc="Does not perform the delivery for real, stops just before validating the messages at the SMTP level" label="Test SMTP delivery" name="verifyMode" type="boolean"/>
          <attribute advanced="true" default="false" desc="Log SQL queries generated during the analysis in the journal" label="Log SQL queries in the journal" name="showSQL" type="boolean"/>
          <attribute default="false" desc="Force the encoding used for messages" label="Force encoding" name="forceCodepage" pkgStatus="always" type="boolean"/>
          <attribute desc="Character encoding" enum="codepage" label="Encoding" name="codepage" type="long"/>
        </element>
        <element defOnDuplicate="true" desc="Consolidated indicators computed for the reporting" label="Indicators" name="indicators">
          <attribute desc="Indicators are to be updated" enum="dirtyFlags" label="Update" name="dirty" type="byte"/>
          <attribute desc="Last calculation date of the error breakdowns" label="Error update" name="lastErrorComputation" type="datetime"/>
          <attribute desc="Number of errors that have yet to be qualified" label="Unqualified errors" name="errorPending" type="long"/>
          <attribute desc="Last calculation date of the tracking indicators" label="Tracking update" name="lastTrackingComputation" type="datetime"/>
          <attribute desc="Number of tracking logs not taken into account in the indicators" label="Tracking not taken into account" name="trackingPending" type="long"/>
          <attribute desc="Number of processed messages" label="Processed" name="processed" type="long"/>
          <attribute desc="Number of messages sent" label="Sent" name="sent" type="long"/>
          <attribute desc="Number of messages successfully processed" label="Success" name="success" type="long"/>
          <attribute label="Success excluding seed addresses" name="successWithoutSeeds" type="long"/>
          <attribute desc="Number of errors" label="Errors" name="error" type="long"/>
          <attribute desc="Number of recipients put in quarantine" label="New quarantines" name="newQuarantine" type="long"/>
          <attribute desc="Number of errors of type user unknown" label="Unknown users" name="unknownUser" type="long"/>
          <attribute desc="Number of errors of type invalid domain" label="Invalid domains" name="invalidDomain" type="long"/>
          <attribute desc="Number of errors of type unreachable" label="Unreachables" name="unreachable" type="long"/>
          <attribute desc="Number of disabled-account type errors" label="Deactivated accounts" name="disabled" type="long"/>
          <attribute desc="Number of errors of type mailbox full" label="Mailbox full" name="mailboxFull" type="long"/>
          <attribute desc="Number of errors of type not connected (or not on network)" label="Not connected" name="notConnected" type="long"/>
          <attribute desc="Number message-refused type errors" label="Refused" name="refused" type="long"/>
          <attribute desc="Number of distinct recipients who have opened the mail" label="Recipients who have opened" name="recipientOpen" type="long"/>
          <attribute desc="Total count of opens" label="Total count of opens" name="totalRecipientOpen" type="long"/>
          <attribute desc="Count of distinct persons who have clicked on at least one URL in the mail" label="Persons who have clicked" name="personClick" type="long"/>
          <attribute desc="Distinct number of clicks by recipients (same recipient clicks twice, counted once)" label="Number of distinct clicks" name="recipientClick" type="long"/>
          <attribute desc="Overall total of clicks by recipients (same recipient clicks twice, counted twice)" label="Total number of clicks" name="totalRecipientClick" type="long"/>
          <attribute desc="Count of recipients to whom the email has been forwarded" label="Number of forwards" name="forward" type="long"/>
          <attribute desc="Total count of clicks on the mirror page link" label="Mirror page" name="mirrorPage" type="long"/>
          <attribute desc="Total count of clicks on the unsubscription link" label="Opt-Out" name="optOut" type="long"/>
          <attribute desc="Number of transactions" label="Transactions" name="transaction" type="long"/>
          <attribute desc="Total amount of transactions" label="Amount" name="amount" type="double"/>
          <attribute desc="Total number of articles" label="Articles" name="article" type="long"/>
          <attribute desc="Number of distinct pages visited (distinct clicks on web tracking URLs)" label="Distinct pages visited" name="webPage" type="long"/>
          <attribute desc="Total count of visited pages" label="Visited pages" name="totalWebPage" type="long"/>
          <attribute expr="Percent(@processed, [../properties/@toDeliver])" label="Processed ratio" name="processedRatio" type="double"/>
          <attribute expr="Percent(@success, @processed)" label="Success ratio" name="successRatio" type="double"/>
          <attribute expr="Percent(@error, @processed)" label="Error rate" name="errorRatio" type="double"/>
          <attribute expr="Percent(@newQuarantine, @processed)" label="New quarantines ratio" name="newQuarantineRatio" type="double"/>
          <attribute advanced="true" expr="@unknownUser + @invalidDomain + @unreachable + @disabled + @mailboxFull + @notConnected + @refused" label="Errors (real time value)" name="errorSum" type="long"/>
          <attribute expr="Percent(@unknownUser, @errorSum)" label="Unknown user rate" name="unknownUserRatio" type="double"/>
          <attribute expr="Percent(@invalidDomain, @errorSum)" label="Invalid domain ratio" name="invalidDomainRatio" type="double"/>
          <attribute expr="Percent(@unreachable, @errorSum)" label="Unreachable rate" name="unreachableRatio" type="double"/>
          <attribute expr="Percent(@disabled, @errorSum)" label="Disabled account ratio" name="disabledRatio" type="double"/>
          <attribute expr="Percent(@mailboxFull, @errorSum)" label="Mailbox full ratio" name="mailboxFullRatio" type="double"/>
          <attribute expr="Percent(@notConnected, @errorSum)" label="Not connected ratio" name="notConnectedRatio" type="double"/>
          <attribute expr="Percent(@refused, @errorSum)" label="Refused ratio" name="refusedRatio" type="double"/>
          <attribute expr="Percent(@errorPending, @error)" label="Rate of unqualified errors" name="errorPendingRatio" type="double"/>
          <attribute desc="Estimation of the distinct opens, taking into account the proportion of text mails sent" expr="Iif(([../properties/@toDeliver] - [../properties/@text]) = 0, 0, round(toDouble(@recipientOpen) * [../properties/@toDeliver] / ([../properties/@toDeliver] - [../properties/@text]), 0))" label="Estimation of the number of recipients who have opened" name="estimatedRecipientOpen" type="long"/>
          <attribute desc="Estimation of the distinct opens ratio, taking into account the proportion of text mails sent" expr="Percent(@estimatedRecipientOpen, @successWithoutSeeds)" label="Estimation of the distinct opens ratio" name="estimatedRecipientOpenRatio" type="double"/>
          <attribute desc="Estimation of the total opens, taking into account the proportion of text mails sent" expr="Iif(([../properties/@toDeliver] - [../properties/@text]) = 0, 0, round(toDouble(@totalRecipientOpen) * [../properties/@toDeliver] / ([../properties/@toDeliver] - [../properties/@text]), 0))" label="Estimation of the total opens count" name="estimatedTotalRecipientOpen" type="long"/>
          <attribute desc="Estimation of the total opens ratio, taking into account the proportion of text mails sent" expr="Percent(@estimatedTotalRecipientOpen, @successWithoutSeeds)" label="Estimation of the total opens ratio" name="estimatedTotalRecipientOpenRatio" type="double"/>
          <attribute expr="Percent(@recipientClick, @successWithoutSeeds)" label="Click rate" name="recipientClickRatio" type="double"/>
          <attribute desc="Transfer rate estimation" expr="Percent(@forward, @successWithoutSeeds)" label="Transfer ratio" name="forwardRatio" type="double"/>
          <attribute expr="Percent(@optOut, @successWithoutSeeds)" label="Unsubscription ratio" name="optOutRatio" type="double"/>
          <attribute expr="Percent(@totalRecipientClick, @successWithoutSeeds)" label="Cumulated click ratio" name="totalRecipientClickRatio" type="double"/>
          <attribute expr="Percent(@mirrorPage, @successWithoutSeeds)" label="Cumulated click ratio on the mirror page" name="mirrorPageRatio" type="double"/>
          <attribute desc="Ratio between the number of recipients who have clicked at least once in the mail and the number of recipients who have opened the mail. Clicks on the opt-out and mirror page links are ignored." expr="Percent(@recipientClick, @estimatedRecipientOpen)" label="Reactivity rate" name="reactivity" type="double"/>
          <attribute desc="Rate between recorded transactions and messages sent." expr="Percent(@transaction, @successWithoutSeeds)" label="Transaction rate" name="transactionRatio" type="double"/>
          <attribute expr="Iif(@transaction=0, 0, @amount / @transaction)" label="Average transaction amount" name="avgAmount" type="double"/>
          <attribute expr="Iif(@transaction=0, 0, @article / @transaction)" label="Average count of articles per transaction" name="avgArticle" type="long"/>
        </element>
        <element advanced="false" name="properties" xml="true">
          <attribute advanced="true" defOnDuplicate="true" desc="Delivery status after analysis" enum="deliveryState" label="Status after analysis" name="deliveryState" type="byte"></attribute>
          <attribute advanced="true" desc="Identifier of the last proof created." name="FCPid" type="string"></attribute>
          <attribute desc="Last sequence number used by a Proof" label="Sequence number" name="FCPLastNum" type="long"/>
          <attribute advanced="true" desc="Number of messages to send to FCP or seed addresses" label="Messages to sent (FCP and seed addresses)" name="FCPOrSeedCount" sql="true" type="long" xml="true"/>
          <attribute advanced="true" desc="Identifier of the associated delivery in the mid-sourcing database." label="Remote identifier" name="midRemoteId" sql="true" type="long" xml="true"/>
          <attribute advanced="true" label="Internal name of the mid-sourcing account used" name="midAccountUsedName" type="string"/>
          <attribute advanced="true" label="Mid-sourcing account used" name="midAccountUsedCs" type="string"/>
          <attribute advanced="true" desc="Template last-change date used to create the delivery action." label="Template modification date" name="scenarioModTime" sql="true" type="datetime" xml="true"/>
          <attribute advanced="true" desc="Identifier of the last group of messages added in notification mode. 0 if the delivery is not using the notification mode." label="Notification mode" name="notificationId" type="long" xml="true"/>
          <attribute desc="Total count of messages to be delivered" label="Messages to send" name="toDeliver" sql="true" type="long" xml="true"/>
          <attribute desc="Count of lines rejected from the source file" label="Rejected during import" name="importReject" sql="true" type="long" xml="true"/>
          <attribute desc="Number of seeds inserted" label="Seed addresses" name="seedProcessed" sql="true" type="long" xml="true"/>
          <attribute desc="Number of messages excluded by the typology rules" label="Messages excluded by the rule" name="reject" sql="true" type="long" xml="true"/>
          <attribute desc="Number of propositions selected" label="Propositions" name="propositionCount" sql="true" type="long" xml="true"/>
          <attribute expr="@toDeliver + @importReject + @reject" label="Initial target population" name="totalTarget" type="long" xml="false"></attribute>
          <attribute desc="Number of lines exported including the seeds" expr="@toDeliver" label="Number of lines in the file" name="outputLine" type="long" xml="false"/>
          <attribute expr="Percent(@reject, @totalTarget)" label="Rule-based exclusion ratio" name="rejectRatio" type="double" xml="false"/>
          <attribute desc="Number of messages in HTML format" label="HTML messages" name="html" sql="true" type="long" xml="true"/>
          <attribute desc="Number of messages in text format" label="Text messages" name="text" sql="true" type="long" xml="true"/>
          <attribute desc="Number of messages in Multipart/Alternative format" label="Multipart messages" name="multipart" sql="true" type="long" xml="true"/>
          <attribute expr="Percent(@html, @toDeliver)" label="HTML messages ratio" name="htmlRatio" type="double" xml="false"/>
          <attribute expr="Percent(@text, @toDeliver)" label="Text messages ratio" name="textRatio" type="double" xml="false"/>
          <attribute expr="Percent(@multipart, @toDeliver)" label="Multipart messages ratio" name="multipartRatio" type="double" xml="false"/>
          <attribute expr="@toDeliver - @multipart - @html - @text" label="SMS Messages" name="sms" type="long"/>
          <attribute desc="Directory type of the output file (export, upload or none)" label="Directory of the output file" name="outputDir" type="string"/>
          <attribute desc="Name of the output file on the server directory" label="Output file name" name="outputFile" type="string"/>
          <attribute desc="Local full name of the file (defined in the export template)" label="Local name of the output file" name="outputLocal" type="string"/>
          <attribute desc="Count of tracked URLs for this delivery" label="Count of tracked URLs" name="url" sql="true" type="long" xml="true"/>
          <element advanced="false" name="DMDCounters" xml="true">
            <attribute desc="Number of messages to send using the Direct Mail Delivery module." label="Deliver using Direct Mail" name="dmdCount" type="long"/>
            <attribute desc="Number of messages to send using the classical method." label="Deliver using native SMTP" name="smtpCount" type="long"/>
          </element>
        </element>
        <attribute desc="Message sent contains attachments" label="Add attached files" name="hasAttachments" type="boolean"/>
        <element autopk="true" desc="Attached files referenced in the delivery action" img="nms:attachment.png" integrity="owncopy" label="Attached files" labelSingular="Attached file" name="attachment" pkgStatus="always" sqltable="NmsAttachments" template="xtk:common:fileToUpload" unbound="true">
          <compute-string expr="@label"/>
          <attribute desc="Attachment label" name="label" template="xtk:common:label"/>
          <attribute desc="Attachment type" enum="attachmentType" label="Type" length="16" name="type" required="true" type="string" xml="true"/>
          <attribute advanced="true" desc="File size in bytes (0 if the size is not known)." label="Size in bytes" name="size" type="long" xml="true"/>
          <attribute desc="Compression mode (PDF)" enum="compressMode" label="Compression" name="compressMode" type="string"/>
          <element desc="Content to personalize for dynamic PDF generation." label="Customizable content" name="source" type="CDATA"/>
          <attribute advanced="true" desc="Content-Type field used for the attachment in the message sent." length="100" name="contentType" type="string"/>
          <attribute advanced="true" desc="Codepage associated with the message attachment." name="codePage" type="long"/>
          <attribute default="false" desc="Enable filtering of recipients who will receive the attachment" label="Filter" name="filterActive" type="boolean" xml="true"/>
          <element desc="Script calculating for each recipient if they should receive the attachment" label="Filtering script" name="filterScript" type="CDATA" xml="true"/>
          <attribute default="false" desc="Script the name of the file name displayed in the mails sent" label="Script name" name="nameScriptActive" type="boolean" xml="true"/>
          <element desc="Script used to compute the file name displayed in the mail sent to the recipient" label="Name script" name="nameScript" type="CDATA" xml="true"/>
          <attribute advanced="true" desc="Encoding type used to send attachments." name="encoding" type="string" xml="true"/>
          <attribute advanced="true" desc="Name of the file on the server associated with the attachment." name="fileName" type="string" xml="true"/>
        </element>
        <element applicableIf="HasPackage('nms:coupon')" label="Coupon" name="coupon" required="false" revDesc="Deliveries using this coupon" revIntegrity="normal" revLabel="Deliveries" target="nms:coupon" type="link"/>
        <element applicableIf="HasPackage('nms:webAnalytics')" label="Web Analytics account" name="webAnalyticsAccount" revIntegrity="define" target="nms:extAccount" type="link"/>
        <element advanced="true" applicableIf="HasPackage('nms:webAnalytics')" label="Web Analytics extra fields" name="webAnalytics">
          <attribute label="Tag 1" name="tag1" type="string" xml="true"/>
          <attribute label="Tag 2" name="tag2" type="string" xml="true"/>
          <attribute label="Tag 3" name="tag3" type="string" xml="true"/>
        </element>
        <element advanced="true" integrity="own" label="Action parts" name="deliveryPart" revLink="delivery" target="nms:deliveryPart" type="link" unbound="true"/>
        <attribute name="deleteStatus" template="xtk:common:deleteStatus"/>
        <attribute name="deleteDate" template="xtk:common:deleteDate"/>
        <element defOnDuplicate="true" default="iif(@isModel, DefaultFolder('nmsDeliveryModel', [@_folder-id]), DefaultFolder('nmsDelivery', [@_folder-id]))" label="Folder" name="folder" revDesc="Deliveries contained in this folder" revLabel="Delivery"/>
        <element defOnDuplicate="true" default="iif (@isModel, DefaultFolder('nmsDelivery', [@_folderProcess-id]), 0)" name="folderProcess" revDesc="Delivery templates executing deliveries in this folder" revLabel="Delivery templates" revLink="delivery-folderProcess" revTarget="nms:delivery"/>
        <element applicableIf="HasPackage('nms:messageCenter')" label="Parameters of the transactional message" name="triggerMessage">
          <attribute enum="publicationStatus" label="Publication status" name="publicationStatus" type="byte"/>
          <attribute dbEnum="eventType" label="Event type" name="eventType" type="string"/>
          <attribute expr="[../scheduling/@contactDate]" label="Published on" name="publicationDate" type="datetime"/>
          <attribute label="Space call up URL" name="offerSpaceUrl" type="string" xml="true"/>
          <attribute label="Category" name="offerCategory" type="string" xml="true"/>
          <attribute label="Anonymous category" name="offerAnonymousCategory" type="string" xml="true"/>
          <attribute label="Themes" name="offerThemes" type="string" xml="true"/>
          <attribute desc="Identifier of the transactional message template" label="Template identifier" name="templateId" type="long" xml="true"/>
        </element>
      </element>
      <methods async="true">
        <method name="PrepareTargetImpl"></method>
        <method name="PrepareMessageImpl"></method>
        <method library="nms:delivery.js" name="PrepareTarget"></method>
        <method name="PrioritizeTarget"></method>
        <method library="nms:delivery.js" name="PrepareMessage"></method>
        <method library="nms:delivery.js" name="Prepare"></method>
        <method name="PrepareAndStart"></method>
        <method name="PrepareNotification"></method>
        <method name="PrepareProof">
          <parameters>
            <param desc="Execute the created proof straightaway." inout="in" name="bStart" type="boolean"/>
          </parameters>
        </method>
        <method name="PrepareFromId" static="true">
          <parameters>
            <param desc="Delivery ID." inout="in" name="deliveryId" type="string"/>
          </parameters>
        </method>
        <method name="HtmlToText" static="true">
          <parameters>
            <param desc="HTML content to convert" inout="in" name="htmlContent" type="string"/>
            <param desc="Returns converted text" inout="out" name="textContent" type="string"/>
          </parameters>
        </method>
        <method name="DiagnoseHTML" static="true">
          <parameters>
            <param desc="HTML content to be checked" inout="in" name="htmlContent" type="string"/>
            <param desc="The mail format" inout="in" name="format" type="byte"/>
            <param desc="Returns the diagnostic" inout="out" name="diagnostic" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="Play" static="true">
          <parameters>
            <param desc="Delivery ID." inout="in" name="deliveryId" type="string"/>
          </parameters>
        </method>
        <method name="Pause" static="true">
          <parameters>
            <param desc="Delivery ID." inout="in" name="deliveryId" type="string"/>
          </parameters>
        </method>
        <method name="Stop" static="true">
          <parameters>
            <param desc="Delivery ID." inout="in" name="deliveryId" type="string"/>
          </parameters>
        </method>
        <method name="LaunchFCP" static="true">
          <parameters>
            <param desc="Delivery ID." inout="in" name="deliveryId" type="long"/>
          </parameters>
        </method>
        <method const="true" name="LoadExpandedContents">
          <parameters>
            <param desc="List of component identifiers separated by commas (e.g. 'option|NmsServer_URL|text,includeView|UnsubscriptionLink|html')." inout="in" name="ids" type="string"/>
            <param desc="Returns the contents as a 'material' element." inout="out" name="material" type="DOMDocument"/>
          </parameters>
        </method>
        <method const="true" name="BuildPreviewFromId" static="true">
          <parameters>
            <param desc="Delivery ID." inout="in" name="deliveryId" type="long"/>
            <param desc="Recipient filtering condition (@filter = '@id = 5673'), content identifier (@content = 'html', 'text', 'sms', 'webContent1', 'outputFile'...), @targetPart = 1345686..." inout="in" name="params" type="DOMDocument"/>
            <param desc="Returns all the parameters of the generated preview." inout="out" name="preview" type="DOMDocument"/>
            <param desc="Returns the data loaded to compute the preview." inout="out" name="queryResult" type="DOMDocument"/>
          </parameters>
        </method>
        <method const="true" name="BuildPreview">
          <parameters>
            <param desc="Recipient filtering condition (@filter = '@id = 5673'), content identifier (@content = 'html', 'text', 'sms', 'webContent1', 'outputFile'...), @targetPart = 1345686..." inout="in" name="params" type="DOMDocument"/>
            <param desc="Returns all the parameters of the generated preview" inout="out" name="preview" type="DOMDocument"/>
            <param desc="Returns the data loaded to compute the preview." inout="out" name="queryResult" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="SaveUrlInfo" static="true">
          <parameters>
            <param desc="List of new URLs (not associated with an URL template)" inout="in" name="insUrlList" type="DOMDocument"/>
            <param desc="List of URL templates to update" inout="in" name="updUrlList" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetFilesToDownload" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Returns the list of files which can be downloaded as element [properties/filesToDownload]" inout="out" name="filesToDownload" type="DOMDocument"/>
            <param desc="Returns the list of files which cannot be downloaded as element [properties/filesNotToDownload]" inout="out" name="filesNotToDownload" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="UpdateImageConfig" static="true">
          <parameters>
            <param desc="Configuration of image handling" inout="inout" name="imageConfig" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetDlStatusAndLogs" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Identifier of the last log entry returned in the previous call" inout="in" name="lastLogId" type="long"/>
            <param desc="Delivery status" enum="deliveryState" inout="out" name="deliveryState" type="short"/>
            <param desc="Log messages" inout="out" name="returnLogs" type="DOMElement"/>
          </parameters>
        </method>
        <method name="CollectLogs" static="true">
          <parameters>
            <param desc="Prioritization unique identifier" inout="in" name="id" type="long"/>
            <param desc="list of deliveries to take into account" inout="in" name="deliveries" type="DOMElement"/>
            <param desc="table to create to contain all the log messages" inout="in" name="logTable" type="string"/>
          </parameters>
        </method>
        <method name="PrioritizeLogs" static="true">
          <parameters>
            <param desc="Prioritization unique identifier" inout="in" name="id" type="long"/>
            <param desc="list of deliveries to take into account" inout="in" name="deliveries" type="DOMElement"/>
            <param desc="table containing all the log messages" inout="in" name="logTable" type="string"/>
          </parameters>
        </method>
        <method name="ExecuteJob" static="true">
          <parameters>
            <param desc="Name of the method to call on entity" inout="in" name="methodName" type="string"/>
            <param desc="Delivery identifier" inout="in" name="id" type="long"/>
          </parameters>
        </method>
        <method name="SubmitJob" static="true">
          <parameters>
            <param desc="Name of the method to call on entity" inout="in" name="methodName" type="string"/>
            <param desc="Delivery identifier" inout="in" name="id" type="long"/>
          </parameters>
        </method>
        <method name="SubmitDelivery" static="true">
          <parameters>
            <param desc="Internal name of the delivery template" inout="in" name="scenarioName" type="string"/>
            <param desc="XML content to add to the template" inout="in" name="content" type="DOMElement"/>
            <param desc="Identifier of the new delivery (returned even if the analysis fails)" inout="out" name="deliveryId" type="long"/>
          </parameters>
        </method>
        <method name="SubmitNotification" static="true">
          <parameters>
            <param desc="Internal name of the template" inout="in" name="scenarioName" type="string"/>
            <param desc="Delivery target population replacing the one in the scenario" inout="in" name="target" type="DOMElement"/>
            <param desc="Notification identifier" inout="out" name="notificationId" type="long"/>
          </parameters>
        </method>
        <method name="CreateFromModel" static="true">
          <parameters>
            <param desc="Internal name of delivery template" inout="in" name="scenarioName" type="string"/>
            <param desc="XML content to add to the template" inout="in" name="content" type="DOMElement"/>
            <param desc="Returns the delivery document created" inout="out" name="delivery" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="SubmitDeliveryById" static="true">
          <parameters>
            <param desc="Template identifier" inout="in" name="scenarioId" type="long"/>
            <param desc="XML content to add to the template" inout="in" name="content" type="DOMElement"/>
            <param desc="XML content to add to the template" inout="out" name="deliveryId" type="long"/>
          </parameters>
        </method>
        <method name="QueueNotification" static="true">
          <parameters>
            <param desc="Internal name of template" inout="in" name="scenarioName" type="string"/>
            <param desc="Delivery target population" inout="in" name="target" type="DOMElement"/>
          </parameters>
        </method>
        <method access="anonymous" name="BuildMirror" static="true">
          <parameters>
            <param desc="Reversible crypt for message and delivery part identifiers" inout="in" name="crypted" type="string"/>
            <param desc="Content of the mirror page" inout="out" name="content" type="CDATA"/>
            <param desc="HTTP response in case of error" inout="out" name="responseCode" type="long"/>
          </parameters>
        </method>
        <method access="anonymous" name="BuildMirrorEx" static="true">
          <parameters>
            <param desc="Reversible crypt for message and delivery part identifiers" inout="in" name="crypted" type="string"/>
            <param desc="Parameters" inout="in" name="parameters" type="DOMElement"/>
            <param desc="Content of the mirror page" inout="out" name="content" type="CDATA"/>
            <param desc="HTTP response in case of error" inout="out" name="responseCode" type="long"/>
          </parameters>
        </method>
        <method name="GetMirrorURL" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Message ID" inout="in" name="message" type="string"/>
            <param desc="Mirror page URL" inout="out" name="url" type="string"/>
          </parameters>
        </method>
        <method access="anonymous" name="BuildForward" static="true">
          <parameters>
            <param desc="Reversible crypt for message and delivery part identifiers" inout="in" name="crypted" type="string"/>
            <param desc="URL parameters" inout="in" name="parameters" type="DOMElement"/>
            <param desc="Page content" inout="out" name="content" type="CDATA"/>
            <param desc="HTTP response in case of error" inout="out" name="responseCode" type="long"/>
          </parameters>
        </method>
        <method name="UpdateBroadLogs" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Collection containing the nms:broadLog records to update (@id, @status, @eventDate and @lastModified must be specified)" inout="in" name="logs" type="DOMDocument"/>
            <param desc="Specifies whether to raise an error for an invalid delivery identifier." inout="in" name="deliveryMustExist" type="boolean"/>
          </parameters>
        </method>
        <method name="RecomputeStats" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Bit field describing what to recompute (see the 'nms:delivery:dirtyFlags' enumeration)." inout="in" name="dirtyFlags" type="byte"/>
          </parameters>
        </method>
        <method name="ExecCommand" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="string"/>
            <param desc="Command name ('play', 'pause' or 'stop')" inout="in" name="command" type="string"/>
            <param desc="Delivery status after the command is executed" inout="out" name="newState" type="byte"/>
          </parameters>
        </method>
        <method name="ValidateWavesDefinition" static="true">
          <parameters>
            <param desc="Definition to approve." inout="in" name="definition" type="DOMElement"/>
            <param desc="Definition approved." inout="out" name="validation" type="DOMElement"/>
          </parameters>
        </method>
        <method access="midSourcingSubmit" name="SubmitMidSourcing" static="true">
          <parameters>
            <param desc="Document representing the delivery." inout="in" name="delivery" type="DOMDocument"/>
            <param desc="No longer used" inout="in" name="routingMatch" type="DOMDocument"/>
            <param desc="Full folder name (in the sender database)." inout="in" name="folderName" type="string"/>
            <param desc="Identifier of the delivery in the receiver database." inout="out" name="remoteId" type="long"/>
            <param desc="No longer used" inout="out" name="remoteMatchId" type="long"/>
          </parameters>
        </method>
        <method access="midSourcingSubmit" name="FinalizeMidPreparation" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Error code returned by the analysis on the marketing database (method-level error code is not used for this)" inout="in" name="errorCode" type="long"/>
            <param desc="Delivery properties to update" inout="in" name="properties" type="DOMDocument"/>
            <param desc="Specifies if this is a retry for the method call." inout="in" name="retry" type="boolean"/>
            <param desc="Returns an error code preventing the caller to perform retires. Otherwise, the error can be temporary." inout="out" name="fatalError" type="long"/>
            <param desc="Error message associated with the 'fatalError' error code." inout="out" name="fatalErrorMsg" type="string"/>
          </parameters>
        </method>
        <method name="AppendDeliveryPart" static="true">
          <parameters>
            <param desc="Document representing the delivery part (or a collection of delivery parts)." inout="in" name="deliveryPart" type="DOMDocument"/>
            <param desc="Specifies if this is a new try to submit this delivery part." inout="in" name="retry" type="boolean"/>
            <param desc="Delivery part identifier in the database (when it is not a collection)." inout="out" name="deliveryPartId" type="long"/>
            <param desc="Returns an error code preventing the caller to perform retires. Otherwise, the error can be temporary." inout="out" name="fatalError" type="long"/>
            <param desc="Error message associated with the 'fatalError' error code." inout="out" name="fatalErrorMsg" type="string"/>
          </parameters>
        </method>
        <method name="StoreMirrorPageInfoEx" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Is it a notification?" inout="in" name="notification" type="boolean"/>
            <param desc="Number of parts" inout="in" name="partsCount" type="long"/>
            <param desc="First part identifier" inout="in" name="firstPartId" type="long"/>
            <param desc="Notification identifier" inout="in" name="notificationId" type="long"/>
            <param desc="Returns an error code preventing the caller to perform retires. Otherwise, the error can be temporary." inout="out" name="fatalError" type="long"/>
            <param desc="Error message associated with the 'fatalError' error code." inout="out" name="fatalErrorMsg" type="string"/>
          </parameters>
        </method>
        <method name="StoreMirrorPageInfo" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
            <param desc="Number of parts" inout="in" name="partsCount" type="long"/>
            <param desc="First part identifier" inout="in" name="firstPartId" type="long"/>
            <param desc="Last part identifier" inout="in" name="lastPartId" type="long"/>
            <param desc="Returns an error code preventing the caller to perform retires. Otherwise, the error can be temporary." inout="out" name="fatalError" type="long"/>
            <param desc="Error message associated with the 'fatalError' error code." inout="out" name="fatalErrorMsg" type="string"/>
          </parameters>
        </method>
        <method name="UpdateCachedDelivery"></method>
        <method name="InvalidateDeliveryCache" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="long"/>
          </parameters>
        </method>
        <method name="GetMidBroadLogs" static="true">
          <parameters>
            <param desc="Retrieve logs modified since this date (on the mid-sourcing server)." inout="in" name="startDate" type="datetime"/>
            <param desc="Maximum number of logs to retrieve, as long as they have not been updated within the same second." inout="in" name="logCount" type="long"/>
            <param desc="Reference date from the issuing server. Used to adjust the delivery log dates." inout="in" name="emitterDate" type="datetime"/>
            <param desc="Output document, list of delivery logs." inout="out" name="result" type="DOMDocument"/>
            <param desc="Date of the first log retrieved (greater than startDate)." inout="out" name="nextDate" type="datetime"/>
          </parameters>
        </method>
        <method name="GetMidDeliveries" static="true">
          <parameters>
            <param desc="Retrieve modifications since this date (on the mid-sourcing server)." inout="in" name="startDate" type="datetime"/>
            <param desc="Maximum number of deliveries to retrieve, provided they were not updated during the same second." inout="in" name="maxCount" type="long"/>
            <param desc="Reference date of the issuing server. Used to adjust dates of deliveries." inout="in" name="emitterDate" type="datetime"/>
            <param desc="Output document, list of deliveries updated." inout="out" name="result" type="DOMDocument"/>
            <param desc="Start date for the next call." inout="out" name="nextDate" type="datetime"/>
          </parameters>
        </method>
        <method name="CleanupDeliveries" static="true">
          <parameters>
            <param desc="List of delivery identifiers in the sending database (comma separated)" inout="in" name="deliveryId" type="string"/>
          </parameters>
        </method>
        <method name="DispatchImages" static="true">
          <parameters>
            <param desc="List of images to upload to the mid-sourcing server." inout="in" name="images" type="string"/>
            <param desc="Identifier of the delivery router." inout="in" name="providerId" type="long"/>
            <param desc="Name of the delivery router." inout="in" name="providerName" type="string"/>
          </parameters>
        </method>
        <method name="ImagePublishing" static="true">
          <parameters>
            <param inout="in" name="imageList" type="string"/>
          </parameters>
        </method>
        <method name="PrepareMultipartRelated" static="true">
          <parameters>
            <param desc="List of images" inout="in" name="imageList" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:delivery.js" name="PreviewExtraction" static="true">
          <parameters>
            <param desc="File name" inout="in" name="fileName" type="string"/>
            <param desc="Number of lines" inout="in" name="nbLines" type="int"/>
            <param desc="Result" inout="out" name="result" type="string"/>
          </parameters>
        </method>
        <method name="DeployTriggerMessages" static="true">
          <parameters>
            <param desc="Filter conditions for defining the transactional messages to deploy" inout="in" name="deliveries" type="DOMElement"/>
            <param desc="Publish on the control instance only?" inout="in" name="localPublish" type="boolean"/>
          </parameters>
        </method>
        <method library="nms:messageCenter.js" name="DeployTriggerMessageSingle" static="true">
          <parameters>
            <param desc="ID of the delivery to deploy" inout="in" name="deliveryId" type="long"/>
            <param desc="Publish on the control instance only?" inout="in" name="localPublish" type="boolean"/>
            <param desc="Publication complete" inout="out" name="isSuccess" type="boolean"/>
          </parameters>
        </method>
        <method library="nms:messageCenter.js" name="InstallTransactionalMessage" static="true">
          <parameters>
            <param desc="XML element containing the package to be imported." name="parameters" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetMidXtkKey" static="true">
          <parameters>
            <param desc="Key" inout="out" name="key" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:amcIntegration.js" name="aemListContent" static="true">
          <parameters>
            <param desc="Internal name of the delivery" inout="in" name="deliveryName" type="string"/>
            <param desc="AEM external account ID" inout="in" name="cmsAccountId" type="long"/>
            <param desc="Search in the label" inout="in" name="searchLabel" type="string"/>
            <param desc="Filter by status" inout="in" name="status" type="string"/>
            <param desc="Filter by links" inout="in" name="linking" type="string"/>
            <param desc="Sort type" inout="in" name="sort" type="string"/>
            <param desc="Number of elements to return" inout="in" name="count" type="long"/>
            <param desc="Position of first element" inout="in" name="offset" type="long"/>
            <param inout="out" name="list" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:amcIntegration.js" name="aemLinkContent" static="true">
          <parameters>
            <param desc="Delivery" inout="in" name="delivery" type="DOMElement"/>
            <param desc="Content path" inout="in" name="path" type="string"/>
            <param desc="Contents" inout="out" name="content" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:amcIntegration.js" name="aemUnlinkContent" static="true">
          <parameters>
            <param desc="Delivery" inout="in" name="delivery" type="DOMElement"/>
            <param desc="Desynchronization successful." inout="out" name="success" type="boolean"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:amcIntegration.js" name="aemGetContent" static="true">
          <parameters>
            <param desc="Delivery" inout="in" name="delivery" type="DOMElement"/>
            <param desc="Contents" inout="out" name="content" type="DOMElement"/>
          </parameters>
        </method>
        <method name="BuildTargetDataSchema" static="true">
          <parameters>
            <param desc="Delivery identifier" inout="in" name="deliveryId" type="string"/>
            <param desc="'targetData' schema" inout="out" name="schema" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Seed to insert in the export files" entitySchema="xtk:srcSchema" img="nms:unknownad.png" implements="xtk:persist" label="Seed addresses" labelSingular="Seed" name="seedMember" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="common">
        <key internal="true" name="id" noDbIndex="true">
          <keyfield xpath="@id"/>
        </key>
        <attribute default="Gid()" label="Primary key" name="id" type="string"/>
        <attribute defOnDuplicate="true" default="GetOption('XtkInstancePrefix')+'SDM'+CounterValue('nmsSeedMember')" name="internalName" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute desc="This record is a seed address template" label="Template" name="isModel" type="boolean"/>
        <element desc="Target extension" label="Extension" name="targetData" type="ANY" xml="true"/>
        <element name="custom_nms_broadLog">
          <attribute desc="Address of the delivery log" label="Address" length="512" name="address" type="string"/>
          <element name="postalAddress">
            <element name="address" template="nms:common:postalAddress">
              <attribute _operation="delete" name="addrDefined"/>
              <attribute _operation="delete" name="addrQuality"/>
              <attribute _operation="delete" name="addrLastCheck"/>
              <attribute _operation="delete" name="addrErrorCount"/>
              <element _operation="delete" name="serialized"/>
            </element>
          </element>
        </element>
        <element label="Recipient" name="custom_nms_recipient">
          <attribute name="email" template="nms:recipient:recipient/@email"/>
          <attribute name="emailFormat" template="nms:recipient:recipient/@emailFormat"/>
          <attribute name="mobilePhone" template="nms:recipient:recipient/@mobilePhone"/>
          <attribute name="phone" template="nms:recipient:recipient/@phone"/>
          <attribute name="fax" template="nms:recipient:recipient/@fax"/>
          <attribute applicableIf="hasPackage('nms:centralLocal')" label="Agency" length="64" name="agency" type="string"/>
          <attribute name="account" template="nms:recipient:recipient/@account"/>
          <attribute name="origin" template="nms:recipient:recipient/@origin"/>
          <attribute name="blackList" template="nms:recipient:recipient/@blackList"/>
          <attribute name="lastName" template="nms:recipient:recipient/@lastName"/>
          <attribute name="firstName" template="nms:recipient:recipient/@firstName"/>
          <attribute name="middleName" template="nms:recipient:recipient/@middleName"/>
          <attribute name="salutation" template="nms:recipient:recipient/@salutation"/>
          <attribute name="gender" template="nms:recipient:recipient/@gender"/>
          <attribute name="birthDate" template="nms:recipient:recipient/@birthDate"/>
          <attribute name="language" template="nms:recipient:recipient/@language"/>
          <attribute name="company" template="nms:recipient:recipient/@company"/>
          <attribute name="status" template="nms:recipient:recipient/@status"/>
          <element label="Localization" name="location">
            <attribute name="address1" template="nms:common:locationAggregate/location/@address1"/>
            <attribute name="address2" template="nms:common:locationAggregate/location/@address2"/>
            <attribute name="address3" template="nms:common:locationAggregate/location/@address3"/>
            <attribute name="address4" template="nms:common:locationAggregate/location/@address4"/>
            <attribute name="zipCode" template="nms:common:locationAggregate/location/@zipCode"/>
            <attribute name="city" template="nms:common:locationAggregate/location/@city"/>
            <attribute name="stateCode" template="nms:common:locationAggregate/location/@stateCode"/>
            <attribute name="countryCode" template="nms:common:locationAggregate/location/@countryCode"/>
          </element>
        </element>
        <element applicableIf="HasPackage('nms:messageCenter')" name="custom_nms_rtEvent" xml="true">
          <attribute desc="Recipient email address" label="Email" name="email" sqlname="sEmailRtEvent" template="xtk:common:email" xml="false"/>
          <attribute desc="Recipient mobile number" label="Mobile" name="mobilePhone" sqlname="sMobilePhoneRtEvent" template="xtk:common:mobilePhone" xml="false"/>
          <attribute name="externalId" template="nms:rtEvent:rtEvent/@externalId"/>
          <element name="postalAddress" template="nms:common:postalAddress">
            <attribute _operation="delete" name="addrDefined"/>
            <attribute _operation="delete" name="addrQuality"/>
            <attribute _operation="delete" name="addrLastCheck"/>
            <attribute _operation="delete" name="addrErrorCount"/>
            <element _operation="delete" name="serialized"/>
          </element>
          <attribute applicableIf="HasPackage('nms:mobileApp')" name="registrationToken" sqlname="sRegistrationTokenRtEvent" template="nms:appSubscription:appSubscription/@registrationToken" xml="false"/>
          <attribute advanced="true" applicableIf="HasPackage('nms:mobileApp')" expr="@registrationToken" label="ID of the iOS device" name="ios"/>
          <attribute advanced="true" applicableIf="HasPackage('nms:mobileApp')" expr="@registrationToken" label="ID of the Android device" name="android"/>
          <element applicableIf="HasPackage('nms:mobileApp')" name="mobileApp">
            <attribute name="uuid" template="nms:mobileApp:mobileApp/@uuid"/>
            <attribute name="senderId" template="nms:mobileApp:mobileApp/@senderId"/>
            <attribute name="password" template="nms:mobileApp:mobileApp/@password"/>
            <attribute name="certificate" template="nms:mobileApp:mobileApp/@certificate"/>
            <attribute name="sandbox" template="nms:mobileApp:mobileApp/@sandbox"/>
          </element>
          <element applicableIf="HasPackage('nms:mobileApp')" label="Mobile application" name="mobileAppLink" revLink="_NONE_" target="nms:mobileApp" type="link"/>
          <element name="ctx" template="nms:rtEvent:rtEvent/ctx"/>
        </element>
        <element label="Subscription" name="custom_nms_subscription" xml="true">
          <attribute name="created" template="nms:subscription:subscription/@created"/>
          <element label="Service" name="service">
            <attribute name="label" template="nms:service:service/@label"/>
            <attribute name="name" template="nms:service:service/@name"/>
          </element>
        </element>
      </element>
      <element autopk="true" folderLink="folder" folderModel="nmsSeedList" img="nms:unknownad.png" name="seedMember">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@internalName"/>
        </key>
        <element aggregate="nms:seedMember:common" name="common"/>
        <element name="custom_nms_broadLog">
          <element name="postalAddress">
            <element name="address">
              <element name="serialized" template="nms:common:postalAddress/serialized"/>
            </element>
          </element>
        </element>
        <attribute name="id" type="long"/>
        <element advanced="true" defOnDuplicate="true" label="Delivery including the seed" name="delivery" revIntegrity="owncopy" revLabel="Seed addresses" revLink="seedMember" target="nms:delivery" type="link"/>
        <element advanced="true" defOnDuplicate="true" label="Delivery including the seed (proof)" name="proof" revIntegrity="owncopy" revLabel="Proof seed addresses" revLink="FCPSeed" target="nms:delivery" type="link"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsSeedList', [@_folder-id])" label="Folder" name="folder" revDesc="Seed addresses contained in this folder" revIntegrity="define" revLabel="Seed addresses" target="xtk:folder" type="link"/>
      </element>
      <methods>
        <method library="nms:seedMember.js" name="getAsModel" static="true">
          <parameters>
            <param desc="Attribute containing the identifier of the entity to be associated (e.g. 'delivery-id')" inout="in" name="refIdName" type="string"/>
            <param desc="Identifier of the entity to be associated (value of 'refIdName')" inout="in" name="refIdValue" type="long"/>
            <param desc="Element containing the selected template identifiers" inout="in" name="selection" type="DOMElement"/>
            <param desc="Element containing the existing seed addresses" inout="in" name="parentIn" type="DOMElement"/>
            <param desc="Returns the element with the new templates added" inout="out" name="parentOut" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Configuration of the target mapping" entitySchema="xtk:srcSchema" img="nms:deliveryMapping.png" implements="xtk:persist" label="Target mapping" name="deliveryMapping" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="none" label="Definition mode for a field of the delivery" name="mappingFieldMode">
        <value desc="Field not specified for this delivery" label="Not specified" name="none"/>
        <value desc="The field value is evaluated from the delivery schema" label="Schema of the target" name="targetSchema"/>
        <value desc="The field value is evaluated from the recipient schema" label="Recipient schema" name="recipient"/>
      </enumeration>
      <enumeration basetype="byte" default="same" name="exclusionType">
        <value label="Store exclusions and messages in the same table" name="same" value="0"/>
        <value label="Store messages only" name="delete" value="1"/>
        <value label="Store exclusions and messages in separate tables" name="other" value="2"/>
      </enumeration>
      <element name="mappingField">
        <attribute desc="Field value evaluation method" enum="mappingFieldMode" label="Mode" name="mode" type="string"/>
        <attribute desc="Field value computation expression" label="Expression" name="expr" type="string"/>
      </element>
      <element autopk="true" folderLink="folder" folderModel="nmsDeliveryMapping" fullLoad="true" img="nms:deliveryMapping.png" name="deliveryMapping" pkgAdmin="@id != 0">
        <compute-string expr="@label + ' ('+@schema+')'"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'MAP'+CounterValue('nmsDeliveryMapping')" name="name" template="xtk:common:name"/>
        <attribute name="label" required="true" template="xtk:common:label"/>
        <attribute default="getOption('Nms_DefaultRcpSchema')" label="Filtering dimension" length="64" name="schema" required="true" type="string"/>
        <attribute label="Link identifying the recipients" length="64" name="recipientLink" type="string"/>
        <attribute expr="GetLinkSchema(@schema, @recipientLink)" label="Targeting dimension" name="targetSchema" type="string" xml="true"/>
        <attribute advanced="true" defOnDuplicate="true" label="Application built-in mapping" name="builtIn" type="boolean"/>
        <element name="comment" template="xtk:common:comment"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute label="Email" name="email" xml="true"/>
        <attribute label="SMS" name="sms" xml="true"/>
        <attribute label="Phone" name="phone" xml="true"/>
        <attribute label="Agency identifier" name="agency" xml="true"/>
        <attribute label="Fax" name="fax" xml="true"/>
        <attribute label="Postal address" name="paper" xml="true"/>
        <attribute label="Blacklist email" name="blackListEmail" xml="true"/>
        <attribute label="SMS blacklist" name="blackListSms" xml="true"/>
        <attribute label="Telephone blacklist" name="blackListPhone" xml="true"/>
        <attribute label="Fax blacklist" name="blackListFax" xml="true"/>
        <attribute label="Direct Mail blacklist" name="blackListPaper" xml="true"/>
        <attribute label="'Agency' blacklist" name="blackListAgency" xml="true"/>
        <attribute label="Format" name="format" xml="true"/>
        <attribute label="Country code" name="countryCode" xml="true"/>
        <attribute label="External ID" name="externalId" xml="true"/>
        <attribute label="Segment code" name="segmentCode" xml="true"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Facebook address" name="facebook" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Twitter address" name="twitter" type="string"/>
        <attribute applicableIf="HasPackage('nms:mobileApp')" label="'iOS' blacklist" name="blackListIos" xml="true"/>
        <attribute applicableIf="HasPackage('nms:mobileApp')" label="'Android' blacklist" name="blackListAndroid" xml="true"/>
        <attribute label="Sub-affinity" name="affinityGroup" type="string" xml="true"/>
        <element desc="Default source delivery for web tracking if no other source can be found." label="Default traffic source" name="defaultOrigin" revIntegrity="define" target="nms:delivery" type="link"/>
        <element name="storage">
          <attribute desc="Schema of delivery logs to process" label="Message schema" length="64" name="broadLogSchema" sql="true"/>
          <attribute enum="exclusionType" label="Exclusions management" name="exclusionType" type="byte" xml="true"/>
          <attribute desc="Schema of excluded delivery logs" label="Rejection schema" length="64" name="broadLogExclSchema" sql="true"/>
          <attribute label="Tracking logs schema" length="64" name="trackingLogSchema" sql="true"/>
          <element name="extraField" ordered="true" unbound="true" xml="true">
            <key name="dstXPath">
              <keyfield xpath="@dstXPath"/>
              <keyfield xpath="@srcExpr"/>
            </key>
            <attribute label="Destination" name="dstXPath" type="string"/>
            <attribute label="Source expression" name="srcExpr" type="string"/>
          </element>
        </element>
        <element applicableIf="HasPackage('nms:social')" name="social" xml="true">
          <attribute label="Email" name="email" type="string"/>
          <attribute label="First name" name="firstName" type="string"/>
          <attribute label="Last name" name="lastName" type="string"/>
          <attribute label="Birth date" name="birthDate" type="string"/>
          <attribute label="Gender" name="gender" type="string"/>
          <attribute label="Language" name="locale" type="string"/>
          <attribute label="Link" name="pathFromVisitorSchema" type="string"/>
        </element>
        <element defOnDuplicate="true" default="DefaultFolder('nmsDeliveryMapping', [@_folder-id])" label="Mapping folder" name="folder" required="true" revDesc="Target mappings contained in this folder" revIntegrity="define" revLabel="Target mappings" target="xtk:folder" type="link"/>
      </element>
      <methods>
        <method hidden="true" library="nms:delivery.js" name="CreateCustomTarget" static="true">
          <parameters>
            <param desc="Schema of the targeting dimension" inout="in" name="targetSchema" type="string"/>
            <param desc="Document containing information on generating schemas linked to the targeting dimension." inout="in" name="targetDesc" type="DOMDocument"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:delivery.js" name="UpdateCustomTarget" static="true">
          <parameters>
            <param desc="Document containing the original information." inout="in" name="targetOldDesc" type="DOMDocument"/>
            <param desc="Document containing information on generating schemas linked to the targeting dimension." inout="in" name="targetDesc" type="DOMDocument"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:delivery.js" name="UpdateCustomAggregate" static="true">
          <parameters>
            <param desc="Document containing information on generating schemas linked to the targeting dimension." inout="in" name="aggregateDesc" type="DOMDocument"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Delivery action parts (used to load balance between delivery servers)" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Delivery action parts" labelSingular="Delivery action part" name="deliveryPart" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" label="Message format" name="contentFormat">
        <value name="multipart" value="multipart/alternative"/>
        <value name="html"/>
        <value name="text"/>
      </enumeration>
      <enumeration basetype="string" label="Message status" name="messageStatus">
        <value label="Not defined" name="undefined"/>
        <value label="Successfully sent" name="success"/>
        <value label="Sent after retries" name="retry success"/>
        <value label="Failed" name="failed"/>
        <value label="Error after retry" name="retry failed"/>
      </enumeration>
      <element desc="Messages to send" label="Messages to send" name="message" template="nms:common:postalAddress">
        <key internal="true" name="messageId">
          <keyfield xpath="@id"/>
        </key>
        <attribute desc="Internal message identifier (used as the identifier of the associated delivery log)" label="Identifier" name="id" type="long"/>
        <attribute desc="Recipient address" label="Address" name="address" type="string"/>
        <element _operation="delete" name="serialized"/>
        <attribute _operation="delete" name="addrDefined"/>
        <attribute _operation="delete" name="addrQuality"/>
        <attribute _operation="delete" name="addrLastCheck"/>
        <attribute _operation="delete" name="addrErrorCount"/>
        <attribute desc="External identifier of the message" label="External Id" name="externalId" type="string"/>
        <attribute desc="Segment code of the targeted recipient" label="Segment code" length="16" name="segmentCode" type="string"/>
        <attribute advanced="true" desc="Message identifier on the mid-sourcing platform" label="Mid-sourcing id" name="midSourcingId" type="long"/>
        <attribute desc="Delivery format for this message" enum="contentFormat" label="Delivery format" name="content" type="string"/>
        <attribute label="Country code" name="countryCode" type="string"/>
        <attribute advanced="true" desc="Address status when message was prepared." enum="nms:address:status" label="Address status" name="addressStatus" type="byte"/>
        <attribute advanced="true" enum="messageStatus" label="Message status" name="messageStatus" type="string"/>
        <attribute advanced="true" desc="Specifies if this message has been repaired after a child process has died." label="Repaired" name="repaired" type="boolean"/>
        <attribute advanced="true" desc="Internal identifier of the recipient of this message." label="Recipient identifier" name="recipient-id" type="long"/>
        <attribute advanced="true" desc="Identifier of the delivery part used in the mirror page URL." label="Part identifier" name="deliveryPartId" type="long"/>
        <attribute advanced="true" desc="Number of bytes effectively sent, including technical data." label="Volume sent" name="bytesSent" type="long"/>
        <attribute advanced="true" label="Do not retry (after failure)" name="noRetry" type="boolean"/>
        <attribute advanced="true" desc="Indicates if this message is no longer in the message queue of a child process." label="Released" name="released" type="boolean"/>
        <element name="pdfFile" ordered="true" unbound="true">
          <key internal="true" name="pdfFileId">
            <keyfield xpath="@id"/>
          </key>
          <attribute label="Identifier of the PDF in the delivery" name="id" type="long"/>
          <attribute label="Full name of the PDF file" name="fileName" type="string"/>
          <attribute desc="Specifies the start page of the content in the PDF file. 0 if the file does not concern this message." label="Start page (compression mode)" name="pageStart" type="long"/>
          <attribute desc="Specifies the end page of the content in the PDF file. 0 if the file does not concern this message." label="End page (compression mode)" name="pageEnd" type="long"/>
          /&gt;
        </element>
        <element desc="Personalized text content of the Fax." label="Personalized text content" name="faxText" type="CDATA"/>
        <element label="Personalization information" name="custom" type="ANY"/>
        <element label="Document personalization information" name="customDoc" type="ANY"/>
        <attribute label="Message identifier returned by the external delivery connector" name="providerId" type="string"/>
      </element>
      <element autopk="true" name="deliveryPart" pkgStatus="never">
        <dbindex name="state">
          <keyfield xlink="delivery"/>
          <keyfield xpath="@nextPass"/>
        </dbindex>
        <attribute advanced="true" desc="Process identifier (at the operating system level, pid) executing this fragment" label="Process (PID)" name="processId" type="long"/>
        <attribute advanced="true" desc="Hostname processing this fragment" label="Hostname" length="64" name="hostname" type="string"/>
        <attribute desc="Start date for next pass" label="Next pass" name="nextPass" type="datetime"/>
        <attribute desc="Date of latest modification to the delivery content" label="Delivery content date" name="contentModTime" type="datetime"/>
        <attribute desc="Start date of delivery action" label="Start" name="startDate" type="datetime"/>
        <attribute desc="Date past which the delivery part can no longer be processed" label="Validity limit" name="validityDate" type="datetime"/>
        <attribute name="IPAffinity" template="nms:delivery:delivery/scheduling/@IPAffinity"/>
        <attribute label="Recipients count" name="rcpCount" type="long"/>
        <attribute desc="Number of retries" label="Retries" name="retry" type="long"/>
        <attribute desc="Identifier used to separate different notification sessions" label="Notification Id" name="notificationId" type="long"/>
        <element name="message" ref="message" unbound="true" xml="true"/>
        <element integrity="normal" label="Delivery" name="delivery" noDbIndex="true" required="true" revLink="deliveryPart" target="nms:delivery" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Daily delivery statistics" entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:report.png" implements="xtk:persist" label="Broadcast statistics" labelSingular="Delivery statistics" name="deliveryStat" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="xtk:report.png" name="deliveryStat" pkgStatus="never">
        <key name="dateDlv">
          <keyfield xpath="@date"/>
          <keyfield xlink="delivery"/>
        </key>
        <attribute label="Date" name="date" type="datetime"/>
        <attribute desc="Total volume sent (in bytes)" label="Volume" name="volume" type="double"/>
        <attribute desc="Count of first successful deliveries" label="Success" name="firstSuccess" type="long"/>
        <attribute desc="Number of first deliveries with errors" label="Errors" name="firstError" type="long"/>
        <attribute desc="Count of successful retries" label="Successful retries" name="retriesSuccess" type="long"/>
        <attribute desc="Number of retries with errors" label="Retries with errors" name="retriesError" type="long"/>
        <attribute desc="Delivery executed in simulation mode (verification of addresses)" label="Simulation mode" name="verifyMode" type="boolean"/>
        <element integrity="neutral" label="Delivery" name="delivery" revIntegrity="neutral" target="nms:delivery" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Delivery and tracking statistics, available per delivery and per email domain" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:report.png" implements="xtk:persist" label="Delivery and tracking statistics" labelSingular="Delivery and tracking statistics" name="deliveryLogStats" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="nms:report.png" name="deliveryLogStats" pkgStatus="never">
        <key name="dimensions">
          <keyfield xlink="delivery"/>
          <keyfield xpath="@domain"/>
        </key>
        <element label="Delivery" name="delivery" revIntegrity="own" target="nms:delivery" type="link"/>
        <attribute label="Email domain" length="255" name="domain" type="string"/>
        <attribute label="Number of messages to send" name="messages" type="long"/>
        <attribute label="Deliveries" name="success" type="long"/>
        <attribute label="Deliveries excluding seed addresses" name="successWithoutSeeds" type="long"/>
        <attribute expr="@prepared + @error + @success" label="Number of messages processed" name="processed" type="long"/>
        <attribute label="Prepared" name="prepared" type="long"/>
        <attribute label="Pending" name="waiting" type="long"/>
        <attribute label="Number of messages sent" name="sent" type="long"/>
        <attribute label="Canceled" name="cancelled" type="long"/>
        <attribute label="Disabled account" name="disabled" type="long"/>
        <attribute label="Errors" name="error" type="long"/>
        <attribute label="Invalid domain" name="invalidDomain" type="long"/>
        <attribute label="Inbox full" name="mailBoxFull" type="long"/>
        <attribute label="Quarantine" name="quarantine" type="long"/>
        <attribute label="Rejected" name="refused" type="long"/>
        <attribute label="User unknown" name="unknownUser" type="long"/>
        <attribute label="Unreachable" name="unreachable" type="long"/>
        <attribute label="Not connected" name="notConnected" type="long"/>
        <attribute expr="@unknownUser" label="Hard bounces" name="hardBounce" type="long"/>
        <attribute expr="@unreachable + @mailBoxFull + @invalidDomain + @disabled + @notConnected + @refused" label="Soft bounces" name="softBounce" type="long"/>
        <attribute label="Opened messages" name="opened" type="long"/>
        <attribute label="Distinct opens" name="recipientOpen" type="long"/>
        <attribute label="Opens" name="totalRecipientOpen" type="long"/>
        <attribute label="Messages that were clicked" name="clicked" type="long"/>
        <attribute label="People who clicked" name="personClick" type="long"/>
        <attribute label="Recipients who clicked" name="recipientClick" type="long"/>
        <attribute label="Total number of recipients who clicked" name="totalRecipientClick" type="long"/>
        <attribute label="Complaints" name="screamers" type="long"/>
        <attribute label="Amount" name="amount" type="double"/>
        <attribute label="Item" name="article" type="long"/>
        <attribute label="Mirror pages" name="mirrorPage" type="long"/>
        <attribute label="Unsubscriptions" name="optOut" type="long"/>
        <attribute label="Web pages" name="totalWebPage" type="long"/>
        <attribute label="Transaction" name="transaction" type="long"/>
        <attribute label="Distinct web pages" name="webPage" type="long"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="xtk:report.png" implements="xtk:persist" label="Delivery exclusions" labelSingular="Delivery exclusion" name="dlvExclusion" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="xtk:report.png" name="dlvExclusion" pkgStatus="never">
        <key name="id">
          <keyfield xlink="delivery"/>
          <keyfield xlink="typologyRule"/>
        </key>
        <attribute desc="Volume excluded by the rule" label="Volume" name="count" type="long"/>
        <attribute desc="Date of application of the rule" label="Application date" name="applied" type="datetime"/>
        <element integrity="neutral" label="Delivery" name="delivery" revIntegrity="own" revLabel="Causes of exclusion" target="nms:delivery" type="link"/>
        <element integrity="neutral" label="Typology rule" name="typologyRule" revIntegrity="neutral" target="nms:typologyRule" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Domains known as valid for email addresses" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:valid.png" implements="xtk:persist" label="Domains" labelSingular="Domain" name="domain" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="nms:valid.png" name="domain">
        <compute-string expr="@domain"/>
        <key name="domain">
          <keyfield xpath="@domain"/>
        </key>
        <attribute desc="Domain for email addresses" label="Domain" length="80" name="domain" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Definition of external accounts (Email, SMS...) used by the modules" entitySchema="xtk:srcSchema" implements="xtk:persist" label="External Accounts" labelSingular="External account" name="extAccount" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="delivery" name="type">
        <value desc="POP3 account, used only for bounce mails." img="nms:miniatures/mini-inmail.png" label="Bounce mails (POP3)" name="bounces" value="0"/>
        <value desc="Routing outsourcer used for deliveries." img="nms:miniatures/mini-delivery.png" label="Routing" name="delivery" value="3"/>
        <value desc="FTP account." img="nms:miniatures/mini-ftp.png" label="FTP" name="ftp" value="4"/>
        <value desc="HTTP account." img="nms:miniatures/mini-http.png" label="HTTP" name="http" value="5"/>
        <value desc="Generic POP3 account." img="nms:miniatures/mini-inmail.png" label="POP3" name="pop3" value="6"/>
        <value applicableIf="HasPackage('nms:federatedDataAccess') OR HasPackage('nms:messageCenterControl') OR HasPackage('nms:interactionControl') OR HasPackage('nms:midEmitter')" desc="Account to access an external database" img="nms:miniatures/mini-dbImport.png" label="External database" name="sql" value="7"/>
        <value applicableIf="HasPackage('nms:webAnalytics')" desc="Web analytics" img="nms:miniatures/mini-webAnalytics.png" label="Web Analytics" name="webAnalytics" value="8"/>
        <value applicableIf="HasPackage('nms:social')" desc="Facebook Connect - OAuth" img="nms:miniatures/facebook.png" label="Facebook Connect" name="oauthFacebook" value="9"/>
        <value applicableIf="HasPackage('nms:messageCenterControl') or HasPackage('nms:interactionControl')" desc="Execution instance" img="nms:mcExtAccount.png" label="Execution instance" name="executionInstance" value="11"/>
        <value applicableIf="HasPackage('nms:macIntegration')" desc="Adobe Marketing Cloud" img="nms:miniatures/mini-mac-integration.png" label="Adobe Marketing Cloud" name="mac" value="13"/>
        <value desc="SFTP account" img="nms:miniatures/mini-sftp.png" label="SFTP" name="sftp" value="14"/>
        <value applicableIf="HasPackage('nms:aemIntegration')" desc="AEM" img="nms:aemContent.png" label="AEM" name="aem" value="12"/>
      </enumeration>
      <enumeration basetype="byte" default="none" name="encryptionType">
        <value label="None" name="none" value="0"/>
        <value label="SSL" name="ssl" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="incomingMail" name="EMailFunction">
        <value label="Inbound email" name="incomingMail" value="0"/>
        <value label="SOAP router" name="SOAPRouter" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="JavaScript" name="activationMode">
        <value label="Call Web Service" name="SoapCall" value="1"/>
        <value label="Call JavaScript" name="JavaScript" value="2"/>
        <value label="Wake up workflow" name="Workflow" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="netsize" name="mobileConnector">
        <value label="Generic" name="generic" value="1"/>
        <value label="NetSize" name="netsize" value="0"/>
        <value label="Generic SMPP" name="smppGen" value="2"/>
        <value label="Sybase365 (SMPP)" name="smppSyb365" value="3"/>
        <value label="mBlox (SMPP)" name="smppmBlox" value="4"/>
        <value label="Tele2 (SMPP)" name="smppTele2" value="5"/>
        <value label="O2 (SMPP)" name="smppO2" value="6"/>
        <value label="iOS" name="ios" value="20"/>
      </enumeration>
      <enumeration basetype="string" default="default" name="smppIdEncodeStyle">
        <value label="Default behavior" name="default" value="default"/>
        <value label="Do not modify" name="passThru" value="passThru"/>
        <value label="Decimal value" name="decimal" value="decimal"/>
        <value label="Hexadecimal value" name="hexadecimal" value="hexadecimal"/>
      </enumeration>
      <enumeration basetype="string" default="GSM7" name="smppCharset">
        <value label="GSM 7" name="GSM7" value="X-Gsm7Bit"/>
        <value label="Latin-1 (ISO-8859-1)" name="Latin_1" value="ISO-8859-1"/>
        <value label="US-ASCII" name="ASCII" value="US-ASCII"/>
        <value label="Unicode (UCS2)" name="UCS2" value="UTF-16BE"/>
        <value label="Latin/Cyrillic (ISO-8859-5)" name="cyrillic" value="ISO-8859-5"/>
        <value label="Latin/Hebrew (ISO-8859-8)" name="hebrew" value="ISO-8859-8"/>
      </enumeration>
      <enumeration basetype="byte" default="adobeGenesis" name="webAnalyticsPartner">
        <value label="Adobe-Genesis" name="adobeGenesis" value="1"/>
        <value label="Other" name="other" value="10"/>
      </enumeration>
      <enumeration basetype="byte" default="webService" name="mcHistoMethod">
        <value label="Web service" name="webService" value="0"/>
        <value label="Federated Data Access (FDA)" name="fda" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="undefined" name="realtimeSubStatus">
        <value label="Undefined" name="undefined" value="0"/>
        <value label="Approved subscription" name="subscribed" value="1"/>
        <value label="Unsubscription approved" name="unsubscribed" value="2"/>
      </enumeration>
      <element name="cnxParams">
        <attribute desc="Server address" img="xtk:server.png" label="Server" length="80" name="server" type="string"/>
        <attribute desc="Server port" label="Port" length="20" name="port" type="string"/>
        <attribute desc="Name (or login) of account" img="xtk:login.png" label="Account" length="80" name="account" type="string"/>
        <attribute desc="Password associated with account" edit="PasswordEdit" img="xtk:passwd.png" label="Password" length="128" name="password" pkgStatus="never" type="string"/>
        <attribute desc="Name of the Marketing Cloud tenant" img="xtk:server.png" label="Tenant" length="80" name="tenant" type="string"/>
        <attribute desc="Unique organization identifier within the Adobe Marketing Cloud for the IMS SSO." img="xtk:server.png" label="IMS organization ID" length="80" name="imsOrgId" type="string"/>
        <attribute desc="IMS server address" img="xtk:server.png" label="IMS server" length="80" name="imsServer" type="string"/>
        <attribute desc="User's IMS scope" label="IMS scope" length="400" name="userScope" type="string"/>
        <attribute desc="Regular expression used to extract the name of the Adobe Campaign right corresponding to the IMS group name" label="Association mask" length="40" name="imsRightsMask" type="string"/>
        <attribute desc="Client identifier for IMS users" img="xtk:login.png" label="IMS client identifier" length="40" name="clientId" type="string"/>
        <attribute desc="Client secret for IMS users" edit="PasswordEdit" img="xtk:login.png" label="IMS client secret" length="128" name="clientSecret" pkgStatus="never" type="string"/>
        <attribute desc="Callback server address" img="xtk:server.png" label="Callback server" length="80" name="callbackServer" type="string"/>
      </element>
      <element name="webAnalyticsParamsAgr">
        <element name="webAnalyticsParams">
          <attribute enum="webAnalyticsPartner" label="Partner" name="partner" type="string" xml="true"/>
          <element label="Tracked URL calculation formula" name="clickFormula" type="CDATA" xml="true"/>
          <attribute default="180" label="Lifespan (days)" name="purge" type="long" xml="true"/>
          <attribute default="7" label="Persistence (days)" name="persistence" type="long" xml="true"/>
          <element name="integrationDetails">
            <attribute expr="[../../@name]" name="integrationName" type="string"/>
            <attribute default="md5digest(GetOption('XtkDatabaseId') + @name)" label="Account ID" name="integrationValue" type="string" xml="true"/>
            <attribute label="Integration code" name="integrationCode" type="string" xml="true"/>
            <attribute label="Email" name="integrationEmail" type="string" xml="true"/>
            <attribute label="Product code" name="productCode" type="string" xml="true"/>
            <attribute label="Product name" name="productName" type="string" xml="true"/>
            <attribute label="Set of reports" name="reportSuiteId" type="string" xml="true"/>
            <attribute label="Company" name="company" type="string" xml="true"/>
            <attribute label="Creation date" name="creationDate" type="string" xml="true"/>
            <attribute label="Identifier of database" name="dataSourceId" type="string" xml="true"/>
            <attribute advanced="true" label="SOAP end point" name="soapEndPoint" type="string" xml="true"/>
            <element desc="List of selected segments" label="Segments" name="segments" xml="true">
              <element label="Segment" name="segment" unbound="true">
                <key>
                  <keyfield xpath="@name"/>
                </key>
                <attribute label="Segment name" length="128" name="name" type="string"/>
                <element label="Workflow" name="workflow" target="xtk:workflow" type="link"/>
                <element label="Delivery template" name="deliveryTemplate" target="nms:delivery" type="link"/>
              </element>
            </element>
          </element>
        </element>
      </element>
      <element name="facebook">
        <element label="Facebook parameters" name="facebookParams">
          <attribute label="Access token" name="accessToken" type="string" xml="true"/>
          <attribute desc="Page synchronization filter" label="Filter" name="filter" type="string" xml="true"/>
          <attribute enum="realtimeSubStatus" label="Status of the subscription to real-time notifications" name="realtimeSubStatus" type="byte" xml="true"/>
          <attribute default="'http://www.adobe.com'" label="Marketing URL" name="marketingURL" type="string" xml="true"/>
        </element>
      </element>
      <element name="oauth">
        <element label="OAuth parameters" name="oauthParams">
          <attribute default="true" label="Third-party application" name="thirdPartyApplication" type="boolean" xml="true"/>
          <attribute label="Application ID" name="consumerKey" type="string" xml="true"/>
          <attribute label="Application secret" name="consumerSecret" type="string" xml="true"/>
          <attribute label="Canvas URL" name="callbackUrl" type="string" xml="true"/>
          <attribute label="Secure Canvas URL" name="secureCallbackUrl" type="string" xml="true"/>
          <attribute label="Extended rights" name="xFacebookPerms" type="string" xml="true"/>
        </element>
      </element>
      <element autopk="true" enumImage="@type" folderModel="nmsExtAccount" fullLoad="true" name="extAccount" pkgAdmin="@id != 0 AND @packageAutoExport=1">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'EXT'+CounterValue('nmsExtAccount')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute desc="Account type" enum="nms:extAccount:type" label="Type" name="type" type="byte"/>
        <attribute default="1" desc="Account enabled" label="Enabled" name="active" type="boolean"/>
        <attribute default="0" desc="Exported in automatic packages" label="Exported automatically" name="packageAutoExport" type="boolean"/>
        <element aggregate="cnxParams" name="cnxParams"/>
        <element aggregate="webAnalyticsParamsAgr" applicableIf="HasPackage('nms:webAnalytics')" name="webAnalyticsParamsAgr"/>
        <attribute enum="xtk:serverConf:provider" label="Type" name="provider" type="string"/>
        <attribute desc="Base identifier" label="Database" name="dbName" type="string"/>
        <attribute desc="Data stored in unicode in the database" label="Unicode data" name="unicodeData" type="boolean"/>
        <attribute desc="Use unicode type storage in the database" label="Use unicode storage" name="NChar" type="boolean"/>
        <attribute desc="Path of the mass insert tool" label="Mass insert tool" name="bulkCopyUtility" type="string" xml="true"/>
        <attribute desc="Name of database schema that stocks work tables." label="Working schema" name="dbSchema" type="string" xml="true"/>
        <attribute desc="Tables and functions prefix" label="Tables and functions prefix" name="prefix" type="string" xml="true"/>
        <attribute default="''" label="Time zone" name="timezone" template="xtk:common:timezone"/>
        <attribute advanced="true" expr="TimeZoneName(@timezone)" name="timezoneName" type="string" xml="true"/>
        <attribute desc="Options" label="Options" name="options" type="string" xml="true"/>
        <attribute default="false" desc="Target of an 'HTTP relay to remote database' account" label="Target of an 'HTTP relay to remote database' account" name="httpRelayTarget" type="boolean" xml="true"/>
        <attribute default="0" desc="Encryption type of connection" enum="nms:common:pop3TLSMode" label="Encryption" name="encryptionType" type="byte"/>
        <attribute desc="Specifies whether the account is used to handle inbound emails or SOAP requests" enum="EMailFunction" label="Function" name="EMailFunction" type="byte"/>
        <attribute applicableIf="HasPackage('nms:messageCenter') or HasPackage('nms:interactionControl')" label="Execution instance type" name="executionInstanceType" type="byte"/>
        <attribute applicableIf="HasPackage('nms:messageCenter')" desc="Message Center" expr="IsBitSet(@executionInstanceType, 1)" label="Message Center" name="isMessageCenter" type="boolean"/>
        <attribute applicableIf="HasPackage('nms:interactionControl')" desc="Interaction" expr="Iif(IsBitSet(@executionInstanceType, 2)=2, 1, 0)" label="Interaction" name="isInteraction" type="boolean"/>
        <attribute applicableIf="HasPackage('nms:messageCenter') or HasPackage('nms:interactionControl')" defOnDuplicate="true" label="Execution instance ID" name="executionInstanceId" type="long" xml="true"/>
        <attribute desc="Channel for the deliveries executed by this outsourcer." enum="nms:delivery:messageType" label="Channel" name="messageType" type="byte"/>
        <attribute desc="Delivery mode for deliveries performed by this outsourcer." enum="nms:delivery:deliveryMode" label="Delivery mode" name="deliveryMode" type="byte"/>
        <attribute advanced="true" desc="URL of the mirror page server" label="Mirror page URL" name="mirrorURL" type="string"/>
        <element advanced="true" dataPolicy="emailOrScript" desc="Technical address for bounce messages for this server." label="Error address" name="errorAddress" type="CDATA" xml="true"/>
        <element desc="Workflow to execute when the delivery is approved" label="Post-processing" name="workflow" target="xtk:workflow" type="link" xml="true"/>
        <attribute default="'signal'" desc="Activity in the post-processing workflow on which the event is generated" label="Activity" name="activity" type="string" xml="true"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:midEmitter')" default="false" desc="Routing with alternating mid-sourcing accounts" label="Multiple mid-sourcing routing" name="multiMidProvider" type="boolean"/>
        <element advanced="true" applicableIf="HasPackage('nms:midEmitter')" label="Mid-sourcing account" name="subProvider" ordered="true" unbound="true" xml="true">
          <key name="subProviderId">
            <keyfield xpath="@name"/>
          </key>
          <attribute advanced="true" label="Identifier" name="accountId" type="string"/>
          <attribute default="true" desc="Authorize sending messages through this account" label="Active" name="active" type="boolean"/>
          <attribute advanced="true" label="Account label" name="label" type="string"/>
          <attribute label="Routing name" name="name" type="string"/>
        </element>
        <attribute advanced="true" applicableIf="HasPackage('nms:midEmitter')" default="''" desc="Last account used in multiple mid-sourcing" label="Last account used" name="lastMultiUsed" template="xtk:common:name"/>
        <attribute advanced="true" enum="activationMode" label="Activation mode" name="activationMode" type="byte" xml="true"/>
        <attribute advanced="true" label="Access URL of the connector" name="connectorUrl" type="string" xml="true"/>
        <element advanced="true" desc="JavaScript to execute to process a delivery part" label="JavaScript used in connector" name="connectorJs" target="xtk:javascript" type="link" xml="true"/>
        <element advanced="true" desc="Workflow to wake up to process a delivery part" label="Workflow of the connector" name="connectorWkf" target="xtk:workflow" type="link" xml="true"/>
        <attribute advanced="true" enum="mobileConnector" label="Connector" name="mobileConnector" type="byte" xml="true"/>
        <element advanced="true" name="params" xml="true">
          <attribute desc="Send Endpoint" label="Send Endpoint" name="endPointSend" type="string"/>
          <attribute desc="Endpoint to use for inbound messages" label="Reception Endpoint" name="endPointReceipt" type="string"/>
          <attribute desc="Endpoint to use to retrieve notifications" label="Notification Endpoint" name="endPointNotif" type="string"/>
          <attribute desc="Identifies the nature of the ESME client establishing a sending session" label="System type" length="13" name="systemType" type="string"/>
          <attribute desc="Identifies the nature of the ESME client establishing a receiving session" label="System type MO" length="13" name="systemTypeMO" type="string"/>
          <attribute label="Source number" name="sourceAddress" type="string"/>
          <attribute label="Source TON" name="sourceTon" type="byte"/>
          <attribute label="Source NPI" name="sourceNpi" type="byte"/>
          <attribute label="Destination TON" name="destinationTon" type="byte"/>
          <attribute label="Destination NPI" name="destinationNpi" type="byte"/>
          <attribute desc="Coding of the gateway identifier when sending" enum="smppIdEncodeStyle" label="Coding when sending" name="submitRespIdEncode" type="string"/>
          <attribute desc="Coding of the gateway identifier when receiving" enum="smppIdEncodeStyle" label="Coding when receiving" name="deliverIdEncode" type="string"/>
          <attribute desc="Outbound SMS character charset" enum="smppCharset" label="Outbound SMS coding" name="defaultMtCharset" type="string"/>
          <attribute desc="Inbound SMS character charset" enum="smppCharset" label="Inbound SMS coding" name="defaultMoCharset" type="string"/>
          <element name="wapPush">
            <element aggregate="cnxParams" name="cnxParams"/>
            <attribute desc="Send Endpoint" label="Send Endpoint" name="endPointSend" type="string"/>
            <attribute desc="Endpoint to use to retrieve notifications" label="Notification Endpoint" name="endPointNotif" type="string"/>
          </element>
          <element name="mms">
            <element aggregate="cnxParams" name="cnxParams"/>
            <attribute desc="Send Endpoint" label="Send Endpoint" name="endPointSend" type="string"/>
            <attribute desc="Endpoint to use for inbound messages" label="Reception Endpoint" name="endPointReceipt" type="string"/>
            <attribute desc="Endpoint to use to retrieve notifications" label="Notification Endpoint" name="endPointNotif" type="string"/>
          </element>
          <element aggregate="oauth" applicableIf="HasPackage('nms:social')" name="oauth"/>
          <element aggregate="facebook" applicableIf="HasPackage('nms:social')" name="facebook"/>
        </element>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element name="comment" template="xtk:common:comment"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsExtAccount', [@_folder-id])" label="External account folder" name="folder" required="true" revDesc="External accounts contained in this folder" revIntegrity="define" revLabel="External Accounts" target="xtk:folder" type="link"/>
        <element applicableIf="HasPackage('nms:social')" defOnDuplicate="true" label="Service folder" name="folderSetOfServices" required="true" revDesc="Information Services in the folder" revIntegrity="define" revLabel="External Accounts" target="xtk:folder" type="link"/>
        <element applicableIf="HasPackage('nms:messageCenter') OR HasPackage('nms:interactionControl') OR HasPackage('nms:midEmitter')" label="FDA account" name="fdaExtAccount" revCardinality="single" revExternalJoin="true" revLabel="Execution instance" target="nms:extAccount" type="link"/>
        <attribute applicableIf="HasPackage('nms:messageCenter')" enum="mcHistoMethod" label="Historization method" name="mcHistoMethod" type="byte"/>
      </element>
      <methods>
        <method name="TestAccount" static="true">
          <parameters>
            <param desc="Account type" name="type" type="byte"/>
            <param desc="Server address" name="server" type="string"/>
            <param desc="Name (or login) of account" name="account" type="string"/>
            <param desc="Password associated with account" name="password" type="string"/>
            <param desc="Server port" name="port" type="string"/>
            <param desc="Connection options" name="options" type="string"/>
          </parameters>
        </method>
        <method name="CreateFDASchema" static="true">
          <parameters>
            <param desc="Server address" name="server" type="string"/>
            <param desc="Name (or login) of account" name="account" type="string"/>
            <param desc="Password associated with account" name="password" type="string"/>
            <param desc="Server port" name="port" type="string"/>
            <param desc="Connection options" name="options" type="string"/>
            <param desc="Schema name" name="schema" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:extAccount.js" name="InitializeExecutionInstanceAccount" static="true">
          <parameters>
            <param desc="Account ID" inout="in" name="extAccountId" type="long"/>
            <param desc="Execution instance identifier" inout="out" name="executionInstanceId" type="long"/>
          </parameters>
        </method>
        <method library="nms:federatedDataAccess.js" name="DeploySQLFunctions" static="true">
          <parameters>
            <param desc="Internal Name or PrimaryKey of the external Account" inout="in" name="extAccountId" type="string"/>
          </parameters>
        </method>
        <method library="nms:federatedDataAccess.js" name="DeclareTableSpaces" static="true">
          <parameters>
            <param desc="Internal name or primary key of the external Account" inout="in" name="extAccountId" type="string"/>
            <param desc="Name of the tablespace to use for remote work tables" inout="in" name="tableSpace" type="string"/>
            <param desc="Name of the tablespace to use for indexes" inout="in" name="tableSpaceIndex" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:webAnalyticsIntegration.js" name="GetIntegrationDetails" static="true">
          <parameters>
            <param desc="Partner" name="partner" type="int"/>
            <param desc="Integration name" name="integrationName" type="string"/>
            <param desc="Integration value" name="integrationValue" type="string"/>
            <param desc="Login account" name="username" type="string"/>
            <param desc="Password" name="password" type="string"/>
            <param desc="Integration details" inout="out" name="output" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:webAnalyticsIntegration.js" name="CopySegmentsInOption" static="true">
          <parameters>
            <param desc="Account name" name="name" type="string"/>
            <param desc="New account name" name="newName" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:webAnalyticsIntegration.js" name="GetSegments" static="true">
          <parameters>
            <param desc="External account ID" name="extAccountId" type="int"/>
            <param desc="List of segments" inout="out" name="output" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:webAnalyticsIntegration.js" name="InitAppendClickFormula" static="true">
          <parameters>
            <param desc="Partner" name="partner" type="int"/>
            <param desc="URL mask" name="mask" type="string"/>
            <param desc="Formula" inout="out" name="output" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:webAnalyticsIntegration.js" name="SetRemarketingParams" static="true">
          <parameters>
            <param desc="Campaign ID" name="operationId" type="int"/>
            <param desc="External account ID" name="extAccountId" type="int"/>
            <param desc="Segment name" name="segmentName" type="string"/>
            <param desc="Delivery template ID" name="dlvTemplateId" type="int"/>
            <param desc="Name of the new workflow which will process the segment" inout="out" name="workflowName" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:webAnalyticsIntegration.js" name="GetRemarketingParams" static="true">
          <parameters>
            <param desc="Campaign ID" name="operationId" type="int"/>
            <param desc="External account ID" name="extAccountId" type="int"/>
            <param desc="Matching segment" inout="out" name="segment" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:extAccount.js" name="SubscribeToRealTimeUpdates" static="true">
          <parameters>
            <param desc="Internal name of the Facebook Connect type external account" name="name" type="string"/>
            <param desc="ID of the Facebook application" name="appId" type="string"/>
            <param desc="Facebook application secret" name="appSecret" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:extAccount.js" name="UnsubscribeToRealTimeUpdates" static="true">
          <parameters>
            <param desc="Internal name of the Facebook Connect type external account" name="internalName" type="string"/>
            <param desc="ID of the Facebook application" name="appId" type="string"/>
            <param desc="Facebook application secret" name="appSecret" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:messageCenter.js" name="UpdateMCSynchWkf" static="true">
          <parameters>
            <param desc="Message Center external account identifier" name="extAccountId" type="int"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:rcpgroup.png" implements="xtk:persist" label="Recipient list" labelSingular="List of recipients" name="group" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="nms" name="origin">
        <value img="nms:rcpgroup.png" label="Adobe Campaign" name="nms" value="0"/>
        <value img="nms:spss.png" label="SPSS" name="spss" value="1"/>
        <value img="nms:bo.png" label="Business Objects" name="bo" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="nms" name="type">
        <value img="nms:rcpgroup.png" label="Group" name="nms" value="0"/>
        <value img="nms:list.png" label="List" name="seg" value="1"/>
        <value img="xtk:file.png" label="File" name="file" value="2"/>
        <value img="nms:docview.png" label="Template" name="template" value="3"/>
      </enumeration>
      <enumeration basetype="string" default="text" name="textFormat">
        <value img="xtk:text.png" label="Text" name="text"/>
        <value img="xtk:text.png" label="Text using fixed width columns" name="fixed"/>
        <value img="xtk:csv.png" label="CSV (Excel)" name="csv"/>
      </enumeration>
      <enumeration basetype="byte" default="delimiter" name="colType">
        <value img="xtk:text.png" label="Delimited columns" name="delimiter" value="0"/>
        <value img="xtk:text.png" label="Fixed width columns" name="fixed" value="1"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="spaceXform">
        <value label="None" name="none"/>
        <value label="Ignore spaces" name="trim"/>
        <value label="Remove leading spaces" name="ltrim"/>
        <value label="Remove trailing spaces" name="rtrim"/>
        <value label="Remove all spaces (including inside the value)" name="full"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="stringXform">
        <value label="None" name="none"/>
        <value label="First letter in upper case" name="smart"/>
        <value label="Upper case" name="upper"/>
        <value label="Lower case" name="lower"/>
      </enumeration>
      <enumeration basetype="byte" default="default" name="nullValueChoice">
        <value label="Adobe Campaign default" name="default" value="0"/>
        <value label="Empty value allowed" name="allowNull" value="1"/>
        <value label="Always populated" name="notNull" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="none" name="columnProcessing">
        <value label="Ignore the value" name="none" value="0"/>
        <value label="Reject the line" name="reject" value="1"/>
        <value label="Use a default value in case of error" name="defaultOnErr" value="2"/>
        <value label="Use a default value in case the value is not remapped" name="defaultOnMissing" value="3"/>
        <value label="Reject the line when there is no remapping value." name="rejectOnMissing" value="4"/>
      </enumeration>
      <element autopk="true" enumImage="@createdFrom" filterPath="@label" folderModel="nmsGroup,crmListImport" fullLoad="true" img="nms:rcpgroup.png" name="group" pkgStatus="never">
        <compute-string expr="@label+ ' (' + @name + ')'"/>
        <dbindex name="label">
          <keyfield xlink="folder"/>
          <keyfield xpath="@label"/>
        </dbindex>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="'LST'+CounterValue('nmsList')" name="name" template="xtk:common:name"/>
        <attribute desc="Label of the list" label="Label" length="128" localizable="true" name="label" required="true" translatedDefault="'List '+CounterValue('nmsList')" type="string"/>
        <attribute default="getOption('Nms_DefaultRcpSchema')" desc="Schema of list items" label="Schema" length="64" name="schema" required="true" type="string"/>
        <attribute defOnDuplicate="true" label="Built in import template" name="builtIn" type="boolean"/>
        <attribute enum="type" label="List type" name="type" type="byte"/>
        <element doesNotSupportDiff="true" label="Extension data" name="extension" type="ANY" xml="true"/>
        <attribute name="deleteStatus" template="xtk:common:deleteStatus"/>
        <attribute name="deleteDate" template="xtk:common:deleteDate"/>
        <attribute desc="Expiration date" label="Expires on" name="expirationDate" type="datetime"/>
        <attribute applicableIf="HasPackage('nms:aamIntegration')" desc="Shared audience identifier" label="Audience identifier" length="64" name="segmentId" type="string"/>
        <attribute applicableIf="HasPackage('nms:aamIntegration')" desc="Audience Manager mapping identifier" label="AAM mapping ID" name="mappingId" type="string"/>
        <attribute applicableIf="HasPackage('nms:aamIntegration')" label="Delete disabled" name="deleteDisabled" type="boolean"/>
        <attribute desc="Origin of list creation" enum="origin" label="Origin" name="createdFrom" type="byte"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element name="desc" template="xtk:common:desc"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsGroup', [@_folder-id])" label="List folder" name="folder" required="true" revDesc="Recipient lists contained in this folder" revIntegrity="define" revLabel="Recipient lists" revLink="nmsGroup" target="xtk:folder" type="link"/>
        <element applicableIf="HasPackage('nms:aamIntegration')" integrity="neutral" label="AMC Data source" name="amcDataSource" revIntegrity="define" revLabel="Shared audience" revLink="group" target="nms:amcDataSource" type="link"/>
        <element desc="Workflow that created this list" label="Workflow" name="workflow" target="xtk:workflow" type="link"/>
        <element applicableIf="HasPackage('nms:campaign')" desc="Marketing campaign linked to the list" label="Marketing campaign" name="operation" target="nms:operation" type="link"/>
        <attribute label="Use a line number as identifier" name="collectLineNumber" type="boolean"/>
        <element name="source" template="xtk:common:fileToUpload" xml="true">
          <attribute enum="textFormat" label="Input format" name="format" type="string"/>
          <attribute name="lastParsedDataSource" type="string"/>
          <element name="dataSourceConfig" template="xtk:dataTransfer:dataSourceConfig">
            <attribute enum="colType" name="colType"/>
            <element name="dataSourceColumn">
              <attribute dataPolicy="none" name="name"/>
              <attribute desc="Use NULL values for missing values" enum="nullValueChoice" label="Allow NULLs" name="allowNullValues" type="byte"/>
              <attribute enum="spaceXform" label="White space management" name="spaceXform" type="string"/>
              <attribute enum="stringXform" label="Upper/lower case management" name="stringXform" type="string"/>
              <attribute enum="xtk:dataTransfer:columnType" label="New data type" name="typeXform" type="string"/>
              <element label="Remapping of values" name="valueMapping" ordered="true" unbound="true">
                <attribute label="Source value" name="src" type="string"/>
                <attribute label="Destination value" name="dst" type="string"/>
              </element>
              <attribute enum="nms:group:columnProcessing" label="Error processing" name="colProcessing" type="byte"/>
              <attribute label="Default value" name="default" type="string"/>
            </element>
          </element>
        </element>
        <attribute desc="File containing invalid lines" label="Rejection file" name="rejectFilename" type="string" xml="true"/>
        <attribute default="100" desc="Maximum number of errors before aborting" label="Errors before aborting" name="errorLimit" type="long" xml="true"/>
        <attribute advanced="true" default="true" desc="Do not keep a trace of this job in the database" label="Do not historize this job" name="doNotPersist" type="boolean" xml="true"/>
        <element integrity="own" name="log" revLink="job" target="xtk:jobLog" type="link" unbound="true"/>
      </element>
      <methods async="true">
        <method name="ImportFile"></method>
        <method name="Cleanup" static="true">
          <parameters>
            <param desc="List identifier" inout="in" name="jobId" type="string"/>
          </parameters>
        </method>
        <method library="nms:group.js" name="Register" pkonly="true">
          <parameters>
            <param desc="List of records to add" name="recipientList" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:group.js" name="Unregister" pkonly="true">
          <parameters>
            <param desc="List of records to delete" name="recipientList" type="DOMElement"/>
          </parameters>
        </method>
        <method name="BuildFromCube" static="true">
          <parameters>
            <param desc="List identifier" inout="in" name="listId" type="long"/>
            <param desc="Conditions to define list building" inout="in" name="conditions" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:macIntegration.js" name="createAudienceMapping" static="true">
          <parameters>
            <param desc="Segment ID" inout="in" name="segmentId" type="string"/>
            <param desc="Destination ID" inout="in" name="destinationId" type="int64"/>
            <param desc="Mapping ID" inout="out" name="mappingId" type="string"/>
          </parameters>
        </method>
        <method library="nms:macIntegration.js" name="deleteAudienceMapping" static="true">
          <parameters>
            <param desc="Segment ID" inout="in" name="segmentId" type="string"/>
            <param desc="Destination ID" inout="in" name="destinationId" type="int64"/>
            <param desc="Mapping ID" inout="in" name="oldMappingId" type="string"/>
            <param desc="Status" inout="out" name="successStatus" type="boolean"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Reusable content blocks that can be included in the customization" entitySchema="xtk:srcSchema" img="nms:docview.png" implements="xtk:persist" label="Personalization blocks" labelSingular="Personalization blocks" name="includeView" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="fragment" name="type">
        <value label="Personalization block" name="fragment" value="0"/>
        <value label="Content template" name="fullPage" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="shared" name="contentType">
        <value label="Shared" name="shared" value="0"/>
        <value label="Delivery" name="delivery" value="1"/>
        <value label="Web application" name="webApp" value="2"/>
      </enumeration>
      <element autopk="true" folderModel="nmsIncludeView" img="nms:docview.png" name="includeView" pkgAdmin="@id != 0">
        <compute-string expr="@label+ ' (' + @name + ')'"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'VIEW'+CounterValue('nmsView')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute advanced="true" enum="type" label="Type" name="type" type="byte"/>
        <attribute label="Miniature" length="255" name="thumbnail" type="string"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="1" desc="Defines if the view block must be displayed in customization menus" label="Visible in the customization menus" name="visible" type="boolean"/>
        <attribute enum="contentType" label="Content type" name="contentType" type="byte"/>
        <attribute advanced="true" label="Display sequence" name="order" type="long"/>
        <element name="source" xml="true">
          <attribute default="false" desc="The content of the personalization block depends upon the format (HTML or text)" label="Depends upon the format" name="dependOnFormat" type="boolean"/>
          <attribute default="false" desc="The content of the block is included in an attachment" label="Do not escape the content of the block" name="noEscaping" type="boolean"/>
          <element desc="'HTML' code of the block" label="HTML" localizable="true" name="html" type="CDATA"/>
          <element desc="'Text' code of the block" label="Text" localizable="true" name="text" type="CDATA"/>
        </element>
        <element name="content" xml="true">
          <element name="customRecipient" ref="nms:delivery:customization"/>
        </element>
        <element defOnDuplicate="true" default="Iif(@type = 1, DefaultFolder('nmsDigitalContentModel', [@_folder-id]), DefaultFolder('nmsIncludeView', [@_folder-id]))" label="Folder" name="folder" required="true" revDesc="Personalization blocks contained in this folder" revIntegrity="define" revLabel="Personalization blocks" target="xtk:folder" type="link"/>
      </element>
      <methods>
        <method hidden="true" name="ExtractAndPatchContent" static="true">
          <parameters>
            <param desc="Archive name (found in the upload folder of the instance)." inout="in" name="archiveName" type="string"/>
            <param desc="Also uploads external resources to publish them to the media servers." inout="in" name="getAndUploadExternalResources" type="boolean"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Personalization data parts used to build mirror pages" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Mirror page data parts" labelSingular="Mirror page data part" name="mirrorPageInfo" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="mirrorPageInfo" pkgStatus="never">
        <key internal="true">
          <keyfield xpath="@id"/>
        </key>
        <attribute label="Part identifier" name="id" sqlname="iMirrorPageInfoId" type="long"/>
        <element label="Delivery" name="delivery" revIntegrity="own" target="nms:delivery" type="link"/>
        <element name="message" ref="nms:deliveryPart:message" unbound="true" xml="true"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Table to lookup mirror pages" name="mirrorPageSearch" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="mirrorPageSearch" pkgStatus="never">
        <key internal="true" name="messageId">
          <keyfield xpath="@messageId"/>
        </key>
        <attribute label="Message identifier" name="messageId" type="long"/>
        <element advanced="true" label="Delivery log" name="broadLog" revCardinality="single" revIntegrity="own" target="nms:broadLog" type="link">
          <join xpath-dst="@id" xpath-src="@messageId"/>
        </element>
        <element advanced="true" label="Copy of the delivery part" name="mirrorPageInfo" noDbIndex="true" revIntegrity="neutral" target="nms:mirrorPageInfo" type="link"/>
        <element advanced="true" label="Delivery" name="delivery" revIntegrity="own" target="nms:delivery" type="link"/>
        <dbindex applicableIf="HasPackage('nms:midReceiver')" name="remoteId">
          <keyfield xpath="@remoteMessageId"/>
        </dbindex>
        <attribute applicableIf="HasPackage('nms:midReceiver')" label="Message identifier in the source database" name="remoteMessageId" type="long"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:rcpgroup.png" implements="xtk:persist" label="Recipient list contents" labelSingular="Recipient lists content" name="rcpGrpRel" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="nms:rcpgroup.png" name="rcpGrpRel" pkgStatus="never">
        <key internal="true" name="id">
          <keyfield xlink="rcpGroup"/>
          <keyfield xlink="recipient"/>
        </key>
        <dbindex name="recipientId">
          <keyfield xpath="@recipient-id"/>
        </dbindex>
        <element integrity="neutral" label="Recipient" name="recipient" revDesc="Lists to which the recipient belongs" revIntegrity="own" revLabel="Lists" target="nms:recipient" type="link"/>
        <element integrity="neutral" label="List" name="rcpGroup" revDesc="Recipients in the list" revIntegrity="own" revLabel="Recipients" revLink="rcpGrpRel" target="nms:group" type="link">
          <join xpath-dst="@id" xpath-src="@group-id"/>
        </element>
        <attribute label="Foreign key of link 'List' (field 'id')" name="group-id" sqlname="iGroupId" type="long"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Recipient table (profiles" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:recipient.png" label="Recipients" labelSingular="Recipient" name="recipient" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="gender">
        <value label="None specified" name="unknown" value="0"/>
        <value label="Male" name="male" value="1"/>
        <value label="Female" name="female" value="2"/>
      </enumeration>
      <enumeration basetype="byte" name="status">
        <value label="Prospect" name="prospect" value="0"/>
        <value label="Client" name="customer" value="1"/>
      </enumeration>
      <enumeration basetype="byte" name="messageFormat">
        <value label="Unknown" name="unknown" value="0"/>
        <value label="Text" name="text" value="1"/>
        <value label="HTML" name="html" value="2"/>
        <value desc="Edits the mail encoding to become a Deco-mail for Japanese provider DoCoMo" label="Deco-mail (DoCoMo)" name="deco" value="3"/>
        <value desc="Edits the mail encoding to become a Deco-mail for the Japanese provider KDDI AU" label="Decoration Mail (KDDI AU)" name="kddi" value="4"/>
        <value desc="Edits the mail encoding to become a Deco-mail for Japanese provider Softbank" label="Raku Deco (Softbank)" name="soft" value="5"/>
      </enumeration>
      <element autopk="true" filterPath="@email" folderModel="nmsRecipient" img="nms:recipient.png" name="recipient" pkgStatus="never">
        <compute-string expr="@lastName + ' ' + @firstName +' (' + @email + ')' "/>
        <dbindex name="lastName">
          <keyfield xlink="folder"/>
          <keyfield xpath="@lastName"/>
        </dbindex>
        <dbindex name="account">
          <keyfield xlink="folder"/>
          <keyfield xpath="@account"/>
        </dbindex>
        <dbindex name="email">
          <keyfield xlink="folder"/>
          <keyfield xpath="@email"/>
        </dbindex>
        <dbindex name="mobilePhone">
          <keyfield xlink="folder"/>
          <keyfield xpath="@mobilePhone"/>
        </dbindex>
        <dbindex name="lastModified">
          <keyfield xlink="folder"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <dbindex name="origin">
          <keyfield xlink="folder"/>
          <keyfield xpath="@origin"/>
        </dbindex>
        <dbindex name="email2">
          <keyfield xpath="@email"/>
        </dbindex>
        <attribute default="GetDate()" label="Creation date" name="created" type="datetime"/>
        <attribute label="Modification date" name="lastModified" type="datetime"/>
        <attribute label="Account #" length="30" name="account" type="string"/>
        <attribute desc="Origin of address (broker...)" label="Origin" length="80" name="origin" type="string" userEnum="origin"/>
        <attribute label="No longer contact (by any channel)" name="blackList" type="boolean"/>
        <attribute label="No longer contact by email" name="blackListEmail" type="boolean"/>
        <attribute label="No longer contact by phone" name="blackListPhone" type="boolean"/>
        <attribute label="No longer contact by fax" name="blackListFax" type="boolean"/>
        <attribute label="No longer contact by SMS/MMS" name="blackListMobile" type="boolean"/>
        <attribute label="No longer contact by direct mail" name="blackListPostalMail" type="boolean"/>
        <attribute dataPolicy="smartCase" desc="Recipient last name" label="Last name" length="50" name="lastName" type="string"/>
        <attribute dataPolicy="smartCase" desc="Recipient first name" label="First name" length="30" name="firstName" type="string"/>
        <attribute dataPolicy="smartCase" desc="Middle name of recipient" label="Middle name" length="30" name="middleName" type="string"/>
        <attribute desc="Recipient title" label="Salutation" length="20" name="salutation" type="string" userEnum="salutation"/>
        <attribute desc="Recipient sex" enum="nms:recipient:gender" label="Gender" name="gender" type="byte"/>
        <attribute label="Birth date" name="birthDate" type="date"/>
        <attribute desc="Age in years" expr="YearsOld([@birthDate])" label="Age" name="age" notNull="false" type="long"/>
        <attribute desc="Preferred language of the recipient" label="Language" length="32" name="language" type="string" userEnum="language"/>
        <attribute desc="Company name of recipient" label="Company" length="80" name="company" type="string" userEnum="company"/>
        <attribute name="email" template="xtk:common:email"/>
        <attribute desc="Domain part of the email" expr="GetEmailDomain([@email])" label="Email domain" name="domain"/>
        <attribute default="0" desc="Email format type" enum="nms:recipient:messageFormat" label="Email format" name="emailFormat" type="byte"/>
        <attribute name="mobilePhone" template="xtk:common:mobilePhone"/>
        <attribute name="phone" template="nms:common:phone"/>
        <attribute name="fax" template="nms:common:fax"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:purl')" desc="Calculated field dedicated to generating the guest ID." expr="@lastName+@firstName" label="Guest ID personalization" length="128" name="guestIdExpr" type="string"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:purl')" desc="Calculated field dedicated to generating the guest code." expr="@lastName+@firstName" label="Guest code personalization" length="128" name="guestCodeExpr" type="string"/>
        <attribute desc="Encrypted identifier to be used for web applications." expr="AESEncrypt(@id)" label="Encrypted identifier" name="cryptedId" type="string" xml="true"/>
        <element aggregate="nms:common:locationAggregate" name="location"/>
        <element externalJoin="true" label="Country" name="country" revIntegrity="normal" revLink="recipient" target="nms:country" type="link">
          <join xpath-dst="@isoA2" xpath-src="location/@countryCode"/>
        </element>
        <element desc="State/Province" externalJoin="true" label="State" name="stateLink" revLink="recipient" target="nms:state" type="link">
          <join xpath-dst="@code" xpath-src="location/@stateCode"/>
          <join xpath-dst="@countryCode" xpath-src="location/@countryCode"/>
        </element>
        <element name="postalAddress" template="nms:common:postalAddress">
          <attribute expr="SubString(JuxtWords3(Smart([../@salutation]), Smart([../@firstName]), Upper([../@lastName])), 1, 38)" name="line1"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" expr="Upper(SubString([../location/@address1], 1,38))" name="line2"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" expr="Upper(SubString([../location/@address2], 1,38))" name="line3"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" expr="Upper(SubString([../location/@address3],        1,38))" name="line4"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" expr="Upper(SubString([../location/@address4],       1,38))" name="line5"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" expr="Upper(SubString([../location/@additionalRcp], 1,38))" name="line2"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" expr="Upper(SubString([../location/@additionalGeo], 1,38))" name="line3"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" expr="Upper(SubString([../location/@street],        1,38))" name="line4"/>
          <attribute applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" expr="Upper(SubString([../location/@special],       1,38))" name="line5"/>
          <attribute expr="SubString(JuxtWords([../location/@zipCode], Upper([../location/@city])), 1,38)" name="line6"/>
          <attribute _operation="delete" name="line7"/>
          <element expr="@line1+'\n'+@line2+'\n'+@line3+'\n'+@line4+'\n'+@line5+'\n'+@line6" name="serialized"/>
          <attribute expr="AllNonNull3([../location/@zipCode], [../location/@city], [../@lastName])" name="addrDefined"/>
        </element>
        <element name="comment" template="xtk:common:comment"/>
        <element aggregate="nms:common:freeFields" name="freeFields"/>
        <attribute enum="nms:recipient:status" label="Status" name="status" type="byte"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsRecipient', [@_folder-id])" label="Folder" name="folder" revDesc="Recipients included in this folder" revIntegrity="define" revLabel="Recipients" target="xtk:folder" type="link"/>
        <element advanced="true" desc="Information about the email" externalJoin="true" integrity="neutral" label="Info on the email" name="emailInfo" revIntegrity="neutral" revLink="recipient" target="nms:address" type="link">
          <join xpath-dst="@address" xpath-src="@email"/>
        </element>
      </element>
      <methods>
        <method name="RegisterGroup" static="true">
          <parameters>
            <param desc="Lists" name="groupList" type="DOMElement"/>
            <param desc="Recipient list" name="recipientList" type="DOMElement"/>
            <param desc="Subscribe/Unsubscribe recipients" name="register" type="boolean"/>
          </parameters>
        </method>
        <method name="RegisterGroup2" static="true">
          <parameters>
            <param desc="Lists" name="groupList" type="DOMElement"/>
            <param desc="Recipient list" name="recipientList" type="DOMElement"/>
            <param desc="Recreate list" name="clearGroup" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ClearFolder" static="true">
          <parameters>
            <param desc="Folder ID" name="folderId" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ClearGroup" static="true">
          <parameters>
            <param desc="List ID" name="groupId" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Visitor table (profiles)" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:visitor.png" label="Visitors" labelSingular="Visitor" name="visitor" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="undefined" name="origin">
        <value img="nms:visitor.png" label="Undefined" name="undefined" value="0"/>
        <value applicableIf="HasPackage('nms:interaction')" img="nms:offer.png" label="Interaction" name="interaction" value="1"/>
        <value applicableIf="HasPackage('nms:social')" img="nms:facebook.png" label="Facebook" name="facebook" value="2"/>
        <value applicableIf="HasPackage('nms:social')" img="nms:twitter.png" label="Twitter" name="twitter" value="3"/>
      </enumeration>
      <element autopk="true" filterPath="@lastName" folderModel="nmsVisitor" img="nms:visitor.png" label="Visitor" name="visitor" pkgStatus="never">
        <compute-string expr="@lastName+' '+@firstName"/>
        <dbindex name="lastName">
          <keyfield xlink="folder"/>
          <keyfield xpath="@lastName"/>
        </dbindex>
        <dbindex name="email">
          <keyfield xlink="folder"/>
          <keyfield xpath="@email"/>
        </dbindex>
        <dbindex name="created">
          <keyfield xlink="folder"/>
          <keyfield xpath="@created"/>
        </dbindex>
        <dbindex name="lastModified">
          <keyfield xlink="folder"/>
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <dbindex name="externalId">
          <keyfield xlink="folder"/>
          <keyfield xpath="@externalId"/>
          <keyfield xpath="@origin"/>
        </dbindex>
        <attribute dataPolicy="smartCase" desc="Visitor's last name" label="Last name" length="50" name="lastName" type="string"/>
        <attribute dataPolicy="smartCase" desc="Visitor's first name" label="First name" length="30" name="firstName" type="string"/>
        <attribute desc="Visitor's email" label="Email" name="email" template="xtk:common:email"/>
        <attribute advanced="true" label="Identifier of the last delivery" name="deliveryId" type="long"/>
        <attribute label="Recipient identifier" name="recipientId" type="long"/>
        <attribute label="Referrer identifier" name="referrerId" type="long"/>
        <attribute dataPolicy="smartCase" label="Referrer last name" length="50" name="referrerLastName" type="string"/>
        <attribute dataPolicy="smartCase" label="Referrer first name" length="30" name="referrerFirstName" type="string"/>
        <attribute label="Referrer email" name="referrerEmail" template="xtk:common:email"/>
        <attribute label="Forward url" length="255" name="forwardUrl" type="string"/>
        <attribute default="GetDate()" label="Creation date" name="created" type="datetime"/>
        <attribute label="Modification date" name="lastModified" type="datetime"/>
        <element label="Referrer comment" length="255" name="comment" type="string"/>
        <attribute label="External ID" length="128" name="externalId" type="string"/>
        <attribute enum="origin" label="Origin" name="origin" type="byte"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Username" length="32" name="screenName" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Full name" length="128" name="name" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Image" length="256" name="picture" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Time zone" name="timezone" template="xtk:common:timezone"/>
        <attribute applicableIf="HasPackage('nms:social')" dbEnum="dictionaryLocale" label="Language" length="12" name="lang" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" enum="nms:recipient:gender" label="Gender" name="gender" type="byte"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Birth date" name="birthDate" type="date"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Place" length="128" name="location" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Number of friends" name="friendCount" type="long"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Access token" length="255" name="accessToken" type="string"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Token expiration date" name="tokenExpirationDate" type="datetime"/>
        <attribute applicableIf="HasPackage('nms:social')" desc="True if visitor existence has been confirmed" label="Checked" name="verified" type="boolean"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Last synchronized" name="lastSynchronized" type="datetime"/>
        <element applicableIf="HasPackage('nms:social')" desc="Last web application which updated this visitor." label="Web application" name="webApp" target="nms:webApp" type="link"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:social')" expr="@screenName" label="Twitter address" name="twitter"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:social')" expr="@accessToken" label="Facebook address" name="facebook"/>
        <attribute applicableIf="HasPackage('nms:social')" label="Sign in country code" length="2" name="signInCountryCode" type="string"/>
        <element integrity="neutral" label="Delivery" name="delivery" revLink="_NONE_" target="nms:delivery" type="link">
          <join xpath-dst="@id" xpath-src="@deliveryId"/>
        </element>
        <element defOnDuplicate="true" default="DefaultFolder('nmsVisitor', [@_folder-id])" externalJoin="true" label="Folder" name="folder" revDesc="Visitors in this folder" revIntegrity="define" revLabel="Visitors" target="xtk:folder" type="link"/>
        <element externalJoin="true" integrity="neutral" label="Referrer" name="referrerRcp" revLink="_NONE_" target="nms:recipient" type="link">
          <join xpath-dst="@id" xpath-src="@referrerId"/>
        </element>
        <element externalJoin="true" label="Recipient" name="recipient" revExternalJoin="true" revIntegrity="own" revLabel="Visitor" target="nms:recipient" type="link">
          <join xpath-dst="@id" xpath-src="@recipientId"/>
        </element>
        <element applicableIf="HasPackage('nms:social')" externalJoin="true" label="Sign in country" name="signInCountryCode" target="nms:country" type="link">
          <join xpath-dst="@isoA2" xpath-src="@signInCountryCode"/>
        </element>
      </element>
      <methods>
        <method library="nms:visitor.js" name="updateFacebookProfile" static="true">
          <parameters>
            <param inout="in" name="accessToken" type="string"/>
            <param desc="Returns the ID of the Adobe Campaign entity that matches the Facebook access token. If the code is different from 0, the call was successful." inout="out" name="result" type="long"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Access to the remote tracking management service" entitySchema="xtk:srcSchema" genAccessors="false" label="Remote tracking services" mappingType="xmlFile" name="remoteTracking" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="remoteTracking" pkgStatus="never"/>
      <methods>
        <method name="GetTrackingLogs4" static="true">
          <parameters>
            <param desc="Short identifier" name="instance" type="string"/>
            <param desc="Database identifier for customer performing a delivery" name="dbId" type="string"/>
            <param desc="Identifier (serialized int64) of log from which logs should be retrieved." inout="inout" name="pointer" type="string"/>
            <param desc="Number of logs to retrieve for the request (0 means default value), number of logs returned by response." inout="inout" name="logCount" type="long"/>
            <param desc="Logs retrieved" inout="out" name="logs" type="string"/>
            <param desc="GMT time of server at the moment of log retrieval request" inout="out" name="srvDate" type="datetime"/>
          </parameters>
        </method>
        <method name="GetTrackingLogs" static="true">
          <parameters>
            <param desc="Short identifier" name="instance" type="string"/>
            <param desc="Database identifier for customer performing a delivery" name="dbId" type="string"/>
            <param desc="Tracking log version" name="version" type="long"/>
            <param desc="Identifier (serialized int64) of log from which logs should be retrieved." inout="inout" name="pointer" type="string"/>
            <param desc="Number of logs to retrieve for the request (0 means default value), number of logs returned by response." inout="inout" name="logCount" type="long"/>
            <param desc="Logs retrieved" inout="out" name="logs" type="string"/>
            <param desc="GMT time of server at the moment of log retrieval request" inout="out" name="srvDate" type="datetime"/>
          </parameters>
        </method>
        <method name="PushTrackingInfo" static="true">
          <parameters>
            <param desc="Instance name" name="instance" type="string"/>
            <param desc="Database identifier for customer performing a delivery" name="dbId" type="string"/>
            <param desc="Delivery ID." name="jobId" type="string"/>
            <param desc="Document containing the tracking information for this delivery" name="document" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GetTrackingInfo" static="true">
          <parameters>
            <param desc="Instance name" name="instance" type="string"/>
            <param desc="Database identifier for customer performing a delivery" name="dbId" type="string"/>
            <param desc="Delivery ID." name="deliveryId" type="string"/>
            <param desc="Document containing the tracking information for this delivery" inout="out" name="document" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="RegisterInstance" static="true">
          <parameters>
            <param desc="Name of the instance to approve" name="instanceName" type="string"/>
            <param desc="Database identifier for customer performing a delivery" name="dbId" type="string"/>
            <param desc="Instance language" name="lang" type="string"/>
          </parameters>
        </method>
        <method name="CreateInstance" static="true">
          <parameters>
            <param desc="Name of the instance to create" name="instanceName" type="string"/>
            <param desc="DNS masks associated with the instance" name="hosts" type="string"/>
            <param desc="Database identifier for customer performing a delivery" name="dbId" type="string"/>
            <param desc="Encrypted password used for tracking" name="cryptedPwd" type="string"/>
            <param desc="Instance language" name="lang" type="string"/>
          </parameters>
        </method>
        <method name="PushRelayInfo" static="true">
          <parameters>
            <param desc="Instance name" name="instance" type="string"/>
            <param desc="Customer database identifier" name="dbId" type="string"/>
            <param desc="Document containing data" name="document" type="DOMDocument"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Non deliverable and bounce mail processing rules" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:ruleSet.png" implements="xtk:persist" label="Mail processing rules" name="ruleSet" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="mode">
        <value label="Inbound email" name="async" value="2"/>
        <value label="Domain management" name="domain" value="3"/>
        <value label="MX management" name="mx" value="4"/>
      </enumeration>
      <enumeration basetype="byte" name="failureType">
        <value label="Not defined" name="undefined" value="0"/>
        <value label="Soft" name="soft" value="1"/>
        <value label="Hard" name="hard" value="2"/>
        <value label="Ignored" name="ignored" value="3"/>
      </enumeration>
      <enumeration basetype="byte" name="failureReason">
        <value label="Not defined" name="Undefined" value="0"/>
        <value label="User unknown" name="UnknownUser" value="1"/>
        <value label="Invalid domain" name="InvalidDomain" value="2"/>
        <value label="Unreachable" name="Unreachable" value="3"/>
        <value label="Account disabled" name="Disabled" value="4"/>
        <value label="Mailbox full" name="MailboxFull" value="5"/>
        <value label="Not connected" name="NotConnected" value="6"/>
        <value label="Refused" name="Refused" value="20"/>
        <value desc="Error ignored since address is whitelisted" label="Error ignored" name="ErrorIgnored" value="25"/>
        <value label="Blacklisted address" name="Blacklisted" value="8"/>
      </enumeration>
      <element autopk="true" img="nms:ruleSet.png" name="ruleSet" pkgAdmin="@id != 0">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'RS'+CounterValue('nmsRuleSet')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute default="2" desc="Rule mode" enum="mode" label="Mode" name="mode" type="byte"/>
        <attribute default="1" desc="Used to temporarily disable the rule set" label="Enabled" name="active" type="boolean"/>
        <element name="rule" ordered="true" unbound="true" xml="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute name="name" template="xtk:common:name"/>
          <attribute default="1" desc="Allows to temporarily disable this rule" label="Enabled" name="active" type="boolean"/>
          <attribute desc="Failure type" enum="failureType" label="Type" name="failureType" type="byte"/>
          <attribute desc="Reason of failure" enum="failureReason" label="Reason" name="failureReason" type="byte"/>
          <element desc="Rule text" label="Text" name="text" type="memo"/>
          <attribute desc="Forward the message if rule applies" label="Forward" name="forward" type="boolean"/>
          <attribute desc="Address to use if the message must be forwarded." label="Forwarding address" length="80" name="forwardAddress" type="string"/>
        </element>
        <element label="Rule" name="domainRule" ordered="true" unbound="true" xml="true">
          <key name="mask">
            <keyfield xpath="@mask"/>
          </key>
          <attribute desc="Mask of domains to which the rule applies." label="Domain mask" name="mask" type="string"/>
          <attribute desc="Activate SenderID for these domains." label="Sender ID" name="senderID" type="boolean"/>
          <attribute desc="Activate DomainKeys signature for these domains." label="DomainKeys" name="domainKeys" type="boolean"/>
          <attribute desc="Activate the DKIM signature for messages of these domains." label="DKIM" name="dkim" type="boolean"/>
          <attribute desc="Activate the S/MIME signature for messages of these domains." label="S/MIME" name="smime" type="boolean"/>
          <attribute desc="Host name (alias DNS) of the SMTP relay for these domains." label="SMTP relay (hostname)" name="relayAddress" type="string"/>
          <attribute default="25" desc="SMTP relay port for these domains." label="SMTP relay (port)" name="relayPort" type="long"/>
        </element>
        <element label="Rule" name="MXRule" ordered="true" unbound="true" xml="true">
          <key allowEmptyPart="true" name="mask">
            <keyfield xpath="@mask"/>
            <keyfield xpath="@publicIds"/>
          </key>
          <attribute desc="Mask of MX records to the which the rule applies." label="MX mask" name="mask" type="string"/>
          <attribute desc="Range of public identifiers concerned by the rule." label="Range of identifiers" name="publicIds" type="string"/>
          <attribute desc="All the MX connection and message counters concerned by the rule are cumulated." label="Shared" name="shared" type="boolean"/>
          <attribute default="0" desc="Maximum number of simultaneous connections for these MXs." label="Maximum number of connections" name="maxConnections" type="long"/>
          <attribute default="0" desc="Maximum number of messages per concurrent connection for these MXs." label="Maximum number of messages" name="maxMessages" type="long"/>
          <attribute default="0" desc="Maximum number of messages per hour for a connection for these MXs." label="Messages per hour" name="maxMessagesPerHour" type="long"/>
          <attribute default="60" desc="SMTP timeout used for the connection phase." label="Connection timeout" name="connectionTimeout" type="timespan"/>
          <attribute desc="Timeout when sending message content (DATA)." label="Timeout Data" name="dataTimeout" type="timespan"/>
          <attribute desc="Timeout for other SMTP exchanges." label="Timeout" name="timeout" type="timespan"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" extendedSchema="xtk:serverConf" library="true" name="serverConf" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="normal" label="Synchronization status" name="syncStatus">
        <value label="Normal execution" name="normal" value="normal"/>
        <value label="Url blacklist in case of error 404" name="blacklist" value="blacklist"/>
        <value label="File upload on spare server if existing" name="spare" value="spare"/>
      </enumeration>
      <element desc="Configuration of delivery agents" label="mta" name="mta" template="xtk:serverConf:serverTask">
        <attribute default="2" desc="Display level of log messages." label="Log level" name="logLevel" type="long"></attribute>
        <attribute default="false" desc="Activates the verify mode (no physical transmission of messages; used for simulation and tests)." label="Verification mode" name="verifyMode" type="boolean"/>
        <attribute desc="If not empty, the path where all source files of sent emails will be saved." label="Save path of emails sent" name="dataLogPath" type="string"/>
        <attribute default="15" desc="Number of days before archived emails in the directory specified in dataLogPath are purged." label="Delay before archived emails are deleted" name="purgeDataLogDelay" type="long"/>
        <attribute default="'nlserver, Build $(PRODUCT_VERSION).$(BUILD_NUMBER)'" desc="Value of field 'X-Mailer' in SMTP mail header." label="X-Mailer field" name="xMailer" type="string"/>
        <attribute default="'$(XTK_INSTALL_DIR)/var/$(INSTANCE_NAME)/mta/'" desc="Location of temporary files used by the MTA to communicate with its child processes." label="Working directory" name="workingPath" type="string"/>
        <attribute desc="If not empty, copy MIME envelopes of sent mail messages in this directory. Used for trouble shooting." label="Dump directory" name="debugPath" type="string"/>
        <attribute default="1024" desc="Maximum memory size (in MB) that an mta process can use. Above this limit, the process is re-started so that the memory it uses is released to the system." label="Maximum memory consumption" name="maxMemoryMb" type="long"/>
        <attribute desc="HostName:Port used to relay notifications" label="Notification relay" name="notifRelay" type="string"/>
        <attribute default="true" desc="Delivery parts will be retried if the child process is dead." label="Retry lost messages" name="retryLostMessages" type="boolean"/>
        <element desc="Local file cache configuration" name="cache">
          <attribute default="3600" desc="Period in seconds between executions of the cache purge mechanism." label="Purge frequency" name="purgePeriodSec" type="long"/>
          <attribute default="244800" desc="Period, expressed in seconds, after which the file is automatically deleted from the cache to reclaim storage." label="Recycled after" name="maxPeriodSec" type="long"/>
          <attribute default="1024" desc="Maximum cache size (Mb)." label="Max. size (Mb)" name="maxSizeOnDiskMb" type="long"/>
        </element>
        <element desc="Configuration of the mail server for the message delivery." name="relay">
          <attribute desc="Comma-separated list of DNS names or IP addresses of SMTP relays to use." label="Address" name="address" type="string"/>
          <attribute default="25" desc="IP port of SMTP server." label="Port" name="port" type="long"/>
        </element>
        <element label="Configuration of principal server" name="master">
          <attribute default="0" desc="Minimum number of child servers." label="Minimum count" name="minSpareServers" type="long"></attribute>
          <attribute default="2" desc="Maximum number of child servers." label="Maximum count" name="maxSpareServers" type="long"></attribute>
          <attribute default="0" desc="Number of child server at start-up." label="Count when starting." name="startSpareServers" type="long"></attribute>
          <attribute default="30" desc="Database polling frequency of the jobs to be delivered." label="Search period" name="dataBasePoolPeriodSec" type="long"></attribute>
          <attribute default="60" desc="Waiting period after a database connection failure." label="Retry delay" name="dataBaseRetryDelaySec" type="long"></attribute>
          <attribute default="600" desc="Validity duration for the cache of private keys (DomainKeys)." label="Cache of private keys" name="domainKeysReloadPeriodSec" type="long"></attribute>
        </element>
        <attribute default="true" desc="Generate error statistics and store them in the database." label="Generate error statistics" name="logEmailErrors" type="boolean"/>
        <attribute default="300" desc="Time between generation of statistics and storage in the database." label="Error statistics frequency" name="errorPeriodSec" type="long"/>
        <attribute default="1" label="Error threshold to take into account" name="minErrorsToLog" type="long"></attribute>
        <attribute default="1000" label="Message threshold to take into account" name="minMessagesToLog" type="long"></attribute>
        <attribute default="100" label="Connection threshold to take into account" name="minConnectionsToLog" type="long"></attribute>
        <attribute desc="Address of the delivery statistics server, given as &lt;dns or ip>[:&lt;port>]. If not defined, the default port is 7777." label="Address of delivery statistics server" name="statServerAddress" type="string"/>
        <attribute desc="Communication protocol version (1 for a v5.11 and 6.0.2 server, 2 for a v6.1 server). If undefined, the latest version is used." label="Protocol version used" name="statServerVersion" type="string"/>
        <element label="Configuration of child servers" name="child">
          <attribute default="5000000" desc="Maximum count of messages per child server." label="Maximum count" name="maxMsgPerChild" type="long"></attribute>
          <attribute default="128" desc="Maximum memory size (in MB) that a child process can use. Above this limit, the process is stopped so that the memory it uses is released to the system." label="Maximum memory consumption" name="maxWorkingSetMb" type="long"/>
          <attribute default="2000" desc="Maximum number of messages waiting in memory to be delivered." label="Pending messages" name="maxWaitingMessages" type="long"/>
          <attribute default="60" desc="Timeout until idle child servers are stopped." label="Timeout" name="idleChildTimeoutSec" type="long"></attribute>
          <attribute default="48" desc="Maximum number of consecutive attempts when resumed." label="TTL" name="timeToLive" type="long"/>
          <attribute default="600" desc="Timeout (in seconds) after which a SOAP connection for a delivery connector is abandoned." label="SOAP connection timeout" name="soapConnectorTimeoutSec" type="long"/>
          <attribute default="600" desc="Maximum message retention time." label="Maximum message retention time" name="maxAgeSec" type="long"></attribute>
          <attribute default="false" label="Always start with the highest priority MX" name="startWithFirstMX" type="boolean"/>
          <element label="Configuration of SMTP sessions" name="smtp">
            <attribute default="1000" desc="Maximum number of SMTP sessions by child server." label="Maximum count" name="maxSessionsPerChild" type="long"></attribute>
            <attribute default="5" desc="Idle session timeout." label="Inactive session time-out" name="idleSessionTimeoutSec" type="long"></attribute>
            <attribute default="4" desc="Initial delay before retrying connection. This delay is doubled each time connection fails." label="Initial delay before retrying connection" name="initialDelaySec" type="long"/>
            <attribute default="false" desc="Activates the delivery of emails in safe mode (STARTTLS/SMTPS) when supported by the remote server." label="Activate SMTPS support" name="enableTLS" type="boolean"/>
            <element desc="Management of affinities with IP addresses for optimized outgoing SMTP traffic." label="IP affinity" name="IPAffinity" unbound="true">
              <key name="name">
                <keyfield xpath="@name"/>
              </key>
              <attribute desc="Names linked to the affinity by users. Names are separated using semicolons; " label="Logical name" name="name" type="string"/>
              <attribute desc="Local domain name linked to the IP address. Used when issuing an SMTP HELO command." label="Domain name" name="localDomain" type="string"/>
              <element desc="Outbound IP." label="IP" name="IP" unbound="true">
                <key name="address">
                  <keyfield xpath="@address"/>
                </key>
                <attribute desc="Associated physical address. Eg: '192.168.0.1' " label="Physical address" name="address" type="string"/>
                <attribute desc="Associated public address ID. Used as a key for the statistics server. Must be numeric." label="Public identifier" name="publicId" type="long"/>
                <attribute desc="Specifies the frequency of use for this IP, relative to other IPs (bigger weights lead to higher frequencies)." label="Weight" name="weight" type="long"/>
                <attribute desc="Comma separated list of domain masks to include" label="Domains" name="includeDomains" type="string"/>
                <attribute desc="Comma separated list of domain masks to exclude" label="Exclusions" name="excludeDomains" type="string"/>
                <attribute desc="Computer name linked to the IP address. Used when issuing an SMTP HELO command." label="HELO name" name="heloHost" type="string"/>
              </element>
            </element>
          </element>
          <attribute desc="Optional command line arguments" label="arguments" name="extraArgs" type="string"/>
        </element>
      </element>
      <element desc="Configuration of the inbound Email management module" label="Inbound emails" name="inMail" template="xtk:serverConf:serverTask">
        <attribute default="300" desc="POP3 polling period." label="POP3 pick up period" name="popMailPeriodSec" type="long"/>
        <attribute default="300" desc="Communication timeout with POP3 server." label="Timeout POP3" name="popTimeoutSec" type="long"/>
        <attribute default="5" desc="Message queue polling frequency." label="Message reading period" name="inMailPeriodSec" type="long"/>
        <attribute default="600" desc="Database reload frequency of accounts to be polled." label="Account reload period" name="reloadPeriodSec" type="long"/>
        <attribute default="100" label="Queue size of read messages" name="popQueueSize" type="long"/>
        <attribute default="200" desc="Maximum number of messages to read during POP3 session." label="Maximum number of messages read by session." name="maxMsgPerSession" type="long"/>
        <attribute default="100" desc="Maximum duration of message processing session" label="Session duration" name="maxSessionTTLSec" type="long"/>
        <attribute dataPolicy="email" desc="Default email transfer address not processed by a rule." label="Forwarding address" name="defaultForwardAddress" type="string"/>
        <attribute dataPolicy="email" desc="Default address used to transfer invalid Emails (bad MIME encoding)." label="Address for errors" name="errorForwardAddress" type="string"/>
        <attribute default="20" desc="Defines the maximum number of log messages to keep in memory before updating the database." label="Maximum number of logs to update." name="maxBroadLog" type="long"/>
        <attribute default="false" desc="Is used to ignore the size of a message returned by POP3 servers. In this case, the module expects a '.' at the end of the messages." label="Ignore message size" name="ignoreSize" type="boolean"/>
        <element desc="Dump of processed messages" label="Saving" name="msgDump">
          <attribute default="false" desc="Save all inbound messages in text format." label="Save messages" name="dump" type="boolean"/>
          <attribute default="'/tmp/inMail'" desc="Message dump path." label="Path for saving" name="msgPath" type="string"/>
        </element>
        <attribute default="true" desc="If true, the name of the Adobe Campaign instance contained in the Message-ID headers must be the same as the current instance." label="Verify instance name" name="checkInstanceName" type="boolean"/>
      </element>
      <element desc="Configuration of the inbound SMS management module" label="SMS module" name="sms" template="xtk:serverConf:serverTask">
        <attribute default="25" desc="Max. period in seconds between two frames for notifying that the receiving session is still enabled" label="Recurrence of the session continuity frame" name="keepAlivePeriod" type="long"/>
        <attribute default="300" desc="SMS account poll period." label="Search frequency" name="pollPeriod" type="long"/>
        <attribute default="600" desc="Database reload frequency of accounts to be polled." label="Account reload frequency" name="reloadPeriod" type="long"/>
        <attribute default="300" desc="Communication timeout with SMS gateway." label="Timeout" name="timeout" type="long"/>
        <attribute default="512" label="Maximum size in MB of the SMPP working files." name="dataSizeMo" type="long"/>
        <attribute default="60" label="Maximum number of days files working files kept by the SMPP connector." name="dataRetentionDays" type="long"/>
        <attribute default="600" desc="Only SRs with a recovery date earlier than the current time minus the duration in seconds given by srReadDelay." label="Number of seconds late for SR processing" name="srReadDelay" type="long"/>
        <element name="netsize">
          <attribute default="30" label="Timeout in seconds when establishing a connection with Netsize" name="netsizeConnectionTimeout" type="long"/>
        </element>
      </element>
      <element desc="Configuration of the tracking server" label="tracking" name="tracking" template="xtk:serverConf:serverTask">
        <attribute default="300" label="Consolidation period" name="consolidationPeriodSec" type="long"/>
        <attribute default="1000" desc="Number of logs requested by call to the remote tracking server" label="Number of logs" name="logCountPerRequest" type="long"/>
        <attribute default="2592000" desc="Duration after the validity date of a delivery after which consolidated indicators are no longer computed" label="Compute indicators during" name="indicatorsDuration" type="long"/>
        <attribute default="1" desc="Remove duplicate open tracking logs to limit the effects of mail previews in mail readers like Outlook." label="Deduplicate openings" name="dedupOpenPeriodMin" type="long"/>
        <attribute default="1" desc="Do not update tracking indicators as long as the ratio of logs not already taken into account does not reach this value." label="Ignore up to X% of tracking" name="trackingIgnorePercent" type="byte"/>
        <attribute default="86400" desc="Maximum duration before tracking indicators are recomputed." label="Update tracking indicators" name="trackingIgnorePeriod" type="long"/>
        <attribute default="1" desc="Do not update tracking indicators as long as the ratio of logs not already taken into account does not reach this value." label="Ignore up to X% of errors" name="errorIgnorePercent" type="byte"/>
        <attribute default="86400" desc="Maximum duration before error indicators are recomputed." label="Update error indicators" name="errorIgnorePeriod" type="long"/>
        <attribute default="500" desc="Size of browser identifier cache." label="UserAgents cache" name="userAgentCacheSize" type="long"/>
      </element>
      <element desc="Configuration of the tracking log writing daemon" label="Writing of tracking logs" name="trackinglogd" template="xtk:serverConf:serverTask">
        <attribute default="64" desc="Maximum number of characters saved in shared memory for extra web tracking parameters" label="Max number of characters for the web tracking" name="webTrackingParamSize" type="long"/>
        <attribute default="25000" desc="Maximum number of logs stored in shared memory. Cannot be less than 10000." label="Maximum log count" name="maxSharedLogs" type="long"/>
        <attribute default="50000" desc="Number of logs inserted before starting the purge of log files. May not be lower than 50000." label="Number of logs before purge" name="purgeLogsPeriod" type="long"/>
        <attribute default="500" desc="Maximum space used by logs on disk (in MB). May not be less than 100 MB." label="Maximum log size" name="maxLogsSizeOnDiskMb" type="long"/>
        <attribute default="5" desc="Maximum number of files that can be created in case of writing failure in log files." label="Max writing retries" name="maxCreateFileRetry" type="long"/>
      </element>
      <element desc="Configuring the write daemon for inbound Interaction events" label="Writing inbound Interaction events" name="interactiond" template="xtk:serverConf:serverTask">
        <attribute default="0" desc="Max. number of characters stored in the shared memory for call data" label="Max. number of characters for call data" name="callDataSize" type="long"/>
        <attribute default="16" desc="Max. number of characters stored in the shared memory for identifying individuals" label="Max. number of characters for identifying an individual" name="targetKeySize" type="long"/>
        <attribute default="0" desc="Maximum number of eligible offers sorted right after propositions, to be stored for statistics" label="Max. number of next eligible offers" name="nextOffersSize" type="long"/>
        <attribute default="25000" desc="Max. number of events stored in the shared memory." label="Max. number of events" name="maxSharedEntries" type="long"/>
        <attribute default="600" desc="Aggregation duration in seconds for the response time statistics. 0 means statistic storage was deactivated." label="Aggregation duration in seconds for the response time statistics" name="statsPeriod" type="long"/>
      </element>
      <element desc="Database repair module." label="Repair module" name="repair">
        <attribute default="60" desc="Delay (in minutes) after which delivery actions can be processed by the repair module." label="Delivery actions repair module" name="repairActionDelayMin" type="long"/>
      </element>
      <element name="web">
        <attribute default="8080" label="Tomcat HTTP listening port" name="httpPort" type="short"/>
        <attribute default="8005" label="Tomcat listening control port" name="controlPort" type="short"/>
        <attribute default="75" desc="Maximum number of threads." label="Maximum number of threads" name="MaxThreads" type="long"/>
        <attribute default="5" desc="Minimum number of threads." label="Minimum number of threads." name="MinSpareThreads" type="long"/>
        <attribute desc="Options of the JVM passed as a string." label="JVM options" name="JVMOptions" type="string"/>
        <element desc="Relay for HTTP requests between two zones" label="HTTP relay" name="relay">
          <attribute default="false" desc="Start the HTTP relay module" label="Start" name="startRelay" type="boolean"/>
          <attribute default="true" desc="Start the HTTP relay module within the Web server." label="Start" name="startRelayInModule" type="boolean"/>
          <attribute default="false" desc="Start the HTTP relay module within the Web server in debug mode" label="Debug mode" name="debugRelay" type="boolean"/>
          <attribute default="'.?#@/:'" desc="List of forbidden characters in the 'authority' section of a URI" label="Forbidden character(s) (Domain)" name="forbiddenCharsInAuthority" type="string"/>
          <attribute default="'?#/'" desc="List of forbidden characters in the 'path' section of a URI" label="Forbidden character(s) (Path)" name="forbiddenCharsInPath" type="string"/>
          <attribute default="'index.html'" desc="List of files to be used during a query on a folder" label="Value of the 'mod_dir' module option" name="modDir" type="string"/>
          <attribute default="'60'" desc="Wait time before deleting banned url" label="Wait time" name="timeout" type="string"/>
          <element desc="List of URLs to relay (insert order defines priority)." name="url" ordered="true" unbound="true">
            <default>&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true"
     status="normal" targetUrl="http://localhost:7781" timeout="" urlPath="/pipelined/*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="false" urlPath="/view/*"/&gt;
&lt;url IPMask="" deny="true" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="false" urlPath="*ooconv.jsp*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/sc.jssp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/interactionProposal.jssp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/zoneJson.jssp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/barcode.jsp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/captcha.jsp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/webForm.jsp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/zoneinfo.jsp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/facebookCallback.jssp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/m.jsp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="*/s.jsp"/&gt;

&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="blacklist" httpAllowed="false" urlPath="*.jsp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="blacklist" httpAllowed="false" urlPath="*.jssp"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="blacklist" httpAllowed="true" urlPath="/webApp/*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="blacklist" httpAllowed="false" urlPath="/report/*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="blacklist" httpAllowed="false" urlPath="/jssp/*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="false" urlPath="/strings/*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="/interaction/*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="true" relayPath="true" targetUrl="http://localhost:8080"
     timeout="" status="normal" httpAllowed="true" urlPath="/barcode/*"/&gt;

&lt;url IPMask="" deny="" hostMask="" relayHost="false" relayPath="false" targetUrl=""
     timeout="" status="spare" httpAllowed="true" urlPath="/favicon.*"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="false" relayPath="false" targetUrl=""
     timeout="" status="spare" httpAllowed="true" urlPath="/*.html"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="false" relayPath="false" targetUrl=""
     timeout="" status="spare" httpAllowed="true" urlPath="/*.png"/&gt;
&lt;url IPMask="" deny="" hostMask="" relayHost="false" relayPath="false" targetUrl=""
     timeout="" status="spare" httpAllowed="true" urlPath="/*.jpg"/&gt;</default>
            <key name="urlPath">
              <keyfield xpath="@urlPath"/>
            </key>
            <attribute desc="Mask of URLs to relay (ex: '/nl*', '*.jsp')." label="URL to relay" name="urlPath" type="string"/>
            <attribute desc="URL of the target page." label="URL of the target" name="targetUrl" type="string"/>
            <attribute desc="Append the complete path of the URLs to relay to the URL of the target page." label="Add initial URL path" name="relayPath" type="boolean"/>
            <attribute desc="use the HTTP 'Host' header of the original request when relaying." label="Add original host" name="relayHost" type="boolean"/>
            <attribute desc="Comma separated list of source IP addresses allowed to used the relay for this mask" label="Authorized IPs" name="IPMask" type="string"/>
            <attribute desc="Comma separated list of DNS alias masks to relay (ex: '*.adobe.com')." label="DNS alias to relay" name="hostMask" type="string"/>
            <attribute desc="Maximum execution time (in seconds) of the request being relayed" label="Timeout" name="timeout" type="long"/>
            <attribute desc="Http access authorized no matter what the security zone (like webApps)" label="Http access authorized" name="httpAllowed" type="boolean"/>
            <attribute desc="Url status for synchronization (blacklist, spare, normal)" enum="syncStatus" label="Synchronization status" name="status" type="string"/>
            <attribute desc="Deny access to these URLs (return an HTTP 403 error)" label="Deny access" name="deny" type="boolean"/>
          </element>
          <element desc="List of HTTP headers to add to replies forwarded to the relay." name="responseHeader" ordered="true" unbound="true">
            <attribute desc="Header name" label="Name" name="name" type="string"/>
            <attribute desc="Header value" label="Name" name="value" type="string"/>
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <default>&lt;responseHeader name="X-XSS-Protection" value="1; mode=block"/&gt;</default>
          </element>
        </element>
        <element desc="Configuration of the redirection module" name="redirection">
          <attribute default="true" desc="Start the redirection service." label="Redirection" name="startRedirection" type="boolean"/>
          <attribute default="true" desc="Start the redirection service in module mode." label="Redirection" name="startRedirectionInModule" type="boolean"/>
          <attribute desc="URL of Web page used by default by the redirection server when redirection for a delivery action has expired." label="Page for expired redirections" name="expirationURL" type="string"/>
          <attribute default="100" desc="Maximum number of delivery actions in cache. May not be lower than 50." label="Maximum job count" name="maxJobsInCache" type="long"/>
          <attribute default="30" desc="Number of logs returned by default upon a call of method GetTrackingLogs" label="Log count by call" name="defLogCount" type="long"/>
          <attribute default="false" desc="Creation of logs for the pages visited by unknown users." label="Web tracking" name="trackWebVisitors" type="boolean"/>
          <attribute desc="Password used by the redirection server" label="Password" name="trackingPassword" type="string"/>
          <attribute desc="Database identifier associated with the tracking instance" label="Database identifier" name="databaseId" type="string"/>
          <attribute default="'CAO DSP COR CURa DEVa TAIa OUR BUS IND UNI COM NAV'" desc="Value describing the policy used for permanent cookies (compliant with the P3P Compact Policy format)." label="P3P Compact Policy" name="P3PCompactPolicy" type="string"/>
          <attribute desc="Unique organization identifier within the Adobe Marketing Cloud, used in particular for the VisitorID service and the IMS SSO." label="IMS organization identifier" name="IMSOrgId" type="string"/>
          <element name="spareServer" unbound="true">
            <key name="id">
              <keyfield xpath="@id"/>
            </key>
            <attribute default="1" label="Name" name="id" type="string"/>
            <attribute desc="Extra redirection server URL" label="URL" name="url" type="string"/>
            <attribute desc="The tracking server is taken into account if the expression returns true" label="Taken into account if" name="enabledIf" type="string"/>
          </element>
        </element>
        <element desc="Email anti-spam scoring evaluation parameters" label="Anti-spam checking" name="spamCheck">
          <attribute default="''" desc="Command to execute to evaluate the anti-spam score of an email (e.g. 'perl spamcheck.pl')" label="Command" name="command" type="string"/>
        </element>
      </element>
      <element desc="Application option: Predictive Marketing." label="Predictive Marketing option" name="predictive">
        <attribute default="'http://localhost:8080'" desc="Root URL of the server to invoke the datamining connectors." label="Connector URL" name="url" type="string"/>
        <attribute desc="Default path and name of the KXEN configuration file, used when no path is specified in the predictive model." label="Path of KXEN configuration file" name="kxenConfigFile" type="string"/>
      </element>
      <element desc="Event processing module for the Pipeline Services" label="Connector for the Pipeline services" name="pipelined" template="xtk:serverConf:serverTask">
        <attribute desc="Name of the application generated in the Developer connection when the public key is saved." label="Name of the application created in the Marketing Cloud" name="appName" type="string"/>
        <attribute default="'https://api.omniture.com'" desc="URL to obtain a gateway token" label="URL to obtain a token" name="authGatewayEndpoint" type="string"/>
        <attribute desc="Private key to obtain tokens (encrypted in AES with the XtkKey option)" label="Private key to obtain tokens (encrypted in AES)" name="authPrivateKey" type="string"/>
        <attribute desc="Connect to Pipeline Services without authentication." label="Disable authentication" name="disableAuth" type="boolean"/>
        <attribute default="'https://producer-pipeline-pnw.adobe.net'" desc="URL to discover the Pipeline Services URL" label="URL to discover the listening URL" name="discoverPipelineEndpoint" type="string"/>
        <attribute desc="Force the listening URL of the Pipeline Services." label="Listening URL" name="forcedPipelineEndpoint" type="string"/>
        <attribute default="4" desc="Number of threads for event processing." label="Processing threads" name="processingThreads" type="long"/>
        <attribute default="4" desc="Number of threads for event processing with a personalized JavaScript connector." label="JS processing threads" name="processingJSThreads" type="long"/>
        <attribute default="1000" desc="The pointer will be stored in the database every time that this number of messages are processed." label="Number of messages to process before the pointer stored." name="pointerFlushMessageCount" type="long"/>
        <attribute default="5" desc="The pointer will be stored in the database at least once during this period (useful in case of low activity)." label="Delay before the pointer is stored" name="pointerFlushPeriodSec" type="long"/>
        <attribute default="0" desc="Frequency that the process's internal information is saved in a file. Inactive if 0." label="Status save period" name="dumpStatePeriodSec" type="long"/>
        <attribute default="7781" desc="HTTP server port allowing you to query the status of the process. Inactive if 0." label="Status server port" name="monitorServerPort" type="long"/>
        <attribute default="30" desc="Delay between processing if there is a failure" label="Delay between processing" name="retryPeriodSec" type="long"/>
        <attribute default="300" desc="Abandon the event if the processing is still failing after this period." label="Abandon after this period" name="retryValiditySec" type="long"/>
      </element>
      <element name="serverConf">
        <element name="mta" ref="mta"/>
        <element name="inMail" ref="inMail"/>
        <element name="sms" ref="sms"/>
        <element name="tracking" ref="tracking"/>
        <element name="trackinglogd" ref="trackinglogd"/>
        <element name="interactiond" ref="interactiond"/>
        <element name="repair" ref="repair"/>
        <element name="predictive" ref="predictive"/>
        <element name="pipelined" ref="pipelined"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" extendedSchema="xtk:serverOptions" genAccessors="false" library="true" name="serverOptions" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration default="none" name="imagePublishing">
        <value label="None" name="none" value="none"/>
        <value label="Tracking server(s)" name="tracking" value="tracking"/>
        <value label="Other Adobe Campaign server(s)" name="list" value="list"/>
        <value label="Manual publication script" name="script" value="script"/>
      </enumeration>
      <enumeration basetype="byte" default="session" name="webTrackingMode">
        <value label="Session web tracking" name="session" value="0"/>
        <value label="Permanent Web tracking (forced delivery)" name="permanent" value="1"/>
        <value label="Permanent Web tracking (last delivery)" name="permanentLastTouch" value="3"/>
        <value label="Anonymous Web tracking (forced delivery)" name="anonymous" value="2"/>
        <value label="Anonymous Web tracking (last delivery)" name="anonymousLastTouch" value="4"/>
      </enumeration>
      <element name="serverOptions">
        <element name="baseOption">
          <element name="email">
            <element label="Parameters for delivered emails" name="header">
              <attribute label="Sender name" name="fromName" sqlname="NmsEmail_FromName" type="string"/>
              <attribute dataPolicy="email" label="Sender address" name="defaultFromAddr" sqlname="NmsEmail_DefaultFromAddr" type="string"/>
              <attribute label="Reply address text" name="replyToName" sqlname="NmsEmail_ReplyToName" type="string"/>
              <attribute dataPolicy="email" label="Reply address" name="defaultReplyToAddr" sqlname="NmsEmail_DefaultReplyToAddr" type="string"/>
              <attribute dataPolicy="email" label="Error address" name="defaultErrorAddr" sqlname="NmsEmail_DefaultErrorAddr" type="string"/>
              <attribute desc="List (separated by commas, with '*' and '?' characters) of authorized reasons for the sender address." label="Authorized masks for the sender address" name="fromMask" sqlname="NmsDelivery_FromAddressMasks" type="memo"/>
              <attribute desc="List (separated by commas, with '*' and '?' characters) of authorized reasons for the error address." label="Authorized masks for the error address" name="errorMask" sqlname="NmsDelivery_ErrorAddressMasks" type="memo"/>
            </element>
            <element label="Configuration of image uploading" name="image">
              <attribute desc="List of URL masks for the images skipped during upload" label="URL masks" name="defaultIgnoredImage" sqlname="NmsDelivery_DefaultIgnoredImage" type="string"/>
              <attribute default="'images'" desc="Folder in which the images on the server are to be stored" label="Image subdirectory" name="imageSubDirectory" sqlname="NmsDelivery_ImageSubDirectory" type="string"/>
              <attribute default="'none'" enum="imagePublishing" label="Publication mode" name="publishing" sqlname="NmsDelivery_ImagePublishing" type="string"/>
              <attribute label="Media URL(s)" name="mediaServers" sqlname="NmsDelivery_MediaServers" type="string"/>
              <attribute label="Publication script" name="publishingScript" sqlname="NmsDelivery_PublishingScript" type="string"/>
              <attribute edit="PasswordEdit" label="Password" name="password" sqlname="NmsDelivery_MediaPassword" type="string"/>
              <attribute label="Instance name" name="instance" sqlname="NmsDelivery_MediaInstance" type="string"/>
            </element>
            <element label="Characters authorized in addresses" length="256" name="addressChars" sqlname="XtkEmail_Characters" type="memo"/>
            <element label="Delivery parameters" name="delivery">
              <attribute default="432000" label="Delivery duration of messages" name="msgValidityDuration" sqlname="NmsBroadcast_MsgValidityDuration" type="timespan"/>
              <attribute default="5184000" label="Online resources validity duration" name="msgWebValidityDuration" sqlname="NmsBroadcast_MsgWebValidityDuration" type="timespan"/>
              <attribute default="true" label="Exclude recipients who no longer wish to be contacted" name="excludeBlackListed" sqlname="NmsBroadcast_RemoveBlackList" type="boolean"/>
              <attribute default="true" label="Automatically ignore doubles" name="excludeDuplicates" sqlname="NmsBroadcast_RemoveDuplicatesRecipients" type="boolean"/>
            </element>
            <element label="Retries" name="retry">
              <attribute default="3600" label="Period of retries" name="period" sqlname="NmsEmail_RetryPeriod" type="timespan"/>
              <attribute default="5" label="Number of retries" name="count" sqlname="NmsEmail_RetryCount" type="long"/>
            </element>
          </element>
          <element name="paper">
            <element name="senderAddress" template="nms:common:postalAddress">
              <attribute name="line1" sqlname="NmsPaper_SenderLine1"/>
              <attribute name="line2" sqlname="NmsPaper_SenderLine2"/>
              <attribute name="line3" sqlname="NmsPaper_SenderLine3"/>
              <attribute name="line4" sqlname="NmsPaper_SenderLine4"/>
              <attribute name="line5" sqlname="NmsPaper_SenderLine5"/>
              <attribute name="line6" sqlname="NmsPaper_SenderLine6"/>
              <attribute name="line7" sqlname="NmsPaper_SenderLine7"/>
              <attribute _operation="delete" name="addrDefined"/>
              <attribute _operation="delete" name="addrQuality"/>
              <attribute _operation="delete" name="addrLastCheck"/>
              <attribute _operation="delete" name="addrErrorCount"/>
            </element>
            <attribute default="0" name="useOldAddr" sqlname="NmsRecipient_UseOldAddr" type="long"/>
          </element>
          <element name="sms">
            <element label="Parameters of SMS sent" name="headerSMS">
              <attribute default="0" desc="Information transmitted to the SMS gateway to indicate the message priority." enum="nms:delivery:smsPriority" label="Priority" name="priority" sqlname="NmsSMS_Priority" type="byte"/>
            </element>
            <element label="Retries" name="retrySMS">
              <attribute default="900" label="Period of retries" name="period" sqlname="NmsSMS_RetryPeriod" type="timespan"/>
              <attribute default="5" label="Number of retries" name="count" sqlname="NmsSMS_RetryCount" type="long"/>
            </element>
          </element>
          <element label="Tracking" name="tracking">
            <attribute label="Activate tracking" name="activated" sqlname="NmsTracking_Available" type="boolean"/>
            <attribute default="Iif(HasPackage('crm:lead'),2,0)" enum="webTrackingMode" label="Web tracking mode" name="webTrackingMode" sqlname="NmsTracking_WebTrackingMode" type="byte"/>
            <element label="URL search parameters" name="parsing">
              <attribute default="'() {} []'" label="Delimiter pairs" name="urlDelimiters" sqlname="NmsTracking_UrlDelimiters" type="string"/>
            </element>
            <element label="Tracking server" name="server">
              <attribute default="'http://localhost'" label="External URL" name="url" sqlname="NmsTracking_ServerUrl" type="string"/>
              <attribute label="Secure external URL" name="secureUrl" sqlname="NmsTracking_SecureServerUrl" type="string"/>
              <attribute label="Internal URL(s)" name="urlList" sqlname="NmsTracking_ServerUrlList" type="string"/>
              <element name="extAccount">
                <attribute label="External account" name="name" sqlname="NmsTracking_ExtAccount" type="string"/>
                <attribute label="External account" name="label" sqlname="NmsTracking_ExtAccountLabel" type="string"/>
              </element>
              <attribute edit="PasswordEdit" label="Password" name="password" sqlname="NmsTracking_Password" type="string"/>
              <attribute label="Instance name on the tracking server" name="instance" sqlname="NmsTracking_Instance" type="string"/>
            </element>
            <element label="Web Tracking tags creation formula" name="webFormula" sqlname="NmsTracking_WebFormula" type="CDATA"/>
            <element label="Open URL computation script" name="openFormula" sqlname="NmsTracking_OpenFormula" type="CDATA"/>
            <element label="Tracked-URL calculation script" name="clickFormula" sqlname="NmsTracking_ClickFormula" type="CDATA"/>
          </element>
          <element label="Non-deliverables" name="listHygiene">
            <element label="Email quarantine parameters" name="quarantineEmail">
              <attribute default="86400" desc="Minimum period of time in order for two errors to be considered significant for emails" label="Time between two significant errors" name="significantErrorDelayEmail" sqlname="NmsNPAI_EmailSignificantErrorDelay" type="timespan"/>
              <attribute default="5" label="Maximum number of errors before quarantine" name="maxSoftErrorEmail" sqlname="NmsNPAI_EmailMaxError" type="short"/>
            </element>
            <element label="Quarantine parameters for mobiles" name="quarantineMobile">
              <attribute default="86400" desc="Minimum period of time in order for two errors to be considered significant for mobiles" label="Time between two significant errors" name="significantErrorDelayMobile" sqlname="NmsNPAI_MobileSignificantErrorDelay" type="timespan"/>
              <attribute default="5" label="Maximum number of errors before quarantine" name="maxSoftErrorMobile" sqlname="NmsNPAI_MobileMaxError" type="short"/>
            </element>
          </element>
          <element name="serverApp">
            <attribute desc="Customer identifier used when sending the billing report" label="Customer identifier used in billing" name="customerId" sqlname="NmsServer_CustomerId" type="string"/>
            <attribute label="Common name of the customer" name="expOrganization" sqlname="NmsEmail_ExpOrganization" type="string"/>
            <attribute default="'http://localhost:8080'" desc="URL used to access the application server exposed on the Internet" label="URL" name="url" sqlname="NmsServer_URL" type="string"/>
            <attribute default="'http://localhost:8080'" desc="URL used to access the application server" label="URL" name="urlIntranet" sqlname="NmsServer_IntranetURL" type="string"/>
            <attribute default="'http://localhost:8080'" desc="URL used to access the mirrorpage server exposed on the Internet" label="URL" name="urlMirror" sqlname="NmsServer_MirrorPageUrl" type="string"/>
          </element>
          <element label="Aging data deletion" name="cleanup">
            <attribute default="31104000" label="Tracking logs" name="trackingLogPurgeDelay" sqlname="NmsCleanup_TrackingLogPurgeDelay" type="timespan"/>
            <attribute default="31104000" label="Consolidated tracking" name="trackingStatPurgeDelay" sqlname="NmsCleanup_TrackingStatPurgeDelay" type="timespan"/>
            <attribute applicableIf="HasPackage('nms:coreInteraction')" default="31104000" label="Offer propositions" name="propositionPurgeDelay" sqlname="NmsCleanup_PropositionPurgeDelay" type="timespan"/>
            <attribute applicableIf="HasPackage('nms:messageCenterExec')" default="2592000" label="Events" name="eventPurgeDelay" sqlname="NmsCleanup_EventPurgeDelay" type="timespan"/>
            <attribute applicableIf="HasPackage('nms:messageCenterExec')" default="31104000" label="Statistics of event processing" name="eventStatPurgeDelay" sqlname="NmsCleanup_EventStatPurgeDelay" type="timespan"/>
            <attribute applicableIf="HasPackage('nms:messageCenterControl')" default="31104000" label="Archived events" name="eventHistoPurgeDelay" sqlname="NmsCleanup_EventHistoPurgeDelay" type="timespan"/>
            <attribute default="15552000" label="Delivery logs" name="broadLogPurgeDelay" sqlname="NmsCleanup_BroadLogPurgeDelay" type="timespan"/>
            <attribute default="15552000" label="Import rejects" name="rejectsPurgeDelay" sqlname="NmsCleanup_RejectsPurgeDelay" type="timespan"/>
            <attribute default="2592000" label="Visitor profiles" name="visitorPurgeDelay" sqlname="NmsCleanup_VisitorPurgeDelay" type="timespan"/>
            <attribute default="2592000" label="Pipeline events ignored" name="pipelineDiscardPurgeDelay" sqlname="NmsCleanup_PipelineDiscardPurgeDelay" type="timespan"/>
            <attribute default="604800" label="Deleted deliveries" name="recycledDeliveryPurgeDelay" sqlname="NmsCleanup_RecycledDeliveryPurgeDelay" type="timespan"/>
          </element>
          <element name="dataPolicy">
            <element name="phone">
              <attribute default="false" desc="Store all phone numbers (even domestic) using the international format (for instance, a number entered as 425 555 0199 will be stored and displayed as +1 425 555 0199)" label="Store all phone numbers using the international format" name="outputAllInternat" sqlname="NmsDataPolicy_PhoneOutputAllInternat" type="boolean"/>
              <attribute default="false" desc="Phone numbers must all be entered in international format" label="Consider all phone numbers as international ones" name="inputDefaultInternat" sqlname="NmsDataPolicy_PhoneInputDefaultInternat" type="boolean"/>
            </element>
          </element>
          <element name="defaultCountry">
            <attribute desc="Country used for the default configuration of some data quality rules" label="Default country" name="code" sqlname="NmsLocal" translatedDefault="'GB'" type="string"/>
            <attribute label="Default country label" name="label" sqlname="NmsLocal_Label" translatedDefault="'United Kingdom'" type="string"/>
          </element>
          <element label="Configuration of frontal servers for pURLs" name="purlServersOptions">
            <attribute default="'none'" desc="Option which lets you specify a publishing mode for pURLs: local by default (requires an http server with the Adobe Campaign module), uses the tracking servers if the option is 'tracking' and uses a personalized list with the 'other server(s)' option." enum="frontalServersMode" label="Publication mode" name="publishing" sqlname="NmsPurl_ServersMode" type="string"/>
            <attribute desc="Personalized list of server addresses to be contacted for pURL publication ('Other server(s)' mode)." label="Internal URLs of the frontal servers" name="internalURLs" sqlname="NmsPurl_ServersURLs" type="string"/>
            <attribute desc="Name of the instance to be used for pURL publication in 'other server(s)' mode" label="Instance name" name="instance" sqlname="NmsPurl_Instance" type="string"/>
            <attribute desc="Password of the instance defined for pURL publication in 'other server(s)' mode" edit="PasswordEdit" label="Password" name="password" sqlname="NmsPurl_Password" type="string"/>
            <attribute default="7776000" desc="Period during which the microsite remains available after its end date is reached" label="pURL invalidation period" name="pURLPurgeDelay" sqlname="NmsPurl_pURLPurgeDelay" type="timespan"/>
          </element>
          <element applicableIf="HasPackage('nms:messageCenterExec')" label="Configuration of the Message Center execution instance" name="messageCenterExec">
            <attribute label="Execution instance identifier" name="cellId" sqlname="NmsExecutionInstanceId" type="long"/>
            <attribute desc="Threshold before warning for the queue of pending real time events." label="Warning threshold" name="rtQueueWarning" sqlname="MC_RtEventQueueWarning" type="long"/>
            <attribute desc="Threshold before critical condition for the queue of pending real time events." label="Alert threshold" name="rtQueueAlert" sqlname="MC_RtEventQueueAlert" type="long"/>
            <attribute default="200" desc="Threshold before warning regarding number of failed Message Center deliveries" label="Threshold before delivery failure warning" name="failedDeliveriesWarning" sqlname="MC_FailedDeliveriesWarning" type="long"/>
            <attribute default="500" desc="Threshold before alert regarding number of failed Message Center deliveries" label="Threshold before delivery failure alert" name="failedDeliveriesAlert" sqlname="MC_FailedDeliveriesAlert" type="long"/>
            <attribute desc="Warning threshold for processing errors of real-time events." label="Warning threshold" name="rtErrorWarning" sqlname="MC_RtEventErrorWarning" type="long"/>
            <attribute desc="Alert threshold for processing errors of real-time events." label="Alert threshold" name="rtErrorAlert" sqlname="MC_RtEventErrorAlert" type="long"/>
            <attribute desc="Alert threshold for real-time event throughput." label="Alert threshold" name="rtThroughputAlert" sqlname="MC_RtEventThroughputAlert" type="long"/>
            <attribute desc="Warning threshold for real-time event throughput." label="Warning threshold" name="rtThroughputWarning" sqlname="MC_RtEventThroughputWarning" type="long"/>
            <attribute desc="Alert threshold for the average queuing time of real-time events." label="Alert threshold" name="rtAvgQueueTimeAlert" sqlname="MC_RtEventAvgQueueTimeAlert" type="long"/>
            <attribute desc="Warning threshold for the average queuing time of real-time events." label="Warning threshold" name="rtAvgQueueTimeWarning" sqlname="MC_RtEventAvgQueueTimeWarning" type="long"/>
            <attribute desc="Alert threshold for the average sending time of real-time events." label="Alert threshold" name="rtAvgDeliveryTimeAlert" sqlname="MC_RtEventAvgDeliveryTimeAlert" type="long"/>
            <attribute desc="Warning threshold for the average sending time of real-time events." label="Warning threshold" name="rtAvgDeliveryTimeWarning" sqlname="MC_RtEventAvgDeliveryTimeWarning" type="long"/>
            <attribute desc="Alert threshold for the average processing time of real-time events." label="Alert threshold" name="rtAvgProcessTimeAlert" sqlname="MC_RtEventAvgProcessTimeAlert" type="long"/>
            <attribute desc="Warning threshold for the average processing time of real-time events." label="Warning threshold" name="rtAvgProcessTimeWarning" sqlname="MC_RtEventAvgProcessTimeWarning" type="long"/>
            <attribute desc="Alert threshold for the maximum number of queued real-time events." label="Alert threshold" name="rtMaxQueueAlert" sqlname="MC_RtEventMaxQueueAlert" type="long"/>
            <attribute desc="Warning threshold for the maxmium number of queued real-time events." label="Warning threshold" name="rtMaxQueueWarning" sqlname="MC_RtEventMaxQueueWarning" type="long"/>
            <attribute desc="Alert threshold for the minimum number of queued real-time events." label="Alert threshold" name="rtMinQueueAlert" sqlname="MC_RtEventMinQueueAlert" type="long"/>
            <attribute desc="Warning threshold for the minimum number of queued real-time events." label="Warning threshold" name="rtMinQueueWarning" sqlname="MC_RtEventMinQueueWarning" type="long"/>
            <attribute desc="Alert threshold for the average number of queued real-time events." label="Alert threshold" name="rtAvgQueueAlert" sqlname="MC_RtEventAvgQueueAlert" type="long"/>
            <attribute desc="Warning threshold for the average number of queued real-time events." label="Warning threshold" name="rtAvgQueueWarning" sqlname="MC_RtEventAvgQueueWarning" type="long"/>
          </element>
        </element>
        <element label="POP account used to retrieve inbound emails" name="bounceMailbox" ref="nms:extAccount:extAccount"/>
        <element label="Default account for SMS delivery" name="smsAccount" ref="nms:extAccount:extAccount"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Services to which recipients can subscribe" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Services" labelSingular="Service" name="service" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="mail" name="messageType">
        <value desc="Email channel" img="nms:email.png" label="Email" name="mail" value="0"/>
        <value applicableIf="HasPackage('nms:mobile')" desc="Mobile channel (SMS)" img="nms:mobile.png" label="Mobile (SMS)" name="sms" value="1"/>
        <value applicableIf="HasPackage('nms:social')" desc="Facebook channel" img="nms:facebook.png" label="Facebook" name="facebook" value="20"/>
        <value applicableIf="HasPackage('nms:social')" desc="Twitter channel" img="nms:twitter.png" label="Twitter" name="twitter" value="25"/>
        <value applicableIf="HasPackage('nms:mobileApp')" desc="Mobile application channel" img="nms:mobileApp.png" label="Mobile application" name="mobileApp" value="40"/>
      </enumeration>
      <enumeration basetype="byte" default="newsletter" name="mode">
        <value label="Newsletter" name="newsletter" value="0"/>
        <value label="Viral" name="viral" value="1"/>
      </enumeration>
      <element autopk="true" enumImage="@type" filterPath="@label" folderModel="nmsSetOfServices" fullLoad="true" name="service">
        <compute-string expr="@label+' ('+@name+')'"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <dbindex applicableIf="HasPackage('nms:social')" name="externalKey">
          <keyfield xpath="social/@externalId"/>
          <keyfield xlink="folder"/>
        </dbindex>
        <dbindex name="label">
          <keyfield xpath="@label"/>
        </dbindex>
        <attribute default="GetOption('XtkInstancePrefix')+'SVC'+CounterValue('nmsService')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute desc="Service type" enum="messageType" label="Type" name="type" type="byte"/>
        <attribute desc="Mode" enum="mode" label="Mode" name="mode" type="byte"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute default="1" label="Unlimited" name="unlimited" type="boolean"/>
        <attribute default="864000" label="Expiration date" name="validityDuration" sqlname="tsValidity" type="timespan"/>
        <element aggregate="nms:common:freeFields" name="freeFields"/>
        <element desc="Subscription confirmation delivery template" label="Subscription confirmation" name="subScenario" revIntegrity="define" revLabel="Subscription services" target="nms:delivery" type="link"/>
        <element desc="Unsubscription confirmation delivery template" label="Unsubscription confirmation" name="unsubScenario" revIntegrity="define" revLabel="Unsubscription services" target="nms:delivery" type="link"/>
        <element name="desc" template="xtk:common:desc"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsSetOfServices', [@_folder-id])" label="Service Folder" name="folder" required="true" revDesc="Information Services in the folder" revIntegrity="define" revLabel="Services" target="xtk:folder" type="link"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:social')" expr="[social/@accessToken]" name="facebook"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:social')" expr="@name" name="twitter"/>
        <element applicableIf="HasPackage('nms:mobileApp')" label="Target mapping linked to mobile applications" name="mobileAppsTargetMapping" target="nms:deliveryMapping" type="link"/>
        <element applicableIf="HasPackage('nms:social')" label="Social networks" name="social">
          <attribute desc="Audience (Number of Facebook fans, Twitter followers, etc.)" label="Audience" name="audience" type="long"/>
          <attribute desc="External system identifier" label="External identifier" length="128" name="externalId" type="string"/>
          <attribute desc="Link to image (http://...)" label="Image" length="128" name="externalPicture" type="string"/>
          <attribute label="Web link" length="128" name="externalUrl" type="string"/>
          <attribute label="Category" length="128" name="category" type="string"/>
          <attribute desc="Access Token" label="Access token" length="250" name="accessToken" type="string"/>
          <attribute desc="Access Token Secret" label="Access token secret" length="250" name="accessTokenSecret" type="string"/>
          <attribute desc="Application ID (Consumer key)" label="Application ID" length="250" name="consumerKey" type="string"/>
          <attribute desc="Application secret (Consumer secret)" label="Application secret" length="250" name="consumerSecret" type="string"/>
          <attribute default="true" label="Synchronize subscriptions" name="syncSubscription" type="boolean"/>
        </element>
        <element applicableIf="HasPackage('nms:social')" default="DefaultFolder('nmsVisitor')" label="Visitor folder" name="visitorFolder" revIntegrity="define" revLabel="Visitors" target="xtk:folder" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="History of service subscription" labelSingular="Subscription history" name="subHisto" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="short" name="action">
        <value label="Unsubscription" name="Unsubscription" value="0"/>
        <value label="Subscription" name="Subscription" value="1"/>
      </enumeration>
      <element autopk="true" name="subHisto" pkgStatus="never">
        <compute-string expr="@action + ': ' + [service/@label] + ' / ' + recipient"/>
        <attribute desc="Action type to historize" enum="action" label="Action" name="action" type="short"/>
        <attribute desc="Historic date" label="Date" name="date" type="datetime"/>
        <element integrity="neutral" label="Recipient" name="recipient" revIntegrity="own" revLabel="History of service subscription" target="nms:recipient" type="link"/>
        <element integrity="neutral" label="Service" name="service" revIntegrity="own" revLabel="History of service subscription" target="nms:service" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Subscriptions to services" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:subscribe.png" implements="xtk:persist" label="Subscriptions" labelSingular="Subscription" name="subscription" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="nms:subscribe.png" name="subscription" pkgStatus="never">
        <key internal="true" name="subscription">
          <keyfield xlink="service"/>
          <keyfield xlink="recipient"/>
        </key>
        <dbindex name="confirmationId">
          <keyfield xpath="@confirmationId"/>
        </dbindex>
        <dbindex name="recipient">
          <keyfield xlink="recipient"/>
          <keyfield xpath="@addressSpecific"/>
        </dbindex>
        <compute-string expr="[service/@label] + ' / ' + recipient"/>
        <attribute default="GetDate()" desc="Creation date" label="Creation date" name="created" type="datetime"/>
        <attribute desc="Subscription valid until" label="Expiration date" name="expirationDate" sqlname="tsExpiration" type="date"/>
        <attribute dataPolicy="none" desc="Address to use for the subscription" label="Specific Address" name="addressSpecific" template="xtk:common:email"/>
        <attribute desc="Email format type" enum="nms:recipient:messageFormat" label="Email format" name="emailFormat" type="byte"/>
        <attribute expr="Coalesce(@addressSpecific, IfEquals(ToString([service/@type]),'0',[recipient/@email],IfEquals(ToString([service/@type]),'1',[recipient/@mobilePhone],IfEquals(ToString([service/@type]),'2',[recipient/@phone],[recipient/@fax]))))" label="Address" name="address" type="string"/>
        <attribute name="deleteStatus" template="xtk:common:deleteStatus"/>
        <attribute advanced="true" desc="Identifier used to group confirmation messages into a single delivery (this is not a foreign key)" label="Confirmation Id" name="confirmationId" type="long"/>
        <element integrity="neutral" label="Service" name="service" revIntegrity="own" revLabel="Recipient subscriptions" target="nms:service" type="link"/>
        <element integrity="neutral" label="Recipient" name="recipient" revIntegrity="own" revLabel="Subscriptions" target="nms:recipient" type="link"/>
      </element>
      <methods>
        <method name="RecipientSubscribe" static="true">
          <parameters>
            <param desc="Recipient list" name="recipientList" type="DOMElement"/>
            <param desc="List of services" name="serviceList" type="DOMElement"/>
            <param desc="Subscribe/Unsubscribe recipients" name="subscribe" type="boolean"/>
            <param desc="Send a confirmation message" name="sendConfirmation" type="DOMElement"/>
            <param desc="List of confirmation IDs" inout="out" name="confirmationIds" type="DOMElement"/>
          </parameters>
        </method>
        <method name="SendConfirmation" static="true">
          <parameters>
            <param desc="Internal name of associated delivery template" name="internalName" type="string"/>
            <param desc="Confirmation message Id" name="confirmationId" type="string"/>
          </parameters>
        </method>
        <method name="Subscribe" static="true">
          <parameters>
            <param desc="List of Information Service names (comma separated)" name="serviceName" type="string"/>
            <param desc="Recipient to register and optionally to create" name="recipient" type="DOMElement"/>
            <param desc="Create recipient if it does not exist" name="create" type="boolean"/>
          </parameters>
        </method>
        <method name="Unsubscribe" static="true">
          <parameters>
            <param desc="List of Information Service names (comma separated)" name="serviceName" type="string"/>
            <param desc="Recipient" name="recipient" type="DOMElement"/>
          </parameters>
        </method>
        <method name="DeleteService" static="true">
          <parameters>
            <param desc="Service identifier" inout="in" name="id" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Delivery messages being prepared." entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Messages being prepared" labelSingular="Message" name="tmpBroadcast" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="broadLogStatus">
        <value img="nms:broadLog.png" label="Messages" name="real" value="0"/>
        <value img="nms:fakeLog.png" label="Tests" name="fake" value="1"/>
        <value img="nms:excludeLog.png" label="Excluded" name="excluded" value="2"/>
      </enumeration>
      <element enumImage="@broadLogStatus" name="tmpBroadcast" temporaryTable="true">
        <key internal="true" name="messageId" noDbIndex="true">
          <keyfield xpath="@message-id"/>
        </key>
        <attribute desc="Status" enum="broadLogStatus" expr="Iif(@failureReason = 0, Iif(@targetCode='__MAIN__', 0, 1), 2)" name="broadLogStatus" type="byte" xml="true"/>
        <attribute desc="message (and associated delivery log) identifier" label="Message identifier" name="message-id" type="long"/>
        <attribute autoIncrement="true" desc="Internal message renumbering (ordering of delivery waves)" label="Sequence number" name="AutoInc" type="long"/>
        <attribute enum="nms:recipient:messageFormat" label="Expected format" name="format" type="byte"/>
        <attribute label="Blacklisted" name="blackList" notNull="false" type="boolean"/>
        <attribute enum="nms:address:status" label="Address status" name="status" notNull="false" type="byte"/>
        <attribute dataPolicy="none" label="Address" length="512" name="address" template="xtk:common:email"/>
        <attribute label="Sub-affinity" length="32" name="affinityGroup" type="string"/>
        <attribute default="''" label="Original code" name="targetCode" template="nms:seedMember:seedMember/@internalName" type="string"/>
        <attribute desc="Reason of failure" enum="nms:broadLog:failureReason" label="Reason" name="failureReason" type="short"/>
        <element desc="Typology rule which has generated the reject" label="Typology rule" name="typologyRule" noDbIndex="true" revLink="_NONE_" target="nms:typologyRule" type="link"/>
        <element desc="Exclusion message" name="msg" noDbIndex="true" revLink="_NONE_" target="nms:broadLogMsg" type="link"/>
        <element advanced="true" applicableIf="HasPackage('nms:coupon')" label="Coupon" name="coupon" revLink="_NONE_" target="nms:coupon" type="link">
          <join xpath-dst="@id" xpath-src="$(delivery/@coupon-id)"/>
        </element>
        <element desc="Data of the line of the external file for the recipient" label="Line of the file" name="dataSourceContext" type="memo"/>
        <element name="dataSourceId" type="long"/>
        <attribute label="Message weight" name="messageWeight" type="double"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Messages excluded from the delivery currently being prepared." entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Messages excluded from the preparation" name="tmpBroadcastExclusion" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="tmpBroadcastExclusion" temporaryTable="true">
        <key internal="true" name="messageId" noDbIndex="true">
          <keyfield xpath="@message-id"/>
        </key>
        <attribute desc="message (and associated delivery log) identifier" label="Message identifier" name="message-id" type="long"/>
        <attribute desc="Line number" label="Rank" name="rowNum" type="long"/>
        <attribute desc="Grouping criteria" label="group" length="512" name="groupVal" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Message including a coupon" name="tmpBroadcastMessageId" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="tmpBroadcastMessageId" temporaryTable="true">
        <key internal="true" name="AutoIncId" noDbIndex="true">
          <keyfield xpath="@AutoIncId"/>
        </key>
        <attribute autoIncrement="true" label="Reservation ID" name="AutoIncId" type="long"/>
        <attribute name="MessageId" template="nms:tmpBroadcast:tmpBroadcast/@message-id"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Messages pending arbitration" labelSingular="Message" name="tmpMarketingPressure" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="tmpMarketingPressure" temporaryTable="true">
        <attribute label="identifier" name="message-id" type="long"/>
        <attribute label="contact date" name="contactDate" type="datetime"/>
        <element name="delivery" noDbIndex="true" revLink="_NONE_" target="nms:delivery" type="link"/>
        <attribute label="Past" name="past" type="boolean"/>
        <attribute label="propensity" name="affinityScore" type="double"/>
        <attribute label="Pressure threshold" name="threshold" type="long"/>
        <attribute label="Rank number" name="messageRank" type="long"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="List of tracking logs for clicks and openings" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Tracking logs" labelSingular="Tracking log" library="true" name="trackingLog" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="true" img="nms:tracking.png" name="trackingLog" pkSequence="NmsTrackingLogId" pkgStatus="never">
        <compute-string expr="url"/>
        <dbindex name="logDate">
          <keyfield xpath="@logDate"/>
        </dbindex>
        <dbindex name="delivery">
          <keyfield xpath="@delivery-id"/>
          <keyfield xpath="@logDate"/>
        </dbindex>
        <attribute name="id" sqlname="iTrackingLogId" type="long"/>
        <attribute desc="Redirect date" label="Date" name="logDate" type="datetime"/>
        <attribute advanced="true" desc="Unique identifier for redirection URL requester" label="Requester UUID" length="48" name="sourceId" type="string"/>
        <attribute desc="Type of the URL redirect requester" label="Requester type" length="16" name="sourceType" type="string"/>
        <attribute advanced="true" desc="Browser type." label="Browser" name="userAgent" type="long"/>
        <attribute desc="External identifier of the tracked URL" label="External Id" length="48" name="externalId" type="string"/>
        <element integrity="neutral" label="Url" name="url" noDbIndex="true" revIntegrity="own" revLabel="Tracking logs" target="nms:trackingUrl" type="link"/>
        <element integrity="neutral" label="Delivery" name="delivery" revIntegrity="normal" revLabel="Tracking logs" target="nms:delivery" type="link"/>
        <element integrity="neutral" label="Browser" name="userAgent" revIntegrity="normal" revLabel="Tracking logs" target="nms:userAgent" type="link">
          <join xpath-dst="@hashKey" xpath-src="@userAgent"/>
        </element>
        <element externalJoin="true" integrity="neutral" label="Web tracking log" name="webTrackingLog" revIntegrity="own" revLink="_NONE_" target="nms:webTrackingLog" type="link">
          <join xpath-dst="@id" xpath-src="@id"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Recipient tracking logs" labelSingular="Recipient tracking log" name="trackingLogRcp" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="trackingLogRcp" template="nms:trackingLog">
        <compute-string expr="url + ' / '+ recipient"/>
        <dbindex name="urlId">
          <keyfield xlink="url"/>
          <keyfield xlink="recipient"/>
        </dbindex>
        <element name="delivery" revLabel="Recipient tracking logs"/>
        <element desc="Message (delivery log)" integrity="neutral" label="Message" name="broadLog" revIntegrity="normal" revLabel="Tracking logs" revLink="trackingLog" target="nms:broadLogRcp" type="link"/>
        <element integrity="neutral" label="Recipient" name="recipient" revIntegrity="normal" revLabel="Tracking logs" revLink="trackingLog" target="nms:recipient" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Visitor tracking logs" labelSingular="Visitor tracking log" name="trackingLogVisitor" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="trackingLogVisitor" template="nms:trackingLog">
        <compute-string expr="url + ' / '+ visitor"/>
        <dbindex name="urlId">
          <keyfield xlink="url"/>
          <keyfield xlink="visitor"/>
        </dbindex>
        <element name="delivery" revLabel="Visitor tracking logs"/>
        <element desc="Message (delivery log)" integrity="neutral" label="Message" name="broadLog" revIntegrity="normal" revLabel="Tracking logs" revLink="trackingLog" target="nms:broadLogVisitor" type="link"/>
        <element integrity="neutral" label="Visitor" name="visitor" revIntegrity="normal" revLabel="Tracking logs" revLink="trackingLog" target="nms:visitor" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Consolidated statistics from tracking logs" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Consolidated tracking" name="trackingStats" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="true" name="trackingStats" pkgStatus="never">
        <compute-string expr="'['+@startDate+';'+@endDate+'[ ' + url"/>
        <dbindex name="deliveryId">
          <keyfield xlink="delivery"/>
          <keyfield xpath="@startDate"/>
        </dbindex>
        <attribute desc="Start date of period" label="Start date" name="startDate" type="datetime"/>
        <attribute desc="End date of period" label="End date" name="endDate" type="datetime"/>
        <attribute desc="Type of the URL redirect requester" label="Requester type" length="16" name="sourceType" type="string"/>
        <attribute desc="Total number of clicks over the period." label="Clicks" name="totalClicks" type="long"/>
        <attribute desc="Number of transactions over the period" label="Transactions" name="transaction" type="long"/>
        <attribute desc="Amount of transactions over period" label="Amount" name="amount" type="double"/>
        <attribute desc="Number of articles in transactions over the period" label="Articles" name="article" type="long"/>
        <element integrity="neutral" label="Url" name="url" revIntegrity="own" revLabel="Consolidated tracking" target="nms:trackingUrl" type="link"/>
        <element integrity="neutral" label="Delivery" name="delivery" noDbIndex="true" revIntegrity="normal" revLabel="Consolidated tracking" target="nms:delivery" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="List of tracking URLs for a delivery action" entitySchema="xtk:srcSchema" img="nms:webtracking.png" implements="xtk:persist" label="Delivery URL tracking" name="trackingUrl" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="true" folderModel="nmsWebTracking" img="nms:webtracking.png" name="trackingUrl">
        <compute-string expr="@label"/>
        <key name="tagId">
          <keyfield xpath="@tagId"/>
        </key>
        <dbindex name="code">
          <keyfield xpath="@checksum"/>
        </dbindex>
        <attribute desc="Identifier associated with this URL for the Web tracking" label="Identifier" length="128" name="tagId" type="string"/>
        <attribute label="Source URL" length="1000" name="source" type="string"/>
        <attribute desc="URL occurrence index in the content (first is 1)." label="Occurrence index" name="occurrence" type="short"/>
        <attribute desc="URL label" label="Label" length="255" localizable="true" name="label" required="true" type="string"/>
        <attribute desc="Category of the URL" label="Category" length="100" name="category" type="string" userEnum="urlCategory"/>
        <attribute advanced="true" desc="CRC32 code of source URL" label="CRC32" name="checksum" type="long"/>
        <attribute advanced="true" desc="URL with user defined parameters" label="Customizable" name="withParams" type="boolean"/>
        <attribute default="4" desc="URL type" enum="nms:trackingUrlInfo:urlType" label="Type" name="type" type="byte"/>
        <attribute desc="Limit validity date" label="Validity limit" name="validity" type="date"/>
        <attribute desc="Stage linked to the tracker" label="Stage" name="step" type="byte"/>
        <attribute dbEnum="trackerGoal" label="Objective" length="64" name="goal" type="string"/>
        <attribute desc="Internal name of the tracker" label="Name of the tracker" length="32" name="trackerName" type="string"/>
        <element integrity="neutral" label="Delivery" name="delivery" revIntegrity="normal" revLabel="Tracked URLs" target="nms:delivery" type="link"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsWebTracking', [@_folder-id])" label="Tag folder" name="folder" required="true" revDesc="Web tracking tags contained in this folder" revIntegrity="define" revLabel="Web tracking tags" target="xtk:folder" type="link"/>
        <element applicableIf="HasPackage('nms:purl')" label="pURL" name="purl" revDesc="Trackers linked to this pURL." revIntegrity="own" revLabel="Tracked URLs" revLink="trackingUrl" target="nms:purl" type="link"/>
        <element label="WebApp" name="webApp" revDesc="Trackers associated to this web application." revIntegrity="own" revLabel="Tracked URLs" revLink="trackingUrl" target="nms:webApp" type="link"/>
        <element applicableIf="HasPackage('nms:coreInteraction')" label="Offer" name="offer" target="nms:offer" type="link"/>
      </element>
      <methods async="true">
        <method const="true" name="GenerateTag">
          <parameters>
            <param desc="Tag HTML code" inout="out" name="tag" type="string"/>
          </parameters>
        </method>
        <method name="CreateTrackingInstance" static="true">
          <parameters>
            <param desc="Internal password" name="internalPwd" type="string"/>
            <param desc="External URL of the tracking server" name="serverUrl" type="string"/>
            <param desc="External secure URL of the tracking server" name="secureServerUrl" type="string"/>
            <param desc="Internal URLs of the tracking servers" name="serverUrlList" type="string"/>
            <param desc="Name of the instance to create" name="instanceName" type="string"/>
            <param desc="Encrypted password" name="cryptedPassword" type="string"/>
            <param desc="DNS masks associated with the instance" name="host" type="string"/>
          </parameters>
        </method>
        <method name="RegisterTrackingInstance" static="true">
          <parameters>
            <param desc="External URL of the tracking server" name="serverUrl" type="string"/>
            <param desc="External secure URL of the tracking server" name="secureServerUrl" type="string"/>
            <param desc="Internal URLs of the tracking servers" name="serverUrlList" type="string"/>
            <param desc="Name of the instance to approve" name="instanceName" type="string"/>
            <param desc="Encrypted password" name="cryptedPassword" type="string"/>
          </parameters>
        </method>
        <method name="CreateTrackingInstanceShell" static="true">
          <parameters>
            <param desc="Internal password" name="internalPwd" type="string"/>
            <param desc="Internal URLs of the tracking servers" name="serverUrlList" type="string"/>
            <param desc="Name of the instance to create" name="instanceName" type="string"/>
            <param desc="Encrypted password" name="cryptedPassword" type="string"/>
            <param desc="DNS masks associated with the instance" name="host" type="string"/>
          </parameters>
        </method>
        <method name="RegisterExternalInstance" static="true">
          <parameters>
            <param desc="Relay server access login" name="login" type="string"/>
            <param desc="Name of the instance to approve" name="instanceName" type="string"/>
            <param desc="Database identifier for customer performing a delivery" name="dbId" type="string"/>
            <param desc="Save options if successful" name="saveParams" type="boolean"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="List of URLs known to the tracking module" entitySchema="xtk:srcSchema" implements="xtk:persist" label="Tracking URL templates" labelSingular="Tracking URL template" name="trackingUrlInfo" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="alwaysNever">
        <value label="Not defined" name="undefined" value="0"/>
        <value label="Always" name="always" value="1"/>
        <value label="Never" name="never" value="2"/>
      </enumeration>
      <enumeration basetype="byte" name="urlType">
        <value label="Not defined" name="undefined" value="0"/>
        <value label="Email click" name="mail" value="1"/>
        <value label="Open" name="open" value="2"/>
        <value label="Opt-out" name="optout" value="3"/>
        <value label="Web" name="web" value="4"/>
        <value label="Transaction" name="transact" value="5"/>
        <value label="Mirror page" name="mirrorPage" value="6"/>
        <value applicableIf="HasPackage('nms:social')" label="Facebook Link" name="facebookLink" value="7"/>
        <value applicableIf="HasPackage('nms:social')" label="Facebook Action" name="facebookAction" value="8"/>
        <value applicableIf="HasPackage('nms:social')" label="Twitter Link" name="twitterLink" value="9"/>
        <value applicableIf="HasPackage('nms:mobileApp')" label="Click on mobile notification" name="mobileAppClick" value="10"/>
        <value label="Proposition update" name="propUpdate" value="11"/>
      </enumeration>
      <enumeration basetype="byte" name="behaviourType">
        <value label="Email open" name="open" value="2"/>
        <value label="Click in the email" name="mail" value="1"/>
        <value label="Opt-Out" name="optout" value="3"/>
        <value label="Click in a Web page" name="web" value="4"/>
        <value label="Transaction from a Web page" name="transact" value="5"/>
        <value label="Mirror page" name="mirrorPage" value="6"/>
        <value applicableIf="HasPackage('nms:social')" label="Facebook Link" name="facebookLink" value="7"/>
        <value applicableIf="HasPackage('nms:social')" label="Facebook Action" name="facebookAction" value="8"/>
        <value applicableIf="HasPackage('nms:social')" label="Twitter Link" name="twitterLink" value="9"/>
        <value label="Proposition update" name="propUpdate" value="11"/>
      </enumeration>
      <enumeration basetype="byte" name="tagType">
        <value label="Web" name="web" value="4"/>
        <value label="Transaction" name="transact" value="5"/>
      </enumeration>
      <element autopk="true" name="trackingUrlInfo">
        <compute-string expr="@label"/>
        <dbindex name="code">
          <keyfield xpath="@checksum"/>
        </dbindex>
        <attribute label="Source URL" length="1000" name="source" type="string"/>
        <attribute desc="URL label" label="Label" length="255" localizable="true" name="label" type="string"/>
        <attribute desc="Category of the URL" label="Category" length="100" name="category" type="string" userEnum="urlCategory"/>
        <attribute advanced="true" desc="CRC32 code of source URL" label="CRC32" name="checksum" type="long"/>
        <attribute default="1" desc="Allows to always enable or disable this URL" enum="alwaysNever" label="Enabled" name="active" type="byte"/>
        <attribute desc="URL type" enum="urlType" label="Type" name="type" type="byte"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Internet browser tracking information" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:useragent.png" implements="xtk:persist" label="Internet browsers" labelSingular="Internet browser" name="userAgent" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" name="device">
        <value label="Android" name="android"/>
        <value label="PC" name="pc"/>
        <value label="iPad" name="ipad"/>
        <value label="iPod" name="ipod"/>
        <value label="iPhone" name="iphone"/>
        <value label="BlackBerry" name="blackberry"/>
        <value label="Nokia" name="nokia"/>
        <value label="Other" name="other"/>
      </enumeration>
      <element img="nms:useragent.png" name="userAgent" pkgStatus="never">
        <key name="hashKey">
          <keyfield xpath="@hashKey"/>
        </key>
        <compute-string expr="@browserName + ' ' + @browserVersion + '/' + @OSName"/>
        <attribute desc="Internal browser identifier." label="Key" name="hashKey" type="long"/>
        <attribute desc="Name of internal browser or email client" label="Browser" length="50" name="browserName" type="string"/>
        <attribute label="Browser version" length="10" name="browserVersion" type="string"/>
        <attribute desc="Image associated with the browser in the reports." label="Browser icon" length="15" name="browserImage" type="string"/>
        <attribute desc="Device used" enum="device" label="Device" name="device" type="string"/>
        <attribute desc="Mobile device" expr="Iif(@device = 'pc', 'false', 'true')" label="Mobile device" name="isMobile"/>
        <attribute desc="Name of the operating system." label="Operating System" length="50" name="OSName" type="string"/>
        <attribute label="Operating system family" length="20" name="OSFamilly" type="string"/>
        <attribute desc="Image associated with the operating system in the reports." label="Operating system icon" length="15" name="OSImage" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Rejected browser qualifications" labelSingular="Rejected browser qualification" name="userAgentReject" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="userAgentReject" template="nms:userAgent">
        <attribute label="Software UserAgentString." length="255" name="userAgentString" type="string"/>
        <attribute desc="Number of occurrences of this UserAgent." label="Number" name="hit" type="long"/>
        <attribute desc="Last update date." label="Update" name="lastUpdate" type="datetime"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Internet browser usage statistics" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:useragent.png" implements="xtk:persist" label="Internet browser statistics" name="userAgentStats" namespace="nms" xtkschema="xtk:srcSchema">
      <element img="nms:useragent.png" name="userAgentStats" pkgStatus="never">
        <key name="hashKey">
          <keyfield xpath="@hashKey"/>
          <keyfield xpath="@date"/>
        </key>
        <attribute desc="Internal browser identifier." label="Key" name="hashKey" type="long"/>
        <attribute label="Date" name="date" type="date"/>
        <attribute label="Pages viewed" name="pages" type="long"/>
        <attribute desc="Estimated number of visitors." label="Visitors" name="visitors" type="long"/>
        <attribute desc="Estimated total number of visitors for the day." label="Visitors/day" name="visitorsOfTheDay" type="long"/>
        <element label="Internet browser" name="userAgent" target="nms:userAgent" type="link">
          <join xpath-dst="@hashKey" xpath-src="@hashKey"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Web application definitions" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:webApp.png" implements="xtk:persist" label="Web applications" labelSingular="Web application" mergeable="true" name="webApp" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" label="Action on link or on button" name="linkAction">
        <value label="Refresh data in a list" name="refreshData"/>
      </enumeration>
      <enumeration basetype="string" default="list" name="targetType">
        <value label="List" name="list"/>
        <value label="Query" name="query"/>
      </enumeration>
      <enumeration basetype="byte" default="client" name="listLoadType">
        <value label="Client (dynamic)" name="client" value="0"/>
        <value label="Variable" name="var" value="1"/>
        <value label="Database collection" name="xpath" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="scrolling" name="navigationType">
        <value label="Via scrolling" name="scrolling" value="0"/>
        <value label="By page" name="page" value="1"/>
      </enumeration>
      <element name="queryDef">
        <attribute label="Source schema" name="schema" required="true" type="string"/>
        <attribute default="'/'" label="Initial path" name="startPath" type="string"/>
        <attribute label="Lines to retrieve" name="lineCount" type="long"/>
        <attribute label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element name="where" ref="xtk:queryDef:where"/>
        <element name="orderBy" ref="xtk:queryDef:orderBy"/>
        <element name="groupBy" ref="xtk:queryDef:groupBy"/>
        <element name="having" ref="xtk:queryDef:having"/>
        <element desc="Collection links filtering condition" name="conditionLink" ref="xtk:queryDef:conditionLink" unbound="true"/>
      </element>
      <element applicableIf="HasPackage('nms:purl')" label="Access control" name="accessControl" template="xtk:abstractForm:activity" unbound="true">
        <attribute default="'nms:activities/accessControl.png'" name="img" type="string"/>
        <attribute enum="authorization" label="Authorization" name="authorization" type="byte"/>
        <attribute label="Disallow returning to previous page" name="disablePreviousButton" type="boolean"/>
        <element desc="HTML content of the page header" label="Page header" name="header" type="html"/>
        <element desc="HTML content of the page footer" label="Page footer" name="footer" type="html"/>
        <element name="strings" ref="strings" xml="true"/>
        <attribute label="Compute string of the 'seed list' link" name="controlList-cs" type="string"/>
        <attribute label="Identifier of the 'Seed list' link" name="controlList-id" type="long"/>
        <element label="List" name="controlList" revLink="_NONE_" target="nms:group" type="link" xml="true">
          <join xpath-dst="@id" xpath-src="@controlList-id"/>
        </element>
        <attribute default="false" label="Exclusion" name="exclusion" type="boolean"/>
        <element name="transitions">
          <element name="authenticated" template="xtk:abstractForm:transition">
            <attribute name="label" translatedDefault="'Authentication'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="anonymous" template="xtk:abstractForm:transition">
            <attribute name="label" translatedDefault="'Anonymous'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <element applicableIf="HasPackage('nms:social')" label="Access control" name="accessControlSocial" template="xtk:abstractForm:activity" unbound="true">
        <attribute default="'nms:activities/accessControl.png'" name="img" type="string"/>
        <element name="transitions">
          <element name="authenticated" template="xtk:abstractForm:transition">
            <attribute name="label" translatedDefault="'Authentication'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="anonymous" template="xtk:abstractForm:transition">
            <attribute name="label" translatedDefault="'Anonymous'"/>
            <attribute default="true" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="nms:miniatures/mini-survey.png" label="Page" name="htmlPage" template="xtk:abstractForm:activity" unbound="true">
        <attribute default="'htmlPage'" label="Type" name="type" type="string"/>
        <attribute default="'nms:activities/survey.png'" name="img"/>
        <attribute localizable="true" name="label"/>
        <attribute default="true" name="binding" type="boolean"/>
        <element label="Page content" name="content" type="html"/>
        <element name="bindings">
          <element name="input" unbound="true">
            <attribute name="htmlId" type="string"/>
            <key internal="true" name="htmlId">
              <keyfield xpath="@htmlId"/>
            </key>
            <element label="Record" name="storage" template="xtk:abstractForm:storage"/>
          </element>
          <element name="action" unbound="true">
            <attribute name="id" type="string"/>
            <key internal="true" name="id">
              <keyfield xpath="@id"/>
            </key>
            <attribute default="'url'" enum="linkAction" label="Action" name="action" type="string"/>
            <attribute label="Transition" name="transition" type="string"/>
            <element label="JavaScript" name="linkJavascript" type="CDATA"/>
          </element>
        </element>
        <element name="transitions">
          <element name="next" template="xtk:abstractForm:transition" unbound="true">
            <key internal="true" name="name">
              <keyfield xpath="@name"/>
            </key>
            <translatedDefault>&lt;next name="next" label="Next" enabled="true"/&gt;</translatedDefault>
          </element>
        </element>
        <element name="tracker" template="xtk:abstractForm:tracker" unbound="true"/>
      </element>
      <enumeration basetype="byte" default="public" name="authorization">
        <value label="Public" name="public" value="0"/>
        <value label="List" name="list" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="col" name="listContentType">
        <value label="Detail only" name="det" value="0"/>
        <value label="Columns only" name="col" value="1"/>
        <value label="Columns and Additional detail" name="both" value="2"/>
      </enumeration>
      <enumeration name="inputType">
        <value enabledIf="[facet/@advanced]" name="folderSelector"/>
        <value enabledIf="[facet/@advanced]" name="linkEdit"/>
      </enumeration>
      <element autopk="true" label="List" name="list" template="xtk:abstractForm:cell" unbound="true">
        <attribute localizable="true" name="label" translatedDefault="'List '+ColIndex()"/>
        <attribute enum="staticAlignment" label="Alignment" name="staticAlignment" type="string"/>
        <attribute default="1" enum="listContentType" label="Display the columns defined for the list" name="useColumns" type="byte"/>
        <attribute desc="Use the first cell of the line as a link to document editing" label="Use a link to the entity" name="openHRef" type="boolean"/>
        <element desc="Override the edit form" label="Edit form" name="editForm" target="xtk:form" type="link" xml="true"/>
        <attribute edit="viewComboList" label="Edit view" name="viewName" template="xtk:navtree:command/@view"/>
        <attribute default="true" label="Display column titles" name="showHeaders" type="boolean"/>
        <attribute label="Maximum height" name="maxHeight" type="short"/>
        <element name="styles">
          <attribute default="'listContent'" label="List style" name="tableClass" type="string"/>
          <attribute default="'listHeader'" label="Header style" name="headerLineClass" type="string"/>
          <attribute default="'listEvenLine'" label="Line style (even lines)" name="evenLineClass" type="string"/>
          <attribute default="'listOddLine'" label="Line style (odd lines)" name="oddLineClass" type="string"/>
          <attribute default="'listCellClass'" label="Cell style (standard)" name="rowCellClass" type="string"/>
          <attribute default="'listTitleClass'" label="Cell style (header)" name="headerCellClass" type="string"/>
          <attribute default="'titleContainer'" label="List title style" name="titleListClass" type="string"/>
          <attribute default="'dottedContainer'" label="List frame style" name="listBorderClass" type="string"/>
        </element>
        <attribute label="Number of details per line" name="numItemByLine" type="short"/>
        <attribute default="true" label="Make the detail hideable" name="templateVisibility" type="boolean"/>
        <attribute default="false" label="Display browsing" name="activeNav" type="boolean"/>
        <attribute enum="navigationType" label="Browsing type" name="navigationType" type="byte"/>
        <attribute default="true" label="Display a title bar" name="showListTitle" type="boolean"/>
        <element name="title">
          <attribute label="Icon" name="img" type="string"/>
          <attribute label="Title" localizable="true" name="label" type="string"/>
          <attribute label="Show/Hide button" name="listFoldable" type="boolean"/>
          <attribute label="Refresh button" name="showListRefresh" type="boolean"/>
        </element>
        <attribute label="XPath in the context" name="storage" type="string"/>
        <attribute label="Folder filter XPath" name="folderXPath" type="string"/>
        <attribute label="XPath for the line count" name="lineCountXPath" type="string"/>
        <attribute enum="listLoadType" label="Load type" name="loadType"/>
        <element label="Data" name="content" ref="queryDef"/>
        <element name="lineTemplate" type="html"/>
        <element name="strings" ref="strings"/>
      </element>
      <element name="iterator" template="xtk:abstractForm:container">
        <attribute label="Data" name="query" type="string"/>
        <attribute label="Data extraction path" name="xpath" type="string"/>
      </element>
      <element autopk="true" label="Container" name="container" template="xtk:abstractForm:container" unbound="true">
        <element name="list" ref="list" unbound="true"/>
      </element>
      <element name="link" template="xtk:abstractForm:link">
        <attribute default="'url'" enum="nms:webApp:linkAction" label="Action" name="action"/>
        <element label="Objects to refresh" name="objectTarget" unbound="true">
          <attribute enum="nms:webApp:targetType" label="Object type" name="type" type="string"/>
          <attribute label="Identifier" name="identifier" type="string"/>
        </element>
      </element>
      <element autopk="true" enumImage="@appState" folderModel="nmsWebApp" img="nms:webApp.png" label="Web application" name="webApp" pkgAdmin="@id != 0 ANd @isModel = 1" template="xtk:abstractForm">
        <compute-string expr="@label + ' (' + @internalName + ')'"/>
        <key name="name">
          <keyfield xpath="@internalName"/>
        </key>
        <attribute default="'nms:webApp'" name="entitySchema"/>
        <attribute default="GetOption('XtkInstancePrefix')+'APP'+CounterValue('nmsWebApp')" name="internalName"/>
        <attribute default="'nms:backgrounds/survey.png'" name="background" xml="true"/>
        <attribute default="1" name="accessControl"/>
        <attribute advanced="true" label="Type of application (compatibility)" name="appType" type="byte"/>
        <attribute advanced="true" desc="Create a log for each response to the form" label="Log responses" name="trackingEnabled" type="boolean" xml="true"/>
        <attribute desc="Tracking web enabling" label="Enable web tracking" name="webTrackingEnabled" type="boolean" xml="true"/>
        <attribute advanced="true" default="false" label="Use AEM as asset library" name="useAEM" type="boolean" xml="true"/>
        <attribute advanced="true" desc="Tracking URL name" label="Tracking URL name" name="trackingUrlName" type="string" xml="true"/>
        <attribute advanced="true" desc="Name of target folder" label="Name of target folder" name="folderName" type="string" xml="true"/>
        <attribute default="GetOption('NmsWebApp_XmlBackup')" desc="Saves survey answers in XML format in the answer table" label="Save a copy of raw answers" name="xmlBackup" type="boolean" xml="true"/>
        <element desc="Error message displayed if the form is closed." label="Log 'form closed'" localizable="true" name="closedFormLog" translatedDefault="'This form is currently closed.'" type="html" xml="true"/>
        <attribute desc="Form start date" label="Start" name="startDate" type="datetime"/>
        <attribute desc="Form close date" label="End date" name="endDate" type="datetime"/>
        <attribute default="getOption('Nms_DefaultRcpSchema')" label="Schema" name="schema" type="string" xml="true"/>
        <attribute advanced="true" default="'nms:webAppLogRcp'" desc="Schema of the library" label="Library" name="library" type="string"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:survey')" expr="Iif([facet/@survey], Iif(@library = '', '', 'temp:' + ExtractRight(@library, ':') + 'Data'), @library)" label="Dynamic schema" name="archivedFieldSchema" xml="true"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsWebAppModel', [@_folder-id])" name="folder" required="true" revDesc="Web applications contained in this folder" revLabel="Web applications" revLink="webapps" revTarget="nms:webApp" target="xtk:folder"/>
        <element applicableIf="HasPackage('nms:campaign')" label="Campaign" name="operation" revIntegrity="owncopy" target="nms:operation" type="link"/>
        <attribute dbEnum="webAppNature" desc="Nature of the web application" label="Nature" length="64" name="nature" type="string"/>
        <attribute advanced="true" desc="Specifies whether the content includes at least one HTML page" label="HTML page present" name="hasHtmlPage" type="boolean"/>
        <attribute advanced="true" default="true" desc="Allow overriding traffic source in the web application url" label="Allow url overriding of the traffic source" name="originUrlOverride" type="boolean" xml="true"/>
        <element advanced="true" desc="Default traffic source for this web application if no other source was found." externalJoin="true" label="Traffic source" name="defaultOrigin" target="nms:delivery" type="link"/>
        <element advanced="true" label="Target mapping" name="deliveryMapping" target="nms:deliveryMapping" type="link"/>
        <element defOnDuplicate="true" name="archivedFieldsSchema" type="ANY" xml="true"/>
        <element name="archivedFields" xml="true">
          <element name="field" unbound="true">
            <key internal="true" name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute label="Label" name="label" type="string"/>
            <attribute label="Name" name="name" type="string"/>
            <attribute label="Description" name="desc" type="string"/>
            <attribute label="Type" name="type" type="string"/>
            <attribute label="Constraint(s)" name="dataPolicy" type="string"/>
            <attribute label="Multiple values" name="unbound" type="string"/>
            <element name="values">
              <element advanced="true" label="Value" name="value" ordered="true" unbound="true">
                <key internal="true" name="@id">
                  <keyfield xpath="@id"/>
                </key>
                <attribute label="Primary key" name="id" type="string"/>
                <attribute label="Label" localizable="true" name="label" type="string"/>
                <attribute label="Value" name="value" type="string"/>
                <attribute advanced="true" label="Column index" name="colIndex" type="string"/>
                <attribute advanced="true" default="false" label="Other field" name="otherField" type="boolean"/>
                <attribute label="SQL name" name="sqlname" type="string"/>
                <attribute default="true" label="Calculate the SQL name automatically" name="autoSqlName" type="boolean"/>
              </element>
            </element>
            <attribute advanced="true" label="Last choice has text field for other" name="otherValEnabled" type="boolean"/>
            <attribute label="SQL name" name="sqlname" type="string"/>
            <attribute default="true" label="Calculate the SQL name automatically" name="autoSqlName" type="boolean"/>
            <attribute advanced="true" desc="Index used to map the field in SQL" label="Column index" name="colIndex" type="string"/>
            <element label="Enumeration" name="userEnum">
              <key internal="true" name="name">
                <keyfield xpath="@id"/>
              </key>
              <attribute label="Primary key" name="id" type="string"/>
              <attribute label="Name" length="128" name="name" type="string"/>
            </element>
            <element name="field" unbound="true">
              <key internal="true" name="id">
                <keyfield xpath="@id"/>
              </key>
              <attribute default="Gid()" label="Primary key" name="id" type="string"/>
              <attribute label="Label" name="label" type="string"/>
              <attribute label="SQL name" name="sqlname" type="string"/>
              <attribute advanced="true" desc="Index used to map the field in SQL" label="Column index" name="colIndex" type="string"/>
              <attribute label="Name" name="name" type="string"/>
            </element>
          </element>
        </element>
        <element aggregate="xtk:job:modelSupport" name="modelSupport"/>
        <element defOnDuplicate="true" default="iif (@isModel, DefaultFolder('nmsWebApp', [@_folderProcess-id]), 0)" img="xtk:execute.png" label="Instances folder" name="folderProcess" required="true" revDesc="Web application templates generating instances in this folder" revIntegrity="define" revLabel="Web application templates" revLink="webAppFolderProcess" revTarget="nms:webApp" target="xtk:folder" type="link"/>
        <element label="AEM account" name="cmsAccount" target="nms:extAccount" type="link"/>
        <element label="Activities" name="activities" xml="true">
          <element name="start" template="xtk:abstractForm:start" unbound="true"/>
          <element doesNotSupportDiff="true" label="Page (v5 compatibility)" name="page" template="xtk:abstractForm:page" unbound="true">
            <element name="link" template="nms:webApp:link" unbound="true"/>
            <element name="list" ref="list" unbound="true"/>
            <element name="iterator" template="nms:webApp:iterator" unbound="true"/>
          </element>
          <element name="test" ref="xtk:abstractForm:test" unbound="true"/>
          <element name="script" ref="xtk:abstractForm:script" unbound="true"/>
          <element name="prefill" ref="xtk:abstractForm:prefill" unbound="true"/>
          <element doesNotSupportDiff="true" name="htmlPage" ref="nms:webApp:htmlPage" unbound="true"/>
          <element name="writer" ref="xtk:abstractForm:writer" unbound="true"/>
          <element name="jump" template="xtk:abstractForm:jump" unbound="true">
            <element label="Target Web application" name="externalTarget" revLabel="Calling Web applications" revLink="links" target="nms:webApp" type="link"/>
          </element>
          <element name="end" ref="xtk:abstractForm:end" unbound="true"/>
          <element name="query" template="xtk:abstractForm:query" unbound="true"/>
          <element applicableIf="HasPackage('nms:purl')" name="accessControl" ref="nms:webApp:accessControl" unbound="true"/>
          <element applicableIf="HasPackage('nms:social')" name="accessControlSocial" ref="nms:webApp:accessControlSocial" unbound="true"/>
        </element>
        <element label="Facet" name="facet">
          <attribute applicableIf="HasPackage('nms:survey')" label="Survey" name="survey" type="boolean"/>
          <attribute applicableIf="HasPackage('nms:purl')" label="Microsites / pURL" name="purl" type="boolean"/>
          <attribute applicableIf="HasPackage('crm:lead')" label="Leads capture" name="lead" type="boolean"/>
          <attribute label="Advanced website (extranet)" name="advanced" type="boolean"/>
          <attribute applicableIf="HasPackage('nms:social')" label="Site integrated into social networks (facebook)" name="social" type="boolean"/>
        </element>
        <element applicableIf="HasPackage('nms:social')" label="Application" name="socialAccount" target="nms:extAccount" type="link"/>
      </element>
      <methods>
        <method name="Publish" static="true">
          <parameters>
            <param desc="Selection." inout="in" name="where" type="DOMElement"/>
            <param desc="New status of the form." inout="in" name="appState" type="byte"/>
          </parameters>
        </method>
        <method name="DictionaryCheck" static="true">
          <parameters>
            <param desc="Selection." inout="in" name="where" type="DOMElement"/>
            <param desc="Translation statistics." inout="out" name="stats" type="DOMElement"/>
          </parameters>
        </method>
        <method name="DictionaryImport" static="true">
          <parameters>
            <param desc="Name of the file or archive to import." inout="in" name="fileName" type="string"/>
          </parameters>
        </method>
        <method name="DictionaryExport" static="true">
          <parameters>
            <param desc="Selection." inout="in" name="where" type="DOMElement"/>
            <param desc="Export option" inout="in" name="exportOption" type="short"/>
            <param desc="Export format" inout="in" name="exportFormat" type="string"/>
            <param desc="Description of the output files" inout="out" name="files" type="DOMElement"/>
          </parameters>
        </method>
        <method name="ScanResources" static="true">
          <parameters>
            <param desc="Web application definition." inout="in" name="webApp" type="DOMElement"/>
            <param desc="Resources to translate." inout="out" name="resources" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GenerateSchema" static="true">
          <parameters>
            <param desc="Selection." inout="in" name="webAppId" type="string"/>
          </parameters>
        </method>
        <method dom="true" hidden="true" name="TranslateToInstanceLanguage" static="true">
          <parameters>
            <param desc="WebApp filters to be translated" inout="in" name="where" type="DOMElement"/>
            <param desc="XML element with the following attributes: destLang(string, default:instance language, can be any of en, fr, de, ..., see xtk:dictionaryString/@lang)" inout="in" name="parameters" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:wkfSurvey.js" name="RemoveLog" pkonly="true">
          <parameters>
            <param desc="List of records to remove" name="webAppLogList" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:wkfSurvey.js" name="NormalizeField" static="true">
          <parameters>
            <param desc="List of surveys which can contain the field to be normalized." inout="in" name="selectedWebApp" type="DOMElement"/>
            <param desc="Information on the field to be normalized." inout="in" name="archivedField" type="DOMElement"/>
            <param desc="New SQL name of this field." inout="in" name="newSQLName" type="string"/>
            <param desc="Name of the table which will contain the new SQL field." inout="in" name="tableName" type="string"/>
            <param desc="Schema identifier (view) where to add a reference belonging to the new field (optional)." inout="in" name="schemaId" type="string"/>
            <param desc="Also rename previously standardized fields." inout="in" name="rename" type="boolean"/>
          </parameters>
        </method>
        <method name="RemoveUnusedField"/>
        <method name="InvalidateWebAppCache" static="true">
          <parameters>
            <param desc="Selection." inout="in" name="where" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetUsedLanguagesEnum" static="true">
          <parameters>
            <param desc="Design language" inout="in" name="designLanguage" type="string"/>
            <param desc="Default language" inout="in" name="defaultLanguage" type="string"/>
            <param desc="Other languages" inout="in" name="additionalLanguages" type="DOMElement"/>
            <param desc="Enumeration with the languages used" inout="out" name="enum" type="DOMElement"/>
          </parameters>
        </method>
        <method library="xtk:webApp.js" name="DeleteWebApp" static="true">
          <parameters>
            <param desc="Web application identifier" name="id" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Version 4 Web form definitions" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:webForm.png" implements="xtk:persist" label="v4 Web forms" labelSingular="v4 Web form" name="webForm" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="string" default="edit" name="input">
        <value label="String" name="edit"/>
        <value label="Date" name="date"/>
        <value label="Drop-down list" name="combo"/>
        <value label="Checkbox" name="checkbox"/>
        <value label="Radio buttons" name="radio"/>
        <value label="Label" name="label"/>
        <value label="Hidden" name="hidden"/>
        <value label="Separator" name="separator"/>
        <value label="Separator label" name="labelSep"/>
        <value label="Encrypted password" name="password"/>
      </enumeration>
      <enumeration basetype="string" default="center" name="align">
        <value label="left" name="left"/>
        <value label="center" name="center"/>
        <value label="right" name="right"/>
      </enumeration>
      <enumeration basetype="string" default="horizontal" name="vAlign">
        <value label="Horizontal" name="horizontal"/>
        <value label="Vertical" name="vertical"/>
      </enumeration>
      <enumeration basetype="byte" default="update" name="type">
        <value img="nms:recipient.png" label="Update profile" name="update" value="0"/>
        <value img="nms:subscribe.png" label="Service subscription" name="subscribe" value="1"/>
        <value img="nms:blacklisted.png" label="Unsubscription from a service or blacklisting" name="unsub" value="2"/>
        <value img="nms:setofservices.png" label="Viral service" name="viral" value="3"/>
      </enumeration>
      <enumeration basetype="string" default="GET" name="method">
        <value label="GET" name="GET"/>
        <value label="POST" name="POST"/>
      </enumeration>
      <enumeration basetype="string" default="none" name="encoding">
        <value label="Do nothing" name="none"/>
        <value label="MD5" name="md5"/>
      </enumeration>
      <element desc="Title &amp; content" name="common">
        <attribute desc="Page title" label="Title" localizable="true" name="pageTitle" translatedDefault="'Enter your title here'" type="string"/>
        <attribute desc="Title style" label="Style" name="style" type="string"/>
        <element desc="HTML page content" label="Content" localizable="true" name="html" translatedDefault="'Enter your HTML content here'" type="CDATA"/>
      </element>
      <element name="page">
        <attribute label="Use an external confirmation page" name="external" type="boolean"/>
        <attribute default="false" label="Use an intermediate error page" name="interPage" type="boolean"/>
        <attribute label="URL" name="url" type="string"/>
        <element desc="Parameters to pass on to the external URL" label="Parameters to pass on" name="parameter" unbound="true">
          <attribute label="Field" name="xpath" type="string"/>
          <attribute label="Alias" name="alias" type="string"/>
        </element>
        <element aggregate="common" name="labels"/>
      </element>
      <element autopk="true" folderLink="folder" folderModel="nmsWebForm" img="nms:webForm.png" name="webForm" pkgAdmin="@id != 0">
        <compute-string expr="@label"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'FRM'+CounterValue('nmsWebForm')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="comment" template="xtk:common:comment"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute desc="Allow subscription to and unsubscription from all services by passing the service name as an additional parameter." label="Allow subscription to all services" name="enableAllServices" type="boolean" xml="true"/>
        <element desc="Service associated with the form" label="Service" name="service" target="nms:service" type="link"/>
        <element label="Search folder" name="searchFolder" target="xtk:folder" type="link"/>
        <element label="Creation folder" name="creationFolder" target="xtk:folder" type="link"/>
        <element label="XSL style sheet" name="xsltMail" target="xtk:xslt" type="link"/>
        <element default="DefaultXmlLink('nms:webForm.xsl')" label="XSL style sheet" name="xsltWeb" target="xtk:xslt" type="link"/>
        <element label="Generated HTML pages parameters" name="parameters" xml="true">
          <attribute default="'/xtk/img/form/classic/neologo159x42.png'" label="URL of the logo" name="logoUrl" type="string"/>
          <attribute label="Link of the logo" name="logoLink" type="string"/>
          <attribute default="'/nl/webForms/webForm.css'" desc="URL of the CSS stylesheet" label="URL of the CSS" name="cssUrl" type="string"/>
          <attribute default="false" desc="Used to hide the logo, frame and title" label="Do not generate decorations" name="noDecoration" type="boolean"/>
          <attribute label="HTML page title" name="pageTitle" type="string"/>
          <attribute label="Page width (pixels)" name="pageWidth" type="short"/>
          <attribute label="Page style" name="pageStyle"/>
          <element desc="HTML form" name="form">
            <attribute desc="Form type" enum="type" label="Type" name="type" type="byte"/>
            <attribute expr="getOption('NmsServer_URL')+'/nms/jsp/webForm.jsp?fo='+[../../@name]" label="Form URL" name="url"/>
            <attribute enum="method" label="Delivery method" name="method" type="string"/>
            <attribute label="Form requiring access control" name="authentication" type="boolean"/>
            <element desc="Form labels &amp; text" name="labels">
              <element aggregate="common" name="labels"/>
              <element desc="End of page HTML content" label="End of page" localizable="true" name="footer" type="CDATA"/>
              <attribute label="Mandatory fields" localizable="true" name="mandatory" translatedDefault="'* required field'" type="string"/>
              <attribute default="'center'" enum="align" label="Alignment" name="mandatoryAlign"/>
              <attribute label="Action label or URL" localizable="true" name="submit" translatedDefault="'Save'" type="string"/>
              <attribute default="'center'" enum="align" label="Alignment" name="submitAlign"/>
              <attribute default="1920" label="Start year" name="startYear" type="short"/>
              <attribute default="2015" label="End year" name="endYear" type="short"/>
              <attribute label="Day label" name="dayLabel" translatedDefault="'Day'" type="string"/>
              <attribute label="Month label" name="monthLabel" translatedDefault="'Month'" type="string"/>
              <attribute label="Year label" name="yearLabel" translatedDefault="'Year'" type="string"/>
              <attribute desc="Required label style" label="Style" name="mandatoryStyle" type="string"/>
              <attribute desc="Action button style" label="Style" name="submitStyle" type="string"/>
            </element>
            <element label="Form validation" name="validation">
              <element label="JavaScript code" name="javascript" type="string"/>
              <attribute label="Function called" name="function" type="string"/>
            </element>
            <element desc="List of editable fields of the recipient" name="recipientFields">
              <attribute label="Create recipient if it does not exist" name="create" type="boolean"/>
              <attribute default="'center'" enum="align" label="Form alignment" name="align"/>
              <attribute desc="Editable-field style" label="Field style" name="fieldStyle" type="string"/>
              <attribute desc="Field label style" label="Label style" name="labelStyle" type="string"/>
              <attribute desc="Internal usage" label="Encrypted value of the key" name="cryptedKey" type="string"/>
              <attribute default="true" label="Use an encrypted version of the primary key as a reconciliation key" name="mainKey" type="boolean"/>
              <element desc="Recipient fields" label="Recipient" name="field" ordered="true" unbound="true">
                <attribute label="Field" name="xpath" type="string"/>
                <attribute label="Label" localizable="true" name="label" type="string"/>
                <attribute label="Mandatory" name="mandatory" type="boolean"/>
                <attribute label="Reconciliation key" name="key" type="boolean"/>
                <attribute enum="input" label="Type" name="type"/>
                <attribute label="Initial length" name="size" type="short"/>
                <attribute label="Maximum length" name="maxsize" type="short"/>
                <attribute label="Number of columns" name="colNumber" type="short"/>
                <attribute label="Number of lines" name="lineNumber" type="short"/>
                <attribute default="false" label="Use multiple lines" name="multiLine" type="boolean"/>
                <attribute label="Value" name="value" type="string"/>
                <attribute label="Alias" name="alias" type="string"/>
                <attribute label="Style" name="style" type="string"/>
                <attribute label="Align left" name="leftAlign" type="boolean"/>
                <attribute default="'horizontal'" enum="vAlign" label="Alignment" name="vAlign" type="string"/>
                <attribute label="Width (%)" name="widthPercent" type="short"/>
                <attribute enum="encoding" label="Encryption type" name="encoding" type="string"/>
                <element name="value" ordered="true" unbound="true">
                  <attribute label="Label" localizable="true" name="label"/>
                  <attribute label="Value" name="value"/>
                  <attribute label="Select" name="selected" type="boolean"/>
                </element>
              </element>
            </element>
            <element desc="List of constant fields" name="constList">
              <element desc="Constant values" label="Constants" name="constant" unbound="true">
                <attribute label="Field" name="expr" type="string"/>
                <attribute label="Value" name="value" type="string"/>
                <attribute label="Update only if destination is empty" name="nullDestValue" type="boolean"/>
              </element>
            </element>
            <element desc="List of fields used to lookup the recipient" name="findList">
              <attribute default="false" label="Pre-fill form" name="loadData" type="boolean"/>
              <attribute default="true" label="Use an encrypted version of the primary key as a reconciliation key" name="mainKey" type="boolean"/>
              <element desc="Field used to lookup the recipient" name="find" unbound="true">
                <attribute label="Field" name="xpath" type="string"/>
                <attribute label="Alias" name="alias" type="string"/>
              </element>
            </element>
            <element desc="List of services the recipient can subscribe" name="serviceList">
              <attribute label="Title" localizable="true" name="title" translatedDefault="'List of subscriptions'" type="string"/>
              <attribute desc="List title style" label="Title style" name="style" type="string"/>
              <attribute desc="List style" label="List style" name="styleList" type="string"/>
              <attribute default="'left'" enum="align" label="List alignment" name="align"/>
              <element label="List of services" name="subscribe" ordered="true" unbound="true">
                <attribute label="Label" localizable="true" name="label" type="string"/>
                <attribute label="Service name" name="name" type="string"/>
                <attribute label="Mandatory" name="mandatory" type="boolean"/>
                <attribute label="Select" name="selected" type="boolean"/>
              </element>
            </element>
            <element desc="Viral form specific parameters" name="viral">
              <attribute default="1" desc="Number of referees" label="Number" name="sponsoredCount" type="long"/>
              <element name="senderField">
                <attribute label="Label" localizable="true" name="emailLabel" translatedDefault="'Your email'" type="string"/>
                <attribute default="1" label="Display first name" name="displayFirstName" type="boolean"/>
                <attribute label="Label" localizable="true" name="firstNameLabel" translatedDefault="'Your first name'" type="string"/>
                <attribute default="1" label="Display last name" name="displayLastName" type="boolean"/>
                <attribute label="Label" localizable="true" name="lastNameLabel" translatedDefault="'Your last name'" type="string"/>
                <attribute desc="Email label style" label="Style" name="emailStyle" type="string"/>
                <attribute desc="First name label style" label="Style" name="firstNameStyle" type="string"/>
                <attribute desc="Last name label style" label="Style" name="lastNameStyle" type="string"/>
                <attribute default="'@text3'" desc="First name xpath" label="First name" name="xpathFirstName" type="string"/>
                <attribute default="'@text4'" desc="Last name xpath" label="Last name" name="xpathLastName" type="string"/>
                <attribute default="'@origin'" desc="Email xpath" label="Email" name="xpathEmail" type="string"/>
                <attribute default="'@text5'" desc="Object XPath" label="Object" name="xpathObject" type="string"/>
                <attribute default="'@text2'" label="Mirror page key" name="xpathRecipient" type="string"/>
                <attribute default="'@text1'" desc="Encrypted delivery identifier" label="Delivery identifier" name="xpathDelivery" type="string"/>
                <attribute desc="Editable-field style" label="Field style" name="fieldStyle" type="string"/>
                <attribute desc="Field label style" label="Label style" name="labelStyle" type="string"/>
              </element>
              <attribute desc="Recipient-form header text" label="Recipient" localizable="true" name="recipient" translatedDefault="'Recipient: your friend'" type="string"/>
              <attribute desc="Sender-form header text" label="From" localizable="true" name="sender" translatedDefault="'Sender'" type="string"/>
              <attribute desc="Message header text" label="Message" localizable="true" name="message" translatedDefault="'Your message'" type="string"/>
              <attribute desc="Label style" label="Style" name="style" type="string"/>
            </element>
            <element desc="Unsubscription specific parameters" name="unsubscription">
              <attribute default="true" label="Use an intermediate confirmation page" name="interPage" type="boolean"/>
            </element>
          </element>
          <element desc="Confirmation page" name="confirm">
            <element name="successPage" ref="page"/>
            <element name="errorPage" ref="page"/>
          </element>
        </element>
        <element defOnDuplicate="true" default="DefaultFolder('nmsWebForm', [@_folder-id])" label="Folder" name="folder" required="true" revDesc="Web forms contained in this folder" revIntegrity="define" revLabel="Forms" target="xtk:folder" type="link"/>
      </element>
      <methods>
        <method access="anonymous" name="GetFormInfo" static="true">
          <parameters>
            <param desc="Parameters (at least form name)" name="formParam" type="DOMDocument"/>
            <param desc="Form parameters" inout="out" name="webForm" type="DOMDocument"/>
            <param desc="XSL style sheet" inout="out" name="xslForm" type="DOMDocument"/>
          </parameters>
        </method>
        <method access="anonymous" name="ValidateForm" static="true">
          <parameters>
            <param desc="Form name" name="formName" type="string"/>
            <param desc="List of recipients" name="recipient" type="DOMDocument"/>
          </parameters>
        </method>
        <method name="GenerateForm" static="true">
          <parameters>
            <param desc="Form name" name="formName" type="string"/>
            <param desc="Generate a form of type Mail" name="mailMode" type="boolean"/>
            <param desc="Result of the application of the XSL on the form" inout="out" name="result" type="string"/>
          </parameters>
        </method>
        <method access="anonymous" name="CompleteURLParams" static="true">
          <parameters>
            <param desc="Form name" name="formName" type="string"/>
            <param desc="Comma-separated list of XPaths to return" name="xpathParams" type="string"/>
            <param desc="Recipient data" name="recipient" type="DOMElement"/>
            <param desc="Return parameters for the URL" inout="out" name="result" type="string"/>
          </parameters>
        </method>
        <method access="anonymous" name="GetRcpIdFromConnectionString" static="true">
          <parameters>
            <param desc="Connection string" name="connectionString" type="string"/>
            <param desc="External identifier" inout="out" name="id" type="string"/>
            <param desc="Encrypted identifier" inout="out" name="cryptedId" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="List of extra parameters retrieved by the web tracking" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Web tracking" name="webTrackingLog" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="webTrackingLog" pkgStatus="never">
        <dbindex name="id" unique="true">
          <keyfield xpath="@id"/>
        </dbindex>
        <key internal="true" name="id">
          <keyfield xpath="@id"/>
        </key>
        <attribute desc="Internal primary key" label="Primary key" name="id" sqlname="iWebTrackingLogId" type="long"/>
        <attribute desc="Transaction amount" label="Amount" name="amount" type="double"/>
        <attribute desc="Number of articles in transaction" label="Articles" name="article" type="long"/>
        <attribute desc="Visitor identifier" label="Visitor identifier" name="visitorId" type="long"/>
        <attribute desc="Log category" label="Category" length="10" name="category" type="string"/>
        <element integrity="neutral" label="Delivery" name="delivery" revLink="_NONE_" target="nms:delivery" type="link">
          <join xpath-dst="@id" xpath-src="@deliveryId"/>
        </element>
        <attribute advanced="true" label="Foreign key of 'Delivery' link (field 'id')" name="deliveryId" sqlname="iDeliveryId" type="long"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" extendedSchema="xtk:workflow" genAccessors="false" name="workflow" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="undefined" name="startState">
        <value img="xtk:workflow16x16.png" label="Not defined" name="undefined" value="0"/>
        <value img="xtk:workflow/status-started.png" label="Pending start" name="starting" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="local" name="extSourceType">
        <value label="Specified in the transition" name="event" value="0"/>
        <value label="Calculated" name="script" value="1"/>
        <value label="Use the template" name="local" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="event" name="extFileSourceType">
        <value label="Specified in the transition" name="event" value="0"/>
        <value label="Calculated" name="script" value="1"/>
        <value label="Preprocessed" name="preproc" value="2"/>
      </enumeration>
      <enumeration basetype="byte" name="cardinality">
        <value label="N cardinality collection link" name="unbound" value="0"/>
        <value label="1 cardinality simple link" name="single" value="1"/>
        <value label="0 or 1 cardinality simple link" name="external" value="2"/>
      </enumeration>
      <enumeration basetype="byte" name="processState" template="xtk:workflow:workflowState">
        <value img="xtk:workflow/status-started.png" label="Start as soon as possible" name="fastStarting" value="1"/>
        <value img="xtk:workflow/status-started.png" label="Start during a low activity period" name="forecasting" value="2"/>
      </enumeration>
      <enumeration basetype="string" default="Oracle" name="provider">
        <value img="xtk:oracle.png" name="Oracle"/>
        <value img="xtk:mssql.png" label="Microsoft SQL Server" name="MSSQL"/>
        <value img="xtk:pgsql.png" label="PostgreSQL" name="PostgreSQL"/>
        <value img="xtk:teradata.png" label="Teradata" name="Teradata"/>
        <value img="xtk:db2.png" label="DB2" name="DB2"/>
        <value img="xtk:mysql.png" label="MySQL" name="MySQL"/>
        <value img="xtk:odbc.png" name="ODBC"/>
      </enumeration>
      <enumeration basetype="byte" default="low" name="priority">
        <value label="Low" name="low" value="0"/>
        <value label="Average" name="medium" value="1"/>
        <value label="High" name="high" value="2"/>
      </enumeration>
      <element applicableIf="HasPackage('nms:campaign')" name="execution">
        <attribute enum="xtk:workflow:priority" label="Priority" name="priority" type="byte"/>
        <attribute desc="Schedule execution for a time of low activity" label="Execute during downtime" name="forecasted" type="boolean"/>
        <attribute label="Execution login" name="login" pkgStatus="never" template="xtk:operator:operator/@name"/>
      </element>
      <element label="Result" name="result" template="xtk:workflow:transition">
        <attribute name="label" translatedDefault="'Result'"/>
        <attribute desc="Segment code of the target part" label="Segment code" name="code" type="string"/>
      </element>
      <element img="nms:subset.png" label="Subset" name="extractOutput" template="nms:workflow:result">
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute label="Use a specific filtering dimension" name="schemaOverride" type="boolean"/>
        <attribute default="[../@recipientLink]" name="recipientLink" template="nms:workflow:queryTarget/@recipientLink"/>
        <attribute default="[../@recipientLink]" name="schema" template="nms:workflow:queryTarget/@schema"/>
        <attribute label="Exclude this sub-set from the population" name="forExclusion" type="boolean"/>
        <attribute default="ColLabel()" name="label"/>
        <attribute default="Iif([../done/@enabled], 0, 1)" label="Generates its own table" name="enabled" xml="true"/>
        <element label="Record count limitation" name="limiter">
          <attribute label="Enable limitation" name="enabled" type="boolean"/>
          <attribute label="Keep only the first records after sorting" name="order" type="boolean"/>
          <attribute label="Activate random sampling" name="random" type="boolean"/>
          <attribute enum="limiterExtractType" label="Type of limit" name="type" type="string"/>
          <attribute default="10" label="Size (in %)" name="percent" type="float"/>
          <attribute label="Maximum size" name="number" type="long"/>
          <element label="Select which records to keep" name="orderBy" ref="xtk:queryDef:orderBy"/>
          <element label="Limitation by grouping" name="groupBy" ref="xtk:queryDef:groupBy"/>
          <attribute label="Enable limitation by grouping value" name="enableGroupByLimit" type="boolean"/>
          <element label="Limitations by grouping value" name="groupByLimit" unbound="true">
            <attribute label="Value" name="grpValue" type="string"/>
            <attribute label="Size" name="limit" type="long"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
          </element>
          <attribute default="100" label="Size of the default group" name="defaultLimit" type="long"/>
          <element label="Grouping condition" localizable="true" name="humanCond" type="string"/>
          <element applicableIf="HasPackage('nms:centralLocal')" label="Data distribution" name="localDistribution" target="nms:localDistribution" type="link"/>
        </element>
        <element label="Filtering of the records to keep" name="filter">
          <attribute label="Activate query based filtering" name="enabled" type="boolean"/>
          <attribute label="Activates intersection filtering" name="useIntersect" type="boolean"/>
          <element name="where" ref="where" unbound="true"/>
          <attribute label="Add a grouping clause" name="activeHaving" type="boolean"/>
          <element name="having" ref="xtk:queryDef:having"/>
          <element label="Query" localizable="true" name="humanCond" type="string"/>
        </element>
        <element name="select" ref="xtk:queryDef:select"/>
      </element>
      <enumeration basetype="byte" name="inmailAction">
        <value desc="The message must be processed only once" label="Delete the message and issue an event" name="deleteMailPostEvent" value="1"/>
        <value desc="The message must be processed and recycled for further possible processing" label="Leave the message and issue an event" name="keepMailPostEvent" value="2"/>
        <value desc="Unwanted message, deleted without processing" label="Delete the message but do not generate an event" name="deleteMailNoEvent" value="3"/>
        <value desc="Message maybe for another process" label="Leave the message and do not issue an event" name="keepMailNoEvent" value="4"/>
      </enumeration>
      <enumeration basetype="string" default="percent" label="Type of limit for extraction" name="limiterExtractType">
        <value label="Size (in %)" name="percent"/>
        <value label="Size (as a % of the segment)" name="segmentPercent"/>
        <value label="Maximum size" name="number"/>
        <value label="By data grouping" name="grouped"/>
        <value label="By data grouping (as a %)" name="groupedPercent"/>
        <value enabledIf="HasPackage('nms:centralLocal')" label="By data distribution" name="distribution"/>
      </enumeration>
      <enumeration basetype="string" default="manual" label="Predictive limitation type" name="limiterPredictiveType">
        <value label="Limit manually" name="manual"/>
        <value label="Fit to budget" name="stickToBudget"/>
        <value label="Maximize profit" name="maximizeProfit"/>
      </enumeration>
      <enumeration basetype="string" default="choice" label="Deduplication type" name="dedupType">
        <value label="Choose for me" name="choice"/>
        <value label="Following a list of values" name="order"/>
        <value label="Non-empty value" name="noEmpty"/>
        <value label="Using an expression" name="expr"/>
      </enumeration>
      <enumeration basetype="string" default="number" label="Limitation type for the union" name="limiterUnionType">
        <value label="Size (in %)" name="percent"/>
        <value label="Maximum size" name="number"/>
      </enumeration>
      <element name="queryTarget">
        <attribute default="[/@schema]" desc="Document types on which the query applies" label="Document type" length="64" name="schema" type="string"/>
        <attribute default="[/@recipientLink]" desc="Specifies the link from which foreign keys are used as output values" label="Target link" name="recipientLink" type="string"/>
      </element>
      <element desc="Where filtering clause" name="where" unbound="true">
        <element aggregate="xtk:queryDef:where" name="where"/>
        <attribute label="Filter name" name="filterName" type="string"/>
        <element desc="Context of the condition" label="Context" name="ctx" type="ANY"/>
      </element>
      <element desc="Process inbound emails from a POP3 account" img="nms:activities/inmail.png" label="Inbound Emails" name="inmail" template="xtk:workflow:activity">
        <attribute default="'nms:activities/inmail.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="true" label="Use an external account" name="useExtAccount" type="boolean"/>
        <element label="External account" name="extAccount" target="nms:extAccount" type="link"/>
        <attribute label="POP3 account" name="account" type="string"/>
        <attribute label="Password" name="password" type="string"/>
        <attribute label="POP3 server" name="server" required="true" type="string"/>
        <attribute default="110" label="Port" name="port" type="short"/>
        <attribute default="0" desc="Encryption type of connection" enum="nms:common:pop3TLSMode" label="Security" name="encryptionType" type="byte"/>
        <attribute default="true" label="Skip portions of emails that are badly formed or use an unsupported encoding." name="bypassCorruptedPart" type="boolean"/>
        <element edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <attribute default="false" desc="Stop as soon as an email is processed" label="Process a single email" name="stopAfterFirst" type="boolean"/>
        <attribute default="1000" label="Process emails in batch of" name="commitAfter" type="long"/>
        <attribute label="Plan execution" name="usePeriod" type="boolean"/>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo">
          <default>"m_abDay='7' m_abDay[0]='0' m_abDay[1]='0' m_abDay[2]='0' m_abDay[3]='0' m_abDay[4]='0' m_abDay[5]='0' m_abDay[6]='0' m_abMonth='12' m_abMonth[0]='0' m_abMonth[10]='0' m_abMonth[11]='0' m_abMonth[1]='0' m_abMonth[2]='0' m_abMonth[3]='0' m_abMonth[4]='0' m_abMonth[5]='0' m_abMonth[6]='0' m_abMonth[7]='0' m_abMonth[8]='0' m_abMonth[9]='0' m_iDayMode='1' m_iMaxIter='0' m_iMonthDay='0' m_iMonthMode='0' m_iPosDay='0' m_iSpanDay='0' m_iSpanWeek='0' m_iTimeMode='3' m_iValidMode='1' m_iWeekDay='0' m_iWeekMode='0' m_tmFixedDay='' m_tmFixedTime='00:00:00.000' m_tmIterDate='' m_tmIterTime='00:00:00.000' m_tmOrgDate='' m_tmSpanTime='30mn' m_tmStartDate='0001/01/01' m_tmStartTime='' m_tmStopDate='0001/01/01' m_tmStopTime='' m_vtmTime='0'"</default>
        </element>
        <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
        <element name="transitions">
          <element name="done" ref="xtk:workflow:transition"/>
          <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
          <element name="noMail" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'No email'"/>
            <attribute default="false" name="enabled"/>
          </element>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" name="insmsAction">
        <value label="Issue an event" name="postEvent" value="1"/>
        <value label="Do not issue an event" name="noEvent" value="2"/>
      </enumeration>
      <element desc="Inbound SMS" img="nms:activities/sms.png" label="Inbound SMS" name="inSms" template="xtk:workflow:activity">
        <attribute default="'nms:activities/sms.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element label="External account" name="extAccount" target="nms:extAccount" type="link"/>
        <element label="Filter" name="filter">
          <element label="Description" name="helpCond" type="string"/>
          <element name="where" template="xtk:queryDef:where" unbound="true">
            <attribute expr="'nms:inSMS'" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
          </element>
        </element>
        <element edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <attribute label="Plan execution" name="usePeriod" type="boolean"/>
        <attribute default="true" label="Stop schedule as soon as an SMS has been received and en event generated" name="stopAfterFirst" type="boolean"/>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo">
          <default>"m_abDay='7' m_abDay[0]='0' m_abDay[1]='0' m_abDay[2]='0' m_abDay[3]='0' m_abDay[4]='0' m_abDay[5]='0' m_abDay[6]='0' m_abMonth='12' m_abMonth[0]='0' m_abMonth[10]='0' m_abMonth[11]='0' m_abMonth[1]='0' m_abMonth[2]='0' m_abMonth[3]='0' m_abMonth[4]='0' m_abMonth[5]='0' m_abMonth[6]='0' m_abMonth[7]='0' m_abMonth[8]='0' m_abMonth[9]='0' m_iDayMode='1' m_iMaxIter='0' m_iMonthDay='0' m_iMonthMode='0' m_iPosDay='0' m_iSpanDay='0' m_iSpanWeek='0' m_iTimeMode='3' m_iValidMode='1' m_iWeekDay='0' m_iWeekMode='0' m_tmFixedDay='' m_tmFixedTime='00:00:00.000' m_tmIterDate='' m_tmIterTime='00:00:00.000' m_tmOrgDate='' m_tmSpanTime='30mn' m_tmStartDate='0001/01/01' m_tmStartTime='' m_tmStopDate='0001/01/01' m_tmStopTime='' m_vtmTime='0'"</default>
        </element>
        <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
        <element name="transitions">
          <element name="done" ref="xtk:workflow:transition"/>
          <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="download" name="fileTransferAction">
        <value label="File download" name="download" value="0"/>
        <value label="File upload" name="upload" value="1"/>
        <value label="Test to see if file exists" name="fileExistence" value="2"/>
        <value label="File listing" name="fileList" value="3"/>
      </enumeration>
      <element img="nms:activities/ftp.png" label="File transfer" name="fileTransfer" template="xtk:workflow:activity">
        <attribute default="'nms:activities/ftp.png'" name="img"/>
        <attribute desc="Action (download, upload, test for, list)" enum="fileTransferAction" label="Action" name="action" type="byte"/>
        <attribute default="true" desc="Use the file name posted by the previous activity (vars.filename)" label="Use the file generated by the previous activity" name="useIncomingFile" type="boolean"/>
        <attribute default="true" label="Use an external account" name="useExtAccount" type="boolean"/>
        <attribute desc="URL of the remote file" label="URL" name="url" type="string"/>
        <element label="External account" name="extAccount" target="nms:extAccount" type="link"/>
        <element name="localFile" ordered="true" unbound="true">
          <key name="path">
            <keyfield xpath="@path"/>
          </key>
          <attribute desc="Path of the file on the Adobe Campaign server (may include '*' and '?' wildcard characters)" label="Source file" name="path" type="string"/>
        </element>
        <attribute desc="Path of the file on the FTP server (may include '*' and '?' wildcard characters)" label="Server folder" name="filePath" type="string"/>
        <attribute default="false" label="Delete the source files after transfer" name="deleteFiles" type="boolean"/>
        <attribute default="true" label="Keep history of files sent" name="archiveFiles" type="boolean"/>
        <attribute desc="To be used when the remote server has limited access (behind a firewall)" label="Disable passive mode" name="disablePasv" type="boolean"/>
        <attribute desc="Displays the session logs in detail" label="Display the session logs" name="verboseMode" type="boolean"/>
        <attribute default="'-'" desc="Address of the Adobe Campaign FTP client to give to the remote server" label="Address for the PORT command" name="portAddress" type="string"/>
        <attribute desc="Requires the use of SSL for both connections (control and data)" label="Use SSL" name="useSSL" type="boolean"/>
        <attribute desc="List all files in a single transition" label="List all files" name="listFiles" type="boolean"/>
        <attribute desc="Temporary storage directory" label="Storage directory" name="tmpDirectory" type="string"/>
        <attribute default="true" desc="Use a specific storage directory for this activity, calculated  by default" label="Use a default storage directory" name="useDefault" type="boolean"/>
        <attribute default="100" desc="Maximum number of files to keep in the storage directory" label="Number of files" name="maxFiles" type="long"/>
        <attribute default="50" desc="Maximum storage space size in megabytes" label="Maximum size (in MB)" name="maxSizeMo" type="long"/>
        <attribute label="Plan execution" name="usePeriod" type="boolean"/>
        <attribute default="true" label="Stop the scheduling as soon as a file has been transferred" name="stopAfterFirst" type="boolean"/>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo">
          <default>"m_abDay='7' m_abDay[0]='0' m_abDay[1]='0' m_abDay[2]='0' m_abDay[3]='0' m_abDay[4]='0' m_abDay[5]='0' m_abDay[6]='0' m_abMonth='12' m_abMonth[0]='0' m_abMonth[10]='0' m_abMonth[11]='0' m_abMonth[1]='0' m_abMonth[2]='0' m_abMonth[3]='0' m_abMonth[4]='0' m_abMonth[5]='0' m_abMonth[6]='0' m_abMonth[7]='0' m_abMonth[8]='0' m_abMonth[9]='0' m_iDayMode='1' m_iMaxIter='0' m_iMonthDay='0' m_iMonthMode='0' m_iPosDay='0' m_iSpanDay='0' m_iSpanWeek='0' m_iTimeMode='3' m_iValidMode='1' m_iWeekDay='0' m_iWeekMode='0' m_tmFixedDay='' m_tmFixedTime='00:00:00.000' m_tmIterDate='' m_tmIterTime='00:00:00.000' m_tmOrgDate='' m_tmSpanTime='30mn' m_tmStartDate='0001/01/01' m_tmStartTime='' m_tmStopDate='0001/01/01' m_tmStopTime='' m_vtmTime='0'"</default>
        </element>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Ok'"/>
          </element>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
          <element name="fileExists" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'File exists'"/>
            <attribute default="false" name="enabled"/>
          </element>
          <element name="fileDoesNotExist" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'File does not exist'"/>
            <attribute default="false" name="enabled"/>
          </element>
          <element name="noFile" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'No file'"/>
            <attribute default="false" name="enabled"/>
          </element>
          <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
        </element>
      </element>
      <element applicableIf="HasPackage('nms:aamIntegration')" img="nms:activities/exportToAAM.png" label="Update shared audience" name="exportToAAM" template="xtk:workflow:activity">
        <attribute default="'nms:activities/exportToAAM.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute desc="Identifier of the Audience Manager property" label="Property" name="traitId" type="string"/>
        <attribute desc="Segment name" label="Audience name" name="segmentName" type="string"/>
        <attribute desc="Identifier of the Audience Manager segment" label="Audience identifier" name="segmentId" type="string"/>
        <element label="AMC Data source" name="amcDataSource" target="nms:amcDataSource" type="link"/>
        <attribute desc="Schema of the target mapping to export" label="Schema" name="schema" type="string"/>
        <attribute default="false" label="Use an external account" name="useExtAccount" type="boolean"/>
        <element label="External account" name="extAccount" target="nms:extAccount" type="link"/>
        <attribute label="Server file path" name="filePath" type="string"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="get" name="httpTransferAction">
        <value desc="GET method: the URL is the only parameter to pass" label="Simple transfer (GET)" name="get" value="0"/>
        <value desc="POST method: allow to send form parameters to the Web server" label="Transfer using a form (POST)" name="post" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="explicit" name="urlSource">
        <value desc="Exact URL connection" label="Explicit URL" name="explicit" value="0"/>
        <value desc="Connection to a predefined Web server" label="External account" name="extAccount" value="1"/>
        <value desc="Connection to the Adobe Campaign instance with the account used by the task" label="Adobe Campaign instance" name="nlserver" value="2"/>
      </enumeration>
      <element desc="File download from Web" img="nms:activities/http.png" label="Web download" name="httpTransfer" template="xtk:workflow:activity">
        <attribute default="'nms:activities/http.png'" name="img"/>
        <attribute desc="HTTP method (GET, POST) to use for the transfer" enum="httpTransferAction" label="Action" name="action" type="byte"/>
        <attribute enum="urlSource" label="Source URL" name="urlSource" type="byte"/>
        <attribute desc="URL of the file on the Web" label="URL" name="url" type="string"/>
        <element label="External account" name="extAccount" target="nms:extAccount" type="link"/>
        <attribute desc="File path on the server (can contain parameters)" label="File" name="filePath" type="string"/>
        <attribute label="Plan execution" name="usePeriod" type="boolean"/>
        <attribute default="true" desc="Stop schedule as soon as a file has been received and en event generated" label="Wait for a single file" name="stopAfterFirst" type="boolean"/>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo">
          <default>"m_abDay='7' m_abDay[0]='0' m_abDay[1]='0' m_abDay[2]='0' m_abDay[3]='0' m_abDay[4]='0' m_abDay[5]='0' m_abDay[6]='0' m_abMonth='12' m_abMonth[0]='0' m_abMonth[10]='0' m_abMonth[11]='0' m_abMonth[1]='0' m_abMonth[2]='0' m_abMonth[3]='0' m_abMonth[4]='0' m_abMonth[5]='0' m_abMonth[6]='0' m_abMonth[7]='0' m_abMonth[8]='0' m_abMonth[9]='0' m_iDayMode='1' m_iMaxIter='0' m_iMonthDay='0' m_iMonthMode='0' m_iPosDay='0' m_iSpanDay='0' m_iSpanWeek='0' m_iTimeMode='3' m_iValidMode='1' m_iWeekDay='0' m_iWeekMode='0' m_tmFixedDay='' m_tmFixedTime='00:00:00.000' m_tmIterDate='' m_tmIterTime='00:00:00.000' m_tmOrgDate='' m_tmSpanTime='30mn' m_tmStartDate='0001/01/01' m_tmStartTime='' m_tmStopDate='0001/01/01' m_tmStopTime='' m_vtmTime='0'"</default>
        </element>
        <attribute label="Follow redirections" name="followRedirs" type="boolean"/>
        <attribute label="Add the HTTP headers to the file" name="addHeaders" type="boolean"/>
        <attribute label="Ignore the HTTP return code" name="ignoreRespCode" type="boolean"/>
        <element label="POST parameters" name="postParameters">
          <element label="POST parameter" name="postParameter" ordered="true" unbound="true">
            <key name="name">
              <keyfield xpath="@name"/>
            </key>
            <attribute label="Name" name="name" type="string"/>
            <element label="Value" name="value" type="memo"/>
          </element>
        </element>
        <attribute desc="Temporary storage directory" label="Storage directory" name="tmpDirectory" type="string"/>
        <attribute default="true" desc="Use a specific storage directory for this activity, calculated  by default" label="Use a default storage directory" name="useDefault" type="boolean"/>
        <attribute default="100" desc="Maximum number of files to keep in the storage directory" label="Number of files" name="maxFiles" type="long"/>
        <attribute default="50" desc="Maximum storage space size in megabytes" label="Maximum size (in MB)" name="maxSizeMo" type="long"/>
        <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
        <element name="transitions">
          <element name="done" ref="xtk:workflow:transition"/>
          <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="xtk:activities/exec.png" label="nlserver module" name="nlmodule" template="xtk:workflow:activity">
        <attribute default="'xtk:activities/exec.png'" name="img"/>
        <element desc="Module start-up settings" label="Parameters" name="params" type="memo"/>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Ok'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/validation.png" label="Approval" name="validation" template="xtk:workflow:activity">
        <attribute default="'nms:activities/validation.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute desc="Title of the task" label="Title" name="title" type="string"/>
        <element desc="Message" edit="jstEdit" label="Message" name="message" type="memo" xml="true"/>
        <element label="Assignee" name="assignee" required="true" target="xtk:group" type="link"/>
        <element label="Assignee" name="operator" required="true" target="xtk:operator" type="link"/>
        <element label="Assignee" name="assigneeFilter" required="true" xml="true">
          <attribute desc="Start schema of the dynamic condition" label="Schema" name="schema" type="string"/>
          <element label="Dynamic condition" name="where" ref="xtk:queryDef:where"/>
          <attribute label="Label of the dynamic condition" localizable="true" name="humanCond" type="string"/>
        </element>
        <attribute enum="xtk:workflow:assigneeType" label="Assignment type" name="assigneeType" type="byte"/>
        <attribute label="Multiple approval" name="multiple" type="boolean"/>
        <element default="DefaultInstance('notifyAssignee')" desc="Template used for notification" label="Delivery template" name="scenario" target="nms:delivery" type="link"/>
        <element name="transitions">
          <element label="Answer" name="transition" ordered="true" ref="xtk:workflow:forkTransition" unbound="true">
            <translatedDefault>&lt;transition enabled="true" label="Yes" name="yes"/&gt;
          &lt;transition enabled="true" label="No" name="no"/&gt;</translatedDefault>
          </element>
          <element name="timeout" ref="xtk:workflow:timeout" unbound="true"/>
        </element>
      </element>
      <element img="nms:activities/alert.png" label="Alert" name="alert" template="xtk:workflow:activity">
        <attribute default="'nms:activities/alert.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute desc="Title of the task" label="Title" localizable="true" name="title" type="string"/>
        <element desc="Message" edit="jstEdit" label="Message" name="message" type="memo" xml="true"/>
        <element label="Assignee" name="assignee" required="true" target="xtk:group" type="link"/>
        <element label="Assignee" name="operator" required="true" target="xtk:operator" type="link"/>
        <element label="Assignee" name="assigneeFilter" required="true" xml="true">
          <attribute desc="Start schema of the dynamic condition" label="Schema" name="schema" type="string"/>
          <element label="Dynamic condition" name="where" ref="xtk:queryDef:where"/>
          <attribute label="Label of the dynamic condition" localizable="true" name="humanCond" type="string"/>
        </element>
        <attribute enum="xtk:workflow:assigneeType" label="Assignment type" name="assigneeType" type="byte"/>
        <element default="DefaultInstance('alertAssignee')" desc="Template used for notification" label="Template" name="scenario" target="nms:delivery" type="link"/>
        <element name="transitions">
          <element name="done" ref="xtk:workflow:transition"/>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="event" name="targetType">
        <value label="Specified by the inbound events" name="event" value="0"/>
        <value label="Specified in the scenario" name="scenario" value="1"/>
        <value label="File specified in the input event" name="file" value="2"/>
        <value label="Specified by a script" name="script" value="3"/>
      </enumeration>
      <element desc="Notification-type continuous delivery" img="nms:activities/notification.png" label="Continuous delivery" name="notification" template="xtk:workflow:activity">
        <attribute default="'nms:activities/notification.png'" name="img"/>
        <element label="Template" name="scenario" target="nms:delivery" type="link"/>
        <attribute desc="Specifies the source of the recipients" enum="targetType" label="Recipients" name="targetType" type="byte"/>
        <element desc="Script" edit="jstedit" label="Script" name="script" type="memo" xml="true"/>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Ok'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="event" name="targetSel">
        <value label="Specified by the inbound event(s)" name="event" value="0"/>
        <value label="Specified in the delivery" name="delivery" value="1"/>
        <value label="File(s) specified in the input event(s)" name="file" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="event" name="deliverySel">
        <value label="Specified in the event" name="event" value="0"/>
        <value label="Explicit" name="explicit" value="1"/>
        <value label="Computed by a script" name="script" value="2"/>
        <value label="New, created from a scenario" name="new" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="prepare" name="actionType">
        <value label="Save" name="save" value="0"/>
        <value label="Prepare" name="prepare" value="1"/>
        <value label="Prepare and start" name="prepareAndStart" value="2"/>
        <value label="Send a proof" name="sendFCP" value="3"/>
        <value label="Estimate the target" name="prepareTarget" value="4"/>
      </enumeration>
      <enumeration basetype="byte" default="delivery" name="contentType">
        <value label="Specified in the delivery" name="delivery" value="0"/>
        <value label="Specified by the inbound event" name="event" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="delivery" name="offerSel">
        <value label="Configured in the delivery" name="delivery" value="0"/>
        <value label="Specified by the input event" name="event" value="1"/>
      </enumeration>
      <element desc="Creates, prepares and starts a delivery" img="nms:activities/delivery.png" label="Delivery" name="delivery" template="xtk:workflow:activity">
        <attribute default="'nms:activities/delivery.png'" name="img"/>
        <attribute desc="Specifies the delivery on which to act" enum="deliverySel" label="Delivery" name="deliverySel" type="byte"/>
        <attribute desc="Specifies the source of the recipients" enum="targetSel" label="Target population" name="targetSel" type="byte"/>
        <attribute desc="Type of action to perform on the delivery action" enum="actionType" label="Action type" name="actionType" type="byte"/>
        <attribute desc="Specify the content of the delivery" enum="contentType" label="Content" name="contentType" type="byte"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Specifies the source of the offers" enum="offerSel" label="Offers" name="offerSel" type="byte"/>
        <attribute desc="Do not retrieve the target population for the delivery" label="Do not retrieve the target population" name="ignoreTarget" type="boolean"/>
        <element label="Delivery" name="delivery" target="nms:delivery" type="link"/>
        <element label="Template" name="scenario" target="nms:delivery" type="link"/>
        <element desc="Script used to computed the delivery identifier" label="Script" name="deliveryIdScript" type="CDATA"/>
        <element desc="Delivery object modification script" edit="jsedit" label="Script" name="script" type="memo"/>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Ok'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <element name="deliveryOperation" template="nms:workflow:delivery">
        <attribute default="'delivery'" name="xpathEditTarget" type="string"/>
        <attribute default="'deliveryOperation'" name="form" type="string"/>
        <attribute default="1" name="deliverySel" type="byte"/>
        <attribute default="1" name="targetSel" type="byte"/>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <element label="Email delivery" name="deliveryEmail" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/email.png'" name="img" type="string"/>
        <attribute default="0" name="messageType" type="byte"/>
      </element>
      <element applicableIf="HasPackage('nms:mobile')" label="Mobile delivery" name="deliveryMobile" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/sms.png'" name="img" type="string"/>
        <attribute default="1" name="messageType" type="byte"/>
      </element>
      <element applicableIf="HasPackage('nms:phone')" label="Telephone delivery" name="deliveryPhone" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/phone.png'" name="img" type="string"/>
        <attribute default="2" name="messageType" type="byte"/>
      </element>
      <element applicableIf="HasPackage('nms:paper')" label="Direct mail delivery" name="deliveryPaper" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/envelope.png'" name="img" type="string"/>
        <attribute default="3" name="messageType" type="byte"/>
      </element>
      <element applicableIf="HasPackage('nms:fax')" label="Fax delivery" name="deliveryFax" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/fax.png'" name="img" type="string"/>
        <attribute default="4" name="messageType" type="byte"/>
      </element>
      <element applicableIf="HasPackage('nms:centralLocal')" label="Agency delivery" name="deliveryAgency" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/agency.png'" name="img" type="string"/>
        <attribute default="5" name="messageType" type="byte"/>
      </element>
      <element label="Other delivery" name="deliveryOther" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/other.png'" name="img" type="string"/>
        <attribute default="120" name="messageType" type="byte"/>
      </element>
      <element label="Recurring delivery" name="deliveryRecurring" template="nms:workflow:deliveryOperation">
        <attribute default="'nms:activities/recurring.png'" name="img" type="string"/>
        <attribute default="127" name="messageType" type="byte"/>
        <attribute default="3" name="deliverySel" type="byte"/>
      </element>
      <element applicableIf="HasPackage('nms:campaign')" img="nms:activities/deliveryOutline.png" label="Delivery outline" name="deliveryOutline" template="xtk:workflow:activity">
        <attribute default="'nms:activities/deliveryOutline.png'" name="img"/>
        <element label="Delivery outline" name="deliveryOutline" target="nms:deliveryOutline" type="link"/>
        <attribute advanced="true" default="127" label="Outline channel" name="messageType" type="byte"/>
        <attribute advanced="true" label="Planned contact-date" name="contactDate" type="datetime"/>
        <attribute applicableIf="HasPackage('nms:interaction')" default="0" label="Number of propositions to keep" name="maxPropositionCount" type="long"/>
        <attribute applicableIf="HasPackage('nms:interaction')" default="0" label="Exclude individuals not eligible to the offers from the delivery outline." name="excludeOnMissingOffer" type="boolean"/>
        <element applicableIf="HasPackage('nms:interaction')" label="Offer space" name="offerSpace" target="nms:offerSpace" type="link"/>
        <element autopk="true" label="Filtering rules" name="ruleFilter" ordered="true" unbound="true" xml="true">
          <element label="Typology rule" name="rule" target="nms:typologyRule" type="link"/>
        </element>
        <element autopk="true" label="Filtering typologies" name="typologyFilter" ordered="true" unbound="true" xml="true">
          <element label="Typology" name="typology" target="nms:typology" type="link"/>
        </element>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Ok'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="event" name="controlDeliverySel">
        <value label="Specified by the input event" name="event" value="0"/>
        <value label="Explicit" name="explicit" value="1"/>
        <value label="Computed by a script" name="script" value="2"/>
      </enumeration>
      <enumeration basetype="byte" default="start" name="controlActionType">
        <value label="Start" name="start" value="1"/>
        <value label="Pause" name="pause" value="2"/>
        <value label="Stop" name="stop" value="3"/>
      </enumeration>
      <element desc="Act on an existing delivery" img="nms:activities/control-delivery.png" label="Delivery control" name="controlDelivery" template="xtk:workflow:activity">
        <attribute default="'nms:activities/control-delivery.png'" name="img"/>
        <attribute desc="Specifies the delivery on which to act" enum="controlDeliverySel" label="Delivery" name="deliverySel" type="byte"/>
        <attribute desc="Type of action to perform on the delivery action" enum="controlActionType" label="Action type" name="actionType" type="byte"/>
        <element label="Delivery" name="delivery" target="nms:delivery" type="link"/>
        <element desc="Script used to computed the delivery identifier" label="Script" name="deliveryIdScript" type="CDATA"/>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Ok'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="error" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Error'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="event" name="distributionSel">
        <value label="Specified by the event" name="event" value="0"/>
        <value label="Explicit" name="explicit" value="1"/>
      </enumeration>
      <enumeration basetype="byte" default="notif" name="distributionAction">
        <value label="Target approval notification" name="notif" value="0"/>
        <value label="Delivery feedback report" name="report" value="1"/>
      </enumeration>
      <element applicableIf="HasPackage('nms:centralLocal')" img="nms:activities/localValidation.png" label="Local approval" name="localValidation" template="xtk:workflow:activity">
        <attribute default="'nms:activities/localValidation.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute enum="distributionSel" label="Distribution context" name="distributionSel" type="byte"/>
        <attribute enum="distributionAction" label="Distribution action" name="distributionAction" type="byte"/>
        <element label="Data distribution" name="localDistribution" target="nms:localDistribution" type="link"/>
        <element label="Approval" name="validation" ref="nms:common:validation"/>
        <element label="Reminder" name="reminder" ordered="true" ref="nms:common:reminder" unbound="true" xml="true"/>
        <element label="Delivery" name="delivery" target="nms:delivery" type="link"/>
        <attribute desc="Specifies the delivery on which to act" enum="deliverySel" label="Delivery" name="deliverySel" type="byte"/>
        <attribute desc="Delivery subject" label="Subject" name="subject" type="string"/>
        <element default="DefaultInstance('notifyLocalValidation')" label="Template" name="deliveryModel" target="nms:delivery" type="link"/>
        <element label="Description" name="description" type="html"/>
        <attribute desc="Automatically activate the output transition once approvals" label="Processing expected as soon as everything has been approved" name="earlyValidation" type="boolean"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" desc="Generate the complementary set (all non approved targets are saved in a second set)" label="Generate complement" name="enabled"/>
          </element>
        </element>
      </element>
      <element desc="Marketing tasks" img="nms:activities/task.png" label="Task" name="task" template="xtk:workflow:activity">
        <attribute default="'nms:activities/task.png'" name="img"/>
        <attribute default="'taskOp'" name="xpathEditTarget" type="string"/>
        <attribute default="'task'" name="form" type="string"/>
        <element label="Task" name="taskOp" target="nms:task" type="link"/>
        <element name="transitions">
          <element name="validated" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Approve'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="refused" template="xtk:workflow:transition">
            <attribute name="label" translatedDefault="'Reject'"/>
            <attribute default="true" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/incremental.png" label="Incremental query" name="incremental" template="xtk:workflow:activity">
        <attribute default="'nms:activities/incremental.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element aggregate="queryTarget" name="target"/>
        <attribute default="true" label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute label="Group data by targeting dimension element" name="groupBy" type="boolean"/>
        <attribute default="false" label="Disable automatic adding of targeting dimension identification keys" name="noAutoPk" type="boolean"/>
        <attribute default="false" label="Disable automatic filtering of 0 ID records" name="noAutoPkFilter" type="boolean"/>
        <attribute default="false" label="Keep all additional data from the main set" name="keepAllExtraData" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Group aggregates based on the values in the sort columns" name="useOrderByValuesAsRank" type="boolean"/>
          <attribute label="The collection represents an N-N link" name="NtoNDedup" type="boolean"/>
          <attribute label="Merge records" name="merge" type="boolean"/>
        </element>
        <element name="where" template="where" unbound="true">
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
        </element>
        <element name="outputFilter" ref="where"/>
        <element doesNotSupportDiff="true" label="Source schema" name="extension" type="ANY"/>
        <attribute label="Add a grouping clause" name="activeHaving" type="boolean"/>
        <element name="having" ref="xtk:queryDef:having"/>
        <element label="Query" localizable="true" name="humanCond" type="string"/>
        <attribute default="true" label="Plan execution" name="usePeriod" type="boolean"/>
        <element desc="Configuration of execution schedule" label="Schedule" name="period" required="true" type="memo"></element>
        <attribute desc="Number of days to keep the list of processed recipients" label="History in days" name="history" type="long"></attribute>
        <attribute default="true" desc="The history is not reset when a task is activated" label="Keep history when starting" name="keepHistory" type="boolean"></attribute>
        <attribute desc="Overloads the name of the SQL table used to keep history." label="SQL table name" name="sqlTableHisto" type="string"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/query.png" label="Query" name="query" template="xtk:workflow:activity">
        <attribute default="'nms:activities/query.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element aggregate="queryTarget" name="target"/>
        <attribute default="false" label="Use the source" name="useSource" type="boolean"/>
        <attribute default="true" label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute label="Group data by targeting dimension element" name="groupBy" type="boolean"/>
        <attribute default="false" label="Disable automatic adding of targeting dimension identification keys" name="noAutoPk" type="boolean"/>
        <attribute default="false" label="Disable automatic filtering of 0 ID records" name="noAutoPkFilter" type="boolean"/>
        <attribute default="false" label="Keep all additional data from the main set" name="keepAllExtraData" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Group aggregates based on the values in the sort columns" name="useOrderByValuesAsRank" type="boolean"/>
          <attribute label="The collection represents an N-N link" name="NtoNDedup" type="boolean"/>
          <attribute label="Merge records" name="merge" type="boolean"/>
        </element>
        <element name="where" template="where" unbound="true">
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
        </element>
        <element name="outputFilter" ref="where"/>
        <element doesNotSupportDiff="true" label="Source schema" name="extension" type="ANY"/>
        <attribute label="Add a grouping clause" name="activeHaving" type="boolean"/>
        <element name="having" ref="xtk:queryDef:having"/>
        <element label="Query" localizable="true" name="humanCond" type="string"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
        </element>
      </element>
      <enumeration basetype="string" name="scoreApplicationType">
        <value label="Exact match" name="none"/>
        <value label="All" name="all"/>
        <value label="A selection" name="select"/>
      </enumeration>
      <enumeration basetype="string" label="Deduplication type for reconciliation" name="dedupReconcType">
        <value label="Following a list of values" name="order"/>
        <value label="Non-empty value" name="noEmpty"/>
        <value label="Using an expression" name="expr"/>
      </enumeration>
      <element img="nms:activities/enrich.png" label="Enrichment" name="enrich" template="xtk:workflow:activity">
        <attribute default="'nms:activities/enrich.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <attribute label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute label="Group data by targeting dimension element" name="groupBy" type="boolean"/>
        <attribute label="Add an identifier per line" name="addAutoPk" type="boolean"/>
        <attribute default="false" label="Disable automatic filtering of 0 ID records" name="noAutoPkFilter" type="boolean"/>
        <attribute default="true" label="Keep all additional data from the main set" name="keepAllExtraData" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element name="outputFilter" ref="where"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Group aggregates based on the values in the sort columns" name="useOrderByValuesAsRank" type="boolean"/>
          <attribute label="The collection represents an N-N link" name="NtoNDedup" type="boolean"/>
          <attribute label="Merge records" name="merge" type="boolean"/>
        </element>
        <element desc="Targeting document identification" name="mainReconc">
          <attribute label="Identify the document from the working data" name="enabled" type="boolean"/>
          <attribute label="Keep unreconciled data coming from the work table" name="outerJoin" type="boolean"/>
          <attribute label="Select the same reference for all records identified two by two" name="flattenTree" type="boolean"/>
          <attribute label="Keep only one record for all records considered as close" name="dedup" type="boolean"/>
          <attribute label="Targeting dimension" name="schema" type="string"/>
          <element label="Reconciliation" name="condition" unbound="true">
            <key name="recCond">
              <keyfield xpath="@srcExpr"/>
              <keyfield xpath="@dstExpr"/>
            </key>
            <attribute label="Source expression" name="srcExpr" type="string"/>
            <attribute label="Destination expression" name="dstExpr" type="string"/>
          </element>
          <element name="join" template="xtk:queryDef:where"/>
          <element label="Identification rule" name="keys" ordered="true" unbound="true">
            <attribute default="true" label="Active" name="active" type="boolean"/>
            <attribute label="Description" name="label" type="string"/>
            <element name="join" template="xtk:queryDef:where"/>
            <attribute label="Minimum proximity score" name="minScore" type="double"/>
            <attribute enum="scoreApplicationType" label="Scores taken into account" name="scoresApplied" type="string"/>
            <element label="Selected scores" name="scoreRule" unbound="true">
              <key name="scoreKey">
                <keyfield xpath="@name"/>
              </key>
              <attribute name="name"/>
            </element>
          </element>
          <element desc="Calculation rule of the proximity score" label="Proximity score" name="scoreRule" ordered="true" unbound="true">
            <attribute default="true" label="Active" name="active" type="boolean"/>
            <attribute label="Identifier" name="name" type="string"/>
            <element name="join" template="xtk:queryDef:where"/>
            <attribute desc="Proximity score: the higher it is, the more similar the records are considered as being" label="Score" name="score" type="double"/>
          </element>
          <element name="where" ref="xtk:queryDef:where"/>
          <element label="Ordering values" name="orderedValue" ordered="true" unbound="true">
            <attribute enum="dedupReconcType" label="Selection" name="dedupType" type="string"/>
            <attribute label="Expression" name="expr" type="string"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
            <attribute enum="orderType" label="Comparison used for other values" name="orderType" type="byte"/>
            <element label="Values" name="value" ordered="true" unbound="true">
              <attribute label="Value" name="value" type="string"/>
            </element>
          </element>
        </element>
        <element desc="Join conditions for creating links" name="reconc" unbound="true">
          <attribute label="Identifier" name="name" type="string"/>
          <attribute label="Description" localizable="true" name="label" type="string"/>
          <attribute label="Target schema" name="schema" type="string"/>
          <attribute label="Source activity" name="srcDataSet" type="string"/>
          <element label="Join" name="condition" unbound="true">
            <key name="recCond">
              <keyfield xpath="@srcExpr"/>
              <keyfield xpath="@dstExpr"/>
            </key>
            <attribute label="Source expression" name="srcExpr" type="string"/>
            <attribute label="Destination expression" name="dstExpr" type="string"/>
          </element>
          <element name="join" template="xtk:queryDef:where"/>
          <attribute label="Taken into account if" name="enabledIf" type="string"/>
          <attribute desc="Fetch a single row for a link (optimized mode)" label="Choose a single row" name="singleRow" type="boolean"/>
          <attribute label="Select the same reference for all records identified two by two" name="flattenTree" type="boolean"/>
          <attribute label="Authorize empty reconciliation keys" name="allowEmptyPart" type="boolean"/>
          <element label="Identification rules" name="keys" ordered="true" unbound="true">
            <attribute default="true" label="Active" name="active" type="boolean"/>
            <attribute label="Description" name="label" type="string"/>
            <element name="join" template="xtk:queryDef:where"/>
            <attribute label="Minimum proximity score" name="minScore" type="double"/>
            <attribute enum="scoreApplicationType" label="Scores taken into account" name="scoresApplied" type="string"/>
            <element label="Rule" name="scoreRule" unbound="true">
              <key name="scoreKey">
                <keyfield xpath="@name"/>
              </key>
              <attribute name="name"/>
            </element>
          </element>
          <element desc="Proximity score calculation rule" label="Proximity score" name="scoreRule" ordered="true" unbound="true">
            <attribute default="true" label="Active" name="active" type="boolean"/>
            <attribute label="Identifier" name="name" type="string"/>
            <element name="join" template="xtk:queryDef:where"/>
            <attribute label="Score" name="score" type="double"/>
          </element>
          <element name="where" ref="xtk:queryDef:where"/>
          <element name="orderBy" ref="xtk:queryDef:orderBy"/>
        </element>
        <element desc="Join conditions for link definition" name="links" unbound="true">
          <key name="linkDef">
            <keyfield xpath="@name"/>
          </key>
          <attribute label="Identifier" name="name" type="string"/>
          <attribute label="Description" localizable="true" name="label" type="string"/>
          <attribute label="Target schema" name="schema" type="string"/>
          <attribute label="Source activity" name="srcDataSet" type="string"/>
          <attribute enum="cardinality" label="Cardinality" name="cardinality" type="byte"/>
          <element label="Join" name="condition" unbound="true">
            <key name="join">
              <keyfield xpath="@srcExpr"/>
              <keyfield xpath="@dstExpr"/>
            </key>
            <attribute label="Source expression" name="srcExpr"/>
            <attribute label="Destination expression" name="dstExpr"/>
          </element>
          <element name="join" template="xtk:queryDef:where"/>
        </element>
        <element doesNotSupportDiff="true" label="Source schema" name="extension" type="ANY"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/changeAxis.png" label="Change dimension" name="changeAxis" template="xtk:workflow:activity">
        <attribute default="'nms:activities/changeAxis.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute label="New document type" length="64" name="schema" type="string"/>
        <attribute label="Link enabling change of dimension" name="recipientLink" type="string"/>
        <element name="configuration">
          <attribute enum="dedupType" label="Method" name="type" type="string"/>
          <element label="List of groups" name="groupExpr" ordered="true" unbound="true">
            <attribute label="Expression" name="expr" type="string"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
          </element>
          <attribute default="false" label="Keep deduplicated record in the list of duplicates" name="includeMainInDuplicates" type="boolean"/>
          <element label="Ordering values" name="orderedValue" ordered="true" unbound="true">
            <attribute label="Expression" name="expr" type="string"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
            <attribute enum="orderType" label="Comparison used for other values" name="orderType" type="byte"/>
            <element label="Values" name="value" ordered="true" unbound="true">
              <attribute label="Value" name="value" type="string"/>
            </element>
          </element>
          <element label="Condition" name="where" ref="xtk:queryDef:where" unbound="false"/>
          <element label="Ordering columns" name="orderedExpr" ordered="true" unbound="true">
            <attribute label="Expression" name="expr" type="string"/>
            <attribute label="Label" localizable="true" name="label" type="string"/>
            <attribute enum="compType" label="Comparison type on an expression" name="compType" type="byte"/>
          </element>
          <attribute default="1" label="Number of doubles to keep" name="number" type="short"/>
          <element label="Query" localizable="true" name="display" type="string"/>
        </element>
        <attribute label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute default="false" label="Disable automatic filtering of 0 ID records" name="noAutoPkFilter" type="boolean"/>
        <attribute default="true" label="Keep all additional data from the source" name="keepAllExtraData" type="boolean"/>
        <attribute default="false" label="Save the rank of each record in an additional column" name="keepRank" type="boolean"/>
        <attribute label="Group data by targeting dimension element" name="groupBy" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Group aggregates based on the values in the sort columns" name="useOrderByValuesAsRank" type="boolean"/>
          <attribute label="The collection represents an N-N link" name="NtoNDedup" type="boolean"/>
          <attribute label="Merge records" name="merge" type="boolean"/>
        </element>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" desc="Generate the complementary set (all duplicates are stored in a second set)" label="Generate complement" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="extAccount" name="dataSourceType">
        <value label="External account" name="extAccount" value="0"/>
        <value label="Defined in the activity" name="inline" value="1"/>
        <value label="Defined in the server configuration files" name="server" value="2"/>
      </enumeration>
      <element img="nms:activities/dbImport.png" label="Data loading (RDBMS)" name="dbImport" template="xtk:workflow:activity">
        <attribute default="'nms:activities/dbImport.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="true" name="runOnce" type="boolean"/>
        <attribute enum="xtk:workflow:dataSourceType" label="Local data source" name="inline" type="byte"/>
        <element desc="External data source definition" label="Data source" name="dataSourceDesc" template="xtk:serverConf:dataSource/dbcnx">
          <attribute desc="External database name" label="Database name" name="dbName" type="string"/>
          <attribute desc="Identifier of the data source in the config-instance.xml file" label="Connection name" name="name" type="string"/>
        </element>
        <element label="Data source" name="dataSource" target="nms:extAccount" type="link"/>
        <attribute label="Name of the template table" name="tableName" type="string"/>
        <attribute enum="xtk:workflow:extSourceType" name="importType" type="byte"/>
        <attribute label="Table name" name="script" type="string"/>
        <element doesNotSupportDiff="true" label="Source schema" name="extension" type="ANY"/>
        <element desc="Join conditions for creating links" name="links" ref="xtk:workflow:enrich/links" unbound="true"/>
        <attribute label="Keep all source data" name="keepAllExtraData" type="boolean"/>
        <attribute default="false" label="Disable automatic adding of targeting dimension identification keys" name="noAutoPk" type="boolean"/>
        <attribute default="false" label="Disable automatic filtering of 0 ID records" name="noAutoPkFilter" type="boolean"/>
        <attribute label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute label="Group data by targeting dimension element" name="groupBy" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Group aggregates based on the values in the sort columns" name="useOrderByValuesAsRank" type="boolean"/>
          <attribute label="The collection represents an N-N link" name="NtoNDedup" type="boolean"/>
          <attribute label="Merge records" name="merge" type="boolean"/>
        </element>
        <element label="Condition" name="where" ref="xtk:queryDef:where" unbound="false"/>
        <element label="Filter" localizable="true" name="humanCond" type="string"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="true" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/fileImport.png" label="Data loading (file)" name="fileImport" template="xtk:workflow:activity">
        <attribute default="'nms:activities/fileImport.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="true" name="runOnce" type="boolean"/>
        <element name="source" ref="nms:group:group/source"/>
        <attribute enum="xtk:workflow:extFileSourceType" name="importType" type="byte"/>
        <attribute default="true" label="Use a line number as identifier" name="collectLineNumber" type="boolean"/>
        <attribute default="100" desc="Maximum number of erroneous lines before timeout" label="Maximum number of errors" name="maxErrorCount" type="long"/>
        <attribute label="File Name" name="file" type="string"/>
        <attribute label="Preprocessing command" name="preproc" type="string"/>
        <attribute label="Md5 of the file in case of download" name="md5" type="string"/>
        <element label="Data source" name="dataSource" target="nms:extAccount" type="link"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" name="enabled"/>
            <attribute label="File Name" name="file" type="string"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/soapImport.png" label="Loading (SOAP)" name="soapImport" template="xtk:workflow:activity">
        <attribute default="'nms:activities/soapImport.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="true" name="runOnce" type="boolean"/>
        <element label="Example of a result" name="sample" type="memo"/>
        <element name="dataSourceConfig" ref="nms:group:group/source/dataSourceConfig"/>
        <attribute label="URL for accessing the schema/ WSDL" name="URL" type="string"/>
        <attribute label="Selected service" name="serviceName" type="string"/>
        <attribute label="Selected call" name="callName" type="string"/>
        <element edit="jsedit" name="soapInit" type="memo"/>
        <element edit="jsedit" name="soapCall" type="memo"/>
        <element edit="jsedit" name="soapEnd" type="memo"/>
        <attribute default="true" label="Use a line number as identifier" name="collectLineNumber" type="boolean"/>
        <attribute default="true" label="The SOAP call returns several elements" name="collectionResult" type="boolean"/>
        <attribute default="100" desc="Maximum number of erroneous lines before timeout" label="Maximum number of errors" name="maxErrorCount" type="long"/>
        <element doesNotSupportDiff="true" label="Extension data" name="extension" type="ANY" xml="true"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="true" name="enabled"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" name="enabled"/>
            <attribute label="File Name" name="file" type="string"/>
          </element>
        </element>
      </element>
      <element img="xtk:activities/export.png" label="Data extraction (file)" name="fileExport" template="xtk:workflow:activity">
        <attribute default="'xtk:activities/export.png'" name="img"/>
        <attribute desc="Name of the file to extract" label="File name" name="file" type="string"/>
        <element edit="jsedit" label="Script" name="script" type="memo" xml="true"/>
        <element label="Extraction definition" name="extraction" xml="true">
          <element name="source" ref="xtk:dataTransfer:source"/>
          <element name="destination" ref="xtk:dataTransfer:destination"/>
        </element>
        <element name="transitions" template="xtk:workflow:doneAndError"/>
      </element>
      <element img="nms:activities/schemaEdit.png" label="Edit schema" name="schemaEdit" template="xtk:workflow:activity">
        <attribute default="'nms:activities/schemaEdit.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="true" label="Hide the columns defined upstream" name="hideSourceColumn" type="boolean"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <element aggregate="queryTarget" name="target"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Join conditions for creating links" name="links" ref="xtk:workflow:enrich/links" unbound="true"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/union.png" label="Union" name="union" template="xtk:workflow:activity">
        <attribute default="'nms:activities/union.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute label="Use common additional data only" name="useOnlyCommonColumns" type="boolean"/>
        <attribute default="true" label="Use the targeting key for deduplication" name="useKeyForReconciliation" type="boolean"/>
        <attribute label="Limit the size of the population generated" name="enableLimit" type="boolean"/>
        <attribute label="Maximum number of records" name="limit" type="long"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <element label="List of fields for the join" name="joinKeys" unbound="true">
          <key name="xpath">
            <keyfield xpath="@xpath"/>
          </key>
          <attribute label="Field" name="xpath" type="string"/>
        </element>
        <element label="List of limitations on inbound events" name="eventLimit" ordered="true" unbound="true">
          <key name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute label="Data set" name="name" type="string"/>
          <attribute label="Label" localizable="true" name="label" type="string"/>
        </element>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/intersection.png" label="Intersection" name="intersection" template="xtk:workflow:activity">
        <attribute default="'nms:activities/intersection.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute label="Use common additional data only" name="useOnlyCommonColumns" type="boolean"/>
        <attribute default="true" label="Use the targeting key for deduplication" name="useKeyForReconciliation" type="boolean"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <element label="List of fields for the join" name="joinKeys" unbound="true">
          <key name="xpath">
            <keyfield xpath="@xpath"/>
          </key>
          <attribute label="Field" name="xpath" type="string"/>
        </element>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" desc="Generate the complementary set (union of inputs minus the intersection)" label="Generate complement" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="id" label="Exclusion type" name="excludeType">
        <value label="Change axis" name="axis" value="0"/>
        <value label="Identifier" name="id" value="1"/>
        <value label="Joins" name="join" value="2"/>
      </enumeration>
      <element img="nms:activities/exclusion.png" label="Exclusion" name="exclusion" template="xtk:workflow:activity">
        <attribute default="'nms:activities/exclusion.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="true" label="Use the targeting key for deduplication" name="useKeyForReconciliation" type="boolean"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <element label="Exclusions" name="exclusionSet" unbound="true" xml="true">
          <attribute label="Exclusion set" name="name" type="string"/>
          <attribute enum="xtk:workflow:excludeType" label="Exclusion type" name="excludeType" type="byte"/>
          <attribute label="Change dimension" name="excludeAxis" type="string"/>
          <attribute label="Identifier" name="excludePath" type="string"/>
          <element label="Joins" name="joinKeys" unbound="true">
            <key name="xpath">
              <keyfield xpath="@xpathSrc"/>
              <keyfield xpath="@xpathDst"/>
            </key>
            <attribute label="Source" name="xpathSrc" type="string"/>
            <attribute label="Destination" name="xpathDst" type="string"/>
          </element>
        </element>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" desc="Generate the complementary set (intersection between the union of entries and the main set)" label="Generate complement" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/piechart.png" label="Split" name="extract" template="xtk:workflow:activity">
        <attribute default="'nms:activities/piechart.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute label="Enable overlapping of output populations" name="alwaysExtractFromSource" type="boolean"/>
        <attribute label="Concatenate the code of each segment with the code found in the inbound population" name="concatenateSegmentCode" type="boolean"/>
        <element aggregate="queryTarget" name="target"/>
        <attribute label="Primary set" name="mainSet" type="string"/>
        <element doesNotSupportDiff="true" label="Extension data" name="extension" type="ANY" xml="true"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
        </element>
        <element name="transitions">
          <element name="extractOutput" ordered="true" ref="extractOutput" unbound="true">
            <translatedDefault>&lt;extractOutput enabled="true" label="Subset" name="extractOutput" &gt;
             &lt;limiter type="percent" percent="10"/&gt;
          &lt;/extractOutput&gt;</translatedDefault>
          </element>
          <element name="done" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="false" label="Generate all sub-sets in the same table" name="enabled"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" desc="Generate complementary set (contains all remaining records)" label="Generate complement" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="0" label="Comparison type" name="compType">
        <value label="The smallest value" name="0"/>
        <value label="The largest value" name="1"/>
      </enumeration>
      <enumeration basetype="byte" default="0" label="Comparison type" name="orderType">
        <value label="Indifferent" name="0"/>
        <value label="The smallest value" name="1"/>
        <value label="The largest value" name="2"/>
      </enumeration>
      <element img="nms:activities/dedup.png" label="Deduplication" name="dedup" template="xtk:workflow:activity">
        <attribute default="'nms:activities/dedup.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="false" label="Disable automatic filtering of 0 ID records" name="noAutoPkFilter" type="boolean"/>
        <attribute enum="dedupType" label="Method" name="type" type="string"/>
        <element aggregate="queryTarget" name="target"/>
        <element label="List of groupings" name="groupExpr" ordered="true" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Label" name="label" type="string"/>
        </element>
        <element label="Ordering values" name="orderedValue" ordered="true" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Label" localizable="true" name="label" type="string"/>
          <attribute enum="orderType" label="Comparison used for other values" name="orderType" type="byte"/>
          <element label="Values" name="value" ordered="true" unbound="true">
            <attribute label="Value" name="value" type="string"/>
          </element>
        </element>
        <attribute label="Expression" name="expr" type="string"/>
        <attribute default="1" label="Number of doubles to keep" name="number" type="short"/>
        <attribute enum="compType" label="Comparison type on an expression" name="compType" type="byte"/>
        <element label="Query" localizable="true" name="display" type="string"/>
        <attribute label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute label="Group data by targeting dimension element" name="groupBy" type="boolean"/>
        <attribute default="true" label="Keep all additional data from the source" name="keepAllExtraData" type="boolean"/>
        <attribute default="true" label="Keep deduplicated record in the list of duplicates" name="includeMainInDuplicates" type="boolean"/>
        <attribute default="false" label="Save the rank of each record in an additional column" name="keepRank" type="boolean"/>
        <attribute default="false" label="Merge records" name="merge" type="boolean"/>
        <attribute default="false" label="Use several record merging criteria" name="multipleMergeCriteria" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Group aggregates based on the values in the sort columns" name="useOrderByValuesAsRank" type="boolean"/>
          <attribute label="The collection represents an N-N link" name="NtoNDedup" type="boolean"/>
          <attribute label="Merge records" name="merge" type="boolean"/>
          <attribute label="Filter condition" name="humanCond" type="string"/>
        </element>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" desc="Generate the complementary set (all duplicates are stored in a second set)" label="Generate complement" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/group.png" label="List update" name="saveGroup" template="xtk:workflow:activity">
        <attribute default="'nms:activities/group.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element label="List to create/update" name="savedGroup">
          <attribute default="true" desc="Saves the date in a list with its own table, which makes it possible to keep the additional data." label="Create or use a list with its own table" name="dedicatedTable" type="boolean"/>
          <element label="List" name="group" target="nms:group" type="link"/>
          <attribute label="Compute string of the 'List' link" name="group-cs" type="string"/>
          <attribute default="false" desc="The full name of the folder of the list is calculated" label="Calculated folder" name="computeFolder" type="boolean"/>
          <element edit="JstEdit" label="Scripted folder" name="folderScript" type="CDATA"/>
          <attribute label="Select list" name="computeName" type="boolean"/>
          <element desc="Label computation script" edit="JstEdit" label="Calculation script" name="script" type="CDATA"/>
          <attribute default="true" label="Purge and re-use the list if it exists (otherwise add to the list)" name="recycle" type="boolean"/>
          <element label="Folder" name="folder" target="xtk:folder" type="link"/>
          <attribute label="Compute string of the 'Folder' link" name="folder-cs" type="string"/>
          <attribute applicableIf="HasPackage('nms:federatedDataAccess')" desc="Database used for storage" label="Database type" name="dataSourceTarget" type="byte"/>
          <element applicableIf="HasPackage('nms:federatedDataAccess')" label="Database" name="dataSource" target="nms:extAccount" type="link"/>
        </element>
        <element name="transitions">
          <element label="Result" name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <element img="nms:activities/prefill.png" label="Read list" name="readGroup" template="xtk:workflow:activity">
        <attribute default="'nms:activities/prefill.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute desc="Document type to which the split applies" label="Document type" name="schema" type="string"/>
        <element doesNotSupportDiff="true" label="Extension data" name="extension" type="ANY" xml="true"/>
        <element label="Recipient group" name="readGroup">
          <attribute default="false" desc="The list label is calculated" label="Computed label" name="computeName" type="boolean"/>
          <element edit="JstEdit" label="Scripted label" name="script" type="CDATA"/>
          <attribute default="false" desc="The full name of the folder of the list is calculated" label="Calculated folder" name="computeFolder" type="boolean"/>
          <element edit="JstEdit" label="Scripted folder" name="folderScript" type="CDATA"/>
          <element label="List" name="group" target="nms:group" type="link"/>
          <attribute label="Compute string of the 'List' link" name="group-cs" type="string"/>
          <element label="Folder" name="folder" target="xtk:folder" type="link"/>
          <attribute label="Compute string of the 'Folder' link" name="folder-cs" type="string"/>
        </element>
        <element label="Condition" name="where" ref="xtk:queryDef:where" unbound="false"/>
        <element label="Filter" localizable="true" name="humanCond" type="string"/>
        <element name="transitions">
          <element label="Result" name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="true" name="enabled"/>
          </element>
        </element>
      </element>
      <element applicableIf="HasPackage('nms:survey')" desc="Read survey responses" img="nms:activities/survey.png" label="Survey responses" name="readSurvey" template="xtk:workflow:activity">
        <attribute default="'nms:activities/survey.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="'nms:wkfSurvey.js'" name="library"/>
        <attribute default="true" name="andJoin" type="boolean"/>
        <attribute default="false" name="distributable" type="boolean"/>
        <attribute default="true" name="shouldSync" type="boolean"/>
        <attribute name="targetSchema" ref="xtk:workflow:queryTarget/@schema"/>
        <element doesNotSupportDiff="true" label="Extension data" name="extension" type="ANY" xml="true">
          <attribute default="true" label="No source" name="noSource" type="boolean"/>
        </element>
        <element label="Survey" name="survey" target="nms:webApp" type="link"/>
        <attribute label="Compute string for link 'Survey'" name="survey-cs" type="string"/>
        <attribute label="Select all answer data" name="keepAllExtraData" type="boolean"/>
        <attribute label="Remove duplicate rows (DISTINCT)" name="distinct" type="boolean"/>
        <attribute label="Group data by targeting dimension element" name="groupBy" type="boolean"/>
        <element name="select" ref="xtk:queryDef:select"/>
        <element desc="Collection links filtering condition" name="conditionLink" template="xtk:queryDef:conditionLink" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
        </element>
        <element label="Condition" name="where" ref="xtk:queryDef:where" unbound="false"/>
        <element label="Filter" localizable="true" name="humanCond" type="string"/>
        <element name="transitions">
          <element label="Result" name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="true" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="byte" default="1" name="subscribeType">
        <value label="Subscribe" name="1"/>
        <value label="Unsubscription" name="0"/>
      </enumeration>
      <element img="nms:activities/setService.png" label="Subscription Services" name="setOfService" template="xtk:workflow:activity">
        <attribute default="'nms:activities/setService.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute default="false" label="Send a confirmation message" name="sendConfirmation" type="boolean"/>
        <attribute enum="subscribeType" label="Operation type" name="subscribeType" type="byte"/>
        <element label="Service" name="service" target="nms:service" type="link"/>
        <attribute label="Compute string for the 'service' link" name="service-cs" type="string"/>
        <element name="transitions">
          <element label="Result" name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
      </element>
      <enumeration basetype="string" default="insertOrUpdate" name="operationType">
        <value label="Insert or update" name="insertOrUpdate"/>
        <value label="Insert" name="insert"/>
        <value label="Update" name="update"/>
        <value label="Update and merge collections" name="merge"/>
        <value label="Delete" name="delete"/>
      </enumeration>
      <enumeration basetype="string" default="insertOrUpdate" name="mergeType">
        <value label="Insert or update" name="insertOrUpdate"/>
        <value label="Insert" name="insert"/>
        <value label="Update" name="update"/>
        <value label="Replace" name="replace"/>
      </enumeration>
      <enumeration basetype="string" default="all" name="enabledOperation">
        <value label="All" name="all"/>
        <value label="Insert" name="insert"/>
        <value label="Update" name="update"/>
      </enumeration>
      <element img="nms:activities/writer.png" label="Update data" name="writer" template="xtk:workflow:activity">
        <attribute default="'nms:activities/writer.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute enum="operationType" label="Operation type" name="operationType" type="string"/>
        <attribute advanced="true" default="10000" desc="Batch size when updating the destination" label="Batch size" name="transactionSize" type="long"/>
        <attribute default="100" desc="Maximum number of erroneous lines before timeout" label="Number of errors" name="maxErrorCount" type="long"/>
        <attribute label="Updated dimension" name="schema" ref="xtk:workflow:queryTarget/@schema"/>
        <attribute desc="Disable the audit information management (update, create)" label="Disable audit" name="noAudit" type="boolean"/>
        <attribute label="Disable automatic key management" name="noAutoPK" type="boolean"/>
        <attribute default="true" label="Empty the destination value if the source value is empty (NULL)" name="noPreservation" type="boolean"/>
        <attribute label="Ignore records which concern the same target." name="ignoreDuplicates" type="boolean"/>
        <element label="Expression for specifying the duplicate processing order" name="orderedExpr" ordered="true" unbound="true">
          <attribute label="Expression" name="expr" type="string"/>
          <attribute label="Descending order" name="desc" type="boolean"/>
        </element>
        <attribute label="Update all columns with matching names" name="updateAllColumns" type="boolean"/>
        <attribute label="Do not update links" name="noUpdateLinks" type="boolean"/>
        <attribute desc="Limit the records included" label="Taken into account if" name="enabledIf" type="string"/>
        <element name="primaryKeyNode" ordered="true" ref="xtk:workflow:writer/node" unbound="true"/>
        <element name="node" ordered="true" unbound="true">
          <attribute label="Destination" name="dstExpr" type="string"/>
          <attribute label="Source expression" name="calcExpr" type="string"/>
          <attribute label="Value" localizable="true" name="valueLabel" type="string"/>
          <attribute label="Taken into account if" name="enabledIf" type="string"/>
          <attribute enum="enabledOperation" label="Operation" name="enabledOperation" type="string"/>
          <attribute label="Type" name="operationType" type="string"/>
          <attribute label="Deletion in case of replacement" name="replacedIf" type="string"/>
          <attribute label="Moved if no record exists. Target records are identified based on dimension uniqueness criteria" name="onlyIfNotExists" type="boolean"/>
          <element name="primaryKeyNode" ordered="true" ref="xtk:workflow:writer/node" unbound="true"/>
          <element name="node" ordered="true" ref="xtk:workflow:writer/node" unbound="true"/>
        </element>
        <element name="transitions">
          <element name="done" template="xtk:workflow:transition">
            <attribute default="false" name="enabled"/>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Rejects'"/>
            <attribute default="false" name="enabled"/>
          </element>
        </element>
        <attribute label="Do not retrieve the target population" name="ignoreTarget" type="boolean"/>
      </element>
      <enumeration basetype="byte" default="new" name="contentSel">
        <value label="Specified by the event" name="event" value="0"/>
        <value label="Explicit" name="explicit" value="1"/>
        <value label="Computed by a script" name="script" value="2"/>
        <value label="New, created from a publication template" name="new" value="3"/>
      </enumeration>
      <enumeration basetype="byte" default="save" name="actionContentType">
        <value label="Save" name="save" value="0"/>
        <value label="Generate" name="generate" value="1"/>
      </enumeration>
      <element applicableIf="HasPackage('ncm:content')" img="nms:activities/content.png" label="Content Management" name="content" template="xtk:workflow:activity">
        <attribute default="'nms:activities/content.png'" name="img"/>
        <attribute desc="Specify the content to work on" enum="contentSel" label="Content" name="contentSel" type="byte"/>
        <attribute desc="Type of action to perform on the content" enum="actionContentType" label="Action type" name="actionType" type="byte"/>
        <element desc="Script used to computed the delivery identifier" label="Script" name="contentIdScript" type="CDATA"/>
        <attribute desc="Delivery subject" label="Subject" name="subject" type="string" xml="true"/>
        <attribute default="GetOption('NcmPublishingDir')" label="Publication folder" name="publishingDir" type="string" xml="true"/>
        <element desc="Associated channel" label="Channel" name="channel" revIntegrity="define" target="ncm:channel" type="link"/>
        <element desc="Publication template" label="Template" name="publishing" revIntegrity="define" target="ncm:publishing" type="link"/>
        <element label="Content" name="content" target="ncm:content" type="link"/>
        <attribute label="Update using an XML feed" name="activeTransform" type="boolean"/>
        <attribute desc="URL to access XML data" label="URL" name="url" type="string"/>
        <element label="XSL style sheet" name="xslt" target="xtk:xslt" type="link"/>
        <element name="transitions">
          <element name="done" ref="xtk:workflow:transition"/>
        </element>
      </element>
      <element applicableIf="HasPackage('nms:predictive')" img="nms:activities/predictive-extract.png" label="Predictive split" name="predictiveExtract" template="xtk:workflow:activity">
        <attribute default="'nms:activities/predictive-extract.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <element aggregate="queryTarget" name="target"/>
        <element name="transitions">
          <element name="extractOutput" ordered="true" template="extractOutput" unbound="true">
            <element name="limiter">
              <element label="Predictive model" name="predictiveModel" target="nms:predictiveModel" type="link"/>
              <attribute label="Use a predictive model" name="predictive" type="boolean"/>
              <attribute enum="limiterPredictiveType" label="Type of limit" name="limiterPredictiveType" type="string"/>
              <attribute label="Unit cost" name="unitDeliveryCost" type="double"/>
              <attribute label="Transaction profit" name="unitTransactionProfit" type="double"/>
              <attribute label="Budget" name="deliveryBudget" type="double"/>
            </element>
          </element>
          <element name="remainder" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Complement'"/>
            <attribute default="false" desc="Generate complementary set (contains all remaining records)" label="Generate complement" name="enabled"/>
          </element>
        </element>
      </element>
      <element applicableIf="HasPackage('nms:interaction')" img="nms:activities/offerSelection.png" label="Offer engine" name="offerSelection" template="xtk:workflow:activity">
        <attribute default="'nms:activities/offerSelection.png'" name="img"/>
        <attribute default="true" name="runOnSimulation"/>
        <attribute desc="Comma-separated list of selected themes." label="Themes" name="offerThemes" type="string"/>
        <attribute default="1" label="Number of propositions to calculate" name="maxPropositionCount" type="long"/>
        <attribute default="GetDate()" label="Contact date" name="contactDate" type="datetime"/>
        <element label="Offer space" name="offerSpace" target="nms:offerSpace" type="link"/>
        <element label="Offer category" name="offerCategory" target="nms:offerCategory" type="link"/>
        <element name="transitions">
          <element name="result" template="nms:workflow:result">
            <attribute name="label" translatedDefault="'Result'"/>
          </element>
        </element>
      </element>
      <element name="workflow">
        <element default="DefaultInstance('notifySupervisor')" desc="Template used to notify supervisor of error" label="Template" name="scenario" target="nms:delivery" type="link" xml="true"/>
        <element applicableIf="HasPackage('nms:campaign')" defOnDuplicate="true" label="Campaign" name="operation" revIntegrity="owncopy" revLink="workflow" target="nms:operation" type="link"/>
        <element applicableIf="HasPackage('nms:campaign')" name="process">
          <attribute advanced="true" defOnDuplicate="true" enum="startState" label="Start status" name="startState" type="byte"/>
          <attribute advanced="true" desc="Workflow execution status" enum="processState" expr="iif(@startState=1 and @forecasted=false and ([../@state]=0 or [../@state]=20), 1, iif (@startState=1 and @forecasted=true and ([../@state]=0 or [../@state]=20), 2, [../@state]))" label="Execution status" name="processState" type="byte"/>
          <element aggregate="nms:workflow:execution"/>
        </element>
        <attribute advanced="true" applicableIf="HasPackage('nms:campaign')" desc="Workflow scheduling in the campaign" label="Order" name="order" type="long"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:campaign')" desc="Expiration date for starting scheduled (deferred) workflows" label="Expiration date" name="expiration" type="datetime"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:campaign')" label="Recurring workflow template" name="recurrentMdl" type="boolean"/>
        <attribute advanced="true" applicableIf="HasPackage('nms:centralLocal')" label="Current order" name="currentOrderId" type="long"/>
        <element advanced="true" applicableIf="HasPackage('nms:campaign')" defOnDuplicate="true" label="Routing campaign" name="routingOperation" revIntegrity="own" revLabel="Post-processing to the router" revLink="routingPostProcess" target="nms:operation" type="link"/>
        <element defOnDuplicate="true" label="Aggregate" name="aggregate" revIntegrity="owncopy" revLink="workflow" target="xtk:olapAggregate" type="link"/>
        <element name="activities">
          <element name="nlmodule" ref="nlmodule" unbound="true"/>
          <element name="validation" ref="validation" unbound="true"/>
          <element name="alert" ref="alert" unbound="true"/>
          <element name="notification" ref="notification" unbound="true"/>
          <element name="delivery" ref="delivery" unbound="true"/>
          <element name="deliveryEmail" ref="deliveryEmail" unbound="true"/>
          <element applicableIf="HasPackage('nms:paper')" name="deliveryPaper" ref="deliveryPaper" unbound="true"/>
          <element applicableIf="HasPackage('nms:mobile')" name="deliveryMobile" ref="deliveryMobile" unbound="true"/>
          <element applicableIf="HasPackage('nms:phone')" name="deliveryPhone" ref="deliveryPhone" unbound="true"/>
          <element applicableIf="HasPackage('nms:fax')" name="deliveryFax" ref="deliveryFax" unbound="true"/>
          <element applicableIf="HasPackage('nms:centralLocal')" name="deliveryAgency" ref="deliveryAgency" unbound="true"/>
          <element name="deliveryOperation" ref="deliveryOperation" unbound="true"/>
          <element name="deliveryOther" ref="deliveryOther" unbound="true"/>
          <element name="deliveryRecurring" ref="deliveryRecurring" unbound="true"/>
          <element name="controlDelivery" ref="controlDelivery" unbound="true"/>
          <element applicableIf="HasPackage('nms:centralLocal')" name="localValidation" ref="localValidation" unbound="true"/>
          <element applicableIf="HasPackage('ncm:content')" name="content" ref="content" unbound="true"/>
          <element applicableIf="HasPackage('nms:campaign')" name="deliveryOutline" ref="deliveryOutline" unbound="true"/>
          <element applicableIf="HasPackage('nms:mrm')" name="task" ref="task" unbound="true"/>
          <element name="incremental" ref="incremental" unbound="true"/>
          <element name="query" ref="query" unbound="true"/>
          <element name="readGroup" ref="readGroup" unbound="true"/>
          <element applicableIf="HasPackage('nms:survey')" name="readSurvey" ref="readSurvey" unbound="true"/>
          <element name="enrich" ref="enrich" unbound="true"/>
          <element name="schemaEdit" ref="schemaEdit" unbound="true"/>
          <element name="union" ref="union" unbound="true"/>
          <element name="intersection" ref="intersection" unbound="true"/>
          <element name="exclusion" ref="exclusion" unbound="true"/>
          <element name="extract" ref="extract" unbound="true"/>
          <element applicableIf="HasPackage('nms:predictive')" name="predictiveExtract" ref="predictiveExtract" unbound="true"/>
          <element name="dedup" ref="dedup" unbound="true"/>
          <element name="changeAxis" ref="changeAxis" unbound="true"/>
          <element name="saveGroup" ref="saveGroup" unbound="true"/>
          <element applicableIf="HasPackage('nms:interaction')" name="offerSelection" ref="offerSelection" unbound="true"/>
          <element name="fileExport" ref="fileExport" unbound="true"/>
          <element name="setOfService" ref="setOfService" unbound="true"/>
          <element name="writer" ref="writer" unbound="true"/>
          <element name="fileTransfer" ref="fileTransfer" unbound="true"/>
          <element applicableIf="HasPackage('nms:aamIntegration')" name="exportToAAM" ref="exportToAAM" unbound="true"/>
          <element name="httpTransfer" ref="httpTransfer" unbound="true"/>
          <element name="inmail" ref="inmail" unbound="true"/>
          <element name="inSms" ref="inSms" unbound="true"/>
          <element applicableIf="HasPackage('nms:federatedDataAccess') OR HasPackage('nms:midEmitter') OR HasPackage('nms:messageCenterControl')" name="dbImport" ref="dbImport" unbound="true"/>
          <element applicableIf="HasPackage('nms:federatedDataAccess') OR HasPackage('nms:messageCenterControl')" name="soapImport" ref="soapImport" unbound="true"/>
          <element name="fileImport" ref="fileImport" unbound="true"/>
        </element>
      </element>
      <methods>
        <method library="nms:wkfSurvey.js" name="readSurveySchema" static="true">
          <parameters>
            <param desc="Current activity" inout="in" name="activity" type="DOMElement"/>
            <param desc="Enriched activity." inout="out" name="enrichedActivity" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:federatedDataAccess.js" name="describeWSDL" static="true">
          <parameters>
            <param desc="URL of the WSDL" inout="in" name="wdslURL" type="string"/>
            <param desc="Description of available calls." inout="out" name="simplifiedDescription" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:federatedDataAccess.js" name="generateSOAPCode" static="true">
          <parameters>
            <param desc="Selected API" inout="in" name="apiCallDescription" type="DOMElement"/>
            <param desc="Call prototype." inout="out" name="apiCalls" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" implements="xtk:persist" label="Form responses" labelSingular="Form response" library="true" name="webAppLog" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="true" img="nms:webtracking.png" label="Form responses" labelSingular="Form response" name="webAppLog" pkgStatus="never">
        <dbindex name="date">
          <keyfield xpath="@webApp-id"/>
          <keyfield xpath="@logDate"/>
        </dbindex>
        <element integrity="normal" label="Application" name="webApp" noDbIndex="true" revIntegrity="normal" revLabel="Form responses" target="nms:webApp" type="link"/>
        <attribute dbEnum="dictionaryLocale" desc="Language in which the application was presented." label="Language" length="12" name="language" type="string"/>
        <attribute default="GetDate()" desc="Log creation date" label="Date" name="logDate" type="datetime"/>
        <attribute desc="Origin of log (affiate)" label="Origin" length="80" name="origin" type="string"/>
        <attribute desc="Global score of the survey." label="Score" name="score" type="double"/>
        <attribute desc="Create respondent in the database" label="Creation" name="creation" type="boolean"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" implements="xtk:persist" label="Responses to recipient forms" labelSingular="Response to a recipient form" name="webAppLogRcp" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="webAppLogRcp" pkgStatus="never" template="nms:webAppLog">
        <element name="webApp" revLabel="Recipient form responses"/>
        <element label="Recipient" name="recipient" revLink="webAppLog" target="nms:recipient" type="link"/>
        <element label="Delivery" name="delivery" revLink="webAppLog" target="nms:delivery" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Email errors by path" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Email errors" labelSingular="Email error" name="emailError" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" name="connectionCode">
        <value label="OK" name="ok" value="0"/>
        <value label="Connection failure" name="failed" value="1"/>
        <value label="Timeout" name="timeout" value="2"/>
        <value label="Connection refused" name="refused" value="3"/>
        <value label="Unexpected end of session" name="aborted" value="4"/>
      </enumeration>
      <element name="emailError" pkgStatus="never">
        <key name="path">
          <keyfield xpath="@MXIP"/>
          <keyfield xpath="@publicId"/>
        </key>
        <attribute desc="Remote MX IP" label="MX IP" length="39" name="MXIP" type="string"/>
        <attribute desc="Outbound IP identifier" label="IP identifier" name="publicId" type="long"/>
        <attribute desc="Status of the last connection with errors" enum="connectionCode" label="Last status" name="lastConnectionCode" type="byte"/>
        <attribute desc="SMTP code of last connection with errors" label="Last code" name="lastReplyCode" type="long"/>
        <attribute desc="Response text of the last connection with errors" label="Last message" length="512" name="lastReplyMessage" type="string"/>
        <attribute desc="Last error date" label="Last error date" name="lastDate" type="datetime"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Email error counters" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="Email error counters" labelSingular="Email error counters" name="emailErrorStat" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="emailErrorStat" pkgStatus="never">
        <dbindex name="date">
          <keyfield xpath="@date"/>
        </dbindex>
        <dbindex name="mxip">
          <keyfield xpath="@MXIP"/>
        </dbindex>
        <attribute desc="Remote MX IP" label="MX IP" length="39" name="MXIP" type="string"/>
        <attribute desc="Outbound IP identifier" label="IP identifier" name="publicId" type="long"/>
        <attribute desc="Counter date" label="Date" name="date" type="datetime"/>
        <attribute desc="Total number of messages sent" label="Sent" name="sentMessages" type="long"/>
        <attribute desc="Total number of connections" label="Connections" name="totalConnections" type="long"/>
        <attribute desc="Total error count" label="Errors" name="totalErrors" type="long"/>
        <attribute desc="Number of expired connections" label="Expirations" name="timeoutConnections" type="long"/>
        <attribute desc="Number of refused connections" label="Refused" name="refusedConnections" type="long"/>
        <attribute desc="Number of abandoned connections" label="Abandoned" name="abortedConnections" type="long"/>
        <attribute desc="Number of failed connections" label="Failures" name="failedConnections" type="long"/>
        <attribute desc="Message error count" label="Messages" name="messageErrors" type="long"/>
        <attribute desc="Number of messages" label="Hits" name="hitCount" type="long"/>
        <element label="Error" name="error" revIntegrity="own" revLabel="Counters" revLink="lines" target="nms:emailError" type="link">
          <join xpath-dst="@MXIP" xpath-src="@MXIP"/>
          <join xpath-dst="@publicId" xpath-src="@publicId"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Associations between MX and domains" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="MXs" labelSingular="MX" name="mxDomain" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="mxDomain" pkgStatus="never">
        <key name="path">
          <keyfield xpath="@MXIP"/>
          <keyfield xpath="@domain"/>
        </key>
        <attribute label="MX IP" length="39" name="MXIP" type="string"/>
        <attribute label="MX name" length="80" name="MX" type="string"/>
        <attribute label="Domain name" length="80" name="domain" type="string"/>
        <attribute advanced="true" desc="Number of hits" label="Hits" name="hitCount" type="long"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="MX mappings and owners" entitySchema="xtk:srcSchema" genAccessors="false" implements="xtk:persist" label="MX owners" labelSingular="MX owner" name="mxOwner" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="mxOwner">
        <key name="ip">
          <keyfield xpath="@MXIP"/>
        </key>
        <attribute label="MX IP" length="39" name="MXIP" type="string"/>
        <attribute label="Owner name" length="80" name="owner" type="string"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Organizational entity for accessing the application" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:localOrgUnit.png" implements="xtk:persist" label="Organizational entities" labelSingular="Organizational entity" name="localOrgUnit" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="true" folderLink="folder" folderModel="nmsLocalOrgUnit" fullLoad="true" img="nms:localOrgUnit.png" label="Organizational entity" name="localOrgUnit" pkgAdmin="@id != 0">
        <compute-string expr="@label+ ' (' + @name + ')'"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'OU'+CounterValue('nmsLocalOrgUnit')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <attribute name="phone" template="nms:common:phone"/>
        <attribute name="fax" template="nms:common:fax"/>
        <attribute name="email" template="xtk:common:email"/>
        <attribute name="url" template="nms:common:url"/>
        <element aggregate="nms:common:locationAggregate" name="location"/>
        <element externalJoin="true" label="Country" name="country" revIntegrity="normal" revLink="localOrgUnit" target="nms:country" type="link">
          <join xpath-dst="@isoA2" xpath-src="location/@countryCode"/>
        </element>
        <attribute dbEnum="orgUnitNature" desc="Nature of the entity" label="Nature" length="64" name="nature" type="string"/>
        <element label="Comment" name="comment" template="xtk:common:comment"/>
        <element applicableIf="HasPackage('nms:centralLocal')" label="Notification group" name="group" revIntegrity="define" target="xtk:group" type="link"/>
        <element applicableIf="HasPackage('nms:campaign')" label="Approval" name="orderValidation" ref="xtk:operator:operatorAssignee"/>
        <element applicableIf="HasPackage('nms:centralLocal')" label="Campaign reviewers" name="operationValidation" revIntegrity="define" target="xtk:group" type="link"/>
        <element label="Parent entity" name="parent" revIntegrity="define" revLabel="Linked entities" target="nms:localOrgUnit" type="link"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsLocalOrgUnit', [@_folder-id])" label="Folder" name="folder" required="true" revIntegrity="define" revLabel="Contained organizational entities" revLink="containedOrgUnits" target="xtk:folder" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Aggregates for cost and turnover analysis" entitySchema="xtk:srcSchema" genAccessors="false" img="nms:budget.png" implements="xtk:persist" label="Delivery aggregates" labelSingular="Delivery aggregate" library="true" name="dlvAggregate" namespace="nms" xtkschema="xtk:srcSchema">
      <element advanced="false" label="Delivery aggregates" name="dlvAggregate" pkgStatus="never" sqltable="NmsdlvAggregate">
        <dbindex>
          <keyfield xpath="@delivery-id"/>
        </dbindex>
        <attribute label="Calculated with Response Manager" name="hasResponse" sqlname="bHasResponse" type="boolean"/>
        <attribute label="Estimated responding population" name="simuResponse" sqlname="dSimuResponse" type="double"/>
        <attribute label="Estimated revenue" name="simuRevenue" sqlname="dSimuRevenue" type="double"/>
        <attribute label="Estimated margin" name="simuMargin" sqlname="dSimuMargin" type="double"/>
        <attribute label="Responding population (response)" name="remaResponse" sqlname="dRemaResponse" type="double"/>
        <attribute label="Revenue (response)" name="remaRevenue" sqlname="dRemaRevenue" type="double"/>
        <attribute label="Margin (response)" name="remaMargin" sqlname="dRemaMargin" type="double"/>
        <attribute expr="Iif(@hasResponse=1, @remaResponse, @simuResponse)" label="Answering population" name="response" type="double"/>
        <attribute expr="Iif(@hasResponse=1, @remaRevenue, @simuRevenue)" label="Revenue" name="revenue" type="double"/>
        <attribute expr="Iif(@hasResponse=1, @remaMargin, @simuMargin)" label="Margin" name="margin" type="double"/>
        <attribute label="Target population" name="totalMsg" sqlname="iTotalMsg" type="long"/>
        <attribute label="Messages to send" name="toDeliver" sqlname="iToDeliver" type="long"/>
        <attribute label="Messages processed" name="processed" sqlname="iProcessed" type="long"/>
        <attribute label="Messages successfully processed" name="success" sqlname="iSuccess" type="long"/>
        <attribute advanced="true" label="Delivery ID" name="delivery-id" sqlname="iDeliveryId" type="long"/>
        <attribute advanced="true" label="Rule ID" name="rule-id" sqlname="iRuleId" type="long"/>
        <attribute advanced="true" defOnDuplicate="true" default="GetDate()" desc="Modification date" label="Modified on" name="lastModified" pkgStatus="always" sqlname="tsLastModified" type="datetime"/>
        <element externalJoin="false" label="Delivery" name="delivery" target="nms:delivery" type="link" unbound="false"/>
        <element label="Typology rule" name="rule" target="nms:typologyRule" type="link" unbound="false"/>
        <attribute enum="nms:broadLog:failureReason" label="Reason for the rejection" name="failureReason" sqlname="iFailureReason" type="byte"/>
        <attribute applicableIf="HasPackage('nms:campaign')" expr="Iif([delivery/properties/@toDeliver] > 0, @toDeliver * Iif([delivery/@state]>45, [delivery/budgetParameters/@realCost], [delivery/budgetParameters/@estimatedCost]) / [delivery/properties/@toDeliver], 0)" label="Cost" name="estimatedCost" type="double"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" label="Listening pointers of the Pipeline Services" labelSingular="Listening pointer of the Pipeline Services" name="pipelineOffset" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="pipelineOffset" pkgStatus="never">
        <key name="topicConsumerPartition">
          <keyfield xpath="@host"/>
          <keyfield xpath="@topic"/>
          <keyfield xpath="@consumer"/>
          <keyfield xpath="@partition"/>
        </key>
        <attribute label="Pipeline server" name="host" type="string"/>
        <attribute label="Kafka topic" name="topic" type="string"/>
        <attribute label="Consumer name" length="64" name="consumer" type="string"/>
        <attribute label="Partition" name="partition" type="long"/>
        <attribute label="Pointer" name="offset" type="int64"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" label="Events of ignored Pipeline Services" labelSingular="Event of ignored Pipeline Services" name="pipelineDiscard" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="false" name="pipelineDiscard" pkgStatus="never">
        <key name="idDiscard">
          <keyfield xpath="@host"/>
          <keyfield xpath="@topic"/>
          <keyfield xpath="@consumer"/>
          <keyfield xpath="@partition"/>
          <keyfield xpath="@offset"/>
          <keyfield xpath="@discardDate"/>
        </key>
        <attribute label="Pipeline server" name="host" type="string"/>
        <attribute label="Kafka topic" name="topic" type="string"/>
        <attribute label="Consumer name" length="64" name="consumer" type="string"/>
        <attribute label="Partition" name="partition" type="long"/>
        <attribute label="Pointer" name="offset" type="int64"/>
        <attribute label="Reject date" name="discardDate" type="datetime"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="nms:offerEnv.png" implements="xtk:persist" label="Marketing offers environment" labelSingular="Marketing offers environment" name="offerEnv" namespace="nms" xtkschema="xtk:srcSchema">
      <element desc="Filters on the target" label="Constraints" name="filter" xml="true">
        <attribute name="label" type="string"/>
        <attribute label="Targeting dimension" name="schema" pkgStatus="always" type="string"/>
        <attribute label="Link used" name="recipientLink" type="string"/>
        <element applicableIf="HasPackage('nms:interaction')" name="where" template="xtk:queryDef:where" unbound="true">
          <attribute expr="[../@schema]" label="Filtering schema" name="filteringSchema" pkgStatus="always" type="string"/>
        </element>
        <element applicableIf="HasPackage('nms:interaction')" label="Filter" name="humanCond" type="memo"/>
      </element>
      <element img="nms:offerEnv.png" name="offerEnv" pkgAdmin="@id != 0" template="xtk:folder">
        <compute-string expr="@label+' ('+@name+')'"/>
        <attribute default="GetOption('XtkInstancePrefix')+'OE'+CounterValue('nmsOfferEnv')" name="name"/>
        <attribute label="Live" name="live" type="boolean"/>
        <attribute default="1" label="Version" name="version" type="short" xml="true"/>
        <element label="Offer presentation typology" name="typology" target="nms:typology" type="link" xml="true"/>
        <element applicableIf="HasPackage('nms:interactionControl')" label="Execution instances" name="executionInstance" unbound="true" xml="true">
          <key name="key">
            <keyfield xlink="extAccount"/>
          </key>
          <element label="External account" name="extAccount" target="nms:extAccount" type="link"/>
          <attribute default="900" label="Frequency of updates" name="updateInterval" type="timespan"/>
          <attribute label="Filtering recipients" name="filterExpr" type="string"/>
          <attribute default="true" label="Active" name="active" type="boolean"/>
        </element>
        <element name="filter" pkgStatus="always" template="filter">
          <attribute default="getOption('Nms_DefaultRcpSchema')" label="Targeting dimension" name="schema" type="string"/>
        </element>
        <element advanced="true" applicableIf="HasPackage('nms:interaction')" label="Target mapping" name="deliveryMapping" revIntegrity="define" target="nms:deliveryMapping" type="link"/>
        <element label="Live environment" name="prodEnv" revIntegrity="define" target="nms:offerEnv" type="link"/>
        <attribute desc="Storage dimension for propositions" label="Storage dimension" name="propositionSchema" type="string" xml="true"/>
        <attribute default="'nms:interaction'" label="Call data schema" length="64" name="inputSchema" type="string"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Environment dedicated to incoming anonymous interactions" label="Anonymous environment" name="anonymous" type="boolean"/>
        <element applicableIf="HasPackage('nms:interaction')" defOnDuplicate="true" default="DefaultFolder('nmsVisitor', [@_visitorFolder-id])" label="Visitor folder" name="visitorFolder" target="xtk:folder" type="link"/>
        <element label="Example of call data" name="sampleCallData" unbound="true" xml="true">
          <key internal="true" name="name">
            <keyfield xpath="@name"/>
          </key>
          <attribute name="name" template="xtk:common:name"/>
          <attribute name="label" template="xtk:common:label"/>
          <element label="Call data" name="callData" type="ANY"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="nms:offerCategory.png" implements="xtk:persist" label="Marketing offer categories" labelSingular="Marketing offer category" name="offerCategory" namespace="nms" xtkschema="xtk:srcSchema">
      <element autopk="true" img="nms:offerCategory.png" name="offerCategory" template="xtk:folder">
        <compute-string expr="@label"/>
        <attribute default="GetOption('XtkInstancePrefix')+'OC'+CounterValue('nmsOfferCategory')" name="name"/>
        <element label="Environment" name="env" revIntegrity="neutral" revLabel="Categories" revLink="offerCategory" target="nms:offerEnv" type="link"/>
        <attribute default="GetOfferEnv([@parent-id])" name="env-id"/>
        <attribute defOnDuplicate="true" label="Production deployment date" name="productionDate" type="datetime"/>
        <attribute expr="iif (@productionDate='' or SecondsDiff(@productionDate, @lastModified)!=0, 1, 0)" label="Design" name="edition" type="boolean"/>
        <attribute default="0" label="To deploy" name="goLive" type="boolean"/>
        <attribute default="1" desc="Category active" label="Enabled" name="active" pkgStatus="always" type="boolean" xml="true"/>
        <attribute applicableIf="HasPackage('nms:interaction')" default="1" label="Multiplier weight" name="weight" type="double" xml="true"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Validity start date of the multiplier weight" label="Multiplier start date" name="weightStartDate" pkgStatus="always" type="datetime"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Validity end date of the multiplier weight" label="Multiplier end date" name="weightEndDate" pkgStatus="always" type="datetime"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Validity start date for offers in the category" label="Start date" name="startDate" pkgStatus="always" type="datetime" xml="true"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Validity end date for offers in the category" label="End date" name="endDate" pkgStatus="always" type="datetime" xml="true"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="This category is always included in the recommendations" label="Default categories" name="alwaysEligible" pkgStatus="always" type="boolean" xml="true"/>
        <attribute desc="Comma-separated list of offer themes." label="Themes" length="64" name="offerThemes" type="string" xml="true"/>
        <element name="filter" pkgStatus="always" template="nms:offerEnv:filter">
          <attribute expr="[../env/filter/@schema]" name="schema"/>
        </element>
        <element desc="Parent category" label="Parent" name="parent" revLink="folder" target="nms:offerCategory" type="link">
          <join xpath-dst="@id" xpath-src="@parent-id"/>
        </element>
      </element>
      <methods async="true">
        <method library="nms:interaction.js" name="GetAccessInfo" static="true">
          <parameters>
            <param desc="Category ID" inout="in" name="categoryId" type="long"/>
            <param desc="Specifies whether or not the category offers are anonymous" inout="out" name="anonymous" type="boolean"/>
            <param desc="Specifies whether or not the parent category offers are anonymous" inout="out" name="parentAnonymous" type="boolean"/>
          </parameters>
        </method>
        <method library="nms:interaction.js" name="Deploy" static="true">
          <parameters>
            <param desc="Filtering condition defining the categories to copy" inout="in" name="offerCategoryFilter" type="DOMElement"/>
            <param desc="Identifier of the destination environment" inout="in" name="offerEnv" type="long"/>
          </parameters>
        </method>
        <method library="nms:interaction.js" name="GoLive" static="true">
          <parameters>
            <param desc="Category ID" inout="in" name="categoryId" type="long"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema desc="Space for offer propositions" entitySchema="xtk:srcSchema" img="nms:offerSpace.png" implements="xtk:persist" label="Offer spaces" labelSingular="Offer space" name="offerSpace" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration name="channel" template="nms:delivery:messageType">
        <value desc="Web channel" enabledIf="HasPackage('nms:interaction')" img="nms:world.png" label="Inbound Web" name="web" value="50"/>
        <value desc="Call Center channel" enabledIf="HasPackage('nms:interaction')" img="nms:phone.png" label="Inbound call center" name="callCenter" value="51"/>
      </enumeration>
      <element name="formula" xml="true">
        <key internal="true" name="xpath">
          <keyfield xpath="@xpath"/>
        </key>
        <attribute label="Destination" name="xpath" type="string"/>
        <attribute label="Expression" name="expr" type="string"/>
      </element>
      <element autopk="true" enumImage="@channel" folderLink="folder" folderModel="nmsOfferSpace" fullLoad="true" img="nms:offerSpace.png" name="offerSpace" pkgAdmin="@id != 0">
        <compute-string expr="@label + ' (' + [env/@label] + ')'"/>
        <key name="name">
          <keyfield xlink="env"/>
          <keyfield xpath="@name"/>
        </key>
        <element label="Environment" name="env" revIntegrity="neutral" revLabel="Offer spaces" revLink="space" target="nms:offerEnv" type="link"/>
        <attribute default="GetOfferEnv([@folder-id])" name="env-id"/>
        <attribute default="GetOption('XtkInstancePrefix')+'SPC'+CounterValue('nmsOfferSpace')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="desc" template="xtk:common:desc" xml="true"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <attribute defOnDuplicate="true" label="Deployment date" name="deploymentDate" pkgStatus="never" type="datetime"/>
        <attribute expr="iif (@deploymentDate='' or SecondsDiff(@deploymentDate, @lastModified)!=0, 1, 0)" label="Design" name="edition" type="boolean"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsOfferSpace', [@_folder-id])" label="Folder" name="folder" required="true" revIntegrity="define" revLabel="Offer spaces" target="xtk:folder" type="link"/>
        <attribute enum="channel" label="Channel" name="channel" type="byte"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Enable unitary mode" label="Enable unitary mode" name="unitary" type="boolean"/>
        <element applicableIf="HasPackage('nms:interaction')" default="GetOfferEnv([@folder-id])" label="Default category" name="defaultCategory" revLink="_NONE_" target="nms:offerCategory" type="link"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Default offer themes, separated by commas." label="Default themes" length="64" name="defaultThemes" type="string" xml="true"/>
        <attribute desc="Default proposition status" enum="nms:common:propositionStatus" label="Default status" name="defaultStatus" type="byte"/>
        <attribute desc="Default value of the proposition status when accepted" enum="nms:common:propositionStatus" label="Default value of the status when accepted" name="defaultUpdateStatus" type="byte"/>
        <element label="Information to store when proposition is made" name="propositionFormula" template="formula" unbound="true" xml="true"/>
        <element label="Information to store when acceptance is made" name="acceptanceFormula" template="formula" unbound="true" xml="true"/>
        <element label="Content fields" name="representationFields" ordered="true" unbound="true" xml="true">
          <key internal="true" name="xpath">
            <keyfield xpath="@xpath"/>
          </key>
          <attribute label="Field" name="xpath" type="string"/>
          <attribute label="Required" name="isMandatory" type="boolean"/>
        </element>
        <element integrity="own" label="Log" name="log" revLink="job" target="xtk:jobLog" type="link" unbound="true"/>
        <attribute label="Disable the inserting of propositions" name="disablePropositionStorage" type="boolean"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Enabling this setting lets you identify the target based on their browser history" label="Enable target identification based on browser history" name="implicitIdentification" pkgStatus="always" type="boolean" xml="true"/>
        <attribute applicableIf="HasPackage('nms:interaction')" desc="Fall back on an anonymous environment if no individuals were identified" label="Enable anonymous fallback" name="anonymousFallback" pkgStatus="always" type="boolean" xml="true"/>
        <element applicableIf="HasPackage('nms:interaction')" label="Linked anonymous space" name="fallbackOfferSpace" revIntegrity="define" target="nms:offerSpace" type="link"/>
        <element name="targetKey" ordered="true" unbound="true" xml="true">
          <attribute label="Key path" name="xpath" type="string"/>
        </element>
        <attribute label="Randomly display alternative content" name="randomizeAlternativeContents"/>
        <element name="alternativeContent" ordered="true" unbound="true" xml="true">
          <element label="Offer containing the alternative content" name="offer" target="nms:offer" type="link"/>
        </element>
        <element advanced="true" label="Advanced extension scripts" name="extension">
          <element desc="Library inclusion script and initialization" label="Library" name="library" type="CDATA"/>
          <attribute label="Enrich the target data load script" name="useTargetScript" type="boolean"/>
          <element desc="Target data load enrichment script" label="Target data" name="target" type="CDATA"/>
          <attribute label="Overload the proposition selection script" name="useBuildPropositionsScript" type="boolean"/>
          <element desc="Selection script for the proposition list" label="Proposition selection" name="buildPropositions" type="CDATA"/>
          <element desc="Overfiltering script for the list of selected propositions" label="Overfiltering script for the selected propositions" name="postBuildPropositions" type="CDATA"/>
        </element>
        <element advanced="true" label="Rendering functions" name="rendering">
          <attribute label="Overload the XML rendering function" name="useXmlFunction" type="boolean"/>
          <element desc="Rendering function that returns the XML version" label="XML rendering" name="xmlFunction" type="CDATA"/>
          <attribute label="Overload the HTML rendering function" name="useHtmlFunction" type="boolean"/>
          <element desc="Rendering function that returns the HTML version" label="HTML rendering" name="htmlFunction" type="CDATA"/>
          <attribute label="Overload the text rendering function" name="useTextFunction" type="boolean"/>
          <element desc="Rendering function that returns the text version" label="Text rendering" name="textFunction" type="CDATA"/>
        </element>
        <attribute advanced="true" expr="[env/@prodEnv-id]" label="Identifier of the production environment" name="prodOfferEnvId"/>
        <element advanced="true" externalJoin="true" label="Offer space in production" name="prodOfferSpace" revLink="_NONE_" target="nms:offerSpace" type="link">
          <join xpath-dst="@name" xpath-src="@name"/>
          <join xpath-dst="@env-id" xpath-src="@prodOfferEnvId"/>
        </element>
      </element>
      <methods async="true">
        <method library="nms:interaction.js" name="Deploy" static="true">
          <parameters>
            <param desc="Filtering condition defining the spaces to copy" inout="in" name="offerSpaceFilter" type="DOMElement"/>
            <param desc="Identifier of the destination environment" inout="in" name="offerEnv" type="long"/>
          </parameters>
        </method>
        <method name="Publish" static="true">
          <parameters>
            <param desc="Identifier" inout="in" name="offerSpaceId" type="long"/>
          </parameters>
        </method>
        <method const="true" name="GetGeneratedCode">
          <parameters>
            <param desc="Generated Javascript code" inout="out" name="generatedCode" type="string"/>
          </parameters>
        </method>
        <method name="GetUrls" static="true">
          <parameters>
            <param desc="Identifier" inout="in" name="offerSpaceId" type="long"/>
            <param desc="Urls" inout="out" name="urls" type="string"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" img="nms:offer.png" implements="xtk:persist" label="Marketing offers" labelSingular="Marketing offer" name="offer" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="edition" name="status">
        <value img="nms:offer.png" label="Being edited" name="edition" value="0"/>
        <value enabledIf="hasPackage('nms:campaign') OR hasPackage('nms:interaction')" img="nms:delayed.png" label="Pending approval" name="validationPending" value="1"/>
        <value enabledIf="hasPackage('nms:campaign') OR hasPackage('nms:interaction')" img="nms:started.png" label="Approval in progress" name="inProcess" value="2"/>
        <value img="xtk:xtkcheck.png" label="Approved" name="validated" value="3"/>
        <value img="xtk:logwarn.png" label="Refused" name="refused" value="4"/>
        <value img="nms:canceled.png" label="Disabled" name="canceled" value="5"/>
        <value img="nms:prepare.png" label="Online" name="published" value="6"/>
        <value img="nms:delayed.png" label="Pending deployment" name="productionPending" value="7"/>
        <value img="nms:delayed.png" label="Pending de-activation" name="cancelPending" value="8"/>
      </enumeration>
      <element autopk="true" folderLink="category" folderModel="nmsOfferCategory" img="nms:offer.png" name="offer" pkgAdmin="@id != 0 AND @isModel = 1">
        <compute-string expr="@label+' ('+@name+')'"/>
        <key name="name">
          <keyfield xpath="@name"/>
        </key>
        <attribute default="GetOption('XtkInstancePrefix')+'OFR'+CounterValue('nmsOffer')" name="name" template="xtk:common:name"/>
        <attribute name="label" template="xtk:common:label"/>
        <element name="desc" template="xtk:common:desc" xml="true"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element defOnDuplicate="true" default="CurrentUser()" label="Assigned to" name="owner" revIntegrity="define" target="xtk:opsecurity, xtk:operator" type="link"/>
        <attribute enum="status" expr="iif ([category/env/@live]=1, iif(@eligibilityStatus=3 and @contentStatus=3, 6, 5), iif(@eligibilityStatus IN (1, 2, 4) or @contentStatus IN (1, 2, 4), 2, iif (@eligibilityStatus=3 and @contentStatus=3, 7, iif (@eligibilityStatus=5 and @contentStatus=5 , 8, 0))))" name="status" type="byte"/>
        <attribute expr="iif (@productionDate='' or @productionDate &lt; @lastModified, 1, 0)" label="Being edited" name="edition" type="boolean"/>
        <attribute defOnDuplicate="true" enum="status" label="Eligibility status" name="eligibilityStatus" pkgStatus="always" type="byte"/>
        <element label="Eligibility approval" name="eligibilityValidation" ref="xtk:operator:operatorAssignee" xml="true"/>
        <attribute label="Eligibility approval deadline" name="expectedEligibility" type="date"/>
        <attribute advanced="true" label="Reminder date" name="reminderEligibility" type="date"/>
        <attribute defOnDuplicate="true" label="Date on which eligibility was approved" name="eligibilityValidationDate" type="datetime"/>
        <attribute defOnDuplicate="true" enum="status" label="Content status" name="contentStatus" pkgStatus="always" type="byte"/>
        <element label="Content approval" name="contentValidation" ref="xtk:operator:operatorAssignee" xml="true"/>
        <attribute label="Content approval deadline" name="expectedContent" type="date"/>
        <attribute advanced="true" label="Reminder date" name="reminderContent" type="date"/>
        <attribute defOnDuplicate="true" label="Content approval date" name="contentValidationDate" type="datetime"/>
        <element defOnDuplicate="true" default="DefaultFolder('nmsOfferCategory', [@_folder-id])" label="Category" name="category" required="true" revDesc="Marketing offers in this category" revIntegrity="define" revLabel="Marketing offers" revLink="offer" target="nms:offerCategory" type="link"/>
        <attribute label="Offer code" length="64" name="code" type="string"/>
        <attribute desc="Offer start date" label="Start date" name="startDate" pkgStatus="always" type="datetime"/>
        <attribute desc="Offer end date" label="End date" name="endDate" pkgStatus="always" type="datetime"/>
        <attribute defOnDuplicate="true" label="Deployment date" name="productionDate" pkgStatus="never" type="datetime"/>
        <attribute label="Template" name="isModel" type="boolean"/>
        <attribute defOnDuplicate="true" label="Native application offer" name="builtIn" type="boolean"/>
        <element name="filter" pkgStatus="always" template="nms:offerEnv:filter">
          <attribute expr="[../category/env/filter/@schema]" name="schema"/>
          <attribute default="getOption('Nms_DefaultRcpSchema')" desc="Template targeting dimension" label="Targeting dimension" length="64" name="targetSchema" sql="true" type="string"/>
        </element>
        <element integrity="own" label="Log" name="log" revLink="job" target="xtk:jobLog" type="link" unbound="true"/>
        <element name="forecast" template="nms:delivery:forecastDef" xml="true"/>
        <element label="Content" name="view">
          <element label="HTML content" name="htmlSource" type="CDATA" xml="true"/>
          <element label="Text content" name="textSource" type="CDATA" xml="true"/>
          <element label="Title" name="shortContent" type="CDATA" xml="true"/>
          <element label="Image URL" name="imageUrl" type="string" xml="true"/>
          <element label="Acceptance URL in unitary mode" name="unitaryUpdateStatusUrl" type="string" xml="true"/>
          <element advanced="true" desc="HTML content calculation script." label="HTML script" name="htmlSource_jst" type="CDATA" xml="true"/>
          <element advanced="true" desc="Text content calculation script." label="Text script" name="textSource_jst" type="CDATA" xml="true"/>
          <element advanced="true" desc="Title content calculation script." label="Script of the title" name="shortContent_jst" type="CDATA" xml="true"/>
          <element advanced="true" desc="Calculation script of the URL content of the image." label="URL script of the image" name="imageUrl_jst" type="CDATA" xml="true"/>
          <element advanced="true" desc="Calculation script of the acceptance URL in unitary mode (uses the destination URL)." label="URL script for acceptance in unitary mode" name="unitaryUpdateStatusUrl_jst" type="CDATA" xml="true"/>
          <element label="URLs tracked in batch mode" name="trackedUrls">
            <element label="Destination URL" name="url" type="string" xml="true"/>
            <element advanced="true" desc="Calculation script of the destination URL content." label="Destination URL script" name="url_jst" type="CDATA" xml="true"/>
          </element>
        </element>
        <attribute advanced="true" expr="Iif(Right(@name, Length([category/env/@name]) + 1)='_' + [category/env/@name], Left(@name, Length(@name) - Length([category/env/@name]) - 1), @name) + '_' + [category/env/prodEnv/@name]" label="Name of the offer in production" name="prodOfferName"/>
        <element advanced="true" externalJoin="true" label="Offer in production" name="prodOffer" revLink="_NONE_" target="nms:offer" type="link">
          <join xpath-dst="@name" xpath-src="@prodOfferName"/>
        </element>
      </element>
      <methods async="true">
        <method library="nms:interaction.js" name="Deploy" static="true">
          <parameters>
            <param desc="Filtering condition defining the offers to copy" inout="in" name="offerFilter" type="DOMElement"/>
            <param desc="Identifier of the destination environment" inout="in" name="offerEnv" type="long"/>
          </parameters>
        </method>
        <method library="nms:interaction.js" name="DeployPublish" static="true">
          <parameters>
            <param desc="Filtering condition defining the offers to copy" inout="in" name="offerFilter" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:offer.js" name="Cancel" static="true">
          <parameters>
            <param desc="ID of the offer." inout="in" name="offerId" type="string"/>
            <param desc="Comment" inout="in" name="comment" type="string"/>
            <param desc="Offer spaces to approve" inout="in" name="offerSpaces" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:offer.js" name="StartValidation" static="true">
          <parameters>
            <param desc="Offer ID." inout="in" name="offerId" type="string"/>
            <param desc="Approval type (targeting=0, content=1)" inout="in" name="type" type="byte"/>
            <param desc="Offer spaces to approve" inout="in" name="offerSpaces" type="DOMElement"/>
          </parameters>
        </method>
        <method library="nms:offer.js" name="Validation" static="true">
          <parameters>
            <param desc="Offer ID" inout="in" name="offerId" type="long"/>
            <param desc="Approval type (targeting=0, content=1)" inout="in" name="type" type="byte"/>
            <param desc="Offer spaces to approve" inout="in" name="offerSpaces" type="DOMElement"/>
            <param desc="Reject eligibility approval" inout="in" name="refused" type="boolean"/>
            <param desc="Comment" inout="in" name="comment" type="string"/>
          </parameters>
        </method>
        <method name="CheckValidationAccess" static="true">
          <parameters>
            <param desc="Approval parameters" inout="in" name="validation" type="DOMElement"/>
            <param desc="Identifier of the assignee (owner)" inout="in" name="ownerId" type="long"/>
            <param desc="Method return value (yes/no)" inout="out" name="result" type="boolean"/>
          </parameters>
        </method>
        <method library="nms:offer.js" name="Complete" static="true">
          <parameters>
            <param desc="Inbound offer" inout="in" name="offerIn" type="DOMElement"/>
            <param desc="Updated offer" inout="out" name="offerOut" type="DOMElement"/>
          </parameters>
        </method>
        <method name="GetCompatibleOfferViews" static="true">
          <parameters>
            <param desc="Offer ID" inout="in" name="offerId" type="long"/>
            <param desc="Compatible representations" inout="out" name="offerViews" type="DOMElement"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" implements="xtk:persist" label="Offer propositions" labelSingular="Offer proposition" library="true" name="proposition" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="batch" name="engineType">
        <value label="Batch engine" name="batch" value="0"/>
        <value label="Unitary engine" name="unitary" value="1"/>
      </enumeration>
      <element autopk="true" img="nms:proposition.png" name="proposition" pkSequence="NmsPropositionId" pkgStatus="never">
        <dbindex name="lastModified">
          <keyfield xpath="@lastModified"/>
        </dbindex>
        <dbindex name="eventDate">
          <keyfield xpath="@eventDate"/>
        </dbindex>
        <attribute advanced="true" name="id" sqlname="iPropositionId" type="expr:Iif(HasPackage('nms:interactionControl') or HasPackage('nms:interactionExec'), 'int64', 'long')"/>
        <attribute expr="@id" label="Proposition ID" name="proposition-id" sql="true" type="expr:Iif(HasPackage('nms:interactionControl') or HasPackage('nms:interactionExec'), 'int64', 'long')"/>
        <element integrity="neutral" label="Offer" name="offer" revIntegrity="neutral" target="nms:offer" type="link"/>
        <element integrity="neutral" label="Offer space" name="offerSpace" revIntegrity="neutral" target="nms:offerSpace" type="link"/>
        <attribute label="Interaction ID" name="interactionId" sqlname="iInteractionId" type="expr:Iif(HasPackage('nms:interactionControl') or HasPackage('nms:interactionExec'), 'int64', 'long')"/>
        <attribute desc="Weight calculated for this proposition in the interaction" label="Weight" name="weight" type="double"/>
        <attribute desc="Ranking of this proposition in the interaction" label="Ranking" name="rank" type="byte"/>
        <attribute desc="Date of the last event" label="Event date" name="eventDate" type="datetime"/>
        <attribute desc="Last modification date of the log" label="Last modified" name="lastModified" type="datetime"/>
        <attribute advanced="true" desc="Status stored" enum="nms:common:propositionStatus" label="Status" name="statusSql" sqlname="iStatus" type="byte"/>
        <attribute desc="Proposition status" enum="nms:common:propositionStatus" expr="@statusSql" label="Status" name="status" type="byte"/>
        <attribute advanced="true" desc="Offer engine type" enum="engineType" label="Engine type" name="engineType" type="byte"/>
        <element integrity="neutral" label="Delivery" name="delivery" revDesc="Marketing offer propositions" revIntegrity="neutral" revLabel="Offer propositions" revLink="proposition" target="nms:delivery" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" implements="xtk:persist" label="Recipient offer propositions" labelSingular="Recipient offer proposition" name="propositionRcp" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="propositionRcp" template="nms:proposition">
        <element name="offer" revLink="propositionRcp"/>
        <element name="offerSpace" revLink="propositionRcp"/>
        <element integrity="neutral" label="Recipient" name="recipient" revDesc="Marketing offer propositions" revIntegrity="own" revLabel="Offer propositions" revLink="proposition" target="nms:recipient" type="link"/>
        <element externalJoin="true" integrity="neutral" label="Message" name="broadLog" revDesc="Marketing offer propositions" revIntegrity="neutral" revLabel="Offer propositions" revLink="proposition" target="nms:broadLogRcp" type="link">
          <join xpath-dst="@id" xpath-src="@interactionId"/>
          <join xpath-dst="0" xpath-src="@engineType"/>
        </element>
        <attribute expr="Iif(@statusSql=0 &amp;&amp; [broadLog/@status]=1,1,@statusSql)" name="status"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" implements="xtk:persist" label="Visitor offer propositions" labelSingular="Visitor offer proposition" name="propositionVisitor" namespace="nms" xtkschema="xtk:srcSchema">
      <element name="propositionVisitor" template="nms:proposition">
        <element name="offer" revLink="propositionVisitor"/>
        <element name="offerSpace" revLink="propositionVisitor"/>
        <element integrity="neutral" label="Visitor" name="visitor" revDesc="Marketing offer propositions" revIntegrity="own" revLabel="Offer propositions" revLink="proposition" target="nms:visitor" type="link"/>
        <element integrity="neutral" label="Message" name="broadLog" revDesc="Marketing offer propositions" revIntegrity="neutral" revLabel="Offer propositions" revLink="proposition" target="nms:broadLogVisitor" type="link">
          <join xpath-dst="@id" xpath-src="@interactionId"/>
          <join xpath-dst="0" xpath-src="@engineType"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" img="nms:offerView.png" implements="xtk:persist" label="Offer representations" labelSingular="Offer representation" name="offerView" namespace="nms" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="edition" name="status">
        <value img="nms:offer.png" label="Being edited" name="edition" value="0"/>
        <value enabledIf="hasPackage('nms:campaign') OR hasPackage('nms:interaction')" img="nms:delayed.png" label="Pending approval" name="validationPending" value="1"/>
        <value img="xtk:xtkcheck.png" label="Approved" name="validated" value="3"/>
        <value img="xtk:logwarn.png" label="Refused" name="refused" value="4"/>
        <value img="nms:canceled.png" label="Disabled" name="canceled" value="5"/>
        <value img="nms:prepare.png" label="Online" name="published" value="6"/>
      </enumeration>
      <element autopk="true" img="nms:offerView.png" name="offerView">
        <key name="type">
          <keyfield xpath="@offer-id"/>
          <keyfield xpath="@space-id"/>
        </key>
        <attribute defOnDuplicate="true" enum="status" label="Status" name="status" pkgStatus="always" type="byte"/>
        <attribute enum="status" expr="iif ([offer/category/env/@live]=1 and @status=3, 6, iif ([offer/category/env/@live]=0 and [offer/@contentStatus]=0, iif (@status=3 or @status=5, 0, @status), @status))" label="Calculated status" name="state" type="byte"/>
        <attribute defOnDuplicate="true" label="Publication date" name="publicationDate" pkgStatus="never" type="datetime"/>
        <element aggregate="xtk:common:auditTrail" name="auditTrail"/>
        <element label="Offer" name="offer" revIntegrity="own" revLabel="Representations" target="nms:offer" type="link"/>
        <element label="Offer space" name="space" required="true" revIntegrity="define" target="nms:offerSpace" type="link"/>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" genAccessors="false" label="Interactions" labelSingular="Interaction" name="interaction" namespace="nms" view="true" xtkschema="xtk:srcSchema">
      <enumeration basetype="byte" default="explicit" name="identificationMode">
        <value label="Anonymous" name="anonymous" value="0"/>
        <value label="Implicit" name="implicit" value="1"/>
        <value label="Explicit" name="explicit" value="2"/>
      </enumeration>
      <element name="interaction" pkgStatus="never">
        <attribute label="Interaction date" name="event" type="datetime"/>
        <attribute label="Environment" name="env" type="string"/>
        <attribute label="Offer space" name="offerSpace" type="string"/>
        <element applicableIf="HasPackage('nms:geoip')" label="Location" name="location">
          <attribute label="Country" name="country" type="string"/>
          <attribute label="City" name="city" type="string"/>
          <attribute label="Zip/Postcode" name="zipCode" type="string"/>
          <attribute label="Latitude" name="latitude" type="string"/>
          <attribute label="Longitude" name="longitude" type="string"/>
          <attribute label="Region" name="region" type="string"/>
          <attribute label="Country code" name="countryCode" type="string"/>
        </element>
        <attribute enum="identificationMode" label="Identification mode" name="identificationMode" type="byte"/>
      </element>
      <methods async="true">
        <method hidden="true" library="nms:interaction.js" name="CompileRealTimeScript" static="true">
          <parameters>
            <param desc="Space ID" inout="in" name="spaceId" type="string"/>
            <param desc="Generates a preview script" inout="in" name="preview" type="boolean"/>
            <param desc="Offer forced for preview" inout="in" name="offer" type="long"/>
            <param desc="JavaScript generated" inout="out" name="script" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:interaction.js" name="GetFilteringConditions" static="true">
          <parameters>
            <param desc="Offer IDs" inout="in" name="offers" type="string"/>
            <param desc="Category ID" inout="in" name="categoryId" type="string"/>
            <param desc="Contact date" inout="in" name="contactDate" type="datetime"/>
            <param desc="Channel" inout="in" name="channel" type="long"/>
            <param desc="Filter conditions" inout="out" name="filter" type="DOMElement"/>
            <param desc="Eligibility statuses" inout="out" name="offerStatus" type="DOMElement"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:interaction.js" name="ForceOffers" static="true">
          <parameters>
            <param desc="Offer IDs" inout="in" name="offers" type="string"/>
            <param desc="Filtering table schema" inout="in" name="schema" type="string"/>
            <param desc="Path of the target from the filtering schema" inout="in" name="targetXPath" type="string"/>
            <param desc="Saves the SQL queries in the log" inout="in" name="logSQL" type="boolean"/>
            <param desc="Prefix to use for work tables" inout="in" name="SQLPrefix" type="string"/>
            <param desc="Reuses a preexisting table for the propositions" inout="in" name="reuseTable" type="boolean"/>
            <param desc="Space ID" inout="in" name="spaceId" type="long"/>
            <param desc="Additional filter on the filtering schema" inout="in" name="additionalFilter" type="DOMElement"/>
            <param desc="Contact date" inout="in" name="contactDate" type="datetime"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:interaction.js" name="GenerateTempPropositions" static="true">
          <parameters>
            <param desc="Filtering table schema" inout="in" name="schema" type="string"/>
            <param desc="Path of the target from the filtering schema" inout="in" name="targetXPath" type="string"/>
            <param desc="Offer category (or environment) ID" inout="in" name="categoryId" type="long"/>
            <param desc="Maximum number of propositions per target" inout="in" name="maxPropositionCount" type="long"/>
            <param desc="Saves the SQL queries in the log" inout="in" name="logSQL" type="boolean"/>
            <param desc="Prefix to use for work tables" inout="in" name="SQLPrefix" type="string"/>
            <param desc="Reuses a preexisting table for the propositions" inout="in" name="reuseTable" type="boolean"/>
            <param desc="Space ID" inout="in" name="spaceId" type="long"/>
            <param desc="Additional filter on the filtering schema" inout="in" name="additionalFilter" type="DOMElement"/>
            <param desc="Contact date" inout="in" name="contactDate" type="datetime"/>
            <param desc="Sort propositions by weight" inout="in" name="keepOnlyBestPropositions" type="boolean"/>
            <param desc="Limit the offers to the selected themes" inout="in" name="sThemes" type="string"/>
          </parameters>
        </method>
        <method hidden="true" library="nms:interaction.js" name="OptimizePropositions" static="true">
          <parameters>
            <param desc="List of offers" inout="in" name="offerSelection" type="string"/>
            <param desc="Filtering table schema" inout="in" name="schema" type="string"/>
            <param desc="Path of the target from the filtering schema" inout="in" name="targetXPath" type="string"/>
            <param desc="Maximum number of propositions per target" inout="in" name="maxPropositionCount" type="long"/>
            <param desc="Saves the SQL queries in the log" inout="in" name="logSQL" type="boolean"/>
            <param desc="Prefix to use for work tables" inout="in" name="SQLPrefix" type="string"/>
            <param desc="Reuses a preexisting table for the propositions" inout="in" name="reuseTable" type="boolean"/>
            <param desc="Space ID" inout="in" name="spaceId" type="long"/>
            <param desc="Additional filter on the filtering schema" inout="in" name="additionalFilter" type="DOMElement"/>
            <param desc="Contact date" inout="in" name="contactDate" type="datetime"/>
            <param desc="Sort propositions by weight" inout="in" name="keepOnlyBestPropositions" type="boolean"/>
          </parameters>
        </method>
      </methods>
    </srcSchema>
  </entities>
  <entities schema="xtk:srcSchema">
    <srcSchema entitySchema="xtk:srcSchema" extendedSchema="xtk:rights" genAccessors="false" label="Rights" labelSingular="Right" name="rights" namespace="nms" xtkschema="xtk:srcSchema">
      <element label="Rights" labelSingular="Right" name="rights">
        <element applicableIf="HasPackage('nms:campaign')" desc="Plan linked to the right" label="Plan" name="plan" pkgStatus="never" revIntegrity="own" revLabel="Rights" revLink="rights" target="nms:plan" type="link">
          <join xpath-dst="@id" xpath-src="@folder-id"/>
        </element>
        <element applicableIf="HasPackage('nms:campaign')" desc="Program linked to the right" label="Program" name="program" pkgStatus="never" revIntegrity="own" revLabel="Rights" revLink="rights" target="nms:program" type="link">
          <join xpath-dst="@id" xpath-src="@folder-id"/>
        </element>
        <element desc="Offer environment linked to the right" label="Offer environment" name="offerEnv" pkgStatus="never" revIntegrity="own" revLabel="Rights" revLink="rights" target="nms:offerEnv" type="link">
          <join xpath-dst="@id" xpath-src="@folder-id"/>
        </element>
        <element desc="Offer category linked to the right" label="Offer category" name="offerCategory" pkgStatus="never" revIntegrity="own" revLabel="Rights" revLink="rights" target="nms:offerCategory" type="link">
          <join xpath-dst="@id" xpath-src="@folder-id"/>
        </element>
      </element>
    </srcSchema>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:specFile" entitySchema="xtk:form" img="xtk:package32.png" label="Package export wizard" md5="7B61F57EC022654F61887372E4B0C356" name="addInPackage" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Please specify the process to apply to the selected objects" title="Export type">
        <input checkedValue="1" label="Export now" type="radioButton" xpath="/tmp/@type"/>
        <input checkedValue="0" label="Add to a package definition" type="radioButton" xpath="/tmp/@type"/>
        <container enabledIf="[/tmp/@type]=0" type="enabledGroup">
          <input choiceButton="true" form="xtk:specFile" fullLoad="true" label="Package" newEntityFormChoice="true" schema="xtk:specFile" type="linkEdit" xpath="/tmp/@package">
            <orderBy>
              <node expr="@label"/>
            </orderBy>
          </input>
        </container>
        <leave>
          <if expr="[/tmp/@type]=0">
            <soapCall name="addInPackage" service="xtk:specFile">
              <param exprIn="[/tmp/@package]" type="string"/>
              <param exprIn="[/tmp/@xtkschema]" type="string"/>
              <param exprIn="/tmp/selection/where" type="DOMElement"/>
            </soapCall>
          </if>
          <if expr="[/tmp/@type]=1">
            <soapCall name="exportSelection" service="xtk:specFile">
              <param exprIn="[/tmp/@xtkschema]" type="string"/>
              <param exprIn="/tmp/selection/where" type="DOMElement"/>
              <param type="DOMElement" xpathOut="/tmp/package"/>
            </soapCall>
          </if>
        </leave>
      </container>
      <container desc="Content of the resulting package" title="Export of selected objects" visibleIf="[/tmp/@type]=1">
        <input nolabel="true" type="sourceEdit" xpath="/tmp/package"/>
        <input img="xtk:save.png" label="Save the package content in a local file..." title="Save the package content" type="saveEntityButton" xpath="/tmp/package" xpathFile="/tmp/@file"/>
      </container>
      <container desc="Operation complete" title="Add to a package definition" visibleIf="[/tmp/@type]=0 and [/tmp/@package]!=''">
        <static img="nms:checked.png" label="Updated package definition."/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:serverConf" entitySchema="xtk:form" img="xtk:keys.png" label="Declare a new instance" md5="FB4DFEB1A35175235FDC355C8435E42C" name="addInstance" namespace="xtk" nothingToSave="true" xtkschema="xtk:form">
      <container type="visibleGroup" visibleIf="$(databaseId)==''">
        <static type="help">The application server has just been installed. The first step is to declare a new instance to work with.</static>
      </container>
      <container img="nl:serverOptions32.png" label="Instance parameters" type="frame">
        <input type="edit" xpath="@name"/>
        <input xpath="shared/dataStore/@hosts"/>
        <static type="help">Enter here list of DNS masks used by the application server, separated by commas, to determine whether it should work on this instance.
Example: myinstance.domain.com*</static>
        <input xpath="shared/dataStore/@lang"/>
      </container>
      <container type="visibleGroup" visibleIf="$(databaseId)==''">
        <static img="xtk:logwarn.png">You will be disconnected after the instance has been declared. You must reconnect to proceed with database creation.</static>
      </container>
      <container type="visibleGroup" visibleIf="$(databaseId)!=''">
        <static img="xtk:logwarn.png">After the instance has been declared, disconnect and reconnect to this instance so that you can proceed with database creation.</static>
      </container>
      <leave>
        <soapCall name="AddInstance" service="xtk:serverOptions">
          <param exprIn="@name" type="string"/>
          <param exprIn="[shared/dataStore/@hosts]" type="string"/>
          <param exprIn="[shared/dataStore/@lang]" type="string"/>
        </soapCall>
        <setClean/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="ncm:generate32.png" label="Alias cleansing" md5="7DCA0012E5E5D5D455E18ABB6E1C4FC2" name="aliasCleansing" namespace="xtk" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
        <if expr="[/enum/@id] != ''">
          <set expr="[/enum/@lastAliasCleansing]" xpath="/tmp/@from"/>
          <set expr="'@id = ' + [/enum/@id]" xpath="/tmp/ctxForm/keys/where/condition/@expr"/>
        </if>
      </enter>
      <container desc="Click 'Start' to start alias cleansing." name="finish" title="Cleansing">
        <container refreshPeriod="1500" type="jobProgressContainer" xpathProperties="/tmp/properties">
          <soapCall name="AliasCleansing" service="xtk:enum">
            <param type="DOMElement" xpath="/tmp/ctxForm/keys/where"/>
            <param type="datetime" xpath="/tmp/@from"/>
            <param type="boolean" xpath="/tmp/@refreshHit"/>
            <param type="boolean" xpath="/tmp/@resetHit"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/tmp/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/tmp/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <container>
        <input img="xtk:properties.png" label="Advanced parameters..." prebuildSubForm="false" type="subFormLink">
          <form label="Advanced parameters">
            <input label="Start date" type="datetime" xpath="/tmp/@from"/>
            <input checkedValue="true" label="Updates the number of alias hits" nolabel="true" type="checkbox" unCheckedValue="false" xpath="/tmp/@refreshHit"/>
            <container type="visibleGroup" visibleIf="[/tmp/@refreshHit]">
              <input checkedValue="true" label="Recalculate the number of alias hits from the start" nolabel="true" type="checkbox" unCheckedValue="false" xpath="/tmp/@resetHit"/>
            </container>
          </form>
        </input>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:session" entitySchema="xtk:form" img="xtk:keys.png" label="Change password" md5="9BA00441158589437F8D46C52A5542C0" name="changePassword" namespace="xtk" nothingToSave="true" xtkschema="xtk:form">
      <value expr="$(login)" hidden="false" label="Login" type="expr"/>
      <input crypt="false" img="xtk:passwd.png" label="Old password" type="passwordedit" xpath="/tmp/@oldPassword"/>
      <input crypt="false" img="xtk:passwd.png" label="New password" type="passwordedit" xpath="/tmp/@newPassword"/>
      <input crypt="false" img="xtk:passwd.png" label="Confirmation" type="passwordedit" xpath="/tmp/@newPassword2"/>
      <leave>
        <check expr="[/tmp/@newPassword] == [/tmp/@newPassword2]">
          <error>The new password and its confirmation do not match.
Please try again.</error>
        </check>
        <soapCall name="ChangePassword" service="xtk:session">
          <param exprIn="[/tmp/@oldPassword]" type="string"/>
          <param exprIn="[/tmp/@newPassword]" type="string"/>
        </soapCall>
        <setClean/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:workflow" entitySchema="xtk:form" img="xtk:form.png" label="Change the execution account" md5="EA5F9502E9E8F52C85998630DA21749A" name="changeWorkflowLogin" namespace="xtk" nothingToSave="true" xtkschema="xtk:form">
      <enter>
        <soapCall name="GetLogin" service="xtk:workflow">
          <param exprIn="@id" type="string"/>
          <param type="int" xpathOut="/tmp/login/@id"/>
          <param type="string" xpathOut="/tmp/login/@name"/>
          <param type="string" xpathOut="/tmp/login/@cs"/>
        </soapCall>
      </enter>
      <input computeStringAlias="@cs" label="Login" notifyPathList="@name" schema="xtk:operator" type="linkedit" xpath="/tmp/login/@id">
        <sysFilter>
          <condition expr="@type=0"/>
        </sysFilter>
      </input>
      <leave>
        <if expr="[/tmp/login/@id] = ''">
          <set value="" xpath="/tmp/login/@name"/>
        </if>
        <soapCall name="SetLogin" service="xtk:workflow">
          <param exprIn="@id" type="string"/>
          <param exprIn="[/tmp/login/@name]" type="string"/>
        </soapCall>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="3" entitySchema="xtk:form" img="xtk:form.png" label="Edit conflicts" md5="1A166098919AE776ABBFF1A561F9A89E" name="conflict" namespace="xtk" xtkschema="xtk:form">
      <input readOnly="true" xpath="@name"/>
      <input readOnly="true" xpath="@namespace"/>
      <input readOnly="true" xpath="@entitySchema"/>
      <input colspan="3" contentType="xml" nolabel="true" toolbar="true" type="SourceEdit" xpath="xml"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Connections" md5="8690A88A63CE9AA3590194B5F52C935F" name="connections" namespace="xtk" xtkschema="xtk:form">
      <input toolbarAlign="horizontal" type="toolbarHierarchy" xpath="/tmp/@toolbar">
        <input align="left" img="xtk:newentity.png" label="Add" type="CXtkHierarchyMenuBtn"/>
        <input type="CIconSep"/>
        <input commandName="AdbDelete" img="xtk:delete.png"/>
        <input commandName="AdbCancel"/>
        <input type="CIconSep"/>
        <input commandName="Copy" img="xtk:copy.png"/>
        <input commandName="Cut" img="xtk:cut.png"/>
        <input commandName="Paste" img="xtk:paste.png"/>
        <input type="CIconSep"/>
        <input align="left" commandName="CloseForm" img="xtk:close.png"/>
      </input>
      <static type="separator"/>
      <container type="vpaned">
        <input dblClickAction="btnOk" type="hierarchy" xpath="." xpathSelection="/tmp/@xpathSelection" xpathSelectionType="/tmp/@selectionType" xpathToolbarHierarchy="/tmp/@toolbar"/>
        <container>
          <container type="visibleGroup" visibleIf="[/tmp/@selectionType]='connections'" xpath="folder">
            <container label="Help" type="frame">
              <static type="help">Here you can define connection settings for the application servers to which you have access</static>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/@selectionType]='folder'" xpath="folder">
            <container type="CollectionItemGroup" xpath="." xpathSelection="/tmp/@xpathSelection">
              <static label="Folder" type="separator"/>
              <input xpath="@label"/>
              <input xpath="comment"/>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/@selectionType]='cnx'" xpath="cnx">
            <container type="CollectionItemGroup" xpath="." xpathSelection="/tmp/@xpathSelection">
              <static label="Connection" type="separator"/>
              <input xpath="@label"/>
              <input xpath="@url"/>
              <input xpath="@ims"/>
              <input xpath="comment"/>
            </container>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" md5="02CF9101B8D0C1045344FE6EB9AACD2A" name="counter" namespace="xtk" xtkschema="xtk:form">
      <input xpath="@label"/>
      <input type="ComputeNameEdit" xpath="@name" xpathRef="@label"/>
      <input colspan="2" xpath="@value"/>
      <input colspan="2" xpath="comment"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:builder" entitySchema="xtk:form" img="xtk:createdb.png" label="Database Creation Wizard" md5="7BC507C7A624FDD35D0631DA9DF676C5" name="createdb" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <soapCall name="GetDbParams" service="xtk:builder">
          <param type="DOMElement" xpathOut="dbcnx"/>
          <param type="DOMElement" xpathOut="createdbParameters"/>
        </soapCall>
        <set value="false" xpath="createdbParameters/creationSteps/@createEmptyDb"/>
        <if expr="[dbcnx/@provider]==''">
          <set value="PostgreSQL" xpath="dbcnx/@provider"/>
          <set value="neolane" xpath="dbcnx/@login"/>
          <set value="true" xpath="createdbParameters/creationSteps/@createEmptyDb"/>
        </if>
        <set expr="$(databaseId)==''" xpath="/tmp/@newId"/>
      </enter>
      <container desc="This wizard guides you through the database creation process." name="general" title="Database creation" xpath="createdbParameters">
        <static>Select the database engine to use from the list of supported ones.</static>
        <input enum="xtk:builder:creationProvider" label="Engine" xpath="../dbcnx/@provider"/>
        <static font-size="15" label="Database server" type="separator"/>
        <input xpath="../dbcnx/@server"/>
        <container type="visibleGroup" visibleIf="[../dbcnx/@provider]=='Oracle'">
          <static type="help">TNS name (defined on the application server) used to access the database server.</static>
        </container>
        <container type="visibleGroup" visibleIf="[../dbcnx/@provider]=='PostgreSQL'">
          <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
        </container>
        <container type="visibleGroup" visibleIf="[../dbcnx/@provider]=='MSSQL'">
          <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
          <static label="Authentication mode used to access SQL Server" type="separator"/>
          <input checkedValue="false" label="SQL Server authentication" type="RadioButton" xpath="/tmp/@integratedSecurity"/>
          <input checkedValue="true" label="Windows NT authentication (integrated security)" type="RadioButton" xpath="/tmp/@integratedSecurity"/>
        </container>
        <container type="visibleGroup" visibleIf="[../dbcnx/@provider]=='DB2'">
          <static type="help">Host name or host:port name used to access the database server.</static>
        </container>
        <container type="visibleGroup" visibleIf="[../dbcnx/@provider]=='MySQL'">
          <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
        </container>
        <static font-size="15" label="Database to use" type="separator"/>
        <input checkedValue="true" label="Create or recycle a database" type="RadioButton" xpath="creationSteps/@createEmptyDb"/>
        <input checkedValue="false" label="Use an existing database" type="RadioButton" xpath="creationSteps/@createEmptyDb"/>
        <container type="visibleGroup" visibleIf="[creationSteps/@createEmptyDb]='true'">
          <static type="help">Use this option to create a new database or recycle an existing database.</static>
        </container>
        <container type="visibleGroup" visibleIf="[creationSteps/@createEmptyDb]='false'">
          <static type="help">Use this option to recycle an empty database already created by your database administrator or to extend the structure of an existing database.</static>
        </container>
        <leave>
          <check expr="[../dbcnx/@provider] != 'MySQL'">
            <error>A new instance could not be installed on a MySQL database.</error>
          </check>
          <if expr="[../dbcnx/@provider]=='DB2'">
            <set value="neolane" xpath="../dbcnx/@login"/>
          </if>
        </leave>
        <leave>
          <if expr="[/tmp/@integratedSecurity]">
            <set value="(INTEGRATED)" xpath="../dbcnx/@login"/>
          </if>
        </leave>
      </container>
      <container desc="Define the database server connection parameters." name="dbParameters" title="Server access" visibleIf="[/tmp/@integratedSecurity]!='true' and [createdbParameters/creationSteps/@createEmptyDb]" xpath="createdbParameters">
        <enter>
          <if expr="[dbAdminAccount/@login]==''">
            <if expr="[../dbcnx/@provider]=='Oracle'">
              <set value="system" xpath="dbAdminAccount/@login"/>
            </if>
            <if expr="[../dbcnx/@provider]=='PostgreSQL'">
              <set value="postgres" xpath="dbAdminAccount/@login"/>
            </if>
            <if expr="[../dbcnx/@provider]=='MSSQL'">
              <set expr="'sa'" xpath="dbAdminAccount/@login"/>
            </if>
            <if expr="[../dbcnx/@provider]=='DB2'">
              <set value="db2inst1" xpath="dbAdminAccount/@login"/>
            </if>
            <if expr="[../dbcnx/@provider]=='Teradata'">
              <set value="DBC" xpath="dbAdminAccount/@login"/>
              <set value="100" xpath="@databaseSizeMb"/>
            </if>
            <if expr="[../dbcnx/@provider]=='MySQL'">
              <set value="root" xpath="dbAdminAccount/@login"/>
            </if>
          </if>
        </enter>
        <container colcount="2">
          <value enum="xtk:builder:creationProvider" fontBold="true" xpath="../dbcnx/@provider"/>
          <value fontBold="true" xpath="../dbcnx/@server"/>
        </container>
        <static font-size="15" label="System account (administrator)" type="separator"/>
        <static label="You must use a database account having enough privileges to create new databases."/>
        <input xpath="dbAdminAccount/@login"/>
        <input crypt="false" xpath="dbAdminAccount/@password"/>
      </container>
      <container desc="Define the database connection settings." name="dbParameters" title="Database" xpath="createdbParameters">
        <enter>
          <if expr="[/ignored/@isUserChoiceUtc]!=true">
            <if expr="[../dbcnx/@provider] != 'PostgreSQL'">
              <set value="false" xpath="@utc"/>
            </if>
            <if expr="[../dbcnx/@provider] = 'PostgreSQL'">
              <set value="true" xpath="@utc"/>
              <set value="true" xpath="@unicodeData"/>
            </if>
          </if>
        </enter>
        <container colcount="2">
          <value enum="xtk:builder:creationProvider" fontBold="true" xpath="../dbcnx/@provider"/>
          <value fontBold="true" xpath="../dbcnx/@server"/>
        </container>
        <container type="visibleGroup" visibleIf="![creationSteps/@createEmptyDb]">
          <static font-size="15" label="Database to use" type="separator"/>
          <static>You must define parameters used to connect to your database.</static>
          <input xpath="@dbName"/>
          <container type="visibleGroup" visibleIf="[/tmp/@integratedSecurity]!='true'">
            <container type="visibleGroup" visibleIf="[../dbcnx/@provider] != 'Oracle' and [../dbcnx/@provider] != 'Teradata'">
              <input xpath="../dbcnx/@login"/>
            </container>
            <input crypt="false" xpath="../dbcnx/@password"/>
          </container>
          <static font-size="15" label="Character set" type="separator"/>
          <input xpath="@unicodeData"/>
          <container type="visibleGroup" visibleIf="EV([../dbcnx/@provider], 'Oracle', 'MSSQL')==true">
            <input xpath="@NChar"/>
          </container>
          <container type="visibleGroup" visibleIf="[../dbcnx/@provider] = 'PostgreSQL' or [../dbcnx/@provider] = 'DB2'">
            <static label=" " nolabel="false" type="warning">The database being initialized needs to have been created using encoding compatible with the storage mode (Unicode or not) that you select.</static>
          </container>
          <static font-size="15" label="Time zone" type="separator"/>
          <container enabledIf="[../dbcnx/@provider] = 'MSSQL' OR [../dbcnx/@provider] = 'PostgreSQL' OR [../dbcnx/@provider] = 'Oracle'" type="enabledGroup">
            <input xpath="@utc"/>
          </container>
          <input xpath="@timezone"/>
        </container>
        <container type="visibleGroup" visibleIf="[creationSteps/@createEmptyDb]">
          <static font-size="15" label="New database" type="separator"/>
          <input xpath="@dbName" xpathCopyName="../dbcnx/@login"/>
          <container type="visibleGroup" visibleIf="[../dbcnx/@provider] == 'DB2'">
            <static label="8 characters maximum" type="warning"/>
          </container>
          <input xpath="@overwriteDatabase"/>
          <container type="visibleGroup" visibleIf="[../dbcnx/@provider]=='DB2'">
            <static font-size="15" label="Server connection data" type="separator"/>
            <input xpath="../dbcnx/@login"/>
            <input crypt="false" xpath="../dbcnx/@password"/>
            <static label="User account must have the required rights to create routines." type="help"/>
          </container>
          <container type="visibleGroup" visibleIf="[../dbcnx/@provider] == 'Teradata'">
            <static font-size="15" label="Storage parameters" type="separator"/>
            <static>You must specify the size allocated to the new database (in Mb).</static>
            <input xpath="@databaseSizeMb"/>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/@integratedSecurity]!='true' and [../dbcnx/@provider] != 'Oracle' and [../dbcnx/@provider] != 'Teradata' and [../dbcnx/@provider] != 'DB2'">
            <static font-size="15" label="Account used to access the database" type="separator"/>
            <input checkedValue="true" label="Create a new user account for this database" type="RadioButton" xpath="@createNewAccount"/>
            <input checkedValue="false" label="Associate the new database to an existing user account" type="RadioButton" xpath="@createNewAccount"/>
            <input xpath="../dbcnx/@login"/>
            <input crypt="false" xpath="../dbcnx/@password"/>
            <container type="visibleGroup" visibleIf="[@createNewAccount]">
              <input crypt="false" img="xtk:passwd.png" label="Confirmation" type="passwordedit" xpath="/tmp/@passwordConfirm"/>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="[../dbcnx/@provider] == 'Oracle' or [../dbcnx/@provider] == 'Teradata'">
            <static font-size="15" label="Password" type="separator"/>
            <static>You must enter the password of the account linked to the new database.</static>
            <input crypt="false" xpath="../dbcnx/@password"/>
            <input crypt="false" img="xtk:passwd.png" label="Confirmation" type="passwordedit" xpath="/tmp/@passwordConfirm"/>
          </container>
          <static font-size="15" label="Character set" type="separator"/>
          <input xpath="@unicodeData"/>
          <container type="visibleGroup" visibleIf="EV([../dbcnx/@provider], 'Oracle', 'MSSQL')==true">
            <input xpath="@NChar"/>
          </container>
          <static font-size="15" label="Time zone" type="separator"/>
          <container enabledIf="[../dbcnx/@provider] = 'MSSQL' OR [../dbcnx/@provider] = 'PostgreSQL' OR [../dbcnx/@provider] = 'Oracle'" type="enabledGroup">
            <input xpath="@utc"/>
          </container>
          <input xpath="@timezone"/>
        </container>
        <leave>
          <set value="true" xpath="/ignored/@isUserChoiceUtc"/>
          <check expr="[creationSteps/@createEmptyDb] == 'false' OR [@createNewAccount] == 'false' OR [../dbcnx/@password] == [/tmp/@passwordConfirm]">
            <error>The new password and its confirmation do not match.
Please try again.</error>
          </check>
          <check expr="[../dbcnx/@provider] != 'DB2' or StrLen(@dbName)&lt;=8">
            <error>The database name must not exceed 8 characters.</error>
          </check>
        </leave>
      </container>
      <container desc="Select the modules to enable when creating the database. Certain packages are subject to payment, please check which ones you are entitled to." name="packages" title="Packages to install" xpath="createdbParameters">
        <enter>
          <check expr="@dbName != ''">
            <error>Please specify a name for the database.</error>
          </check>
        </enter>
        <container xpath="packages">
          <input hideEditButtons="true" nolabel="true" type="PackageList" xpath="package">
            <input xpath="@label"/>
            <input xpath="@enabled"/>
          </input>
          <static unbound-width="true"/>
        </container>
        <leave>
          <if expr="[/tmp/package/@import] == false">
            <reset xpath="package"/>
          </if>
        </leave>
      </container>
      <container desc="Select the database creation steps to be performed." name="steps" title="Creation steps" xpath="createdbParameters">
        <enter>
          <set value="true" xpath="@changeAdminPassword"/>
        </enter>
        <input xpath="@editSql"/>
        <input xpath="@overwriteTables"/>
        <container type="visibleGroup" visibleIf="[../dbcnx/@provider] != 'Teradata' and [../dbcnx/@provider] != 'MySQL'">
          <container label="Storage parameters" maxLabelWidth="200" type="frame">
            <static label="Specify storage parameters when creating database objects." type="help"/>
            <input xpath="@tableSpaceUser"/>
            <input xpath="@tableSpaceIndex"/>
            <input xpath="@tableSpaceWork"/>
            <input xpath="@tableSpaceWorkIndex"/>
            <container type="visibleGroup" visibleIf="[../dbcnx/@provider] == 'Oracle'">
              <input xpath="@tableSpaceTemp"/>
            </container>
          </container>
        </container>
        <container label="Adobe Campaign administrator password" maxLabelWidth="200" type="frame">
          <input xpath="@changeAdminPassword"/>
          <container type="visibleGroup" visibleIf="@changeAdminPassword">
            <input crypt="false" label="Password" xpath="@nlAdminPassword"/>
            <input crypt="false" img="xtk:passwd.png" label="Confirmation" type="passwordedit" xpath="/tmp/@passwordConfirmNl"/>
          </container>
        </container>
        <leave>
          <check expr="@nlAdminPassword != '' or @changeAdminPassword == 'false'">
            <error>Please specify an administrator password.</error>
          </check>
          <check expr="@nlAdminPassword == [/tmp/@passwordConfirmNl] or @changeAdminPassword == 'false'">
            <error>The administrator password and its confirmation do not match.
Please try again.</error>
          </check>
        </leave>
      </container>
      <container desc="Preview of the SQL script used to create the database" name="previewSql" title="Table-creation script" visibleIf="[createdbParameters/@editSql]" xpath="createdbParameters">
        <enter>
          <soapCall name="GenCreateDbDDL" service="xtk:builder">
            <param exprIn="[/builder]" type="DOMElement"/>
            <param type="string" xpathOut="sqlDDL"/>
          </soapCall>
        </enter>
        <input contentType="sql" nolabel="true" toolbar="true" type="CodeEdit" xpath="sqlDDL"/>
      </container>
      <container desc="Press 'Start' to launch the database creation." name="finish" title="Database creation execution">
        <enter>
          <set value="true" xpath="@doNotPersist"/>
        </enter>
        <container img="nl:serverOptions32.png" label="Connection settings" type="frame">
          <value enum="xtk:builder:creationProvider" fontBold="true" xpath="dbcnx/@provider"/>
          <value fontBold="true" xpath="dbcnx/@server"/>
          <value fontBold="true" xpath="createdbParameters/@dbName"/>
        </container>
        <container refreshPeriod="500" type="jobProgressContainer" xpathProperties="/properties">
          <soapCall name="CreateDb" service="xtk:builder">
            <param exprIn="/" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
        <container type="visibleGroup" visibleIf="[/tmp/@newId]">
          <static img="xtk:logwarn.png">You will be disconnected after the database has been created. Please reconnect to proceed with instance configuration.</static>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Dashboard" md5="B3976ED9428B114C2FD82629C499B3CA" name="dashboard" namespace="xtk" xtkschema="xtk:form">
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="imgTitle">
          <input xpath="@displayTitle"/>
          <container type="visibleGroup" visibleIf="@displayTitle">
            <input xpath="@useTitleSep"/>
          </container>
          <container type="visibleGroup" visibleIf="@displayTitle=false">
            <static/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@displayTitle">
            <input colspan="2" xpath="@title"/>
            <input xpath="leftImg/@img"/>
            <input alias="views/view" type="viewComboList" xpath="leftImg/@view"/>
          </container>
        </container>
        <container colcount="2" name="view">
          <input xpath="@refresh"/>
          <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath=".">
            <form label="Advanced parameters">
              <input label="List of actions" type="list" xpath="actionLink" zoom="true" zoomOnAdd="true">
                <input xpath="@label"/>
                <input hidden="true" xpath="@name"/>
                <form colcount="2" label="Edit">
                  <input xpath="@label"/>
                  <input required="true" xpath="@name"/>
                  <input alias="views/view" colspan="2" type="viewComboList" xpath="@view" xpathLabel="@label"/>
                  <input colspan="2" xpath="@img"/>
                </form>
              </input>
              <static label="Please enter the list of actions to be displayed in the toolbar of the view." type="help"/>
            </form>
          </input>
          <container colcount="2" colspan="2" ref="xtk:dashboard:lib/imgTitle"/>
          <container colspan="2" style="down" type="notebook">
            <container label="Header">
              <static colspan="2" label="Header" type="separator"/>
              <input nolabel="true" xpath="header"/>
            </container>
            <container label="List of links">
              <input colspan="2" img="nms:tracking.png" nolabel="true" toolbarCaption="List of links" type="list" xpath="urlLink" zoom="true" zoomOnAdd="true">
                <input xpath="@label"/>
                <input xpath="@desc"/>
                <input hidden="true" xpath="@name"/>
                <input hidden="true" xpath="@reportName"/>
                <input hidden="true" xpath="@reportTarget"/>
                <form colcount="2" label="Edit">
                  <input xpath="@label"/>
                  <input required="true" xpath="@name"/>
                  <container type="visibleGroup" visibleIf="EV(@viewType, 'report')=false">
                    <input alias="views/view" type="viewComboList" xpath="@view" xpathLabel="@label"/>
                  </container>
                  <container type="visibleGroup" visibleIf="EV(@viewType, 'report')">
                    <input createMode="none" img="xtk:report.png" notifyPathList="@label|../@label,@internalName|../@reportName,targetReport/@internalName|../@reportTarget" xpath="report">
                      <sysFilter>
                        <condition expr="@isGlobal=1"/>
                        <condition expr="@isModel=0"/>
                      </sysFilter>
                    </input>
                  </container>
                  <input xpath="@viewType"/>
                  <input colspan="2" xpath="@img"/>
                  <input colspan="2" xpath="@rights"/>
                  <input colspan="2" xpath="@desc"/>
                </form>
              </input>
              <input xpath="@colspan"/>
              <static/>
            </container>
            <container label="Page footer">
              <static colspan="2" label="Page footer" type="separator"/>
              <input nolabel="true" xpath="footer"/>
            </container>
            <container colcount="2" label="Web page" xpath="urlPage">
              <static colspan="2" label="Web page" type="separator"/>
              <input colspan="2" xpath="@type"/>
              <container colspan="2" type="visibleGroup" visibleIf="@type='webApp'">
                <input createMode="none" img="nms:webApp.png" notifyPathList="@schema|../@webAppSchema" xpath="webApp">
                  <sysFilter>
                    <condition expr="@isModel=0"/>
                  </sysFilter>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@type='report'">
                <input colspan="2" createMode="none" img="xtk:report.png" xpath="report">
                  <sysFilter>
                    <condition expr="@isModel=0"/>
                  </sysFilter>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@type!='url' and @type!='none' and @type!='ajax'">
                <input xpath="@urlParam"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@type='url'">
                <input xpath="@url"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@type='ajax'">
                <input xpath="script/script"/>
                <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="ajaxParameters"/>
              </container>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type!='none' and @type!='ajax'">
                <input colspan="2" xpath="@width"/>
                <input colspan="2" xpath="@height"/>
                <container colcount="2" colspan="2" ref="xtk:dashboard:lib/imgTitle"/>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container type="iconbox">
        <container colcount="2" img="xtk:properties.png" label="General" readOnlyIf="@builtIn">
          <container colspan="2" type="visibleGroup" visibleIf="@builtIn">
            <container label="Warning" type="frame">
              <static type="warning">The following is a factory-configured object of the application and should not be edited. Please create and reference your own project.</static>
            </container>
          </container>
          <input xpath="@label"/>
          <input xpath="@name"/>
          <input discardReadOnly="true" xpath="@default"/>
          <static/>
          <container colcount="2" colspan="2" label="Menu" type="frame" xpath="menu">
            <input alias="menu" type="viewComboList" xpath="@name"/>
            <static/>
            <input alias="menu" type="viewComboList" xpath="@newMenu"/>
            <static label="'New' menu to be displayed first." type="help"/>
            <input xpath="@hiddenMenus"/>
            <static label="List of internal menu names (separated by a comma) not shown." type="help"/>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="desc"/>
        </container>
        <container img="xtk:dashboard.png" label="Views" readOnlyIf="@builtIn">
          <container colcount="2" type="notebookList" xpath="view" xpath-label="@label">
            <container colcount="2" colspan="2">
              <input xpath="@label"/>
              <input xpath="@name"/>
              <input xpath="@colspan"/>
              <input xpath="@height"/>
              <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath=".">
                <form label="Advanced parameters">
                  <input xpath="@hideBackground"/>
                  <input xpath="@rights"/>
                  <static label="List of required rights (separated by a comma) to display the view." type="help"/>
                </form>
              </input>
              <static/>
              <container colcount="2" colspan="2" type="notebook">
                <container colcount="2" colspan="2" label="Block" ref="xtk:dashboard:lib/view" visibleIf="EV([../@colspan], 'one')" xpath="left"/>
                <container colcount="2" colspan="2" label="Left-hand block" ref="xtk:dashboard:lib/view" visibleIf="EV([../@colspan], 'all')" xpath="left"/>
                <container colcount="2" colspan="2" label="Right-hand block" ref="xtk:dashboard:lib/view" visibleIf="EV([../@colspan], 'all')" xpath="right"/>
              </container>
            </container>
          </container>
        </container>
        <container img="xtk:operator.png" label="Operators">
          <input disableDefaultFilter="true" hideEditButtons="true" hideFilterBtn="true" img="xtk:operator.png" nolabel="true" toolbarCaption="Operators assigned to the dashboard" type="linklist" xpath="operator">
            <input xpath="[.]"/>
          </input>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Data transfer" md5="B054A756B0C2F5003D38719FE2DC432A" name="dataTransfer" namespace="xtk" type="iconbox" xtkschema="xtk:form">
      <container colcount="2" img="xtk:properties.png" label="General">
        <input xpath="@label"/>
        <input readOnly="true" xpath="@status"/>
        <value fontBold="true" xpath="@jobType"/>
        <value xpath="@startDate"/>
        <value xpath="@duration"/>
        <value xpath="@endDate"/>
        <static colspan="2" label="Job progress:"/>
        <value colspan="2" type="ProgressBar" xpathCur="properties/progress/@current" xpathMax="properties/progress/@max"/>
        <static colspan="2" label="Properties:"/>
        <input colspan="2" editable="false" nolabel="true" type="treeEdit">
          <container label="Counters and errors">
            <input xpath="properties/counters/@total"/>
            <input xpath="properties/counters/@processed"/>
            <input xpath="properties/counters/@successes"/>
            <input visibleIf="@jobType='import'" xpath="properties/counters/@empties"/>
            <input img="xtk:logerr.png" xpath="properties/counters/@errors"/>
            <input img="xtk:logwarn.png" xpath="properties/counters/@warnings"/>
            <input img="xtk:logerr.png" xpath="properties/counters/@rejected"/>
            <input img="xtk:logwarn.png" visibleIf="@jobType='import'" xpath="properties/counters/doubles/@count"/>
            <input img="xtk:logwarn.png" visibleIf="@jobType='import'" xpath="properties/counters/duplicates/@count"/>
            <input img="xtk:sql.png" visibleIf="@jobType='import' and [properties/counters/@sqlPreComplete] > 0" xpath="properties/counters/@sqlPreComplete"/>
            <input img="xtk:sql.png" visibleIf="@jobType='import' and [properties/counters/@sqlPostComplete] > 0" xpath="properties/counters/@sqlPostComplete"/>
          </container>
          <container collapsed="true" label="Low-level counters" visibleIf="@jobType='import'" xpath="properties/counters">
            <container label="Processed entities (XML level)" visibleIf="@jobType='import'">
              <input xpath="@entityInserted"/>
              <input xpath="@entityDeleted"/>
              <input xpath="@entityUpdated"/>
            </container>
            <container label="Records processed (at the SQL level)" visibleIf="@jobType='import'">
              <input xpath="@sqlInserted"/>
              <input xpath="@sqlDeleted"/>
              <input xpath="@sqlUpdated"/>
              <input xpath="@transactions"/>
            </container>
          </container>
          <container collapsed="true" label="Others">
            <input xpath="@internalName"/>
            <input xpath="@form"/>
          </container>
        </input>
        <static colspan="2" label="Description" type="separator"/>
        <input colspan="2" nolabel="true" xpath="desc"/>
      </container>
      <container img="xtk:logs.png" label="Journal">
        <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Log messages of the journal" type="linkList" xpath="log">
          <input xpath="@logDate"/>
          <input xpath="@message"/>
          <orderBy>
            <node expr="@id" sortDesc="true"/>
          </orderBy>
        </input>
      </container>
      <container img="xtk:reject.png" label="Rejects" xpath="/dataTransfer">
        <container type="hpaned">
          <input delButton="false" height-percent="75" hideEditButtons="true" img="xtk:reject.png" noToolbar="false" nolabel="true" type="linkList" xpath="reject" xpathId="/tmp/@rejectId">
            <input xpath="@rejectLogType"/>
            <input xpath="@logDate"/>
            <input xpath="@connectorType"/>
            <input xpath="@origin"/>
            <input xpath="message"/>
          </input>
          <container height-percent="25" xpath="/tmp/reject">
            <container type="visibleGroup" visibleIf="@origin=='textConnector'">
              <input label="Rejected line" type="edit" xpath="entity"/>
            </container>
            <input type="RejectTree" xpath="." xpathCalculatedFields="/dataTransfer/dataTransferStep/source/calculatedFields" xpathDataSourceConfig="/dataTransfer/dataTransferStep/source/dataSourceConfig" xpathLogField="/tmp/@logRejectField" xpathMapping="/dataTransfer/dataTransferStep/source/mappingConfig" xpathRejectId="/tmp/@rejectId"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:sqlSchema" entitySchema="xtk:form" img="xtk:createdb.png" label="Database Extension Wizard" md5="0AF30C12A35DB8B4E7D00B26EDF5965D" name="dbExtension" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Please specify the data from which you would like to create the auto-discovery." title="Database Extension Wizard">
        <enter>
          <if expr="[/content/@file] != ''">
            <set value="1" xpath="/tmp/@option"/>
          </if>
          <if expr="[/content/@file] == ''">
            <set value="0" xpath="/tmp/@option"/>
          </if>
          <set value="true" xpath="sqlDiffParam/@searchNewTables"/>
          <set value="wk%" xpath="sqlDiffParam/@whereFilter"/>
          <soapCall name="GetDefaultNamespace" service="xtk:builder">
            <param type="string" xpathOut="sqlDiffParam/@userNamespace"/>
          </soapCall>
          <soapCall name="GetDefaultNamespace" service="xtk:builder">
            <param type="string" xpathOut="sqlDiffParam/@defaultNamespace"/>
          </soapCall>
        </enter>
        <static label="This wizard allows to compare the physical structure of the database and its logical description (source schemas), in order to synchronize schemas with the database." type="help"/>
        <input checkedValue="0" label="Create a new auto-discovery" type="RadioButton" xpath="/tmp/@option"/>
        <input checkedValue="1" label="Refresh using an existing package" type="RadioButton" xpath="/tmp/@option"/>
        <container enabledIf="[/tmp/@option]=1" type="enabledGroup">
          <input filters="XML files (*.xml)|*.xml|All (*.*)|*.*|" label="File" title="Open XML content" type="fileedit" xpath="/content/@file" xpathLoadContent="/tmp/package"/>
        </container>
      </container>
      <container desc="Please specify the parameters of the auto-discovery and click on 'Next' to start it." name="autoDescParameters" title="Database Extension Parameters">
        <enter>
          <if expr="[/tmp/package/sqlDiffParam/@userNamespace] != ''">
            <set expr="[/tmp/package/sqlDiffParam/@userNamespace]" xpath="sqlDiffParam/@userNamespace"/>
          </if>
          <if expr="[/tmp/package/sqlDiffParam/@defaultNamespace] != ''">
            <set expr="[/tmp/package/sqlDiffParam/@defaultNamespace]" xpath="sqlDiffParam/@defaultNamespace"/>
          </if>
          <if expr="[/tmp/package/sqlDiffParam/@namespaceFilter] != ''">
            <set expr="[/tmp/package/sqlDiffParam/@namespaceFilter]" xpath="sqlDiffParam/@namespaceFilter"/>
          </if>
          <if expr="[/tmp/package/sqlDiffParam/@whereFilter] != ''">
            <set expr="[/tmp/package/sqlDiffParam/@whereFilter]" xpath="sqlDiffParam/@whereFilter"/>
          </if>
          <if expr="[/tmp/package/sqlDiffParam/@useNamingConventions] != ''">
            <set expr="[/tmp/package/sqlDiffParam/@useNamingConventions]" xpath="sqlDiffParam/@useNamingConventions"/>
          </if>
          <if expr="[/tmp/package/sqlDiffParam/@searchNewTables] != ''">
            <set expr="[/tmp/package/sqlDiffParam/@searchNewTables]" xpath="sqlDiffParam/@searchNewTables"/>
          </if>
        </enter>
        <container xpath="sqlDiffParam">
          <container label="New fields in existing tables" type="frame">
            <input xpath="@userNamespace"/>
            <static type="help">Each table being extended is associated by default to a schema with this namespace.</static>
          </container>
          <container label="New tables" type="frame">
            <input xpath="@searchNewTables"/>
            <container enabledIf="@searchNewTables=='true'" type="enabledGroup">
              <input xpath="@defaultNamespace"/>
              <static type="help">Newly discovered tables are associated by default with a schema belonging to this namespace.</static>
            </container>
          </container>
          <input label="Advanced parameters..." type="subFormLink" xpath=".">
            <form label="Advanced auto-discovery parameters">
              <container type="notebook">
                <container label="Filtering" propagateConstraints="false">
                  <container label="Namespaces filter" type="frame">
                    <input xpath="@namespaceFilter"/>
                    <static type="help">Tables for which the namespace of the associated schema is not in this list are ignored during the database structure auto-discovery.</static>
                  </container>
                  <container label="Filter on table names" type="frame">
                    <input xpath="@whereFilter"/>
                    <static type="help">Tables whose names match this filter are ignored.</static>
                  </container>
                  <input xpath="@useNamingConventions"/>
                </container>
              </container>
            </form>
          </input>
          <static label=" "/>
          <static label="Press 'Next' to start the auto-discovery." type="help"/>
        </container>
        <leave>
          <soapCall name="BuildSqlSchemaDiff" service="xtk:builder">
            <param exprIn="/sqlSchema/sqlDiffParam" type="DOMElement"/>
            <param exprIn="/tmp/package" type="DOMElement"/>
            <param type="DOMDocument" xpathOut="."/>
          </soapCall>
        </leave>
      </container>
      <container desc="Here are the tables for which the logical description does not match the physical structure." name="editTables" title="Edit tables">
        <input editable="false" enumImage="@diffStatus" noEditCollection="true" nolabel="true" toolbarCaption="Modified tables" type="diffList" xpath="table" zoom="true">
          <input colSize="20" xpath="@name"/>
          <input colSize="10" editable="true" type="checkBox" xpath="@commitDiff"/>
          <input xpath="@label"/>
          <input xpath="@hostSchema"/>
          <form entity-schema="xtk:sqlSchema" label="Edit table" name="extensionTable" namespace="xtk" readOnlyExpr="@commitDiff == false">
            <container colcount="2" label="Table description" type="frame">
              <value fontBold="true" label="Table" xpath="@name"/>
              <input label="Schema" xpath="@hostSchema"/>
              <input xpath="@label"/>
              <input xpath="@relXPath"/>
              <input colspan="2" xpath="@desc"/>
              <static colspan="2" label="These parameters specify the source schema and the path inside this schema where the element representing the table is located. An empty path means the root element of the schema." type="help"/>
            </container>
            <input editable="false" enumImage="@diffStatus" noEditCollection="true" nolabel="true" toolbarCaption="Modified fields" type="diffList" xpath="field" zoom="true">
              <input colSize="20" xpath="@name"/>
              <input colSize="10" editable="true" type="checkBox" xpath="@commitDiff"/>
              <input xpath="@label"/>
              <input xpath="@type"/>
              <input colSize="10" xpath="@length"/>
              <input xpath="@oldType"/>
              <input colSize="10" xpath="@oldLength"/>
              <form colcount="2" label="Field properties" readOnlyExpr="@commitDiff == false">
                <value colspan="2" fontBold="true" label="Field name" xpath="@name"/>
                <input colspan="2" xpath="@label"/>
                <input colspan="2" xpath="@desc"/>
                <container colcount="2" colspan="2" label="Field format" type="frame">
                  <input xpath="@type"/>
                  <container enabledIf="@type=='string'" type="enabledGroup">
                    <input xpath="@length"/>
                  </container>
                  <value xpath="@oldType"/>
                  <value xpath="@oldLength"/>
                </container>
                <input colspan="2" xpath="@relXPath"/>
                <input colspan="2" label="Default value" xpath="@default"/>
              </form>
            </input>
          </form>
        </input>
      </container>
      <container desc="Content of the package containing extended entities. You can save this package in a local file using the associated button." title="Extension result">
        <enter>
          <soapCall name="PatchSrcSchemas" service="xtk:sqlSchema">
            <param exprIn="[/sqlSchema]" type="DOMElement"/>
            <param type="DOMElement" xpathOut="/tmp/package"/>
          </soapCall>
          <set expr="[sqlDiffParam/@userNamespace]" xpath="/tmp/package/sqlDiffParam/@userNamespace"/>
          <set expr="[sqlDiffParam/@defaultNamespace]" xpath="/tmp/package/sqlDiffParam/@defaultNamespace"/>
          <set expr="[sqlDiffParam/@namespaceFilter]" xpath="/tmp/package/sqlDiffParam/@namespaceFilter"/>
          <set expr="[sqlDiffParam/@searchNewTables]" xpath="/tmp/package/sqlDiffParam/@searchNewTables"/>
          <set expr="[sqlDiffParam/@whereFilter]" xpath="/tmp/package/sqlDiffParam/@whereFilter"/>
          <set expr="[sqlDiffParam/@useNamingConventions]" xpath="/tmp/package/sqlDiffParam/@useNamingConventions"/>
        </enter>
        <input nolabel="true" type="sourceEdit" xpath="/tmp/package"/>
        <input img="xtk:save.png" label="Save the package content in a local file..." type="saveEntityButton" xpath="/tmp/package"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:report" entitySchema="xtk:form" img="xtk:form.png" label="Descriptive analysis wizard" md5="09E5F7DC28037F9D32D7516125AADE7A" name="descriptiveAnalysis" namespace="xtk" noNewInstance="true" nothingToEdit="true" nothingToSave="true" type="wizard" xpath="activities/page/analysis" xtkschema="xtk:form">
      <container desc="Please select the descriptive analysis template." img="xtk:report/report.png" title="Descriptive analysis configuration">
        <enter>
          <if expr="[/tmp/@mode]=''">
            <set value="new" xpath="/tmp/@mode"/>
          </if>
        </enter>
        <static img="nms:circle-one.png">Select a descriptive analysis template</static>
        <container type="visibleGroup" visibleIf="[/tmp/@displayExistingReport] != 'false'">
          <input checkedValue="report" label="Existing analyzes or reports" type="radioButton" xpath="/tmp/@mode"/>
          <input checkedValue="new" label="New descriptive analysis from a template" type="radioButton" xpath="/tmp/@mode"/>
        </container>
        <container enabledIf="[/tmp/@mode] = 'new'" type="enabledGroup">
          <input boldLineExpr="@builtIn = 1" choiceButton="true" createMode="none" defaultModel="qualitative" folderFilterChoice="@model = 'xtkReportModel'" form="xtk:report" fullLoad="true" img="xtk:report.png" label="Template" newFromModelOnChange="true" noZoom="true" schema="xtk:report" selectionPath="/tmp/model" type="linkEdit" xpath="/tmp/@model">
            <sysFilter>
              <condition expr="@type = 'descriptiveAnalysis'"/>
            </sysFilter>
            <orderBy>
              <node expr="@builtIn" sortDesc="true"/>
              <node expr="@label"/>
            </orderBy>
          </input>
          <input label="Title" xpath="../@label"/>
          <container colspan="2" maxLabelWidth="200" type="visibleGroup" visibleIf="EV(@model, 'qualitative')">
            <static img="nms:circle-two.png">Display mode</static>
            <container margin-left="10">
              <input xpath="@hasChart"/>
              <input xpath="@hasTable"/>
            </container>
          </container>
          <input img="xtk:properties.png" label="Advanced settings..." prebuildSubForm="false" type="subFormLink" xpath="data">
            <form label="Advanced parameters" maxLabelWidth="60">
              <enter>
                <if expr="[/report/activities/page/analysis/data/@schema]=''">
                  <set expr="[/tmp/@schema]" xpath="/report/activities/page/analysis/data/@schema"/>
                </if>
              </enter>
              <container type="visibleGroup" visibleIf="[/tmp/@useTemp]!=''">
                <input checkedValue="1" label="Use the work table of the workflow" nolabel="true" type="radioButton" xpath="/tmp/@useTemp"/>
                <input checkedValue="0" label="Use the targeting dimension" nolabel="true" type="radioButton" xpath="/tmp/@useTemp"/>
                <input expr="Iif([/tmp/@useTemp]==1, [/tmp/@targetSchema], [/tmp/@schema])" type="expr" xpath="@schema"/>
                <input label="Document type" readOnly="true" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
              </container>
              <container type="visibleGroup" visibleIf="[/tmp/@useTemp]=''">
                <input label="Document type" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
              </container>
              <input choiceType="sort" nolabel="true" toolbarAlign="horizontal" type="conditionList" xpath="where" xpathExpr="@expr" xpathHelp="/@helpCond" xpathSchema="@schema">
                <input colSize="15" label=" " xpath="/@bool-operator"/>
                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                <input colSize="15" label="Operator" xpath="/@operator"/>
                <input colSize="30" label="Value" xpath="/@rightExpr"/>
              </input>
              <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
              <leave>
                <if expr="[/tmp/@useTemp]=='1'">
                  <set value="" xpath="/tmp/@condition"/>
                </if>
                <if expr="[/tmp/@useTemp]=='0'">
                  <set expr="[/tmp/@schemaCondition]" xpath="/tmp/@condition"/>
                </if>
              </leave>
            </form>
          </input>
        </container>
        <leave>
          <if expr="[/tmp/@displaySchema] != ''">
            <set expr="[/tmp/@displaySchema]" xpath="/report/@schema"/>
          </if>
          <if expr="[/report/activities/page/analysis/data/@schema]=''">
            <set expr="[/tmp/@schema]" xpath="/report/activities/page/analysis/data/@schema"/>
          </if>
          <if expr="[/report/activities/page/analysis/data/sysFilter/condition/@sql]='' and [/tmp/@sql]!=''">
            <set expr="[/tmp/@sql]" xpath="/report/activities/page/analysis/data/sysFilter/condition/@sql"/>
          </if>
          <if expr="[/report/activities/page/analysis/data/sysFilter/condition/@expr]='' and [/tmp/@condition]!='' and [/tmp/@sql]=''">
            <set expr="[/tmp/@condition]" xpath="/report/activities/page/analysis/data/sysFilter/condition/@expr"/>
            <set value="fullCopy" xpath="/report/activities/page/analysis/data/sysFilter/@mode"/>
          </if>
        </leave>
      </container>
      <container desc="Please specify the table properties." img="xtk:report/report.png" title="Table configuration" visibleIf="[/tmp/@mode] = 'new' and [activities/page/analysis/@model] = 'qualitative' and [activities/page/analysis/@hasTable]">
        <enter>
          <set value="false" xpath="/tmp/@variableCountSetted"/>
        </enter>
        <container ref="xtk:formlib:pivot"/>
        <leave>
          <check expr="Count([data/variables/column/var]) > 0 or Count([data/variables/row/var]) > 0">
            <error>You must have at least one variable.</error>
          </check>
        </leave>
      </container>
      <container desc="Please specify the distribution properties." img="xtk:report/report.png" title="Table configuration" visibleIf="[activities/page/analysis/@model] = 'quantitative' and [/tmp/@mode] = 'new'">
        <enter>
          <set expr="[data/@schema]" xpath="data/@schema"/>
          <set value="distribution" xpath="@type"/>
        </enter>
        <container ref="xtk:formlib:distribution"/>
        <leave>
          <check expr="Count([data/variables/row/var])>0">
            <error>You must specify a variable.</error>
          </check>
          <check expr="IsNumber([data/variables/row/var/@expr], [data/@schema])">
            <error>The selected expression is not compatible. It must be numerical.</error>
          </check>
        </leave>
      </container>
      <container desc="Please enter the options for the chart" img="xtk:valuestats.png" title="Chart configuration" visibleIf="[/tmp/@mode] = 'new' and [activities/page/analysis/@model] = 'qualitative' and ([activities/page/analysis/@hasChart] and [activities/page/analysis/@hasTable] = false)">
        <enter>
          <if expr="[/tmp/@variableCountSetted] != true">
            <set expr="iif(Count([data/variables/row/var])>0,1,0)+iif(Count([data/variables/column/var])>0,1,0)" xpath="data/@variableCount"/>
            <set value="true" xpath="/tmp/@variableCountSetted"/>
          </if>
        </enter>
        <container ref="xtk:formlib:graphStyleAndData"/>
        <leave>
          <set expr="Count([data/variables/row/var]) == 1 and [data/variables/row/var/@expr] != ''" xpath="/ignored/@firstVarOk"/>
          <set expr="Count([data/variables/column/var]) == 1 and [data/variables/column/var/@expr] != ''" xpath="/ignored/@secondVarOk"/>
          <check expr="([data/@variableCount] == 1 and [/ignored/@firstVarOk]) or ([data/@variableCount] == 2 and [/ignored/@firstVarOk] and [/ignored/@secondVarOk])">
            <error>Some variables have not been defined.</error>
          </check>
        </leave>
      </container>
      <container desc="Please enter the options for the chart." img="xtk:report/report.png" title="Chart" visibleIf="[/tmp/@mode] = 'new' and [activities/page/analysis/@model] = 'qualitative' and ([activities/page/analysis/@hasChart] and [activities/page/analysis/@hasTable])">
        <container label="Chart type" type="frame">
          <container ref="xtk:formlib:graphStyle" xpath="chart"/>
        </container>
      </container>
      <container desc="Please specify the statistics to calculate." img="xtk:report/report.png" title="Statistics" visibleIf="[/tmp/@mode] = 'new'">
        <enter>
          <if expr="@model = 'qualitative'">
            <set expr="@hasChart and @hasTable = false" xpath="/tmp/@onlyChart"/>
          </if>
          <set expr="@model" xpath="/tmp/@analysisModel"/>
        </enter>
        <container ref="xtk:formlib:statistic" xpath="data/statistic"/>
      </container>
      <container desc="Display the results of the descriptive analysis" img="xtk:report/report.png" title="View">
        <container type="visibleGroup" visibleIf="[/tmp/@mode] = 'new'">
          <input type="analysisViewer"/>
        </container>
        <container img="xtk:report/report.png" type="visibleGroup" visibleIf="[/tmp/@mode] = 'report'">
          <input context="selection" label="List of existing analyzes" locationName="descriptiveAnalysis" type="reportPublisher" xpathRefSchema="/report/activities/page/analysis/data/@schema" xpathSchemaData="/tmp/extensions" xpathWhereCond="/report/activities/page/analysis/data/sysFilter"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form editionMode="dialog" entity-schema="xtk:dictionaryString" entitySchema="xtk:form" img="xtk:form.png" label="Translation" md5="B3730BC85436BA0569CB0CFD43DA1E2B" name="dictionary" namespace="xtk" xtkschema="xtk:form">
      <enter>
        <if expr="[/ignored/dictionaryString/@context] != ''">
          <set expr="[/ignored/dictionaryString/@context]" xpath="@context"/>
        </if>
        <if expr="[/ignored/dictionaryString/@sourceId] != ''">
          <set expr="[/ignored/dictionaryString/@sourceId]" xpath="@sourceId"/>
        </if>
      </enter>
      <container type="visibleGroup" visibleIf="[sourceString/@text] != ''">
        <input label="Source" type="separator"/>
        <input nolabel="true" readOnly="true" xpath="sourceString/@text"/>
      </container>
      <container>
        <input label="Translation" type="separator"/>
        <container readOnlyIf="[/ignored/tmp/dictionary/@global] != true" type="readOnlyGroup">
          <input xpath="@locale"/>
        </container>
        <container type="visibleGroup" visibleIf="@status != 3">
          <input nolabel="true" xpath="@text"/>
          <input expr="iif(@status=2, 2, iif(@text!='', 1, 0))" type="expr" xpath="@status"/>
          <input checkedValue="2" label="Translation approved" nolabel="true" type="checkBox" unCheckedValue="0" xpath="@status"/>
        </container>
        <container type="visibleGroup" visibleIf="@status == 3">
          <input nolabel="true" readOnly="true" xpath="@text"/>
        </container>
      </container>
      <leave>
        <set expr="Md5Digest(@text)" xpath="@md5"/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dictionaryString" entitySchema="xtk:form" img="xtk:form.png" label="Dictionary" md5="7FAF8817662D746B1EB61705D152F73E" name="dictionaryGlobal" namespace="xtk" xtkschema="xtk:form">
      <enter name="add">
        <set value="true" xpath="/tmp/dictionary/@global"/>
        <set expr="iif(@context = '', 'global', @context)" xpath="@context"/>
      </enter>
      <container readOnlyIf="@context != 'system' and @context != 'global'" type="readOnlyGroup">
        <input label="Definition of the source in the dictionary" type="separator"/>
        <container colcount="4">
          <input xpath="@locale"/>
          <input xpath="@status"/>
          <input xpath="@sourceId"/>
        </container>
        <input lineCount="3" nolabel="true" xpath="@text"/>
      </container>
      <container>
        <input label="Available translations" type="separator"/>
        <input enumImage="@status" form="xtk:dictionary" hideEditButtons="false" nolabel="true" propagateXPathToCtx="/tmp/dictionary/@global,@context,@sourceId" type="linkList" xpath="translations" zoom="true">
          <input xpath="@status"/>
          <input xpath="@locale"/>
          <input xpath="@text"/>
        </input>
      </container>
      <leave>
        <set expr="Md5Digest(@text)" xpath="@md5"/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:import32.png" label="Downloading files referenced in a data transfer" md5="6AF6B78DA1B6FB7A9C6CC02DE839C0AC" name="downloadDataTransferFiles" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Select the files used by this transfer that you want to download in the list below." name="fileList" title="Select files">
        <enter>
          <soapCall name="GetFilesToDownload" service="xtk:dataTransfer">
            <param exprIn="[/dataTransfer/@id]" type="int"/>
            <param type="DOMElement" xpathOut="properties/filesToDownload"/>
            <param type="DOMElement" xpathOut="properties/filesNotToDownload"/>
          </soapCall>
        </enter>
        <static>Files which can be downloaded:</static>
        <input editable="false" noEditCollection="true" noToolbar="true" nolabel="true" type="list" xpath="properties/filesToDownload/file" zoom="false">
          <input colSize="10" editable="true" xpath="@active"/>
          <input colSize="50" editable="true" type="saveFileEdit" xpath="@originalName"/>
          <input colSize="30" xpath="@serverName"/>
          <input colSize="10" xpath="@size"/>
          <input colSize="20" xpath="@lastModified"/>
        </input>
        <static>Files that cannot be downloaded:</static>
        <input editable="false" img="xtk:noentry.png" noEditCollection="true" noToolbar="true" nolabel="true" type="list" xpath="properties/filesNotToDownload/fileImpossible" zoom="false">
          <input colSize="30" xpath="@serverName"/>
          <input xpath="@reason"/>
        </input>
      </container>
      <container desc="Click on 'Start' to launch the file download." name="finish" title="Downloading files">
        <enter>
          <set value="0" xpath="properties/progress/@current"/>
          <set value="1" xpath="properties/progress/@max"/>
        </enter>
        <container methodName="NONE" onlyDownloadMode="true" type="dataTransferSubmitContainer" xpathCurProgress="properties/progress/@current" xpathMaxProgress="properties/progress/@max">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatButton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Enumeration" md5="204F5CAD3B61B912EB7C888CC5DE1B41" name="enum" namespace="xtk" xpathsToLoad="@aliases,@classBinning,@lastAliasCleansing" xtkschema="xtk:form">
      <enter>
        <set expr="iif ([@classBinning]=1, 'binning', iif([@aliases]=1, 'alias', 'noalias'))" xpath="/tmp/@subtype"/>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="values">
          <input img="xtk:enumVal.png" name="list" nolabel="true" propagateXPathToCtx="@type,/tmp/@subtype" propagateXPathToCtxOnAdd="@type,/tmp/@subtype" toolbarCaption="List of enumeration values" type="linkList" xpath="value" zoom="true">
            <input xpath="@label"/>
          </input>
        </container>
        <container name="general">
          <input xpath="@label"/>
          <input xpath="@name"/>
          <input xpath="@type"/>
          <static label="The open type makes it possible to add a new enumeration value directly in the corresponding field." type="help"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'system')=false">
            <container colcount="2" colspan="2">
              <input checkedValue="noalias" label="Simple enumeration" type="RadioButton" xpath="/tmp/@subtype"/>
              <static label="" type=""/>
              <input checkedValue="alias" label="Alias cleansing" type="RadioButton" xpath="/tmp/@subtype"/>
              <static label="Alias cleansing enables you to harmonize the enumeration values stored in the database." type="help"/>
              <input checkedValue="binning" label="Reserved for binning" type="RadioButton" xpath="/tmp/@subtype"/>
              <static label="This option allows you to dynamically link cube values to this enumeration." type="help"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@subtype] == 'noalias'">
              <container ref="xtk:enum:lib/values"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@subtype] != 'noalias'">
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/@subtype] == 'alias'">
                <input form="xtk:aliasCleansing" img="nms:prepare.png" label="Cleanse values..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="."/>
              </container>
              <container colspan="2" type="notebook">
                <container label="Values" ref="xtk:enum:lib/values"/>
                <container label="Alias" visibleIf="[/tmp/@subtype] == 'alias'">
                  <input form="xtk:enumAlias" img="nms:coupon.png" name="alias" nolabel="true" propagateXPathToCtx="/tmp/@subtype" propagateXPathToCtxOnAdd="/tmp/@subtype" toolbarCaption="List of aliases" type="linkList" xpath="aliases" zoom="true">
                    <input label="Alias" xpath="@label"/>
                    <input label="Value" xpath="enumValue"/>
                    <input label="Hits" xpath="@hits"/>
                    <input xpath="@lastModified"/>
                    <orderBy>
                      <node expr="@hits" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container label="Alias" visibleIf="[/tmp/@subtype] == 'binning'">
                  <input form="xtk:enumAlias" img="nms:coupon.png" name="alias" nolabel="true" propagateXPathToCtx="/tmp/@subtype" propagateXPathToCtxOnAdd="/tmp/@subtype" toolbarCaption="List of aliases" type="linkList" xpath="aliases" zoom="true">
                    <input label="Alias" xpath="@label"/>
                    <input label="Class" xpath="enumValue"/>
                    <input xpath="@lastModified"/>
                  </input>
                </container>
              </container>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV(@type, 'system')">
            <input img="xtk:enumVal.png" name="systemList" nolabel="true" propagateXPathToCtxOnAdd="@type" toolbarCaption="List of enumeration values" type="linklist" xpath="value" zoom="true">
              <input xpath="@name"/>
              <input xpath="@label"/>
              <input xpath="@img"/>
            </input>
          </container>
        </container>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@subtype] == 'noalias'">
        <container colcount="2" ref="xtk:enum:lib/general"/>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@subtype] != 'noalias'">
        <container type="iconbox">
          <container colcount="2" img="xtk:properties.png" label="General" ref="xtk:enum:lib/general"/>
          <container img="xtk:logs.png" label="Log">
            <input addButton="false" delButton="true" enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" toolbarCaption="Cleansing log" type="linklist" xpath="log" zoom="true">
              <input colSize="30" xpath="@logDate"/>
              <input colSize="30" xpath="@message"/>
              <orderBy>
                <node expr="@logDate" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
        </container>
      </container>
      <leave>
        <if expr="[/tmp/@subtype]='noalias'">
          <set value="false" xpath="@aliases"/>
          <set value="false" xpath="@classBinning"/>
        </if>
        <if expr="[/tmp/@subtype]='alias'">
          <set value="true" xpath="@aliases"/>
          <set value="false" xpath="@classBinning"/>
        </if>
        <if expr="[/tmp/@subtype]='binning'">
          <set value="true" xpath="@aliases"/>
          <set value="true" xpath="@classBinning"/>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:enumAlias" entitySchema="xtk:form" img="xtk:form.png" label="Alias" md5="2B6DFEF2CAE405CD27EA196C3C0D45FB" name="enumAlias" namespace="xtk" xpathsToLoad="@enum-id" xtkschema="xtk:form">
      <enter>
        <set expr="[enumValue/@id]" xpath="/tmp/@oldValueId"/>
        <set expr="[/ignored/tmp/@subtype]" xpath="/tmp/@subtype"/>
      </enter>
      <container margin="8">
        <container type="visibleGroup" visibleIf="[/tmp/@subtype]!='binning'">
          <static type="warning">Warning, the replaced data will not be saved.</static>
        </container>
        <input label="Alias" xpath="@label"/>
        <input createMode="none" label="Value" notifyPathList="@enum-id" xpath="enumValue">
          <sysFilter>
            <condition expr="[@enum-id]=$(@enum-id)"/>
          </sysFilter>
        </input>
      </container>
      <leave>
        <if expr="[enumValue/@id]!=0 and [/tmp/@subtype]!='binning'">
          <msgBox translatedExpr="'Do you really want to replace \'' + @label + '\' with \'' + [enumValue] + '\'.'" type="yesno" xpathOut="/ignored/@resMsgBox"/>
          <check expr="[/ignored/@resMsgBox]='yes'">
            <error>Save canceled by the user</error>
          </check>
        </if>
        <check expr="[/tmp/@subtype]!='binning' or [enumValue/@id]!=0">
          <error>You must specify a value</error>
        </check>
      </leave>
      <postSave>
        <if expr="[/tmp/@oldValueId]!=[enumValue/@id]">
          <set value="xtk:enum" xpath="/ignored/writer/enum/@xtkschema"/>
          <set value="update" xpath="/ignored/writer/enum/@_operation"/>
          <set expr="[@enum-id]" xpath="/ignored/writer/enum/@id"/>
          <set expr="'1970-01-01'" xpath="/ignored/writer/enum/@lastAliasCleansing"/>
          <soapCall name="Write" service="xtk:persist">
            <param exprIn="[/ignored/writer/enum]" type="DOMDocument"/>
          </soapCall>
        </if>
      </postSave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form editionMode="dialog" entitySchema="xtk:form" img="xtk:form.png" label="Enumeration value" md5="9FF5B1838D21F357D788813BF47B8D48" name="enumValue" namespace="xtk" xpathsToLoad="@enum-id,enum/@type" xtkschema="xtk:form">
      <enter>
        <set expr="[@enum-id]" xpath="/tmp/@enum-id"/>
        <set expr="iif ([/ignored/enum/@type]!='', [/ignored/enum/@type], iif ([enum/@type]!='', [enum/@type], ''))" xpath="/tmp/@enumType"/>
        <set expr="[/ignored/tmp/@subtype]" xpath="/tmp/@subtype"/>
      </enter>
      <container margin="8" type="visibleGroup" visibleIf="[/tmp/@enumType]!=2 and [/tmp/@subtype]!='binning'">
        <input xpath="@label"/>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@enumType]=2">
        <input xpath="@name"/>
        <input xpath="@label"/>
        <input xpath="@img"/>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@enumType]!=2 and [/tmp/@subtype]=='binning'">
        <input xpath="@name"/>
        <input xpath="@label"/>
      </container>
      <leave>
        <check expr="@label!=''">
          <error>You must specify a label.</error>
        </check>
        <check expr="@name!='' or ([/tmp/@enumType]!=2 and [/tmp/@subtype]!='binning')">
          <error>You must specify an internal name.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:export32.png" label="Data export" md5="F335D9F8D93D9B0128ECD6E56B890E12" name="export" namespace="xtk" noNewInstance="true" type="wizard" xpathsToLoad="@isModel,@jobType,@form,@editForm,@status,@img,@modelName" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/tmp/@firstPageVisible"/>
        <set value="0" xpath="/tmp/@execFromModel"/>
        <set expr="(@id != 0)" xpath="/tmp/@editingInstance"/>
        <set value="0" xpath="/tmp/@saveAsModel"/>
        <set value="0" xpath="/tmp/processId"/>
        <set value="0" xpath="/tmp/@modelId"/>
        <set value="xtk:dataTransfer" xpath="@form"/>
        <set value="xtk:dataTransfer" xpath="/tmp/schema/@job"/>
        <set value="xtk:export" xpath="@editForm"/>
        <set value="export" xpath="@jobType"/>
        <set value="xtk:dataTransfer" xpath="@xtkschema"/>
        <set value="xtk:export.png" xpath="@img"/>
        <set value="select" xpath="/tmp/@choiceType"/>
        <set value="0" xpath="/tmp/@newFromWebApp"/>
        <set value="1" xpath="/tmp/selectCtrl/in/@allowGroupBy"/>
      </enter>
      <container name="hidden" type="visibleGroup" visibleIf="false">
        <container name="advancedParameters" type="notebook">
          <container label="General" propagateConstraints="false">
            <input xpath="@outOfProcess"/>
            <static type="separator"/>
            <input xpath="@timezone"/>
          </container>
          <container ref="xtk:import:hidden/advancedParameters/variables"/>
        </container>
      </container>
      <container desc="The export can be based on parameters previously saved as an export template. Please select the default template to start a brand new export." name="script" title="Template selection" visibleIf="([/tmp/processId] != 0 or [/tmp/@newFromWebApp] = 1 or [/tmp/@firstPageVisible]) and  [/tmp/@saveAsModel] == false and [/tmp/@execFromModel] == false">
        <enter>
          <set value="1" xpath="/tmp/@firstPageVisible"/>
        </enter>
        <container type="visibleGroup" visibleIf="[/tmp/processId] != 0 or [/tmp/@newFromWebApp] = 1 or ([/tmp/@execFromModel] == false and [/tmp/@editingInstance] == false)">
          <static img="nms:circle-one.png">Select an export template</static>
          <input boldLineExpr="@builtIn = 1" choiceButton="true" createMode="none" defaultModel="newExport" folderFilterChoice="@model = 'xtkJobModel'" form="xtk:export" fullLoad="true" img="xtk:export.png" label="Export template" newFromModelOnChange="true" noZoom="true" schema="xtk:job" type="linkEdit" xpath="/tmp/@model">
            <sysFilter>
              <condition expr="@isModel = 1 and @jobType = 'export'"/>
            </sysFilter>
            <orderBy>
              <node expr="@builtIn" sortDesc="true"/>
              <node expr="@label"/>
            </orderBy>
          </input>
        </container>
        <container enabledIf="[/tmp/@modelId] != 0 or [/tmp/@execFromModel] or ([/tmp/@editingInstance] and [/tmp/processId] = 0)" type="EnabledGroup">
          <container type="visibleGroup" visibleIf="[/tmp/processId] != 0 or ([/tmp/@execFromModel] == false and [/tmp/@editingInstance] == false)">
            <static img="nms:circle-two.png">Complete or modify parameters</static>
          </container>
          <input xpath="@label"/>
          <input xpath="desc"/>
          <input xpath="@exportType"/>
          <static label=" " nolabel="false" type="help">A simple export allows to export data from a single document type. To export from multiple document types, select multiple export.</static>
          <container type="visibleGroup" visibleIf="@isModel">
            <input xpath="@internalName"/>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/processId] = 0">
            <input img="xtk:job.png" label="Folder" writeAccess="true" xpath="folder">
              <sysFilter>
                <condition expr="@model = 'xtkJobInstance'"/>
              </sysFilter>
            </input>
          </container>
        </container>
        <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink">
          <form label="Advanced parameters">
            <container ref="xtk:export:hidden/advancedParameters"/>
          </form>
        </input>
        <leave>
          <check expr="([/tmp/@editingInstance] and [/tmp/processId] = 0) or [/tmp/@execFromModel] = 1 or ([/tmp/@execFromModel] = 0 and [/tmp/@modelId] != 0)">
            <error>You must specify an export template.</error>
          </check>
          <if expr="[/tmp/processId] != 0">
            <set expr="[/tmp/processId]" xpath="@folder-id"/>
            <set value="0" xpath="@folderProcess-id"/>
          </if>
          <check expr="[@folder-id] != 0">
            <error>You must specify an execution folder.</error>
          </check>
        </leave>
      </container>
      <container desc="Please specify the export description, type and the folder where information about its execution is saved." name="general" title="Export definition" visibleIf="[/tmp/@firstPageVisible]=0">
        <container ref="xtk:import:general/warningBuiltIn"/>
        <input xpath="@label"/>
        <input xpath="desc"/>
        <input xpath="@exportType"/>
        <static label=" " nolabel="false" type="help">A simple export allows to export data from a single document type. To export from multiple document types, select multiple export.</static>
        <container type="visibleGroup" visibleIf="@isModel">
          <input xpath="@internalName"/>
        </container>
        <container type="visibleGroup" visibleIf="![/tmp/@saveAsModel] and [/tmp/@execFromModel]">
          <input img="xtk:job.png" label="Folder" xpath="folder">
            <sysFilter>
              <condition expr="@model = 'xtkJobInstance'"/>
            </sysFilter>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="![/tmp/@saveAsModel] and @isModel">
          <input label="Folder" xpath="folderProcess">
            <sysFilter>
              <condition expr="@model = 'xtkJobInstance'"/>
            </sysFilter>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="[/tmp/@saveAsModel]">
          <input label="Folder" setDefault="true" xpath="folder">
            <sysFilter>
              <condition expr="@model = 'xtkJobModel'"/>
            </sysFilter>
          </input>
        </container>
        <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink">
          <form label="Advanced parameters">
            <container ref="xtk:export:hidden/advancedParameters"/>
          </form>
        </input>
        <leave>
          <check expr="(@isModel=false and [/tmp/@execFromModel]=false) or [/tmp/@saveAsModel] or ([/tmp/@saveAsModel]=false and @isModel and [@folderProcess-id]!=0) or ([/tmp/@saveAsModel]=false and [/tmp/@execFromModel] and [@folder-id]!=0)">
            <error>You must specify an execution folder.</error>
          </check>
        </leave>
      </container>
      <container desc="Please edit the list of export steps" name="batch" title="Export scripts" visibleIf="@exportType = 'batch'">
        <input editable="false" form="xtk:exportSource" img="xtk:script.png" nolabel="true" toolbarAlign="vertical" type="list" xpath="dataTransferStep" zoom="true" zoomOnAdd="true">
          <input xpath="@name"/>
          <input editable="true" xpath="@active"/>
        </input>
      </container>
      <container ref="xtk:exportSource:srcInfo" visibleIf="@exportType = 'simple'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:destInfo" visibleIf="@exportType = 'simple'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:column" visibleIf="@exportType = 'simple'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:sort" visibleIf="@exportType = 'simple'" xpath="dataTransferStep[1]"/>
      <container firstActivatedIf="count([dataTransferStep/source/where]) == 0" ref="xtk:exportSource:filter" visibleIf="@exportType = 'simple'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:targetPage" visibleIf="@exportType = 'simple'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:conditionLink" visibleIf="@exportType = 'simple' AND [dataTransferStep/source/conditionLink/@xpath]!=''" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:group" visibleIf="@exportType = 'simple' AND [/tmp/selectCtrl/out/@group]" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:having" visibleIf="@exportType = 'simple' AND [/tmp/selectCtrl/out/@group]" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:mapping" visibleIf="@exportType = 'simple' AND EV([dataTransferStep/destination/exportFormat/@format], 'text', 'csv', 'fixed')" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:preview" visibleIf="@exportType = 'simple'" xpath="dataTransferStep[1]"/>
      <container desc="Click on 'Start' to launch the export of the data." name="finish" title="Data export execution" visibleIf="!@isModel">
        <container methodName="Start" type="dataTransferSubmitContainer" xpathCurProgress="properties/progress/@current" xpathDestName="dataTransferStep/destination/@remoteSourceName" xpathMaxProgress="properties/progress/@max" xpathsToLoad="dataTransferStep/destination/@type">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2" xpath="properties/counters">
            <value xpath="@processed"/>
            <value xpath="@rejected"/>
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:export32.png" label="Export list" md5="BC11EADDFA72CC51236E34B5D631A0BB" name="exportList" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="export" xpath="@jobType"/>
        <set value="simple" xpath="@exportType"/>
        <set value="exportList" xpath="dataTransferStep[1]/@name"/>
        <set value="true" xpath="dataTransferStep[1]/@active"/>
        <set value="xtk:export" xpath="@editForm"/>
        <set value="xtk:dataTransfer" xpath="@xtkschema"/>
        <set value="xtk:export.png" xpath="@img"/>
        <set value="xtk:dataTransfer" xpath="@form"/>
        <set value="" xpath="@folder-id"/>
      </enter>
      <container ref="xtk:exportSource:column" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:mapping" visibleIf="true" xpath="dataTransferStep[1]"/>
      <container desc="Select destination file." name="srcInfo" title="File to export" xpath="dataTransferStep[1]">
        <enter>
          <set value="xtkDataStore" xpath="source/@type"/>
          <set value="text" xpath="destination/@type"/>
        </enter>
        <input xpath="destination/@downloadDestFile"/>
        <container type="visibleGroup" visibleIf="[destination/@downloadDestFile]">
          <input dlgType="save" filters="Text files (*.txt;*.tab)|*.txt;*.tab|CSV files (*.csv)|*.csv|XML files (*.xml)|*.xml|All (*.*)|*.*|" label="Local file" type="fileEdit" xpath="destination/@dataSourceName" xpathCopyName="@name"/>
        </container>
        <container type="visibleGroup" visibleIf="[destination/@downloadDestFile] == 'false'">
          <input label="Server file" xpath="destination/@dataSourceName"/>
        </container>
        <leave>
          <check expr="[destination/@dataSourceName] != ''">
            <error>You must specify the destination file</error>
          </check>
        </leave>
      </container>
      <container ref="xtk:exportSource:destInfo" xpath="dataTransferStep[1]"/>
      <container desc="Click on 'Start' to launch the export of the data." name="finish" title="Destination format">
        <container methodName="Start" type="dataTransferSubmitContainer" xpathCurProgress="properties/progress/@current" xpathDestName="dataTransferStep/destination/@remoteSourceName" xpathMaxProgress="properties/progress/@max">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2" xpath="properties/counters">
            <value xpath="@processed"/>
            <value xpath="@rejected"/>
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <input label="Advanced parameters..." type="subFormLink">
            <form label="Advanced parameters">
              <input xpath="@outOfProcess"/>
              <input useDesc="true" xpath="@doNotPersist"/>
              <container type="visibleGroup" visibleIf="!@doNotPersist">
                <input xpath="folderProcess">
                  <sysFilter>
                    <condition expr="@model = 'xtkJobInstance'"/>
                  </sysFilter>
                </input>
              </container>
              <leave>
                <if expr="@doNotPersist==false">
                  <set expr="[@folderProcess-id]" xpath="@folder-id"/>
                </if>
              </leave>
            </form>
          </input>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatButton"/>
          </container>
        </container>
      </container>
      <leave>
        <check expr="[/tmp/@inProcess] = false">
          <error>Job in progress. Please cancel before you can quit.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:import32.png" label="Data transfer" md5="B917F86213698DA6F805BE2B27915379" name="exportSource" namespace="xtk" type="wizard" xtkschema="xtk:form">
      <container desc="Enter the type of document to export and the destination file." name="srcInfo" title="File to export">
        <enter>
          <set value="xtkDataStore" xpath="source/@type"/>
          <set value="text" xpath="destination/@type"/>
          <if expr="[source/@schema]==''">
            <set value="nms:recipient" xpath="source/@schema"/>
          </if>
        </enter>
        <input label="Document type" schema="xtk:schema" type="schemaEdit" xpath="source/@schema" xpathStartPath="source/@startPath"/>
        <input xpath="destination/@downloadDestFile"/>
        <container type="visibleGroup" visibleIf="[destination/@downloadDestFile]">
          <input defExt="txt" filters="Text files (*.txt;*.tab)|*.txt;*.tab|CSV files (*.csv)|*.csv|XML files (*.xml)|*.xml|All (*.*)|*.*|" label="Local file" type="saveFileEdit" xpath="destination/@dataSourceName" xpathCopyName="@name"/>
        </container>
        <container type="visibleGroup" visibleIf="[destination/@downloadDestFile] == 'false'">
          <input label="Server file" xpath="destination/@dataSourceName"/>
        </container>
        <input xpath="@name"/>
        <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath="source">
          <form label="Advanced parameters" maxLabelWidth="60">
            <container type="notebook">
              <container label="General">
                <input xpath="@lineCount"/>
              </container>
              <container label="Differential export" xpath="differential">
                <input nolabel="true" useDesc="true" xpath="@active"/>
                <static type="help">The differential export is used to export only records modified since the last execution date. To use it, you have to specify the field which contains the last modification date.</static>
                <container type="visibleGroup" visibleIf="@active">
                  <input choiceType="xpath" hideCalculated="true" hideMappedAsXml="true" nolabel="false" type="pathEdit" xpath="lastModified" xpathSchema="../@schema"/>
                  <input label="Force the option name" xpath="@option"/>
                  <static type="help">The option stores the last execution date of the export. You can force its name or leave the field blank so that a default name is automatically computed.</static>
                </container>
              </container>
            </container>
          </form>
        </input>
        <container type="visibleGroup" visibleIf="[source/differential/@active]">
          <static fontBold="true" label=" " nolabel="false" type="warning">Differential export activated</static>
        </container>
        <leave>
          <check expr="[source/@schema] != ''">
            <error>Please specify the type of document to export.</error>
          </check>
          <check expr="[@name] != ''">
            <error>You must specify the internal name for the export job.</error>
          </check>
        </leave>
      </container>
      <container desc="Please enter the output format and enter the parameters of the output format of file to be exported." name="destInfo" title="Destination format" xpath="destination/exportFormat">
        <container colcount="2" name="exportFormat" xpathsToLoad="*">
          <input xpath="@format"/>
          <static/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@format, 'text', 'csv', 'fixed')">
            <container colspan="2" type="visibleGroup" visibleIf="EV(@format, 'text', 'csv')">
              <input xpath="@saveTitle"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@format, 'text', 'fixed')">
              <container type="visibleGroup" visibleIf="EV(@format, 'text')">
                <input xpath="@separator"/>
                <static/>
                <container type="visibleGroup" visibleIf="@separator=='other'">
                  <input xpath="@otherSep"/>
                </container>
                <static/>
                <input xpath="@delimitor"/>
                <static/>
                <input xpath="@lineEnd"/>
                <static/>
              </container>
            </container>
          </container>
          <input xpath="@codepage"/>
          <static/>
          <input label="Date format" type="dateFormatPreview" xpath="dataFormat"/>
          <input label="Edit..." prebuildSubForm="false" type="subFormLink" xpath="dataFormat">
            <form label="Edit date format">
              <input label="Date sample" type="dateFormatPreview" xpath="."/>
              <input xpath="@sepDate"/>
              <input enum="xtk:dataTransfer:dateFormatExport" xpath="@orderDate"/>
              <input xpath="@yearShort"/>
              <input xpath="@sepDateTime"/>
              <input xpath="@hideTime"/>
              <container type="visibleGroup" visibleIf="@hideTime==false">
                <input xpath="@sepTime"/>
                <input xpath="@showSec"/>
                <container enabledIf="@showSec" type="enabledGroup">
                  <input xpath="@showMs"/>
                </container>
              </container>
            </form>
          </input>
          <input label="Number format" type="doubleFormatPreview" xpath="dataFormat"/>
          <input label="Edit..." prebuildSubForm="false" type="subFormLink" xpath="dataFormat">
            <form label="Edit number format">
              <input label="Number sample" type="doubleFormatPreview" xpath="."/>
              <input xpath="@sepThousand"/>
              <input xpath="@sepNumber"/>
              <input xpath="@decimalCount"/>
            </form>
          </input>
          <input colspan="2" useDesc="true" xpath="@analyze"/>
          <container colspan="2" type="visibleGroup" visibleIf="EV(@format, 'fixed')">
            <input img="xtk:properties.png" label="Advanced parameters..." type="subFormLink" xpath=".">
              <form label="Advanced parameters">
                <input xpath="@lineWidth"/>
                <static label="You can specify the length of the lines to export. Lines will be padded with spaces if necessary."/>
                <input xpath="@lineEnd"/>
              </form>
            </input>
          </container>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="EndWith([../@dataSourceName],'.xml') and EV(@format, 'xml') == false">
          <static type="warning">The output file extension '.xml' does not match the format you have selected.</static>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="EndWith([../@dataSourceName],'.csv') and EV(@format, 'csv') == false and ( EV(@format, 'text') == false or EV(@separator,'sepPointComma','sepComma') == false or EV(@delimitor,'delSimpleQuote') )">
          <static type="warning">The output file extension '.csv' does not match the format you have selected.</static>
        </container>
      </container>
      <container desc="Select the columns to extract for the export (used to generate the SELECT part of the SQL statement)." name="column" title="Data to extract" xpath="source">
        <enter>
          <set expr="@schema" xpath="/tmp/selectCtrl/in/@schema"/>
          <set expr="@startPath" xpath="/tmp/selectCtrl/in/@startPath"/>
          <set value="export" xpath="/tmp/selectCtrl/in/@choiceType"/>
        </enter>
        <container allowDistinct="true" allowGroupBy="true" allowUnexpandMemo="true" extraColumns="@groupBy, @alias" ref="xtk:queryDef:hidden/selectCtrl" showCollections="true"/>
        <leave>
          <if expr="[/tmp/selectCtrl/out/@group] == false">
            <reset xpath="groupBy"/>
            <reset xpath="having"/>
          </if>
        </leave>
      </container>
      <container desc="Please specify the data filtering conditions (used to generate the WHERE part of the SQL statement)." name="filter" title="Data filtering">
        <container name="filterList">
          <static label="List of restriction filters" type="separator"/>
          <input dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" selectFirstFilter="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="source/@schema" xpathWhere="source/where"/>
        </container>
      </container>
      <container desc="Please enter the definition of the target element" img="nms:pictoprofile.png" name="targetPage" title="Target element">
        <container name="targetPageFocus" style="flat" type="notebook">
          <container label="Criteria">
            <static label="Filter settings" type="separator"/>
            <input type="filterView" xpath="source" xpathFilter="/ignored/@filterName" xpathSchema="source/@schema" xpathSchemaData="/tmp/@schemaDataXPath"/>
          </container>
          <container label="Preview">
            <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="/ignored/previewList" xpathSchema="source/@schema" xpathSchemaData="/tmp/@schemaDataXPath" xpathTargetPart="source"/>
          </container>
        </container>
        <leave>
          <set value="" xpath="/ignored/@filterName"/>
        </leave>
      </container>
      <container name="conditionLink" ref="xtk:exportSource:lib/conditionLinkRef" xpath="source"/>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container desc="Please enter the filtering and sort conditions for each collection link." name="conditionLinkRef" title="Collection personalization information">
          <input alwaysActive="true" editable="false" img="xtk:xtklinkn.png" noEditCollection="true" nolabel="true" type="customizeCondition" xpath="conditionLink" xpathSchema="@schema" xpathSelect="select/node" xpathStartPath="@startPath" zoom="true">
            <input xpath="@label"/>
            <input xpath="@lineCount"/>
            <input xpath="where/@displayFilter"/>
            <input xpath="orderBy/@displayOrder"/>
            <input hidden="true" xpath="@schema"/>
            <form label="Filtering for a collection of personalization information" type="wizard">
              <enter>
                <if expr="@singleRow=''">
                  <set value="0" xpath="@singleRow"/>
                </if>
              </enter>
              <container desc="Enter information used to specify how many collection elements you want to keep." img="xtk:report/editor/insertColumnRight.png" name="parameters" title="General parameters">
                <input enum="xtk:dataTransfer:rowConditionType" label="Data collected" type="sysEnum" xpath="@singleRow"/>
                <container type="visibleGroup" visibleIf="@singleRow==0">
                  <input label="Lines to retrieve" xpath="@lineCount"/>
                </container>
                <container backcolor="tooltip" type="visibleGroup" visibleIf="@singleRow==1">
                  <static type="warning">This mode optimizes the generated SQL query thanks to a direct join on the collection elements. \nWarning: if the initial condition isn't complied with, the result may be false (missing lines or duplicates).</static>
                </container>
                <leave>
                  <if expr="@singleRow">
                    <set value="1" xpath="@lineCount"/>
                  </if>
                </leave>
              </container>
              <container desc="Enter the filtering condition used to specify which collection elements you want to keep." img="xtk:filter32.png" name="where" title="Filter">
                <container buildQueryXPath="." ref="xtk:queryDef:where"/>
              </container>
              <container desc="Specify the sort order used to indicates which lines to keep, when there are more lines eligible than specified previously." img="xtk:filter32.png" name="orderBy" title="Sort" visibleIf="@singleRow == false">
                <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                  <input colSize="20" xpath="@label"/>
                  <input colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                  <input colSize="15" editable="true" xpath="@sortDesc"/>
                </input>
                <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@help"/>
              </container>
            </form>
          </input>
        </container>
      </container>
      <container desc="Select the sort order of the columns (used to generate the ORDER BY clause of the SQL statement)." name="sort" title="Sorting">
        <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="source/orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathSchema="source/@schema" xpathSelect="source/select/node" xpathStartPath="source/@startPath" zoom="false">
          <input colSize="20" xpath="@label"/>
          <input choiceType="sortAggregate" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
          <input colSize="15" editable="true" xpath="@sort"/>
          <input colSize="15" editable="true" xpath="@sortDesc"/>
        </input>
      </container>
      <container desc="Please specify the grouping conditions (used to generate the SQL GROUP BY clause)." name="group" title="Data grouping" visibleIf="[/tmp/selectCtrl/out/@group]">
        <input editable="false" name="groupList" nolabel="true" toolbarCaption="Group columns" type="groupByList" xpath="source/groupBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/groupBy" xpathSchema="source/@schema" xpathSelect="source/select/node" xpathStartPath="source/@startPath" zoom="false">
          <input colSize="20" xpath="@label"/>
          <input choiceType="group" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
        </input>
      </container>
      <container desc="Please specify the group-filtering conditions (used to generate the SQL HAVING clause)." name="having" title="Grouping condition" visibleIf="[/tmp/selectCtrl/out/@group]">
        <input name="havingList" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionlist" xpath="source/having" xpathCurrentLookupPath="/lookupPath/having" xpathHelp="/@helpHaving" xpathSchema="source/@schema" xpathStartPath="source/@startPath">
          <input colSize="15" label=" " xpath="/having/@bool-operator"/>
          <input colSize="30" label="Expression" xpath="/having/@leftExpr"/>
          <input colSize="15" label="Operator" xpath="/having/@operator"/>
          <input colSize="30" label="Value" xpath="/having/@rightExpr"/>
        </input>
        <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpHaving"/>
      </container>
      <container desc="Select and reorder the columns to export. You may also add columns added from the elementary columns defined previously." name="mapping" title="Data formatting" xpath="destination">
        <input alwaysActive="true" name="list" type="exportMappingList" xpath="exportColumns/exportColumn" xpathFormat="../destination/exportFormat/@format" xpathSelect="../source/select">
          <form label="Export calculated field definition" name="calculatedField">
            <container colcount="2">
              <input xpath="@label"/>
              <input label="Internal name" type="ComputeNameEdit" uniqueInParent="true" xpath="@name" xpathRef="@label"/>
            </container>
            <input xpath="@calcFieldType"/>
            <container type="visibleGroup" visibleIf="EV(@calcFieldType, 'constant')">
              <input nolabel="true" type="memo" xpath="srcScript"/>
              <static label="Please specify a text string in the edit box (ex: 'my string')." type="help"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@calcFieldType, 'enumeration')">
              <container style="flat" type="notebook">
                <container label="Script" propagateConstraints="false">
                  <input noDefaultValue="true" type="importColumnSelect" xpath="@refPath" xpathCalculatedFields="../exportColumn" xpathSource="../../../source/select/node"/>
                  <input nolabel="true" toolbarCaption="List of enumeration values" type="list" xpath="enumeration">
                    <input xpath="@source"/>
                    <input xpath="@destination"/>
                  </input>
                  <container colcount="3" cols-width="1,1,100">
                    <static label="For the other cases:"/>
                    <input checkedValue="update" colspan="2" label="Keep the source value" type="radioButton" xpath="@defaultType"/>
                    <static/>
                    <input checkedValue="value" label="Use the following value:" type="radioButton" xpath="@defaultType"/>
                    <container enabledIf="@defaultType=='value'" type="enabledGroup">
                      <input nolabel="true" xpath="@defaultValue"/>
                    </container>
                    <static/>
                    <input checkedValue="warning" colspan="2" label="Generate a warning and continue" type="radioButton" xpath="@defaultType"/>
                    <static/>
                    <input checkedValue="error" colspan="2" label="Generate an error and reject the line" type="radioButton" xpath="@defaultType"/>
                    <static/>
                  </container>
                  <static label="Please select the reference source column and set the enumeration values; fields containing source values are transformed with the associated mapped values." type="help"/>
                </container>
                <container label="Preview">
                  <static img="xtk:preview.png" label="JavaScript expression preview" type="separator"/>
                  <input calcFieldMode="true" name="PreviewList" type="exportPreviewList" xpath="." xpathErrorLogs="/tmp/exportPreview/currentLine"/>
                  <input editable="false" img="xtk:logerr.png" noToolbar="true" nolabel="true" type="list" xpath="/tmp/exportPreview/currentLine/log">
                    <input label="Logs during evaluation of the calculated field" xpath="@message"/>
                  </input>
                </container>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="EV(@calcFieldType, 'javascript', 'jst')">
              <container style="flat" type="notebook">
                <container label="Script" propagateConstraints="false">
                  <input nolabel="true" type="jstEdit" xpath="srcScript" xpathInsert="/ignored/customizeBtnOut/ins">
                    <container>
                      <input isJsExpr="EV([../@calcFieldType], 'javascript')" isJstExpr="EV([../@calcFieldType], 'jst')" type="calcFieldMenuBtn" xpathCondLinks="../../../../source/conditionLink" xpathInsert="/ignored/customizeBtnOut/ins" xpathMapping="../.." xpathSelect="../../../../source/select"/>
                    </container>
                  </input>
                  <static label="You can select the fields associated with the source columns with the toolbar button (e.g.: return source.my_column)." type="help"/>
                </container>
                <container label="Preview">
                  <static img="xtk:preview.png" label="JavaScript expression preview" type="separator"/>
                  <input calcFieldMode="true" name="PreviewList" type="exportPreviewList" xpath="." xpathErrorLogs="/tmp/exportPreview/currentLine"/>
                  <input editable="false" img="xtk:logerr.png" noToolbar="true" nolabel="true" type="list" xpath="/tmp/exportPreview/currentLine/log">
                    <input label="Logs during evaluation of the calculated field" xpath="@message"/>
                  </input>
                </container>
              </container>
            </container>
            <leave>
              <if expr="EV(@calcFieldType, 'enumeration')">
                <set expr="Iif(EV(@defaultType,'error') , 'line', 'warning')" xpath="@rejectCol"/>
              </if>
            </leave>
          </form>
        </input>
      </container>
      <container desc="Click on the button to preview the data returned by the query." name="preview" title="Data preview">
        <enter>
          <set expr="200" xpath="/tmp/@lineCount"/>
        </enter>
        <container type="exportPreviewContainer">
          <container colcount="3">
            <input img="xtk:preview.png" label="Start the preview of the data" name="launchButton" type="urlButton"/>
            <static/>
            <input align="right" label="Lines to display" type="Number" xpath="/tmp/@lineCount"/>
          </container>
          <container style="flat" type="notebook">
            <container label="Column results">
              <container type="hpaned">
                <input name="PreviewList" type="exportPreviewList" xpathErrorLogs="/tmp/exportPreview/currentLine" xpathSchemaData="/tmp/@schemaDataXPath"/>
                <input editable="false" img="xtk:logerr.png" noToolbar="true" nolabel="true" type="list" xpath="/tmp/exportPreview/currentLine/log">
                  <input label="Logs generated during export" xpath="@message"/>
                </input>
              </container>
            </container>
            <container label="XML result">
              <input name="PreviewXml" nolabel="true" readOnly="true" type="sourceEdit"/>
            </container>
            <container label="Generated SQL queries">
              <input contentType="sql" name="PreviewSQL" nolabel="true" readOnly="true" type="codeEdit" wrap="true"/>
            </container>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:queryDef" entitySchema="xtk:form" img="xtk:form.png" label="Select an expression" md5="B0888995AFEFAC25621DED57CF89A80D" name="exprChoice" namespace="xtk" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="false" xpath="/ignored/@firstActivation"/>
        <set value="dateOnly" xpath="/@dateFunction"/>
        <set value="30" xpath="/@daysAgoNumber"/>
        <set expr="[/expr]" xpath="/ignored/@exprFullXPath"/>
        <if expr="[/ignored/@exprFullXPath] != '[.]'">
          <if expr="StartWith([/ignored/@exprFullXPath], '[')">
            <set expr="SubString([/ignored/@exprFullXPath], 1, StrLen([/ignored/@exprFullXPath])-2)" xpath="/ignored/@exprFullXPath"/>
          </if>
          <set expr="SubString([/ignored/@startPath]+'/'+[/ignored/@exprFullXPath], 1)" xpath="/ignored/@exprFullXPath"/>
        </if>
        <switch>
          <case expr="[/ignored/@choiceType]=='sortAggregate' and [/ignored/@recipientLink] != ''">
            <set value="aggregate" xpath="/ignored/@exprChoice"/>
            <set value="true" xpath="/ignored/@firstActivation"/>
          </case>
          <case expr="IsAllowedSql() AND ([/ignored/@isSqlChoice] or (([/ignored/@choiceType] != 'condition' or [/ignored/@editRightValue]) and StartWith([/expr], '[SQLDATA[')))">
            <set value="sql" xpath="/ignored/@exprChoice"/>
          </case>
          <case expr="[/ignored/@isSqlChoice]==false and ([/ignored/@constantType] != '' or ([/expr] != '' and FieldExists([/ignored/@schema], [/ignored/@exprFullXPath])==false))">
            <set value="other" xpath="/ignored/@exprChoice"/>
          </case>
          <default>
            <set value="xpath" xpath="/ignored/@exprChoice"/>
          </default>
        </switch>
        <set value="count" xpath="/ignored/@aggregateType"/>
        <set value="0" xpath="/ignored/@countdistinct"/>
        <if expr="[/ignored/@choiceType]!='condition'">
          <set value="0" xpath="/ignored/@editRightValue"/>
        </if>
        <if expr="([/ignored/@choiceType] == 'expression' and [/expr] == '') or ([/ignored/@editRightValue] and ([/ignored/@constantType] == 'date' or [/ignored/@constantType] == 'datetime') and [/expr]=='##')">
          <set value="true" xpath="/ignored/@firstActivation"/>
          <set value="date" xpath="/ignored/@exprChoice"/>
        </if>
        <if expr="[/ignored/@forceFirstActivation]">
          <set value="true" xpath="/ignored/@firstActivation"/>
        </if>
        <set value="hide" xpath="/ignored/@showLink1N"/>
        <if expr="[/ignored/@choiceType]=='select' or [/ignored/@choiceType]=='aggregate'">
          <set value="0" xpath="/ignored/@hideMappedAsXml"/>
          <set value="" xpath="/ignored/@showLink1N"/>
        </if>
        <if expr="[/ignored/@choiceType]=='export'">
          <set value="0" xpath="/ignored/@hideMappedAsXml"/>
          <set value="showCollections" xpath="/ignored/@showLink1N"/>
        </if>
        <if expr="[/ignored/@choiceType]=='condition'">
          <set value="unboundPath" xpath="/ignored/@showLink1N"/>
        </if>
        <set expr="[/ignored/@showLink1N]" xpath="/ignored/@refShowLink1N"/>
      </enter>
      <container colcount="3" desc="Select the formula type required to populate the expression." firstActivatedIf="[/ignored/@firstActivation]" img="xtk:choice.png" name="choice" title="Formula type" visibleIf="[/ignored/@isSqlChoice]==false and [/ignored/@choiceType]!='xpath'">
        <container colcount="3" colspan="3" type="visibleGroup" visibleIf="[/ignored/@recipientLink]==''">
          <static colspan="3" img="xtk:table.png" label="Field only" type="separator"/>
          <static/>
          <input checkedValue="xpath" label="Select a field from a list of available fields" type="radioButton" xpath="/ignored/@exprChoice"/>
          <static/>
        </container>
        <container colcount="3" colspan="3" type="visibleGroup" visibleIf="[/ignored/@editRightValue] and ([/ignored/@constantType] == 'date' or [/ignored/@constantType] == 'datetime')">
          <static colspan="3" img="xtk:function.png" label="Function" type="separator"/>
          <static/>
          <input checkedValue="date" label="Process on dates" type="radioButton" xpath="/ignored/@exprChoice"/>
          <static/>
          <container colcount="4" colspan="3" type="visibleGroup" visibleIf="[/ignored/@exprChoice]=='date'">
            <static/>
            <static/>
            <input checkedValue="dateOnly" label="Date without the time" type="radioButton" xpath="/@dateFunction"/>
            <static/>
            <static/>
            <static/>
            <input checkedValue="current" label="Current date" type="radioButton" xpath="/@dateFunction"/>
            <static/>
            <static/>
            <static/>
            <input checkedValue="daysAgo" label="Current date minus n days" type="radioButton" xpath="/@dateFunction"/>
            <container enabledIf="[/@dateFunction] == 'daysAgo'" type="enabledGroup">
              <input nolabel="true" type="number" xpath="/ignored/@daysAgoNumber"/>
            </container>
            <static/>
            <static/>
            <input checkedValue="monthsAgo" label="Current date minus n months" type="radioButton" xpath="/@dateFunction"/>
            <container enabledIf="[/@dateFunction] == 'monthsAgo'" type="enabledGroup">
              <input nolabel="true" type="number" xpath="/ignored/@monthsAgoNumber"/>
            </container>
          </container>
        </container>
        <container colcount="3" colspan="3" type="visibleGroup" visibleIf="[/ignored/@editRightValue]==false and ([/ignored/@choiceType]=='condition' or [/ignored/@choiceType]=='export' or [/ignored/@choiceType]=='aggregate' or [/ignored/@choiceType]=='sortAggregate')">
          <static colspan="3" img="xtk:parameters.png" label="Aggregate" type="separator"/>
          <static/>
          <input checkedValue="aggregate" label="Process on an aggregate function" type="radioButton" xpath="/ignored/@exprChoice"/>
          <static/>
          <container colcount="4" colspan="3" type="visibleGroup" visibleIf="[/ignored/@exprChoice]=='aggregate'">
            <static/>
            <static/>
            <input checkedValue="count" label="Count" type="radioButton" xpath="/ignored/@aggregateType"/>
            <input label="Distinct" type="checkBox" xpath="/ignored/@countdistinct"/>
            <static/>
            <static/>
            <input checkedValue="sum" label="Sum" type="radioButton" xpath="/ignored/@aggregateType"/>
            <static/>
            <static/>
            <static/>
            <input checkedValue="max" label="Maximum value" type="radioButton" xpath="/ignored/@aggregateType"/>
            <static/>
            <static/>
            <static/>
            <input checkedValue="min" label="Minimum value" type="radioButton" xpath="/ignored/@aggregateType"/>
            <static/>
            <static/>
            <static/>
            <input checkedValue="average" label="Average" type="radioButton" xpath="/ignored/@aggregateType"/>
            <static/>
          </container>
        </container>
        <container colcount="3" colspan="3" type="visibleGroup" visibleIf="[/ignored/@choiceType]=='condition' and [/ignored/@editRightValue]==false">
          <static colspan="3" img="xtk:filter.png" label="User filter" type="separator"/>
          <static/>
          <input checkedValue="filter" label="Select the filter from a list of predefined filters" type="radioButton" xpath="/ignored/@exprChoice"/>
          <static/>
        </container>
        <container colcount="3" colspan="3">
          <static colspan="3" img="xtk:runsmall.png" label="Expression" type="separator"/>
          <static/>
          <input checkedValue="other" label="Edit the formula using an expression" type="radioButton" xpath="/ignored/@exprChoice"/>
          <static/>
        </container>
        <container colcount="3" colspan="3" type="visibleGroup" visibleIf="IsAllowedSQL()">
          <static colspan="3" img="xtk:sql.png" label="SQL code" type="separator"/>
          <static/>
          <input checkedValue="sql" label="Edit the formula using SQL code" type="radioButton" xpath="/ignored/@exprChoice"/>
          <static/>
        </container>
      </container>
      <container desc="Select the field from the list of available fields." img="xtk:choice.png" prevButtonImg="xtk:properties.png" prevButtonLabel="Advanced selection" title="Field to select" visibleIf="[/ignored/@exprChoice]=='xpath' or [/ignored/@exprChoice]=='aggregate' or ([/ignored/@exprChoice] == 'date' and [/@dateFunction] == 'dateOnly')">
        <enter>
          <set expr="[/expr]" xpath="/ignored/exprValue"/>
          <set value="" xpath="/ignored/@filterType"/>
          <if expr="[/ignored/@exprChoice]=='aggregate' and [/ignored/@aggregateType]=='sum'">
            <set value="number" xpath="/ignored/@filterTypes"/>
          </if>
          <if expr="[/ignored/@exprChoice] == 'date'">
            <set value="date" xpath="/ignored/@filterTypes"/>
          </if>
          <switch>
            <case expr="[/ignored/@editRightValue]">
              <set value="hide" xpath="/ignored/@showLink1N"/>
            </case>
            <case expr="[/ignored/@exprChoice]=='aggregate' and ([/ignored/@activeHaving] or [/ignored/@choiceType]=='export' or [/ignored/@choiceType]=='aggregate' or [/ignored/@choiceType]=='sortAggregate')">
              <set value="showCollections" xpath="/ignored/@showLink1N"/>
            </case>
            <case expr="[/ignored/@exprChoice]=='aggregate' and [/ignored/@choiceType]=='condition'">
              <set value="" xpath="/ignored/@showLink1N"/>
            </case>
            <default>
              <set expr="[/ignored/@refShowLink1N]" xpath="/ignored/@showLink1N"/>
            </default>
          </switch>
        </enter>
        <static fontBold="true" label="Available fields:"/>
        <container colcount="2">
          <static img="xtk:filter.png" type="image"/>
          <input catchReturnKey="true" label="Find" type="edit" xpath="/ignored/@search"/>
        </container>
        <input dblClickAction="wizFinish" expandXPath="true" name="fieldChoice" type="schemaview" xpath="/ignored/@schema" xpathExpr="/ignored/exprValue" xpathFilter="/ignored/@filter" xpathFilterByTypes="/ignored/@filterTypes" xpathHelp="/ignored/@help" xpathHideCalculated="/ignored/@hideCalculated" xpathHideMappedAsXml="/ignored/@hideMappedAsXml" xpathLastSelection="/ignored/exprValue" xpathSearchPath="/ignored/@search" xpathSelection="/ignored/exprValue" xpathShowLink1N="/ignored/@showLink1N" xpathStartPath="/ignored/@startPath" xpathUseTablePath="/ignored/@useTablePath"/>
        <input type="help" xpath="/ignored/@help"/>
        <leave>
          <set expr="[/ignored/exprValue]" xpath="/expr"/>
        </leave>
      </container>
      <container desc="Enter the expression in this edit zone." img="xtk:choice.png" prevButtonImg="xtk:properties.png" prevButtonLabel="Advanced selection" title="Edit the expression" visibleIf="[/ignored/@exprChoice]=='other' or [/ignored/@exprChoice]=='sql'">
        <enter>
          <if expr="[/ignored/@exprChoice]=='other'">
            <set value="xtk" xpath="/ignored/@contentType"/>
          </if>
          <if expr="[/ignored/@exprChoice]=='sql'">
            <set value="sql" xpath="/ignored/@contentType"/>
          </if>
          <if expr="[/ignored/@exprChoice] == 'sql' and ([/ignored/@choiceType] != 'condition'or [/ignored/@editRightValue]) and StartWith([/expr], '[SQLDATA[')">
            <set expr="SubString([/expr], 9, StrLen([/expr])-11)" xpath="/expr"/>
          </if>
          <switch>
            <case expr="[/ignored/@editRightValue]">
              <set value="hide" xpath="/ignored/@showLink1N"/>
            </case>
            <case expr="[/ignored/@exprChoice]=='aggregate' and ([/ignored/@choiceType]=='condition' or [/ignored/@choiceType]=='export' or [/ignored/@choiceType]=='aggregate' or [/ignored/@choiceType]=='sortAggregate')">
              <set value="always" xpath="/ignored/@showLink1N"/>
            </case>
            <default>
              <set expr="[/ignored/@refShowLink1N]" xpath="/ignored/@showLink1N"/>
            </default>
          </switch>
        </enter>
        <input hideCheckButtonIf="[/ignored/@contentType]='sql'" noTransaction="false" nolabel="true" selectAllOnStart="true" toolbar="true" type="exprEdit" xpath="/expr" xpathSchema="/ignored/@schema" xpathStartPath="/ignored/@startPath"/>
        <container colcount="2" cols-width="100,1" xpath=".">
          <container>
            <static fontBold="true" label="Available fields:"/>
            <container colcount="2">
              <static img="xtk:filter.png" type="image"/>
              <input catchReturnKey="true" label="Find" type="edit" xpath="/ignored/@search"/>
            </container>
            <input name="exprChoice" type="schemaview" xpath="/ignored/@schema" xpathConstant="/ignored/constant" xpathContentType="/ignored/@contentType" xpathExpr="/expr" xpathHelp="/ignored/@help" xpathHideMappedAsXml="/ignored/@hideMappedAsXml" xpathSearchPath="/ignored/@search" xpathShowLink1N="/ignored/@showLink1N" xpathStartPath="/ignored/@startPath"/>
            <input type="help" xpath="/ignored/@help"/>
          </container>
          <container>
            <static label="List of functions:"/>
            <input margin-left="4" type="functionview" xpathExpr="/expr" xpathHelp="/@help"/>
          </container>
        </container>
        <input type="help" xpath="/@help"/>
        <leave>
          <if expr="[/ignored/@exprChoice] == 'sql' and ([/ignored/@choiceType] != 'condition' or [/ignored/@editRightValue])">
            <set expr="'[SQLDATA['+[/expr]+']]'" xpath="/expr"/>
          </if>
        </leave>
      </container>
      <container desc="Select a user filter from those available in the list." img="xtk:choice.png" name="filter" prevButtonImg="xtk:properties.png" prevButtonLabel="Advanced selection" title="Filter to select" visibleIf="[/ignored/@exprChoice]=='filter'">
        <input dblClickAction="wizFinish" hideFormFilters="true" hideMainFilters="true" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/ignored/filterList" xpathFilter="/ignored/@filterName" xpathFilterLabel="/ignored/@filterLabel" xpathSchema="/ignored/@schema"/>
      </container>
      <leave>
        <if expr="[/ignored/@exprChoice] == 'aggregate'">
          <if expr="[/ignored/@aggregateType] == 'count' and [/ignored/@countdistinct]">
            <set expr="'Countdistinct('+[/expr]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@aggregateType] == 'count' and [/ignored/@countdistinct]==false">
            <set expr="'count('+[/expr]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@aggregateType] == 'sum'">
            <set expr="'sum('+[/expr]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@aggregateType] == 'max'">
            <set expr="'max('+[/expr]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@aggregateType] == 'min'">
            <set expr="'min('+[/expr]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@aggregateType] == 'average'">
            <set expr="'avg('+[/expr]+')'" xpath="/expr"/>
          </if>
        </if>
        <if expr="[/ignored/@exprChoice] == 'date' and [/@dateFunction] == 'dateOnly'">
          <if expr="[/ignored/@constantType] == 'datetime'">
            <set expr="'DateOnly('+[/expr]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@constantType] == 'date'">
            <set expr="'ToDate('+[/expr]+')'" xpath="/expr"/>
          </if>
        </if>
        <if expr="[/ignored/@exprChoice] == 'date' and [/@dateFunction] == 'current'">
          <set value="GetDate()" xpath="/expr"/>
        </if>
        <if expr="[/ignored/@exprChoice] == 'date' and [/@dateFunction] == 'daysAgo'">
          <if expr="[/ignored/@constantType] == 'datetime'">
            <set expr="'DaysAgo('+[/ignored/@daysAgoNumber]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@constantType] == 'date'">
            <set expr="'SubDays(ToDate(GetDate()), '+[/ignored/@daysAgoNumber]+')'" xpath="/expr"/>
          </if>
        </if>
        <if expr="[/ignored/@exprChoice] == 'date' and [/@dateFunction] == 'monthsAgo'">
          <if expr="[/ignored/@constantType] == 'datetime'">
            <set expr="'MonthsAgo('+[/ignored/@monthsAgoNumber]+')'" xpath="/expr"/>
          </if>
          <if expr="[/ignored/@constantType] == 'date'">
            <set expr="'SubMonths(ToDate(GetDate()), '+[/ignored/@monthsAgoNumber]+')'" xpath="/expr"/>
          </if>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:queryDef" entitySchema="xtk:form" img="xtk:form.png" label="Expression editor" md5="8A71D2C4D3BE3B02CFFA8D38E5F98356" name="expreditor" namespace="xtk" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/constant/@constType"/>
      </enter>
      <input noTransaction="false" nolabel="true" toolbar="true" type="expredit" xpath="/expr" xpathContentType="/expr/@contentType" xpathSchema="/schema/@schema" xpathStartPath="/schema/@startPath"/>
      <container colcount="3" cols-width="100,1,1" xpath=".">
        <container>
          <static fontBold="true" label="Available fields:"/>
          <container colcount="2">
            <static img="xtk:filter.png" type="image"/>
            <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/columns/@search"/>
          </container>
          <input hideMappedAsXml="true" type="schemaview" useUnboundPath="true" xpath="/schema/@schema" xpathConstant="/constant" xpathContentType="/expr/@contentType" xpathExpr="/expr" xpathHelp="/@help" xpathSearchPath="/tmp/columns/@search" xpathStartPath="/schema/@startPath"/>
        </container>
        <container>
          <static label="List of functions:"/>
          <input margin-left="4" type="functionview" xpathExpr="/expr" xpathHelp="/@help"/>
        </container>
        <container>
          <container type="visibleGroup" visibleIf="[/constant/@constType] != 0">
            <value margin-left="4" nolabel="true" xpath="/constant/@label"/>
            <input margin-left="4" nolabel="true" rowspan="2" type="constview" xpath="/constant" xpathExpr="/expr" xpathType=""/>
          </container>
        </container>
      </container>
      <input type="help" xpath="/@help"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:sqlSchema" entitySchema="xtk:form" img="xtk:form.png" label="Field properties " md5="3A146B84B2FB5B140D5E57F8787F4A46" name="fieldProp" namespace="xtk" readOnlyAccess="admin" type="notebook" xpath="table/field" xtkschema="xtk:form">
      <container colcount="2" label="General">
        <container colcount="2" colspan="2" label="Field" type="frame">
          <value colspan="2" fontBold="true" xpath="@relXPath"/>
          <container colspan="2" type="visibleGroup" visibleIf="@expr != '' and [/tmp/@feature]==false">
            <input nolabel="false" type="pathEdit" xpath="@expr" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath" zoom="true"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@expr == '' and [/tmp/@feature]==false">
            <value xpath="@name"/>
          </container>
          <input colspan="2" xpath="@label"/>
          <input colspan="2" xpath="@desc"/>
          <value xpath="@type"/>
          <container type="visibleGroup" visibleIf="@type=='string'">
            <value xpath="@length"/>
          </container>
        </container>
        <container colspan="2" label="Constraints" type="frame">
          <container type="visibleGroup" visibleIf="@expr == '' and [/tmp/@feature]==false">
            <input nolabel="false" type="pathEdit" xpath="@default" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
            <container type="visiblegroup" visibleIf="@type = 'string'">
              <input xpath="@dataPolicy"/>
            </container>
            <input xpath="@required"/>
            <input xpath="@advanced"/>
            <input xpath="@user"/>
          </container>
          <container type="visibleGroup" visibleIf="@expr != '' or [/tmp/@feature]">
            <input xpath="@advanced"/>
            <input xpath="@user"/>
          </container>
        </container>
      </container>
      <leave>
        <soapCall name="UpdateFieldProp" service="xtk:sqlSchema">
          <param exprIn="[.]" type="DOMElement"/>
        </soapCall>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="File resource" md5="94FA75CF66BBBE22153215AF738FEB3C" name="fileRes" namespace="xtk" type="iconbox" xpathsToLoad="@originalName,@fileName,@md5,@contentType,@codepage,@storageType" xpathsToLoadOpt="@publish" xtkschema="xtk:form">
      <enter>
        <soapCall name="GetPublicFileResURL" service="xtk:fileRes">
          <param type="string" xpathOut="/tmp/@publicFileResUrl"/>
        </soapCall>
      </enter>
      <container colcount="2" img="xtk:properties.png" label="General">
        <container colcount="2" colspan="2">
          <input xpath="@label"/>
          <input xpath="@internalName"/>
          <input xpath="@nature"/>
          <input xpath="@version"/>
          <input colspan="2" img="xtk:properties.png" label="Advanced parameters..." nolabel="true" type="subFormLink">
            <form label="Advanced parameters">
              <input xpath="@useMd5AsFilename"/>
              <static label="This option is used to generate a unique filename using a MD5 hash of the file content." type="help"/>
            </form>
          </input>
          <static/>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="GetOption('NmsDelivery_ImagePublishing')='none'">
          <container backcolor="tooltip" padding="4">
            <static label="The resource publication mode is not specified." type="warning"/>
          </container>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="@loaded and FileName(@fileName) != Iif(@useMd5AsFilename, @md5 + '.' + FileExt(@name),@name)">
          <container label="Warning" type="frame">
            <static type="warning">In order for this modification to be taken into account, you must republish the file.</static>
            <input img="xtk:upload.png" label="Publish now..." needWriteAccess="true" type="UrlButton" xpath=".">
              <enter onSuccess="File published with success.">
                <soapCall name="PublishIfNeeded" service="xtk:fileRes">
                  <param exprIn="/fileRes" type="element"/>
                  <param type="DOMElement" xpathOut="/fileRes"/>
                </soapCall>
                <setModified/>
              </enter>
            </input>
          </container>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="GetOption('NmsDelivery_ImagePublishing')!='none'">
          <container form="xtk:fileResUpload" name="dropZone" prebuildSubForm="false" type="fileDropZone">
            <enter name="onClick">
              <set expr="[/tmp/@uploadFile]" xpath="@originalName"/>
              <set value="5" xpath="/tmp/@storageType"/>
            </enter>
            <container label="File" name="actions" type="frame">
              <container name="upload" type="visibleGroup" visibleIf="@loaded==false">
                <static img="xtk:loginfo.png" label=" " name="helpNotLoaded">The file has not yet been uploaded on the server. You can drag &amp; drop the file here to upload it, or click on the link below.</static>
                <input form="xtk:fileResUpload" img="xtk:upload.png" label="Upload file to server..." modelessExpr="'$(entityPath)'='/fileRes'" needWriteAccess="true" type="subFormLink" xpath=".">
                  <enter name="onClick">
                    <set value="5" xpath="/tmp/@storageType"/>
                    <set expr="FileDlg(@originalName, 'open')" xpath="/tmp/@uploadFile"/>
                    <set expr="[/tmp/@uploadFile]" xpath="@originalName"/>
                    <if expr="'$(entityPath)'='/fileRes'">
                      <saveView/>
                    </if>
                  </enter>
                </input>
              </container>
              <container name="loaded" type="visibleGroup" visibleIf="@loaded">
                <static img="xtk:xtkcheck.png" name="helpLoaded" nolabel="true">The file has been uploaded on the server. You can drag &amp; drop it here, or click on the link below to replace the file.</static>
                <container name="download">
                  <input form="xtk:fileResDownload" imgExpr="EImg(@userContentType)" labelExpr="FileName(@originalName)" modelessExpr="'$(entityPath)'='/fileRes'" needWriteAccess="true" nolabel="true" type="fileLink" xpath="."/>
                </container>
                <container name="uploadModify">
                  <input form="xtk:fileResUpload" img="xtk:upload.png" label="Change the file on the server..." modelessExpr="'$(entityPath)'='/fileRes'" needWriteAccess="true" nolabel="true" type="subFormLink" xpath=".">
                    <enter name="onClick">
                      <set value="5" xpath="/tmp/@storageType"/>
                      <set expr="FileDlg(@originalName, 'open')" xpath="/tmp/@uploadFile"/>
                      <set expr="[/tmp/@uploadFile]" xpath="@originalName"/>
                      <if expr="'$(entityPath)'='/fileRes'">
                        <saveView/>
                      </if>
                    </enter>
                  </input>
                </container>
              </container>
            </container>
          </container>
        </container>
        <static colspan="2" label="Description" type="separator"/>
        <input colspan="2" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="comment"/>
      </container>
      <container img="xtk:image.png" label="Image" visibleIf="@userContentType = 0 and @name!=''">
        <container label="Image parameters" type="frame">
          <input xpath="@alt"/>
          <static type="help">We recommend providing an alternative text. It will be shown while the image is being loaded or instead of the image if they are blocked.</static>
          <input xpath="@width"/>
          <input xpath="@height"/>
          <static type="help">Here you can force the size of the image in the HTML code in order to have control of the layout when the image is loaded.</static>
        </container>
      </container>
      <container img="xtk:preview.png" label="Preview" visibleIf="@loaded and FileName(@fileName) == Iif(@useMd5AsFilename, @md5 + '.' + FileExt(@name),@name)">
        <input alwaysActive="true" expr="[/tmp/@publicFileResUrl] + iif(@useMd5AsFilename, @md5 + '.' + FileExt(@name),@name)" type="expr" xpath="/ignored/@url"/>
        <input img="xtk:form/link.png" nolabel="true" type="edit" xpath="/ignored/@url"/>
        <input forceNavigate="true" type="urlViewer" urlExpr="[/ignored/@url]"/>
      </container>
      <container img="nms:category.png" label="History">
        <input hideEditButtons="true" nolabel="true" type="linklist" xpath="history">
          <input xpath="@lastModified"/>
          <input xpath="modifiedBy"/>
          <input xpath="@activityType"/>
          <input xpath="@description"/>
        </input>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:fileRes" entitySchema="xtk:form" img="xtk:form.png" label="Download file..." md5="7EFFAAA8DD1C860B9DC7D42FB03A2E99" name="fileResDownload" namespace="xtk" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/tmp/@processed"/>
        <if expr="[/tmp/@storageType]=''">
          <set value="1" xpath="/tmp/@storageType"/>
        </if>
      </enter>
      <container name="downloaded" type="visibleGroup" visibleIf="[/tmp/@processed]=1">
        <container label="Download document" type="frame">
          <static img="xtk:xtkcheck.png" label=" " name="helpLoaded">The document is downloaded on your computer. You may close the window.</static>
        </container>
        <input label="Open the document..." type="urlButton">
          <enter>
            <set expr="ShellExecute('&quot;' + [/tmp/@downloadFile] + '&quot;')" xpath="/ignored/@value"/>
          </enter>
        </input>
      </container>
      <container name="downloading" type="visibleGroup" visibleIf="[/tmp/@processed]!=1">
        <container autoStart="true" showHelp="false" showLogOnError="true" transferType="download" type="fileResTransfer" xpathOriginal="/tmp/@downloadFile" xpathStorageType="/tmp/@storageType">
          <onTransferComplete>
            <set value="1" xpath="/tmp/@processed"/>
            <if expr="[/tmp/@execOnDownload]">
              <set expr="ShellExecute('&quot;' + [/tmp/@downloadFile] + '&quot;')" xpath="/ignored/@value"/>
            </if>
          </onTransferComplete>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form closeOnCancel="true" entity-schema="xtk:fileRes" entitySchema="xtk:form" img="xtk:form.png" label="Upload file to server" md5="E700069FAC24EEA8A7A093F6C9D0CFB4" name="fileResUpload" namespace="xtk" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <enter>
        <set expr="@loaded" xpath="/tmp/@wasLoaded"/>
        <set value="0" xpath="/tmp/@processed"/>
        <if expr="[/tmp/@storageType]=''">
          <set value="1" xpath="/tmp/@storageType"/>
        </if>
        <if expr="@originalName=''">
          <set expr="FileDlg(@originalName, 'open')" xpath="@originalName"/>
        </if>
      </enter>
      <container name="fileUpload">
        <container name="loaded" type="visibleGroup" visibleIf="[/tmp/@processed]=1">
          <container label="Upload document" type="frame">
            <static img="xtk:xtkcheck.png" label=" " name="helpLoaded">The document is uploaded to the server. You may close the window.</static>
          </container>
        </container>
        <container name="loading" type="visibleGroup" visibleIf="[/tmp/@processed]=0">
          <container autoStart="true" showHelp="false" showLogOnError="true" transferType="upload" type="fileResTransfer" xpathStorageType="/tmp/@storageType">
            <onTransferComplete>
              <set value="1" xpath="/tmp/@processed"/>
              <if expr="[/ignored/@fileNameEraseLabel] = 'true'">
                <set expr="Iif([/tmp/@wasLoaded]=false, FileName(@originalName), @label)" xpath="@label"/>
              </if>
              <set value="1" xpath="@loaded"/>
              <set expr="FileName(@originalName)" xpath="@name"/>
              <set expr="Iif(SubString(@contentType, 0, 6) = 'image/', 0, Iif(SubString(@contentType, 0, 5) = 'text/', Decode(SubString(@contentType, 5), 'html', 5, 6), Decode(SubString(@contentType, 12), 'pdf', 3, 'vnd.ms-excel', 2, 'msword', 1, 'vnd.ms-powerpoint', 4, 20)))" xpath="@userContentType"/>
            </onTransferComplete>
          </container>
        </container>
      </container>
      <leave>
        <if expr="'$(entityPath)'='/asset'">
          <set expr="iif([/tmp/@processed]=1, 0, [@owner-id])" xpath="@owner-id"/>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Folder properties" md5="1F975C9F4A329504612871A9AD4040A9" name="folder" namespace="xtk" xtkschema="xtk:form">
      <enter>
        <if expr="@id = 0">
          <set value="0" xpath="@id"/>
        </if>
        <set value="0" xpath="/ignored/@addParameter"/>
        <set expr="@isView" xpath="/ignored/@isView"/>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="formAdvancedParam">
          <form colcount="2" label="Advanced parameters" maxLabelWidth="60">
            <input colspan="2" xpath="@configName"/>
            <input colspan="2" createMode="none" xpath="orgUnit"/>
            <static colspan="2" label="Internal data" type="separator"/>
            <input colspan="2" readOnly="true" xpath="@id"/>
            <input colspan="2" readOnly="true" width="22" xpath="@model"/>
            <input colspan="2" readOnly="true" xpath="@fullName"/>
            <static colspan="2" label="Audit" type="separator"/>
            <input noZoom="true" readOnly="true" xpath="createdBy"/>
            <value xpath="@created"/>
            <input noZoom="true" readOnly="true" xpath="modifiedBy"/>
            <value xpath="@lastModified"/>
          </form>
        </container>
      </container>
      <container name="notebook" type="notebook">
        <container colcount="2" img="xtk:properties.png" label="General" visibleIf="@id!=0">
          <input colspan="2" xpath="@label"/>
          <input colspan="2" hideComboList="true" xpath="image"/>
          <input colspan="2" xpath="comment"/>
          <input type="computeNameEdit" xpath="@name" xpathRef="@label"/>
          <input colspan="2" img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath="..">
            <form label="Advanced parameters" ref="xtk:folder:lib/formAdvancedParam"/>
          </input>
        </container>
        <container applicableIf="HasNamedRight('folderEdit')" img="xtk:folder.png" label="Sub-folders" name="subFolders">
          <enter>
            <if expr="@id=''">
              <set value="0" xpath="@id"/>
            </if>
          </enter>
          <container type="visibleGroup" visibleIf="@id!=0">
            <input nolabel="true" xpath="@sort"/>
          </container>
          <container type="visibleGroup" visibleIf="!@sort">
            <input disableFilter="true" hideEditButtons="true" img="xtk:folder.png" nolabel="true" toolbarAlign="vertical" type="OrderdFolderList" xpath="folder">
              <input xpath="@label"/>
              <orderBy>
                <node expr="@order"/>
              </orderBy>
            </input>
          </container>
        </container>
        <container applicableIf="HasNamedRight('admin')" colcount="2" img="xtk:passwd.png" label="Security" name="rights" propagateConstraints="false" visibleIf="@id!=0" xpath="rights">
          <input colspan="2" enumImage="operator/@type" labelFormChoice="Please select an operator or a group" nolabel="true" toolbarCaption="Authorizations" type="list" xpath="." xpathChoiceTarget="operator" xpathIndex="/tmp/columns/@current">
            <input col-size="50" createMode="none" label="Operators or groups" noZoom="true" notifyPathList="@type" xpath="operator">
              <orderBy>
                <node expr="@type"/>
                <node expr="@label"/>
              </orderBy>
              <sysFilter>
                <condition expr="@type != 2"/>
              </sysFilter>
            </input>
          </input>
          <static colspan="2" label="Access rights for the selected group or operator" type="separator"/>
          <static colspan="2" label="Access rights:"/>
          <container colspan="2" nolabel="true" type="collectionItemGroup" xpath="." xpathIndex="/tmp/columns/@current">
            <input name="rightsEdition" nolabel="true" type="RightsEdit" xpath="@rights"/>
            <input name="propagate" xpath="@propagate"/>
          </container>
          <static colspan="2" type="separator"/>
          <input nolabel="true" xpath="../@system"/>
          <static label="Selecting this option enables all operators to access the predefined filters, dashboards and web applications which it contains regardless of their rights." type="help"/>
          <input label="Hide this folder from the lists" nolabel="true" xpath="../@noShared"/>
          <static label="If you select this option, this folder will not be visible in the lists of selectable folders." type="help"/>
        </container>
        <container applicableIf="HasNamedRight('folderEdit')" colcount="2" img="xtk:valuestats.png" label="Restriction" name="restriction" propagateConstraints="false" visibleIf="@schema!='' and @id!=0">
          <input xpath="@isView"/>
          <static type="help">A folder which is a view displays all the documents of the type linked to the folder, regardless of the actual folders of these documents.</static>
          <input colspan="2" nolabel="true" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathHelp="/@helpCond">
            <input colSize="15" label=" " xpath="/@bool-operator"/>
            <input colSize="30" label="Expression" xpath="/@leftExpr"/>
            <input colSize="15" label="Operator" xpath="/@operator"/>
            <input colSize="30" label="Value" xpath="/@rightExpr"/>
            <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
          </input>
          <input colspan="2" fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
          <input checkModify="true" colspan="2" label="Generated SQL query..." type="subFormLink">
            <form label="Native SQL query generated from the filter" nothingToEdit="true" nothingToSave="true">
              <enter>
                <soapCall name="BuildQuery" service="xtk:queryDef">
                  <param exprIn="/folder" type="DOMElement"/>
                  <param type="string" xpathOut="/tmp/@previewSQL"/>
                </soapCall>
              </enter>
              <static label="Native SQL query generated to populate the list." type="help"/>
              <input contentType="sql" nolabel="true" readOnly="true" type="codeEdit" wrap="true" xpath="/tmp/@previewSQL"/>
            </form>
          </input>
          <static colspan="2" label="Parameters" type="separator"/>
          <container colspan="2" xpath="context">
            <container type="visibleGroup" visibleIf="NodeCount(parameter)=0 and [/ignored/@addParameter]=0">
              <input label="Add a parameter..." type="urlButton">
                <enter>
                  <set value="1" xpath="/ignored/@addParameter"/>
                </enter>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="NodeCount(parameter)>0 or [/ignored/@addParameter]=1">
              <input colspan="2" nolabel="true" toolbarCaption="Parameters" type="list" xpath="parameter">
                <input xpath="@name"/>
                <input xpath="@value"/>
              </input>
            </container>
          </container>
        </container>
      </container>
      <leave>
        <if expr="[/ignored/@isView]=false and @isView">
          <msgBox translatedExpr="'You are about to change the folder being viewed. \nThis folder must be empty, \if it contains data, please move it to another folder or delete it. \nContinue?'" type="yesno" xpathOut="/ignored/@resMsgBox"/>
          <check expr="[/ignored/@resMsgBox]='yes'">
            <error>Save canceled by the user</error>
          </check>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="3" entitySchema="xtk:form" img="xtk:form.png" label="Form" md5="DC4C20863337B15674F5D77A0D4A709E" name="form" namespace="xtk" screen="SchemaEdit,CheckEdit" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/tmp/@selection"/>
      </enter>
      <container style="flat" type="notebook">
        <container colcount="3" label="Edit">
          <input xpath="@name"/>
          <input xpath="@label"/>
          <input width="50" xpath="@type"/>
          <input addButtonResourceMenu="true" colspan="3" nolabel="true" toolbar="true" type="SourceEdit" xpath="."/>
        </container>
        <container label="Preview" visibleIf="SchemaExists(@namespace+':'+@name) OR SchemaExists([@entity-schema])">
          <static img="xtk:preview.png" label="Form preview" type="separator"/>
          <input nolabel="true" serialize="false" type="FormPreview" xpath="."/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="xtk:formRendering" entitySchema="xtk:form" img="xtk:form.png" label="Form generation template" md5="517F0B558F8C751044913034455620C9" name="formRendering" namespace="xtk" xpathsToLoad="*" xtkschema="xtk:form">
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="row">
          <container type="notebook">
            <container label="Page layout">
              <input label="View" type="separator"/>
              <input xpath="@hideIfNoDecorated"/>
              <input xpath="@hideIfDecorated"/>
              <container type="visibleGroup" visibleIf="EV([../@displayNavigation], 'none') = false">
                <input xpath="@hideIfDashboard"/>
                <container type="visibleGroup" visibleIf="EV([../@type], 'report') and @hideIfDashboard">
                  <static type="warning">Will still be displayed in the report export.</static>
                </container>
              </container>
              <input xpath="@position"/>
              <container colcount="2">
                <container>
                  <input label="Left zone" type="separator"/>
                  <input nolabel="true" xpath="left/text"/>
                </container>
                <container>
                  <input label="Right zone" type="separator"/>
                  <input nolabel="true" xpath="right/text"/>
                </container>
              </container>
            </container>
            <container colcount="2" label="Borders" xpath="border">
              <input colspan="2" label="Left" type="separator"/>
              <input xpath="left/@style"/>
              <container enabledIf="EV([left/@style], 'none', 'default') = false" type="enabledGroup">
                <input xpath="left/@color"/>
              </container>
              <input colspan="2" label="Top" type="separator"/>
              <input xpath="top/@style"/>
              <container enabledIf="EV([top/@style], 'none', 'default') = false" type="enabledGroup">
                <input xpath="top/@color"/>
              </container>
              <input colspan="2" label="Right" type="separator"/>
              <input xpath="right/@style"/>
              <container enabledIf="EV([right/@style], 'none', 'default') = false" type="enabledGroup">
                <input xpath="right/@color"/>
              </container>
              <input colspan="2" label="Bottom" type="separator"/>
              <input xpath="bottom/@style"/>
              <container enabledIf="EV([bottom/@style], 'none', 'default') = false" type="enabledGroup">
                <input xpath="bottom/@color"/>
              </container>
            </container>
            <container colcount="3" label="Font" xpath="font">
              <input xpath="@font"/>
              <input xpath="@style"/>
              <input noTransaction="true" width="4" xpath="@size"/>
              <input xpath="@color"/>
              <static colspan="2"/>
              <input xpath="@underline"/>
              <static colspan="2"/>
              <input xpath="@strikethrough"/>
              <static colspan="2"/>
            </container>
          </container>
        </container>
      </container>
      <input xpath="@label"/>
      <input xpath="@internalName"/>
      <input xpath="@type"/>
      <input img="xtk:formrendering.png" label="Page layout..." nolabel="true" prebuildSubForm="false" type="subformLink">
        <form label="Page layout">
          <container type="notebook">
            <container colcount="2" label="Properties">
              <input colspan="2" label="Logo" type="separator"/>
              <input colspan="2" label="Image" xpath="logo/@src"/>
              <input width="5" xpath="logo/@width"/>
              <input width="5" xpath="logo/@height"/>
              <input colspan="2" label="Preview" type="separator"/>
              <input colspan="2" nolabel="true" xpath="@preview"/>
              <input colspan="2" type="UrlViewer" urlExpr="$(serverUrl) + @preview"/>
            </container>
            <container label="Headers / Footers" maxLabelWidth="500">
              <input xpath="@displayNavigation"/>
              <container type="visibleGroup" visibleIf="EV(@displayNavigation, 'none') = false">
                <input xpath="@navigationLabel"/>
              </container>
              <container type="visibleGroup" visibleIf="EV(@displayNavigation, 'both') = false">
                <input xpath="@pageBorder"/>
              </container>
              <static label="Page headers" type="separator"/>
              <input label=" " type="list" xpath="header" zoom="true" zoomOnAdd="true">
                <input label="Left zone" xpath="left/text"/>
                <input label="Right zone" xpath="right/text"/>
                <form label="Page headers">
                  <container ref="xtk:formRendering:lib/row"/>
                </form>
              </input>
              <input label="Position" xpath="layout/@header"/>
              <static label="Page footers" type="separator"/>
              <input label=" " type="list" xpath="footer" zoom="true" zoomOnAdd="true">
                <input colsize="100" label="Left zone" xpath="left/text"/>
                <input colsize="100" label="Right zone" xpath="right/text"/>
                <form label="Page footers">
                  <container ref="xtk:formRendering:lib/row"/>
                </form>
              </input>
              <input label="Position" xpath="layout/@footer"/>
            </container>
          </container>
        </form>
      </input>
      <container colspan="2" type="visibleGroup" visibleIf="EV(@type, 'report')">
        <container toolbarAlign="horizontal" toolbarCaption="Format" type="notebookList" xpath="format" xpath-label="@name">
          <container maxLabelWidth="100">
            <input xpath="@name"/>
            <input label="Styles" type="separator"/>
            <input xpath="@defaultFontSize"/>
            <container type="visibleGroup" visibleIf="@name == 'web'">
              <input img="nms:css.png" label="CSS" xpath="@css"/>
            </container>
            <input contentType="html" nolabel="true" toolbar="false" type="CodeEdit" xpath="cssOverloading"/>
          </container>
        </container>
      </container>
      <container colspan="2" maxLabelWidth="100" type="visibleGroup" visibleIf="EV(@type, 'form')" xpath="format">
        <input label="Styles" type="separator"/>
        <input xpath="@defaultFontSize"/>
        <container type="visibleGroup" visibleIf="@name == 'web'">
          <input img="nms:css.png" label="CSS" xpath="@css"/>
        </container>
        <input contentType="html" nolabel="true" toolbar="false" type="CodeEdit" xpath="cssOverloading"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Forms (library)" md5="067F909334887ACBEADA590FAE8F3667" name="formlib" namespace="xtk" xtkschema="xtk:form">
      <form label="Expression" name="tableExpressionEdit">
        <enter>
          <set expr="[ancestor::data/@schema]" xpath="/tmp/@schema"/>
          <set expr="Iif(startWith([ancestor::data/@startPath], '['), '/'+ substring([ancestor::data/@startPath], 1, strlen([ancestor::data/@startPath])-2), [ancestor::data/@startPath])" xpath="/tmp/@startPath"/>
        </enter>
        <input choiceType="xpath" label="Expression" name="expr" nolabel="false" type="pathEdit" xpath="@expr" xpathLabel="@label" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
        <input xpath="@label"/>
        <input xpath="desc"/>
        <input xpath="@descImgPos"/>
      </form>
      <form name="variableEdit">
        <enter>
          <switch>
            <case expr="[../../../@dataSource] != 'query'">
              <set value="temp:formContext" xpath="/tmp/@schema"/>
              <set expr="Iif(startWith([../../../@startPath], '['), '/'+ substring([../../../@startPath], 1, strlen([../../../@startPath])-2), [../../../@startPath])" xpath="/tmp/@startPath"/>
            </case>
            <case expr="[../../../@schema] != ''">
              <set expr="[../../../@schema]" xpath="/tmp/@schema"/>
              <set expr="Iif(startWith([../../../@startPath], '['), '/'+ substring([../../../@startPath], 1, strlen([../../../@startPath])-2), [../../../@startPath])" xpath="/tmp/@startPath"/>
            </case>
            <default>
              <set expr="[/report/@schema]" xpath="/tmp/@schema"/>
            </default>
          </switch>
          <set translatedExpr="'Data will be calculated and displayed in the \'' + GetOption('WdbcTimeZone') + '\' time zone.'" xpath="/tmp/@wrnTimezone"/>
          <set expr="[../../../@dataSource]" xpath="/tmp/@dataSource"/>
          <set expr="false" xpath="/tmp/@allowClassingOnContext"/>
        </enter>
        <container>
          <input label="Expression" name="expr" nolabel="false" type="pathEdit" xpath="@expr" xpathLabel="@label" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
          <input xpath="@label"/>
          <container type="visibleGroup" visibleIf="[/tmp/@dataSource]='context'">
            <input xpath="@type"/>
            <container type="visibleGroup" visibleIf="@type = 'time' or @type = 'datetime' or @type = 'date'">
              <input xpath="@minClassDuration"/>
            </container>
            <container type="visibleGroup" visibleIf="@type = 'time' or @type = 'datetime' or @type = 'date'">
              <input xpath="@dateStepType"/>
            </container>
            <container type="visibleGroup" visibleIf="@type != 'automatic' and @type != 'string' and @type != 'boolean'">
              <input xpath="@stepFactor"/>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="([/tmp/@allowClassingOnContext]=true or [/tmp/@dataSource]='query') and @expr != '' and TypeOf(@expr, [/tmp/@schema]) != 'enum'">
            <input useDesc="true" xpath="@isAggregated"/>
            <container label="Binning" type="frame">
              <container colcount="4">
                <input checkedValue="0" label="None" type="radioButton" xpath="@classingType"/>
                <input checkedValue="1" label="Auto" type="radioButton" xpath="@classingType"/>
                <input checkedValue="3" label="Manual" type="radioButton" xpath="@classingType"/>
                <container enabledIf="IsNumber(@expr, [/tmp/@schema])" type="enabledGroup">
                  <input checkedValue="2" label="Modulo" type="radioButton" xpath="@classingType"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@classingType = 1">
                <container type="visibleGroup" visibleIf="IsTime(@expr, [/tmp/@schema]) == false">
                  <input xpath="@classCount"/>
                </container>
                <container type="visibleGroup" visibleIf="(IsNumber(@expr, [/tmp/@schema]) OR IsTime(@expr, [/tmp/@schema])) == false">
                  <static type="help">Only the n best bins will be kept</static>
                </container>
                <container type="visibleGroup" visibleIf="IsTime(@expr, [/tmp/@schema])">
                  <static type="help">Adobe Campaign will choose for you how to group the values (by day, week, month or year).</static>
                  <input xpath="@minClassDuration"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@classingType = 2 and IsNumber(@expr, [/tmp/@schema])">
                <input xpath="@stepFactor"/>
              </container>
              <container type="visibleGroup" visibleIf="@classingType = 3 and IsNumber(@expr, [/tmp/@schema])">
                <container colcount="3">
                  <input img="nl:runtask.png" label="Initialize with" prebuildSubForm="false" type="UrlButton">
                    <enter>
                      <set value="false" xpath="@firstStepIsLimit"/>
                      <set value="true" xpath="@lastStepIsLimit"/>
                      <soapCall name="fillSteps" service="xtk:report">
                        <param exprIn="[/tmp/@schema]" type="string"/>
                        <param exprIn="@expr" type="string"/>
                        <param exprIn="@classCount" type="int"/>
                        <param type="DOMElement" xpathOut="samplingSteps"/>
                      </soapCall>
                    </enter>
                  </input>
                  <input nolabel="true" xpath="@classCount"/>
                  <static label="classes"/>
                </container>
                <input nolabel="true" xpath="@firstStepIsLimit"/>
                <input nolabel="true" xpath="@lastStepIsLimit"/>
                <input nolabel="true" type="list" xpath="samplingSteps/samplingStep">
                  <input xpath="@mark"/>
                </input>
              </container>
              <container type="visibleGroup" visibleIf=" @classingType = 3 and IsTime(@expr, [/tmp/@schema])">
                <input xpath="@dateStepType"/>
                <container enabledIf="EV(@dateStepType, 'hour', 'minute', 'second')" type="enabledGroup">
                  <input useDesc="true" xpath="@removeDate"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@classingType = 3 and (IsNumber(@expr, [/tmp/@schema]) or IsTime(@expr, [/tmp/@schema])) == false">
                <container colcount="3">
                  <input img="nl:runtask.png" label="Initialize with" prebuildSubForm="false" type="UrlButton">
                    <enter>
                      <soapCall name="selectTopValues" service="xtk:report">
                        <param exprIn="[/tmp/@schema]" type="string"/>
                        <param exprIn="@expr" type="string"/>
                        <param exprIn="@classCount" type="int"/>
                        <param type="DOMElement" xpathOut="selectedValues"/>
                      </soapCall>
                    </enter>
                  </input>
                  <input nolabel="true" xpath="@classCount"/>
                  <static label="classes"/>
                </container>
                <input nolabel="true" type="list" xpath="selectedValues/selectedValue">
                  <input xpath="@value"/>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="(@classingType = 2 and IsNumber(@expr, [/tmp/@schema]) == false)">
                <static type="warning">The binning type is not compatible with the expression type.</static>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="GetOption('WdbcTimeZone') != '' and @classingType != 0 and IsTime(@expr, [/tmp/@schema]) and GetOption('WdbcTimeZone') != CurrentTimeZone()">
              <input img="xtk:logwarn.png" type="label" xpath="/tmp/@wrnTimezone"/>
            </container>
          </container>
        </container>
        <leave>
          <if expr="EV(@dateStepType, 'hour', 'minute', 'second') == 'false'">
            <set value="false" xpath="@removeDate"/>
          </if>
          <check expr="@classingType &lt; 2 OR (@classingType = 2 and IsNumber(@expr, [/tmp/@schema]) == false) == false">
            <error>The binning type is not compatible with the expression type.</error>
          </check>
          <check expr="@expr != ''">
            <error>You must specify an expression.</error>
          </check>
        </leave>
      </form>
      <container name="importCell">
        <static img="nms:circle-one.png">Select a source web application</static>
        <input folderFilterChoice="@model in ('nmsWebAppModel', 'nmsWebApp')" hideComboList="true" nolabel="true" schema="nms:webApp" type="linkEdit" xpath="/ignored/webApp">
          <sysFilter>
            <condition enabledIf="$(/ignored/@hasSurvey)" expr="[facet/@survey] = 1"/>
          </sysFilter>
          <enter name="onChange">
            <set value="nms:webApp" xpath="/ignored/queryDef/@schema"/>
            <set value="get" xpath="/ignored/queryDef/@operation"/>
            <set value="true" xpath="/ignored/queryDef/select/node[1]/@anyType"/>
            <set value="archivedFields" xpath="/ignored/queryDef/select/node[1]/@expr"/>
            <set value="true" xpath="/ignored/queryDef/select/node[2]/@anyType"/>
            <set value="activities" xpath="/ignored/queryDef/select/node[2]/@expr"/>
            <set expr="'@id='+[/ignored/webApp]" xpath="/ignored/queryDef/where/condition/@expr"/>
            <soapCall name="ExecuteQuery" service="xtk:queryDef">
              <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
              <param type="DOMDocument" xpathOut="/tmp/webAppSrc"/>
            </soapCall>
          </enter>
        </input>
        <static img="nms:circle-two.png">Select the block(s) to import</static>
        <input nolabel="true" type="formCellSelector" xpath="/tmp/webAppSrc" xpathSelection="/ignored/tree/@xpathSelection"/>
      </container>
      <container colspan="2" name="autoquery">
        <static label="Data source" type="separator"/>
        <container colcount="2" type="visibleGroup" visibleIf="@dataSource != 'context' and @dataSource != 'query'">
          <input xpath="@dataSource"/>
        </container>
        <container type="visibleGroup" visibleIf="@dataSource='context'">
          <input xpath="@dataSource"/>
          <input img="xtk:properties.png" label="Advanced parameters..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
            <form label="Advanced data source settings">
              <enter>
                <set expr="'temp:formContext'" xpath="@schema"/>
              </enter>
              <input choiceType="xpath" hideMappedAsXml="false" label="Data path" nolabel="false" type="pathEdit" useTablePath="true" useUnboundPath="true" xpath="@startPath" xpathSchema="@schema"/>
              <input label="You can specify the location of the data in the context but, in general, this location is deduced automatically from the data that you select." type="help"/>
            </form>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="@dataSource='query'">
          <input xpath="@dataSource"/>
          <input label="Document type" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
        </container>
        <container type="visibleGroup" visibleIf="@dataSource != 'context'">
          <input img="nms:miniatures/mini-query.png" label="Filter data..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
            <form label="Advanced data source settings">
              <input choiceType="sort" nolabel="true" toolbarAlign="horizontal" type="conditionList" xpath="where" xpathExpr="@expr" xpathHelp="/@helpCond" xpathSchema="@schema">
                <input colSize="15" label=" " xpath="/@bool-operator"/>
                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                <input colSize="15" label="Operator" xpath="/@operator"/>
                <input colSize="30" label="Value" xpath="/@rightExpr"/>
              </input>
              <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
              <input useDesc="true" xpath="@contextFilter"/>
              <input useDesc="true" xpath="@folderFilter"/>
              <container colcount="2" type="visibleGroup" visibleIf="@folderFilter">
                <input label="Local variable" type="CollectionSelect" xpath="@folderVariable" xpathSelect="$(entityPath)/variables/variable"/>
                <input label="Edit variables..." nolabel="false" prebuildSubForm="false" type="SubFormLink" xpath=".">
                  <form label="Edit branches">
                    <input editable="true" nolabel="true" prebuildSubForm="false" toolbarAlign="horizontal" type="list" xpath="$(entityPath)/variables/variable" zoom="true" zoomOnAdd="true">
                      <input colSize="20" xpath="@label"/>
                      <input colSize="20" xpath="@xpath"/>
                      <input colSize="15" xpath="@type"/>
                      <form label="Variable">
                        <container ref="xtk:formlib:variable"/>
                      </form>
                    </input>
                  </form>
                </input>
              </container>
            </form>
          </input>
        </container>
        <input fontBold="true" type="help" xpath="where/@displayFilter"/>
      </container>
      <container colcount="2" maxLabelWidth="200" name="graphDataEdit">
        <container colcount="3" colspan="2" xpath="data">
          <input alwaysActive="true" expr="Iif(@dataSource='context', Iif(startWith(@startPath, '['), '/'+ substring(@startPath, 1, strlen(@startPath)-2), @startPath), '')" type="expr" xpath="/ignored/@startPath"/>
          <input alwaysActive="true" expr="Iif(@dataSource!='context', @schema, 'temp:formContext')" type="expr" xpath="/ignored/@schema"/>
          <input alwaysActive="true" expr="Iif(@dataSource=='context', 'xpath', '')" type="expr" xpath="/ignored/@choiceType"/>
          <container colcount="3" colspan="3">
            <input label="First variable (X axis)" nolabel="false" type="pathEdit" xpath="variables/row/var[1]/@expr" xpathChoiceType="/ignored/@choiceType" xpathLabel="variables/row/var[1]/@label" xpathSchema="/ignored/@schema" xpathStartPath="/ignored/@startPath"/>
            <input xpath="variables/row/var[1]/@label"/>
            <input label="More options..." prebuildSubForm="false" type="subFormLink" xpath="variables/row/var[1]">
              <form ref="xtk:formlib:variableEdit"/>
            </input>
          </container>
          <container colcount="3" colspan="3" type="visibleGroup" visibleIf="@variableCount == '2'">
            <input label="Second variable (Z axis)" nolabel="false" type="pathEdit" xpath="variables/column/var[1]/@expr" xpathChoiceType="/ignored/@choiceType" xpathLabel="variables/column/var[1]/@label" xpathSchema="/ignored/@schema" xpathStartPath="/ignored/@startPath"/>
            <input xpath="variables/column/var[1]/@label"/>
            <input label="More options..." prebuildSubForm="false" type="subFormLink" xpath="variables/column/var[1]">
              <form ref="xtk:formlib:variableEdit"/>
            </input>
          </container>
        </container>
      </container>
      <container img="xtk:valuestats.png" label="Chart" name="graphStyleAndData">
        <container label="Data" type="frame">
          <container colcount="2" maxLabelWidth="200" name="graphData">
            <container colcount="2">
              <static img="xtk:graphxy.png" label=" "/>
              <static img="xtk:graphxyz.png" label=" "/>
              <input checkedValue="1" label="1 variable" nolabel="true" type="radioButton" xpath="data/@variableCount"/>
              <container enabledIf="EV([chart/@type], 'pie', 'radar') == false" type="enabledGroup">
                <input checkedValue="2" label="2 variables" nolabel="true" type="radioButton" xpath="data/@variableCount"/>
              </container>
            </container>
            <static/>
            <container ref="xtk:formlib:graphDataEdit"/>
          </container>
        </container>
        <container label="Chart type" type="frame">
          <container ref="xtk:formlib:graphStyle" xpath="chart"/>
        </container>
      </container>
      <container img="xtk:form/pivot.png" label="Table" name="pivot">
        <static label="Display settings" type="separator"/>
        <container xpath="table">
          <input xpath="@displayStatLabel"/>
          <input xpath="@displaySubtotal"/>
          <input maxLabelWidth="20" xpath="@statOrientation"/>
          <static/>
        </container>
        <static colspan="2" label="Select variables" type="separator"/>
        <input colspan="2" type="pivotTableEdit" xpath="data/variables">
          <form name="variableEdit" ref="xtk:formlib:variableEdit"/>
        </input>
      </container>
      <container img="xtk:form/distribution.png" label="Distribution" name="distribution">
        <container label="Select variables" name="vars" style="up" toolbarAlign="horizontal" toolbarCaption="Select variables" xpath="data/variables/row/var" xpath-label="@label" zoomOnAdd="false">
          <input label="Expression" name="expr" nolabel="false" type="pathEdit" xpath="@expr" xpathLabel="@label" xpathSchema="../../../@schema"/>
          <input xpath="@label"/>
          <container colspan="2" type="visibleGroup" visibleIf="@expr != '' and IsNumber(@expr, [../../../@schema]) = false">
            <static type="warning">The selected expression is not compatible. It must be numerical.</static>
          </container>
          <input expr="Iif(IsNumber(@expr, [../../../@schema]), Iif(TypeOf(@expr, [../../../@schema]) = 'long' or TypeOf(@expr, [../../../@schema]) = 'int64' or TypeOf(@expr, [../../../@schema]) = 'byte' or TypeOf(@expr, [../../../@schema]) = 'short', 'integer', 'real'), '')" type="expr" xpath="@type"/>
          <input checkedValue="integer" label="Integer" type="radioButton" xpath="@type"/>
          <input checkedValue="real" label="Real" type="radioButton" xpath="@type"/>
        </container>
      </container>
      <container colcount="6" name="graphStyle">
        <static img="xtk:columnChart.png" label=" "/>
        <static img="xtk:radarChart.png" label=" "/>
        <static img="xtk:filledChart.png" label=" "/>
        <static img="xtk:lineChart.png" label=" "/>
        <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
          <static img="xtk:cylinderChart.png" label=" "/>
        </container>
        <static img="xtk:pieChart.png" label=" "/>
        <container colspan="2" type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')==false">
          <static/>
        </container>
        <input checkedValue="column" label="Histogram" type="radioButton" xpath="@type"/>
        <input checkedValue="radar" label="Radar" type="radioButton" xpath="@type"/>
        <input checkedValue="filled" label="Areas" type="radioButton" xpath="@type"/>
        <input checkedValue="line" label="Curves" type="radioButton" xpath="@type"/>
        <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
          <input checkedValue="cylinder" label="Cylinders" type="radioButton" xpath="@type"/>
        </container>
        <input checkedValue="pie" label="Pie" type="radioButton" xpath="@type"/>
        <container colspan="2" type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')==false">
          <static/>
        </container>
        <input expr="Iif(EV([@type], 'pie') == true, 1, [data/@variableCount])" type="expr" xpath="data/@variableCount"/>
        <input img="xtk:properties.png" label="Variants..." prebuildSubForm="false" type="subFormLink" xpath=".">
          <form colcount="1" label="Variants of the chart">
            <container label="Display zone (in pixels)" type="frame">
              <input xpath="@width"/>
              <input xpath="@height"/>
            </container>
            <container label="General options" type="frame">
              <input xpath="@displayLabels"/>
              <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
                <input xpath="@perspective"/>
              </container>
              <container type="visibleGroup" visibleIf="EV(@type, 'pie', 'radar') == false">
                <input xpath="@accumulate"/>
              </container>
              <container type="visibleGroup" visibleIf="EV(@type, 'pie')">
                <input format="percentage" xpath="@innerPieRadius"/>
                <input xpath="@sortMode"/>
              </container>
              <container type="visibleGroup" visibleIf="EV(@type, 'pie', 'radar') == false">
                <input xpath="@stacked"/>
                <container type="visibleGroup" visibleIf="@stacked">
                  <input xpath="@reverseStacking"/>
                </container>
                <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
                  <input xpath="@reverseSeries"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
                <container type="visibleGroup" visibleIf="EV(@type, 'radar')">
                  <input xpath="@radarFilled"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV(@type, 'column', 'cylinder')">
                <input xpath="@displayEmptySamples"/>
              </container>
              <container type="visibleGroup" visibleIf="EV(@type, 'filled')">
                <input xpath="@filledOpacity"/>
              </container>
              <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
                <input xpath="@zoomOnWheel"/>
              </container>
            </container>
            <container label="Caption" type="frame">
              <input xpath="@displayLegend"/>
              <container type="visibleGroup" visibleIf="@displayLegend">
                <input xpath="@legendOver"/>
                <input xpath="@legendPosition"/>
              </container>
            </container>
          </form>
        </input>
      </container>
      <container name="statisticDetails" type="notebook">
        <container label="General">
          <enter>
            <set value="true" xpath="/tmp/@displayOperator"/>
            <switch>
              <case expr="NodeName([../..]) = 'analysis'">
                <switch>
                  <case expr="[../../@hasTable] and [../../@model]='qualitative'">
                    <set value="pivotOperator" xpath="/tmp/@enum"/>
                  </case>
                  <case expr="[../../@model]='quantitative'">
                    <set value="quantitativeOperator" xpath="/tmp/@enum"/>
                  </case>
                  <case expr="[../../@hasTable] = false and [../../@hasChart]">
                    <set value="chartOperator" xpath="/tmp/@enum"/>
                  </case>
                  <default>
                    <set value="false" xpath="/tmp/@displayOperator"/>
                  </default>
                </switch>
              </case>
              <default>
                <switch>
                  <case expr="[../@dataSource] = 'query' and NodeName([../..]) = 'chart'">
                    <set value="chartOperator" xpath="/tmp/@enum"/>
                  </case>
                  <case expr="NodeName([../..]) = 'table'">
                    <set value="pivotOperator" xpath="/tmp/@enum"/>
                  </case>
                  <default>
                    <set value="false" xpath="/tmp/@displayOperator"/>
                  </default>
                </switch>
              </default>
            </switch>
          </enter>
          <input xpath="@label"/>
          <input label="Alias" xpath="/tmp/@alias"/>
          <container type="visibleGroup" visibleIf="[/tmp/@displayOperator]">
            <input type="sysenum" xpath="@operator" xpathEnum="/tmp/@enum"/>
          </container>
          <container colspan="3" type="visibleGroup" visibleIf="@operator != 'userDefined'">
            <container type="visibleGroup" visibleIf="@operator != 'count' and StartWith(@operator, 'percentage')=false">
              <input choiceType="aggregate" nolabel="false" type="pathEdit" xpath="@aggExpr" xpathSchema="../@schema" xpathStartPath="/tmp/@startPath"/>
            </container>
          </container>
          <container colspan="3" type="visibleGroup" visibleIf="@operator == 'userDefined'">
            <input xpath="@userFunction"/>
          </container>
          <container type="visibleGroup" visibleIf="NodeName([../..]) = 'analysis' and [../../@hasChart] and (@operator = 'userDefined' or @operator = 'percentageRow' or @operator = 'percentageColumn')">
            <static type="warning">This operator is incompatible with the chart. This statistic will only be displayed in the table.</static>
          </container>
        </container>
        <container label="Advanced">
          <enter>
            <if expr="@useDefaultFormat == true">
              <set value="number" xpath="@format"/>
              <if expr="StartWith(@operator, 'percentage')">
                <set value="percentage" xpath="@format"/>
                <set value="2" xpath="@decimalPlaces"/>
              </if>
              <if expr="@operator == 'count'">
                <set value="0" xpath="@decimalPlaces"/>
              </if>
            </if>
            <if expr="[/tmp/@form]='OnAdd' and [/tmp/@edited]=false and [/tmp/@onlyChart] = false and (@operator = 'percentageRow' or @operator = 'percentageColumn' or @operator='userDefined')">
              <set value="false" xpath="@inChart"/>
            </if>
            <if expr="[/tmp/@form]='OnAdd' and [/tmp/@edited]=false and @operator = 'percentageTotal'">
              <set value="false" xpath="@inChart"/>
            </if>
            <set value="true" xpath="/tmp/@edited"/>
          </enter>
          <container type="visibleGroup" visibleIf="[../../@hasTable]">
            <input xpath="@inTable"/>
          </container>
          <container type="visibleGroup" visibleIf="[../../@hasChart]">
            <input xpath="@inChart"/>
          </container>
          <input xpath="@useAsCounting"/>
          <static colspan="3" label="Formatting" type="separator"/>
          <input xpath="@useDefaultFormat"/>
          <container type="visibleGroup" visibleIf="@useDefaultFormat == false">
            <input checkedValue="number" label="Number" type="radioButton" xpath="@format"/>
            <input checkedValue="percentage" label="Percentage" type="radioButton" xpath="@format"/>
            <input checkedValue="currency" label="Currency" type="radioButton" xpath="@format"/>
            <input xpath="@decimalPlaces"/>
            <input xpath="@use1000Sep"/>
          </container>
          <container colspan="3" type="visibleGroup" visibleIf="NodeName([../..]) = 'chart'">
            <static label="Marker" type="separator"/>
            <input label="Edit the markers..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
              <form colcount="1" label="Markers">
                <input editable="true" nolabel="true" toolbarAlign="horizontal" type="list" xpath="marker" zoom="true" zoomOnAdd="true">
                  <input colSize="20" xpath="@abscissaExpr"/>
                  <input colSize="20" xpath="@hline"/>
                  <input colSize="20" xpath="@vline"/>
                  <input colSize="20" xpath="@isLabel"/>
                  <form label="Marker">
                    <container>
                      <input xpath="@atTheEnd"/>
                      <container enabledIf="Iif(@atTheEnd, false, true)" type="enabledGroup">
                        <input xpath="@abscissaExpr"/>
                      </container>
                      <input xpath="@hline"/>
                      <input xpath="@vline"/>
                      <input xpath="@isLabel"/>
                    </container>
                  </form>
                </input>
              </form>
            </input>
          </container>
        </container>
        <container label="Thresholds" visibleIf="@operator == 'distribution'">
          <input nolabel="true" type="list" xpath="percentile">
            <input xpath="@threshold"/>
          </input>
        </container>
        <container label="Filter" visibleIf="EV(@operator, 'distribution', 'missingCount', 'decile', 'userDefined') = false and [../@schema]!='temp:formContext'">
          <input name="filterList" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="/@helpCond" xpathSchema="../@schema">
            <input colSize="15" label=" " xpath="/@bool-operator"/>
            <input colSize="30" label="Expression" xpath="/@leftExpr"/>
            <input colSize="15" label="Operator" xpath="/@operator"/>
            <input colSize="30" label="Value" xpath="/@rightExpr"/>
          </input>
          <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
        </container>
      </container>
      <container name="statistic">
        <enter>
          <if expr="NodeName([../..]) ='analysis'">
            <set expr="[../../@model]" xpath="/tmp/@analysisModel"/>
          </if>
        </enter>
        <input alwaysActive="true" expr="Iif(NodeName([../..]) = 'analysis', Iif([/tmp/@analysisModel] != 'quantitative', Iif([../../@hasTable] = false and [../../@hasChart], 'xtk:abstractForm:chartOperator', 'xtk:abstractForm:pivotOperator'), 'quantitativeOperator'), Iif(NodeName([../..]) = 'table', 'xtk:abstractForm:pivotOperator', 'xtk:abstractForm:chartOperator'))" type="expr" xpath="/ignored/@operatorEnumName"/>
        <input formName="edition" name="statistics" nolabel="true" ordered="true" prebuildSubForm="false" type="list" xpath="." zoom="true" zoomOnAdd="true">
          <input xpath="@label"/>
          <input type="sysenum" xpath="@operator" xpathEnum="/ignored/@operatorEnumName"/>
          <input xpath="@alias"/>
          <form label="Statistic" name="OnAdd">
            <enter>
              <set expr="Iif(startWith([../@startPath], '['), '/'+ substring([../@startPath], 1, strlen([../@startPath])-2), [../@startPath])" xpath="/tmp/@startPath"/>
              <set value="OnAdd" xpath="/tmp/@form"/>
              <set value="false" xpath="/tmp/@edited"/>
              <set expr="@alias" xpath="/tmp/@alias"/>
            </enter>
            <container ref="xtk:formlib:statisticDetails"/>
            <leave>
              <set expr="[/tmp/@alias]" xpath="@alias"/>
              <if expr="@operator = 'percentageRow' or @operator = 'percentageColumn' or @operator='userDefined'">
                <set value="false" xpath="@inChart"/>
              </if>
              <if expr="[/tmp/@edited]=false and @operator = 'percentageTotal' and count([../statistic])!=1">
                <set value="false" xpath="@inChart"/>
              </if>
            </leave>
          </form>
          <form label="Edit statistic" name="edition">
            <enter>
              <set expr="Iif(startWith([../@startPath], '['), '/'+ substring([../@startPath], 1, strlen([../@startPath])-2), [../@startPath])" xpath="/tmp/@startPath"/>
              <set value="edition" xpath="/tmp/@form"/>
              <set expr="@alias" xpath="/tmp/@alias"/>
            </enter>
            <container ref="xtk:formlib:statisticDetails"/>
            <leave>
              <set expr="[/tmp/@alias]" xpath="@alias"/>
              <if expr="@operator = 'percentageRow' or @operator = 'percentageColumn' or @operator='userDefined'">
                <set value="false" xpath="@inChart"/>
              </if>
            </leave>
          </form>
        </input>
      </container>
      <container name="cellVisibility">
        <input label="Visibility" type="separator"/>
        <input label="Edit..." prebuildSubForm="false" type="subFormLink" xpath="visibleIf">
          <form label="Visibility condition">
            <container ref="xtk:formlib:conditionList"/>
          </form>
        </input>
        <input fontBold="true" type="help" xpath="visibleIf/@help"/>
      </container>
      <container name="conditionList">
        <input nolabel="true" schema="temp:formContext" toolbarAlign="horizontal" toolbarCaption="Test conditions" type="ContextConditionList" xpath="condition" xpathHelp="@help">
          <input colSize="8" label=" " xpath="@boolOperator"/>
          <input colSize="30" label="Expression" xpath="@leftExpr"/>
          <input colSize="15" label="Operator" xpath="@operator"/>
          <input colSize="30" label="Value" xpath="@rightExpr"/>
        </input>
      </container>
      <container label="Edit" name="pageEdit" type="webAppPageEditor">
        <container addSchemaMenuXPath="$(entityPath)/@schema" autoAddForms="true" isE4X="true" menuId="globalStringCatcher" prefix="ctx." type="customMenuBuilder">
          <form label="Selection of a global string" name="lookForGlobalString">
            <input applicableIf="$(contextSchema)='nms:webApp'" disableDefaultFilter="true" extraColumns="@sourceId,@text" monoSelection="true" schema="xtk:dictionaryString" toolbarCaption="Filters" type="linkListChoice" xpath="/ignored/aze" xpathInsert="/ignored/qsd" xpathOut="/tmp/selectedString">
              <input xpath="@sourceId"/>
              <input xpath="@text"/>
              <orderBy>
                <node expr="@text"/>
              </orderBy>
              <sysFilter>
                <condition expr="@context = 'global'"/>
              </sysFilter>
            </input>
            <leave>
              <set expr="'$(' + [/tmp/selectedString/dictionaryString/@sourceId] + ')'" xpath="@cmd"/>
              <set expr="[/tmp/selectedString/dictionaryString/@text]" xpath="@label"/>
            </leave>
          </form>
        </container>
        <input toolbarAlign="horizontal" type="toolbarCtrl">
          <input applicableIf="$(contextSchema)='nms:webApp'" commandName="AssistedCellAdd" img="xtk:form/wand.png" label="Add using the wizard"/>
          <input applicableIf="$(contextSchema)='nms:webApp'" commandName="ImportCell" img="xtk:form/import.png" label="Import an existing block..."/>
          <input applicableIf="$(contextSchema)='nms:webApp'" type="CIconSep"/>
          <input img="xtk:form/inputControls.png" label="Input controls" name="AddInput" type="CXawPageEditorToolbarBtn"/>
          <input img="xtk:form/selectControls.png" label="Selection controls" name="AddSelect" type="CXawPageEditorToolbarBtn"/>
          <input img="xtk:form/html.png" label="Static elements" name="AddStatic" type="CXawPageEditorToolbarBtn"/>
          <input applicableIf="$(contextSchema)='nms:webApp'" img="xtk:form/linkedit.png" label="Advanced controls" name="AddWebAppAdvanced" type="CXawPageEditorToolbarBtn"/>
          <input applicableIf="$(contextSchema)='xtk:report'" img="xtk:form/linkedit.png" label="Advanced controls" name="AddReportAdvanced" type="CXawPageEditorToolbarBtn"/>
          <input img="xtk:form/containerV2.png" label="Containers" name="AddContainer" type="CXawPageEditorToolbarBtn"/>
          <input applicableIf="$(contextSchema)='nms:webApp'" img="xtk:form/tabular.png" label="Tables" name="AddWebAppTable" type="CXawPageEditorToolbarBtn" visibleIf="[facet/@advanced]"/>
          <input applicableIf="$(contextSchema)='nms:webApp'" img="xtk:form/column.png" label="Charts" name="AddWebAppChart" type="CXawPageEditorToolbarBtn" visibleIf="[facet/@advanced]"/>
          <input applicableIf="$(contextSchema)='xtk:report'" img="xtk:form/tabular.png" label="Tables" name="AddReportTable" type="CXawPageEditorToolbarBtn"/>
          <input applicableIf="$(contextSchema)='xtk:report'" img="xtk:form/column.png" label="Charts" name="AddReportChart" type="CXawPageEditorToolbarBtn"/>
          <input type="CIconSep"/>
          <input applicableIf="HasPackage('nms:survey') and $(contextSchema)='nms:webApp'" commandName="AddLibrary" img="xtk:form/question.png" label="Answer to a question" visibleIf="[facet/@survey]"/>
          <input applicableIf="$(contextSchema)='nms:webApp'" commandName="AddPath" img="nms:recipient.png" label="Attendee information"/>
          <input applicableIf="$(contextSchema)='nms:webApp'" commandName="AddVar" img="xtk:form/variable16.png" label="Variable"/>
          <input type="CIconSep"/>
          <input commandName="CellMoveUp" img="xtk:arrowup.png"/>
          <input commandName="CellMoveDown" img="xtk:arrowdn.png"/>
          <input commandName="Cut" img="xtk:cut.png"/>
          <input commandName="Copy" img="xtk:copy.png"/>
          <input commandName="Paste" img="xtk:paste.png"/>
          <input type="CIconSep"/>
          <input commandName="CellDelete" img="xtk:delete.png"/>
        </input>
        <static type="separator"/>
        <container type="vpaned">
          <input filter="input,container,link,html,label,list,image,hrule,page,table,chart,value,matrix,matrixRow,javascript,pageBreak,gauge,kpi,funnel,offerProposition,tracker" name="pageEditorTree" type="formDesignTree" xpath="." xpathSelection="/ignored/tree/@xpathSelection" xpathSelectionType="/ignored/tree/@selectionType">
            <menu applicableIf="$(contextSchema)='nms:webApp'" label="Add using the wizard..." name="addCell"/>
            <menu label="Containers" name="AddContainer">
              <menu element="container" img="xtk:form/container.png" label="Standard" name="container"/>
              <menu applicableIf="$(contextSchema)='nms:webApp'" element="container" img="xtk:form/question.png" label="Question" name="question" visibleIf="[/ignored/@hasSurvey] = 1 or [/ignored/@hasSurvey] = true"/>
            </menu>
            <menu label="Input controls" name="AddInput">
              <menu element="input" img="xtk:form/text.png" label="Text" name="text"/>
              <menu element="input" img="xtk:form/number.png" label="Number" name="numeric"/>
              <menu element="input" img="xtk:form/password.png" label="Password" name="password" visibleIf="@entitySchema!='xtk:report'"/>
              <menu element="input" img="xtk:form/textarea.png" label="Multi-line text" name="textarea" visibleIf="@entitySchema!='xtk:report'"/>
              <menu element="input" img="xtk:form/textarea.png" label="HTML text" name="richTextArea" visibleIf="@entitySchema!='xtk:report'"/>
            </menu>
            <menu label="Selection controls" name="AddSelect">
              <menu element="input" img="xtk:form/select.png" label="Combo box" name="select"/>
              <menu element="input" img="xtk:form/checkbox.png" label="Checkbox" name="checkbox"/>
              <menu element="input" img="xtk:form/radio.png" label="Radio button" name="radio"/>
              <menu element="input" img="xtk:form/radiolist.png" label="Multiple choice" name="radiolist"/>
              <menu element="input" img="xtk:form/date.png" label="Date" name="date"/>
              <menu img="xtk:form/matrix.png" label="Grid">
                <menu element="matrix" img="xtk:form/matrix.png" label="Simple grid" name="matrix"/>
                <menu element="matrixRow" img="xtk:form/matrixRow.png" label="Grid line" name="matrixRow"/>
              </menu>
            </menu>
            <menu applicableIf="$(contextSchema)='nms:webApp'" label="Advanced controls" name="AddWebAppAdvanced">
              <menu element="input" img="xtk:form/file.png" label="File" name="file"/>
              <menu element="input" img="xtk:form/subscription.png" label="Subscription" name="subscription" visibleIf="@schema='nms:recipient'"/>
              <menu element="input" img="xtk:form/linkedit.png" label="Link editor" name="linkEdit" visibleIf="[facet/@advanced]"/>
              <menu element="input" img="xtk:form/constant.png" label="Constant" name="constant"/>
              <menu element="input" img="xtk:form/captcha.png" label="Captcha" name="captcha"/>
              <menu element="input" img="xtk:form/folder.png" label="Select folder" name="folderSelector" visibleIf="[facet/@advanced]"/>
            </menu>
            <menu applicableIf="$(contextSchema)='xtk:report'" label="Advanced controls" name="AddReportAdvanced">
              <menu element="input" img="xtk:form/linkedit.png" label="Link editor" name="linkEdit"/>
              <menu element="input" img="xtk:form/constant.png" label="Constant" name="constant"/>
              <menu element="input" img="xtk:form/folder.png" label="Select folder" name="folderSelector"/>
            </menu>
            <menu label="Static elements" name="AddStatic">
              <menu element="value" img="xtk:form/constant.png" label="Value" name="value"/>
              <menu element="link" img="xtk:form/link.png" label="Link" name="link"/>
              <menu element="html" img="xtk:form/html.png" label="HTML" name="html"/>
              <menu element="image" img="xtk:form/image.png" label="Image" name="image"/>
              <menu element="hrule" img="xtk:form/hsep.png" label="Horizontal bar" name="hrule"/>
              <menu applicableIf="$(contextSchema)='nms:webApp'" element="tracker" img="nms:micrositeTracker.png" label="Tracking tag" name="tracker"/>
              <menu element="javascript" img="xtk:form/script.png" label="Script" name="script"/>
              <menu applicableIf="$(contextSchema)='nms:webApp'" element="offerProposition" img="nms:offerMgt.png" label="Offer proposition" name="offerProposition" visibleIf="HasPackage('nms:interaction')"/>
              <menu applicableIf="$(contextSchema)='nms:webApp'" element="list" img="xtk:form/tabular.png" label="List" name="list" visibleIf="[facet/@advanced]"/>
              <menu element="pageBreak" img="xtk:form/pagebreak.png" label="Page break" name="pageBreak" visibleIf="@entitySchema='xtk:report'"/>
              <menu element="kpi" img="xtk:form/kpi.png" label="KPI" name="kpi" visibleIf="@entitySchema='xtk:report' and EV([$(entityPath)/properties/@renderingEngine], 'postV6')"/>
            </menu>
            <menu applicableIf="$(contextSchema)='nms:webApp'" label="Add a chart" name="AddWebAppChart" visibleIf="[facet/@advanced]">
              <menu element="chart" img="xtk:form/column.png" label="Histogram" name="column"/>
              <menu element="chart" img="xtk:form/pie.png" label="Pie" name="pie"/>
              <menu element="chart" img="xtk:form/radar.png" label="Radar" name="radar"/>
              <menu element="chart" img="xtk:form/filled.png" label="Areas" name="filled"/>
              <menu element="chart" img="xtk:form/line.png" label="Curves" name="line"/>
              <menu element="chart" img="xtk:form/cylinder.png" label="Cylinders" name="cylinder" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')"/>
              <menu element="funnel" img="xtk:form/funnel.png" label="Funnel" name="funnel"/>
              <menu element="gauge" img="xtk:form/gauge.png" label="Gauge" name="gauge" visibleIf="[facet/@advanced]"/>
            </menu>
            <menu applicableIf="$(contextSchema)='xtk:report'" label="Add a chart" name="AddReportChart">
              <menu element="chart" img="xtk:form/column.png" label="Histogram" name="column"/>
              <menu element="chart" img="xtk:form/pie.png" label="Pie" name="pie"/>
              <menu element="chart" img="xtk:form/radar.png" label="Radar" name="radar"/>
              <menu element="chart" img="xtk:form/filled.png" label="Areas" name="filled"/>
              <menu element="chart" img="xtk:form/line.png" label="Curves" name="line"/>
              <menu element="chart" img="xtk:form/cylinder.png" label="Cylinders" name="cylinder" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')"/>
              <menu element="funnel" img="xtk:form/funnel.png" label="Funnel" name="funnel"/>
              <menu element="gauge" img="xtk:form/gauge.png" label="Gauge" name="gauge"/>
            </menu>
            <menu applicableIf="$(contextSchema)='nms:webApp'" label="Add a table" name="AddWebAppTable" visibleIf="[facet/@advanced]">
              <menu element="table" img="xtk:form/pivot.png" label="Pivot table" name="pivot"/>
              <menu element="table" img="xtk:form/tabular.png" label="List with group" name="tabular"/>
              <menu element="table" img="xtk:form/distribution.png" label="Distribution" name="distribution"/>
            </menu>
            <menu applicableIf="$(contextSchema)='xtk:report'" label="Add a table" name="AddReportTable">
              <menu element="table" img="xtk:form/cubeExplorer.png" label="Pivot table" name="cubeExplorer"/>
              <menu element="table" img="xtk:form/tabular.png" label="List with group" name="tabular"/>
              <menu element="table" img="xtk:form/distribution.png" label="Distribution" name="distribution"/>
              <menu element="table" img="xtk:form/pivot.png" label="Pivot table (v5 compatibility)" name="pivot"/>
            </menu>
            <menu applicableIf="$(contextSchema)='nms:webApp'" label="Import an existing block..." name="importCell"/>
            <form label="Import an existing block" name="importCell">
              <container ref="xtk:formlib:importCell"/>
            </form>
            <form label="Storage" name="storageMode">
              <enter>
                <set expr="iif([$(entityPath)/@entitySchema]='xtk:report' or @type='folderSelector', 'var', iif([/ignored/@hasSurvey], 'library', 'xpath'))" xpath="storage/@mode"/>
              </enter>
              <container ref="xtk:formlib:storageMode"/>
            </form>
            <form label="Storage" name="valueEdit">
              <enter>
                <reset xpath="/tmp/newField"/>
              </enter>
              <static fontBold="true" label="Available fields:"/>
              <container colcount="2">
                <static img="xtk:filter.png" type="image"/>
                <input catchReturnKey="true" label="Find" type="edit" xpath="/ignored/@search"/>
              </container>
              <input dblClickAction="btnOk" expandXPath="true" hideCalculated="false" hideMappedAsXml="false" name="fieldChoice" schema="temp:formContext" showLink1N="hide" type="schemaview" xpathExpr="/tmp/newField/@xpath" xpathFilterByTypes="/ignored/@filterTypes" xpathHelp="/ignored/@help" xpathSearchPath="/ignored/@search" xpathStartPath="/ignored/@startPath"/>
              <input type="help" xpath="/ignored/@help"/>
            </form>
            <form label="Field creation wizard" name="inputWizard" type="wizard">
              <enter>
                <reset xpath="/tmp/newField"/>
                <if expr="[/tmp/@modeSelected]!=1">
                  <set expr="iif([/ignored/@hasSurvey], 'library', 'xpath')" xpath="/ignored/newField/@mode"/>
                </if>
                <switch>
                  <case expr="([$(entityPath)/facet/@advanced] = false or [/ignored/@hasSurvey] or [/ignored/@hasPurl] or [/ignored/@hasLead]) = false">
                    <set translatedExpr="'Edit the profile of a ' + Lower(SchemaLabel([$(entityPath)/@schema]))" xpath="/tmp/@xpathModeLabel"/>
                  </case>
                  <default>
                    <set translatedExpr="'Edit a ' + Lower(SchemaLabel([$(entityPath)/@schema]))" xpath="/tmp/@xpathModeLabel"/>
                  </default>
                </switch>
                <if expr="[/tmp/@modeSelected]=1">
                  <set value="true" xpath="/tmp/newField/@preload"/>
                  <set value="true" xpath="/tmp/newField/@newField"/>
                  <set value="text" xpath="/tmp/newField/@type"/>
                  <set value="false" xpath="/tmp/newField/storage/@unbound"/>
                  <set value="DDMNY4" xpath="/tmp/newField/@dateFormat"/>
                  <set value="none" xpath="/tmp/newField/@timeFormat"/>
                </if>
              </enter>
              <container desc="This wizard lets you create a personalized form field: input field, question, drop-down list, etc." title="Add a form field" visibleIf="[/tmp/@modeSelected] != 1">
                <container applicableIf="$(contextSchema)='nms:webApp'" type="visibleGroup" visibleIf="[/ignored/@hasSurvey]">
                  <container colcount="2" nolabel="true" padding-bottom="4" padding-left="8" padding-right="8" padding-top="4" type="frame">
                    <container>
                      <static img="xtk:form/question32.png" rowspan="2" type="image"/>
                    </container>
                    <container unbound-width="true">
                      <static font-size="14" label="Answer a question" unbound-width="true"/>
                      <input checkedValue="library" label="You want to save all values entered, even when a participant fills in the form more than once." type="radiobutton" xpath="/ignored/newField/@mode"/>
                    </container>
                  </container>
                </container>
                <container colcount="2" nolabel="true" padding-bottom="4" padding-left="8" padding-right="8" padding-top="4" propagateConstraints="true" type="frame">
                  <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" propagateConstraints="true" type="visibleGroup" visibleIf="[$(entityPath)/facet/@advanced] = false or [/ignored/@hasSurvey] or [/ignored/@hasPurl] or [/ignored/@hasLead]">
                    <container>
                      <static img="xtk:form/entity.png" rowspan="2" type="image"/>
                    </container>
                    <container unbound-width="true">
                      <input font-size="14" fontBold="true" type="label" xpath="/tmp/@xpathModeLabel"/>
                      <input checkedValue="xpath" label="You want to save only the last value entered for each participant." type="radiobutton" xpath="/ignored/newField/@mode"/>
                    </container>
                  </container>
                  <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" propagateConstraints="true" type="visibleGroup" visibleIf="([$(entityPath)/facet/@advanced] = false or [/ignored/@hasSurvey] or [/ignored/@hasPurl] or [/ignored/@hasLead]) = false">
                    <container>
                      <static img="xtk:form/entity.png" rowspan="2" type="image"/>
                    </container>
                    <container unbound-width="true">
                      <input font-size="14" fontBold="true" type="label" xpath="/tmp/@xpathModeLabel"/>
                      <input checkedValue="xpath" label="You want to change information on the entity being edited." type="radiobutton" xpath="/ignored/newField/@mode"/>
                    </container>
                  </container>
                  <container applicableIf="$(contextSchema)='xtk:report'" colcount="2" propagateConstraints="true" type="visibleGroup" visibleIf="true">
                    <container>
                      <static img="xtk:form/entity.png" rowspan="2" type="image"/>
                    </container>
                    <container unbound-width="true">
                      <static font-size="14" label="Filter entities" unbound-width="true"/>
                      <input checkedValue="xpath" label="You want to change information on the entity being edited." type="radiobutton" xpath="/ignored/newField/@mode"/>
                    </container>
                  </container>
                </container>
                <container colcount="2" nolabel="true" padding-bottom="4" padding-left="8" padding-right="8" padding-top="4" type="frame">
                  <container>
                    <static img="xtk:form/variable32.png" rowspan="2" type="image"/>
                  </container>
                  <container unbound-width="true">
                    <static font-size="14" label="Add a variable" unbound-width="true"/>
                    <input checkedValue="var" label="You want to use variable fields whose content will not be saved." type="radiobutton" xpath="/ignored/newField/@mode"/>
                  </container>
                </container>
                <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" type="visibleGroup" visibleIf="true">
                  <container colcount="2" nolabel="true" padding-bottom="4" padding-left="8" padding-right="8" padding-top="4" type="frame">
                    <container>
                      <static img="xtk:form/import32.png" rowspan="2" type="image"/>
                    </container>
                    <container unbound-width="true">
                      <static font-size="14" label="Import an existing question" unbound-width="true"/>
                      <input checkedValue="import" label="You want to use one or more questions created in other forms." type="radiobutton" xpath="/ignored/newField/@mode"/>
                    </container>
                  </container>
                </container>
              </container>
              <container desc="Choose the field to enter." img="xtk:form/entity.png" title="Edit profile" visibleIf="[/ignored/newField/@mode] = 'xpath'">
                <enter>
                  <set value="true" xpath="/tmp/newField/@preload"/>
                </enter>
                <static fontBold="true" label="Available fields:"/>
                <container colcount="2">
                  <static img="xtk:filter.png" type="image"/>
                  <input catchReturnKey="true" label="Find" type="edit" xpath="/ignored/@search"/>
                </container>
                <input dblClickAction="wizFinish" expandXPath="true" hideCalculated="true" hideMappedAsXml="true" name="fieldChoice" showLink1N="hide" type="schemaview" xpath="$(entityPath)/@schema" xpathExpr="/tmp/newField/storage/@xpath" xpathFilter="/ignored/@filter" xpathFilterByTypes="/ignored/@filterTypes" xpathHelp="/ignored/@help" xpathSearchPath="/ignored/@search" xpathSelect="/tmp/newField/storage/@xpath" xpathStartPath="/ignored/@startPath" xpathUseTablePath="/ignored/@useTablePath"/>
                <input type="help" xpath="/ignored/@help"/>
                <container type="visibleGroup" visibleIf="([/tmp/newField/storage/@enum]!='' or [/tmp/newField/storage/@userEnum]!='') or [/tmp/newField/storage/@type]='link'">
                  <input label="Pre-enter with the values in the field" type="checkBox" xpath="/tmp/newField/@preload"/>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" desc="Configure input zone for answer(s) to a question." img="xtk:form/question32.png" title="Answer to a question" visibleIf="[/ignored/newField/@mode] = 'library'">
                <enter>
                  <set value="true" xpath="/tmp/newField/@newField"/>
                  <set value="text" xpath="/tmp/newField/@type"/>
                  <set value="false" xpath="/tmp/newField/storage/@unbound"/>
                  <set value="DDMNY4" xpath="/tmp/newField/@dateFormat"/>
                  <set value="none" xpath="/tmp/newField/@timeFormat"/>
                </enter>
                <input label="New field" type="radioButton" xpath="/tmp/newField/@newField"/>
                <input checkedValue="false" label="Existing field" type="radioButton" xpath="/tmp/newField/@newField"/>
                <container type="visibleGroup" visibleIf="[/tmp/newField/@newField]">
                  <input label="Label" xpath="/tmp/newField/@label"/>
                  <input enum="xtk:abstractForm:inputType" label="Type" type="sysEnum" xpath="/tmp/newField/@type"/>
                  <input label="There are several possible answers" type="checkbox" xpath="/tmp/newField/storage/@unbound"/>
                  <container type="visibleGroup" visibleIf="[/tmp/newField/@type] = 'numeric'">
                    <input label="Decimal" type="checkbox" xpath="/tmp/newField/storage/@decimal"/>
                  </container>
                  <container colcount="2" propagateConstraints="true" type="visibleGroup" visibleIf="[/tmp/newField/@type] = 'date'">
                    <input enum="xtk:abstractForm:dateFormat" label="Date format" type="sysEnum" xpath="/tmp/newField/@dateFormat"/>
                    <input enum="xtk:abstractForm:timeFormat" label="Time format" type="sysEnum" xpath="/tmp/newField/@timeFormat"/>
                  </container>
                </container>
                <container applicableIf="$(contextSchema)='nms:webApp' and hasPackage('nms:survey')" type="visibleGroup" visibleIf="[/tmp/newField/@newField] = false">
                  <input choiceType="condition" hideCalculated="true" hideMappedAsXml="false" label="Archived field" noTransaction="true" nolabel="false" schemaExpr="iif([/ignored/@archivedFieldSchemaEdit] != '', [/ignored/@archivedFieldSchemaEdit], [/webApp/@archivedFieldSchema])" type="pathEdit" useUnboundPath="true" xpath="/tmp/newField/storage/field/@xpath" xpathBaseType="/tmp/newField/storage/@type" xpathEnum="/tmp/newField/storage/@enum" xpathLabel="/tmp/newField/@label" xpathSchemaMd5="/ignored/@md5Library" xpathUnbound="/tmp/newField/storage/@unbound" xpathUserEnum="/tmp/newField/storage/@userEnum" zoom="true"/>
                  <container colcount="2" propagateConstraints="true">
                    <container type="visibleGroup" visibleIf="[storage/field/@xpath]!=''">
                      <input label="Edit the field..." mode="edit" nolabel="true" prebuildSubForm="false" type="archivedFieldEdit" xpath="/webApp/archivedFields/field">
                        <form label="Edit archived field" xpath=".">
                          <container ref="xtk:formlib:archivedField"/>
                          <leave>
                            <set expr="SubString([userEnum/@name], 0,128)" xpath="userEnum/@name"/>
                          </leave>
                        </form>
                      </input>
                    </container>
                  </container>
                </container>
              </container>
              <container desc="Configuring the input zone to act on survey execution." img="xtk:form/variable32.png" title="Add a form field" visibleIf="[/ignored/newField/@mode] = 'var'">
                <enter>
                  <set value="true" xpath="/tmp/newField/@newField"/>
                  <set value="text" xpath="/tmp/newField/@type"/>
                </enter>
                <input label="New variable" type="radioButton" xpath="/tmp/newField/@newField"/>
                <input checkedValue="false" label="Existing variable" type="radioButton" xpath="/tmp/newField/@newField"/>
                <container type="visibleGroup" visibleIf="[/tmp/newField/@newField]">
                  <input label="Label" xpath="/tmp/newField/@label"/>
                  <input label="Name" type="computeNameEdit" xpath="/tmp/newField/@name" xpathRef="/tmp/newField/@label"/>
                  <input enum="xtk:abstractForm:inputType" label="Editor" type="sysEnum" xpath="/tmp/newField/@type"/>
                </container>
                <container type="visibleGroup" visibleIf="[/tmp/newField/@newField] = false">
                  <input label="Variable" type="CollectionSelect" xpath="/tmp/newField/storage/variable/@xpath" xpathSelect="$(entityPath)/variables/variable">
                    <xcopy dst="storage/@type" src="@type"/>
                  </input>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" desc="Import an existing block..." title="Add an input zone" visibleIf="[/ignored/newField/@mode] = 'import'">
                <container ref="xtk:formlib:importCell"/>
              </container>
            </form>
          </input>
          <container padding-left="2">
            <container type="notebook">
              <container label="General" name="general">
                <container name="page" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='page'">
                  <container alwaysActive="true" colcount="2" filter="/page$" type="collectionItemGroup" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" menuId="globalStringCatcher" type="scriptEdit" xpath="@label"/>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input xpath="@labelPosition"/>
                    <input xpath="@colcount"/>
                    <static colspan="2" label="Navigation" type="separator"/>
                    <input colspan="2" label="Disallow returning to the previous page" xpath="@disablePreviousButton"/>
                    <input colspan="2" label="Disable next page" xpath="@disableNextButton"/>
                    <input colspan="2" label="Enable outbound transitions" xpath="transitions/next/@enabled"/>
                    <static colspan="2" label="Outbound transitions" type="separator"/>
                    <container colspan="2" type="visibleGroup" visibleIf="[transitions/next/@enabled]">
                      <input editable="true" label=" " type="list" xpath="transitions/next">
                        <input xpath="@name"/>
                        <input xpath="@label"/>
                        <input xpath="@useLabelAsButtonName"/>
                        <input xpath="@ignoreErrors"/>
                      </input>
                    </container>
                    <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@hasSurvey]">
                      <static colspan="2" label="Randomly select questions" type="separator"/>
                      <input label="Display randomly" xpath="@randomQuestions"/>
                      <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@randomQuestions">
                        <input noTransaction="true" nolabel="true" width="6" xpath="@randomQuestionsLimit"/>
                        <static label="question(s)"/>
                      </container>
                      <container colspan="2" type="visibleGroup" visibleIf="@randomQuestions=false">
                        <static/>
                      </container>
                    </container>
                  </container>
                </container>
                <container type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='input'">
                  <container alwaysActive="true" colcount="2" filter="/input$" type="collectionItemGroup" xpath="input" xpathSelection="/ignored/tree/@xpathSelection">
                    <input menuId="globalStringCatcher" type="scriptEdit" xpath="@label"/>
                    <input enum="inputType" type="sysenum" xpath="@type"/>
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type!='folderSelector'">
                      <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type!='radio' and (@type='radiolist' and [storage/@multipleChoice]=true)=false">
                        <container enabledIf="@type!='captcha'" type="enabledGroup">
                          <input xpath="@required"/>
                        </container>
                        <container enabledIf="@required=true or @type='captcha'" type="enabledGroup">
                          <input label="Personalize the message..." prebuildSubForm="false" type="SubformLink" xpath=".">
                            <form label="Message personalization">
                              <static label="Enter the text to display if the field is left empty." type="help"/>
                              <input nolabel="true" xpath="requiredLog"/>
                            </form>
                          </input>
                        </container>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@type='folderSelector'">
                      <static label="Interactions" type="separator"/>
                      <input enumName="folderSelectAction" label="Action to perform when selecting a folder" xpath="@action"/>
                      <container type="visibleGroup" visibleIf="@action='transition'">
                        <input type="CollectionSelect" xpath="@transition" xpathSelect="ancestor::page/transitions/next"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@action='javascript'">
                        <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarCaption="JavaScript" type="CodeEdit" xpath="onChangeJavascript"/>
                      </container>
                    </container>
                    <container colcount="2" colspan="2" propagateConstraints="true" type="visibleGroup" visibleIf="@type!='subscription' and @type!='captcha'">
                      <static colspan="2" label="Storage" type="separator"/>
                      <container backcolor="tooltip" colcount="2" colspan="2" padding="10" type="visibleGroup" visibleIf="[storage/@xpath] == '' and [storage/field/@xpath] == '' and [storage/variable/@xpath] == ''">
                        <input fontBold="true" label="Please specify storage" type="warning"/>
                        <input label="Edit storage..." prebuildSubForm="false" type="subFormLink" xpath=".">
                          <form label="Storage">
                            <container ref="xtk:formlib:storageMode"/>
                          </form>
                        </input>
                      </container>
                      <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[storage/@xpath] != '' or [storage/field/@xpath] != '' or [storage/variable/@xpath] != ''">
                        <input expr="EL([storage/@mode]) + ' (' + iif([storage/@mode] = 'xpath', [storage/@xpath], iif([storage/@mode] = 'var', [storage/variable/@xpath], [storage/field/@xpath])) + ')'" type="expr" xpath="/tmp/@storageHelper"/>
                        <input label=" " nolabel="false" type="help" xpath="/tmp/@storageHelper"/>
                        <input label="Edit storage..." prebuildSubForm="false" type="subFormLink" xpath=".">
                          <form label="Storage">
                            <container ref="xtk:formlib:storageMode"/>
                          </form>
                        </input>
                        <input applicableIf="$(contextSchema)='nms:webApp'" expr="iif([storage/@mode] = 'xpath', GetLinkSchema([/webApp/@schema],[storage/@xpath]), @targetSchema)" type="expr" xpath="@targetSchema"/>
                        <input applicableIf="$(contextSchema)='xtk:report'" expr="iif([storage/@mode] = 'xpath', GetLinkSchema([/report/@schema],[storage/@xpath]), @targetSchema)" type="expr" xpath="@targetSchema"/>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@type!='folderSelector' and @type!='password' and @type!='button' and @type!='captcha' and @type!='linkEdit'">
                      <static label="Values" type="separator"/>
                    </container>
                    <container colspan="2" propagateConstraints="true">
                      <container type="visibleGroup" visibleIf="@type='subscription'" xpath="storage">
                        <input createMode="none" img="nms:setofservices.png" notifyPathList="@name" xpath="service">
                          <enter name="onChange">
                            <set expr="[service/@name]" xpath="@serviceName"/>
                          </enter>
                        </input>
                      </container>
                      <container type="visibleGroup" visibleIf="(@type='select' or @type='radiolist') and EV([contextOptions/@useContext], 'context')">
                        <static type="help">The list values are defined from the context. The configuration is included in the 'Advanced' tab.</static>
                      </container>
                      <container type="visibleGroup" visibleIf="(@type='select' or @type='radiolist') and EV([contextOptions/@useContext], 'context')=false">
                        <container type="visibleGroup" visibleIf="@type='radiolist'">
                          <container type="visibleGroup" visibleIf="[storage/@mode]='library' and [storage/@unbound]=true">
                            <input label="Allow multiple selections" xpath="storage/@multipleChoice"/>
                          </container>
                          <input label="The last choice is a free field for other values" xpath="storage/@enableOtherVal"/>
                        </container>
                        <container type="visibleGroup" visibleIf="[storage/@type]='string' and [storage/@unbound]=false">
                          <input xpath="storage/@useLabelAsValue"/>
                        </container>
                        <container type="visibleGroup" visibleIf="[storage/@mode] != 'var' and ([storage/@enum]!='' or [storage/@userEnum]!='')">
                          <input img="nl:runtask.png" label="Initialize the list of values from the database" nolabel="false" prebuildSubForm="false" type="UrlButton">
                            <enter>
                              <soapCall name="GetInputValues" service="nms:webApp">
                                <param exprIn="[$(entityPath)/@schema]" type="string"/>
                                <param exprIn="." type="DOMElement"/>
                                <param type="DOMElement" xpathOut="storage/options"/>
                              </soapCall>
                              <setModified/>
                            </enter>
                          </input>
                        </container>
                        <container type="visibleGroup" visibleIf="[storage/@type]='link'">
                          <input img="nl:runtask.png" label="Initialize the list of values from the database..." nolabel="false" prebuildSubForm="false" type="subformLink">
                            <form nothingToEdit="true" xpath="activities/page">
                              <container alwaysActive="true" filter="/input$" type="collectionItemGroup" xpath="input" xpathSelection="/ignored/tree/@xpathSelection">
                                <input img="nms:circle-one.png" label="Select the column to use as label" type="separator"/>
                                <input alwaysActive="true" expr="'/' + [storage/@xpath]" type="expr" xpath="/ignored/selectLink/@startPath"/>
                                <input label="Label field" noTransaction="true" nolabel="false" type="pathEdit" xpath="storage/@xpathLabel" xpathSchema="$(entityPath)/@schema" xpathStartPath="/ignored/selectLink/@startPath" zoom="true"/>
                                <input img="nms:circle-two.png" label="Click Load" type="separator"/>
                                <container enabledIf="[storage/@xpathLabel]!=''" type="enabledGroup">
                                  <input img="nms:prepare.png" label="Load" nolabel="false" type="UrlButton">
                                    <enter>
                                      <soapCall name="GetInputValues" service="nms:webApp">
                                        <param exprIn="[$(entityPath)/@schema]" type="string"/>
                                        <param exprIn="." type="DOMElement"/>
                                        <param type="DOMElement" xpathOut="storage/options"/>
                                      </soapCall>
                                      <setModified/>
                                    </enter>
                                  </input>
                                </container>
                                <input img="nms:circle-three.png" label="Preview" type="separator"/>
                                <input editable="false" noToolbar="true" nolabel="true" toolbar="false" type="list" xpath="storage/options/option" zoom="false">
                                  <input xpath="@label"/>
                                  <input xpath="@value"/>
                                </input>
                              </container>
                            </form>
                          </input>
                        </container>
                        <container type="visibleGroup" visibleIf="[storage/@useLabelAsValue]=false and [storage/@unbound]=false">
                          <input editable="true" label=" " type="list" xpath="storage/options/option">
                            <input xpath="@label"/>
                            <input xpath="@value"/>
                            <input xpath="@selected"/>
                            <input applicableIf="HasPackage('nms:survey')" colSize="10" visibleIf="[$(entityPath)/facet/@survey]" xpath="@score"/>
                          </input>
                        </container>
                        <container type="visibleGroup" visibleIf="[storage/@useLabelAsValue]=true or [storage/@unbound]=true">
                          <input editable="true" label=" " prebuildSubForm="false" type="list" xpath="storage/options/option" zoom="true">
                            <input xpath="@label"/>
                            <input xpath="@selected"/>
                            <input applicableIf="HasPackage('nms:survey')" colSize="10" visibleIf="[$(entityPath)/facet/@survey]" xpath="@score"/>
                            <form>
                              <enter>
                                <if expr="NodeValue('/webApp/archivedFields/field[@name=\''+[../../field/@xpath]+'\']/values/value[@id=\'' + @id + '\']/@id')!=''">
                                  <copyElement exprSrc="'/webApp/archivedFields/field[@name=\''+[../../field/@xpath]+'\']/values/value[@id=\'' + @id + '\']'" xpathDst="/tmp/field/"/>
                                </if>
                                <if expr="NodeValue('/webApp/archivedFields/field[@name=\''+[../../field/@xpath]+'\']/values/value[@id=\'' + @id + '\']/@autoSqlName')='false'">
                                  <set expr="NodeValue('/webApp/archivedFields/field[@name=\''+[../../field/@xpath]+'\']/values/value[@id=\'' + @id + '\']/@autoSqlName')" xpath="@autoSqlName"/>
                                  <set expr="NodeValue('/webApp/archivedFields/field[@name=\''+[../../field/@xpath]+'\']/values/value[@id=\'' + @id + '\']/@sqlname')" xpath="@sqlname"/>
                                </if>
                                <if expr="NodeValue('@autoSqlName') = ''">
                                  <set value="true" xpath="@autoSqlName"/>
                                </if>
                              </enter>
                              <input xpath="@label"/>
                              <input xpath="@selected"/>
                              <container applicableIf="HasPackage('nms:survey')" type="visibleGroup" visibleIf="[$(entityPath)/facet/@survey]">
                                <input xpath="@score"/>
                                <input xpath="@autoSqlName"/>
                                <container type="visibleGroup" visibleIf="@autoSqlName=false">
                                  <input xpath="@sqlname"/>
                                </container>
                              </container>
                              <leave>
                                <if expr="NodeValue('/webApp/archivedFields/field[@name=\''+[../../field/@xpath]+'\']/values/value[@id=\'' + @id + '\']/@id')!=''">
                                  <set expr="@sqlname" xpath="/tmp/field/@sqlname"/>
                                  <set expr="@autoSqlName" xpath="/tmp/field/@autoSqlName"/>
                                  <copyElement exprDst="'/webApp/archivedFields/field[@name=\''+[../../field/@xpath]+'\']/values/value[@id=\'' + @id + '\']'" xpathSrc="/tmp/field/"/>
                                </if>
                              </leave>
                            </form>
                          </input>
                        </container>
                        <container type="visibleGroup" visibleIf="@type='radiolist'" xpath="storage">
                          <container ref="xtk:formlib:multipleChoiceValidation"/>
                        </container>
                      </container>
                      <container type="visibleGroup" visibleIf="@type='checkbox' and [storage/@type]!='boolean'" xpath="storage">
                        <input label="Selected by default" xpath="@selected"/>
                        <input xpath="checkedValue"/>
                        <input xpath="uncheckedValue"/>
                        <container applicableIf="$(contextSchema)='nms:webApp' and HasPackage('nms:survey')" type="visibleGroup" visibleIf="[$(entityPath)/facet/@survey]">
                          <input xpath="@score"/>
                        </container>
                      </container>
                      <container type="visibleGroup" visibleIf="@type='checkbox' and [storage/@type]='boolean'" xpath="storage">
                        <input label="Selected by default" xpath="@selected"/>
                        <input enum="xtk:common:yesno" label="Value if checked" noInvalidErr="true" type="SysEnum" xpath="checkedValue"/>
                        <container applicableIf="$(contextSchema)='nms:webApp' and HasPackage('nms:survey')" type="visibleGroup" visibleIf="[$(entityPath)/facet/@survey]">
                          <input xpath="@score"/>
                        </container>
                      </container>
                      <container type="visibleGroup" visibleIf="@type='radio'" xpath="storage">
                        <input label="Selected by default" xpath="@selected"/>
                        <container type="visibleGroup" visibleIf="@enum=''">
                          <input xpath="checkedValue"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@enum!=''">
                          <input noInvalidErr="true" type="sysEnum" xpath="checkedValue" xpathEnum="@enum"/>
                        </container>
                        <container applicableIf="$(contextSchema)='nms:webApp' and HasPackage('nms:survey')" type="visibleGroup" visibleIf="[$(entityPath)/facet/@survey]">
                          <input xpath="@score"/>
                        </container>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@type='text'" xpath="storage">
                      <input xpath="defaultValue"/>
                    </container>
                    <container colcount="2" colspan="2" propagateConstraints="true" type="visibleGroup" visibleIf="@type='numeric'" xpath="storage">
                      <input label="Default value" xpath="@useDefaultVal"/>
                      <container enabledIf="@useDefaultVal=true" type="enabledGroup">
                        <input xpath="@defaultNumericVal"/>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@type='numeric'" xpath="storage">
                      <static label="Approvals" type="separator"/>
                    </container>
                    <container colcount="2" colspan="2" propagateConstraints="true" type="visibleGroup" visibleIf="@type='numeric'" xpath="storage">
                      <input label="Minimum value" xpath="@useMinVal"/>
                      <container enabledIf="@useMinVal=true" type="enabledGroup">
                        <input xpath="@minval"/>
                      </container>
                      <input label="Maximum value" xpath="@useMaxVal"/>
                      <container enabledIf="@useMaxVal=true" type="enabledGroup">
                        <input xpath="@maxval"/>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@type='constant'" xpath="storage">
                      <input label="Value" xpath="defaultValue"/>
                    </container>
                    <container colspan="2" propagateConstraints="false" type="visibleGroup" visibleIf="@type='textarea'" xpath="storage">
                      <input lineCount="5" xpath="defaultValue"/>
                    </container>
                    <container colspan="2" propagateConstraints="false" type="visibleGroup" visibleIf="@type='richTextArea'" xpath="storage">
                      <input lineCount="5" type="Dhtml" xpath="defaultValue"/>
                    </container>
                    <container colcount="2" colspan="2" propagateConstraints="false" type="visibleGroup" visibleIf="@type='date'" xpath="storage">
                      <input xpath="@dateFormat"/>
                      <input xpath="@timeFormat"/>
                      <container type="visibleGroup" visibleIf="@dateFormat!='none' and [../@dateEditor]!='jsCalendar'">
                        <input xpath="@firstYear"/>
                        <input xpath="@lastYear"/>
                      </container>
                      <container applicableIf="$(contextSchema)='nms:webApp' and HasPackage('nms:survey')" type="visibleGroup" visibleIf="[$(entityPath)/facet/@survey]">
                        <input xpath="@score"/>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@type = 'linkEdit' and [storage/@mode]='var'">
                      <static label="Values" type="separator"/>
                      <input checkedValue="xpath" label="You want to specify the application schema explicitly" type="radiobutton" xpath="@targetSchemaMode"/>
                      <input checkedValue="var" label="You want to specify the application schema from a variable" type="radiobutton" xpath="@targetSchemaMode"/>
                      <container type="visibleGroup" visibleIf="@targetSchemaMode='xpath'">
                        <input label="Application schema" schema="xtk:schema" type="schemaEdit" xpath="@targetSchema"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@targetSchemaMode='var'">
                        <input label="Variable" type="CollectionSelect" xpath="@xpathTargetSchema" xpathSelect="$(entityPath)/variables/variable"/>
                        <input label="Edit variables..." nolabel="false" prebuildSubForm="false" type="SubFormLink" xpath=".">
                          <form label="Edit branches">
                            <input editable="true" nolabel="true" toolbarAlign="horizontal" type="list" xpath="$(entityPath)/variables/variable" zoom="true" zoomOnAdd="true">
                              <input colSize="20" xpath="@label"/>
                              <input colSize="20" xpath="@xpath"/>
                              <input colSize="15" xpath="@type"/>
                              <form label="Variable">
                                <container ref="xtk:formlib:variable"/>
                              </form>
                            </input>
                          </form>
                        </input>
                      </container>
                    </container>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="container" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='container'">
                  <container alwaysActive="true" colcount="2" filter="/container$" type="collectionItemGroup" xpath="container" xpathSelection="/ignored/tree/@xpathSelection">
                    <static colspan="2" label="Title" type="separator"/>
                    <input colspan="2" xpath="@label"/>
                    <container colspan="2" type="visibleGroup" visibleIf="@type!='question'">
                      <input label="Display" xpath="@useHtmlTitle"/>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@type='question'">
                      <input xpath="@useHtmlTitle"/>
                      <container type="visibleGroup" visibleIf="@useHtmlTitle">
                        <container colspan="2" style="flat" type="notebook">
                          <container label="Content">
                            <input nolabel="true" xpath="title"/>
                          </container>
                          <container label="Texts">
                            <input editable="true" nolabel="true" type="list" xpath="strings/string">
                              <input xpath="@id"/>
                              <input label="Text" xpath="@value"/>
                            </input>
                            <static type="help">Text created here can be used in the HTML by using the following syntax &lt;%= $(IDENTIFIANT) %&gt;.</static>
                          </container>
                        </container>
                      </container>
                    </container>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input xpath="@labelPosition"/>
                    <input xpath="@colcount"/>
                    <input xpath="@style"/>
                    <input xpath="@width"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="value" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='value'">
                  <container alwaysActive="true" filter="/value$" type="collectionItemGroup" xpath="value" xpathSelection="/ignored/tree/@xpathSelection">
                    <input menuId="globalStringCatcher" type="scriptEdit" xpath="@label"/>
                    <input choiceType="xpath" hideMappedAsXml="false" label="Value" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@xpath" xpathLabel="@label"/>
                    <static label="Display settings" type="separator"/>
                    <input xpath="@colspan"/>
                    <input xpath="@labelPosition"/>
                    <input label="Edit format..." nolabel="true" prebuildSubForm="false" type="subformlink" xpath=".">
                      <form label="Format">
                        <container type="notebook">
                          <container ref="xtk:formlib:styleValue" xpath="style"/>
                          <container ref="xtk:formlib:styleExtra" xpath="style/extra"/>
                        </container>
                      </form>
                    </input>
                    <container ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="image" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='image'">
                  <container alwaysActive="true" colcount="2" filter="/image$" type="collectionItemGroup" xpath="image" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" menuId="globalStringCatcher" type="scriptEdit" xpath="@label"/>
                    <input colspan="2" xpath="@sourceType"/>
                    <container colspan="2" type="visibleGroup" visibleIf="@sourceType = 'external'">
                      <input xpath="@src"/>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@sourceType = 'library'">
                      <input notifyPathList="@md5,@name,@useMd5AsFilename" xpath="libraryImage">
                        <sysFilter inline="true">
                          <condition expr="@isImage = true"/>
                        </sysFilter>
                      </input>
                    </container>
                    <input colspan="2" type="urlViewer" urlExpr="Iif(@sourceType = 'external', @src, Iif(NodeExists([libraryImage/@useMd5AsFilename]) = false or ([libraryImage/@useMd5AsFilename] !='0' and [libraryImage/@useMd5AsFilename]!='false'),Iif([libraryImage/@md5] != '', GetOption('XtkFileRes_Public_URL') + GetOption('NmsTracking_Instance') + '/' + [libraryImage/@md5] + '.' + FileExt([libraryImage/@name]), 'about:blank'), Iif([libraryImage/@name] != '', GetOption('XtkFileRes_Public_URL') + GetOption('NmsTracking_Instance') + '/' + [libraryImage/@name],'')))"/>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input xpath="@colspan"/>
                    <input xpath="@staticAlignment"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="link" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='link'">
                  <container alwaysActive="true" colcount="2" filter="/link$" type="collectionItemGroup" xpath="link" xpathSelection="/ignored/tree/@xpathSelection">
                    <input menuId="globalStringCatcher" type="scriptEdit" xpath="@label"/>
                    <input enum="linkType" type="sysenum" xpath="@type"/>
                    <input xpath="@action"/>
                    <input xpath="@img"/>
                    <container colspan="2" type="visibleGroup" visibleIf="@action='url'">
                      <input img="xtk:form/link.png" xpath="@href"/>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@action='view'">
                      <input alias="views/view" type="viewComboList" xpath="@viewName"/>
                      <input xpath="@viewConsoleParam"/>
                      <input xpath="@viewWebParam"/>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@action='transition'">
                      <input type="CollectionSelect" xpath="@transition" xpathSelect="ancestor::page/transitions/next"/>
                    </container>
                    <container applicableIf="$(contextSchema)='nms:webApp'" colspan="2" type="visibleGroup" visibleIf="@action='refreshData'">
                      <input editable="true=" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Lists to refresh" type="list" xpath="objectTarget">
                        <input type="CollectionSelect" xpath="@identifier" xpathSelect="ancestor::page/descendant::list"/>
                      </input>
                    </container>
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@action!='refreshData'">
                      <input xpath="@target"/>
                      <container enabledIf="@target='name'" type="enabledGroup">
                        <input xpath="@targetName"/>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="@action='javascript'">
                      <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarCaption="JavaScript" type="CodeEdit" xpath="linkJavascript"/>
                    </container>
                    <container applicableIf="HasPackage('nms:social')" colspan="2" type="visibleGroup" visibleIf="@action='socialPrefill'">
                      <input createMode="none" img="nms:miniatures/mini-accessControl.png" notifyPathList="@messageType" type="linkedit" xpath="socialAccount">
                        <sysFilter>
                          <condition expr="@type = 9"/>
                        </sysFilter>
                      </input>
                    </container>
                    <input colspan="2" xpath="@tooltip"/>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input xpath="@colspan"/>
                    <input xpath="@staticAlignment"/>
                    <input colspan="2" xpath="rendering/@linkClassname"/>
                    <container applicableIf="$(contextSchema)='xtk:report'" colspan="2">
                      <input xpath="@enabledWhenHistory"/>
                    </container>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="html" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='html'">
                  <container alwaysActive="true" colcount="2" filter="/html$" type="collectionItemGroup" xpath="html" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <container ref="xtk:formlib:htmlBlock"/>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input xpath="@colspan"/>
                    <input xpath="@staticAlignment"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="hrule" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='hrule'">
                  <container alwaysActive="true" colcount="2" filter="/hrule$" type="collectionItemGroup" xpath="hrule" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input xpath="@colspan"/>
                    <input xpath="@staticAlignment"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="tracker" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='tracker'">
                  <container alwaysActive="true" colcount="2" filter="/tracker$" type="collectionItemGroup" xpath="tracker" xpathSelection="/ignored/tree/@xpathSelection">
                    <input xpath="@label"/>
                    <input required="true" xpath="@name"/>
                    <input required="true" xpath="@goal"/>
                    <input required="true" xpath="@step"/>
                  </container>
                </container>
                <container applicableIf="$(contextSchema)='nms:webApp'" name="list" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='list'">
                  <container alwaysActive="true" colcount="2" filter="/list$" type="collectionItemGroup" xpath="list" xpathSelection="/ignored/tree/@xpathSelection">
                    <input menuId="globalStringCatcher" type="scriptEdit" xpath="@label"/>
                    <input xpath="@loadType"/>
                    <input colspan="2" xpath="@showListTitle"/>
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@showListTitle" xpath="title">
                      <container colcount="2" colspan="2" label="Frame" type="frame">
                        <input xpath="@img"/>
                        <input menuId="globalStringCatcher" type="scriptEdit" xpath="@label"/>
                        <input xpath="@listFoldable"/>
                        <input xpath="@showListRefresh"/>
                      </container>
                    </container>
                    <container colspan="2" label="Configuration" type="frame">
                      <input label="View" xpath="@useColumns"/>
                      <container type="visibleGroup" visibleIf="@useColumns=0">
                        <input label="Nb. items per line" xpath="@numItemByLine"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@useColumns=1">
                        <input xpath="@showHeaders"/>
                        <input label="Use the first cell of the list to access the entity" xpath="@openHRef"/>
                        <input expr="iif(@openHRef, false, @templateVisibility)" type="expr" xpath="@templateVisibility"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@useColumns=2">
                        <input xpath="@showHeaders"/>
                        <container enabledIf="!@templateVisibility" type="enabledGroup">
                          <input label="Use the first cell of the list to access the entity" xpath="@openHRef"/>
                        </container>
                        <container enabledIf="!@openHRef" type="enabledGroup">
                          <input label="Use the first cell of the list to display or hide the detail" xpath="@templateVisibility"/>
                        </container>
                      </container>
                      <input xpath="@activeNav"/>
                      <container type="visibleGroup" visibleIf="@activeNav">
                        <input xpath="@navigationType"/>
                      </container>
                      <input expr="iif(@useColumns!=1, 'showTab', 'hideTab')" type="expr" xpath="/ignored/@refreshListDetTabExpression"/>
                      <input expr="iif(EV(@loadType, 'client'), 'showTab', 'hideTab')" type="expr" xpath="/ignored/@refreshListDataTabExpression"/>
                    </container>
                  </container>
                </container>
                <container name="javascript" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='javascript'">
                  <container alwaysActive="true" colcount="2" filter="/javascript$" type="collectionItemGroup" xpath="javascript" xpathSelection="/ignored/tree/@xpathSelection">
                    <input xpath="@label"/>
                    <input xpath="@runat"/>
                    <container colspan="2" style="flat" type="notebook">
                      <container label="Code">
                        <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="code"/>
                      </container>
                      <container label="Texts">
                        <input editable="true" nolabel="true" type="list" xpath="strings/string">
                          <input xpath="@id"/>
                          <input label="Text" xpath="@value"/>
                        </input>
                        <static type="help">The texts created here can be used in the script using the following syntax $(IDENTIFIANT).</static>
                      </container>
                    </container>
                    <input colspan="2" label="Associate the script with a cell" nolabel="true" xpath="@cell"/>
                  </container>
                </container>
                <container applicableIf="$(contextSchema)='xtk:report'" name="pageBreak" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='pageBreak'">
                  <container alwaysActive="true" colcount="2" filter="/pageBreak$" type="collectionItemGroup" xpath="pageBreak" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container applicableIf="$(contextSchema)='xtk:report'" name="kpi" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='kpi'">
                  <container alwaysActive="true" colcount="2" filter="/kpi$" type="collectionItemGroup" xpath="kpi" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <input choiceType="xpath" colspan="2" hideMappedAsXml="false" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@xpathValue" xpathLabel="@label"/>
                    <input colspan="2" xpath="@mode"/>
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mode, 'dynamic')">
                      <input colspan="2" label="Thresholds" type="separator"/>
                      <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@xpathWarning"/>
                      <static label="Value from which indicator is set as bad" type="help"/>
                      <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@xpathSuccess"/>
                      <static label="Value from which indicator is set as good" type="help"/>
                    </container>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input nolabel="false" xpath="@style"/>
                    <input nolabel="false" xpath="@size"/>
                    <input nolabel="false" xpath="@format"/>
                    <input nolabel="false" xpath="@significantFigures"/>
                    <input colspan="2" xpath="rendering/@inlineStyle"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="gauge" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='gauge'">
                  <container alwaysActive="true" colcount="2" filter="/gauge$" type="collectionItemGroup" xpath="gauge" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <input choiceType="xpath" colspan="2" hideMappedAsXml="false" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@xpathValue" xpathLabel="@label"/>
                    <input choiceType="xpath" colspan="2" hideMappedAsXml="false" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@xpathGoal"/>
                    <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
                      <input choiceType="xpath" colspan="2" hideMappedAsXml="false" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@xpathMarker"/>
                    </container>
                    <static colspan="2" label="Display range" type="separator"/>
                    <container colcount="2" colspan="2">
                      <input xpath="@exprLowerBound"/>
                      <input xpath="@exprUpperBound"/>
                    </container>
                    <static colspan="2" label="Value ranges" type="separator"/>
                    <input colspan="2" editable="true" nolabel="true" type="list" xpath="stateRange">
                      <input xpath="@lowerBound"/>
                      <input xpath="@state"/>
                    </input>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <container colcount="3" colspan="2">
                      <input xpath="@colspan"/>
                      <input label="Edit format..." nolabel="true" prebuildSubForm="false" type="subformlink" xpath=".">
                        <form label="Format">
                          <container ref="xtk:formlib:styleValue" xpath="style"/>
                        </form>
                      </input>
                      <input label="Change appearance..." nolabel="true" prebuildSubForm="false" type="subformlink" xpath=".">
                        <form colcount="2" label="Appearance">
                          <input colspan="2" label="General" type="separator"/>
                          <input colspan="2" xpath="@displayValue"/>
                          <input xpath="@spanRange"/>
                          <static label="The value must be between 0 (minimal aperture) and 1 (full circle)." type="help"/>
                          <input colspan="2" label="Display zone (in pixels)" type="separator"/>
                          <input xpath="@width"/>
                          <static label="Height is automatically deduced from width." type="help"/>
                        </form>
                      </input>
                    </container>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="funnel" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='funnel'">
                  <container alwaysActive="true" colcount="2" filter="/funnel$" type="collectionItemGroup" xpath="funnel" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <static colspan="2" label="Data source" type="separator"/>
                    <input colspan="2" img="xtk:form/tabular.png" label="Funnel data XPath..." nolabel="false" prebuildSubForm="false" type="subformlink" xpath=".">
                      <form label="Funnel data">
                        <enter>
                          <set expr="'temp:formContext'" xpath="@schema"/>
                        </enter>
                        <static>Select in the context the item containing the data to display in the funnel.</static>
                        <input choiceType="xpath" hideMappedAsXml="false" nolabel="true" type="pathEdit" useTablePath="true" useUnboundPath="true" xpath="@startPath" xpathSchema="@schema"/>
                      </form>
                    </input>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <container colcount="3" colspan="2">
                      <input colspan="3" xpath="@labelPosition"/>
                      <input xpath="@colspan"/>
                      <input label="Change appearance..." nolabel="true" prebuildSubForm="false" type="subformlink" xpath=".">
                        <form colcount="2" label="Appearance">
                          <input colspan="2" label="General" type="separator"/>
                          <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
                            <input colspan="2" xpath="@perspective"/>
                          </container>
                          <input colspan="2" xpath="@labelColor"/>
                          <input colspan="2" label="Display zone (in pixels)" type="separator"/>
                          <input xpath="@width"/>
                          <input xpath="@height"/>
                        </form>
                      </input>
                    </container>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container applicableIf="HasPackage('nms:interaction')" name="offerProposition" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='offerProposition'">
                  <container alwaysActive="true" filter="/offerProposition$" type="collectionItemGroup" xpath="offerProposition" xpathSelection="/ignored/tree/@xpathSelection">
                    <input xpath="@label"/>
                    <input xpath="offerSpace">
                      <sysFilter>
                        <condition expr="@channel = 50"/>
                        <condition expr="[env/@live]=true"/>
                      </sysFilter>
                      <enter name="onChange">
                        <set value="nms:offerSpace" xpath="/ignored/queryDefOfferSpace/@schema"/>
                        <set value="get" xpath="/ignored/queryDefOfferSpace/@operation"/>
                        <set value="[env/@inputSchema]" xpath="/ignored/queryDefOfferSpace/select/node[1]/@expr"/>
                        <set expr="'@id='+[@offerSpace-id]" xpath="/ignored/queryDefOfferSpace/where/condition/@expr"/>
                        <soapCall name="ExecuteQuery" service="xtk:queryDef">
                          <param exprIn="[/ignored/queryDefOfferSpace]" type="DOMDocument"/>
                          <param type="DOMDocument" xpathOut="/ignored/offerSpace"/>
                        </soapCall>
                        <set expr="[/ignored/offerSpace/env/@inputSchema]" xpath="@inputSchema"/>
                      </enter>
                    </input>
                    <input choiceType="xpath" hideMappedAsXml="false" label="Target ID" nolabel="false" schema="temp:formContext" type="pathEdit" useUnboundPath="true" xpath="@targetXPath"/>
                    <input type="list" xpath="parameter">
                      <input choiceType="xpath" hideMappedAsXml="true" type="pathEdit" useUnboundPath="false" xpath="@name" xpathSchema="../@inputSchema" zoom="true"/>
                      <input choiceType="xpath" schema="temp:formContext" type="pathEdit" xpath="@source"/>
                    </input>
                    <static label="Display settings" type="separator"/>
                    <container colcount="3">
                      <input xpath="@colspan"/>
                    </container>
                    <container ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="matrix" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='matrix'">
                  <container alwaysActive="true" colcount="1" filter="/matrix$" type="collectionItemGroup" xpath="matrix" xpathSelection="/ignored/tree/@xpathSelection">
                    <input xpath="@label"/>
                    <input label="Values" type="separator"/>
                    <container propagateConstraints="true">
                      <input label="Allow multiple selections" xpath="@multipleChoice"/>
                      <input label="The last choice is a free field for other values" xpath="@enableOtherVal"/>
                      <container type="visibleGroup" visibleIf="[@useLabelAsValue]=false">
                        <input editable="true" label=" " type="list" xpath="options/option">
                          <input xpath="@label"/>
                          <input xpath="@value"/>
                          <input xpath="@selected"/>
                          <input colSize="10" xpath="@score"/>
                        </input>
                      </container>
                      <container type="visibleGroup" visibleIf="[@useLabelAsValue]=true">
                        <input editable="true" label=" " type="list" xpath="options/option">
                          <input xpath="@label"/>
                          <input xpath="@selected"/>
                          <input colSize="10" xpath="@score"/>
                        </input>
                      </container>
                      <input xpath="@useLabelAsValue"/>
                      <container ref="xtk:formlib:multipleChoiceValidation"/>
                    </container>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="matrixRow" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='matrixRow'">
                  <container alwaysActive="true" colcount="2" filter="/matrixRow$" type="collectionItemGroup" xpath="matrix/matrixRow" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <input xpath="@required"/>
                    <container enabledIf="@required=true" type="enabledGroup">
                      <input label="Personalize the message..." prebuildSubForm="false" type="SubformLink" xpath=".">
                        <form label="Message personalization">
                          <static label="Enter the text to display if the field is left empty." type="help"/>
                          <input nolabel="true" xpath="requiredLog"/>
                        </form>
                      </input>
                    </container>
                    <container colspan="2" ref="xtk:formlib:storageMode"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="chart" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='chart'">
                  <container alwaysActive="true" colcount="2" filter="/chart$" type="collectionItemGroup" xpath="chart" xpathSelection="/ignored/tree/@xpathSelection">
                    <input colspan="2" xpath="@label"/>
                    <input colspan="2" xpath="@legend"/>
                    <input xpath="@colspan"/>
                    <input label="Interaction events..." prebuildSubForm="false" type="subformlink" xpath=".">
                      <form label="Interaction events" name="cellFormat">
                        <container colcount="2" label="Click" xpath="onclick">
                          <input colspan="2" label="Click on chart" type="separator"/>
                          <input colspan="2" default="none" xpath="@action"/>
                          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[@action]!='' and [@action]!='none'">
                            <container colspan="2" type="visibleGroup" visibleIf="@action='url'">
                              <input img="xtk:form/link.png" xpath="@href"/>
                            </container>
                            <container colspan="2" type="visibleGroup" visibleIf="@action='transition'">
                              <input type="CollectionSelect" xpath="@transition" xpathSelect="ancestor::page/transitions/next"/>
                            </container>
                            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@action!='javascript' and @action!='refreshData' and @action!='refresh'">
                              <input xpath="@target"/>
                              <container>
                                <container enabledIf="@target='name'" type="enabledGroup">
                                  <input xpath="@targetName"/>
                                </container>
                              </container>
                            </container>
                            <input colspan="2" editable="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Update context" type="list" xpath="context/set">
                              <input xpath="@xpath"/>
                              <input xpath="@expr"/>
                            </input>
                            <container colspan="2" type="visibleGroup" visibleIf="@action='url'">
                              <input colspan="2" editable="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="URL parameters" type="list" xpath="urlParam/param">
                                <input xpath="@name"/>
                                <input xpath="@value"/>
                              </input>
                            </container>
                            <container applicableIf="$(contextSchema)='nms:webApp'" colspan="2" type="visibleGroup" visibleIf="@action='refreshData'">
                              <input editable="true=" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Lists to refresh" type="list" xpath="objectTarget">
                                <input type="CollectionSelect" xpath="@identifier" xpathSelect="ancestor::page/descendant::list"/>
                              </input>
                            </container>
                            <container colspan="2" type="visibleGroup" visibleIf="@action='javascript'">
                              <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarCaption="JavaScript" type="CodeEdit" xpath="javascript"/>
                            </container>
                          </container>
                        </container>
                      </form>
                    </input>
                    <static colspan="2" label="Display settings" type="separator"/>
                    <input colspan="2" xpath="@labelPosition"/>
                    <static colspan="2" label="Chart type" type="separator"/>
                    <container colspan="2" ref="xtk:formlib:graphStyle"/>
                    <container colspan="2" ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
                <container name="table" type="visibleGroup" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='table'">
                  <container alwaysActive="true" filter="/table$" type="collectionItemGroup" xpath="table" xpathSelection="/ignored/tree/@xpathSelection">
                    <input xpath="@label"/>
                    <input xpath="@legend"/>
                    <container maxLabelWidth="200" type="visibleGroup" visibleIf="@type='pivot'">
                      <input xpath="@statOrientation"/>
                      <input xpath="@displayStatLabel"/>
                      <input xpath="@displaySubtotal"/>
                    </container>
                    <container type="visibleGroup" visibleIf="@type!='tabular' AND @type!='cubeExplorer'">
                      <container ref="xtk:formlib:autoquery" xpath="data"/>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='tabular'" xpath="data">
                      <static label="Data source" type="separator"/>
                      <input img="xtk:form/tabular.png" label="Table data XPath..." nolabel="false" prebuildSubForm="false" type="subformlink" xpath=".">
                        <form label="Table data" prebuildSubForm="false">
                          <enter>
                            <set expr="'temp:formContext'" xpath="@schema"/>
                          </enter>
                          <static>Select in the context the item containing the data to display in the table.</static>
                          <input choiceType="xpath" hideMappedAsXml="false" nolabel="true" type="pathEdit" useTablePath="true" useUnboundPath="true" xpath="@startPath" xpathSchema="@schema"/>
                        </form>
                      </input>
                    </container>
                    <container ref="xtk:formlib:cellVisibility"/>
                  </container>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" label="Data" name="list" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='list' AND NodeValue([/ignored/tree/@xpathSelection] + '/@loadType')=='0' AND [/ignored/@refreshListDataTabExpression]!='noTab'">
                <container alwaysActive="true" filter="/list$" type="collectionItemGroup" xpath="list" xpathSelection="/ignored/tree/@xpathSelection">
                  <container type="visibleGroup" visibleIf="EV(@loadType, 'client')">
                    <container colcount="2" xpath="content">
                      <input colspan="2" label="Document type" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                      <input colspan="2" label="Maximum number of lines" xpath="@lineCount"/>
                      <static colspan="2" type="separator"/>
                      <container colspan="2" type="visibleGroup" visibleIf="@schema!=''">
                        <container style="flat" type="notebook">
                          <container label="Columns">
                            <container name="selectCtrl" type="querySelectContainer">
                              <container name="vpaned" type="vpaned">
                                <container name="schema">
                                  <static fontBold="true" label="Available fields:"/>
                                  <container colcount="2">
                                    <static img="xtk:filter.png" type="image"/>
                                    <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                                  </container>
                                  <input name="schemaView" showCollections="true" type="SchemaView" useUnboundPath="true" xpath="@schema" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="select/node/@expr" xpathStartPath="@startPath"/>
                                </container>
                                <container name="output" xpathsToLoad="output*">
                                  <static fontBold="true" label="Output columns:"/>
                                  <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" xpath="select/node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupBy="groupBy/node" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHaving="having/condition" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="@schema" xpathStartPath="@startPath" zoom="false">
                                    <input colSize="20" xpath="@label"/>
                                    <input colSize="35" type="pathedit" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="../../@schema" xpathStartPath="../../@startPath"/>
                                    <input colsize="20" xpath="@displayFormat"/>
                                    <input colSize="10" xpath="@colSize"/>
                                    <input colSize="10" xpath="@alias"/>
                                    <input colSize="10" xpath="@hidden"/>
                                    <form label="Column definition" name="colDetail">
                                      <input xpath="@label"/>
                                      <container name="extraFields"/>
                                      <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="@schema"/>
                                      <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                                        <container colcount="2" cols-width="100,1">
                                          <container>
                                            <static fontBold="true" label="Available fields:"/>
                                            <container colcount="2">
                                              <static img="xtk:filter.png" type="image"/>
                                              <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                                            </container>
                                            <input type="schemaview" xpath="@schema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="@startPath"/>
                                          </container>
                                          <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                                        </container>
                                        <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                                      </container>
                                      <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                                    </form>
                                  </input>
                                </container>
                              </container>
                              <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                            </container>
                          </container>
                          <container label="Sorting">
                            <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" xpathSelect="select/node" zoom="false">
                              <input colSize="20" xpath="@label"/>
                              <input choiceType="sort" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema" xpathStartPath="../../@startPath"/>
                              <input colSize="15" editable="true" xpath="@sort"/>
                              <input colSize="15" editable="true" xpath="@sortDesc"/>
                            </input>
                            <input type="help" xpath="/@help"/>
                          </container>
                          <container label="Filter">
                            <input name="filterList" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="/@helpCond">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                              <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                            </input>
                            <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                          </container>
                          <container label="Collections">
                            <container ref="xtk:queryDef:hidden/conditionLink"/>
                          </container>
                        </container>
                      </container>
                    </container>
                  </container>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" label="Additional detail" name="list" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='list' AND NodeValue([/ignored/tree/@xpathSelection] + '/@useColumns')!='1' AND [/ignored/@refreshListDetTabExpression]!='noTab'">
                <container alwaysActive="true" filter="/list$" type="collectionItemGroup" xpath="list" xpathSelection="/ignored/tree/@xpathSelection">
                  <container style="flat" type="notebook">
                    <container label="Source">
                      <input nolabel="true" type="htmlSource" xpath="lineTemplate"/>
                    </container>
                    <container label="Texts">
                      <input editable="true" nolabel="true" type="list" xpath="strings/string">
                        <input xpath="@id"/>
                        <input label="Text" xpath="@value"/>
                      </input>
                      <static type="help">The texts created here can be used in the script using the following syntax $(IDENTIFIANT).</static>
                    </container>
                    <container label="Preview">
                      <input nolabel="true" type="dhtml" viewSourceBtn="false" xpath="lineTemplate"/>
                    </container>
                  </container>
                </container>
              </container>
              <container colcount="2" label="Data" name="chart" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='chart'">
                <container alwaysActive="true" colcount="2" colspan="2" filter="/chart$" type="collectionItemGroup" xpath="chart" xpathSelection="/ignored/tree/@xpathSelection">
                  <container colspan="2" ref="xtk:formlib:autoquery" xpath="data"/>
                  <static colspan="2" label="Chart type" type="separator"/>
                  <static img="xtk:graphxy.png" label=" " nolabel="false"/>
                  <static img="xtk:graphxyz.png" label=" " nolabel="false"/>
                  <input checkedValue="1" label="1 variable" nolabel="false" type="radioButton" xpath="data/@variableCount"/>
                  <container enabledIf="EV(@type, 'pie') == false" type="enabledGroup">
                    <input checkedValue="2" label="2 variables" nolabel="false" type="radioButton" xpath="data/@variableCount"/>
                  </container>
                  <container colspan="2" ref="xtk:formlib:graphDataEdit"/>
                  <static colspan="2" label="Series parameters" type="separator"/>
                  <container colspan="2" ref="xtk:formlib:statistic" xpath="data/statistic"/>
                </container>
              </container>
              <container label="Data" name="table" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='table'">
                <container alwaysActive="true" filter="/table$" type="collectionItemGroup" xpath="table" xpathSelection="/ignored/tree/@xpathSelection">
                  <container type="visibleGroup" visibleIf="@type='pivot'">
                    <input type="pivotTableEdit" xpath="data/variables">
                      <form name="variableEdit" ref="xtk:formlib:variableEdit"/>
                    </input>
                  </container>
                  <container type="visibleGroup" visibleIf="@type='pivot'">
                    <container ref="xtk:formlib:statistic" xpath="data/statistic"/>
                  </container>
                  <container colcount="2" type="visibleGroup" visibleIf="@type='cubeExplorer'">
                    <input label="Cube" noZoom="true" xpath="cubeExplorer/cube">
                      <enter name="onChange">
                        <reset xpath="cubeExplorer/where"/>
                        <reset xpath="cubeExplorer/visualConfig"/>
                      </enter>
                    </input>
                    <input img="nms:miniatures/mini-query.png" label="Filter data..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="cubeExplorer">
                      <form label="Cube data filtering">
                        <enter>
                          <soapCall name="GetCubeSchema" service="xtk:olapCube">
                            <param exprIn="[@cube-id]" type="int"/>
                            <param exprIn="'true'" type="boolean"/>
                            <param type="DOMDocument" xpathOut="/tmp/cube/schema"/>
                          </soapCall>
                          <set expr="LoadSchema('/tmp/cube/schema')" xpath="/tmp/cube/@cubeSchema"/>
                        </enter>
                        <input choiceType="sort" nolabel="true" toolbarAlign="horizontal" type="conditionList" xpath="where" xpathExpr="where/@expr" xpathSchema="/tmp/cube/@cubeSchema">
                          <input colSize="15" label=" " xpath="/@bool-operator"/>
                          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                          <input colSize="15" label="Operator" xpath="/@operator"/>
                          <input colSize="30" label="Value" xpath="/@rightExpr"/>
                          <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                        </input>
                      </form>
                    </input>
                    <static colspan="2" label="During configuration, conditions which depend on context are not applied." type="help"/>
                    <container colspan="2" title="Pivot table" type="visibleGroup" visibleIf="[cubeExplorer/@cube-id] != 0">
                      <input canSaveConfiguration="true" mode="edit" type="cubeExplorer" xpath="." xpathCubeId="cubeExplorer/@cube-id"/>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="@type='distribution'">
                    <input label="Expression" name="expr" nolabel="false" type="pathEdit" xpath="data/variables/row/var/@expr" xpathLabel="data/variables/row/var/@label" xpathSchema="data/@schema"/>
                    <input xpath="data/variables/row/var/@label"/>
                    <input xpath="data/variables/row/var/@type"/>
                    <container ref="xtk:formlib:statistic" xpath="data/statistic"/>
                  </container>
                  <container type="visibleGroup" visibleIf="@type='tabular'">
                    <input type="TabularReport" xpath="data/group">
                      <form label="Expression" name="editExpression" ref="xtk:formlib:tableExpressionEdit"/>
                      <form label="Cell format" name="cellFormat">
                        <container type="notebook">
                          <container ref="xtk:formlib:styleValue" xpath="style"/>
                          <container colcount="2" label="Borders" xpath="style/border">
                            <input colspan="2" label="Left" type="separator"/>
                            <input xpath="left/@style"/>
                            <container enabledIf="EV([left/@style], 'none', 'default') = false" type="enabledGroup">
                              <input xpath="left/@color"/>
                            </container>
                            <input colspan="2" label="Top" type="separator"/>
                            <input xpath="top/@style"/>
                            <container enabledIf="EV([top/@style], 'none', 'default') = false" type="enabledGroup">
                              <input xpath="top/@color"/>
                            </container>
                            <input colspan="2" label="Right" type="separator"/>
                            <input xpath="right/@style"/>
                            <container enabledIf="EV([right/@style], 'none', 'default') = false" type="enabledGroup">
                              <input xpath="right/@color"/>
                            </container>
                            <input colspan="2" label="Bottom" type="separator"/>
                            <input xpath="bottom/@style"/>
                            <container enabledIf="EV([bottom/@style], 'none', 'default') = false" type="enabledGroup">
                              <input xpath="bottom/@color"/>
                            </container>
                          </container>
                          <container colcount="2" label="Click" xpath="onclick">
                            <input colspan="2" label="Click on cell" type="separator"/>
                            <input colspan="2" xpath="@action"/>
                            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[@action]!='' and [@action]!='none'">
                              <container colspan="2" type="visibleGroup" visibleIf="@action='url'">
                                <input img="xtk:form/link.png" xpath="@href"/>
                              </container>
                              <container colspan="2" type="visibleGroup" visibleIf="@action='transition'">
                                <input type="CollectionSelect" xpath="@transition" xpathSelect="ancestor::page/transitions/next"/>
                              </container>
                              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@action!='javascript' and @action!='refreshData' and @action!='refresh'">
                                <input xpath="@target"/>
                                <container>
                                  <container enabledIf="@target='name'" type="enabledGroup">
                                    <input xpath="@targetName"/>
                                  </container>
                                </container>
                              </container>
                              <container colspan="2" type="frame">
                                <input label="Disabling clicks..." prebuildSubForm="false" type="subFormLink" xpath="notClickableIf">
                                  <form>
                                    <container ref="xtk:formlib:conditionList"/>
                                  </form>
                                </input>
                              </container>
                              <input colspan="2" editable="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Update context" type="list" xpath="context/set">
                                <input xpath="@xpath"/>
                                <input xpath="@expr"/>
                              </input>
                              <container colspan="2" type="visibleGroup" visibleIf="@action='url'">
                                <input colspan="2" editable="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="URL parameters" type="list" xpath="urlParam/param">
                                  <input xpath="@name"/>
                                  <input xpath="@value"/>
                                </input>
                              </container>
                              <container applicableIf="$(contextSchema)='nms:webApp'" colspan="2" type="visibleGroup" visibleIf="@action='refreshData'">
                                <input editable="true=" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Lists to refresh" type="list" xpath="objectTarget">
                                  <input type="CollectionSelect" xpath="@identifier" xpathSelect="ancestor::page/descendant::list"/>
                                </input>
                              </container>
                              <container colspan="2" type="visibleGroup" visibleIf="@action='javascript'">
                                <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarCaption="JavaScript" type="CodeEdit" xpath="javascript"/>
                              </container>
                            </container>
                          </container>
                          <container ref="xtk:formlib:styleExtra" xpath="style/extra"/>
                        </container>
                      </form>
                      <form label="Grouping" name="groupEdit">
                        <container type="notebook">
                          <container label="General">
                            <container type="visibleGroup" visibleIf="@name!='_root'">
                              <input xpath="@name"/>
                            </container>
                            <container type="visibleGroup" visibleIf="@name='_root'">
                              <input readOnly="true" xpath="@name"/>
                            </container>
                            <input label="Grouping on" type="separator"/>
                            <input nolabel="true" type="list" xpath="groupBy/node" zoom="true" zoomOnAdd="true">
                              <form ref="xtk:formlib:tableExpressionEdit"/>
                              <input xpath="@expr"/>
                            </input>
                            <input label="Group headers and footers" type="separator"/>
                            <container colcount="2" propagateConstraints="false">
                              <input xpath="@hasHeader"/>
                              <input xpath="@hasFooter"/>
                            </container>
                            <input label="Page break" type="separator"/>
                            <container colcount="2" propagateConstraints="false">
                              <input xpath="@pageBreakAtStart"/>
                              <input xpath="@pageBreakAtEnd"/>
                            </container>
                          </container>
                          <container label="View">
                            <input xpath="@limit"/>
                            <container enabledIf="@limit=true" type="enabledGroup">
                              <input width="20" xpath="@limitValue"/>
                            </container>
                            <input xpath="@collapse"/>
                          </container>
                        </container>
                        <leave>
                          <check expr="@name != ''">
                            <error>You must specify a name for the grouping.</error>
                          </check>
                        </leave>
                      </form>
                      <form colcount="2" label="Column" name="editColumn">
                        <input xpath="@widthMode"/>
                        <container enabledIf="@widthMode='manual'" type="enabledGroup" width="10">
                          <input noTransaction="true" xpath="@width"/>
                        </container>
                      </form>
                    </input>
                  </container>
                </container>
              </container>
              <container colcount="2" label="Data" name="funnel" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='funnel'">
                <container alwaysActive="true" colspan="2" filter="/funnel$" type="collectionItemGroup" xpath="funnel" xpathSelection="/ignored/tree/@xpathSelection">
                  <input alwaysActive="true" expr="Iif(startWith([@startPath], '['), '/'+ substring([@startPath], 1, strlen([@startPath])-2), [@startPath])" type="expr" xpath="/tmp/@startPath"/>
                  <input alwaysActive="true" expr="'temp:formContext'" type="expr" xpath="/tmp/@schema"/>
                  <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@radiusValue" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
                  <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@heightValue" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
                  <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@labelExpr" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
                  <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@transitionRatio" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
                  <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@transitionTime" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
                  <input choiceType="xpath" hideMappedAsXml="false" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@hint" xpathSchema="/tmp/@schema" xpathStartPath="/tmp/@startPath"/>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='xtk:report'" label="Advanced" name="page" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='page'">
                <container alwaysActive="true" filter="/page$" type="collectionItemGroup" xpathSelection="/ignored/tree/@xpathSelection">
                  <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'preV6')">
                    <input nolabel="true" xpath="@exportable"/>
                  </container>
                  <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'postV6')">
                    <input label="Activate OpenOffice/Microsoft Excel export" nolabel="true" xpath="@exportable"/>
                  </container>
                  <container type="visibleGroup" visibleIf="EV([$(entityPath)/properties/@renderingEngine], 'postV6')">
                    <container type="visibleGroup" visibleIf="@exportAllData">
                      <static label="Only the first 200 lines of data will be displayed in the console." type="warning"/>
                    </container>
                    <input label="Allow large data export" nolabel="true" xpath="@exportAllData"/>
                  </container>
                  <input label="Export settings" type="separator"/>
                  <container enabledIf="@exportable or EV([/report/properties/@renderingEngine], 'postV6')" type="enabledGroup">
                    <input nolabel="true" type="treeEdit">
                      <container label="Paper">
                        <input xpath="@paperOrientation"/>
                        <input xpath="@paperFormat"/>
                        <input xpath="@scalingMode"/>
                      </container>
                      <container label="Margins">
                        <input xpath="@marginTop"/>
                        <input xpath="@marginBottom"/>
                        <input xpath="@marginLeft"/>
                        <input xpath="@marginRight"/>
                      </container>
                    </input>
                  </container>
                </container>
              </container>
              <container label="Advanced" name="input" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='input' ">
                <container alwaysActive="true" filter="/input$" type="collectionItemGroup" xpath="input" xpathSelection="/ignored/tree/@xpathSelection">
                  <container type="hpaned">
                    <container>
                      <input label="Display settings" type="separator"/>
                      <input nolabel="true" type="treeEdit">
                        <container label="View">
                          <input xpath="@colspan"/>
                          <input label="Inline style of the captcha" visibleIf="@type='captcha'" xpath="rendering/@inlineStyle"/>
                          <input visibleIf="@type='folderSelector'" xpath="rendering/@inlineStyle"/>
                          <input xpath="rendering/@verticalAlign"/>
                          <container label="Label" visibleIf="@type!='folderSelector'">
                            <input xpath="@labelPosition"/>
                            <input xpath="rendering/@whiteSpace"/>
                            <input visibleIf="[rendering/@whiteSpace]!='no-wrap'" xpath="rendering/@labelWidth"/>
                            <input xpath="rendering/@inlineStyleLabel"/>
                          </container>
                          <container label="Input zone" visibleIf="@type!='folderSelector'">
                            <input visibleIf="@type='numeric'" xpath="@prefix"/>
                            <input visibleIf="@type='numeric'" xpath="@suffix"/>
                            <input visibleIf="@type='date'" xpath="@dateEditor"/>
                            <input xpath="rendering/@width"/>
                            <input visibleIf="@type='richTextArea'" xpath="rendering/@height"/>
                            <input xpath="rendering/@align"/>
                            <input visibleIf="@type='text' or @type='numeric' or @type='password'" xpath="rendering/@maxLength"/>
                            <input visibleIf="@type='richTextArea'" xpath="rendering/@htmlEditor"/>
                            <input visibleIf="@type='textarea'" xpath="rendering/@rows"/>
                            <input label="Number of lines (Opera and iOs)" visibleIf="@type='richTextArea'" xpath="rendering/@rows"/>
                            <input visibleIf="@type!='richTextArea'" xpath="rendering/@inlineStyleValue"/>
                          </container>
                        </container>
                        <container label="Toolbar" visibleIf="@type='richTextArea' and [rendering/@htmlEditor]=''">
                          <input xpath="rendering/@styleButton"/>
                          <input xpath="rendering/@justifyButton"/>
                          <input xpath="rendering/@sourceButton"/>
                          <input xpath="rendering/@imageButton"/>
                          <input xpath="rendering/@toolbarPos"/>
                        </container>
                        <container label="Context" visibleIf="@type='select'" xpath="contextOptions">
                          <input xpath="@useContext"/>
                          <input visibleIf="EV([contextOptions/@useContext], 'context')" xpath="@xpath"/>
                          <input visibleIf="EV([contextOptions/@useContext], 'context')" xpath="@xpathLabel"/>
                          <input visibleIf="EV([contextOptions/@useContext], 'context')" xpath="@xpathValue"/>
                          <input visibleIf="EV([contextOptions/@useContext], 'enum')" xpath="@xpathEnum"/>
                        </container>
                        <container label="Advanced">
                          <input xpath="@alias"/>
                          <input visibleIf="@type='select' or @type='text' or @type='password' or @type='numeric' or @type='checkbox'" xpath="@onChange"/>
                          <input type="CollectionSelect" visibleIf="@onChange='refreshData'" xpath="@refreshTarget" xpathSelect="ancestor::page/descendant::list"/>
                          <input applicableIf="$(contextSchema)='xtk:report'" xpath="@enabledWhenHistory"/>
                        </container>
                      </input>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='linkEdit'">
                      <static label="Limitation of choices" type="separator"/>
                      <input choiceType="sort" nolabel="true" toolbarAlign="horizontal" type="conditionList" xpath="sysFilter" xpathHelp="/@helpCond" xpathSchema="@targetSchema">
                        <input colSize="15" label=" " xpath="/@bool-operator"/>
                        <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                        <input colSize="15" label="Operator" xpath="/@operator"/>
                        <input colSize="30" label="Value" xpath="/@rightExpr"/>
                        <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                      </input>
                      <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                      <input nolabel="true" xpath="@writeAccessFolderFlt"/>
                      <static label="This option is used for folder selection. If checked, the list if filetered to keep only folders writable for the user." type="help"/>
                    </container>
                  </container>
                </container>
              </container>
              <container label="Advanced" name="container" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='container'">
                <container alwaysActive="true" filter="/container$" type="collectionItemGroup" xpath="container" xpathSelection="/ignored/tree/@xpathSelection">
                  <input colspan="2" label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input xpath="rendering/@inlineStyle"/>
                      <input xpath="rendering/@cellSpacing"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="value" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='value'">
                <container alwaysActive="true" filter="/value$" type="collectionItemGroup" xpath="value" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input label="Inline style of the label" xpath="rendering/@inlineStyleLabel"/>
                      <input label="Inline style of the value" xpath="rendering/@inlineStyleValue"/>
                    </container>
                  </input>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" label="Advanced" name="list" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='list'">
                <container alwaysActive="true" filter="/list$" type="collectionItemGroup" xpath="list" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input xpath="@colspan"/>
                      <input xpath="@staticAlignment"/>
                      <input xpath="@maxHeight"/>
                      <input xpath="editForm"/>
                      <input xpath="@viewName"/>
                    </container>
                    <container label="Storage / Filtering">
                      <input type="CollectionSelect" xpath="@storage" xpathSelect="$(entityPath)/variables/variable"/>
                      <input xpath="@folderXPath"/>
                      <input xpath="@lineCountXPath"/>
                    </container>
                    <container label="Styles">
                      <input xpath="styles/@tableClass"/>
                      <input visibleIf="@showHeaders" xpath="styles/@headerLineClass"/>
                      <input visibleIf="@showHeaders" xpath="styles/@headerCellClass"/>
                      <input visibleIf="@useColumns>0" xpath="styles/@evenLineClass"/>
                      <input visibleIf="@useColumns>0" xpath="styles/@oddLineClass"/>
                      <input visibleIf="@useColumns>0" xpath="styles/@rowCellClass"/>
                      <input visibleIf="@showListTitle" xpath="styles/@titleListClass"/>
                      <input visibleIf="@showListTitle" xpath="styles/@listBorderClass"/>
                      <input label="Inline style of the list frame" xpath="rendering/@inlineStyle"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="matrix" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='matrix' ">
                <container alwaysActive="true" filter="/matrix$" type="collectionItemGroup" xpath="matrix" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input xpath="@colspan"/>
                      <input xpath="rendering/@verticalAlign"/>
                      <container label="Label">
                        <input xpath="@labelPosition"/>
                        <input xpath="rendering/@whiteSpace"/>
                        <input xpath="rendering/@inlineStyleLabel"/>
                      </container>
                      <container label="Grid">
                        <input xpath="rendering/@align"/>
                        <input label="Inline style of the columns" xpath="rendering/@inlineStyleValue"/>
                      </container>
                    </container>
                    <container label="Advanced">
                      <input xpath="@alias"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="matrixRow" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='matrixRow' ">
                <container alwaysActive="true" filter="/matrixRow$" type="collectionItemGroup" xpath="matrix" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="Label display">
                      <input xpath="rendering/@whiteSpace"/>
                      <input xpath="rendering/@width"/>
                      <input xpath="rendering/@inlineStyleLabel"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="input" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='table' ">
                <container alwaysActive="true" filter="/table$" type="collectionItemGroup" xpath="input" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input xpath="@colspan"/>
                      <input xpath="rendering/@verticalAlign"/>
                      <container label="Label">
                        <input xpath="@labelPosition"/>
                        <input xpath="rendering/@whiteSpace"/>
                        <input xpath="rendering/@labelWidth"/>
                        <input xpath="rendering/@inlineStyleLabel"/>
                      </container>
                      <container label="Table">
                        <input xpath="rendering/@width"/>
                        <input xpath="rendering/@align"/>
                        <input xpath="rendering/@tableClass"/>
                        <input xpath="rendering/@inlineStyleValue"/>
                      </container>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="javascript" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='javascript' ">
                <container alwaysActive="true" filter="/javascript$" type="collectionItemGroup" xpath="javascript" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input xpath="@labelPosition"/>
                      <input xpath="rendering/@whiteSpace"/>
                      <input visibleIf="[rendering/@whiteSpace]!='no-wrap'" xpath="rendering/@labelWidth"/>
                      <input xpath="@colspan"/>
                      <input xpath="rendering/@align"/>
                      <input xpath="rendering/@verticalAlign"/>
                      <input xpath="rendering/@width"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="image" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='image'">
                <container alwaysActive="true" filter="/image$" type="collectionItemGroup" xpath="image" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input xpath="rendering/@inlineStyle"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="link" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='link'">
                <container alwaysActive="true" filter="/link$" type="collectionItemGroup" xpath="link" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input xpath="rendering/@inlineStyle"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Advanced" name="chart" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='chart'">
                <container alwaysActive="true" filter="/chart$" type="collectionItemGroup" xpath="chart" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Display settings" type="separator"/>
                  <input nolabel="true" type="treeEdit">
                    <container label="View">
                      <input label="Inline style of the label" xpath="rendering/@inlineStyleLabel"/>
                      <input label="Inline style of the chart" xpath="rendering/@inlineStyleValue"/>
                    </container>
                  </input>
                </container>
              </container>
              <container label="Initialization script" name="page" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='page'">
                <container alwaysActive="true" filter="/page$" type="collectionItemGroup" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Javascript code to be executed (on the client side) once the page is loaded" type="separator"/>
                  <container style="flat" type="notebook" xpath="onPageLoadScript">
                    <container label="Code">
                      <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="code"/>
                    </container>
                    <container label="Texts">
                      <input editable="true" nolabel="true" type="list" xpath="strings/string">
                        <input xpath="@id"/>
                        <input label="Text" xpath="@value"/>
                      </input>
                      <static type="help">The texts created here can be used in the script using the following syntax $(IDENTIFIANT).</static>
                    </container>
                  </container>
                </container>
              </container>
              <container label="Approval script" name="page" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='page'">
                <container alwaysActive="true" filter="/page$" type="collectionItemGroup" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Javascript code to be executed (on the server side) during page approval" type="separator"/>
                  <container style="flat" type="notebook" xpath="validationScript">
                    <container label="Code">
                      <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="code"/>
                    </container>
                    <container label="Texts">
                      <input editable="true" nolabel="true" type="list" xpath="strings/string">
                        <input xpath="@id"/>
                        <input label="Text" xpath="@value"/>
                      </input>
                      <static type="help">The texts created here can be used in the script using the following syntax $(IDENTIFIANT).</static>
                    </container>
                  </container>
                </container>
              </container>
              <container label="Header" name="page" visibleIf="ExtractRight(NormalizeXPath([/ignored/tree/@xpathSelection]), '/')='page'">
                <container alwaysActive="true" filter="/page$" type="collectionItemGroup" xpathSelection="/ignored/tree/@xpathSelection">
                  <input label="Additional elements which will be integrated into the html header of the page" type="separator"/>
                  <input contentType="html" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="extraHeader"/>
                </container>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container name="subforms" xpath=".">
        <form label="Transition" name="transitionBase">
          <input xpath="@label"/>
        </form>
        <form label="Start" name="start">
          <input xpath="@label"/>
        </form>
        <form name="end">
          <container xpath="endPage">
            <input xpath="@useExternalUrl"/>
            <container type="visibleGroup" visibleIf="@useExternalUrl = true">
              <input img="xtk:form/link.png" nolabel="true" xpath="@externalUrl"/>
              <input nolabel="true" type="UrlViewer" urlExpr="@externalUrl"/>
            </container>
            <container type="visibleGroup" visibleIf="@useExternalUrl = false">
              <input label="Title" xpath="../@label"/>
              <container ref="xtk:formlib:htmlBlock"/>
            </container>
          </container>
        </form>
        <form name="next" ref="xtk:formlib:subforms/transitionBase"/>
        <form label="Tests" name="test" type="notebook">
          <container label="General">
            <input xpath="@label"/>
            <static label="Branchings" type="separator"/>
            <input editable="false" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Edit branches" type="list" xpath="transitions/condition" xpathToIgnore="transitions/condition/condition" zoom="true" zoomOnAdd="true">
              <input xpath="@label"/>
              <input colSize="45" xpath="@help"/>
              <form label="Edit branch">
                <input xpath="@label"/>
                <container ref="xtk:formlib:conditionList"/>
              </form>
            </input>
            <static label="Default branching" type="separator"/>
            <input label="Activate the default branching" xpath="transitions/default/@enabled"/>
            <container type="visibleGroup" visibleIf="[transitions/default/@enabled]">
              <input xpath="transitions/default/@label"/>
            </container>
            <static type="help">This branching is activated when no other branching are active.</static>
          </container>
          <container label="Comment">
            <input nolabel="true" xpath="comment"/>
          </container>
        </form>
        <form label="Branching" name="condition" type="notebook">
          <container label="General">
            <input xpath="@label"/>
            <static label="Condition" type="separator"/>
            <container ref="xtk:formlib:conditionList"/>
            <static label="Comment" type="separator"/>
            <input nolabel="true" xpath="comment"/>
          </container>
        </form>
        <form label="Branching" name="default" type="notebook">
          <container label="General">
            <input xpath="@label"/>
            <static label="Condition" type="separator"/>
            <static type="help">This branching is activated when no other branching are active.</static>
            <static label="Comment" type="separator"/>
            <input nolabel="true" xpath="comment"/>
          </container>
        </form>
        <form forceToSaveEntity="true" maxLabelWidth="50" name="page" nothingToSave="false">
          <container ref="xtk:formlib:pageEdit"/>
        </form>
        <form name="query">
          <enter>
            <if expr="[output/@path]=''">
              <set expr="@name" xpath="output/@path"/>
            </if>
            <if expr="[source/@schema]=''">
              <set expr="[../../@schema]" xpath="source/@schema"/>
            </if>
            <reset xpath="/tmp/selectCtrl"/>
          </enter>
          <container type="notebook">
            <container colcount="2" label="Query">
              <input colspan="2" xpath="@label"/>
              <input colspan="2" type="schemaContextDisabler"/>
              <static colspan="2" label="Edit query" type="separator"/>
              <input checkedValue="0" colspan="2" label="Use a schema from the database" type="radioButton" xpath="@inputType"/>
              <input checkedValue="1" colspan="2" label="Use an imported list" type="radioButton" xpath="@inputType"/>
              <input checkedValue="2" colspan="2" label="Use a cube" type="radioButton" xpath="@inputType"/>
              <container colspan="2" type="visibleGroup" visibleIf="[@inputType]==0">
                <input label="Source" schema="xtk:schema" type="schemaEdit" xpath="source/@schema"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[@inputType]==1">
                <input createMode="none" img="nms:rcpgroup.png" label="Imported list" xpath="predefinedData">
                  <enter name="onChange">
                    <set value="nms:group" xpath="/ignored/queryDef/@schema"/>
                    <set value="get" xpath="/ignored/queryDef/@operation"/>
                    <set value="extension" xpath="/ignored/queryDef/select/node[1]/@expr"/>
                    <set expr="'@id=' + [@predefinedData-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/tmp/tempSchemas"/>
                    </soapCall>
                    <if expr="[/tmp/tempSchemas/extension/@name] == [@name]">
                      <set expr="[@name] + NodeCount([.])" xpath="@name"/>
                    </if>
                    <copyElement xpathDst="tempSchemas/schema" xpathSrc="/tmp/tempSchemas/extension"/>
                    <set expr="LoadSchema('tempSchemas/schema')" xpath="source/@schema"/>
                    <set value="false" xpath="@contextFilter"/>
                  </enter>
                  <sysFilter>
                    <condition expr="@type!=0"/>
                  </sysFilter>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@inputType==2">
                <input createMode="none" img="xtk:olapCube.png" label="Cube" noZoom="true" xpath="cubeData">
                  <enter name="onChange">
                    <soapCall name="GetCubeSchema" service="xtk:olapCube">
                      <param exprIn="[cubeData/@id]" type="int"/>
                      <param exprIn="'true'" type="boolean"/>
                      <param type="DOMDocument" xpathOut="tempSchemas/schema"/>
                    </soapCall>
                    <set expr="LoadSchema('tempSchemas/schema')" xpath="source/@schema"/>
                    <set value="false" xpath="@contextFilter"/>
                  </enter>
                </input>
                <input xpath="@useAggregates"/>
                <static label=" " nolabel="false" type="help">Using the cube aggregates increases query efficiency. However, the results are no longer updated in real-time. The data displayed dates from the last update of the aggregate used.</static>
              </container>
              <input alwaysActive="true" expr="Iif([@inputType] == 0, '', NodePath([.]) + '/tempSchemas')" type="expr" xpath="/tmp/@schemaDataXPath"/>
              <input colspan="2" xpath="@selectAll"/>
              <container colspan="2" enabledIf="[source/@schema]!=''" type="enabledGroup">
                <input img="nms:miniatures/mini-query.png" label="Edit query..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form img="xtk:filter32.png" type="wizard">
                    <enter>
                      <set expr="[source/@schema]" xpath="/tmp/selectCtrl/in/@schema"/>
                      <if expr="NodeExists([tempSchemas])">
                        <set expr="LoadSchema('tempSchemas/schema')" xpath="/tmp/@tempSchemaName"/>
                      </if>
                    </enter>
                    <container desc="Select the columns to extract for the export (used to generate the SELECT part of the SQL statement)." img="xtk:filter32.png" name="column" title="Data to extract" visibleIf="@selectAll=false" xpath="source">
                      <enter>
                        <set expr="@schema" xpath="/tmp/selectCtrl/in/@schema"/>
                        <set expr="@startPath" xpath="/tmp/selectCtrl/in/@startPath"/>
                        <set value="export" xpath="/tmp/selectCtrl/in/@choiceType"/>
                      </enter>
                      <container allowDistinct="true" allowGroupBy="true" allowUnexpandMemo="true" extraColumns="@groupBy, @alias, @enabledIf, @analyze" ref="xtk:queryDef:hidden/selectCtrl" showCollections="true"/>
                      <leave>
                        <if expr="[/tmp/selectCtrl/out/@group] == false">
                          <reset xpath="groupBy"/>
                          <reset xpath="having"/>
                        </if>
                      </leave>
                    </container>
                    <container ref="xtk:exportSource:sort" xpath="."/>
                    <container ref="xtk:exportSource:filter" xpath="."/>
                    <container ref="xtk:exportSource:targetPage" visibleIf="EV(@inputType,'cube')=false" xpath="."/>
                    <container desc="Please enter the definition of the target element" img="nms:pictoprofile.png" name="targetPage" title="Target element" visibleIf="EV(@inputType,'cube')" xpath=".">
                      <static label="Filters parameters" type="separator"/>
                      <input type="filterView" xpath="source" xpathFilter="/ignored/@filterName" xpathSchema="source/@schema" xpathSchemaData="/tmp/@schemaDataXPath"/>
                      <leave>
                        <set value="" xpath="/ignored/@filterName"/>
                      </leave>
                    </container>
                    <container ref="xtk:exportSource:group" visibleIf="[/tmp/selectCtrl/out/@group]" xpath="."/>
                    <container ref="xtk:exportSource:having" visibleIf="[/tmp/selectCtrl/out/@group]" xpath="."/>
                  </form>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[../../@entitySchema]=='xtk:report'">
                <static label="Simplified filtering" type="separator"/>
                <container type="visibleGroup" visibleIf="@inputType == 0">
                  <input xpath="@contextFilter"/>
                </container>
                <input xpath="@folderFilter"/>
                <container colcount="2" type="visibleGroup" visibleIf="@folderFilter">
                  <input label="Local variable" type="CollectionSelect" xpath="@folderVariable" xpathSelect="$(entityPath)/variables/variable"/>
                  <input label="Edit variables..." nolabel="false" prebuildSubForm="false" type="SubFormLink" xpath=".">
                    <form label="Edit branches">
                      <input editable="true" nolabel="true" toolbarAlign="horizontal" type="list" xpath="$(entityPath)/variables/variable" zoom="true" zoomOnAdd="true">
                        <input colSize="20" xpath="@label"/>
                        <input colSize="20" xpath="@xpath"/>
                        <input colSize="15" xpath="@type"/>
                        <form label="Variable">
                          <container ref="xtk:formlib:variable"/>
                        </form>
                      </input>
                    </form>
                  </input>
                  <container colspan="2" enabledIf="[source/@schema]!='' and [source/@schema] != [../../@schema]" type="enabledGroup">
                    <input choiceType="xpath" margin-left="20" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@contextLink" xpathSchema="source/@schema"/>
                  </container>
                </container>
              </container>
              <static colspan="2" label="Limit result" type="separator"/>
              <input colspan="2" label="Limit the selected records" nolabel="false" xpath="limiter/@enabled"/>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[limiter/@enabled]=true" xpath="limiter">
                <input checkedValue="firstRow" colspan="2" label="Limit to first record" type="radioButton" xpath="@type"/>
                <input checkedValue="size" label="Size:" type="radioButton" xpath="@type"/>
                <container enabledIf="@type='size'" type="enabledGroup">
                  <input nolabel="true" xpath="@sizeValue"/>
                </container>
              </container>
              <static colspan="2" label="Store result" type="separator"/>
              <input colspan="2" xpath="output/@path"/>
            </container>
          </container>
        </form>
        <form name="script">
          <input xpath="@label"/>
          <input label="Script" type="separator"/>
          <container style="flat" type="notebook">
            <container label="Code">
              <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="code"/>
            </container>
            <container label="Texts">
              <input editable="true" nolabel="true" type="list" xpath="strings/string">
                <input xpath="@id"/>
                <input label="Text" xpath="@value"/>
              </input>
              <static type="help">The texts created here can be used in the script using the following syntax $(IDENTIFIANT).</static>
            </container>
          </container>
        </form>
        <form name="prefill">
          <enter>
            <if expr="HasPackage('nms:social') = false">
              <set value="neolane" xpath="/tmp/@prefillDataSource"/>
            </if>
            <if expr="HasPackage('nms:social')">
              <set expr="Iif(@source = '', 'neolane', @source)" xpath="/tmp/@prefillDataSource"/>
            </if>
          </enter>
          <input xpath="@label"/>
          <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="[/ignored/@hasSocial]">
            <input xpath="@source">
              <enter name="onChange">
                <set expr="@source" xpath="/tmp/@prefillDataSource"/>
              </enter>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/@prefillDataSource] = 'neolane'">
            <input label="Auto-load data referenced in the form" xpath="@autodetect"/>
            <input label="Load additional data" xpath="@additionnalData"/>
            <container type="visibleGroup" visibleIf="@additionnalData!=false">
              <input editable="true" label=" " ordered="true" type="list" xpath="select/node">
                <input xpath="@label"/>
                <input noTransaction="true" type="pathEdit" xpath="@expr" xpathAlias="@alias" xpathLabel="@label" xpathSchema="$(entityPath)/@schema" zoom="true"/>
                <input xpath="@alias"/>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@hasSocial] = false">
              <static label="Identification" type="separator"/>
              <container type="visibleGroup" visibleIf="[/ignored/@hasPurl] = false">
                <input label="Method" xpath="@method"/>
              </container>
              <container type="visibleGroup" visibleIf="@method='des'">
                <input xpath="@desKey"/>
              </container>
              <container type="visibleGroup" visibleIf="@method='keyList'">
                <input editable="true" label="Fields" lineCount="8" ordered="true" type="list" xpath="contextKeys/key">
                  <input schema="temp:formContext" type="pathEdit" xpath="@expr" zoom="true"/>
                </input>
              </container>
              <input label="Skip preloading if no ID" xpath="@skipIfNoId"/>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="[/ignored/@hasSocial] and [/tmp/@prefillDataSource] = 'facebook'">
            <input label="Public information" type="separator"/>
            <input xpath="facebook/@profile"/>
            <input xpath="facebook/@picture"/>
            <input xpath="facebook/@friends"/>
            <input label="Private information" type="separator"/>
            <static label="To recover this information, the user will need access permissions." type="help"/>
            <input xpath="facebook/@email"/>
            <input xpath="facebook/@birthDate"/>
            <input xpath="facebook/@likes"/>
            <input xpath="facebook/@location"/>
            <container backcolor="tooltip" padding="10">
              <static label="In order to comply with Facebook conditions of use, as well as for performance reasons, only data which is essential to your application must be recovered." type="warning"/>
              <input label="I agree to comply with Facebook conditions of use." nolabel="true" type="checkBox" xpath="@acceptedLegalTerms"/>
            </container>
          </container>
          <leave>
            <check expr="[/tmp/@prefillDataSource] = 'neolane' or @acceptedLegalTerms">
              <error>To continue, you need to agree to the Facebook conditions of use.</error>
            </check>
          </leave>
        </form>
        <form name="writer">
          <input xpath="@label"/>
          <container label="Storage" type="visibleGroup" visibleIf="[/ignored/@hasLead]=false and [/ignored/@hasSocial]=false">
            <input label="Update the preloaded record" xpath="@updateOnly"/>
            <input label="Reconciliation options" type="separator"/>
            <input label=" " type="webAppStorageTree" xpath="." xpathSelection="/ignored/storage/@xpathSelection"/>
            <container type="visibleGroup" visibleIf="[/ignored/storage/@xpathSelection] != ''" xpath="key">
              <container alwaysActive="true" type="collectionItemGroup" xpath="." xpathSelection="/ignored/storage/@xpathSelection">
                <input xpath="@operation"/>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="[../../@schema]='nms:recipient' and @updateOnly!='true'">
              <input img="nms:rcpFolder.png" xpath="folder">
                <sysFilter>
                  <condition expr="@model like 'nmsRecipient%'"/>
                </sysFilter>
              </input>
              <input label="Creation options" type="separator"/>
              <input img="nms:rcpFolder.png" xpath="folderCreate">
                <sysFilter>
                  <condition expr="@model like 'nmsRecipient%'"/>
                </sysFilter>
              </input>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:social')" maxLabelWidth="170" type="visibleGroup" visibleIf="[$(entityPath)/facet/@social]">
            <input img="nms:rcpFolder.png" xpath="folderCreateVisitor">
              <sysFilter>
                <condition expr="@model like 'nmsVisitor%'"/>
              </sysFilter>
            </input>
            <input xpath="@reconciliationStrategy"/>
            <container type="visibleGroup" visibleIf="EV(@reconciliationStrategy, 'auto')">
              <static type="help">Reconciliation is based on the email address, last name, first name and date of birth depending on the information provided.</static>
            </container>
            <container type="visibleGroup" visibleIf="EV(@reconciliationStrategy, 'none') = false">
              <input createMode="none" img="nms:deliveryMapping.png" notifyPathList="@schema" xpath="reconciliationMapping">
                <enter name="onChange">
                  <set expr="[reconciliationMapping/@schema]" xpath="@reconciliationMappingSchema"/>
                </enter>
              </input>
              <container type="visibleGroup" visibleIf="EV(@reconciliationStrategy, 'manual') and @reconciliationMappingSchema != ''">
                <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" toolbarCaption="Reconciliation criteria" type="columnList" xpath="manualMapping/mapping" xpathSchema="@reconciliationMappingSchema" zoom="false">
                  <input colSize="50" type="pathedit" xpath="@visitorExpr" xpathSchema="$(entityPath)/@schema"/>
                  <input colSize="50" type="pathedit" xpath="@contactExpr" xpathSchema="../../@reconciliationMappingSchema"/>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="@reconciliationMappingSchema = 'nms:recipient'">
                <input img="nms:rcpFolder.png" xpath="folder">
                  <sysFilter>
                    <condition expr="@model like 'nmsRecipient%'"/>
                  </sysFilter>
                </input>
                <input img="nms:rcpFolder.png" xpath="folderCreate">
                  <sysFilter>
                    <condition expr="@model like 'nmsRecipient%'"/>
                  </sysFilter>
                </input>
                <static type="help">If reconciliation fails but the visitor provided their email address, a new contact is created.</static>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('crm:lead')" type="visibleGroup" visibleIf="[/ignored/@hasLead]=true">
            <container ref="crm:webAppWriter:action"/>
          </container>
        </form>
        <form label="Jump" name="jump" type="notebook">
          <container label="General">
            <container label="Destination" type="frame">
              <input checkedValue="0" label="Internal activity" type="RadioButton" xpath="@targetType"/>
              <input checkedValue="1" label="Explicit" type="RadioButton" xpath="@targetType"/>
              <input checkedValue="2" label="Stored in a variable" type="RadioButton" xpath="@targetType"/>
              <container propagateConstraints="true">
                <container type="visibleGroup" visibleIf="@targetType=0">
                  <input type="CollectionSelect" xpath="@target" xpathSelect="$(entityPath)/activities/page">
                    <xcopy dst="@label" src="@label"/>
                  </input>
                </container>
                <container applicableIf="$(contextSchema)='nms:webApp'" type="visibleGroup" visibleIf="@targetType=1">
                  <input createMode="none" folderFilterChoice="@model like 'nmsWebApp%'" img="nms:webApp.png" type="linkEdit" xpath="externalTarget" xpathAlias="@label">
                    <sysFilter>
                      <condition expr="@isModel = 0"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                  </input>
                  <input expr="[@externalTarget-cs]" type="expr" xpath="@label"/>
                </container>
                <container applicableIf="$(contextSchema)='xtk:report'" type="visibleGroup" visibleIf="@targetType=1">
                  <input createMode="none" folderFilterChoice="@model like 'xtkReport%'" img="xtk:report.png" noAutoComplete="true" type="linkEdit" xpath="externalTarget">
                    <sysFilter>
                      <condition expr="@isModel = 0"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                  </input>
                  <input expr="[@externalTarget-cs]" type="expr" xpath="@label"/>
                </container>
                <container colcount="2" type="visibleGroup" visibleIf="@targetType=2">
                  <input label="Local variable" type="CollectionSelect" xpath="@targetNameVariable" xpathSelect="$(entityPath)/variables/variable"/>
                  <container propagateConstraints="true">
                    <input label="Edit variables..." nolabel="false" prebuildSubForm="false" type="SubFormLink" xpath=".">
                      <form label="Edit branches">
                        <input editable="true" nolabel="true" toolbarAlign="horizontal" type="list" xpath="$(entityPath)/variables/variable" zoom="true" zoomOnAdd="true">
                          <input colSize="20" xpath="@label"/>
                          <input colSize="20" xpath="@xpath"/>
                          <input colSize="15" xpath="@type"/>
                          <form label="Variable">
                            <container ref="xtk:formlib:variable"/>
                          </form>
                        </input>
                      </form>
                    </input>
                  </container>
                </container>
              </container>
            </container>
            <static label="Script" type="separator"/>
            <static type="help">This script will be executed just before the jump.</static>
            <container style="flat" type="notebook">
              <container label="Code">
                <input contentType="JavaScript" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="code"/>
              </container>
              <container label="Texts">
                <input editable="true" nolabel="true" type="list" xpath="strings/string">
                  <input xpath="@id"/>
                  <input label="Text" xpath="@value"/>
                </input>
                <static type="help">The texts created here can be used in the script using the following syntax $(IDENTIFIANT).</static>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="@targetType!=0">
              <static type="warning">Changes to the context will not be propagated to the target.</static>
            </container>
          </container>
          <container label="Comment">
            <static label="Comment" type="separator"/>
            <input nolabel="true" xpath="comment"/>
          </container>
        </form>
      </container>
      <container name="variable">
        <static label="Properties of the variable" type="separator"/>
        <input xpath="@label"/>
        <input label="Name" xpath="@xpath"/>
        <input xpath="@desc"/>
        <input xpath="@type"/>
        <static label="Constraints" type="separator"/>
        <input xpath="@default"/>
        <container type="visibleGroup" visibledIf="@type='string'">
          <input xpath="@dataPolicy"/>
        </container>
      </container>
      <container name="storageMode" propagateConstraints="true">
        <container type="visibleGroup" visibleIf="@type!='folderSelector'">
          <static img="nms:circle-one.png">Select your need</static>
          <container margin-bottom="10" margin-left="30">
            <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" padding-bottom="4" type="visibleGroup" visibleIf="[/ignored/@hasSurvey]">
              <container>
                <static img="xtk:form/question32.png" rowspan="2" type="image"/>
              </container>
              <container unbound-width="true">
                <static font-size="14" label="Store answers to a question" unbound-width="true"/>
                <input checkedValue="library" label="You want to save all values entered, even when a participant fills in the form more than once." type="radiobutton" xpath="storage/@mode"/>
              </container>
            </container>
            <container colcount="2" padding-bottom="4" propagateConstraints="true">
              <input alwaysActive="true" translatedExpr="'Edit a ' + Lower(SchemaLabel([/webApp/@schema]))" type="expr" xpath="/tmp/@xpathModeLabel"/>
              <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" propagateConstraints="true" type="visibleGroup" visibleIf="[$(entityPath)/facet/@advanced] = false or [/ignored/@hasSurvey] or [/ignored/@hasPurl] or [/ignored/@hasLead]">
                <container>
                  <static img="xtk:form/entity.png" rowspan="2" type="image"/>
                </container>
                <container unbound-width="true">
                  <input font-size="14" fontBold="true" type="label" xpath="/tmp/@xpathModeLabel"/>
                  <input checkedValue="xpath" label="You want to save only the last value entered for each participant." type="radiobutton" xpath="storage/@mode"/>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" propagateConstraints="true" type="visibleGroup" visibleIf="([$(entityPath)/facet/@advanced] = false or [/ignored/@hasSurvey] or [/ignored/@hasPurl] or [/ignored/@hasLead]) = false">
                <container>
                  <static img="xtk:form/entity.png" rowspan="2" type="image"/>
                </container>
                <container unbound-width="true">
                  <input font-size="14" fontBold="true" type="label" xpath="/tmp/@xpathModeLabel"/>
                  <input checkedValue="xpath" label="You want to change information on the entity being edited." type="radiobutton" xpath="storage/@mode"/>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='xtk:report'" colcount="2" propagateConstraints="true" type="visibleGroup" visibleIf="true">
                <container>
                  <static img="xtk:form/entity.png" rowspan="2" type="image"/>
                </container>
                <container unbound-width="true">
                  <static font-size="14" label="Filter entities" unbound-width="true"/>
                  <input checkedValue="xpath" label="You want to filter information on the entity being edited." type="radiobutton" xpath="storage/@mode"/>
                </container>
              </container>
            </container>
            <container colcount="2">
              <container>
                <static img="xtk:form/variable32.png" rowspan="2" type="image"/>
              </container>
              <container unbound-width="true">
                <static font-size="14" label="Variable" unbound-width="true"/>
                <input checkedValue="var" label="You want to use variable fields whose content will not be saved." type="radiobutton" xpath="storage/@mode"/>
              </container>
            </container>
          </container>
          <static img="nms:circle-two.png">Edit properties</static>
        </container>
        <container colcount="2" margin-left="30">
          <container colspan="2" type="visibleGroup" visibleIf="[storage/@mode]='xpath'">
            <input hideCalculated="true" hideMappedAsXml="false" label="Database field" noTransaction="true" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="storage/@xpath" xpathBaseType="storage/@type" xpathEnum="storage/@enum" xpathLabel="@label" xpathSchema="$(entityPath)/@schema" xpathUnbound="storage/@unbound" xpathUserEnum="storage/@userEnum" zoom="true"/>
          </container>
          <container applicableIf="$(contextSchema)='nms:webApp' and hasPackage('nms:survey')" colcount="2" colspan="2" type="visibleGroup" visibleIf="[storage/@mode]='library'">
            <input choiceType="condition" colspan="2" hideCalculated="true" hideMappedAsXml="false" label="Archived field" noTransaction="true" nolabel="false" schemaExpr="iif([/ignored/@archivedFieldSchemaEdit] != '', [/ignored/@archivedFieldSchemaEdit], [/webApp/@archivedFieldSchema])" type="pathEdit" useUnboundPath="true" xpath="storage/field/@xpath" xpathBaseType="storage/@type" xpathEnum="storage/@enum" xpathLabel="@label" xpathSchemaMd5="/ignored/@md5Library" xpathUnbound="storage/@unbound" xpathUserEnum="storage/@userEnum" zoom="true"/>
            <container colcount="2" colspan="2" propagateConstraints="true">
              <input label="New field..." mode="new" nolabel="false" prebuildSubForm="false" type="archivedFieldEdit" xpath="/webApp/archivedFields/field">
                <form label="Create new archived field" xpath=".">
                  <enter>
                    <set value="new" xpath="/ignored/@mode"/>
                  </enter>
                  <container ref="xtk:formlib:archivedField"/>
                  <leave>
                    <set expr="SubString([userEnum/@name], 0,128)" xpath="userEnum/@name"/>
                    <check expr="@autoSqlName or @sqlname!=''">
                      <error>You must specify the SQL name of the field.</error>
                    </check>
                  </leave>
                </form>
              </input>
              <container type="visibleGroup" visibleIf="[storage/field/@xpath]!=''">
                <input label="Edit the field..." mode="edit" nolabel="false" prebuildSubForm="false" type="archivedFieldEdit" xpath="/webApp/archivedFields/field">
                  <form label="Edit archived field" xpath=".">
                    <enter>
                      <set value="edit" xpath="/ignored/@mode"/>
                      <set expr="@name" xpath="/tmp/@name"/>
                    </enter>
                    <container ref="xtk:formlib:archivedField"/>
                    <leave>
                      <set expr="SubString([userEnum/@name], 0,128)" xpath="userEnum/@name"/>
                    </leave>
                  </form>
                </input>
              </container>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[storage/@mode]='var'">
            <input label="Variable" type="CollectionSelect" xpath="storage/variable/@xpath" xpathSelect="$(entityPath)/variables/variable">
              <xcopy dst="storage/@type" src="@type"/>
            </input>
            <input label="Edit variables..." nolabel="false" prebuildSubForm="false" type="SubFormLink" xpath=".">
              <form label="Edit branches">
                <input editable="true" nolabel="true" toolbarAlign="horizontal" type="list" xpath="$(entityPath)/variables/variable" zoom="true" zoomOnAdd="true">
                  <input colSize="20" xpath="@label"/>
                  <input colSize="20" xpath="@xpath"/>
                  <input colSize="15" xpath="@type"/>
                  <form label="Variable">
                    <container ref="xtk:formlib:variable"/>
                  </form>
                </input>
              </form>
            </input>
          </container>
        </container>
      </container>
      <container name="archivedField">
        <static label="Field properties" type="separator"/>
        <input xpath="@label"/>
        <container type="visibleGroup" visibleIf="[/ignored/@mode] != 'edit'">
          <input type="computeNameEdit" xpath="@name" xpathRef="@label"/>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/@mode] = 'edit'">
          <input label="Name" xpath="/tmp/@name"/>
        </container>
        <input xpath="@desc"/>
        <input enum="xtk:abstractForm:fieldType" type="sysEnum" xpath="@type"/>
        <container type="visibleGroup" visibleIf="[/ignored/@mode] = 'edit'">
          <static type="warning">WARNING, if you change the type you will lose all data already stored for this field.</static>
        </container>
        <container type="visibleGroup" visibleIf="@type='string'">
          <input enum="xtk:common:dataPolicy" label="Constraint" type="sysEnum" xpath="@dataPolicy"/>
          <input computeStringAlias="@name" computeStringExpr="@name" form="xtk:enum" label="Enumeration" newEntityFormChoice="true" schema="xtk:enum" type="linkEdit" xpath="userEnum"/>
        </container>
        <input type="checkbox" xpath="@unbound"/>
        <input type="checkbox" xpath="@autoSqlName"/>
        <container type="visibleGroup" visibleIf="!@autoSqlName">
          <input xpath="@sqlname"/>
        </container>
      </container>
      <container colcount="2" colspan="2" img="nms:detailview.png" label="Edit" name="design">
        <container colspan="2" name="diagram">
          <container style="flat" type="notebook">
            <container colcount="2" label="Edit">
              <input xpath="@label"/>
              <input xpath="@internalName"/>
              <input colspan="2" type="webAppDiagramEdit" xpath=".">
                <input type="separator"/>
                <input img="xtk:properties.png" label="Properties" prebuildSubForm="false" resetForm="true">
                  <form ref="xtk:formlib:properties"/>
                </input>
              </input>
            </container>
            <container label="Code" visibleIf="@id != 0">
              <container applicableIf="$(contextSchema)='nms:webApp'" ref="nms:webAppSourceCode:code"/>
              <container applicableIf="$(contextSchema)='xtk:report'" ref="xtk:reportSourceCode:code"/>
            </container>
            <container ref="xtk:formlib:translations" visibleIf="@designLanguage != @defaultLanguage or NodeExists([additionalLanguages/language]) == true"/>
          </container>
        </container>
      </container>
      <container img="xtk:properties.png" label="Properties" name="properties">
        <form label="Properties" name="form">
          <container name="notebook" type="notebook">
            <container colcount="2" label="General" name="general">
              <input xpath="@label"/>
              <input xpath="@internalName"/>
              <input applicableIf="$(contextSchema)='nms:webApp'" xpath="@nature"/>
              <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" prebuildSubForm="false" type="SubformLink" xpath=".">
                <form label="Advanced parameters">
                  <input hideImage="true" noPropagateImg="true" schema="xtk:image" type="linkedit" xpath="@background"/>
                  <input xpath="@timezone"/>
                  <container applicableIf="$(contextSchema)='nms:webApp'" type="visibleGroup" visibleIf="true">
                    <static label="Optional functionalities" type="separator"/>
                    <container applicableIf="HasPackage('nms:survey')" type="visibleGroup" visibleIf="true">
                      <input xpath="facet/@survey"/>
                    </container>
                    <container applicableIf="HasPackage('nms:purl')" type="visibleGroup" visibleIf="true">
                      <input xpath="facet/@purl"/>
                    </container>
                    <container applicableIf="HasPackage('crm:lead')" type="visibleGroup" visibleIf="true">
                      <input xpath="facet/@lead"/>
                    </container>
                    <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="true">
                      <input xpath="facet/@social"/>
                    </container>
                    <container>
                      <input xpath="facet/@advanced"/>
                    </container>
                    <container applicableIf="HasPackage('nms:survey')" type="visibleGroup" visibleIf="true">
                      <input expr="iif([facet/@survey], true, @trackingEnabled)" type="expr" xpath="@trackingEnabled"/>
                      <container enabledIf="![facet/@survey]" type="enabledGroup">
                        <input xpath="@trackingEnabled"/>
                      </container>
                    </container>
                    <container applicableIf="HasPackage('nms:survey') = false" type="visibleGroup" visibleIf="true">
                      <input xpath="@trackingEnabled"/>
                    </container>
                  </container>
                  <container applicableIf="$(contextSchema)='xtk:report'">
                    <input xpath="@noHistory"/>
                  </container>
                  <container applicableIf="$(contextSchema)='nms:webApp' and HasPackage('nms:survey')" type="visibleGroup" visibleIf="[facet/@survey]">
                    <static label="Survey option" type="separator"/>
                    <input xpath="@xmlBackup"/>
                  </container>
                  <container applicableIf="$(contextSchema)='nms:webApp'">
                    <static label="Other options" type="separator"/>
                    <input createMode="none" xpath="deliveryMapping"/>
                    <static label="The target mapping is deducted from the document type." type="help"/>
                    <input createMode="none" xpath="defaultOrigin">
                      <sysFilter>
                        <condition expr="@nature='unknownSource'"/>
                      </sysFilter>
                    </input>
                    <static label="You can specify a source for non-identified traffic." type="help"/>
                    <input useDesc="true" xpath="@originUrlOverride"/>
                  </container>
                  <leave>
                    <if expr="@entitySchema='nms:webApp'">
                      <if expr="HasPackage('crm:lead')">
                        <set expr="[facet/@lead]" xpath="/ignored/@hasLead"/>
                        <if expr="[facet/@lead]">
                          <set value="crm:webAppLogLead" xpath="@library"/>
                          <set value="crm:incomingLead" xpath="@schema"/>
                        </if>
                      </if>
                      <if expr="HasPackage('nms:social')">
                        <set expr="[facet/@social]" xpath="/ignored/@hasSocial"/>
                        <if expr="[facet/@social]">
                          <set value="nms:webAppLogVisitor" xpath="@library"/>
                          <set value="nms:visitor" xpath="@schema"/>
                        </if>
                      </if>
                      <if expr="HasPackage('nms:survey')">
                        <set expr="[facet/@survey]" xpath="/ignored/@hasSurvey"/>
                        <set expr="'temp:' + ExtractRight(@library, ':') + 'Data'" xpath="@archivedFieldSchema"/>
                      </if>
                      <if expr="HasPackage('nms:purl')">
                        <set expr="[facet/@purl]" xpath="/ignored/@hasPurl"/>
                        <if expr="[facet/@purl]">
                          <set value="1" xpath="@accessControl"/>
                        </if>
                      </if>
                    </if>
                  </leave>
                </form>
              </input>
              <container applicableIf="$(contextSchema)!='xtk:report'" type="visibleGroup" visibleIf="@isModel">
                <input xpath="folderProcess">
                  <sysFilter>
                    <condition expr="@model = 'nmsWebApp'"/>
                  </sysFilter>
                </input>
              </container>
              <container applicableIf="$(contextSchema)='xtk:report'" type="visibleGroup" visibleIf="@isModel">
                <input xpath="folderProcess">
                  <sysFilter>
                    <condition expr="@model = 'xtkReport'"/>
                  </sysFilter>
                </input>
              </container>
              <container applicableIf="$(contextSchema)!='xtk:report'" colspan="2">
                <input xpath="folder">
                  <sysFilter>
                    <condition expr="@model = 'nmsWebApp'"/>
                  </sysFilter>
                </input>
              </container>
              <container applicableIf="$(contextSchema)='xtk:report'" colspan="2">
                <input xpath="folder">
                  <sysFilter>
                    <condition expr="@model = 'xtkReport'"/>
                  </sysFilter>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="![/ignored/@hasLead] and [/ignored/@hasSocial] = false">
                <input label="Storage" type="separator"/>
                <input colspan="2" label="Document type" schema="xtk:schema" type="schemaEdit" xpath="@schema" xpathStartPath="@startPath">
                  <enter name="onChange">
                    <if expr="NodeName([/]) = 'webApp'">
                      <set value="nms:deliveryMapping" xpath="/ignored/queryDefMap/@schema"/>
                      <set value="getIfExists" xpath="/ignored/queryDefMap/@operation"/>
                      <set value="@id" xpath="/ignored/queryDefMap/select/node[1]/@expr"/>
                      <set value="[.]" xpath="/ignored/queryDefMap/select/node[2]/@expr"/>
                      <set value="@_cs" xpath="/ignored/queryDefMap/select/node[2]/@alias"/>
                      <set expr="'@schema=\''+@schema + '\''" xpath="/ignored/queryDefMap/where/condition/@expr"/>
                      <soapCall name="ExecuteQuery" service="xtk:queryDef">
                        <param exprIn="[/ignored/queryDefMap]" type="DOMDocument"/>
                        <param type="DOMDocument" xpathOut="deliveryMapping"/>
                      </soapCall>
                      <set expr="iif([deliveryMapping/@id] != '', [deliveryMapping/@id], 0)" xpath="@deliveryMapping-id"/>
                    </if>
                  </enter>
                </input>
                <container applicableIf="$(contextSchema)='nms:webApp'" colspan="2" type="visibleGroup" visibleIf="@trackingEnabled">
                  <input label="Library" schema="xtk:schema" type="schemaEdit" xpath="@library"/>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" colcount="2" colspan="2" type="visibleGroup" visibleIf="!@isModel">
                <input colspan="2" label="Project" type="separator"/>
                <input readOnly="true" xpath="@appState"/>
                <input xpath="@startDate"/>
                <input label="Personalize the message displayed if the form is closed..." nolabel="true" prebuildSubForm="false" type="SubformLink" xpath=".">
                  <form label="Message personalization">
                    <static label="Enter the text to be displayed if the form is closed." type="help"/>
                    <input nolabel="true" xpath="closedFormLog"/>
                  </form>
                </input>
                <input xpath="@endDate"/>
              </container>
              <container applicableIf="HasPackage('nms:aemIntegration') and $(contextSchema)='nms:webApp'" colspan="2">
                <input label="AEM" type="separator"/>
                <input xpath="@useAEM"/>
                <container type="visibleGroup" visibleIf="@useAEM=true">
                  <input xpath="cmsAccount">
                    <sysFilter>
                      <condition expr="@type='12'"/>
                    </sysFilter>
                  </input>
                </container>
              </container>
              <container applicableIf="$(contextSchema)='nms:webApp'" colspan="2">
                <input label="Web tracking" type="separator"/>
                <input xpath="@webTrackingEnabled"/>
                <container type="visibleGroup" visibleIf="@webTrackingEnabled=true">
                  <static label="Script for generating the tag:" type="label"/>
                  <input contentType="JavaScript" nolabel="true" toolbar="false" type="CodeEdit" xpath="@trackingUrlName"/>
                </container>
                <container type="visibleGroup" visibleIf="@webTrackingEnabled=true">
                  <static label="Script for generating the folder:" type="label"/>
                  <input contentType="JavaScript" nolabel="true" toolbar="false" type="CodeEdit" xpath="@folderName"/>
                </container>
              </container>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@hasPurl]=false">
                <input colspan="2" label="Access control" type="separator"/>
                <input checkedValue="1" colspan="2" label="Anonymous access" type="radioButton" xpath="@accessControl"/>
                <input checkedValue="0" colspan="2" label="Enable access control" type="radioButton" xpath="@accessControl"/>
                <input checkedValue="2" colspan="2" label="Use a specific account" type="radioButton" xpath="@accessControl"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@accessControl=0">
                <input label="This application is accessed via permalinks" xpath="@permaLink"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@accessControl=2">
                <input createMode="none" noZoom="true" xpath="operator">
                  <sysFilter>
                    <condition expr="@type = 0"/>
                  </sysFilter>
                </input>
              </container>
              <container applicableIf="HasPackage('nms:social') and $(contextSchema)='nms:webApp'" colspan="2" type="visibleGroup" visibleIf="[facet/@social]">
                <input label="Link to the application" type="separator"/>
                <input img="nms:miniatures/mini-accessControl.png" type="linkedit" xpath="socialAccount">
                  <sysFilter>
                    <condition expr="@type = 9"/>
                  </sysFilter>
                </input>
              </container>
              <input colspan="2" label="Description" type="separator"/>
              <input colspan="2" nolabel="true" xpath="desc"/>
            </container>
            <container label="Page" name="page" xpath="properties">
              <static label="Window title" type="separator"/>
              <input nolabel="true" xpath="@windowTitle"/>
              <container colspan="2" style="flat" type="notebook">
                <container label="Page header and footer">
                  <static label="Header" type="separator"/>
                  <input nolabel="true" type="dhtml" xpath="header"/>
                  <static label="Page footer" type="separator"/>
                  <input nolabel="true" type="dhtml" xpath="footer"/>
                </container>
                <container label="Texts">
                  <input editable="true" nolabel="true" type="list" xpath="strings/string">
                    <input xpath="@id"/>
                    <input label="Text" xpath="@value"/>
                  </input>
                  <static type="help">Text created here can be used in the HTML by using the following syntax &lt;%= $(IDENTIFIANT) %&gt;.</static>
                </container>
              </container>
              <input nolabel="true" xpath="@displayFrame"/>
            </container>
            <container label="Localization" name="localisation">
              <input label="Main languages" type="separator"/>
              <container colcount="2">
                <input xpath="@designLanguage"/>
                <input xpath="@defaultLanguage"/>
              </container>
              <input label="Other languages" type="separator"/>
              <input nolabel="true" notitle="true" type="list" xpath="additionalLanguages/language">
                <input xpath="@lang"/>
              </input>
              <input label="Default dictionary" type="separator"/>
              <input label="Path" xpath="defaultDictionary">
                <sysFilter>
                  <condition expr="@model='xtkDictionary' and @isView!=1 and @name!='xtkSystemDictionary'"/>
                </sysFilter>
              </input>
            </container>
            <container colcount="2" label="Rendering" name="rendering">
              <static colspan="2" label="Chart rendering engine" type="separator"/>
              <input colspan="2" label="Rendering engine" xpath="properties/@renderingEngine"/>
              <static colspan="2" label="Navigation" type="separator"/>
              <container colcount="2" colspan="2" propagateConstraints="true" xpath="properties">
                <input checkedValue="button" label="Use buttons" nolabel="false" type="radioButton" xpath="@navigationMode"/>
                <input checkedValue="link" label="Use links" nolabel="false" type="radioButton" xpath="@navigationMode"/>
              </container>
              <input colspan="2" label="Labels" type="separator"/>
              <input colspan="2" xpath="properties/@labelPosition"/>
              <input colspan="2" label="Generation" type="separator"/>
              <input applicableIf="$(contextSchema)='nms:webApp'" colspan="2" label="Template" xpath="rendering">
                <sysFilter>
                  <condition expr="@type = 0"/>
                </sysFilter>
              </input>
              <input applicableIf="$(contextSchema)='xtk:report'" colspan="2" label="Template" xpath="rendering">
                <sysFilter>
                  <condition expr="@type = 1"/>
                </sysFilter>
              </input>
              <input colspan="2" sessionToken="true" type="UrlViewer" urlExpr="$(serverUrl) + '/xtk/themePreview.jssp?id=' + [@rendering-id]"/>
            </container>
            <container label="Parameters" name="parameters">
              <static label="Initialization" type="separator"/>
              <input editable="false" nolabel="true" prebuildSubForm="false" toolbarAlign="horizontal" type="list" xpath="parameters/param" zoom="true" zoomOnAdd="true">
                <input xpath="@name"/>
                <input label="Mandatory" xpath="@required"/>
                <form>
                  <container type="notebook">
                    <container label="Properties" propagateConstraints="false">
                      <input xpath="@name"/>
                      <input xpath="@required"/>
                      <container ref="xtk:formlib:storageMode"/>
                    </container>
                  </container>
                </form>
              </input>
              <static type="help">The parameters are passed in the URL during the call.</static>
              <static label="Advanced configuration management" type="separator"/>
              <input label="Authorize write access to the context from the parameters" nolabel="true" xpath="parameters/@allowXPathParameters"/>
            </container>
            <container label="Variables" name="variables">
              <static label="Declare variables" type="separator"/>
              <input editable="true" nolabel="true" prebuildSubForm="false" toolbarAlign="horizontal" type="list" xpath="variables/variable" zoom="true" zoomOnAdd="true">
                <input colSize="20" xpath="@label"/>
                <input colSize="20" xpath="@xpath"/>
                <input colSize="15" xpath="@type"/>
                <form label="Variable">
                  <container ref="xtk:formlib:variable"/>
                </form>
              </input>
              <static type="help">The variables are exposed in the context and usable in calculations.</static>
            </container>
            <container label="Scripts" name="scripts">
              <static label="JavaScript codes" type="separator"/>
              <input editable="true" nolabel="true" toolbarAlign="horizontal" type="list" xpath="library/script" zoom="false" zoomOnAdd="false">
                <input xpath="@runat"/>
                <input xpath="ref"/>
              </input>
            </container>
            <container name="errorPage" xpath="errorPage">
              <static label="Error page" type="separator"/>
              <container type="visibleGroup" visibleIf="[endPage/@useExternalUrl] = true">
                <input type="UrlViewer" urlExpr="[endPage/@externalUrl]"/>
              </container>
              <container type="visibleGroup" visibleIf="[endPage/@useExternalUrl] = false">
                <input xpath="@label"/>
                <container style="flat" type="notebook">
                  <container label="HTML">
                    <input nolabel="true" type="dhtml" xpath="endPage/source"/>
                  </container>
                  <container label="Texts">
                    <input editable="true" nolabel="true" type="list" xpath="endPage/strings/string">
                      <input xpath="@id"/>
                      <input label="Text" xpath="@value"/>
                    </input>
                    <static type="help">Text created here can be used in the HTML by using the following syntax &lt;%= $(IDENTIFIANT) %&gt;.</static>
                  </container>
                </container>
              </container>
            </container>
          </container>
        </form>
      </container>
      <container label="Preview" name="preview">
        <container applicableIf="$(contextSchema)='xtk:report'">
          <container colcount="3">
            <container enabledIf="@isGlobal" type="enabledGroup">
              <input checkedValue="global" label="Global" type="radiobutton" xpath="/ignored/@context"/>
            </container>
            <container enabledIf="@monoselection = true or @multiselection = true" type="enabledGroup">
              <input checkedValue="selection" label="Selection" type="radiobutton" xpath="/ignored/@context"/>
            </container>
            <container type="visibleGroup" visibleIf="@monoselection = true or @multiselection = true and [/ignored/@context] = 'selection'">
              <input computeStringAlias="@_cs" createMode="none" nolabel="true" type="linkEdit" xpath="/ignored/@selection" xpathSchema="@schema"/>
            </container>
          </container>
          <input alwaysActive="true" expr="Iif([targetReport/@internalName] != '', [targetReport/@adHocReport], @adHocReport)" type="expr" xpath="/ignored/@displayUrlIsAdHoc"/>
          <input alwaysActive="true" expr="Iif([targetReport/@internalName] != '', [targetReport/@internalName], @internalName)" type="expr" xpath="/ignored/@displayUrlInternalName"/>
          <input alwaysActive="true" expr="Iif([targetReport/@id] != '', [targetReport/@id], @id)" type="expr" xpath="/ignored/@displayUrlId"/>
          <input alwaysActive="true" expr="Iif([targetReport/@uuid] != '', [targetReport/@uuid], @uuid)" type="expr" xpath="/ignored/@displayUrlUuid"/>
          <input alwaysActive="true" expr="$(serverUrl) + Iif([/ignored/@displayUrlIsAdHoc], '/xtk/adHocReport.jssp', '/report/' + [/ignored/@displayUrlInternalName]) + '?_preview=true' + '&amp;standalone=1&amp;reportId=' + [/ignored/@displayUrlId] + '&amp;_uuid=' + [/ignored/@displayUrlUuid] + + '&amp;_reportLabel=' +UrlUtf8Encode(@label)+  +'&amp;_lastModified=' + @lastModified + '&amp;_context=' + Iif([/ignored/@context] = 'selection', 'selection|' + @internalName + '&amp;_selection=' + [/ignored/@selection]+'&amp;_selectionCount=1','global|'+ @internalName) + '&amp;lang=' + [/ignored/@lang] + iif([/ignored/@debug], '&amp;_debug','')" type="expr" xpath="/ignored/@displayUrl"/>
          <input alwaysActive="true" expr="[/ignored/@selection] != '' or [/ignored/@context] = 'global'" type="expr" xpath="/ignored/@navigable"/>
        </container>
        <container applicableIf="$(contextSchema)='nms:webApp'">
          <container type="visibleGroup" visibleIf="[/ignored/@hasPurl]">
            <input computeStringAlias="@_cs" createMode="none" label="pURL" schema="nms:purl" type="linkEdit" xpath="/ignored/@purlId">
              <sysFilter>
                <condition expr="[@webApp-id] = $(@id)"/>
              </sysFilter>
            </input>
          </container>
          <input alwaysActive="true" expr="getOption('NmsServer_URL') + '/' +  extractRight($(contextSchema), ':') + '/' + @internalName + '?_uuid=' + @uuid + '&amp;_preview=true&amp;_lastModified=' + @lastModified + iif([/ignored/@hasPurl], '&amp;purlId='+[/ignored/@purlId],'') + iif([/ignored/@debug], '&amp;_debug','') + iif([/ignored/object/@id] != '' and [/ignored/object/@id]!=0, '&amp;id=' + AESEncrypt([/ignored/object/@id]), '')+'&amp;lang='+[/ignored/@lang]" type="expr" xpath="/ignored/@displayUrl"/>
          <input alwaysActive="true" expr="[/ignored/@hasPurl] = false or ([/ignored/@purlId] != '' and [/ignored/@purlId] != 0)" type="expr" xpath="/ignored/@purlOk"/>
          <input alwaysActive="true" expr="(NodeCount([activities/prefill])=0 or [activities/prefill/@skipIfNoId] = true) or [/ignored/object/@id] != '' or NodeCount([activities/prefill])>1 or [/ignored/@hasSocial]" type="expr" xpath="/ignored/@preloadOk"/>
          <input alwaysActive="true" expr="[/ignored/@purlOk] and [/ignored/@preloadOk]" type="expr" xpath="/ignored/@navigable"/>
        </container>
        <container applicableIf="$(contextSchema)='crm:landingPage'">
          <input alwaysActive="true" expr="GetOption('NmsServer_URL') + '/webApp/' +  [renderApp/@internalName] + '?_uuid=' + [renderApp/@uuid] + '&amp;lpid=' + @id + Iif([/ignored/recipient/@id]!=0, '&amp;rcpid=' + [/ignored/recipient/@id], '') + '&amp;lang=' + @language + '&amp;_preview=true' + '&amp;_lastModified=' + [renderApp/@lastModified] + Iif([/ignored/@debug], '&amp;_debug','')" type="expr" xpath="/ignored/@displayUrl"/>
          <input alwaysActive="true" expr="GetOption('NmsServer_URL') + '/webApp/' +  [renderApp/@internalName] + '?p=' + UrlEncode(AESEncrypt('lp=' + @name + Iif([/ignored/recipient/@id]!=0, '&amp;rcpid=' + [/ignored/recipient/@id], ''))) + '&amp;lang=' + @language" type="expr" xpath="/ignored/@displayExternalUrl"/>
        </container>
        <container>
          <input colspan="3" img="xtk:form/link.png" label="URL" type="edit" xpath="/ignored/@displayUrl"/>
          <container applicableIf="$(contextSchema)='crm:landingPage'" colspan="3">
            <input createMode="none" label="Pre-fill with" schema="nms:recipient" type="linkedit" xpath="/ignored/recipient/@id"/>
            <static type="separator"/>
            <input forceNavigate="true" sessionToken="true" type="urlViewer" urlExpr="[/ignored/@displayUrl]"/>
            <static label="External URL" type="separator"/>
            <input img="xtk:form/link.png" nolabel="true" readOnly="true" type="edit" xpath="/ignored/@displayExternalUrl"/>
          </container>
          <container colcount="3">
            <container applicableIf="$(contextSchema)='nms:webApp'" enabledIf="NodeCount([activities/prefill])&lt;=1 and [/ignored/@hasSocial] = false" type="enabledGroup">
              <container type="visibleGroup" visibleIf="[/ignored/@hasLead]=false">
                <input createMode="none" label="Profile" type="linkedit" xpath="/ignored/object/@id" xpathSchema="@schema"/>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/@hasLead]">
                <input createMode="none" label="Recipient" schema="nms:recipient" type="linkedit" xpath="/ignored/object/@id"/>
              </container>
            </container>
            <container applicableIf="$(contextSchema)!='crm:landingPage'">
              <input enumXPath="/ignored/langs" label="Language" type="DynEnumCombo" xpath="/ignored/@lang"/>
            </container>
            <input label="Enable debug mode" type="checkbox" xpath="/ignored/@debug"/>
          </container>
          <container applicableIf="$(contextSchema)!='crm:landingPage'" colspan="3" type="visibleGroup" visibleIf="[/ignored/@navigable]">
            <input forceNavigate="true" nolabel="true" sessionToken="true" type="urlViewer" urlExpr="Iif([/ignored/@navigable], [/ignored/@displayUrl], '')"/>
          </container>
          <container applicableIf="$(contextSchema)='nms:webApp'" backcolor="tooltip" colspan="3" padding="10" type="visibleGroup" visibleIf="[/ignored/@navigable] = false">
            <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@purlOk] = false">
              <static fontBold="true" img="xtk:logwarn.png">For the preview to work, you need to select a pURL.</static>
            </container>
            <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@preloadOk] = false">
              <static fontBold="true" img="xtk:logwarn.png">Pre-loading is mandatory, you need to select a profile for the preview to work.</static>
            </container>
          </container>
          <container applicableIf="$(contextSchema)='xtk:report'" backcolor="tooltip" colspan="3" padding="10" type="visibleGroup" visibleIf="[/ignored/@navigable] = false">
            <input img="xtk:logwarn.png" type="label" xpath="/ignored/@selectionHelper"/>
          </container>
        </container>
      </container>
      <container label="Translations" name="translations">
        <input applicableIf="$(contextSchema)='nms:webApp'" img="xtk:refresh.png" label="Collect the strings to translate" name="dictionaryCheckButton" type="urlButton">
          <enter onSuccess="String collection was successful" refresh="true">
            <saveView/>
            <set expr="'@id = ' + @id" xpath="/tmp/where/condition/@expr"/>
            <soapCall name="DictionaryCheck" service="nms:webApp">
              <param exprIn="/tmp/where" type="DOMElement"/>
              <param type="DOMElement" xpathOut="/ignored/translationStats"/>
            </soapCall>
          </enter>
        </input>
        <input applicableIf="$(contextSchema)='xtk:report'" img="xtk:refresh.png" label="Collect the strings to translate" name="dictionaryCheckButton" type="urlButton">
          <enter onSuccess="String collection was successful" refresh="true">
            <saveView/>
            <set expr="'@id = ' + @id" xpath="/tmp/where/condition/@expr"/>
            <soapCall name="DictionaryCheck" service="xtk:report">
              <param exprIn="/tmp/where" type="DOMElement"/>
              <param type="DOMElement" xpathOut="/ignored/translationStats"/>
            </soapCall>
          </enter>
        </input>
        <container colcount="2" type="visibleGroup" visibleIf="[/ignored/translationStats/warnings] != ''">
          <static img="xtk:logwarn.png" type="image"/>
          <value lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/ignored/translationStats/warnings"/>
        </container>
        <container colcount="2" type="visibleGroup" visibleIf="[/ignored/@translationNb] > 9999">
          <static label="In case of deletion of this web application, only the 10 000 first strings will be kept in the translation memory." type="warning"/>
        </container>
        <input enumImage="@status" form="xtk:dictionary" hideEditButtons="true" nolabel="true" type="linkList" xpath="strings" xpathOutNbLines="/ignored/@translationNb" xpathRefresh="/ignored/translationStats" zoom="true">
          <input xpath="@status"/>
          <input xpath="@locale"/>
          <input xpath="@sourceId"/>
          <input label="Source string" xpath="sourceString/@text"/>
          <input xpath="@text"/>
          <orderBy>
            <node expr="@sourceId"/>
          </orderBy>
          <sysFilter>
            <condition expr="@isSource = false"/>
          </sysFilter>
        </input>
      </container>
      <container colcount="2" name="multipleChoiceValidation" propagateConstraints="false" type="visibleGroup" visibleIf="@multipleChoice=true">
        <input label="Approval" type="separator"/>
        <input label="Approval messages" type="separator"/>
        <container colcount="2" width="50%">
          <input nolabel="true" width="6" xpath="@minsel"/>
          <static label="selections required"/>
        </container>
        <input label="Personalize the message..." prebuildSubForm="false" type="SubformLink" xpath=".">
          <form label="Message personalization">
            <static label="Error message displayed when there are too few selections." type="help"/>
            <input nolabel="true" xpath="minselLog"/>
          </form>
        </input>
        <container colcount="2">
          <input nolabel="true" width="6" xpath="@maxsel"/>
          <static label="selections allowed"/>
        </container>
        <input label="Personalize the message..." prebuildSubForm="false" type="SubformLink" xpath=".">
          <form label="Message personalization">
            <static label="Error message displayed when there are too many selections." type="help"/>
            <input nolabel="true" xpath="maxselLog"/>
          </form>
        </input>
      </container>
      <container colcount="3" label="Value" name="styleValue">
        <input colspan="3" label="Format" type="separator"/>
        <input colspan="3" xpath="@format"/>
        <container colspan="3" type="visibleGroup" visibleIf="@format='number' or @format='percentage' or @format='currency'">
          <input noTransaction="true" width="2" xpath="@decimalPlaces"/>
          <input xpath="@negativeNumberRed"/>
        </container>
        <container colspan="3" type="visibleGroup" visibleIf="@format='number' or @format='currency'">
          <input label="Use thousand separators" xpath="@use1000Sep"/>
        </container>
        <container colspan="3" type="visibleGroup" visibleIf="@format='currency'">
          <input xpath="@currency"/>
        </container>
        <container colspan="3" type="visibleGroup" visibleIf="@format='date'">
          <input label="Display time" xpath="@useTime"/>
        </container>
        <container colspan="3" type="visibleGroup" visibleIf="@format='date' or @format='time'">
          <container type="visibleGroup" visibleIf="@format='time' or @useTime=true">
            <input label="Display seconds" xpath="@useSec"/>
          </container>
        </container>
        <container colspan="3" type="visibleGroup" visibleIf="@format='enum'">
          <input colspan="3" xpath="@enumFormat"/>
        </container>
        <input colspan="3" label="Text align" type="separator"/>
        <input colspan="3" label="Horizontal" xpath="@alignment"/>
        <input colspan="3" label="Vertical" xpath="@verticalAlignment"/>
        <input colspan="3" xpath="@wrapText"/>
        <input colspan="3" label="Font" type="separator"/>
        <container colcount="3" colspan="3">
          <input xpath="font/@font"/>
          <input xpath="font/@style"/>
          <input noTransaction="true" width="4" xpath="font/@size"/>
          <input xpath="font/@underline"/>
          <input xpath="font/@color"/>
          <static/>
          <input xpath="font/@strikethrough"/>
        </container>
      </container>
      <container label="Extra" name="styleExtra">
        <input xpath="@visual"/>
        <container type="visibleGroup" visibleIf="@visual='rating'">
          <input xpath="@ratingMax"/>
        </container>
        <container type="visibleGroup" visibleIf="@visual!='' and @visual!='none' and @visual!='color'">
          <input xpath="@hideValue"/>
        </container>
      </container>
      <container colspan="2" name="htmlBlock" style="flat" type="notebook">
        <container addSchemaMenuXPath="$(entityPath)/@schema" isE4X="true" menuId="webAppMenuBuilder" prefix="ctx." type="customMenuBuilder"/>
        <container addSchemaMenu="nms:recipient" applicableIf="HasPackage('crm:lead')" isE4X="true" menuId="webAppMenuBuilderLead" prefix="ctx.vars." type="customMenuBuilder"/>
        <container label="Content" visibleIf="[/ignored/@hasLead]=false">
          <input nolabel="true" type="dhtml" xpath="source" xpathInsert="/ignored/customizeBtnOut">
            <container>
              <input menuId="webAppMenuBuilder" options="html" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
            </container>
          </input>
        </container>
        <container applicableIf="HasPackage('crm:lead')" label="Content" visibleIf="[/ignored/@hasLead]=true">
          <input nolabel="true" type="dhtml" xpath="source" xpathInsert="/ignored/customizeBtnOut">
            <container>
              <input menuId="webAppMenuBuilderLead" options="html" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
            </container>
          </input>
        </container>
        <container label="Texts">
          <input editable="true" nolabel="true" type="list" xpath="strings/string">
            <input xpath="@id"/>
            <input label="Text" xpath="@value"/>
          </input>
          <static type="help">Text created here can be used in the HTML by using the following syntax &lt;%= $(IDENTIFIANT) %&gt;.</static>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:fusion32.png" label="Entities merge wizard" md5="742C115106D091ED529A5FB883B47455" name="fusion" namespace="xtk" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="1" xpath="/@priority"/>
        <soapCall name="PrepareFusion" service="xtk:fusion">
          <param exprIn="[/@xtkschema]" type="string"/>
          <param exprIn="[/@priority]" type="boolean"/>
          <param exprIn="[/selection]" type="DOMElement" xpathOut="."/>
        </soapCall>
      </enter>
      <container colcount="2" desc="Please modify the contents of the 'Result' column in the list of conflicts and in the list of other fields, and start merge from source 1 to source 2." title="Merge selected lines">
        <static label="Source 1:"/>
        <value fontBold="true" nolabel="true" xpath="source/@_cs"/>
        <static label="Source 2:"/>
        <value fontBold="true" nolabel="true" xpath="destination/@_cs"/>
        <input colspan="2" editable="false" img="xtk:msgwarn.png" label="List of conflicts" noEditCollection="true" noToolbar="true" type="conflictList" xpath="conflict">
          <input xpath="@label"/>
          <input xpath="@source1"/>
          <input xpath="@source2"/>
          <input editable="true" xpath="@destination"/>
        </input>
        <static label="In case of conflict, by default use value from:"/>
        <container colcount="3">
          <input checkedValue="0" label="Source 1" nolabel="true" type="radioButton" xpath="/@priority"/>
          <input checkedValue="1" label="Source 2" nolabel="true" type="radioButton" xpath="/@priority"/>
          <input img="xtk:runtask.png" label="Compute" name="process" type="flatButton">
            <enter>
              <soapCall name="PrepareFusion" service="xtk:fusion">
                <param exprIn="[/@xtkschema]" type="string"/>
                <param exprIn="[/@priority]" type="boolean"/>
                <param exprIn="[/selection]" type="DOMElement" xpathOut="/fusion"/>
              </soapCall>
            </enter>
          </input>
        </container>
        <static colspan="2"/>
        <input colspan="2" editable="false" img="xtk:comment.png" label="Other fields" noEditCollection="true" noToolbar="true" type="conflictList" xpath="other">
          <input xpath="@label"/>
          <input xpath="@source1"/>
          <input xpath="@source2"/>
          <input editable="true" xpath="@destination"/>
        </input>
        <static colspan="2" label=" "/>
        <static colspan="2" label="Press 'Finish' to start merge." type="help"/>
        <leave>
          <soapCall name="ProcessFusion" service="xtk:fusion">
            <param exprIn="[/@xtkschema]" type="string"/>
            <param exprIn="[/fusion]" type="DOMElement"/>
          </soapCall>
        </leave>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:specFile" entitySchema="xtk:form" img="xtk:form.png" label="Generate the package" md5="16B3D82C6F4EDF91DC01410E07EF12CB" name="generatePackage" namespace="xtk" nothingToEdit="true" nothingToSave="true" xpathsToLoad="*,definition/**" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
        <set expr="@namespace+ '-' + @name + '.xml'" xpath="/tmp/@filename"/>
      </enter>
      <value label="Package" required="false" xpath="@label"/>
      <input dlgType="save" label="File" type="fileedit" xpath="/tmp/@filename"/>
      <container name="generate" refreshPeriod="500" type="packageGenerator" xpathDestName="/tmp/@filename" xpathProperties="/properties">
        <soapCall name="Generate" service="xtk:specFile">
          <param exprIn="/" type="DOMElement"/>
        </soapCall>
        <input name="JobLogsList" type="JobLogList"/>
        <container colcount="2">
          <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
          <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
        </container>
        <container colcount="2">
          <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
          <container enabledIf="[/tmp/@filename] != ''" type="enabledGroup">
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Access groups" md5="7DF25E4F189FA86E66A5C165B64A113F" name="group" namespace="xtk" type="iconbox" xtkschema="xtk:form">
      <container colcount="2" img="xtk:properties.png" label="General">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input colspan="2" xpath="desc"/>
      </container>
      <container img="xtk:login.png" label="Content">
        <input filterFormChoice="@type != 1" folderFilterChoice="@model in ('xtkOperator', 'xtkNamedRight')" labelFormChoice="Add operators or named rights" nolabel="true" orderFormChoice="@type" toolbarCaption="Operators and named rights" type="rightLinkList" xpath="operatorGroup" xpathChoiceTarget="operator" zoom="false">
          <input label="Operator or named right" xpath="operator"/>
          <input xpath="operator/@type"/>
          <input xpath="operator/desc"/>
        </input>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Image" md5="3BCF9E0D592A14F4A37DF718E2B40D8E" name="image" namespace="xtk" xtkschema="xtk:form">
      <input xpath="@name"/>
      <static label="Preview" type="separator"/>
      <input nolabel="true" toolbarAlign="vertical" type="ImagePreview" xpath="data" xpathName="/image/@name"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:import32.png" label="Data import" md5="DF040B27482042FD97F8DFB28E30C61C" name="import" namespace="xtk" noNewInstance="true" type="wizard" xpathsToLoad="@isModel,@jobType,@form,@editForm,@status,@img,@modelName" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/tmp/@firstPageVisible"/>
        <set value="0" xpath="/tmp/@execFromModel"/>
        <set expr="(@id != 0)" xpath="/tmp/@editingInstance"/>
        <set value="0" xpath="/tmp/@saveAsModel"/>
        <set value="0" xpath="/tmp/processId"/>
        <set value="0" xpath="/tmp/@modelId"/>
        <set value="xtk:dataTransfer" xpath="/tmp/schema/@job"/>
        <set value="xtk:dataTransfer" xpath="@form"/>
        <set value="xtk:import" xpath="@editForm"/>
        <set value="import" xpath="@jobType"/>
        <set value="xtk:dataTransfer" xpath="@xtkschema"/>
        <set value="xtk:import.png" xpath="@img"/>
        <set value="select" xpath="/tmp/@choiceType"/>
        <set value="0" xpath="/tmp/@newFromWebApp"/>
      </enter>
      <container name="hidden" type="visibleGroup" visibleIf="false">
        <container name="advancedParameters" type="notebook">
          <container label="General" propagateConstraints="false">
            <input xpath="@stopIfTooManyRejects"/>
            <input xpath="@traceMode"/>
            <input xpath="@outOfProcess"/>
            <input xpath="@noUpdateEnum"/>
            <static type="separator"/>
            <input xpath="@timezone"/>
          </container>
          <container label="Variables" name="variables" propagateConstraints="false" xpath="variables" xpathsToLoad="variables/*">
            <static type="help">Variables are used to define parameters specific to a job instance. These variables are accessible from the query editors and from calculated fields.</static>
            <input editable="false" nolabel="true" prebuildSubForm="false" type="list" xpath="var" zoom="true" zoomOnAdd="true">
              <input editable="true" xpath="@name"/>
              <input editable="true" xpath="desc"/>
              <input editable="true" xpath="@required"/>
              <input xpath="@dataType"/>
              <input xpath="@stringValue"/>
              <form label="Definition of a job variable">
                <input xpath="@name"/>
                <input xpath="@required"/>
                <input xpath="desc"/>
                <input xpath="@dataType"/>
                <container type="visibleGroup" visibleIf="!@calculated">
                  <container ref="xtk:option:editVariantValue"/>
                </container>
                <container type="visibleGroup" visibleIf="@calculated">
                  <input nolabel="false" type="pathEdit" xpath="expr" xpathChoiceType="/tmp/@choiceType" xpathSchema="/tmp/schema/@job"/>
                </container>
                <input xpath="@calculated"/>
              </form>
            </input>
          </container>
        </container>
      </container>
      <container desc="The import can be based on parameters previously saved as an import template. Please select the default template to start a brand new import." name="script" title="Template selection" visibleIf="([/tmp/processId] != 0 or [/tmp/@newFromWebApp] = 1 or [/tmp/@firstPageVisible]) and  [/tmp/@saveAsModel] == false and [/tmp/@execFromModel] == false">
        <enter>
          <set value="1" xpath="/tmp/@firstPageVisible"/>
        </enter>
        <container type="visibleGroup" visibleIf="[/tmp/processId] != 0 or [/tmp/@newFromWebApp] = 1 or ([/tmp/@execFromModel] == false and [/tmp/@editingInstance] == false)">
          <static img="nms:circle-one.png">Select an import template</static>
          <input boldLineExpr="@builtIn = 1" choiceButton="true" createMode="none" defaultModel="newImport" folderFilterChoice="@model = 'xtkJobModel'" form="xtk:import" fullLoad="true" img="xtk:import.png" label="Import template" newFromModelOnChange="true" noZoom="true" schema="xtk:job" type="linkEdit" xpath="/tmp/@model">
            <sysFilter>
              <condition expr="@isModel = 1 and @jobType = 'import'"/>
            </sysFilter>
            <orderBy>
              <node expr="@builtIn" sortDesc="true"/>
              <node expr="@label"/>
            </orderBy>
          </input>
        </container>
        <container enabledIf="[/tmp/@modelId] != 0 or [/tmp/@execFromModel] or ([/tmp/@editingInstance] and [/tmp/processId] = 0)" name="enbl" type="enabledGroup">
          <container type="visibleGroup" visibleIf="[/tmp/processId] != 0 or ([/tmp/@execFromModel] == false and [/tmp/@editingInstance] == false)">
            <static img="nms:circle-two.png">Complete or modify parameters</static>
          </container>
          <input xpath="@label"/>
          <input xpath="desc"/>
          <input xpath="@importType"/>
          <static label=" " nolabel="false" type="help">A simple import allows you to import data from a single source file. To import data from multiple source files, select multiple import.</static>
          <container type="visibleGroup" visibleIf="@isModel">
            <input xpath="@internalName"/>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/processId] = 0">
            <input img="xtk:job.png" label="Folder" writeAccess="true" xpath="folder">
              <sysFilter>
                <condition expr="@model = 'xtkJobInstance'"/>
              </sysFilter>
            </input>
          </container>
          <input img="xtk:properties.png" label="Advanced parameters..." name="advanced" nolabel="true" type="subFormLink">
            <form label="Advanced parameters" name="advancedForm">
              <container ref="xtk:import:hidden/advancedParameters"/>
            </form>
          </input>
        </container>
        <leave>
          <check expr="([/tmp/@editingInstance] and [/tmp/processId] = 0) or [/tmp/@execFromModel] = 1 or ([/tmp/@execFromModel] = 0 and [/tmp/@modelId] != 0)">
            <error>You must specify an import template.</error>
          </check>
          <if expr="[/tmp/processId] != 0">
            <set expr="[/tmp/processId]" xpath="@folder-id"/>
            <set value="0" xpath="@folderProcess-id"/>
          </if>
          <check expr="[@folder-id] != 0">
            <error>You must specify an execution folder.</error>
          </check>
        </leave>
      </container>
      <container desc="Please specify the import description, type and the folder where information about its execution is saved." name="general" title="Import definition" visibleIf="[/tmp/@firstPageVisible]=0">
        <container name="warningBuiltIn" type="visibleGroup" visibleIf="@builtIn and @isModel">
          <static type="warning">Warning: You are about to modify a factory-configured template, which may stop it from functioning correctly.</static>
        </container>
        <input xpath="@label"/>
        <input xpath="desc"/>
        <input xpath="@importType"/>
        <static label=" " nolabel="false" type="help">A simple import allows you to import data from a single source file. To import data from multiple source files, select multiple import.</static>
        <container type="visibleGroup" visibleIf="@isModel">
          <input xpath="@internalName"/>
        </container>
        <container type="visibleGroup" visibleIf="![/tmp/@saveAsModel] and [/tmp/@execFromModel]">
          <input img="xtk:job.png" label="Folder" xpath="folder">
            <sysFilter>
              <condition expr="@model = 'xtkJobInstance'"/>
            </sysFilter>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="![/tmp/@saveAsModel] and @isModel">
          <input label="Folder" xpath="folderProcess">
            <sysFilter>
              <condition expr="@model = 'xtkJobInstance'"/>
            </sysFilter>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="[/tmp/@saveAsModel]">
          <input label="Folder" setDefault="true" xpath="folder">
            <sysFilter>
              <condition expr="@model = 'xtkJobModel'"/>
            </sysFilter>
          </input>
        </container>
        <input img="xtk:properties.png" label="Advanced parameters..." nolabel="true" type="subFormLink">
          <form label="Advanced parameters" name="advancedForm">
            <container ref="xtk:import:hidden/advancedParameters"/>
          </form>
        </input>
        <leave>
          <check expr="(@isModel=false and [/tmp/@execFromModel]=false) or [/tmp/@saveAsModel] or ([/tmp/@saveAsModel]=false and @isModel and [@folderProcess-id]!=0) or ([/tmp/@saveAsModel]=false and [/tmp/@execFromModel] and [@folder-id]!=0)">
            <error>You must specify an execution folder.</error>
          </check>
        </leave>
      </container>
      <container desc="Please edit the list of import steps." name="batch" title="Import steps" visibleIf="@importType = 'batch'">
        <input editable="false" form="xtk:importSource" img="xtk:script.png" nolabel="true" toolbarAlign="vertical" type="list" xpath="dataTransferStep" zoom="true" zoomOnAdd="true">
          <input xpath="@name"/>
          <input editable="true" xpath="@active"/>
          <input editable="true" xpath="@origin"/>
        </input>
      </container>
      <container ref="xtk:importSource:sourceInfos" visibleIf="@importType = 'simple'" xpath="dataTransferStep[1]">
        <enter>
          <set value="1" xpath="/tmp/@genericImport"/>
        </enter>
      </container>
      <container ref="xtk:importSource:mappingInfos" visibleIf="@importType = 'simple'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:importSource:reconciliationInfos" visibleIf="@importType = 'simple'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:importSource:group" visibleIf="@importType = 'simple' and [/tmp/@schema] == 'nms:recipient'" xpath="dataTransferStep[1]"/>
      <container ref="xtk:importSource:sqlScript" visibleIf="@importType = 'simple' and [/tmp/@sqlScript]" xpath="dataTransferStep[1]"/>
      <container desc="Click on 'Start' to launch the import of the data." name="finish" title="Data import execution" visibleIf="!@isModel">
        <container methodName="Start" type="dataTransferSubmitContainer" xpathCurProgress="properties/progress/@current" xpathMaxProgress="properties/progress/@max" xpathSourceName="dataTransferStep/source/@remoteSourceName">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2" xpath="properties/counters">
            <value xpath="@processed"/>
            <value xpath="@rejected"/>
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:import32.png" label="Resume data import" md5="9F562593FDBE850FEEAFACD5847A9FB6" name="importRetry" namespace="xtk" type="wizard" xpathsToLoad="*,folder/@id,folder/@fullName,folderProcess/@id,folderProcess/@fullName" xtkschema="xtk:form">
      <container desc="Click on start to resume the import." name="finish" title="Resume import">
        <container methodName="Start" type="dataTransferSubmitContainer" xpathCurProgress="properties/progress/@current" xpathMaxProgress="properties/progress/@max" xpathSourceName="dataTransferStep/source/@remoteSourceName">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2" xpath="properties/counters">
            <value xpath="@processed"/>
            <value xpath="@rejected"/>
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Resume" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:import32.png" label="Data transfer" md5="88A090A63808D34BF1684D4771085CEC" name="importSource" namespace="xtk" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="1" xpath="/tmp/@genericImport"/>
      </enter>
      <container desc="Please select source file." name="sourceInfos" title="File to import" xpathsToLoad="source/@type,destination/@type">
        <enter>
          <set value="text" xpath="source/@type"/>
          <set value="xtkDataStore" xpath="destination/@type"/>
          <if expr="[destination/@schema]=='' AND HasPackage('crm:lead')=false">
            <set value="nms:recipient" xpath="destination/@schema"/>
          </if>
          <if expr="[source/dataSourceConfig/@colType]==''">
            <set value="0" xpath="source/dataSourceConfig/@colType"/>
          </if>
          <set expr="FileUploaded([source/name], [source/@md5])" xpath="/ignored/file/@uploadStatus"/>
          <set value="1" xpath="/ignored/resource/@notInResTable"/>
          <set value="" xpath="source/calculatedFields"/>
          <set value="" xpath="source/mappingConfig"/>
        </enter>
        <container type="visibleGroup" visibleIf="false">
          <input xpath="source/@type"/>
          <input xpath="destination/@type"/>
        </container>
        <container colcount="2" name="autoDetect" type="importAutoDetectContainer" xpath="source/dataSourceConfig" xpathAutoDetect="../name" xpathLastParsed="../@lastParsedDataSource" xpathUploadFile="../@upload">
          <container colcount="2" colspan="2" name="file" xpath="..">
            <container colspan="2" type="visibleGroup" visibleIf="EV([../../@importType], 'batch')">
              <input label="Step name" xpath="../@name"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@upload">
              <input filters="Text, CSV or XML files (*.txt;*.csv;*.tab;*.xml)|*.txt;*.csv;*.tab;*.xml|All (*.*)|*.*|" label="Local file" type="fileEdit" xpath="name" xpathCopyName="../@name" xpathType="@format"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@upload == false">
              <input label="Server file" xpath="name" xpathCopyName="../@name"/>
            </container>
            <container colcount="2" colspan="2" name="upload">
              <input alwaysActive="true" expr="FileUploaded(name, @md5)" type="expr" xpath="/ignored/file/@uploadStatus"/>
              <input label=" " useDesc="true" xpath="@upload"/>
              <container type="visibleGroup" visibleIf="@upload">
                <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == -1">
                  <static img="xtk:logwarn.png" label=" " nolabel="false">The file no longer exists on the local disk and has not been uploaded</static>
                </container>
                <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 0">
                  <static img="xtk:loginfo.png" label=" " nolabel="false">The local file has not been uploaded on the server</static>
                </container>
                <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 1">
                  <static img="xtk:logwarn.png" label=" " nolabel="false">The local file is not equal to the one on the server</static>
                </container>
                <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 2">
                  <static img="xtk:xtkcheck.png" label=" " nolabel="false">File exists on server, but not on the local disk</static>
                </container>
                <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 3">
                  <static img="xtk:xtkcheck.png" label=" " nolabel="false">File already exists on server</static>
                </container>
              </container>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@upload">
                <input img="xtk:upload.png" label="Update on server..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Updating file on server">
                    <enter>
                      <set value="" xpath="/ignored/@performedUpload"/>
                      <set expr="name" xpath="/ignored/resource/@fileName"/>
                      <set expr="@md5==''" xpath="/ignored/resource/@md5Empty"/>
                    </enter>
                    <input label="File" required="true" type="fileEdit" xpath="/ignored/resource/@fileName"/>
                    <static type="help">Click on 'Upload' to start the file transfer to the server.</static>
                    <container exprTransferType="true" keyIsMd5="true" methodName="NONE" type="resourceTransferContainer" xpathFile="/ignored/resource/@fileName" xpathNotResTable="/ignored/resource/@notInResTable" xpathOutList="@md5,/ignored/@performedUpload">
                      <input name="JobLogsList" type="JobLogList"/>
                      <container colcount="2">
                        <value dataType="timespan" label="Elapsed" xpath="/tmp/execution/@elapsed"/>
                        <value dataType="timespan" label="Estimated left" xpath="/tmp/execution/@remaining"/>
                      </container>
                      <container colcount="2" enabledIf="[/ignored/@performedUpload] == ''" type="enabledGroup">
                        <value name="JobProgressBar" type="ProgressBar" valign="center" xpathElapsed="/tmp/timing/@elapsed" xpathRemaining="/tmp/timing/@remaining"/>
                        <input enabledIf="[/ignored/resource/@fileName]!= '' " img="xtk:upload.png" label="&amp;Transfer" name="JobSubmitButton" type="flatbutton"/>
                      </container>
                    </container>
                  </form>
                </input>
                <container enabledIf="[/ignored/file/@uploadStatus] > 0" type="enabledGroup">
                  <input discardReadOnly="true" filename="name" form="xtk:fileResDownload" img="xtk:download.png" label="Download..." nolabel="true" prebuildSubForm="false" type="fileLink" xpath="."/>
                </container>
              </container>
            </container>
            <input img="xtk:refresh.png" label="Auto-Detect format" name="autoDetectBtn1" nolabel="false" type="urlButton"/>
            <container name="format" type="visibleGroup" visibleIf="@format != 'xml'">
              <input img="xtk:fileEdit.png" label="Click here to change the file format..." nolabel="false" type="subFormLink" xpath=".">
                <form colcount="2" label="File format">
                  <input colspan="2" xpath="dataSourceConfig/@colType"/>
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@format=='text'">
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[dataSourceConfig/@colType]==1">
                      <container colcount="2" colspan="2" xpath="dataSourceConfig">
                        <input xpath="@codepage"/>
                        <input xpath="@ignoredChar"/>
                      </container>
                    </container>
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[dataSourceConfig/@colType]==0">
                      <container colcount="2" colspan="2" xpath="dataSourceConfig">
                        <input xpath="@codepage"/>
                        <input xpath="@ignoredLines"/>
                      </container>
                      <input colspan="2" nolabel="true" xpath="dataSourceConfig/@firstLineIsTitle"/>
                      <input colspan="2" nolabel="true" xpath="dataSourceConfig/@multiline"/>
                      <input xpath="dataSourceConfig/@textQualifier"/>
                      <static/>
                      <static colspan="2" label="Column separator" type="separator"/>
                      <container colcount="5" colspan="2" xpath="dataSourceConfig">
                        <input xpath="@tabIsSep"/>
                        <input xpath="@spaceIsSep"/>
                        <input xpath="@semiColumnIsSep"/>
                        <input xpath="@commaIsSep"/>
                        <input xpath="@otherSep"/>
                        <input colspan="5" xpath="@consecutiveDelimiters"/>
                      </container>
                    </container>
                  </container>
                  <static colcount="2" colspan="2" label="Columns" type="separator"/>
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@format=='text'">
                    <container type="visibleGroup" visibleIf="[dataSourceConfig/@colType]==0">
                      <input columnIndex="true" editable="false" img="xtk:text.png" noToolbar="true" nolabel="true" notitle="true" type="list" xpath="dataSourceConfig/dataSourceColumn" xpathIndex="/tmp/columns/@current">
                        <input xpath="@label"/>
                      </input>
                    </container>
                    <container type="visibleGroup" visibleIf="[dataSourceConfig/@colType]==1">
                      <input columnIndex="true" editable="true" img="xtk:text.png" noToolbar="false" nolabel="true" notitle="false" ordered="false" type="list" xpath="dataSourceConfig/dataSourceColumn" xpathIndex="/tmp/columns/@current">
                        <input xpath="@label"/>
                        <input xpath="@width"/>
                      </input>
                    </container>
                    <container type="collectionItemGroup" xpath="dataSourceConfig/dataSourceColumn" xpathIndex="/tmp/columns/@current">
                      <input xpath="@label"/>
                      <input xpath="@type"/>
                      <container type="visibleGroup" visibleIf="@type=='date'">
                        <input xpath="@dateFormat"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@type=='time'">
                        <input xpath="@timeFormat"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@type=='datetime'">
                        <input label="Date format" xpath="@dateFormat"/>
                        <input label="Time format" xpath="@timeFormat"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@type=='double'">
                        <input xpath="@numFormat"/>
                      </container>
                      <input xpath="@ignore"/>
                    </container>
                  </container>
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@format=='xml'">
                    <input type="SchemaDataSourceColumn" xpath="dataSourceConfig" xpathIndex="/tmp/columns/@current"/>
                    <container type="collectionItemGroup" xpath="dataSourceConfig/dataSourceColumn" xpathIndex="/tmp/columns/@current">
                      <value xpath="@label"/>
                      <value xpath="@name"/>
                      /&gt;
                      <input xpath="@type"/>
                      <container type="visibleGroup" visibleIf="@type=='date'">
                        <input xpath="@dateFormat"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@type=='time'">
                        <input xpath="@timeFormat"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@type=='datetime'">
                        <input label="Date format" xpath="@dateFormat"/>
                        <input label="Time format" xpath="@timeFormat"/>
                      </container>
                      <container type="visibleGroup" visibleIf="@type=='float'">
                        <input xpath="@numFormat"/>
                      </container>
                    </container>
                  </container>
                  <static colspan="2" label="Preview" type="separator"/>
                  <input colspan="2" name="PreviewList" type="fileParsingPreviewList" xpath="dataSourceConfig" xpathIndex="/tmp/columns/@current"/>
                </form>
              </input>
            </container>
          </container>
          <container colcount="2" colspan="2" name="advanced">
            <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath="../../destination">
              <form label="Advanced parameters" maxLabelWidth="60">
                <container type="notebook">
                  <container label="Filtering" propagateConstraints="false">
                    <static label="These options are used to select which lines to import from the source file." type="help"/>
                    <container colcount="2" type="visibleGroup" visibleIf="[../source/@format] != 'xml'">
                      <input xpath="@startRecord"/>
                      <input xpath="@endRecord"/>
                    </container>
                    <container colcount="2" type="visibleGroup" visibleIf="[../source/@format] == 'xml'">
                      <input label="Start with element" xpath="@startRecord"/>
                      <input label="End with element" xpath="@endRecord"/>
                    </container>
                    <static label="Advanced filter" type="separator"/>
                    <input xpath="../source/sourceFilter/@enabled"/>
                    <container type="visibleGroup" visibleIf="[../source/sourceFilter/@enabled]">
                      <container style="flat" type="notebook" xpath="../source/sourceFilter">
                        <container label="Script" propagateConstraints="false">
                          <input nolabel="true" type="jsedit" xpath="srcScript" xpathInsert="/ignored/customizeBtnOut/ins">
                            <container>
                              <input dynamicMenu="true" isJstExpr="false" type="calcFieldMenuBtn" xpathCalcFields="../../calculatedFields" xpathColumns="../../dataSourceConfig" xpathInsert="/ignored/customizeBtnOut/ins"/>
                            </container>
                          </input>
                          <static label="The line of the input file is imported if the JavaScript expression returns 'true'." type="help"/>
                        </container>
                        <container label="Preview">
                          <input name="PreviewList" toolbar="false" type="fileParsingPreviewList" xpath="../dataSourceConfig" xpathAutoDetect="../name" xpathCalcFieldLogs="/tmp/calcFieldPreview/currentLine" xpathCalcFieldResult="/tmp/calcFieldPreview"/>
                          <input editable="false" img="xtk:logerr.png" noToolbar="true" nolabel="true" type="list" xpath="/tmp/calcFieldPreview/currentLine/log">
                            <input label="Logs generated when evaluating the filter" xpath="@message"/>
                          </input>
                        </container>
                      </container>
                    </container>
                  </container>
                  <container label="Others" propagateConstraints="false">
                    <container enabledIf="HasNamedRight('sql')" type="enabledGroup">
                      <input useDesc="true" xpath="../sqlScript/@active"/>
                      <static label="If the execution of SQL scripts is activated, a new page is displayed to edit these scripts." type="help"/>
                    </container>
                    <static type="separator"/>
                    <static label="Frequency at which the progress information is written to the database." type="help"/>
                    <input label="Progression every" xpath="@progressLines"/>
                    <static label="Size of transactions when writing in the database." type="help"/>
                    <input xpath="@transactionLines"/>
                    <input useDesc="true" xpath="../source/dataSourceConfig/@ignoreConfigCheck"/>
                  </container>
                </container>
              </form>
            </input>
            <container type="visibleGroup" visibleIf="[../sourceFilter/@enabled] or [../../destination/@startRecord]!=0 or [../../destination/@endRecord]!=0">
              <static fontBold="true" label="(Filter active)"/>
            </container>
          </container>
          <static colspan="2" img="xtk:preview.png" label="Preview of the first lines of the file" type="separator"/>
          <container colspan="2" xpath=".">
            <input name="fileParsingPreviewList" type="fileParsingPreviewList" xpath="." xpathAutoDetect="../name" xpathIndex="/tmp/columns/@current" xpathLastParsed="../@lastParsedDataSource"/>
          </container>
        </container>
      </container>
      <container desc="Select target schema and associate the fields of the source with the fields of the destination." name="mappingInfos" title="Field mapping">
        <container enabledIf="HasNamedRight('import')" type="enabledGroup">
          <input label="Destination schema" schema="xtk:schema" type="schemaEdit" xpath="destination/@schema" xpathStartPath="destination/@startPath"/>
        </container>
        <container name="mappingList">
          <input alwaysActive="true" expr="[destination/@schema]" type="expr" xpath="/tmp/@schema"/>
          <input alwaysActive="true" expr="[sqlScript/@active]" type="expr" xpath="/tmp/@sqlScript"/>
          <input type="mappingList" xpath="source/mappingConfig" xpathCalcField="source/calculatedFields" xpathColumns="source/dataSourceConfig" xpathSchema="destination/@schema" xpathStartPath="destination/@startPath">
            <form label="Import calculated field definition">
              <container colcount="2">
                <input xpath="@label"/>
                <input label="Internal name" type="ComputeNameEdit" uniqueAlsoInXPath="../../dataSourceConfig/dataSourceColumn" uniqueInParent="true" xpath="@name" xpathRef="@label"/>
              </container>
              <input xpath="@calcFieldType"/>
              <container type="visibleGroup" visibleIf="EV(@calcFieldType, 'constant')">
                <input nolabel="true" type="memo" xpath="srcScript"/>
                <static label="Please specify a text string in the edit box (ex: 'my string')." type="help"/>
              </container>
              <container type="visibleGroup" visibleIf="EV(@calcFieldType, 'enumeration')">
                <container style="flat" type="notebook">
                  <container label="Script" propagateConstraints="false">
                    <input noDefaultValue="true" type="importColumnSelect" xpath="@refPath" xpathCalculatedFields="../../../source/calculatedFields/calculatedField" xpathSource="../../../source/dataSourceConfig/dataSourceColumn"/>
                    <input nolabel="true" toolbarCaption="List of enumeration values" type="list" xpath="enumeration">
                      <input xpath="@source"/>
                      <input xpath="@destination"/>
                    </input>
                    <container colcount="3">
                      <static label="For the other cases:"/>
                      <input checkedValue="update" colspan="2" label="Keep the source value" type="radioButton" xpath="@defaultType"/>
                      <static/>
                      <input checkedValue="value" label="Use the following value:" type="radioButton" xpath="@defaultType"/>
                      <container enabledIf="@defaultType=='value'" type="enabledGroup">
                        <input nolabel="true" xpath="@defaultValue"/>
                      </container>
                      <static/>
                      <input checkedValue="warning" colspan="2" label="Generates a warning" type="radioButton" xpath="@defaultType"/>
                      <static/>
                      <input checkedValue="error" colspan="2" label="Generate an error" type="radioButton" xpath="@defaultType"/>
                      <static/>
                    </container>
                    <static label="Please select the reference source column and set the enumeration values; fields containing source values are transformed with the associated mapped values." type="help"/>
                  </container>
                  <container label="Preview">
                    <static img="xtk:preview.png" label="JavaScript expression preview" type="separator"/>
                    <input name="PreviewList" toolbar="false" type="fileParsingPreviewList" xpath="../../dataSourceConfig" xpathAutoDetect="../../name" xpathCalcFieldLogs="/tmp/calcFieldPreview/currentLine" xpathCalcFieldName="@name" xpathCalcFieldResult="/tmp/calcFieldPreview"/>
                    <input editable="false" img="xtk:logerr.png" noToolbar="true" nolabel="true" type="list" xpath="/tmp/calcFieldPreview/currentLine/log">
                      <input label="Logs during evaluation of the calculated field" xpath="@message"/>
                    </input>
                  </container>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV(@calcFieldType, 'javascript', 'jst')">
                <container style="flat" type="notebook">
                  <container label="Script" propagateConstraints="false">
                    <input nolabel="true" type="jstEdit" xpath="srcScript" xpathInsert="/ignored/customizeBtnOut/ins">
                      <container>
                        <input isJstExpr="EV([../@calcFieldType], 'jst')" type="calcFieldMenuBtn" xpathCalcFields="../.." xpathColumns="../../../dataSourceConfig" xpathInsert="/ignored/customizeBtnOut/ins"/>
                      </container>
                    </input>
                    <static label="You can select the fields associated with the source columns with the toolbar button (e.g.: return source.my_column)." type="help"/>
                  </container>
                  <container label="Preview">
                    <static img="xtk:preview.png" label="JavaScript expression preview" type="separator"/>
                    <input name="PreviewList" toolbar="false" type="fileParsingPreviewList" xpath="../../dataSourceConfig" xpathAutoDetect="../../name" xpathCalcFieldLogs="/tmp/calcFieldPreview/currentLine" xpathCalcFieldName="@name" xpathCalcFieldResult="/tmp/calcFieldPreview"/>
                    <input editable="false" img="xtk:logerr.png" noToolbar="true" nolabel="true" type="list" xpath="/tmp/calcFieldPreview/currentLine/log">
                      <input label="Logs during evaluation of the calculated field" xpath="@message"/>
                    </input>
                  </container>
                </container>
              </container>
            </form>
          </input>
        </container>
        <leave>
          <if expr="HasPackage('crm:lead')">
            <check expr="[destination/@schema]!='nms:recipient' AND [destination/@schema]!='nms:subscription' AND [destination/@schema]!='crm:incomingLead'">
              <error>Please use activity import to import data into this table.</error>
            </check>
          </if>
        </leave>
      </container>
      <container desc="Specify the field or fields which will be used as reconciliation keys to update the database." maxLabelWidth="60" name="reconciliationInfos" title="Reconciliation">
        <enter>
          <if expr="[source/reconciliation/nodeInfo/@updateLog]==''">
            <set value="none" xpath="source/reconciliation/nodeInfo/@updateLog"/>
          </if>
        </enter>
        <input subxpathDisplay="display" subxpathIndex="@current" subxpathKeys="@key" subxpathMaykey="@maybeakey" subxpathSourceField="@sourceField" type="destFieldsTree" xpath="source/reconciliation" xpathMapping="source/mappingConfig" xpathSchema="destination/@schema" xpathStartPath="destination/@startPath" xpathTmp="/tmp/reconciliation"/>
        <static type="separator"/>
        <container colcount="2" type="collectionItemGroup" xpath="source/reconciliation/nodeInfo" xpathIndex="/tmp/reconciliation/@current">
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/reconciliation/display/@sourceField]==1">
            <value colspan="2" label="Reconcile on field " xpath="/tmp/reconciliation/@sourceField"/>
            <input colspan="2" label="In case of error" xpath="@rejectType"/>
            <input label="Update (empty) if source value is empty" nolabel="true" xpath="@emptyValue"/>
            <input label="Update only if destination is empty" nolabel="true" xpath="@nullDestValue"/>
            <static/>
            <input label="Update the field only when the record is inserted" nolabel="true" xpath="@nullInsertOp"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/reconciliation/display/@operation]==1">
            <value colspan="2" label="Reconcile on entity " xpath="/tmp/reconciliation/@sourceField"/>
            <input xpath="@operation"/>
            <container>
              <container enabledIf="[/tmp/reconciliation/display/@rejectEntity]==1" type="enabledGroup">
                <input label="In case of error" xpath="@rejectType"/>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="@operation=='update' or @operation=='delete' or @operation=='none'"/>
            <container type="visibleGroup" visibleIf="@operation=='update' or @operation=='delete' or @operation=='none'">
              <input xpath="@updateLog"/>
            </container>
            <input xpath="@double"/>
            <container enabledIf="@operation=='update' or @operation=='insertOrUpdate'" type="enabledGroup">
              <input xpath="@duplicate"/>
            </container>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/reconciliation/@maybeakey]=='true'">
            <input label="Belongs to reconciliation key #1" nolabel="true" type="checkbox" xpath="/tmp/reconciliation/@key1"/>
            <input label="Belongs to reconciliation key #2" nolabel="true" type="checkbox" xpath="/tmp/reconciliation/@key2"/>
          </container>
        </container>
      </container>
      <container desc="Please select the folder, list, service and origin to use for recipients being imported." name="group" title="Import recipients" visibleIf="[destination/@schema] == 'nms:recipient'" xpathsToLoad="@clearGroup,@useDefaultUserRcpFolder">
        <enter>
          <if expr="@useDefaultUserRcpFolder">
            <set value="0" xpath="@folder-id"/>
            <set value="" xpath="@folder-cs"/>
          </if>
          <if expr="[@group-id] == 0">
            <set value="0" xpath="/tmp/relationEntity/@groupOpt"/>
            <set translatedExpr="'Do not include in a list'" xpath="/tmp/relationEntity/@groupLabel"/>
          </if>
          <if expr="[@group-id] != 0 and [@clearGroup] == 0">
            <set value="1" xpath="/tmp/relationEntity/@groupOpt"/>
            <set translatedExpr="'Add to list \''+[@group-cs]+'\''" xpath="/tmp/relationEntity/@groupLabel"/>
          </if>
          <if expr="[@group-id] != 0 and @clearGroup == 1">
            <set value="2" xpath="/tmp/relationEntity/@groupOpt"/>
            <set translatedExpr="'Recreate list \''+[@group-cs]+'\' (optimized mode, but erase the content of the list before import)'" xpath="/tmp/relationEntity/@groupLabel"/>
          </if>
          <if expr="[@folder-id] == 0 and @useDefaultUserRcpFolder == 0">
            <set value="0" xpath="/tmp/relationEntity/@folderOpt"/>
            <set translatedExpr="'Do not import into a folder'" xpath="/tmp/relationEntity/@folderLabel"/>
          </if>
          <if expr="@useDefaultUserRcpFolder">
            <set value="1" xpath="/tmp/relationEntity/@folderOpt"/>
            <set translatedExpr="'Add in the default folder of the operator'" xpath="/tmp/relationEntity/@folderLabel"/>
          </if>
          <if expr="[@folder-id] != 0 and @useDefaultUserRcpFolder == 0">
            <set value="2" xpath="/tmp/relationEntity/@folderOpt"/>
            <set translatedExpr="'Add in folder \''+[@folder-cs]+'\''" xpath="/tmp/relationEntity/@folderLabel"/>
          </if>
          <if expr="[@service-id] == 0">
            <set value="0" xpath="/tmp/relationEntity/@serviceOpt"/>
            <set translatedExpr="'Do not subscribe to a service'" xpath="/tmp/relationEntity/@serviceLabel"/>
          </if>
          <if expr="[@service-id] != 0">
            <set value="1" xpath="/tmp/relationEntity/@serviceOpt"/>
            <set translatedExpr="'Subscribe to service \''+[@service-cs]+'\''" xpath="/tmp/relationEntity/@serviceLabel"/>
          </if>
        </enter>
        <static img="nms:rcpFolder.png" label="Import into a folder" type="separator"/>
        <container colcount="2">
          <value fontBold="true" margin-left="40" nolabel="true" xpath="/tmp/relationEntity/@folderLabel"/>
          <input label="Edit..." type="subFormLink" xpath=".">
            <form label="Import into a folder">
              <input checkedValue="0" label="Do not import into a specific folder" type="RadioButton" xpath="/tmp/relationEntity/@folderOpt"/>
              <input checkedValue="1" label="Add in the default recipients folder of the operator" type="RadioButton" xpath="/tmp/relationEntity/@folderOpt"/>
              <input checkedValue="2" label="Add to an existing folder" type="RadioButton" xpath="/tmp/relationEntity/@folderOpt"/>
              <container enabledIf="[/tmp/relationEntity/@folderOpt] == 2" type="enabledGroup">
                <input createMode="inline" img="nms:rcpFolder.png" labelFormChoice="Please select a folder" noZoom="true" writeAccess="true" xpath="folder">
                  <sysFilter>
                    <condition expr="@model like 'nmsRecipient%'"/>
                  </sysFilter>
                </input>
              </container>
              <leave>
                <if expr="[/tmp/relationEntity/@folderOpt] != 1">
                  <set value="0" xpath="@useDefaultUserRcpFolder"/>
                </if>
                <if expr="[/tmp/relationEntity/@folderOpt] == 1">
                  <set value="1" xpath="@useDefaultUserRcpFolder"/>
                </if>
                <if expr="[/tmp/relationEntity/@folderOpt] != 2">
                  <set value="0" xpath="@folder-id"/>
                  <set value="" xpath="@folder-cs"/>
                </if>
                <if expr="[@folder-id] == 0 and @useDefaultUserRcpFolder == 0">
                  <set translatedExpr="'Do not import into a specific folder'" xpath="/tmp/relationEntity/@folderLabel"/>
                </if>
                <if expr="[@folder-id] == 0 and @useDefaultUserRcpFolder == 1">
                  <set translatedExpr="'Add in the default folder of the operator'" xpath="/tmp/relationEntity/@folderLabel"/>
                </if>
                <if expr="[@folder-id] != 0 and @useDefaultUserRcpFolder == 0">
                  <set translatedExpr="'Add in folder \''+[@folder-cs]+'\''" xpath="/tmp/relationEntity/@folderLabel"/>
                </if>
                <check expr="([/tmp/relationEntity/@folderOpt] = 2 and [@folder-id] != 0) or @useDefaultUserRcpFolder or [/tmp/relationEntity/@folderOpt] = 0">
                  <error>You must specify a recipient folder.</error>
                </check>
              </leave>
            </form>
          </input>
        </container>
        <static img="nms:rcpgroup.png" label="Add recipients to a list" type="separator"/>
        <container colcount="2">
          <value fontBold="true" margin-left="40" nolabel="true" xpath="/tmp/relationEntity/@groupLabel"/>
          <input label="Edit..." type="subFormLink" xpath=".">
            <form label="Add recipients to a list">
              <input checkedValue="0" label="Do not include in a list" type="RadioButton" xpath="/tmp/relationEntity/@groupOpt"/>
              <input checkedValue="1" label="Add to an existing list" type="RadioButton" xpath="/tmp/relationEntity/@groupOpt"/>
              <input checkedValue="2" label="Recreate the list (optimized mode, but loses the previous content of the list)" type="RadioButton" xpath="/tmp/relationEntity/@groupOpt"/>
              <container enabledIf="[/tmp/relationEntity/@groupOpt] != 0" type="enabledGroup">
                <input newEntityFormChoice="true" xpath="group">
                  <sysFilter>
                    <condition expr="@type = 0 and @schema='nms:recipient'"/>
                  </sysFilter>
                </input>
                <static type="help">Only lists of identifiers from the 'nms:recipient' schema are supported.</static>
              </container>
              <leave>
                <check expr="([/tmp/relationEntity/@groupOpt] != 0 and [@group-id] != 0) or [/tmp/relationEntity/@groupOpt] == 0">
                  <error>You must specify a list.</error>
                </check>
                <if expr="[/tmp/relationEntity/@groupOpt] == 2 and [source/reconciliation/nodeInfo/@double] = 'update'">
                  <set value="ignore" xpath="source/reconciliation/nodeInfo/@double"/>
                </if>
                <if expr="[/tmp/relationEntity/@groupOpt] == 0">
                  <set value="" xpath="@group-id"/>
                  <set value="" xpath="@group-cs"/>
                  <set translatedExpr="'Do not include in a list'" xpath="/tmp/relationEntity/@groupLabel"/>
                </if>
                <if expr="[/tmp/relationEntity/@groupOpt] == 2">
                  <set value="1" xpath="@clearGroup"/>
                  <set translatedExpr="'Recreate list \''+[@group-cs]+'\' (optimized mode, but erase the content of the list before import)'" xpath="/tmp/relationEntity/@groupLabel"/>
                </if>
                <if expr="[/tmp/relationEntity/@groupOpt] != 2">
                  <set value="0" xpath="@clearGroup"/>
                </if>
                <if expr="[/tmp/relationEntity/@groupOpt] == 1">
                  <set translatedExpr="'Add to list \''+[@group-cs]+'\''" xpath="/tmp/relationEntity/@groupLabel"/>
                </if>
              </leave>
            </form>
          </input>
        </container>
        <static img="nms:setofservices.png" label="Subscribe recipients to a service" type="separator"/>
        <container colcount="2">
          <value fontBold="true" margin-left="40" nolabel="true" xpath="/tmp/relationEntity/@serviceLabel"/>
          <input label="Edit..." type="subFormLink" xpath=".">
            <form label="Subscribe recipients to a service">
              <input checkedValue="0" label="Do not subscribe to a service" type="RadioButton" xpath="/tmp/relationEntity/@serviceOpt"/>
              <input checkedValue="1" label="Subscribe to an existing service" type="RadioButton" xpath="/tmp/relationEntity/@serviceOpt"/>
              <container enabledIf="[/tmp/relationEntity/@serviceOpt] != 0" type="enabledGroup">
                <input newEntityFormChoice="true" xpath="service"/>
                <input label="Send a confirmation message" type="checkbox" xpath="@sendConfirmation"/>
              </container>
              <leave>
                <check expr="([/tmp/relationEntity/@serviceOpt] != 0 and [@service-id] != 0) or [/tmp/relationEntity/@serviceOpt] == 0">
                  <error>You must specify an information service.</error>
                </check>
                <if expr="[/tmp/relationEntity/@serviceOpt] == 0">
                  <set value="0" xpath="@service-id"/>
                  <set value="" xpath="@service-cs"/>
                  <set translatedExpr="'Do not subscribe to a service'" xpath="/tmp/relationEntity/@serviceLabel"/>
                </if>
                <if expr="[/tmp/relationEntity/@serviceOpt] == 1">
                  <set translatedExpr="'Subscribe to service \''+[@service-cs]+'\''" xpath="/tmp/relationEntity/@serviceLabel"/>
                </if>
              </leave>
            </form>
          </input>
        </container>
        <static label="Specify origin of recipients" type="separator"/>
        <input xpath="@origin"/>
      </container>
      <container desc="Specify SQL scripts to execute before and/or after the import." name="sqlScript" title="Extra SQL scripts" visibleIf="[sqlScript/@active]" xpath="sqlScript" xpathsToLoad="sqlScript/*">
        <container enabledIf="HasNamedRight('sql')" type="enabledGroup">
          <static label="Pre-import SQL script" type="separator"/>
          <input contentType="sql" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="pre"/>
          <input xpath="@preFile"/>
          <container type="visibleGroup" visibleIf="@preFile">
            <input label="Script" xpath="@preScriptId"/>
          </container>
          <container type="visibleGroup" visibleIf="@preFile=='false'">
            <input createMode="none" label="Script" noAutoComplete="true" schema="xtk:sql" type="linkEdit" xpath="@preScriptId"/>
          </container>
          <static label="Post-import SQL script" type="separator"/>
          <input contentType="sql" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="post"/>
          <input xpath="@postFile"/>
          <container type="visibleGroup" visibleIf="@postFile">
            <input label="Script" xpath="@postScriptId"/>
          </container>
          <container type="visibleGroup" visibleIf="@postFile=='false'">
            <input createMode="none" label="Script" noAutoComplete="true" schema="xtk:sql" type="linkEdit" xpath="@postScriptId"/>
          </container>
        </container>
        <container type="visibleGroup" visibleIf="HasNamedRight('sql') == false">
          <static type="help">You do not have the rights needed to edit these scripts.</static>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="xtk:javascript" entitySchema="xtk:form" img="xtk:form.png" label="JavaScript codes" md5="94F211ABD6AB309F1F7B3663DE082E06" name="javascript" namespace="xtk" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input expr="@namespace='xtk' or @namespace='nl' or @namespace='nms' or @namespace='ncm' or  @namespace='crm'" type="expr" xpath="/tmp/@factory"/>
      <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@factory]">
        <container label="Warning" type="frame">
          <static type="warning">This is an application built-in object. It cannot be modified.</static>
        </container>
        <input contentType="JavaScript" nolabel="true" readOnly="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="data"/>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="![/tmp/@factory]">
        <static label="Edit" type="separator"/>
        <input contentType="JavaScript" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="data"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" md5="5B2D68CF558F5E8D60ADF48C77186C4C" name="job" namespace="xtk" xtkschema="xtk:form"/>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" label="Dynamic JavaScript pages" md5="83FBE4347D41F7D01421CD522A4F3BE2" name="jssp" namespace="xtk" screen="SchemaEdit" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input expr="@namespace='xtk' or @namespace='nl' or @namespace='nms' or @namespace='ncm' or  @namespace='crm'" type="expr" xpath="/tmp/@factory"/>
      <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@factory]">
        <container label="Warning" type="frame">
          <static type="warning">The following is a factory-configured object of the application. You cannot edit it.</static>
        </container>
        <input contentType="html" nolabel="true" readOnly="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="data"/>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="![/tmp/@factory]">
        <static label="Edit" type="separator"/>
        <input contentType="html" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="data"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:jst" entitySchema="xtk:form" img="xtk:form.png" label="JavaScript template" md5="5F49647082D0E53679D64642230AC07E" name="jst" namespace="xtk" xtkschema="xtk:form">
      <container colcount="2">
        <input xpath="@name"/>
        <input schema="xtk:schema" type="linkedit" xpath="@schema"/>
      </container>
      <container style="flat" type="notebook">
        <container label="Edit">
          <input nolabel="true" toolbar="true" type="ContentResEdit" typeJSTMenu="jstMenuSchema" wrap="false" xpath="code" xpathJSTMenu="@schema"/>
        </container>
        <container label="Preview" visibleIf="EndWith(@name, '.jst')=false">
          <static img="xtk:preview.png" label="JavaScript transformation preview (please specify content and generate)" type="separator"/>
          <container colcount="5">
            <input computeStringExpr="@computeString + ' (' + [channel/@fullName] + ')'" label="Content" name="content" schema="ncm:content" serialize="true" type="articleEdit" xpath="/ignored/content">
              <orderBy>
                <node expr="[@channel-id]"/>
              </orderBy>
            </input>
            <input enum="xtk:xslt:format" label="Format" name="format" serialize="true" type="sysEnum" xpath="/ignored/@format"/>
            <input label="DOM" name="dom" serialize="true" type="checkBox" xpath="/ignored/@dom"/>
            <input img="xtk:process.png" label="Generate" name="process" type="buttonProcessRes"/>
            <static/>
          </container>
          <input name="previewBrowser" type="browser"/>
        </container>
        <container label="Preview" visibleIf="EndWith(@name, '.jst')">
          <input alwaysActive="true" expr="$(serverUrl) + '/' + @namespace + '/' +  @name + '?'" type="expr" xpath="/ignored/@editUrl"/>
          <input alwaysActive="true" expr="[/ignored/@editUrl] + '&amp;__lastModified=' + @lastModified" type="expr" xpath="/ignored/@previewUrl"/>
          <input img="xtk:form/link.png" nolabel="true" type="edit" xpath="/ignored/@editUrl"/>
          <input sessionToken="true" type="urlViewer" urlExpr="[/ignored/@previewUrl]"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="xtk:massUpdate32.png" label="Mass update wizard" md5="EBFDC7CABFCCE1C229CF938FF8525BE8" name="massUpdate" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Please add fields to update and specify values to use." title="Select fields to update">
        <enter>
          <set value="true" xpath="@doNotPersist"/>
        </enter>
        <container type="vpaned">
          <container>
            <static fontBold="true" label="Available fields:"/>
            <container colcount="2">
              <static img="xtk:filter.png" type="image"/>
              <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/columns/@search"/>
            </container>
            <input hideCalculated="true" hideLinks="true" hideMappedAsXml="true" name="SchemaView" removeNodupPath="true" showLinks1="true" type="SchemaView" xpath="userArgs/@xtkschema" xpathHelp="/@help" xpathIndex="/tmp/columns/@current" xpathSearchPath="/tmp/columns/@search" xpathSelect="userArgs/select/node/@expr"/>
          </container>
          <container>
            <static fontBold="true" label="Fields to update:"/>
            <input delButton="true" entitySchema="xtk:queryDef" hideEditButtons="true" nolabel="true" ordered="false" toolbarAlign="vertical" type="updateList" xpath="userArgs/select/node" xpathHelp="/@help" xpathSchema="userArgs/@xtkschema">
              <input colSize="35" label="Expression" type="pathedit" xpath="@expr"/>
              <input label="Value" xpath="@valueLabel"/>
            </input>
          </container>
        </container>
        <input type="help" xpath="/@help"/>
      </container>
      <container desc="Click 'Start' to launch the mass update of selected records." name="finish" title="Mass update">
        <enter>
          <set value="0" xpath="properties/progress/@current"/>
          <set value="1" xpath="properties/progress/@max"/>
        </enter>
        <container askConfirmation="true" formKeyPath="userArgs/selection" formSchemaPath="userArgs/@xtkschema" type="jobProgressContainer">
          <soapCall name="Update" service="xtk:queryDef">
            <param exprIn="/" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <leave>
        <check expr="[/tmp/@inProcess] = false">
          <error>Job in progress. Please cancel before you can quit.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" label="Navigation hierarchy" md5="8B1131AE830E3FD81E167A46CC178600" name="navtree" namespace="xtk" screen="SchemaEdit,CheckEdit" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input expr="@namespace='xtk' or @namespace='nl' or @namespace='nms' or @namespace='ncm' or  @namespace='crm'" type="expr" xpath="/tmp/@factory"/>
      <container colspan="2" style="flat" type="notebook">
        <container label="Edit">
          <container type="visibleGroup" visibleIf="[/tmp/@factory]">
            <container label="Warning" type="frame">
              <static type="warning">The following is a factory-configured object of the application and should not be edited. To modify a factory-configured object, you must create an extension object in your own namespace.</static>
            </container>
            <input nolabel="true" readOnly="true" type="SourceEdit" xpath="."/>
          </container>
          <container type="visibleGroup" visibleIf="![/tmp/@factory]">
            <input nolabel="true" toolbar="true" type="SourceEdit" xpath="."/>
          </container>
        </container>
        <container label="Preview">
          <static img="xtk:preview.png" label="Preview of the generated navigation tree" type="separator"/>
          <input nolabel="true" readOnly="true" type="NavTreePreview" xpath="."/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:report" entitySchema="xtk:form" forceToSaveEntity="true" img="xtk:form.png" label="New report" md5="9D96E73C411C521E3D17E16CC1E7746B" name="newReport" namespace="xtk" type="wizard" xpathsToLoad="@isModel" xtkschema="xtk:form">
      <enter>
        <set value="model" xpath="/tmp/@type"/>
        <if expr="[/tmp/@newLink]=true">
          <set expr="/tmp/ctxForm/keys/key/@value" xpath="@targetReport-id"/>
        </if>
      </enter>
      <container colcount="3" desc="Select the report type to create." img="xtk:report32.png" name="choice" title="Report type" visibleIf="@isModel=false and [/tmp/@newFromModel]=false and [/tmp/@newLink]=false and [/tmp/@showFolder]!=1">
        <static colspan="3" img="xtk:newreport.png" label="New report" type="separator"/>
        <static/>
        <input checkedValue="model" label="Create a new report from a template" type="radioButton" xpath="/tmp/@type"/>
        <static/>
        <static colspan="3" img="xtk:newreport.png" label="Link to existing report" type="separator"/>
        <static/>
        <input checkedValue="link" label="Create a link to an existing report" type="radioButton" xpath="/tmp/@type"/>
        <static/>
        <static/>
      </container>
      <container desc="Please specify the different parameters of the data schema." img="xtk:report32.png" title="Report configuration">
        <container type="visibleGroup" visibleIf="[/tmp/@type]='model' and @isModel=false and [/tmp/@newFromModel]=false and [/tmp/@showFolder]!=1">
          <static img="nms:circle-one.png">Select a report template</static>
          <input boldLineExpr="@builtIn = 1" choiceButton="true" createMode="none" defaultModel="fullReport" folderFilterChoice="@model = 'xtkReportModel'" form="xtk:report" fullLoad="true" img="xtk:report.png" label="Template" newFromModelOnChange="true" noZoom="true" schema="xtk:report" selectionPath="/tmp/model" type="linkEdit" xpath="/tmp/@model">
            <sysFilter>
              <condition expr="@isModel = 1"/>
            </sysFilter>
            <orderBy>
              <node expr="@builtIn" sortDesc="true"/>
              <node expr="@label"/>
            </orderBy>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="[/tmp/@type]='link' and [/tmp/@showFolder]!=1">
          <static img="nms:circle-one.png">Select the original report</static>
          <input boldLineExpr="@builtIn = 1" choiceButton="true" computeStringAlias="/tmp/@targetReport_cs" folderFilterChoice="@model = 'xtkReport'" form="xtk:report" img="xtk:report.png" label="Target report" notifyPathList="@label" schema="xtk:report" type="linkedit" xpath="@targetReport-id">
            <sysFilter>
              <condition expr="@isModel = 0"/>
              <condition expr="[@targetReport-id] = 0"/>
            </sysFilter>
            <orderBy>
              <node expr="@builtIn" sortDesc="true"/>
              <node expr="@label"/>
            </orderBy>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="@isModel=false and [/tmp/@newFromModel]=false and [/tmp/@showFolder]!=1">
          <static img="nms:circle-two.png">Complete or modify parameters</static>
        </container>
        <input xpath="@label"/>
        <input schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
        <container type="visibleGroup" visibleIf="@isModel and ([/tmp/@saveAsModel]=='' or [/tmp/@showFolder]=1)">
          <input xpath="@type"/>
        </container>
        <input xpath="desc"/>
        <container type="visibleGroup" visibleIf="@isModel and ([/tmp/@saveAsModel]=='' or [/tmp/@showFolder]=1)">
          <input img="xtk:report.png" label="Instance folder" xpath="folderProcess">
            <sysFilter>
              <condition expr="@model = 'xtkReport'"/>
            </sysFilter>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="[/tmp/@saveAsModel]==true or (@isModel and [/tmp/@showFolder]=1)">
          <input img="xtk:reportModel.png" label="Folder" xpath="folder">
            <sysFilter>
              <condition expr="@model = 'xtkReportModel'"/>
            </sysFilter>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="[/tmp/@newFromModel]==true or [/tmp/@newFromMenu]==true or (@isModel=false and [/tmp/@showFolder]=1)">
          <input img="xtk:report.png" label="Folder" writeAccess="true" xpath="folder">
            <sysFilter>
              <condition expr="@model = 'xtkReport'"/>
            </sysFilter>
          </input>
        </container>
      </container>
      <leave>
        <if expr="@isModel=false and [/tmp/@showFolder]!=1">
          <check expr="[/tmp/@type]!='model' or ([/tmp/@newFromModel]==true or ([/tmp/model/key/@value]!=0 and [/tmp/model/key/@value]!=''))">
            <error>You must specify a template.</error>
          </check>
          <check expr="[/tmp/@type]=='model' or ([/tmp/@type]='link' and ([targetReport/@id] != 0 or [@targetReport-id] != 0))">
            <error>You must specify a target report.</error>
          </check>
          <if expr="[/tmp/@folder-id] != 0 AND [/tmp/@folder-id] != ''">
            <set expr="[/tmp/@folder-id]" xpath="@folder-id"/>
          </if>
          <if expr="@type='descriptiveAnalysis'">
            <set expr="@schema" xpath="activities/page/analysis/data/@schema"/>
          </if>
        </if>
        <if expr="@isModel and [/tmp/@saveAsModel] and [/tmp/@folder-id] != 0 AND [/tmp/@folderId] != ''">
          <set expr="[/tmp/@folder-id]" xpath="@folderProcess-id"/>
        </if>
        <check expr="@schema != ''">
          <error>You must specify a schema.</error>
        </check>
        <check expr="[@folder-id]!=0">
          <error>You must specify the report folder.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:workflow" entitySchema="xtk:form" img="xtk:form.png" label="New workflow" md5="80C1602498FE90F36DE1111C0277B41A" name="newWorkflow" namespace="xtk" noNewInstance="true" xpathsToLoad="@isModel" xtkschema="xtk:form">
      <container type="visibleGroup" visibleIf="@isModel=false and [/tmp/@newFromModel]=false">
        <static img="nms:circle-one.png">Select a workflow template</static>
        <input boldLineExpr="@builtIn = 1" choiceButton="true" createMode="none" defaultModel="newWorkflow" folderFilterChoice="@model = 'xtkWorkflowModel'" form="xtk:workflow" fullLoad="true" img="xtk:workflow.png" label="Template" newFromModelOnChange="true" noZoom="true" schema="xtk:workflow" selectionPath="/tmp/model" type="linkEdit" xpath="/tmp/@model">
          <sysFilter>
            <condition expr="@isModel = 1"/>
            <condition enabledIf="HasPackage('nms:campaign')" expr="[@operation-id] = 0"/>
          </sysFilter>
          <orderBy>
            <node expr="@builtIn" sortDesc="true"/>
            <node expr="@label"/>
          </orderBy>
        </input>
        <static img="nms:circle-two.png">Complete or modify parameters</static>
      </container>
      <input xpath="@label"/>
      <container type="visibleGroup" visibleIf="@isModel and [/tmp/@saveAsModel]==''">
        <input img="xtk:execute.png" label="Execution folder" xpath="folderProcess">
          <sysFilter>
            <condition expr="@model = 'xtkWorkflow'"/>
          </sysFilter>
        </input>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@saveAsModel]==true">
        <input label="Folder" setDefault="true" xpath="folder">
          <sysFilter>
            <condition expr="@model = 'xtkWorkflowModel'"/>
          </sysFilter>
        </input>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@newFromModel]==true or [/tmp/@folder-id] == 0  or [/tmp/@folderId] == 0">
        <input label="Folder" xpath="folder">
          <sysFilter>
            <condition expr="@model = 'xtkWorkflow'"/>
          </sysFilter>
        </input>
      </container>
      <input xpath="desc"/>
      <leave>
        <if expr="@isModel=false">
          <check expr="[@folder-id]!=0">
            <error>You must specify the workflow folder.</error>
          </check>
          <check expr="[/tmp/@newFromModel]==true or ([/tmp/model/key/@value]!=0 and [/tmp/model/key/@value]!='')">
            <error>You must specify a template.</error>
          </check>
          <if expr="[/tmp/@folder-id] != 0 AND [/tmp/@folder-id] != ''">
            <set expr="[/tmp/@folder-id]" xpath="@folder-id"/>
          </if>
          <if expr="[/tmp/@folderId] != 0 AND [/tmp/@folderId] != ''">
            <set expr="[/tmp/@folderId]" xpath="@folder-id"/>
          </if>
        </if>
        <if expr="@isModel and [/tmp/@saveAsModel] and [/tmp/@folder-id] != 0">
          <set expr="[/tmp/@folder-id]" xpath="@folderProcess-id"/>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:workflow" entitySchema="xtk:form" img="xtk:form.png" label="New aggregation workflow" md5="9CDE88DA172429C3AF48723634000EA1" name="newWorkflowAgg" namespace="xtk" noNewInstance="true" nothingToSave="true" xtkschema="xtk:form">
      <static img="nms:circle-one.png">Select an aggregation workflow template</static>
      <input boldLineExpr="@builtIn = 1" choiceButton="true" createMode="none" defaultModel="newAggregation" folderFilterChoice="@model = 'xtkWorkflowModel'" form="xtk:workflow" fullLoad="true" img="xtk:workflow.png" label="Template" linkEntityPath="." newFromModelOnChange="true" noZoom="true" schema="xtk:workflow" selectionPath="/tmp/model" type="linkEdit" xpath="/tmp/@model">
        <sysFilter>
          <condition expr="@isModel = 1"/>
          <condition expr="@internalName='newAggregation'"/>
        </sysFilter>
      </input>
      <static img="nms:circle-two.png">Complete or modify parameters</static>
      <input xpath="@label"/>
      <input xpath="desc"/>
      <leave>
        <check expr="[/tmp/model/key/@value]!=0 and [/tmp/model/key/@value]!=''">
          <error>You must specify a template.</error>
        </check>
        <soapCall name="FillWorkflow" service="xtk:olapAggregate">
          <param exprIn="." type="DOMElement"/>
          <param exprIn="/olapAggregate" type="DOMElement"/>
          <param type="DOMElement" xpathOut="."/>
        </soapCall>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Aggregate" md5="078518EA897E96BCBAA796A1C2E6F701" name="olapAggregate" namespace="xtk" type="iconbox" xpathsToLoad="@cube-id,cube" xtkschema="xtk:form">
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="dimension">
          <input choiceButton="true" createMode="none" fullLoad="true" xpath="dimension">
            <enter name="onChange">
              <set value="xtk:olapDimension" xpath="/ignored/queryDef/@schema"/>
              <set value="get" xpath="/ignored/queryDef/@operation"/>
              <set value="[level/@name]" xpath="/ignored/queryDef/select/node[1]/@expr"/>
              <set value="[level/@label]" xpath="/ignored/queryDef/select/node[2]/@expr"/>
              <set expr="'@id='+[@dimension-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
              <soapCall name="ExecuteQuery" service="xtk:queryDef">
                <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                <param type="DOMDocument" xpathOut="/tmp/olapDimensionLevel"/>
              </soapCall>
              <set value="" xpath="@levelLabel"/>
              <set value="" xpath="@level"/>
            </enter>
            <sysFilter>
              <condition expr="[@cube-id]=$(/olapAggregate/@cube-id)"/>
            </sysFilter>
          </input>
        </container>
      </container>
      <container colcount="2" img="xtk:properties.png" label="General">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input colspan="2" lineCount="3" xpath="description"/>
        <input colspan="2" editable="false" formName="edition" img="xtk:olapDimension.png" label=" " toolbarCaption="Dimensions to save in the aggregate" type="list" xpath="dimension" zoom="true" zoomOnAdd="true">
          <input label="Dimension" xpath="@dimension-cs"/>
          <input label="Level" xpath="@levelLabel"/>
          <input xpath="@useIndex"/>
          <form label="Edit the dimension" name="edition">
            <enter>
              <if expr="[@dimension-id]!=0">
                <set value="xtk:olapDimension" xpath="/ignored/queryDef/@schema"/>
                <set value="get" xpath="/ignored/queryDef/@operation"/>
                <set value="[level/@name]" xpath="/ignored/queryDef/select/node[1]/@expr"/>
                <set value="[level/@label]" xpath="/ignored/queryDef/select/node[2]/@expr"/>
                <set expr="'@id='+[@dimension-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                <soapCall name="ExecuteQuery" service="xtk:queryDef">
                  <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                  <param type="DOMDocument" xpathOut="/tmp/olapDimensionLevel"/>
                </soapCall>
              </if>
            </enter>
            <container ref="xtk:olapAggregate:lib/dimension"/>
            <input enumXPath="/tmp/olapDimensionLevel" label="Level" type="DynEnumCombo" xpath="@level" xpathLabel="@levelLabel"/>
            <container type="visibleGroup" visibleIf="[@dimension-id]!=0 and @level!=''">
              <input xpath="@useIndex"/>
            </container>
            <leave>
              <check expr="[@dimension-id] != '' AND @level != ''">
                <error>Please enter a dimension and level.</error>
              </check>
            </leave>
          </form>
          <form label="Add a dimension" name="OnAdd">
            <static img="nms:circle-one.png">Please check the dimension to add to the aggregate</static>
            <container ref="xtk:olapAggregate:lib/dimension"/>
            <container type="visibleGroup" visibleIf="[@dimension-id]!=0">
              <container type="visibleGroup" visibleIf="[/ignored/@newDimension]!=1">
                <static img="nms:circle-two.png">Select the dimension level</static>
              </container>
              <input enumXPath="/tmp/olapDimensionLevel" label="Level" type="DynEnumCombo" xpath="@level" xpathLabel="@levelLabel"/>
            </container>
            <container type="visibleGroup" visibleIf="[@dimension-id]!=0 and @level!=''">
              <input xpath="@useIndex"/>
            </container>
            <leave>
              <check expr="[@dimension-id] != '' AND @level != ''">
                <error>Please enter a dimension and level.</error>
              </check>
            </leave>
          </form>
        </input>
      </container>
      <container img="xtk:workflow.png" label="Workflow">
        <container img="xtk:workflow.png" label="Aggregation">
          <container type="visibleGroup" visibleIf="![workflow/@id]>0">
            <input form="xtk:newWorkflowAgg" img="xtk:workflow.png" label="Add an aggregation workflow..." type="urlButton" xpath="workflow"/>
          </container>
          <container type="visibleGroup" visibleIf="[workflow/@id]!=0">
            <container type="vpaned">
              <container padding-right="2" width-percent="20">
                <input ref="xtk:workflow:lib/palette" type="notebookPalette" xpath="/tmp"/>
              </container>
              <container width-percent="80">
                <container noTabs="true" noToolbar="true" type="notebooklist" xpath="workflow">
                  <container>
                    <input defaultModel="_NONE_" form="xtk:wkfAggregate" type="linkEntityDet" xpath="."/>
                  </container>
                </container>
              </container>
            </container>
          </container>
        </container>
      </container>
      <leave>
        <set value="0" xpath="@valid"/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Cube" md5="E1726EE868EC0D4516783929341464A7" name="olapCube" namespace="xtk" xtkschema="xtk:form">
      <enter>
        <if expr="EV([fact/@type], 'list')">
          <set value="nms:group" xpath="/ignored/queryDef/@schema"/>
          <set value="get" xpath="/ignored/queryDef/@operation"/>
          <set value="extension" xpath="/ignored/queryDef/select/node[1]/@expr"/>
          <set expr="'@id=' + [@list-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
          <soapCall name="ExecuteQuery" service="xtk:queryDef">
            <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
            <param type="DOMDocument" xpathOut="/tmp/tempSchemas"/>
          </soapCall>
          <copyElement xpathDst="tempSchemas/schema" xpathSrc="/tmp/tempSchemas/extension"/>
          <set expr="LoadSchema('tempSchemas/schema')" xpath="fact/@schema"/>
        </if>
        <set expr="@id" xpath="/ignored/@loaded"/>
        <set value="1" xpath="/ignored/@newDimension"/>
        <set value="1" xpath="/ignored/@newMeasure"/>
      </enter>
      <container colcount="2" readOnlyExpr="HasPackage('nms:neolap')==false" type="visibleGroup" visibleIf="[/ignored/@newEntity]=1">
        <container colcount="2" colspan="2">
          <static colspan="2">Define the fact source:</static>
          <input checkedValue="0" colspan="2" label="Use a schema" type="radioButton" xpath="fact/@type"/>
          <input checkedValue="1" colspan="2" label="Use a list" type="radioButton" xpath="fact/@type"/>
          <container colspan="2" type="visibleGroup" visibleIf="EV([fact/@type], 'schema')">
            <input required="true" type="schemaEdit" xpath="fact/@schema"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV([fact/@type], 'list')">
            <input createMode="none" required="true" xpath="list">
              <sysFilter>
                <condition expr="@type IN (1,2)"/>
              </sysFilter>
            </input>
          </container>
        </container>
        <static colspan="2" label="General information" type="separator"/>
        <input colspan="2" xpath="@label"/>
        <input colspan="2" xpath="description"/>
      </container>
      <container readOnlyExpr="HasPackage('nms:neolap')==false" type="visibleGroup" visibleIf="[/ignored/@newEntity]!=1">
        <container type="iconbox">
          <container colcount="2" img="xtk:olapCube.png" label="General">
            <input xpath="@label"/>
            <input xpath="@name"/>
            <input xpath="@timezone"/>
            <static/>
            <container colspan="2">
              <static label="Data source" type="separator"/>
              <container type="visibleGroup" visibleIf="EV([fact/@type], 'schema')">
                <input readOnly="true" type="schemaEdit" xpath="fact/@schema"/>
              </container>
              <container type="visibleGroup" visibleIf="EV([fact/@type], 'list')">
                <input createMode="none" readOnly="true" xpath="list"/>
              </container>
              <input default="0" type="checkbox" xpath="@autoRefresh"/>
              <container type="visibleGroup" visibleIf="[@autoRefresh]=='1'">
                <static type="warning">This option may alter performance when dealing with large volumes of data.</static>
              </container>
              <input label="Filter the source data..." nolabel="false" type="subFormLink" xpath="fact">
                <form label="Edit filter">
                  <container type="visibleGroup" visibleIf="[/ignored/@loaded]=[../@id]">
                    <container img="xtk:filter.png" label="Filter" type="queryWhereContainer">
                      <input nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathHelp="/@helpCond">
                        <input colSize="15" label=" " xpath="/@bool-operator"/>
                        <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                        <input colSize="15" label="Operator" xpath="/@operator"/>
                        <input colSize="30" label="Value" xpath="/@rightExpr"/>
                        <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                      </input>
                      <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                    </container>
                  </container>
                </form>
              </input>
              <container type="visibleGroup" visibleIf="[fact/where/@displayFilter]!=''">
                <input fontBold="true" label=" " lineCount="4" noBorder="true" readOnly="true" type="memo" xpath="fact/where/@displayFilter"/>
              </container>
            </container>
            <static colspan="2" label="Description" type="separator"/>
            <input colspan="2" nolabel="true" xpath="description"/>
          </container>
          <container img="xtk:olapDimension.png" label="Dimensions">
            <input img="xtk:olapDimension.png" nolabel="true" propagateXPathToCtx="fact/*" propagateXPathToCtxOnAdd="fact/*,/ignored/@newDimension" toolbarCaption="List of cube dimensions" type="linkList" xpath="dimension" zoom="true" zoomOnAdd="true">
              <input xpath="@label"/>
              <input xpath="@name"/>
            </input>
          </container>
          <container img="xtk:olapMeasure.png" label="Measures">
            <input img="xtk:olapMeasure.png" nolabel="true" propagateXPathToCtx="fact/*" propagateXPathToCtxOnAdd="/ignored/@newMeasure,fact/*" toolbarCaption="List of cube measures" type="linkList" xpath="measure" zoom="true" zoomOnAdd="true">
              <input xpath="@label"/>
              <input xpath="@name"/>
              <input xpath="computed/@computed"/>
            </input>
          </container>
          <container img="xtk:olapPreview.png" label="Preview">
            <input canSaveConfiguration="false" mode="preview" type="cubeExplorer" xpath="." xpathCubeId="@id"/>
          </container>
          <container img="xtk:olapAggregate.png" label="Aggregates">
            <input img="xtk:olapAggregate.png" nolabel="true" toolbarCaption="List of cube aggregates" type="linkList" xpath="aggregate" zoom="true" zoomOnAdd="true">
              <input xpath="@label"/>
              <input xpath="@name"/>
              <input xpath="@valid"/>
            </input>
          </container>
        </container>
      </container>
      <leave>
        <check expr="[/ignored/@newEntity]!=1 or [fact/@schema] != '' or EV([fact/@type], 'list') = true">
          <error>You must specify the fact schema.</error>
        </check>
        <check expr="[/ignored/@newEntity]!=1 or [@list-id] != 0 or EV([fact/@type], 'schema') = true">
          <error>You must specify the fact list.</error>
        </check>
      </leave>
      <postSave>
        <soapCall name="InvalidAggregates" service="xtk:olapCube">
          <param exprIn="." type="DOMElement"/>
        </soapCall>
      </postSave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" editionMode="dialog" entitySchema="xtk:form" img="xtk:form.png" label="Dimension" md5="E7833AF8C101C52BE16A40E09F809634" name="olapDimension" namespace="xtk" xpathsToLoad="@cube-id" xtkschema="xtk:form">
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container label="Binning" name="binning">
          <input label="Enable binning" xpath="@enable"/>
          <container type="visibleGroup" visibleIf="!@enable">
            <static label=" " nolabel="false" type="help">We recommend that you define binning when the risk of having many distinct values is high.</static>
          </container>
          <container type="visibleGroup" visibleIf="@enable">
            <static label=" " nolabel="false" type="help">When binning is enabled, formatting information is ignored.</static>
          </container>
          <container type="visibleGroup" visibleIf="@enable">
            <input checkedValue="0" label="Define each bin" type="radioButton" xpath="@dynamic"/>
            <input checkedValue="1" label="Dynamically link the values to an enumeration" type="radioButton" xpath="@dynamic"/>
            <container type="visibleGroup" visibleIf="!@dynamic">
              <input label="Generate bins..." nolabel="false" type="subFormLink" xpath=".">
                <form label="Generate bins" maxLabelWidth="50">
                  <enter>
                    <set expr="'0'" xpath="/tmp/binning/@generateMode"/>
                  </enter>
                  <input label="Number of bins to generate" type="number" xpath="/tmp/binning/@count"/>
                  <input checkedValue="1" label="Recover the most frequently used values" type="RadioButton" xpath="/tmp/binning/@generateMode"/>
                  <input checkedValue="2" label="Generate bins in the form of slots" type="RadioButton" xpath="/tmp/binning/@generateMode"/>
                  <leave>
                    <check expr="[/tmp/binning/@count] > 0">
                      <error>The number of bins must be a strictly positive integer.</error>
                    </check>
                    <check expr="[/tmp/binning/@generateMode] = 1 OR [/tmp/binning/@generateMode] = 2">
                      <error>Please select a generation mode.</error>
                    </check>
                    <if expr="[/tmp/binning/@generateMode] = 1">
                      <soapCall name="GetTopN" service="xtk:olapCube">
                        <param exprIn="." type="DOMElement"/>
                        <param exprIn="[/ignored/fact]" type="DOMElement"/>
                        <param exprIn="[../@expr]" type="string"/>
                        <param exprIn="[../@exprType]" type="string"/>
                        <param exprIn="[/tmp/binning/@count]" type="int"/>
                        <param exprIn="[../../@cube-id]" type="int"/>
                        <param type="DOMElement" xpathOut="."/>
                      </soapCall>
                    </if>
                    <if expr="[/tmp/binning/@generateMode] = 2">
                      <soapCall name="GetQuantiles" service="xtk:olapCube">
                        <param exprIn="." type="DOMElement"/>
                        <param exprIn="[/ignored/fact]" type="DOMElement"/>
                        <param exprIn="[../@expr]" type="string"/>
                        <param exprIn="[../@exprType]" type="string"/>
                        <param exprIn="[/tmp/binning/@count]" type="int"/>
                        <param exprIn="[../../@cube-id]" type="int"/>
                        <param type="DOMElement" xpathOut="."/>
                      </soapCall>
                    </if>
                  </leave>
                </form>
              </input>
              <input label=" " toolbarCaption="Bins" type="list" xpath="class" zoom="true">
                <input xpath="@label"/>
                <form label="Edit bin" name="edition">
                  <input xpath="@label"/>
                  <input xpath="@name"/>
                  <container type="visibleGroup" visibleIf="NodeCount(value) > 0">
                    <input nolabel="true" toolbarCaption="Values" type="list" xpath="value" zoom="false" zoomOnAdd="false">
                      <input xpath="@sqlMask"/>
                      <input label="Value or expression" xpath="@value"/>
                    </input>
                  </container>
                  <container type="visibleGroup" visibleIf="NodeCount(value) = 0">
                    <input xpath="@minValue"/>
                    <input xpath="@maxValue"/>
                  </container>
                  <leave>
                    <soapCall name="UpdateBinningClass" service="xtk:olapCube">
                      <param exprIn="." type="DOMElement"/>
                      <param exprIn="[../../@exprType]" type="string"/>
                      <param type="DOMElement" xpathOut="."/>
                    </soapCall>
                  </leave>
                </form>
                <form label="Creation of a new bin" name="OnAdd">
                  <enter>
                    <set expr="''" xpath="/tmp/binning/@mode"/>
                  </enter>
                  <static img="nms:circle-one.png">Choose how the bin will be defined</static>
                  <input checkedValue="0" label="List of values" nolabel="true" type="radioButton" xpath="/tmp/binning/@mode"/>
                  <input checkedValue="1" label="Define a bracket" nolabel="true" type="radioButton" xpath="/tmp/binning/@mode"/>
                  <container type="visibleGroup" visibleIf="[/tmp/binning/@mode] = 0">
                    <static img="nms:circle-two.png">List the values of the bin</static>
                    <input label="Class name" xpath="@name"/>
                    <input nolabel="true" type="list" xpath="value" zoom="false" zoomOnAdd="false">
                      <input xpath="@sqlMask"/>
                      <input label="Value or expression" xpath="@value"/>
                    </input>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/binning/@mode] = 1">
                    <static img="nms:circle-two.png">Indicate the limits of the bin</static>
                    <input xpath="@minValue"/>
                    <input xpath="@maxValue"/>
                  </container>
                  <leave>
                    <soapCall name="UpdateBinningClass" service="xtk:olapCube">
                      <param exprIn="." type="DOMElement"/>
                      <param exprIn="[../../@exprType]" type="string"/>
                      <param type="DOMElement" xpathOut="."/>
                    </soapCall>
                  </leave>
                </form>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="@dynamic">
              <input choiceButton="true" createMode="none" xpath="enum">
                <sysFilter>
                  <condition expr="[@classBinning]=true"/>
                </sysFilter>
              </input>
            </container>
            <input label="Label of the other values" xpath="@otherLabel"/>
          </container>
        </container>
      </container>
      <enter>
        <if expr="[/ignored/ignored/@newDimension]=1">
          <set expr="true" xpath="/tmp/date/@hasYears"/>
          <set expr="true" xpath="/tmp/date/@hasQuarters"/>
          <set expr="true" xpath="/tmp/date/@hasMonths"/>
          <set expr="true" xpath="/tmp/date/@hasDays"/>
          <set expr="false" xpath="/tmp/date/@hasHours"/>
        </if>
      </enter>
      <container type="visibleGroup" visibleIf="[/ignored/ignored/@newDimension]=1">
        <container colspan="2">
          <static img="nms:circle-one.png">Select the expression which will define the dimension</static>
          <input choiceType="expr" label="Expression" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="/tmp/field/@expr" xpathBaseType="/tmp/field/@type" xpathEnum="/tmp/field/@sysenum" xpathLabel="@label" xpathSchema="/ignored/fact/@schema"/>
          <input xpath="@label"/>
          <input xpath="@name"/>
          <container title="Generation of a time dimension" type="visibleGroup" visibleIf="[/tmp/field/@type] = 'datetime' OR [/tmp/field/@type] = 'datetimetz' OR [/tmp/field/@type] = 'datetimenotz' OR [/tmp/field/@type] = 'date'">
            <static img="nms:circle-two.png">Select the levels you want to include in the dimension.</static>
            <static label="Levels to create" type="separator"/>
            <input label="Years" type="checkbox" xpath="/tmp/date/@hasYears"/>
            <input label="Quarters" type="checkbox" xpath="/tmp/date/@hasQuarters"/>
            <input label="Months" type="checkbox" xpath="/tmp/date/@hasMonths"/>
            <input label="Days" type="checkbox" xpath="/tmp/date/@hasDays"/>
            <input label="Hours" type="checkbox" xpath="/tmp/date/@hasHours"/>
          </container>
          <input expr="[/tmp/field/@expr] + [/tmp/field/@type] + [/tmp/field/@sysenum]" type="expr">
            <enter>
              <if expr="[/tmp/field/@type] = 'link'">
                <soapCall name="GetLinkLevels" service="xtk:olapCube">
                  <param exprIn="/tmp/field" type="DOMElement"/>
                  <param exprIn="[cube/@id]" type="int"/>
                  <param type="DOMElement" xpathOut="/ignored/linklevels"/>
                </soapCall>
              </if>
              <if expr="[/tmp/field/@expr] != '' AND [/tmp/field/@type] != 'link' AND [/tmp/field/@type] != 'datetime' AND [/tmp/field/@type] != 'datetimetz' AND [/tmp/field/@type] != 'datetimenotz' AND [/tmp/field/@type] != 'date'">
                <soapCall name="GenerateSingleLevelDimension" service="xtk:olapDimension">
                  <param exprIn="." type="DOMElement"/>
                  <param exprIn="/tmp/field" type="DOMElement"/>
                  <param type="DOMElement" xpathOut="."/>
                </soapCall>
              </if>
            </enter>
          </input>
          <container type="visibleGroup" visibleIf="[/tmp/field/@type] = 'link'">
            <static img="nms:circle-two.png">Select the levels which the dimension will contain</static>
            <input noToolbar="true" nolabel="true" type="list" xpath="/ignored/linklevels/linklevel">
              <input label="Label" xpath="@label"/>
              <input label="Expression" xpath="@expr"/>
              <input label="Use this level" type="checkbox" xpath="@selected"/>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/field/@type] != '' AND [/tmp/field/@type] != 'link' AND [/tmp/field/@type] != 'datetime' AND [/tmp/field/@type] != 'datetimetz' AND [/tmp/field/@type] != 'datetimenotz' AND [/tmp/field/@type] != 'date'">
            <static img="nms:circle-two.png">Configure binning</static>
            <container ref="xtk:olapDimension:lib/binning" xpath="level/binning"/>
          </container>
        </container>
      </container>
      <container colcount="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newDimension]!=1">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input colspan="2" lineCount="3" xpath="description"/>
        <container colspan="2">
          <input editable="false" formName="edition" label=" " toolbarCaption="List of levels, sorted by preciseness" type="list" xpath="level" zoom="true" zoomOnAdd="true">
            <input xpath="@label"/>
            <input xpath="@name"/>
            <input xpath="@expr"/>
            <form colcount="2" label="Edit level" name="edition" xpathsToLoad="@exprType">
              <enter>
                <if expr="@exprType = 'link'">
                  <set expr="GetLinkSchema([/ignored/fact/@schema], @expr)" xpath="/tmp/formatLink/@schema"/>
                </if>
              </enter>
              <input xpath="@label"/>
              <input xpath="@name"/>
              <input choiceType="expr" colspan="2" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@expr" xpathBaseType="@exprType" xpathLabel="@label" xpathSchema="/ignored/fact/@schema"/>
              <container colspan="2" type="visibleGroup" visibleIf="@exprSysEnum == '' AND @exprType != 'link'">
                <container colspan="2" type="visibleGroup" visibleIf="[binning/@enable] != '1'">
                  <input xpath="@viewType"/>
                </container>
                <container colspan="2" ref="xtk:olapDimension:lib/binning" xpath="binning"/>
              </container>
              <input colspan="2" xpath="description"/>
              <container colspan="2" type="visibleGroup" visibleIf="@exprType = 'link'" xpath="format">
                <input editable="true" label="Formatting formulas" type="list" xpath="formatLink" zoom="false" zoomOnAdd="false">
                  <input choiceType="expr" colspan="2" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@expr" xpathLabel="@label" xpathSchema="/tmp/formatLink/@schema"/>
                  <input xpath="@label"/>
                </input>
              </container>
              <leave>
                <if expr="@expr=''">
                  <set value="self" xpath="@exprType"/>
                </if>
                <check expr="IndexOf(@name, '_') = -1">
                  <error>The '_' character is reserved and may not be used in the internal name of a level.</error>
                </check>
                <check expr="[binning/@dynamic] != 1 or [binning/enum/@id] > 0">
                  <error>You need to select an enumeration to be linked to binning.</error>
                </check>
              </leave>
            </form>
            <form label="Add a level" name="OnAdd">
              <static img="nms:circle-one.png">Please enter the expression which defines the level</static>
              <input choiceType="expr" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@expr" xpathBaseType="@exprType" xpathEnum="@exprSysEnum" xpathLabel="@label" xpathSchema="/ignored/fact/@schema"/>
              <input xpath="@label"/>
              <container type="visibleGroup" visibleIf="@exprType != 'link'">
                <input xpath="@viewType"/>
              </container>
              <container type="visibleGroup" visibleIf="@expr!=''">
                <static img="nms:circle-two.png">Expression binning</static>
                <container colspan="2" ref="xtk:olapDimension:lib/binning" xpath="binning"/>
              </container>
              <leave>
                <soapCall name="UpdateLevelName" service="xtk:olapDimension">
                  <param exprIn="." type="DOMElement"/>
                  <param exprIn="/olapDimension" type="DOMElement"/>
                  <param type="DOMElement" xpathOut="."/>
                </soapCall>
                <check expr="[binning/@dynamic] != 1 or [binning/enum/@id] > 0">
                  <error>You need to select an enumeration to be linked to binning.</error>
                </check>
              </leave>
            </form>
          </input>
        </container>
      </container>
      <leave>
        <if expr="[/ignored/ignored/@newDimension]=1">
          <if expr="[/tmp/field/@type] = 'datetime' OR [/tmp/field/@type] = 'datetimetz' OR [/tmp/field/@type] = 'datetimenotz' OR [/tmp/field/@type] = 'date'">
            <soapCall name="GenerateTimeDimension" service="xtk:olapDimension">
              <param exprIn="." type="DOMElement"/>
              <param exprIn="/tmp/field" type="DOMElement"/>
              <param exprIn="/tmp/date" type="DOMElement"/>
              <param type="DOMElement" xpathOut="."/>
            </soapCall>
          </if>
          <if expr="[/tmp/field/@type] = 'link'">
            <soapCall name="GenerateLinkDimension" service="xtk:olapDimension">
              <param exprIn="." type="DOMElement"/>
              <param exprIn="/ignored/linklevels" type="DOMElement"/>
              <param type="DOMElement" xpathOut="."/>
            </soapCall>
          </if>
          <check expr="[level/binning/@dynamic] != 1 or [level/binning/enum/@id] > 0">
            <error>You need to select an enumeration to be linked to binning.</error>
          </check>
        </if>
        <check expr="IndexOf(@name, '_') = -1">
          <error>The '_' character is reserved and may not be used in the internal name of a dimension.</error>
        </check>
      </leave>
      <postSave>
        <soapCall name="InvalidAggregates" service="xtk:olapDimension">
          <param exprIn="." type="DOMElement"/>
        </soapCall>
      </postSave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" editionMode="dialog" entitySchema="xtk:form" img="xtk:form.png" label="Measurement" md5="78851550BF986E132A51CC76EE3CA843" name="olapMeasure" namespace="xtk" xpathsToLoad="@cube-id" xtkschema="xtk:form">
      <enter>
        <set expr="[/ignored/fact/@schema]" xpath="filter/@schema"/>
        <soapCall name="GetCubeSchema" service="xtk:olapCube">
          <param exprIn="[@cube-id]" type="int"/>
          <param exprIn="'false'" type="boolean"/>
          <param type="DOMElement" xpathOut="/tmp/tempSchemas"/>
        </soapCall>
        <copyElement xpathDst="tempSchemas/schema" xpathSrc="/tmp/tempSchemas"/>
        <set expr="LoadSchema('tempSchemas/schema')" xpath="/tmp/cube/@schema"/>
        <set value="1" xpath="/ignored/@loaded"/>
      </enter>
      <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]!=1">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input xpath="@format"/>
        <static/>
        <input xpath="@unit"/>
        <input xpath="@unitFormat"/>
      </container>
      <container colcount="2" colspan="2">
        <container colspan="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]!=1">
          <static colspan="2" label="Measure type" type="separator"/>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]=1">
          <static img="nms:circle-one.png">Measure type</static>
        </container>
        <input checkedValue="0" colspan="2" label="Measure defined using the fact schema" type="RadioButton" xpath="computed/@computed"/>
        <input checkedValue="1" colspan="2" label="Measure calculated based on other measures" type="RadioButton" xpath="computed/@computed"/>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[computed/@computed]==0">
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]!=1">
            <static label="Measure formula" type="separator"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]=1">
            <static img="nms:circle-two.png">Measure formula</static>
          </container>
          <container colcount="2" colspan="2" padding-right="4" xpath="formula">
            <input xpath="@operator"/>
            <container type="visibleGroup" visibleIf="EV(@operator, 'count') = true">
              <input choiceType="expr" label="Expression (optional)" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@leftValue" xpathLabel="../@label" xpathSchema="../filter/@schema"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@operator, 'weightedAverage') = false and EV(@operator, 'count') = false">
              <input choiceType="expr" label="Expression" nolabel="false" required="true" type="pathEdit" useUnboundPath="false" xpath="@leftValue" xpathLabel="../@label" xpathSchema="../filter/@schema"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@operator, 'weightedAverage') = true">
              <input choiceType="expr" label="Expression" nolabel="false" required="true" type="pathEdit" useUnboundPath="false" xpath="@leftValue" xpathLabel="../@label" xpathSchema="../filter/@schema"/>
              <input choiceType="expr" label="Coefficient" nolabel="false" required="true" type="pathEdit" useUnboundPath="false" xpath="@rightValue" xpathSchema="../filter/@schema"/>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@loaded] == 1" xpath="filter">
            <input label="Filter the measure data..." nolabel="false" type="subFormLink" xpath=".">
              <form label="Edit filter">
                <container type="visibleGroup" visibleIf="[/ignored/@loaded] == 1">
                  <container img="xtk:filter.png" label="Filter" type="queryWhereContainer">
                    <input nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathHelp="/@helpCond">
                      <input colSize="15" label=" " xpath="/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/@operator"/>
                      <input colSize="30" label="Value" xpath="/@rightExpr"/>
                      <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                    </input>
                    <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                  </container>
                </container>
              </form>
            </input>
            <container type="visibleGroup" visibleIf="[where/@displayFilter]!=''">
              <input fontBold="true" label=" " lineCount="4" noBorder="true" readOnly="true" type="memo" xpath="where/@displayFilter"/>
            </container>
          </container>
        </container>
        <container colspan="2" padding-right="4" type="visibleGroup" visibleIf="[computed/@computed] == 1">
          <container type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]=1">
            <static img="nms:circle-two.png">Measure formula</static>
          </container>
          <input choiceType="expr" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="computed/@formula" xpathSchema="/tmp/cube/@schema"/>
        </container>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]=1">
        <static label="Overall information" type="separator"/>
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input xpath="description"/>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="[/ignored/ignored/@newMeasure]!=1">
        <static label="Description" type="separator"/>
        <input nolabel="true" xpath="description"/>
      </container>
      <leave>
        <if expr="[computed/@computed] == 0">
          <if expr="EV([formula/@operator], 'count') = false">
            <check expr="[formula/@leftValue] != ''">
              <error>The expression must be entered.</error>
            </check>
            <if expr="EV([formula/@operator], 'weightedAverage') = true">
              <check expr="[formula/@rightValue] != ''">
                <error>The coefficient must be entered.</error>
              </check>
            </if>
          </if>
        </if>
      </leave>
      <postSave>
        <soapCall name="InvalidAggregates" service="xtk:olapMeasure">
          <param exprIn="." type="DOMElement"/>
        </soapCall>
      </postSave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Operator" maxLabelWidth="50" md5="21176B738A3E4F3E65C0EB2C94D2DDEA" name="operator" namespace="xtk" xpathsToLoadOpt="encryption/*" xtkschema="xtk:form">
      <enter>
        <set expr="@securityZone+@disable+[access/@noConsoleCnx]" xpath="/ignored/@initSec"/>
      </enter>
      <input expr="@securityZone+@disable+[access/@noConsoleCnx]" type="expr" xpath="/ignored/dummy">
        <enter>
          <reset xpath="/ignored/accessDesc"/>
          <if expr="@disable">
            <set translatedExpr="'The operator account is disabled.'" xpath="/ignored/accessDesc"/>
          </if>
          <if expr="!@disable and [access/@noConsoleCnx]">
            <set translatedExpr="[/ignored/accessDesc]+'Access to the Adobe Campaign client console denied. '" xpath="/ignored/accessDesc"/>
          </if>
          <if expr="!@disable and @securityZone=''">
            <set translatedExpr="[/ignored/accessDesc]+'No connection zone defined for the operator. He will not be able to log on to the instance'" xpath="/ignored/accessDesc"/>
          </if>
          <if expr="!@disable and @securityZone='lan'">
            <set translatedExpr="[/ignored/accessDesc]+'The authorized connection zone is \'Internal network (LAN)\'.'" xpath="/ignored/accessDesc"/>
          </if>
          <if expr="!@disable and @securityZone='vpn'">
            <set translatedExpr="[/ignored/accessDesc]+'The authorized connection zone is \'Private company network (VPN+LAN)\'.'" xpath="/ignored/accessDesc"/>
          </if>
          <if expr="!@disable and @securityZone='public'">
            <set translatedExpr="[/ignored/accessDesc]+'The authorized connection zone is \'Public network (Internet+VPN+LAN)\'.'" xpath="/ignored/accessDesc"/>
          </if>
        </enter>
      </input>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="general">
          <container colcount="2" colspan="2" label="Identification" type="frame">
            <input img="xtk:login.png" label="Name (login)" xpath="@name"/>
            <container enabledIf="[access/@authenticationType]=='native'" type="enabledGroup">
              <input img="xtk:passwd.png" reversible="false" type="passwordEdit" xpath="access/@password"/>
            </container>
            <input xpath="@label"/>
            <input xpath="@externalId"/>
            <input applicableIf="HasPackage('nms:core')" createMode="none" xpath="localOrgUnit"/>
            <input xpath="@timezone"/>
            <input createMode="none" xpath="dashboard"/>
            <input xpath="@locale"/>
            <input applicableIf="hasPackage('nms:exchangeSynchronization')" colspan="2" label="Synchronization with Exchange..." nolabel="true" type="subFormLink">
              <form label="Synchronization with Exchange">
                <input xpath="ExchangeSynchronization/@login"/>
                <input xpath="ExchangeSynchronization/@password"/>
                <input xpath="ExchangeSynchronization/@email"/>
              </form>
            </input>
          </container>
          <container colcount="2" colspan="2" label="Contact points" type="frame">
            <input img="nms:sendemail.png" xpath="@email"/>
            <input xpath="@mobilePhone"/>
            <input createMode="none" xpath="reportsTo">
              <sysFilter>
                <condition expr="@type = 0"/>
                <condition expr="@id != $(@id)"/>
              </sysFilter>
            </input>
            <input xpath="@department"/>
            <container applicableIf="HasPackage('crm:lead')" colcount="2" colspan="2">
              <input xpath="@homePhone"/>
              <input xpath="@businessPhone"/>
              <input xpath="@jobTitle"/>
            </container>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="desc"/>
        </container>
        <container name="edition">
          <container type="iconbox">
            <container colcount="2" img="xtk:properties.png" label="General" name="general" ref="xtk:operator:lib/general"/>
            <container applicableIf="HasPackage('crm:lead')" img="nms:msgfolder.png" label="Details">
              <static applicableIf="HasPackage('crm:lead')" label="Details" type="separator"/>
              <container label="Main address" ref="crm:common:location"/>
            </container>
            <container applicableIf="HasNamedRight('admin')" img="xtk:dbprofile.png" label="Access rights" name="rights" visibleIf="[/tmp/@duplicated]!=1" xpath="access">
              <input enumImage="group/@type" folderFilterChoice="@model in ('xtkGroup','xtkNamedRight')" img="xtk:dbprofile.png" labelFormChoice="Add groups or named rights" nolabel="true" toolbarCaption="Groups and named rights" type="rightLinkList" xpath="../operatorGroup" xpathChoiceTarget="group" zoom="false">
                <input label="Named group or right" xpath="group"/>
                <input xpath="group/@type"/>
                <input xpath="group/desc"/>
              </input>
              <static label="Security settings" type="separator"/>
              <input img="nms:lock.png" label="Edit the access parameters..." nolabel="true" type="subFormLink">
                <form label="Access settings" maxLabelWidth="50">
                  <input nolabel="true" useDesc="true" xpath="@disable"/>
                  <static label="This option deactivates the operators' account, meaning that they may no longer access the application." type="help"/>
                  <input nolabel="true" useDesc="true" xpath="access/@noConsoleCnx"/>
                  <static label="This option prohibits access to the Adobe Campaign client console (Web and API access is authorized)." type="help"/>
                  <container type="visibleGroup" visibleIf="GetOption('XtkLdap_Active') == '1'">
                    <input checkedValue="ldap" label="Use LDAP to verify the password" type="checkbox" unCheckedValue="native" xpath="access/@authenticationType"/>
                  </container>
                  <container label="Encryption" type="frame">
                    <input label="Authorized connection zone" xpath="@securityZone"/>
                    <container xpath="access">
                      <container type="visibleGroup" visibleIf="NodeCount(trustedIP)=0">
                        <input label="Add a trusted IP mask" nolabel="true" type="urlButton">
                          <enter>
                            <set value="127.0.0.1" xpath="trustedIP/@mask"/>
                            <setModified/>
                          </enter>
                        </input>
                      </container>
                      <container type="visibleGroup" visibleIf="NodeCount(trustedIP)>0">
                        <input nolabel="true" toolbarCaption="List of trusted IP masks (password not verified)" type="list" xpath="trustedIP">
                          <input xpath="@mask"/>
                        </input>
                      </container>
                    </container>
                  </container>
                </form>
              </input>
              <input fontBold="true" label=" " lineCount="5" noBorder="true" readOnly="true" type="edit" xpath="/ignored/accessDesc"/>
              <static label="Restriction by folder" type="separator"/>
              <input label="Restrict to information found in sub-folders of:" nolabel="false" xpath="homeDir/@activated"/>
              <container type="visibleGroup" visibleIf="[homeDir/@activated]">
                <input computeStringAlias="@fullName" computeStringExpr="@fullName" img="xtk:folder.png" label="Folder" noZoom="true" schema="xtk:folder" type="linkedit" xpath="homeDir"/>
              </container>
            </container>
            <container applicableIf="HasPackage('nms:midReceiver')" img="nms:tracking.png" label="Frontal servers" maxLabelWidth="200" name="tracking">
              <enter>
                <set expr="[tracking/@instance]" xpath="/tmp/tracking/@Instance"/>
                <set value="create" xpath="/tmp/tracking/@trMode"/>
              </enter>
              <container type="visibleGroup" visibleIf="[tracking/@instance]!=''">
                <container label="Tracking server connection settings" type="frame" xpath="tracking">
                  <input xpath="@instance"/>
                  <input type="passwordEdit" xpath="@password"/>
                  <input xpath="@servers"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="[tracking/@instance]=''">
                <container label="Tracking server connection settings" maxLabelWidth="60" type="frame" xpath="tracking">
                  <input xpath="@servers"/>
                  <input label="Password of the 'internal' account" type="PasswordEdit" xpath="/tmp/tracking/@internalPassword"/>
                  <input label="Name of the instance to create" xpath="/tmp/tracking/@instance"/>
                  <input type="passwordEdit" xpath="@password"/>
                  <input label="Associated DNS masks" xpath="/tmp/tracking/@host"/>
                  <input img="nms:tracking.png" label="Confirm the configuration" nolabel="false" type="button">
                    <enter>
                      <check expr="[/tmp/tracking/@instance]!=''">
                        <error>The name of the tracking instance may not be empty</error>
                      </check>
                      <check expr="@servers!=''">
                        <error>The tracking server access URL may not be empty</error>
                      </check>
                      <soapCall name="CreateTrackingInstanceShell" service="nms:trackingUrl">
                        <param exprIn="[/tmp/tracking/@internalPassword]" type="string"/>
                        <param exprIn="@servers" type="string"/>
                        <param exprIn="[/tmp/tracking/@instance]" type="string"/>
                        <param exprIn="@password" type="string"/>
                        <param exprIn="[/tmp/tracking/@host]" type="string"/>
                      </soapCall>
                      <set expr="[/tmp/tracking/@instance]" xpath="@instance"/>
                      <setModified/>
                    </enter>
                  </input>
                  <static type="help">Click the button above to create the tracking instance on servers. To use an existing instance, leave the DNS mask empty.</static>
                </container>
              </container>
              <container label="Image publication settings" type="frame" xpath="imagePublishing">
                <input xpath="@method"/>
                <container type="visibleGroup" visibleIf="[@method]='list'">
                  <input xpath="@mediaServers"/>
                  <input xpath="@mediaInstance"/>
                  <input type="passwordEdit" xpath="@mediaPwd"/>
                </container>
                <container type="visibleGroup" visibleIf="[@method]='script'">
                  <input xpath="@script"/>
                </container>
              </container>
            </container>
            <container applicableIf="HasPackage('nms:midReceiver')" img="nl:passwd.png" label="Encryption" maxLabelWidth="200" name="encryption">
              <input label="Active encryption" nolabel="false" xpath="encryption/@active"/>
              <container type="visibleGroup" visibleIf="[encryption/@active]">
                <input xpath="encryption/@aeskey"/>
                <container type="visibleGroup" visibleIf="StrLen([encryption/@aeskey]) != 16 and StrLen([encryption/@aeskey]) != 24 and StrLen([encryption/@aeskey]) != 32">
                  <static type="warning">The key must be 16, 24 or 32 characters long</static>
                </container>
                <container label="AppendDeliveryPart / deliveryPart/message" type="frame">
                  <container xpath="encryption/AppendDeliveryPart_deliveryPart_message">
                    <enter>
                      <set value="true" xpath="@enabled"/>
                    </enter>
                    <input nolabel="true" type="list" xpath="action">
                      <input label="Action" xpath="@action"/>
                      <input label="XPath" xpath="@xpath"/>
                    </input>
                  </container>
                </container>
              </container>
            </container>
            <container img="xtk:logs.png" label="Audit">
              <container type="notebook">
                <container label="Folder Rights">
                  <input dblClickAction="none" hideEditButtons="true" img="xtk:folder.png" nolabel="true" refresh="true" schema="xtk:rights" toolbarCaption="List of folders linked to the operator" type="linklistChoice" xpath="/ignored/@folderRigth" zoom="false">
                    <input label="Folder" xpath="[folder/@fullName]"/>
                    <input label="Rights" xpath="@rights"/>
                    <sysFilter>
                      <condition boolOperator="OR" expr="[@operator-id]=$long(@id)"/>
                      <condition boolOperator="OR" expr="[@operator-id]" setOperator="IN">
                        <subQuery schema="xtk:operatorGroup">
                          <select>
                            <node expr="[@group-id]"/>
                          </select>
                          <where>
                            <condition expr="[@operator-id]=$long(@id)"/>
                          </where>
                        </subQuery>
                      </condition>
                    </sysFilter>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:campaign')" label="Approvals">
                  <input enumImage="@action" hideEditButtons="true" img="nms:validation.png" nolabel="true" refresh="true" toolbarCaption="Approvals log" type="linklist" xpath="validationLog-validatedBy" zoom="true">
                    <input xpath="@date"/>
                    <input xpath="@action"/>
                    <input xpath="@type"/>
                    <input xpath="validatedBy"/>
                    <input xpath="comment"/>
                    <orderBy>
                      <node expr="@date" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:mrm')" label="Subscriptions" visibleIf="HasPackage('nms:mrm')">
                  <input delButton="true" hideEditButtons="true" img="nms:rss.png" nolabel="true" refresh="true" toolbarCaption="Subscriptions to discussion forums" type="linklist" xpath="newsgroupFollower">
                    <input label="Subscription" xpath="[.]"/>
                    <input xpath="@date"/>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:mrm')" label="Events">
                  <input delButton="true" hideEditButtons="true" img="nms:week.png" nolabel="true" toolbarCaption="Calendar events" type="linklist" xpath="calendarEvent" zoom="true">
                    <input xpath="@start"/>
                    <input xpath="@end"/>
                    <input xpath="@duration"/>
                    <input xpath="@subject"/>
                    <input hidden="true" xpath="@id"/>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:mrm')" label="Tasks">
                  <input delButton="true" hideEditButtons="true" img="nms:task.png" nolabel="true" refresh="true" toolbarCaption="List of assigned tasks" type="linklist" xpath="taskOpRel" xpathEditTarget="task" zoom="true">
                    <input xpath="task"/>
                  </input>
                </container>
                <container applicableIf="HasPackage('crm:lead')" label="Audit" ref="crm:common:auditLink"/>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container type="visibleGroup" visibleIf="[/ignored/@newEntity]=1">
        <static img="nms:circle-one.png">Identification parameters</static>
        <input img="xtk:login.png" label="Name (login)" xpath="@name"/>
        <container enabledIf="[access/@authenticationType]=='native'" type="enabledGroup">
          <input img="xtk:passwd.png" reversible="false" type="passwordEdit" xpath="access/@password"/>
        </container>
        <input xpath="@label"/>
        <input img="nms:sendemail.png" xpath="@email"/>
        <input xpath="localOrgUnit"/>
        <static img="nms:circle-two.png">Operator access rights</static>
        <input folderFilterChoice="@model in ('xtkGroup','xtkNamedRight')" img="xtk:dbprofile.png" labelFormChoice="Add groups or named rights" nolabel="true" toolbarCaption="Groups and named rights" type="rightLinkList" xpath="operatorGroup" xpathChoiceTarget="group" zoom="false">
          <input label="Named group or right" xpath="group"/>
          <input xpath="group/@type"/>
          <input xpath="group/desc"/>
        </input>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@duplicated]=1">
        <container colcount="2" ref="xtk:operator:lib/general"/>
      </container>
      <container type="visibleGroup" visibleIf="[/ignored/@newEntity]!=1 and [/tmp/@duplicated]!=1">
        <container type="notebook">
          <container img="xtk:operator.png" label="Dashboard">
            <input entityRefresh="xtk:operator" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/xtk/operator.jssp?id='+@id+'&amp;standalone=1'"/>
          </container>
          <container img="xtk:form.png" label="Edit" ref="xtk:operator:lib/edition" visibleIf="@id!=0 and (@id=$(loginId) or HasNamedRight('admin'))"/>
        </container>
      </container>
      <postSave>
        <if expr="[/ignored/@initSec]!=(@securityZone+@disable+[access/@noConsoleCnx])">
          <msgBox focusOn="no" translatedExpr="'You have modified the connection parameters for this operator, do you want to force logout?'" type="yesno" xpathOut="/ignored/@resMsgBox"/>
          <if expr="[/ignored/@resMsgBox] == 'yes'">
            <soapCall name="KillSession" service="xtk:session">
              <param exprIn="[@name]" type="string"/>
            </soapCall>
          </if>
        </if>
      </postSave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" md5="C4AB6BA313E64FA6E2134B78C21A74F6" name="option" namespace="xtk" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@dataType"/>
      <container name="editVariantValue">
        <container type="visibleGroup" visibleIf="@dataType==6">
          <input xpath="@stringValue"/>
        </container>
        <container type="visibleGroup" visibleIf="@dataType==3">
          <input xpath="@longValue"/>
        </container>
        <container type="visibleGroup" visibleIf="@dataType==5">
          <input xpath="@doubleValue"/>
        </container>
        <container type="visibleGroup" visibleIf="@dataType==7">
          <input xpath="@timeStampValue"/>
        </container>
        <container type="visibleGroup" visibleIf="@dataType==12">
          <input xpath="memoValue"/>
        </container>
      </container>
      <input xpath="desc"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" label="Installed packages" md5="E284975AB2AAA8F8949A200643927CCF" name="package" namespace="xtk" readOnly="true" xtkschema="xtk:form">
      <input xpath="@label"/>
      <input xpath="@name"/>
      <input xpath="@vendor"/>
      <input xpath="@installDate"/>
      <static colspan="2" label="Description" type="separator"/>
      <input colspan="2" nolabel="true" xpath="desc"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:specFile" entitySchema="xtk:form" img="xtk:package32.png" label="Package Export Wizard" md5="93E79CD2E1CF87386140038E39BA0B27" name="packageExport" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Please specify the package type" title="Package type">
        <input checkedValue="0" label="User package" type="radioButton" xpath="@type"/>
        <static margin-left="28" type="help">This package can be defined by the user.</static>
        <input checkedValue="1" label="Platform package" type="radioButton" xpath="@type"/>
        <static margin-left="28" type="help">This package will contain technical configurations (schemas, forms, etc.).</static>
        <input checkedValue="2" label="Admin package" type="radioButton" xpath="@type"/>
        <static margin-left="28" type="help">This package will contain work configurations (delivery templates, campaigns, etc.).</static>
        <leave>
          <reset xpath="definition[*]"/>
          <if expr="@type!=0">
            <soapCall name="genDefinitions" service="xtk:specFile">
              <param exprIn="@type" type="byte"/>
              <param type="DOMDocument" xpathOut="."/>
            </soapCall>
          </if>
          <set value="true" xpath="@doNotPersist"/>
        </leave>
      </container>
      <container desc="Please specify the entities to export as a package (independent XML file), then click 'Next' to start the job." title="Select data" visibleIf="@type=0">
        <container ref="xtk:specFile:lib/schemas"/>
        <input img="xtk:properties.png" label="Generation parameters..." type="subFormLink">
          <form label="Generation parameters">
            <input xpath="@includeDefaultValues"/>
          </form>
        </input>
      </container>
      <container desc="Enter a file name, then click 'Start' to export the package." title="Export package">
        <enter>
          <set value="true" xpath="@doNotPersist"/>
        </enter>
        <input dlgType="save" label="File" type="fileedit" xpath="/tmp/@filename"/>
        <container ref="xtk:generatePackage:generate"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:builder" entitySchema="xtk:form" img="xtk:package32.png" label="Entities Import Wizard" md5="B624FBF40CFDFD7746C05852772730A8" name="packageImport" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="file" xpath="/ignored/@choice"/>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container colcount="3" desc="Select the package type to install." title="Package type">
        <static colspan="3" img="xtk:folder48.png" label="File" type="separator"/>
        <static/>
        <input checkedValue="file" label="Install a package from a file" type="radioButton" xpath="/ignored/@choice"/>
        <static/>
        <static colspan="3" img="xtk:installedPackage32.png" label="Adobe Campaign package" type="separator"/>
        <static/>
        <input checkedValue="neolane" label="Install a standard package" type="radioButton" xpath="/ignored/@choice"/>
        <static/>
      </container>
      <container desc="Select the packages to install." name="packages" title="Packages to install" visibleIf="[/ignored/@choice] == 'neolane'">
        <enter>
          <soapCall name="GetDbParams" service="xtk:builder">
            <param type="DOMElement" xpathOut="dbcnx"/>
            <param type="DOMElement" xpathOut="createdbParameters"/>
          </soapCall>
        </enter>
        <container>
          <input hideEditButtons="true" nolabel="true" type="PackageList" xpath="createdbParameters/packages/package">
            <input xpath="@label"/>
            <input xpath="@enabled"/>
          </input>
          <static unbound-width="true"/>
        </container>
      </container>
      <container desc="Click 'Start' to start the installation." name="installPackages" title="Installation" visibleIf="[/ignored/@choice] == 'neolane'">
        <container refreshPeriod="500" type="jobProgressContainer" xpathProperties="/properties">
          <soapCall name="InstallVendorPackages" service="xtk:builder">
            <param exprIn="/" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <container desc="Select the source file containing the package of entities to import." title="Package to import" visibleIf="[/ignored/@choice] == 'file'">
        <input filters="XML files (*.xml)|*.xml|All (*.*)|*.*|" label="File" title="Open XML content" type="fileedit" xpath="/content/@file" xpathLoadContent="package"/>
        <static label="XML content of the data to import" type="separator"/>
        <input label="XML content" nolabel="true" type="sourceEdit" xpath="package"/>
        <leave></leave>
      </container>
      <container desc="Click 'Start' to start the installation." name="installFile" title="Installation" visibleIf="[/ignored/@choice] == 'file'">
        <container refreshPeriod="500" type="JobProgressContainer" xpathProperties="/properties">
          <soapCall name="InstallPackage" service="xtk:builder">
            <param exprIn="/" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <input label="Ignore warnings" name="ignoreWarnings" nolabel="true" type="checkbox" xpath="package/@ignoreWarnings"/>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Package installations" md5="2F33BC2540AD8A29E9497F2A42844DA8" name="packageInstall" namespace="xtk" readOnly="true" type="iconbox" xtkschema="xtk:form">
      <container colcount="2" img="xtk:properties.png" label="General">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input xpath="@installDate"/>
        <static/>
        <input colspan="2" hideEditButtons="true" img="xtk:installedPackage.png" nolabel="true" toolbarCaption="Installation packages" type="linklist" xpath="packages" xpathEditTarget="package" zoom="true">
          <input xpath="@package-name"/>
          <input xpath="@package-namespace"/>
        </input>
      </container>
      <container img="xtk:logs.png" label="Log">
        <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Log messages of the journal" type="linkList" xpath="log">
          <input xpath="@logDate"/>
          <input xpath="@message"/>
          <orderBy>
            <node expr="@id" sortDesc="true"/>
          </orderBy>
        </input>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="List configuration" md5="0270C830834FE6CA5F42DA43451CA82B" name="queryDef" namespace="xtk" type="notebook" xtkschema="xtk:form">
      <enter>
        <set expr="@schema" xpath="/tmp/selectCtrl/in/@schema"/>
        <set expr="@startPath" xpath="/tmp/selectCtrl/in/@startPath"/>
        <set value="select" xpath="/tmp/selectCtrl/in/@choiceType"/>
      </enter>
      <container name="hidden" visibleIf="false">
        <container name="selectCtrl" type="querySelectContainer">
          <container name="vpaned" type="vpaned">
            <container name="schema">
              <static fontBold="true" label="Available fields:"/>
              <container colcount="2">
                <static img="xtk:filter.png" type="image"/>
                <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
              </container>
              <input name="schemaView" type="SchemaView" useUnboundPath="true" xpath="/tmp/selectCtrl/in/@schema" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="select/node/@expr" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
            </container>
            <container name="output" xpathsToLoad="output*">
              <static fontBold="true" label="Output columns:"/>
              <input choiceFormOnAdd="true" name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" xpath="select/node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupBy="groupBy/node" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHaving="having/condition" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="/tmp/selectCtrl/in/@schema" xpathStartPath="/tmp/selectCtrl/in/@startPath" zoom="false">
                <input colSize="20" xpath="@label"/>
                <input colSize="35" type="pathedit" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/selectCtrl/in/@schema" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                <form label="Column definition" name="colDetail">
                  <input xpath="@label"/>
                  <container name="extraFields"/>
                  <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                  <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                    <container colcount="2" cols-width="100,1">
                      <container>
                        <static fontBold="true" label="Available fields:"/>
                        <container colcount="2">
                          <static img="xtk:filter.png" type="image"/>
                          <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                        </container>
                        <input type="schemaview" xpath="/tmp/selectCtrl/in/@schema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                      </container>
                      <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                    </container>
                    <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                  </container>
                  <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                </form>
              </input>
            </container>
          </container>
          <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
        </container>
        <container desc="Please enter the filtering and sort conditions for each collection link." name="conditionLink" title="Collection personalization information">
          <input alwaysActive="true" editable="false" img="xtk:xtklinkn.png" noEditCollection="true" nolabel="true" type="customizeCondition" xpath="conditionLink" xpathSchema="@schema" xpathSelect="select/node" xpathStartPath="@startPath" zoom="true">
            <input xpath="@label"/>
            <input xpath="@lineCount"/>
            <input xpath="where/@displayFilter"/>
            <input xpath="orderBy/@displayOrder"/>
            <input hidden="true" xpath="@schema"/>
            <form label="Filtering for a collection of personalization information" type="wizard">
              <container desc="Enter information used to specify how many collection elements you want to keep." img="xtk:report/editor/insertColumnRight.png" name="parameters" title="General parameters">
                <enter>
                  <if expr="@lineCount > 1">
                    <set value="0" xpath="/tmp/@singleRow"/>
                  </if>
                  <if expr="@lineCount==1">
                    <if expr="@groupBy==0">
                      <set value="1" xpath="/tmp/@singleRow"/>
                    </if>
                    <if expr="@singleRow==0 AND @groupBy==0">
                      <set value="0" xpath="/tmp/@singleRow"/>
                    </if>
                    <if expr="@groupBy==1">
                      <set value="2" xpath="/tmp/@singleRow"/>
                    </if>
                  </if>
                  <if expr="@lineCount==0">
                    <set value="-1" xpath="/tmp/@singleRow"/>
                  </if>
                </enter>
                <input enum="xtk:queryDef:rowConditionType" label="Data collected" type="sysEnum" xpath="/tmp/@singleRow"/>
                <container type="visibleGroup" visibleIf="[/tmp/@singleRow]==0">
                  <input xpath="@lineCount"/>
                </container>
                <container backcolor="tooltip" type="visibleGroup" visibleIf="[/tmp/@singleRow]==1">
                  <static type="warning">This mode optimizes the generated SQL query thanks to a direct join on the collection elements. \nWarning: if the initial condition isn't complied with, the result may be false (missing lines or duplicates).</static>
                </container>
                <leave>
                  <if expr="[/tmp/@singleRow]&lt;=0">
                    <set value="0" xpath="@singleRow"/>
                    <set value="0" xpath="@groupBy"/>
                  </if>
                  <if expr="[/tmp/@singleRow]==1">
                    <set value="1" xpath="@singleRow"/>
                    <set value="0" xpath="@groupBy"/>
                  </if>
                  <if expr="[/tmp/@singleRow]==2">
                    <set value="1" xpath="@singleRow"/>
                    <set value="1" xpath="@groupBy"/>
                  </if>
                  <if expr="[/tmp/@singleRow]>0">
                    <set value="1" xpath="@lineCount"/>
                  </if>
                  <if expr="[/tmp/@singleRow]==255">
                    <set value="0" xpath="@lineCount"/>
                  </if>
                </leave>
              </container>
              <container desc="Enter the filtering condition used to specify which collection elements you want to keep." img="xtk:filter32.png" name="where" title="Filtering" visibleI="@lineCount>0">
                <container buildQueryXPath="." ref="xtk:queryDef:where"/>
              </container>
              <container desc="Specify the sort order used to indicates which lines to keep, when there are more lines eligible than specified previously." img="xtk:filter32.png" name="orderBy" title="Sort" visibleIf="@singleRow == false AND @lineCount>0">
                <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                  <input colSize="20" xpath="@label"/>
                  <input colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                  <input colSize="15" editable="true" xpath="@sortDesc"/>
                </input>
                <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@help"/>
              </container>
            </form>
          </input>
        </container>
      </container>
      <container img="xtk:column.png" label="Columns" visibleIf="@hideSelect == 'false'" xpath=".">
        <container extraColumns="@colSize" hideUnboundPath="true" ref="xtk:queryDef:hidden/selectCtrl"/>
        <input label="Advanced parameters..." type="subFormLink">
          <form label="Advanced parameters">
            <static label="Number of lines to retrieve when populating the list." type="help"/>
            <input xpath="@lineCount"/>
          </form>
        </input>
        <input checkModify="true" label="Generated SQL query..." type="subFormLink">
          <form label="Native SQL query used to load the list" nothingToEdit="true" nothingToSave="true">
            <enter>
              <soapCall name="BuildQuery" service="xtk:queryDef">
                <param exprIn="[/queryDef]" type="DOMElement"/>
                <param type="string" xpathOut="/ignored/@previewSQL"/>
              </soapCall>
            </enter>
            <static type="help">Native SQL query generated to populate the list.</static>
            <input contentType="sql" nolabel="true" readOnly="true" type="codeEdit" wrap="true" xpath="/ignored/@previewSQL"/>
          </form>
        </input>
      </container>
      <container img="xtk:filter.png" label="Filter" name="where" type="queryWhereContainer" visibleIf="@hideWhere == 'false'">
        <input name="filterList" nolabel="true" propagateXPathToCtx="/ignored/@currentDeliveryId|/@currentDeliveryId,/ignored/@currentOfferId|/@currentOfferId,/ignored/@currentOrderId|/@currentOrderId" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="/@helpCond">
          <input colSize="15" label=" " xpath="/@bool-operator"/>
          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
          <input colSize="15" label="Operator" xpath="/@operator"/>
          <input colSize="30" label="Value" xpath="/@rightExpr"/>
          <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
        </input>
        <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
        <input checkModify="true" label="Generated SQL query..." type="subFormLink">
          <form label="Native SQL query generated from the filter" nothingToEdit="true" nothingToSave="true">
            <enter>
              <soapCall name="BuildQuery" service="xtk:queryDef">
                <param exprIn="/queryDef" type="DOMElement"/>
                <param type="string" xpathOut="/tmp/@previewSQL"/>
              </soapCall>
            </enter>
            <static label="Native SQL query generated to populate the list." type="help"/>
            <input contentType="sql" nolabel="true" readOnly="true" type="codeEdit" wrap="true" xpath="/tmp/@previewSQL"/>
          </form>
        </input>
      </container>
      <container img="xtk:sort.png" label="Sorting" name="orderBy" visibleIf="@hideOrderby == 'false'">
        <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" xpathSelect="select/node" zoom="false">
          <input colSize="20" xpath="@label"/>
          <input choiceType="sort" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="/tmp/selectCtrl/in/@schema" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
          <input colSize="15" editable="true" xpath="@sort"/>
          <input colSize="15" editable="true" xpath="@sortDesc"/>
        </input>
        <input type="help" xpath="/@help"/>
      </container>
      <container name="having" visibleIf="false">
        <input name="havingList" nolabel="true" propagateXPathToCtx="/ignored/@currentOrderId|/@currentOrderId" toolbarAlign="horizontal" toolbarCaption="Grouping conditions" type="conditionlist" xpath="having" xpathCurrentLookupPath="/lookupPath/having" xpathHelp="/@helpHaving" xpathSchema="@schema" xpathStartPath="source/@startPath">
          <input colSize="15" label=" " xpath="/having/@bool-operator"/>
          <input colSize="30" label="Expression" xpath="/having/@leftExpr"/>
          <input colSize="15" label="Operator" xpath="/having/@operator"/>
          <input colSize="30" label="Value" xpath="/having/@rightExpr"/>
        </input>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Application filter" md5="607AF6BF270E7B7EEC5206EBC87830BD" name="queryFilter" namespace="xtk" type="iconbox" xpathsToLoadOpt="env/@id,env/@inputSchema" xtkschema="xtk:form">
      <input expr="Iif(NodeValue('env/@inputSchema')!='', extendWithInteraction(@schema,NodeValue('env/@inputSchema')), '')" type="expr" xpath="/ignored/@extSchema"/>
      <input expr="Iif( NodeValue('env/@inputSchema')!='', 1, 0)" type="expr" xpath="/ignored/@currentOfferId"/>
      <container colcount="2" img="xtk:valuestats.png" label="General" name="general">
        <input xpath="@label"/>
        <input schema="xtk:schema" type="schemaEdit" xpath="@schema" xpathStartPath="@startPath"/>
        <input xpath="@name"/>
        <input schema="xtk:image" type="linkedit" xpath="@img"/>
        <input type="comboListShortCut" xpath="@shortCut"/>
        <static/>
        <input colspan="2" noSaveFilter="true" nolabel="true" propagateXPathToCtx="/ignored/@currentOfferId|/@currentOfferId" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathHelp="/@helpCond" xpathSchema="@schema" xpathStartPath="@startPath">
          <input colSize="15" label=" " xpath="/@bool-operator"/>
          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
          <input colSize="15" label="Operator" xpath="/@operator"/>
          <input colSize="30" label="Value" xpath="/@rightExpr"/>
          <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
        </input>
        <input colspan="2" fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
        <input checkModify="true" colspan="2" label="Generated SQL query..." type="subFormLink">
          <form label="Native SQL query generated from the filter" nothingToEdit="true" nothingToSave="true">
            <enter>
              <soapCall name="BuildQuery" service="xtk:queryDef">
                <param exprIn="[/queryFilter]" type="DOMElement"/>
                <param type="string" xpathOut="/ignored/@previewSQL"/>
              </soapCall>
            </enter>
            <static type="help">Native SQL query generated from the filtering condition and submitted to the database engine to execute this filter.</static>
            <input contentType="sql" nolabel="true" readOnly="true" type="codeEdit" wrap="true" xpath="/ignored/@previewSQL"/>
          </form>
        </input>
      </container>
      <container colcount="2" img="xtk:properties.png" label="Parameters" name="parameters">
        <input createMode="none" noZoom="true" readOnly="true" xpath="createdBy"/>
        <static/>
        <input colspan="2" useDesc="true" xpath="@default"/>
        <input colspan="2" useDesc="true" xpath="@shared"/>
        <input colspan="2" useDesc="true" xpath="@hasForm"/>
        <input colspan="2" img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink">
          <form label="Advanced parameters">
            <static type="help">SQL table to which the filter applies. Used to create a single filter which applies to multiple document types sharing the same table.</static>
            <input xpath="@sqlTable"/>
            <static type="help">This option enables you to define the filter as the main filter on the entity.</static>
            <input xpath="@main"/>
            <static type="help">This option prevents you from restricting the filter.</static>
            <input xpath="@noStack"/>
            <static type="help">This option lets you define a visibility condition for the filter.</static>
            <input schema="xtk:schema" type="schemaEdit" xpath="@visibleFilterSchema"/>
            <container type="visibleGroup" visibleIf="[@visibleFilterSchema] != ''">
              <input label="Visibility expression" nolabel="false" type="pathedit" xpath="@visibleFilterExpr" xpathSchema="@visibleFilterSchema"/>
            </container>
          </form>
        </input>
        <input colspan="2" xpath="desc"/>
      </container>
      <container img="xtk:form.png" label="Form" name="form" visibleIf="@hasForm">
        <static label="Definition of the form used to enter parameters of the filter." type="help"/>
        <input addButtonResourceMenu="true" nolabel="true" resourceSchema="xtk:form" toolbar="true" type="SourceEdit" xpath="form"/>
      </container>
      <container img="xtk:preview.png" label="Preview" name="preview">
        <input noToolbar="true" nolabel="true" type="previewFilter" xpath="/tmp"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:export32.png" label="Reject export" md5="921F79DD64CEC886803B1E7960FF32E4" name="rejectExport" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set translatedExpr="'Rejects for import ' + [dataTransferStep/source/rejectExportSource/key/@value]" xpath="@label"/>
        <set value="simple" xpath="@exportType"/>
        <set value="rejectExportStep" xpath="dataTransferStep[1]/@name"/>
        <set value="xtk:dataTransfer" xpath="dataTransferStep[1]/source/@schema"/>
        <set value="/reject" xpath="dataTransferStep[1]/source/@startPath"/>
        <set value="false" xpath="dataTransferStep[1]/source/@rejectsFromTextConnector"/>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container desc="Enter the description of the reject export." name="general" title="Definition of the export rejects">
        <static label="This wizard helps you extract from source files the records which have generated errors during an import."/>
        <input xpath="@label"/>
        <input checkedValue="false" label="Export rejects from database or bulk connector" type="RadioButton" xpath="dataTransferStep[1]/source/@rejectsFromTextConnector"/>
        <input checkedValue="true" label="Export rejects from text connector" type="RadioButton" xpath="dataTransferStep[1]/source/@rejectsFromTextConnector"/>
        <static type="help">Some rejects have been generated during database update (database connector), others during source file analysis (source connector). These two types of rejects do not have the same format, so you can process only one connector type at a time.</static>
      </container>
      <container desc="Indicate the path in which to write the generated files." name="rejectExpParams" title="Output file" xpath="dataTransferStep[1]">
        <enter>
          <set value="xtkDataStore" xpath="source/@type"/>
          <set value="text" xpath="destination/@type"/>
        </enter>
        <container label="Output files" type="frame">
          <input label="Download the files generated on the server." xpath="destination/@downloadDestFile"/>
          <container type="visibleGroup" visibleIf="[destination/@downloadDestFile] == 'true'">
            <input dlgType="savedir" label="Local directory" type="fileEdit" xpath="destination/@outputDirectory"/>
          </container>
          <container type="visibleGroup" visibleIf="[destination/@downloadDestFile] == 'false'">
            <input label="Server directory" xpath="destination/@outputDirectory"/>
          </container>
        </container>
        <container label="Destination format" type="frame">
          <container ref="xtk:exportSource:destInfo/exportFormat" xpath="destination/exportFormat"/>
          <input label="Advanced parameters..." nolabel="false" type="subFormLink">
            <form label="Advanced parameters">
              <container type="notebook" xpath="dataTransferStep[1]">
                <container label="Filtering">
                  <input name="filterList" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionlist" xpath="source/where[1]/condition[1]" xpathCurrentLookupPath="/tmp/global/lookupPath/where" xpathExpr="/tmp/global/expr" xpathHelp="/tmp/global/@helpWhere" xpathSchema="source/@schema" xpathSchemaView="/schema" xpathStartPath="source/@startPath">
                    <input colSize="15" label=" " xpath="/tmp/global/@bool-operator"/>
                    <input colSize="30" label="Expression" xpath="/tmp/global/@leftExpr"/>
                    <input colSize="15" label="Operator" xpath="/tmp/global/@operator"/>
                    <input colSize="30" label="Value" xpath="/tmp/global/@rightExpr"/>
                  </input>
                  <input fontBold="true" type="help" xpath="/tmp/global/@helpWhere"/>
                </container>
                <container label="Others" propagateConstraints="false" xpath="destination">
                  <container enabledIf="EV([exportFormat/@format], 'text', 'csv')" type="enabledGroup">
                    <input xpath="@putUnmappedCols"/>
                    <input xpath="@splitOverOrigin"/>
                  </container>
                  <container type="visibleGroup" visibleIf="EV([exportFormat/@format], 'xml')">
                    <static type="help">These advanced options are only relevant for exporting text rejects.</static>
                  </container>
                </container>
              </container>
            </form>
          </input>
        </container>
      </container>
      <container desc="Click on 'Start' to launch the export of the data." name="finish" title="Destination format">
        <enter>
          <set value="export" xpath="@jobType"/>
        </enter>
        <container getFileNameFromProp="true" methodName="RejectExport" type="dataTransferSubmitContainer" xpathCurProgress="properties/progress/@current" xpathDestName="dataTransferStep/destination/@remoteSourceName" xpathMaxProgress="properties/progress/@max">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2" xpath="properties/counters">
            <value xpath="@processed"/>
            <value xpath="@rejected"/>
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatButton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Report" md5="4DE8C0C85F549BB4EB7AA780CB11C765" name="report" namespace="xtk" xpathsToLoad="@entitySchema,rendering/**,operator,operator/@name,folderProcess,folder" xpathsToLoadOpt="defaultDictionary" xtkschema="xtk:form">
      <enter>
        <set expr="Iif([/ignored/@context] != 'selection' or (@monoselection = false and @multiselection = false),'',[/ignored/@selection])" xpath="/ignored/@selection"/>
        <set expr="Iif([/ignored/@context] = 'selection' and (@monoselection = true or @multiselection = true) and [/ignored/@selection] != '', 'selection', '')" xpath="/ignored/@context"/>
        <set translatedExpr="'Please select a display mode (global or selection) and if necessary a' + Lower(SchemaLabel([$(entityPath)/@schema]))" xpath="/ignored/@selectionHelper"/>
        <soapCall name="GetUsedLanguagesEnum" service="xtk:report">
          <param exprIn="@designLanguage" type="string"/>
          <param exprIn="@defaultLanguage" type="string"/>
          <param exprIn="additionalLanguages" type="DOMElement"/>
          <param type="DOMElement" xpathOut="/ignored/langs"/>
        </soapCall>
        <reset xpath="/ignored/translationStats"/>
        <set expr="[/report/@id]" xpath="/tmp/ctxForm/keys/key/@value"/>
        <set value="web" xpath="/ignored/source/@target"/>
        <reset xpath="/ignored/source/@version"/>
        <set value="web" xpath="/ignored/source/option/enum[1]/@name"/>
        <set value="Web" xpath="/ignored/source/option/enum[1]/@label"/>
        <set value="office" xpath="/ignored/source/option/enum[2]/@name"/>
        <set value="Office" xpath="/ignored/source/option/enum[2]/@label"/>
      </enter>
      <input expr="Iif(NodeCount(schemasExtension), loadSchema('/report/schemasExtension/schema'), '')" type="expr" xpath="/tmp/@schema"/>
      <input type="formContext"/>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="palette">
          <container img="nms:dedit.png" label="Common" name="base">
            <input img="xtk:miniatures/mini-start.png" xpath="start"/>
            <input img="nms:miniatures/mini-page.png" xpath="page"/>
            <input img="xtk:miniatures/mini-condition.png" xpath="test"/>
            <input img="xtk:miniatures/mini-script.png" xpath="script"/>
            <input img="nms:miniatures/mini-query.png" xpath="query"/>
            <input img="nms:miniatures/mini-jump.png" xpath="jump"/>
          </container>
        </container>
        <container name="subforms" xpath=".">
          <form name="start" ref="xtk:formlib:subforms/start"/>
          <form name="next" ref="xtk:formlib:subforms/next"/>
          <form name="page" ref="xtk:formlib:subforms/page"/>
          <form name="test" ref="xtk:formlib:subforms/test"/>
          <form name="script" ref="xtk:formlib:subforms/script"/>
          <form name="query" ref="xtk:formlib:subforms/query"/>
          <form name="jump" ref="xtk:formlib:subforms/jump"/>
        </container>
        <container name="edition">
          <container type="iconbox">
            <container colcount="2" colspan="2" img="nms:detailview.png" label="Edit">
              <container type="visibleGroup" visibleIf="@type != 'descriptiveAnalysis' and [@targetReport-id] = 0">
                <container ref="xtk:formlib:design"/>
              </container>
              <container colcount="2" type="visibleGroup" visibleIf="[@targetReport-id]!=0">
                <container style="flat" type="notebook">
                  <container colcount="2" label="Edit">
                    <input xpath="@label"/>
                    <input xpath="@internalName"/>
                    <input colspan="2" label="Display schema" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                    <input colspan="2" xpath="@historyComputeString"/>
                    <input choiceType="xpath" colspan="2" nolabel="false" type="pathEdit" useUnboundPath="true" xpath="@link" xpathSchema="targetReport/@schema"/>
                    <input colspan="2" img="xtk:valuestats.png" label="Advanced condition..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath="linkFilter">
                      <form label="Filter condition">
                        <input choiceType="condition" nolabel="true" toolbarAlign="horizontal" type="conditionList" xpath="where" xpathExpr="@expr" xpathHelp="/@helpCond" xpathSchema="../@schema">
                          <input colSize="15" label=" " xpath="/@bool-operator"/>
                          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                          <input colSize="15" label="Operator" xpath="/@operator"/>
                          <input colSize="30" label="Value" xpath="/@rightExpr"/>
                          <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                        </input>
                        <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                      </form>
                    </input>
                    <static colspan="2" label="Information on the original report" type="separator"/>
                    <input boldLineExpr="@builtIn = 1" choiceButton="true" folderFilterChoice="@model = 'xtkReport'" form="xtk:report" img="xtk:report.png" label="Target report" type="linkedit" xpath="targetReport">
                      <sysFilter>
                        <condition expr="@isModel = 0"/>
                        <condition expr="[@targetReport-id] = 0"/>
                      </sysFilter>
                      <orderBy>
                        <node expr="@builtIn" sortDesc="true"/>
                        <node expr="@label"/>
                      </orderBy>
                    </input>
                    <input label="Display schema" readOnly="true" schema="xtk:schema" type="schemaEdit" xpath="targetReport/@schema"/>
                    <static colspan="2" label="Description" type="separator"/>
                    <input colspan="2" nolabel="true" xpath="desc"/>
                  </container>
                  <container ref="xtk:formlib:translations" visibleIf="@designLanguage != @defaultLanguage or NodeExists([additionalLanguages/language]) == true"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@type = 'descriptiveAnalysis'">
                <container style="flat" type="notebook">
                  <container label="Edit">
                    <container colcount="2">
                      <input xpath="@label"/>
                      <input xpath="@internalName"/>
                      <input label="Report title" xpath="activities/page/@label"/>
                      <input img="xtk:properties.png" label="Properties..." nolabel="false" prebuildSubForm="false" type="subFormLink">
                        <form label="Properties" name="properties" ref="xtk:formlib:properties"/>
                      </input>
                      <container colspan="2" xpath="activities/page/analysis/data">
                        <static label="Data" type="separator"/>
                        <input schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                        <container type="visibleGroup" visibleIf="@schema!=''">
                          <input img="xtk:valuestats.png" label="Filter data..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                            <form label="Advanced data source settings">
                              <input choiceType="sort" nolabel="true" toolbarAlign="horizontal" type="conditionList" xpath="where" xpathExpr="@expr" xpathHelp="/@helpCond" xpathSchema="@schema">
                                <input colSize="15" label=" " xpath="/@bool-operator"/>
                                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                                <input colSize="15" label="Operator" xpath="/@operator"/>
                                <input colSize="30" label="Value" xpath="/@rightExpr"/>
                              </input>
                              <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                            </form>
                          </input>
                          <input fontBold="true" type="help" xpath="where/@displayFilter"/>
                        </container>
                      </container>
                      <container colspan="2" type="visibleGroup" visibleIf="[activities/page/analysis/@model] = 'qualitative'" xpath="activities/page/analysis">
                        <static colspan="2" label="Display mode" type="separator"/>
                        <input xpath="@hasChart"/>
                        <input xpath="@hasTable"/>
                      </container>
                    </container>
                    <container type="notebook">
                      <container ref="xtk:formlib:pivot" visibleIf="@hasTable and @model = 'qualitative'" xpath="activities/page/analysis"/>
                      <container ref="xtk:formlib:distribution" visibleIf="@model = 'quantitative'" xpath="activities/page/analysis"/>
                      <container ref="xtk:formlib:graphStyleAndData" visibleIf="@model = 'qualitative' and @hasChart and @hasTable = false" xpath="activities/page/analysis"/>
                      <container img="xtk:valuestats.png" label="Chart" visibleIf="[activities/page/analysis/@model] = 'qualitative' and ([activities/page/analysis/@hasChart] and [activities/page/analysis/@hasTable])" xpath="activities/page/analysis">
                        <static label="Chart type" type="separator"/>
                        <container ref="xtk:formlib:graphStyle" xpath="chart"/>
                      </container>
                      <container img="xtk:function.png" label="Statistics" xpath="activities/page/analysis/data">
                        <container ref="xtk:formlib:statistic" xpath="statistic"/>
                      </container>
                    </container>
                  </container>
                  <container label="Export options" xpath="activities/page">
                    <container alwaysActive="true" filter="/page$" type="collectionItemGroup" xpathSelection="/ignored/tree/@xpathSelection">
                      <input nolabel="true" type="treeEdit">
                        <container label="Paper">
                          <input xpath="@paperOrientation"/>
                          <input xpath="@paperFormat"/>
                          <input xpath="@scalingMode"/>
                        </container>
                        <container label="Margins">
                          <input xpath="@marginTop"/>
                          <input xpath="@marginBottom"/>
                          <input xpath="@marginLeft"/>
                          <input xpath="@marginRight"/>
                        </container>
                      </input>
                    </container>
                  </container>
                  <container ref="xtk:formlib:translations" visibleIf="@designLanguage != @defaultLanguage or NodeExists([additionalLanguages/language]) == true"/>
                </container>
              </container>
            </container>
            <container colcount="2" label="View" maxLabelWidth="50">
              <static colspan="2" label="Access link" type="separator"/>
              <input xpath="@category"/>
              <input schema="xtk:image" type="linkedit" xpath="@img"/>
              <input colspan="2" nolabel="false" type="pathEdit" xpath="@labelExpr"/>
              <static colspan="2" label="Selection type" type="separator"/>
              <input xpath="@monoselection"/>
              <input xpath="@order"/>
              <input xpath="@multiselection"/>
              <input xpath="@prefered"/>
              <container colspan="2" type="visibleGroup" visibleIf="[@targetReport-id] = 0">
                <input xpath="@isGlobal"/>
              </container>
              <container colspan="2" xpath="visibleIf">
                <static label="Visibility" type="separator"/>
                <input label="Condition..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Visibility condition">
                    <input choiceType="condition" nolabel="true" toolbarAlign="horizontal" type="conditionList" xpath="." xpathExpr="@expr" xpathHelp="/@helpCond" xpathSchema="../@schema">
                      <input colSize="15" label=" " xpath="/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/@operator"/>
                      <input colSize="30" label="Value" xpath="/@rightExpr"/>
                      <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                    </input>
                    <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                    <leave>
                      <set expr="[/@helpCond]" xpath="@displayFilter"/>
                    </leave>
                  </form>
                </input>
                <container type="visibleGroup" visibleIf="@displayFilter!=''">
                  <input fontBold="true" label=" " lineCount="4" noBorder="true" readOnly="true" type="memo" xpath="@displayFilter"/>
                </container>
              </container>
              <static colspan="2" label="Access restriction" type="separator"/>
              <input colspan="2" useDesc="true" xpath="@shared"/>
              <container colspan="2" type="visibleGroup" visibleIf="@shared" xpath="rights">
                <input enumImage="operator/@type" img="xtk:operator.png" label="Authorizations" labelFormChoice="Please select an operator or a group" type="list" xpath="." xpathChoiceTarget="operator" xpathIndex="/tmp/columns/@current">
                  <input createMode="none" label="Operators or groups" noZoom="true" notifyPathList="@type" xpath="operator">
                    <orderBy>
                      <node expr="@type"/>
                    </orderBy>
                    <sysFilter>
                      <condition expr="@type != 2"/>
                    </sysFilter>
                  </input>
                </input>
              </container>
            </container>
            <container img="xtk:history.png" label="Histories" visibleIf="!(@isModel or @noHistory)">
              <input addButton="false" delButton="true" hideEditButtons="true" img="xtk:history.png" nolabel="true" toolbarCaption="Report history" type="linklist" xpath="history" zoom="true">
                <input colSize="30" xpath="@created"/>
                <input colSize="30" xpath="createdBy"/>
                <input colSize="30" xpath="@context"/>
                <orderBy>
                  <node expr="@created" sortDesc="true"/>
                </orderBy>
                <sysFilter>
                  <condition boolOperator="OR" expr="@entitySchema NOT LIKE 'xtk:report|' + '%'"/>
                  <condition expr="@entitySchema IS NULL"/>
                </sysFilter>
              </input>
            </container>
            <container img="xtk:logs.png" label="Log" visibleIf="!@isModel">
              <input addButton="false" delButton="true" hideEditButtons="true" img="xtk:logs.png" nolabel="true" toolbarCaption="Report history" type="linklist" xpath="log" zoom="false">
                <input colSize="30" xpath="@logDate"/>
                <input colSize="30" xpath="@message"/>
                <orderBy>
                  <node expr="@id" sortDesc="true"/>
                </orderBy>
              </input>
            </container>
          </container>
        </container>
      </container>
      <container type="visibleGroup" visibleIf="@adHocReport">
        <input sessionToken="true" type="urlViewer" urlExpr="$(serverUrl) + '/xtk/adHocReport.jssp?reportId=' + @id + '&amp;standalone=1'"/>
      </container>
      <container type="visibleGroup" visibleIf="!@adHocReport">
        <container type="visibleGroup" visibleIf="@isModel">
          <container ref="xtk:report:lib/edition"/>
        </container>
        <container type="visibleGroup" visibleIf="!@isModel">
          <container type="notebook">
            <container img="xtk:form.png" ref="xtk:report:lib/edition"/>
            <container img="xtk:preview.png" ref="xtk:formlib:preview" visibleIf="@id!=0"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="xtk:report32.png" label="Collect new strings" md5="7C06794A999E407F678F85B9F6BFA2AF" name="reportDictionaryCheck" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container desc="Click 'Start' to collect the strings to translate." name="Collecte des chanes  traduire" title="Collect new strings">
        <container refreshPeriod="1500" type="jobProgressContainer">
          <soapCall name="DictionaryCheck" service="xtk:report">
            <param type="DOMElement" xpath="/tmp/ctxForm/keys/where"/>
            <param type="DOMElement" xpathOut="/tmp/translationStats"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form editionMode="dialog" entity-schema="xtk:reportHistory" entitySchema="xtk:form" img="xtk:form.png" label="Report history" md5="8D63E7FF275EB4E1E945F284B3ED8192" name="reportHistory" namespace="xtk" xpathsToLoad="report/@internalName,@id" xtkschema="xtk:form">
      <enter>
        <set expr="$(serverUrl) + '/report/' + [report/@internalName] + '?_version=' + @id" xpath="/ignore/@url"/>
      </enter>
      <input sessionToken="true" type="urlViewer" urlExpr="[/ignore/@url]"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:report" entitySchema="xtk:form" img="xtk:form.png" label="Report" md5="3E4EDCF3808D98AD6C4F2FA34BB72ED2" name="reportProperties" namespace="xtk" xtkschema="xtk:form">
      <container type="notebook">
        <container ref="xtk:formlib:properties/form/notebook/general"/>
        <container ref="xtk:formlib:properties/form/notebook/localisation"/>
        <container ref="xtk:formlib:properties/form/notebook/rendering"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="xtk:report32.png" label="Publication wizard" md5="B5597BDCF6D4B22BDCDEB93A683786FA" name="reportPublishing" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container desc="Click 'Start' to launch publication." name="finish" title="Publication">
        <input label="Publication log" type="separator"/>
        <container refreshPeriod="1500" type="jobProgressContainer">
          <soapCall name="Publish" service="xtk:report">
            <param type="DOMElement" xpath="/tmp/ctxForm/keys/where"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:none" entitySchema="xtk:form" img="xtk:form.png" label="Generated code" md5="ADAEBF7FAF1A0CAFC2413ECD58F18B18" name="reportSourceCode" namespace="xtk" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <enter>
        <set value="web" xpath="/ignored/source/@target"/>
        <reset xpath="/ignored/source/@version"/>
        <reset xpath="/ignored/source/@compiled"/>
        <set value="web" xpath="/ignored/source/option/enum[1]/@name"/>
        <set value="Web" xpath="/ignored/source/option/enum[1]/@label"/>
        <set value="office" xpath="/ignored/source/option/enum[2]/@name"/>
        <set value="Office" xpath="/ignored/source/option/enum[2]/@label"/>
        <soapCall name="GetSource" service="xtk:report">
          <param exprIn="[/tmp/ctxForm/keys/key/@value]" type="string"/>
          <param exprIn="[/ignored/source/@target]" type="string"/>
          <param exprIn="[/ignored/source/@compiled]" type="boolean"/>
          <param exprIn="[/ignored/source/@version]" type="string"/>
          <param type="CDATA" xpathOut="/tmp/source/content"/>
          <param type="DOMElement" xpathOut="/tmp/source/logs"/>
        </soapCall>
      </enter>
      <container name="code">
        <container colcount="2">
          <input enumXPath="/ignored/source/option" label="Select the target" type="DynEnumCombo" xpath="/ignored/source/@target"/>
          <input checkedValue="1" label="Recover the compiled source code (JS)" type="checkBox" unCheckedValue="0" xpath="/ignored/source/@compiled"/>
        </container>
        <input img="xtk:refresh.png" label="Refresh the generated code" type="urlButton">
          <enter>
            <soapCall name="GetSource" service="xtk:report">
              <param exprIn="[/tmp/ctxForm/keys/key/@value]" type="string"/>
              <param exprIn="[/ignored/source/@target]" type="string"/>
              <param exprIn="[/ignored/source/@compiled]" type="boolean"/>
              <param exprIn="[/ignored/source/@version]" type="string"/>
              <param type="CDATA" xpathOut="/tmp/source/content"/>
              <param type="DOMElement" xpathOut="/tmp/source/logs"/>
            </soapCall>
          </enter>
        </input>
        <static/>
        <input contentType="JavaScript" nolabel="true" readOnly="true" type="CodeEdit" xpath="/tmp/source/content"/>
        <container type="visibleGroup" visibleIf="NodeCount([/tmp/source/logs/log]) > 0">
          <input lineCount="5" type="DocViewer" xpath="/tmp/source/logs" xslt="xtk:form/rendererLogs.xsl"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:filter32.png" label="Query editor" md5="DE14958308872DDE6473947834CFEB2C" name="requester" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Select the document type on which to perform a query." name="sourceInfos" title="Document type" xpath="dataTransferStep[1]">
        <enter>
          <if expr="[source/@schema]==''">
            <set value="nms:recipient" xpath="source/@schema"/>
          </if>
        </enter>
        <input dblClickAction="wizNext" label="Document type" monoSelection="true" schema="xtk:schema" setOnClick="true" type="schemaList" xpath="source/@schema" xpathStartPath="source/@startPath">
          <input xpath="[.]"/>
        </input>
        <leave>
          <check expr="[source/@schema] != ''">
            <error>You must specify a document type.</error>
          </check>
        </leave>
      </container>
      <container ref="xtk:exportSource:column" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:sort" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:filter" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:targetPage" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:conditionLink" visibleIf="[dataTransferStep/source/conditionLink/@xpath]!=''" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:group" visibleIf="[/tmp/selectCtrl/out/@group]" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:having" visibleIf="[/tmp/selectCtrl/out/@group]" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:mapping" visibleIf="true" xpath="dataTransferStep[1]"/>
      <container ref="xtk:exportSource:preview" xpath="dataTransferStep[1]"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="xtk:group" entitySchema="xtk:form" img="xtk:form.png" label="Named rights" md5="FE1A4D83FED3491AD664C49551589EC8" name="right" namespace="xtk" xtkschema="xtk:form">
      <input xpath="@label"/>
      <input xpath="@name"/>
      <input colspan="2" xpath="desc"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Content template" md5="E2C3524B3D2338B749D7F9039B7F1D80" name="schema" namespace="xtk" screen="SchemaEdit,CheckEdit" style="flat" type="notebook" xtkschema="xtk:form">
      <container label="Edit">
        <input nolabel="true" toolbar="true" toolbarAlign="horizontal" type="SourceEdit" xpath="."/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:sqlSchema" entitySchema="xtk:form" img="xtk:createdb.png" label="Add new fields" md5="2057A0AB4DB4BFD80C2DC1498579BCF4" name="schemaExtension" namespace="xtk" type="wizard" xtkschema="xtk:form">
      <container name="hidden" type="visibleGroup" visibleIf="false">
        <container desc="Please specify the properties of the field to add in the document type." name="fieldPage" title="Field properties">
          <enter>
            <set value="true" xpath="@user"/>
            <set value="string" xpath="@type"/>
            <set value="255" xpath="@length"/>
            <set value="shared" xpath="@featureType"/>
          </enter>
          <container colcount="2" label="General" type="frame">
            <input colspan="2" xpath="@exprType"/>
            <container colspan="2" type="visibleGroup" visibleIf="@exprType == 'sql'">
              <static type="help">A SQL field modifies the physical structure of the database and can be used for filtering or sorting.</static>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@exprType == 'calculatedSQL' or @exprType == 'calculatedXML'">
              <container type="visibleGroup" visibleIf="@exprType == 'calculatedSQL'">
                <static type="help">A SQL calculated field is an expression not saved in the database and recalculated each time it is used. A field of this type can be used for sorting or filtering. Non SQL fields are not allowed in the expression.</static>
              </container>
              <container type="visibleGroup" visibleIf="@exprType == 'calculatedXML'">
                <static type="help">An non-SQL calculated field is an expression not saved in the database and recomputed each time it is used. A field of this type cannot be used for sorting or filtering. All fields are allowed in the expression.</static>
              </container>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@exprType == 'xml'">
              <static type="help">A non SQL field does not modify the physical structure of the database since it is stored in the XML memo of the table it belongs to. It cannot be used for filtering or sorting.</static>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@exprType == 'feature'">
              <static type="help">A feature field enables you to move the content of the data item to a dedicated table.</static>
            </container>
            <input colspan="2" xpath="@label"/>
            <input colspan="2" xpath="@desc"/>
            <container colspan="2" type="visibleGroup" visibleIf="@exprType == 'sql'">
              <input computeType="sql" type="computePathEdit" xpath="@name" xpathRef="@relXPath,@type"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@exprType == 'calculatedSQL' or @exprType == 'calculatedXML'">
              <input nolabel="false" type="pathEdit" xpath="@expr" xpathSchema="/tmp/@schema" zoom="true"/>
            </container>
            <input xpath="@type"/>
            <container type="visibleGroup" visibleIf="@type=='string'">
              <input xpath="@length"/>
            </container>
            <container type="visibleGroup" visibleIf="@type!='string'">
              <static/>
            </container>
            <input colspan="2" computeType="path" type="computePathEdit" xpath="@relXPath" xpathRef="@label"/>
            <static colspan="2" type="help">Xpath of the field in its XML document (example: '@myField').</static>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@type == 'string' and @exprType != 'calculatedSQL' and @exprType != 'calculatedXML'">
            <container label="Constraints" type="frame">
              <container type="visiblegroup" visibleIf="@exprType != 'feature'">
                <input nolabel="false" type="pathEdit" xpath="@default" xpathSchema="/tmp/@schema" zoom="true"/>
              </container>
              <container type="visiblegroup" visibleIf="@type = 'string' and @exprType != 'feature'">
                <input xpath="@dataPolicy"/>
              </container>
              <container type="visiblegroup" visibleIf="@exprType != 'feature'">
                <input xpath="@required"/>
              </container>
              <input xpath="@advanced"/>
              <input xpath="@user"/>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@exprType = 'feature'">
            <container label="Properties of the feature" type="frame">
              <input xpath="@featureDate"/>
              <input xpath="@featureUnbound"/>
              <input checkedValue="shared" label="Content stored in a shared table" type="radioButton" xpath="@featureType"/>
              <input checkedValue="dedicated" label="Content stored in a dedicated table" type="radioButton" xpath="@featureType"/>
            </container>
          </container>
          <static colspan="2" label=" "/>
          <static colspan="2" label="Press 'Finish' to launch the creation of new the field." type="help"/>
          <leave>
            <check expr="@relXPath != ''">
              <error>You must specify the relative path.</error>
            </check>
            <check expr="@label != ''">
              <error>You must specify the label.</error>
            </check>
            <check expr="@exprType != 'calculatedSQL' or (@exprType == 'calculatedSQL' and @expr != '')">
              <error>You must specify the calculated field expression.</error>
            </check>
            <check expr="@exprType != 'calculatedXML' or (@exprType == 'calculatedXML' and @expr != '')">
              <error>You must specify the calculated field expression.</error>
            </check>
            <soapCall name="UpdateSchema" service="xtk:sqlSchema">
              <param exprIn="[/sqlSchema]" type="DOMElement"/>
            </soapCall>
          </leave>
        </container>
      </container>
      <container desc="Specify the document type in which you want to add one or more fields." name="sourceInfos" title="Document type" xpath="table[1]">
        <enter>
          <if expr="@hostSchema == ''">
            <set value="nms:recipient" xpath="@hostSchema"/>
          </if>
          <set expr="DefaultNameSpace()" xpath="/sqlSchema/@userNamespace"/>
        </enter>
        <container label="Document type to extend" type="frame">
          <input label="Document type" schema="xtk:schema" type="schemaEdit" xpath="@hostSchema"/>
        </container>
        <container label="Storage of extensions" type="frame">
          <input label="Namespace" type="edit" xpath="/sqlSchema/@userNamespace"/>
          <static type="help">Modifications are saved in the document type of this namespace having the same name as the document type to extend, so that
 your modifications are kept separate from the factory settings.</static>
        </container>
        <input label="Add multiple fields" type="checkbox" xpath="/tmp/@multiFields"/>
        <leave>
          <check expr="@hostSchema != ''">
            <error>You must specify a document type.</error>
          </check>
          <set expr="@hostSchema" xpath="/tmp/@schema"/>
        </leave>
      </container>
      <container name="fieldProp" ref="xtk:schemaExtension:hidden/fieldPage" visibleIf="![/tmp/@multiFields]" xpath="table[1]/field[1]"/>
      <container desc="Edit the list of fields to add." name="fieldsProp" title="Add fields" visibleIf="[/tmp/@multiFields]" xpath="table[1]">
        <input nolabel="true" toolbarAlign="horizontal" toolbarCaption="Fields to add" type="list" xpath="field" zoom="true" zoomOnAdd="true">
          <input xpath="@relXPath"/>
          <input xpath="@label"/>
          <input xpath="@type"/>
          <form label="Field properties">
            <container ref="xtk:schemaExtension:hidden/fieldPage"/>
          </form>
        </input>
        <static label=" "/>
        <static label="Press 'Finish' to launch the creation of new the fields." type="help"/>
        <leave>
          <soapCall name="UpdateSchema" service="xtk:sqlSchema">
            <param exprIn="[/sqlSchema]" type="DOMElement"/>
          </soapCall>
        </leave>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:schema" entitySchema="xtk:form" img="xtk:form.png" label="Schema view" md5="56DEDAA50C879F1248D9A249F52D2095" name="schemaView" namespace="xtk" nothingToEdit="true" xtkschema="xtk:form">
      <static img="xtk:preview.png" label="Detail of the document structure" type="separator"/>
      <container colcount="2">
        <static img="xtk:filter.png" type="image"/>
        <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/columns/@search"/>
      </container>
      <input nolabel="true" readOnly="true" type="schemaView" useUnboundPath="true" xpath="." xpathHelp="/@help" xpathSearchPath="/tmp/columns/@search"/>
      <input type="help" xpath="/@help"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Package definition" md5="F0C077C82147013BD963F7967762917B" name="specFile" namespace="xtk" xtkschema="xtk:form">
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container colcount="2" img="xtk:properties.png" label="General" name="general">
          <input xpath="@label"/>
          <input xpath="@name"/>
          <input xpath="@vendor"/>
          <static/>
          <container colspan="2" type="visibleGroup" visibleIf="nodeCount(definition)==0">
            <container label="Entities" type="frame">
              <static label="This package definition is empty" type="warning"/>
            </container>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="desc"/>
        </container>
        <container img="xtk:schema.png" label="Content" name="schemas">
          <input editFileXPath="/content/package" editable="false" img="xtk:schema.png" name="fullEdition" nolabel="true" nsEditXPath="/tmp/@filterNameSpace" toolbarCaption="List of entities to export" type="exportEntityList" xpath="definition" zoom="true" zoomOnAdd="true">
            <input label="Entity" xpath="@schema"/>
            <input label="Condition" xpath="where/@displayFilter"/>
            <input xpath="orderBy/@displayOrder"/>
            <form img="xtk:package32.png" label="Export entities" type="wizard">
              <container desc="Please populate the entity type to be exported." firstActivatedIf="count(where) == 0" maxLabelWidth="200" name="general" title="Entities to export">
                <container readOnlyIf="@automaticDefinition" type="readOnlyGroup">
                  <input dblClickAction="wizNext" label="Document type" monoSelection="true" schema="xtk:schema" setOnClick="true" type="schemaList" xpath="@schema">
                    <input xpath="[.]"/>
                  </input>
                  <input discardReadOnly="true" xpath="@lineCountMax"/>
                </container>
              </container>
              <container desc="Enter the filter condition to define the elements you wish to export." name="where" title="Filter">
                <container readOnlyIf="@automaticDefinition" type="readOnlyGroup">
                  <container buildQueryXPath="." ref="xtk:queryDef:where"/>
                </container>
              </container>
              <container desc="Specify the sort order of the exported data." name="orderBy" title="Sort">
                <container readOnlyIf="@automaticDefinition" type="readOnlyGroup">
                  <input name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                    <input colSize="20" xpath="@label"/>
                    <input choiceType="sort" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                    <input colSize="15" editable="true" xpath="@sortDesc"/>
                  </input>
                  <input type="help" xpath="/@help"/>
                </container>
              </container>
              <container desc="List of entities of this type to export." name="preview" title="Preview">
                <container readOnlyIf="@automaticDefinition" type="readOnlyGroup">
                  <input hideEditButtons="true" name="entityPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="." xpathSchema="@schema" xpathTargetPart="."/>
                </container>
              </container>
            </form>
          </input>
        </container>
        <container img="xtk:javascript.png" label="Script" name="javascript" visibleIf="@includeInstallScript">
          <static label="Editing the package installation script" type="separator"/>
          <input contentType="JavaScript" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="installScript"/>
        </container>
      </container>
      <container type="iconbox">
        <container ref="xtk:specFile:lib/general"/>
        <container colcount="2" img="xtk:schema.png" label="Entities" name="schemas">
          <container colcount="2" colspan="2" label="Entities" type="frame">
            <input label="Initialize package definition" type="SubFormButton">
              <form label="Initializing package definition">
                <enter>
                  <set value="0" xpath="@type"/>
                </enter>
                <static label="Select the package type"/>
                <input checkedValue="1" label="Platform package" type="radioButton" xpath="@type"/>
                <static margin-left="28" type="help">This package will contain technical configurations (schemas, forms, etc.).</static>
                <input checkedValue="2" label="Admin package" type="radioButton" xpath="@type"/>
                <static margin-left="28" type="help">This package will contain work configurations (delivery templates, campaigns, etc.).</static>
                <leave>
                  <if expr="@type!=0">
                    <set value="ok" xpath="/ignored/@eraseDef"/>
                    <if expr="nodeCount(definition)>0">
                      <msgBox translatedExpr="'The package definition \' isn't empty. Overwrite current definition?" type="okcancel" xpathOut="/ignored/@eraseDef"/>
                    </if>
                    <if expr="[/ignored/@eraseDef]='ok'">
                      <reset xpath="definition[*]"/>
                      <soapCall name="genDefinitions" service="xtk:specFile">
                        <param exprIn="@type" type="byte"/>
                        <param type="DOMDocument" xpathOut="/ignored/definitions"/>
                      </soapCall>
                      <copyElement list="true" xpathDst="." xpathSrc="/ignored/definitions/definition"/>
                    </if>
                  </if>
                  <set value="true" xpath="@doNotPersist"/>
                </leave>
              </form>
            </input>
            <input img="xtk:properties.png" label="Generation parameters..." type="subFormLink">
              <form label="Generation parameters">
                <input xpath="@includeSpec"/>
                <input xpath="@includeInstallScript"/>
                <input xpath="@includeDefaultValues"/>
              </form>
            </input>
          </container>
          <container colspan="2" ref="xtk:specFile:lib/schemas"/>
        </container>
        <container ref="xtk:specFile:lib/javascript"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" label="Scripts containing SQL commands" md5="5CA6E449C442E0B820D8C54629166C36" name="sql" namespace="xtk" screen="SchemaEdit" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input expr="@namespace='xtk' or @namespace='nl' or @namespace='nms' or @namespace='ncm' or  @namespace='crm'" type="expr" xpath="/tmp/@factory"/>
      <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@factory]">
        <container label="Warning" type="frame">
          <static type="warning">This is an application built-in object. It cannot be modified.</static>
        </container>
        <input contentType="sql" nolabel="true" readOnly="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="data"/>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="![/tmp/@factory]">
        <static label="Edit" type="separator"/>
        <input contentType="sql" nolabel="true" toolbar="true" toolbarAlign="horizontal" type="CodeEdit" xpath="data"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" label="Data schema" md5="ADF1ED114BB347C8090C72D16D11FCEA" name="srcSchema" namespace="xtk" screen="SchemaEdit,CheckEdit" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input xpath="@labelSingular"/>
      <input xpath="@desc"/>
      <input expr="@namespace='xtk' or @namespace='nl' or @namespace='nms' or @namespace='ncm' or  @namespace='crm'" type="expr" xpath="/tmp/@factory"/>
      <input expr="Iif(@name!='', Iif(@extendedSchema='', @namespace+':'+@name, @extendedSchema), '')" type="expr" xpath="/ignored/@schema"/>
      <container colspan="2" name="notebook" style="flat" type="notebook">
        <container label="Edit">
          <container type="visibleGroup" visibleIf="[/tmp/@factory]">
            <container label="Warning" type="frame">
              <static type="warning">The following is a factory-configured object of the application and should not be edited. To modify a factory-configured object, you must create an extension object in your own namespace.</static>
            </container>
            <input nolabel="true" readOnly="true" type="SourceEdit" xpath="."/>
          </container>
          <container type="visibleGroup" visibleIf="![/tmp/@factory]">
            <input addButtonResourceMenu="true" nolabel="true" toolbar="true" type="SourceEdit" xpath="."/>
          </container>
        </container>
        <container label="Preview">
          <static img="xtk:preview.png" label="Generated schema preview" type="separator"/>
          <input nolabel="true" readOnly="true" type="SchemaPreview" xpath="."/>
        </container>
        <container label="Structure" visibleIf="@library=false and @name!=''">
          <static img="xtk:preview.png" label="Structure of stored schema" type="separator"/>
          <input type="schemaview" xpath="/ignored/@schema"/>
        </container>
        <container label="Documentation">
          <input entityRefresh="xtk:srcSchema" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/xtk/schemaDocumentation.jssp?schema='+[/ignored/@schema]"/>
        </container>
        <container label="Data">
          <input hideEditButtons="true" nolabel="true" refresh="true" toolbarCaption="Table content" type="previewFilter" xpath="." xpathSchema="/ignored/@schema">
            <input xpath="[.]"/>
          </input>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:builder" entitySchema="xtk:form" img="xtk:form.png" label="Schema generation wizard" md5="0D2D315EB8130D36B0C4C0F37DCD0C19" name="srcSchemaDiscovery" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="view" xpath="/tmp/@type"/>
      </enter>
      <container applicableIf="HasPackage('nms:federatedDataAccess')" colcount="3" desc="Select the table discovery mode." img="xtk:createdb.png" name="cnxParams" title="Connection">
        <static colspan="3" img="xtk:sql.png" label="Existing table or SQL view (local database)" type="separator"/>
        <static/>
        <input checkedValue="view" label="Access data from an existing table or a SQL view" nolabel="true" type="radioButton" xpath="/tmp/@type"/>
        <static/>
        <static applicableIf="HasPackage('nms:federatedDataAccess')" colspan="3" img="nms:miniatures/mini-dbImport.png" label="Access to an external database (remote database)" type="separator"/>
        <static/>
        <input checkedValue="extView" label="Access external data" nolabel="true" type="radioButton" xpath="/tmp/@type"/>
        <static/>
        <static/>
        <container type="visibleGroup" visibleIf="[/tmp/@type]='extView'">
          <input computeStringAlias="/tmp/@extAccount-cs" createMode="none" img="nms:miniatures/mini-dbImport.png" label="External account" notifyPathList="@name|/tmp/@extAccount-name,@_cs|/tmp/@extAccount-cs" schema="nms:extAccount" type="linkEdit" xpath="/tmp/@extAccount-id">
            <sysFilter>
              <condition expr="@type = 7"/>
            </sysFilter>
          </input>
        </container>
        <static/>
        <leave>
          <check expr="[/tmp/@type]='view' OR [/tmp/@extAccount-name]!=''">
            <error>Please select the external account for accessing the tables.</error>
          </check>
        </leave>
      </container>
      <container colcount="2" desc="Specify the namespace used for creating schemas, then select the tables to be taken into account." img="xtk:createdb.png" name="tables" title="Select tables">
        <enter>
          <set expr="DefaultNameSpace()" xpath="@namespace"/>
          <soapCall name="BuildTableList" service="xtk:sqlSchema">
            <param exprIn="Iif([/tmp/@type]!='extView', 'default', 'nms:extAccount:'+[/tmp/@extAccount-name])" type="string"/>
            <param exprIn="'%' + [/tmp/extDb/@tableFilter] + '%'" type="string"/>
            <param type="DOMDocument" xpathOut="/tmp/extDb/tableList"/>
          </soapCall>
        </enter>
        <input colspan="2" type="computePathEdit" xpath="@namespace"/>
        <static colspan="2" label="Selection" type="separator"/>
        <input label="Filter" xpath="/tmp/extDb/@tableFilter"/>
        <input label="Filter" type="button">
          <enter>
            <soapCall name="BuildTableList" service="xtk:sqlSchema">
              <param exprIn="Iif([/tmp/@type]!='extView', 'default', 'nms:extAccount:'+[/tmp/@extAccount-name])" type="string"/>
              <param exprIn="'%' + [/tmp/extDb/@tableFilter] + '%'" type="string"/>
              <param type="DOMDocument" xpathOut="/tmp/extDb/tableList"/>
            </soapCall>
          </enter>
        </input>
        <input colspan="2" editable="false" entitySchema="xtk:sqlSchema" noToolbar="true" nolabel="true" type="list" xpath="/tmp/extDb/tableList/table">
          <input editable="true" label="To be generated" type="checkBox" xpath="@selected"/>
          <input label="Table name" xpath="@name"/>
          <input editable="true" label="Label (editable)" xpath="@label"/>
        </input>
        <leave>
          <check expr="@namespace != ''">
            <error>You must specify the namespace.</error>
          </check>
        </leave>
      </container>
      <container desc="Click 'Start' to launch schema generation for the selected tables." img="xtk:createdb.png" title="Generating schemas">
        <enter>
          <set value="true" xpath="@doNotPersist"/>
          <set expr="Iif([/tmp/@type]!='extView', 'default', 'nms:extAccount:'+[/tmp/@extAccount-name])" xpath="@cnx"/>
          <copyElement xpathDst="tableList" xpathSrc="/tmp/extDb/tableList"/>
        </enter>
        <container refreshPeriod="500" type="JobProgressContainer" xpathProperties="/properties">
          <soapCall name="BuildAndInstallSchemas" service="xtk:sqlSchema">
            <param exprIn="/@cnx" type="string"/>
            <param exprIn="/@namespace" type="string"/>
            <param exprIn="/tableList" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value type="ProgressBar" valign="center" xpathCur="/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:srcSchema" entitySchema="xtk:form" img="xtk:form.png" label="Creation of a data schema" md5="F69D77FA7F739D0BCD3930DE3EB3562D" name="srcSchemaWizard" namespace="xtk" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="table" xpath="/tmp/@type"/>
      </enter>
      <container colcount="3" desc="Select the schema type to create." img="xtk:createdb.png" name="choice" title="Schema type">
        <static colspan="3" img="xtk:adbnew.png" label="New table" type="separator"/>
        <static/>
        <input checkedValue="table" label="Create a new table in the data template" type="radioButton" xpath="/tmp/@type"/>
        <static/>
        <static colspan="3" img="xtk:sql.png" label="Existing table or SQL view" type="separator"/>
        <static/>
        <input checkedValue="view" label="Access data from an existing table or a SQL view" type="radioButton" xpath="/tmp/@type"/>
        <static/>
        <static applicableIf="HasPackage('nms:federatedDataAccess')" colspan="3" img="nms:miniatures/mini-dbImport.png" label="Access to an external database" type="separator"/>
        <static applicableIf="HasPackage('nms:federatedDataAccess')"/>
        <input applicableIf="HasPackage('nms:federatedDataAccess')" checkedValue="extView" label="Access external data" type="radioButton" xpath="/tmp/@type"/>
        <static applicableIf="HasPackage('nms:federatedDataAccess')"/>
        <static colspan="3" img="xtk:table.png" label="Extension of a schema" type="separator"/>
        <static/>
        <input checkedValue="extendedSchema" label="Extend the data in the table using an extension schema" type="radioButton" xpath="/tmp/@type"/>
        <static/>
        <static applicableIf="HasPackage('ncm:content')" colspan="3" img="ncm:content.png" label="Content schema" type="separator"/>
        <static applicableIf="HasPackage('ncm:content')"/>
        <input applicableIf="HasPackage('ncm:content')" checkedValue="content" label="Create a schema for content management" type="radioButton" xpath="/tmp/@type"/>
        <static applicableIf="HasPackage('ncm:content')"/>
        <static colspan="3" img="xtk:enum.png" label="Data library" type="separator"/>
        <static/>
        <input checkedValue="library" label="Create a schema containing only the data to be referenced" type="radioButton" xpath="/tmp/@type"/>
        <static/>
      </container>
      <container desc="Please specify the different parameters of the data schema." img="xtk:createdb.png" name="parameters" title="Schema parameters">
        <container type="visibleGroup" visibleIf="[/tmp/@type]=='extendedSchema'">
          <container label="Extension of a schema" type="frame">
            <input label="Schema" notifyPathList="@name, @label, @labelSingular, @desc, @img" schema="xtk:srcSchema" type="linkedit" xpath="@extendedSchema"/>
            <static label="Please specify the schema to extend in the edit zone." type="help"/>
          </container>
        </container>
        <container label="General parameters" type="frame">
          <input type="computePathEdit" xpath="@namespace"/>
          <input type="computePathEdit" xpath="@name"/>
          <input xpath="@label"/>
          <input xpath="@labelSingular"/>
          <input colspan="2" xpath="@desc"/>
          <container type="visibleGroup" visibleIf="[/tmp/@type] != 'library'">
            <input label="Image" schema="xtk:image" type="linkedit" xpath="@img"/>
          </container>
        </container>
        <container type="visibleGroup" visibleIf="[/tmp/@type]=='extView' OR [/tmp/@type]=='view'">
          <container label="Existing table or view" type="frame">
            <container type="visibleGroup" visibleIf="[/tmp/@type]=='extView'">
              <input computeStringAlias="/tmp/@extAccount-cs" img="nms:miniatures/mini-dbImport.png" label="External account" notifyPathList="@name|/tmp/@extAccount-name,@_cs|/tmp/@extAccount-cs" schema="nms:extAccount" type="linkEdit" xpath="/tmp/@extAccount-id">
                <sysFilter>
                  <condition expr="@type = 7"/>
                </sysFilter>
              </input>
            </container>
            <input label="Table name" type="edit" xpath="/tmp/@sqltable">
              <input img="xtk:choiceField.png" modeless="false" name="btnChoiceTable" prebuildSubForm="false" xpath=".">
                <enter name="onClick">
                  <soapCall name="BuildTableList" service="xtk:sqlSchema">
                    <param exprIn="Iif([/tmp/@type]!='extView', 'default', 'nms:extAccount:'+[/tmp/@extAccount-name])" type="string"/>
                    <param exprIn="'%' + [/tmp/extDb/@tableFilter] + '%'" type="string"/>
                    <param type="DOMDocument" xpathOut="/tmp/extDb/tableList"/>
                  </soapCall>
                </enter>
                <form colcount="2" label="Select the table">
                  <input label="Filter" xpath="/tmp/extDb/@tableFilter"/>
                  <input label="Filter" type="button">
                    <enter>
                      <soapCall name="BuildTableList" service="xtk:sqlSchema">
                        <param exprIn="Iif([/tmp/@type]!='extView', 'default', 'nms:extAccount:'+[/tmp/@extAccount-name])" type="string"/>
                        <param exprIn="'%' + [/tmp/extDb/@tableFilter] + '%'" type="string"/>
                        <param type="DOMDocument" xpathOut="/tmp/extDb/tableList"/>
                      </soapCall>
                    </enter>
                  </input>
                  <input colspan="2" dblClickAction="btnOk" editable="false" entitySchema="xtk:sqlSchema" noToolbar="true" nolabel="true" readOnly="true" type="list" xpath="/tmp/extDb/tableList/table" xpathSelection="/tmp/extDb/@tableName">
                    <input editable="false" label="Table name" xpath="@name"/>
                  </input>
                  <leave>
                    <set expr="NodeValue([/tmp/extDb/@tableName]+'/@name')" xpath="/tmp/@sqltable"/>
                  </leave>
                </form>
              </input>
            </input>
            <static/>
            <static type="help">Please enter the SQL name of the table or the view in the editing field. The internal name of the attribute or the element will take the value of the field's SQL name.</static>
            <input label="Remove the prefix linked to their type from the field names (ex. sText will become=&quot;Text&quot; in the schema)" type="checkBox" xpath="/tmp/@removePrefix"/>
            <input label="Mark all fields in the table as advanced fields (ex. advanced attribute=&quot;true&quot; in the schema)" type="checkBox" xpath="/tmp/@advanced"/>
          </container>
        </container>
        <leave>
          <check expr="@name != '' and @namespace != ''">
            <error>You must specify the namespace and the schema name.</error>
          </check>
          <check expr="[/tmp/@type] != 'extendedSchema' or ([/tmp/@type] == 'extendedSchema' and @extendedSchema != '')">
            <error>You must specify the extension schema.</error>
          </check>
          <check expr="[/tmp/@type] != 'view' or ([/tmp/@type] == 'view' and [/tmp/@sqltable] != '')">
            <error>You must specify the table name.</error>
          </check>
          <if expr="[/tmp/@type] == 'extView'">
            <check expr="[/tmp/@sqltable] != ''">
              <error>You must specify the table name.</error>
            </check>
            <set expr="'nms:extAccount:'+[/tmp/@extAccount-name]" xpath="@dataSource"/>
          </if>
          <soapCall name="GenerateSchema" service="xtk:builder">
            <param exprIn="[/tmp]" type="DOMElement"/>
            <param exprIn="." type="DOMElement"/>
            <param type="DOMDocument" xpathOut="."/>
          </soapCall>
        </leave>
      </container>
      <container colcount="2" desc="Please specify the different parameters of the new data schema." img="xtk:createdb.png" name="edition" title="Edit schema">
        <container ref="xtk:srcSchema:notebook"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" md5="F5A66B3CB7DEF836EEEDE1C17BFF949F" name="strings" namespace="xtk" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input expr="@namespace='xtk' or @namespace='nl' or @namespace='nms' or @namespace='ncm' or  @namespace='crm'" type="expr" xpath="/tmp/@factory"/>
      <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@factory]">
        <container label="Warning" type="frame">
          <static type="warning">This is an application built-in object. It cannot be modified.</static>
        </container>
      </container>
      <container colspan="2" readOnlyIf="[/tmp/@factory]" type="readOnlyGroup">
        <input nolabel="true" toolbarCaption="Messages" type="list" xpath="message">
          <input xpath="@name"/>
          <input xpath="@text"/>
        </input>
        <input nolabel="true" toolbarCaption="Errors" type="list" xpath="error">
          <input xpath="@name"/>
          <input xpath="@text"/>
        </input>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="ncm:generate32.png" label="Selecting the enumerations to be converted" md5="4132D8C83A5BF679C72BC6096782AC72" name="switchValuesAndAliases" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container desc="Select values to be converted into aliases." title="Select values" visibleIf="[/tmp/@commandType]=='ValuesToAliases'">
        <input schema="xtk:enumValue" type="linkListChoice" xpath="/tmp/webApp/webApp">
          <input label="Label" xpath="[.]"/>
          <sysFilter>
            <condition expr="[@enum-id] = $long(/tmp/ctxForm/keys/key/@value)"/>
            <condition expr="alias" setOperator="NOT EXISTS"/>
          </sysFilter>
        </input>
      </container>
      <container desc="Click Start to launch value conversion into aliases." title="Conversion start" visibleIf="[/tmp/@commandType]=='ValuesToAliases'">
        <enter>
          <set expr="[/tmp/ctxForm/keys/key/@value]" xpath="/tmp/linklist/data/@enum-id"/>
          <copyElement xpathDst="userArgs/selection" xpathSrc="/tmp/linklist/data"/>
        </enter>
        <container refreshPeriod="1500" type="jobProgressContainer">
          <soapCall name="SwitchValuesAndAliases" service="xtk:enum">
            <param exprIn="[/userArgs/selection]" type="DOMElement"/>
            <param exprIn="'ValuesToAliases'" type="string"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <container desc="Select aliases to be converted into values." title="Select aliases" visibleIf="[/tmp/@commandType]=='AliasesToValues'">
        <input schema="xtk:enumAlias" type="linkListChoice" xpath="/tmp/webApp/webApp">
          <input label="Alias" xpath="[.]"/>
          <input xpath="@hits"/>
          <orderBy>
            <node expr="[.]"/>
          </orderBy>
          <sysFilter>
            <condition expr="[@enum-id] = $long(/tmp/ctxForm/keys/key/@value)"/>
          </sysFilter>
        </input>
      </container>
      <container desc="Click Start to launch the conversion of aliases into values." title="Conversion start" visibleIf="[/tmp/@commandType]=='AliasesToValues'">
        <enter>
          <set expr="[/tmp/ctxForm/keys/key/@value]" xpath="/tmp/linklist/data/@enum-id"/>
          <copyElement xpathDst="userArgs/selection" xpathSrc="/tmp/linklist/data"/>
        </enter>
        <container refreshPeriod="1500" type="jobProgressContainer">
          <soapCall name="SwitchValuesAndAliases" service="xtk:enum">
            <param exprIn="[/userArgs/selection]" type="DOMElement"/>
            <param exprIn="'AliasesToValues'" type="string"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:workflowTask" entitySchema="xtk:form" img="xtk:activities/exec.png" label="Task approval" md5="8BDC99C5648314BDEA532E06391074CA" name="taskWizard" namespace="xtk" nothingToEdit="true" type="wizard" xpathsToLoad="@workflow-id,@taskIdentifier,responses/**" xtkschema="xtk:form">
      <container desc="Click 'Approve' to approve the task." name="validate" nextButtonLabel="Approve" title="Approve task">
        <enter>
          <soapCall name="GetValidationParameters" service="xtk:workflow">
            <param exprIn="[@workflow-id]" type="string"/>
            <param exprIn="@taskIdentifier" type="string"/>
            <param type="DOMElement" xpathOut="/ignored/parameters"/>
          </soapCall>
          <set value="" xpath="/ignored/@value"/>
        </enter>
        <static font-size="15" label="Message" type="separator"/>
        <value label="Date" xpath="@creationDate"/>
        <value xpath="@title"/>
        <input readOnly="true" type="dhtml" xpath="message"/>
        <container type="visibleGroup" visibleIf="[/ignored/parameters/@hasResponded]">
          <static type="help">You have already answered.</static>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/parameters/@isAssignee]=false">
          <static font-size="15" label="Answer" type="separator"/>
          <static type="help">You are not in the list of people assigned to this task.</static>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/parameters/@canReply] AND [/ignored/parameters/@hasResponded]=false">
          <static font-size="15" label="Answer" type="separator"/>
          <input label="Comments" type="memo" xpath="/ignored/comment"/>
          <input enumXPath="/ignored/parameters/options" label="Choice" type="DynEnum" xpath="/ignored/@value"/>
        </container>
      </container>
      <container name="done" title="You request has been saved" visibleIf="[/ignored/@value]!=''">
        <enter>
          <soapCall name="GetValidationParameters" service="xtk:workflow">
            <param exprIn="[@workflow-id]" type="string"/>
            <param exprIn="@taskIdentifier" type="string"/>
            <param type="DOMElement" xpathOut="/ignored/parameters"/>
          </soapCall>
          <if expr="[/ignored/parameters/@isAssignee] AND [/ignored/parameters/@hasResponded]=false AND [/ignored/parameters/@canReply]">
            <soapCall name="Reply" service="xtk:workflow">
              <param exprIn="[@workflow-id]" type="string"/>
              <param exprIn="@taskIdentifier" type="string"/>
              <param exprIn="[/ignored/comment]" type="string"/>
              <param exprIn="[/ignored/@value]" type="string"/>
            </soapCall>
          </if>
        </enter>
        <container type="visibleGroup" visibleIf="[/ignored/parameters/@hasResponded]">
          <static img="xtk:canceled.png" type="help">You have already answered.</static>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/parameters/@hasResponded]=false AND [/ignored/parameters/@canReply]=false">
          <static img="xtk:canceled.png" type="help">Someone else has already answered.</static>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/parameters/@isAssignee]=false">
          <static img="xtk:canceled.png" type="help">You are not in the list of people assigned to this task.</static>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/parameters/@isAssignee] AND [/ignored/parameters/@hasResponded]=false AND [/ignored/parameters/@canReply]">
          <static type="help">You request has been saved</static>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:sqlSchema" entitySchema="xtk:form" img="xtk:createdb.png" label="Database update wizard" md5="775EB29D60FB1E4966ABFC8968B2E8B3" name="updatedb" namespace="xtk" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <soapCall name="GetDbParams" service="xtk:builder">
          <param type="DOMElement" xpathOut="dbcnx"/>
          <param type="DOMElement" xpathOut="createdbParameters"/>
        </soapCall>
      </enter>
      <container desc="Please specify the parameters and click on 'Next' to start the auto-discovery process." name="parameters" title="Update parameters">
        <static label="This wizard helps you to upgrade the physical structure of the database you are currently connected to so that it is aligned with its logical description (as described by the source schemas)." type="help"/>
        <leave>
          <soapCall name="BuildUpdateSchemaDiff" service="xtk:builder">
            <param exprIn="." type="DOMElement"/>
            <param exprIn="[/tmp/@useNamingConventions]" type="boolean"/>
            <param type="DOMDocument" xpathOut="."/>
          </soapCall>
        </leave>
      </container>
      <container desc="Here are the tables for which the logical description does not match the physical structure." name="editTables" title="Edit tables">
        <input editable="false" enumImage="@diffStatus" noEditCollection="true" nolabel="true" toolbarCaption="List of tables" type="diffList" xpath="table" zoom="true">
          <input colSize="20" xpath="@name"/>
          <input colSize="10" editable="true" type="checkBox" xpath="@commitDiff"/>
          <input xpath="@label"/>
          <input xpath="@hostSchema"/>
          <form entity-schema="xtk:sqlSchema" label="Edit table" name="extensionTable" namespace="xtk">
            <container label="Table description" type="frame">
              <value fontBold="true" label="Table" xpath="@name"/>
              <container type="visibleGroup" visibleIf="@diffStatus != 'removed'">
                <value xpath="@label"/>
                <value xpath="@desc"/>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="@diffStatus = 'updated'">
              <input label="Recreate the table with its indexes, and re-import data" nolabel="true" xpath="@create"/>
            </container>
            <container name="hpaned" type="hpaned">
              <input editable="false" enumImage="@diffStatus" noEditCollection="true" noToolbar="false" nolabel="true" toolbarCaption="List of fields" type="diffList" xpath="field" zoom="false">
                <input colSize="20" xpath="@name"/>
                <input colSize="10" editable="true" type="checkBox" xpath="@commitDiff"/>
                <input xpath="@label"/>
                <input xpath="@type"/>
                <input colSize="10" xpath="@length"/>
                <input xpath="@oldType"/>
                <input colSize="10" xpath="@oldLength"/>
              </input>
              <input editable="false" enumImage="@diffStatus" noEditCollection="true" noToolbar="false" nolabel="true" toolbarCaption="List of indexes" type="diffList" xpath="dbindex" zoom="true">
                <input colSize="20" xpath="@name"/>
                <input colSize="10" editable="true" type="checkBox" xpath="@commitDiff"/>
                <input xpath="@unique"/>
                <form label="Edit index">
                  <input editable="false" img="xtk:tablelight.png" noEditCollection="true" noToolbar="false" nolabel="true" toolbarCaption="List of fields of the index" type="list" xpath="field" zoom="false">
                    <input colSize="20" xpath="@name"/>
                  </input>
                </form>
              </input>
            </container>
          </form>
        </input>
        <leave>
          <set expr="[createdbParameters/@dbName]" xpath="/ignored/@dbName"/>
          <soapCall name="GenUpdateDbDDL" service="xtk:builder">
            <param exprIn="." type="DOMElement"/>
            <param type="DOMElement" xpathOut="createdbParameters"/>
          </soapCall>
          <set expr="[/ignored/@dbName]" xpath="createdbParameters/@dbName"/>
        </leave>
      </container>
      <container desc="Preview of the SQL script which will update the physical database structure" name="previewSql" title="Update script" xpath="createdbParameters">
        <container type="visibleGroup" visibleIf="NodeCount(ddl)==1">
          <input contentType="sql" nolabel="true" toolbar="true" type="CodeEdit" xpath="ddl"/>
        </container>
        <container type="visibleGroup" visibleIf="NodeCount(ddl)>1">
          <container noToolbar="true" type="notebookList" xpath="ddl" xpath-label="@dataSource">
            <container>
              <input contentType="sql" nolabel="true" toolbar="true" type="CodeEdit" xpath="."/>
            </container>
          </container>
        </container>
      </container>
      <container desc="Press 'Start' to launch the database update." name="finish" title="Start database update">
        <enter>
          <set value="true" xpath="@doNotPersist"/>
        </enter>
        <container img="nl:serverOptions32.png" label="Connection settings" type="frame">
          <value enum="xtk:builder:creationProvider" fontBold="true" xpath="dbcnx/@provider"/>
          <value fontBold="true" xpath="dbcnx/@server"/>
          <value fontBold="true" xpath="createdbParameters/@dbName"/>
        </container>
        <container refreshPeriod="500" type="jobProgressContainer" xpathProperties="/properties">
          <soapCall name="UpdateDb" service="xtk:builder">
            <param exprIn="/" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
          <static fontBold="true" label="You have to disconnect and reconnect so that your modifications are taken into account." type="warning"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:queryDef" entitySchema="xtk:form" img="xtk:form.png" label="Distribution of values" md5="E0FA435214635AFA8B840DC62FC6A816" name="valueStats" namespace="xtk" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <value fontBold="true" label="Distribution of values on" xpath="/lookupPath/@label"/>
      <input createMode="none" noTransaction="true" schema="xtk:folder" type="linkEdit" xpath="/ignored/folderLink"/>
      <input type="lookupList" xpath="/lookupPath/@xpath"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:queryDef" entitySchema="xtk:form" img="xtk:form.png" label="Advanced filter" md5="90D7F9C394B04E12A131BE72C9EC8E4D" name="whereFilter" namespace="xtk" xtkschema="xtk:form">
      <container ref="xtk:queryDef:where"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:workflow" entitySchema="xtk:form" img="xtk:form.png" label="Campaign workflow" md5="AE5C35EBE8180D3A91C29761FE00CC2B" name="wkfAggregate" namespace="xtk" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="/ignored/@hidePalette"/>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="palette" ref="xtk:workflow:lib/palette"/>
        <container name="tabs" ref="xtk:workflow:lib/tabs"/>
        <container name="subforms" ref="xtk:workflow:lib/subforms"/>
        <container>
          <input xpath="folder"/>
        </container>
      </container>
      <container style="flat" type="notebook">
        <container label="Edit">
          <container ref="xtk:workflow:diagram"/>
        </container>
        <container label="Log" visibleIf="!@isModel">
          <container ref="xtk:workflow:log"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Workflow" md5="FCD49ADFCC39ACED6E3B2500DF6CFC7C" name="workflow" namespace="xtk" showIconsIf="!@isModel" type="iconbox" xtkschema="xtk:form">
      <enter>
        <set expr="''" xpath="/ignored/@writerSchema"/>
        <set expr="''" xpath="/ignored/@transitionSchema"/>
        <set expr="''" xpath="/ignored/@schema"/>
        <set expr="''" xpath="/ignored/@orgSchema"/>
        <set expr="''" xpath="/ignored/@targetExtension"/>
        <set expr="wkfUpdateSubWorkflow()" xpath="/ignored/@ignoredSchema"/>
        <set expr="wkfTargetSchema('*')" xpath="/ignored/@ignoredSchema"/>
        <set translatedExpr="'Dynamic link'" xpath="/ignored/@advancedJoinLinkLabel"/>
        <set translatedExpr="'All'" xpath="/ignored/@allLabel"/>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="palette">
          <container img="nms:miniatures/mini-union.png" label="Targeting" name="segmentation">
            <input img="nms:miniatures/mini-query.png" xpath="query"/>
            <input img="nms:miniatures/mini-prefill.png" xpath="readGroup"/>
            <input img="nms:miniatures/mini-union.png" xpath="union"/>
            <input img="nms:miniatures/mini-intersection.png" xpath="intersection"/>
            <input img="nms:miniatures/mini-exclusion.png" xpath="exclusion"/>
            <input img="nms:miniatures/mini-piechart.png" xpath="extract"/>
            <input img="nms:miniatures/mini-cells.png" label="Cells" xpath="extract">
              <enter>
                <set value="extractCells" xpath="@form"/>
                <set value="nms:activities/cells.png" xpath="@img"/>
                <set value="false" xpath="transitions/extractOutput/@enabled"/>
                <set value="true" xpath="transitions/done/@enabled"/>
                <set translatedExpr="Iif(@name!='extract','Cells ' + SubString(@name, StrLen('extract')),'Cells')" xpath="@label"/>
              </enter>
            </input>
            <input applicableIf="HasPackage('nms:interaction') OR HasPackage('nms:campaign')" img="nms:miniatures/mini-offerCells.png" label="Offers by cell" xpath="extract">
              <enter>
                <set value="offerCells" xpath="@form"/>
                <set value="nms:activities/offerCells.png" xpath="@img"/>
                <set value="false" xpath="transitions/extractOutput/@enabled"/>
                <set value="true" xpath="transitions/done/@enabled"/>
                <set translatedExpr="'Choice of offers by cell'" xpath="@label"/>
              </enter>
            </input>
            <input img="nms:miniatures/mini-survey.png" xpath="readSurvey"/>
            <input img="nms:miniatures/mini-predictive-extract.png" xpath="predictiveExtract"/>
            <input applicableIf="$(entityPath)=='/operation'" img="nms:miniatures/mini-deliveryOutline.png" xpath="deliveryOutline"/>
            <input img="nms:miniatures/mini-enrich.png" xpath="enrich"/>
            <input img="nms:miniatures/mini-schemaEdit.png" xpath="schemaEdit"/>
            <input img="nms:miniatures/mini-incremental.png" xpath="incremental"/>
            <input img="nms:miniatures/mini-offerSelection.png" xpath="offerSelection"/>
            <input img="nms:miniatures/mini-dedup.png" xpath="dedup"/>
            <input img="nms:miniatures/mini-changeAxis.png" xpath="changeAxis"/>
            <input img="nms:miniatures/mini-setService.png" xpath="setOfService"/>
            <input img="nms:miniatures/mini-group.png" xpath="saveGroup"/>
            <input applicableIf="HasPackage('nms:aamIntegration') and IsIMSLoggedIn()" img="nms:miniatures/mini-exportToAAM.png" xpath="exportToAAM"/>
            <input img="nms:miniatures/mini-writer.png" xpath="writer"/>
            <input applicableIf="HasPackage('crm:connectors')" img="crm:crm/dataMgt/crmConnector_16x16.png" xpath="crmConnectorDataMgt"/>
            <input applicableIf="HasPackage('crm:webex')" img="crm:webex/webex_16x16.png" xpath="crmWebex"/>
          </container>
          <container applicableIf="$(entityPath)=='/operation'" img="nms:miniatures/mini-delivery.png" label="Deliveries" name="delivery">
            <input img="nms:miniatures/mini-mail.png" label="Email delivery" xpath="deliveryEmail"/>
            <input img="nms:miniatures/mini-envelope.png" label="Direct mail delivery" xpath="deliveryPaper"/>
            <input img="nms:miniatures/mini-sms.png" label="Mobile delivery" xpath="deliveryMobile"/>
            <input img="nms:miniatures/mini-phone.png" label="Telephone delivery" xpath="deliveryPhone"/>
            <input img="nms:fax.png" label="Fax delivery" xpath="deliveryFax"/>
            <input img="nms:miniatures/mini-agency.png" label="Agency delivery" xpath="deliveryAgency"/>
            <input applicableIf="HasPackage('nms:social')" img="nms:miniatures/facebook.png" label="Facebook delivery" xpath="deliveryOperation">
              <enter>
                <set value="nms:activities/facebook.png" xpath="@img"/>
                <set value="20" xpath="@messageType"/>
              </enter>
            </input>
            <input applicableIf="HasPackage('nms:social')" img="nms:miniatures/twitter.png" label="Twitter delivery" xpath="deliveryOperation">
              <enter>
                <set value="nms:activities/twitter.png" xpath="@img"/>
                <set value="25" xpath="@messageType"/>
              </enter>
            </input>
            <input applicableIf="HasPackage('nms:mobileApp')" img="nms:ios.png" label="iOS delivery" xpath="deliveryOperation">
              <enter>
                <set value="nms:activities/ios.png" xpath="@img"/>
                <set value="41" xpath="@messageType"/>
              </enter>
            </input>
            <input applicableIf="HasPackage('nms:mobileApp')" img="nms:android.png" label="Android delivery" xpath="deliveryOperation">
              <enter>
                <set value="nms:activities/android.png" xpath="@img"/>
                <set value="42" xpath="@messageType"/>
              </enter>
            </input>
            <input img="nms:other.png" label="Other delivery" xpath="deliveryOther"/>
            <input img="nms:miniatures/mini-recurring.png" label="Recurring delivery" xpath="deliveryRecurring"/>
          </container>
          <container img="xtk:miniatures/mini-start.png" label="Flow Control" name="base">
            <input img="xtk:miniatures/mini-start.png" xpath="start"/>
            <input img="xtk:miniatures/mini-end.png" xpath="end"/>
            <input img="xtk:miniatures/mini-stop.png" xpath="stop"/>
            <input img="xtk:miniatures/mini-fork.png" xpath="fork"/>
            <input img="xtk:miniatures/mini-andjoin.png" xpath="andjoin"/>
            <input img="xtk:miniatures/mini-clock.png" xpath="schedule"/>
            <input img="xtk:miniatures/mini-condition.png" xpath="jstest"/>
            <input img="xtk:miniatures/mini-hourglass.png" xpath="wait"/>
            <input img="xtk:miniatures/mini-hourglass.png" xpath="timefilter"/>
            <input img="xtk:miniatures/mini-workflowjob.png" xpath="subworkflow"/>
            <input img="xtk:miniatures/mini-jump-1.png" xpath="jumpin"/>
            <input img="xtk:miniatures/mini-jump-1.png" xpath="jumpout"/>
            <input img="xtk:miniatures/mini-signal.png" xpath="signal"/>
            <input img="nms:miniatures/mini-validation.png" xpath="validation"/>
            <input img="nms:miniatures/mini-alert.png" xpath="alert"/>
            <input applicableIf="HasPackage('nms:mrm') and $(entityPath)=='/operation'" img="nms:miniatures/mini-task.png" xpath="task"/>
          </container>
          <container img="xtk:workflow16x16.png" label="Actions" name="tools">
            <input img="nms:miniatures/mini-delivery.png" xpath="delivery"/>
            <input img="nms:miniatures/mini-control-delivery.png" xpath="controlDelivery"/>
            <input img="nms:miniatures/mini-notification.png" xpath="notification"/>
            <input img="nms:miniatures/mini-localValidation.png" label="Local approval" xpath="localValidation"/>
            <input img="nms:miniatures/mini-content.png" xpath="content"/>
            <input applicableIf="HasPackage('nms:federatedDataAccess')" img="nms:miniatures/mini-dbImport.png" xpath="dbImport"/>
            <input applicableIf="HasPackage('nms:federatedDataAccess')" img="nms:miniatures/mini-soapImport.png" xpath="soapImport"/>
            <input img="nms:miniatures/mini-fileImport.png" xpath="fileImport"/>
            <input img="xtk:miniatures/mini-export.png" xpath="fileExport"/>
            <input img="xtk:miniatures/mini-execsql.png" xpath="sql"/>
            <input img="xtk:miniatures/mini-script.png" xpath="js"/>
            <input img="xtk:miniatures/mini-script.png" xpath="jsx"/>
            <input img="xtk:miniatures/mini-multiscript.png" xpath="multiscript"/>
            <input img="xtk:miniatures/mini-shell.png" xpath="extern"/>
            <input img="xtk:miniatures/mini-exec.png" xpath="nlmodule"/>
            <input img="xtk:miniatures/mini-import.png" xpath="import"/>
            <input img="xtk:miniatures/mini-export.png" xpath="export"/>
            <input applicableIf="HasPackage('crm:connectors')" img="crm:crm/mscrm/mscrm_logo_16x16.png" xpath="mscrmWorkflow"/>
            <input applicableIf="HasPackage('crm:connectors')" img="crm:crm/ood/ood_logo_16x16.png" xpath="oodWorkflow"/>
            <input applicableIf="HasPackage('crm:connectors')" img="crm:crm/sfdc/sfdc_logo_16x16.png" xpath="sfdcWorkflow"/>
            <input img="xtk:miniatures/mini-buildAggregate.png" xpath="buildAggregate"/>
          </container>
          <container applicableIf="$(entityPath)=='/workflow'" img="xtk:miniatures/mini-txt.png" label="Events" name="events">
            <input img="xtk:miniatures/mini-txt.png" xpath="directorywatcher"/>
            <input img="nms:miniatures/mini-ftp.png" xpath="fileTransfer"/>
            <input img="nms:miniatures/mini-http.png" xpath="httpTransfer"/>
            <input img="nms:miniatures/mini-inmail.png" xpath="inmail"/>
            <input img="nms:miniatures/mini-sms.png" xpath="inSms"/>
          </container>
        </container>
        <container name="tabs" xpath=".">
          <container colcount="2" img="xtk:properties.png" label="Advanced" name="advancedActivityPage" propagateConstraints="false">
            <input xpath="@name"/>
            <input hideImage="true" schema="xtk:image" type="linkedit" xpath="@img"/>
            <input xpath="@mask"/>
            <input xpath="@affinity"/>
            <input xpath="@maxExecutionTime"/>
            <input xpath="@collision"/>
            <input xpath="@timezone"/>
            <static/>
            <static colspan="2" label="Error management" type="separator"/>
            <input xpath="@onError"/>
            <static/>
            <container colspan="2" type="visibleGroup" visibleIf="@onError=1">
              <input xpath="@errorLimit"/>
              <static type="help">If the number of consecutive errors is not equal to zero, the process will be suspended after this number of consecutive errors.</static>
            </container>
            <static colspan="2" label="Initialization script" type="separator"/>
            <input colspan="2" nolabel="true" xpath="initScript">
              <container>
                <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
              </container>
            </input>
            <static colspan="2" label="Comment" type="separator"/>
            <input colspan="2" lineCount="4" nolabel="true" xpath="comment"/>
          </container>
          <container colcount="2" img="xtk:properties.png" label="Advanced" name="lightActivityPage" propagateConstraints="false">
            <input xpath="@name"/>
            <input hideImage="true" schema="xtk:image" type="linkedit" xpath="@img"/>
            <static colspan="2" label="Initialization script" type="separator"/>
            <input colspan="2" nolabel="true" xpath="initScript">
              <container>
                <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
              </container>
            </input>
            <static colspan="2" label="Comment" type="separator"/>
            <input colspan="2" lineCount="4" nolabel="true" xpath="comment"/>
          </container>
          <container img="xtk:miniatures/mini-clock.png" label="Expiration" name="timeoutsActivityPage" propagateConstraints="false">
            <input nolabel="true" toolbarCaption="Delayed events" type="list" xpath="transitions/timeout" zoom="true">
              <form>
                <container ref="xtk:workflow:lib/tabs/timeoutTransitionPage"/>
              </form>
              <input xpath="@label"/>
              <input xpath="@type"/>
              <input xpath="@delay"/>
              <input xpath="@date"/>
            </input>
          </container>
          <container img="xtk:miniatures/mini-clock.png" label="Schedule" name="planningActivityPage">
            <input nolabel="true" xpath="@usePeriod"/>
            <container type="visibleGroup" visibleIf="@usePeriod">
              <input nolabel="true" useDesc="true" xpath="@stopAfterFirst"/>
              <container img="nms:calendar-large.png" label="Execution schedule" type="frame">
                <input type="scheduler" xpath="period"/>
              </container>
            </container>
          </container>
          <container img="xtk:properties.png" label="Advanced" name="advancedTransitionPage">
            <input xpath="@name"/>
            <input xpath="@target"/>
            <input xpath="@enabled"/>
            <input xpath="comment"/>
          </container>
          <container img="xtk:properties.png" label="Advanced" name="advancedExtractOutputPage">
            <input xpath="@name"/>
            <input xpath="@target"/>
            <input readOnly="true" xpath="@enabled"/>
            <input xpath="@forExclusion"/>
            <input xpath="comment"/>
          </container>
          <container colcount="2" label="General" name="extractGene">
            <input colspan="2" xpath="@label"/>
            <container colspan="2" type="visibleGroup" visibleIf="@mainSet!=''">
              <input type="ExclusionMainSetEdit" xpath="@mainSet"/>
            </container>
            <container colspan="2">
              <static label="Filtering settings" type="separator"/>
              <input checkedValue="linkedData" label="Use data from the target and additional data" nolabel="false" type="radioButton" xpath="/ignored/@splitType"/>
              <input checkedValue="targetData" label="Use the additional data only" nolabel="false" type="radioButton" xpath="/ignored/@splitType"/>
              <input applicableIf="HasPackage('nms:federatedDataAccess')" checkedValue="extSharedData" label="Use external data" nolabel="false" type="radioButton" xpath="/ignored/@splitType"/>
              <container type="visibleGroup" visibleIf="[/ignored/@splitType]='linkedData'">
                <container ref="xtk:workflow:lib/tabs/schemaSelector"/>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/@splitType]='targetData'">
                <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="@schema"/>
              </container>
              <input expr="Iif([/ignored/@splitType]='targetData', [/ignored/@extractSource], NodeValue('@schema'))" type="expr" xpath="@schema"/>
              <input expr="Iif([/ignored/@splitType]='targetData', '', NodeValue('@recipientLink'))" type="expr" xpath="@recipientLink"/>
              <container applicableIf="HasPackage('nms:federatedDataAccess')" type="visibleGroup" visibleIf="[/ignored/@splitType]='extSharedData' OR [/ignored/@splitType]='externalData'">
                <input label="Targeting dimension" type="targetSchema" xpath="@schema" xpathLink="@recipientLink">
                  <form entity-schema="xtk:schema" label="Please select a document" name="entitySchema" namespace="xtk" nothingToSave="true">
                    <input monoSelection="true" notifyFolderKeyPath="" schema="xtk:schema" type="linkListChoice" xpath=".">
                      <input alias="@_cs" expr="[.]"/>
                      <input xpath="[.]"/>
                      <input xpath="@namespace"/>
                      <input xpath="@name"/>
                      <orderBy>
                        <node expr="@label"/>
                      </orderBy>
                    </input>
                  </form>
                </input>
                <input label="Filtering dimension" readOnly="true" type="targetSchemaLink" xpath="@schema" xpathLink="@recipientLink"/>
                <input img="xtk:xtklinkn.png" labelExpr="Iif(NodeCount([extension])==0, [/ignored/@strAddData], [/ignored/@strEditLinkedData])" nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <enter name="onClick">
                    <set expr="@schema" xpath="/tmp/selectCtrl/in/@schema"/>
                    <set value="1" xpath="/tmp/queryAdd/@dataTypeReadOnly"/>
                    <set value="1" xpath="/tmp/queryAdd/@reverseLink"/>
                    <set expr="[/ignored/@splitType]" xpath="/tmp/queryAdd/@dataType"/>
                  </enter>
                  <form label="Additional data" ref="xtk:workflow:lib/subforms/queryAdd" type="wizard"/>
                </input>
              </container>
            </container>
            <container colcount="2" colspan="2" xpath="transitions">
              <static colspan="2" label="Results" type="separator"/>
              <input colspan="2" xpath="../@alwaysExtractFromSource"/>
              <input colspan="2" xpath="../@concatenateSegmentCode"/>
              <input colspan="2" xpath="done/@enabled"/>
              <input expr="wkfTargetSchema(Iif([../@concatenateSegmentCode] and [done/@enabled], NodeValue('../@name'), NodeValue('../@name')), Iif([../@mainSet]='', '', 'src'))" type="expr" xpath="/ignored/@ignoredSchema"/>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[done/@enabled]">
                <input xpath="done/@label"/>
                <input xpath="done/@code"/>
              </container>
              <container type="visibleGroup" visibleIf="![../@alwaysExtractFromSource]">
                <input colspan="2" xpath="remainder/@enabled"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                  <input xpath="remainder/@code"/>
                </container>
                <static colspan="2" type="help">If this option is checked, a complementary subset will contain all remaining records.</static>
              </container>
            </container>
          </container>
          <container img="xtk:schema.png" label="Schema" name="schemaTransitionPage">
            <static fontBold="true" label="Data structure generated:"/>
            <container colcount="2">
              <static img="xtk:filter.png" type="image"/>
              <input catchReturnKey="true" label="Find" type="edit" xpath="/ignored/@transitionSearch"/>
            </container>
            <input type="schemaview" xpath="/ignored/@transitionSchema" xpathExpr="/ignored/@transitionExpr" xpathHelp="/ignored/selectCtrl/itn/@help" xpathSearchPath="/ignored/@transitionSearch"/>
            <input type="help" xpath="/ignored/selectCtrl/itn/@help"/>
          </container>
          <container colcount="2" img="nms:delayed.png" name="timeoutTransitionPage">
            <input xpath="@label"/>
            <input xpath="@name"/>
            <input xpath="@keepActive"/>
            <input xpath="@target"/>
            <input colspan="2" xpath="@type"/>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type=0">
              <input xpath="@delay"/>
              <static/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type=1 or @type=2">
              <input xpath="@delay"/>
              <input xpath="@date"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@type=3">
              <input menuId="workflowMenuBuilder" options="notJst" type="scriptEdit" xpath="script"/>
            </container>
            <input colspan="2" xpath="@enabled"/>
            <input colspan="2" xpath="comment"/>
          </container>
          <form name="timeout" ref="xtk:workflow:lib/subforms/timeoutContainer"/>
          <container colcount="2" img="nms:subset.png" label="Subset" name="filterTransitionPage">
            <input xpath="@label"/>
            <input xpath="@code"/>
            <container colcount="2" colspan="2" label="Select a subset" name="splitSelection" type="frame">
              <static colspan="2" label="Filtering of selected records" type="separator"/>
              <input checkedValue="false" colspan="2" label="Do not filter the inbound population" type="radioButton" xpath="filter/@enabled"/>
              <input checkedValue="true" label="Add a filtering condition on the inbound population" type="radioButton" xpath="filter/@enabled"/>
              <container enabledIf="[filter/@enabled]" type="enabledGroup">
                <input label="Edit..." type="subFormLink" xpath="filter">
                  <form label="Query" name="queryWizard" nothingToSave="true" type="wizard">
                    <enter>
                      <set value="1" xpath="/ignored/@currentFilterStack"/>
                      <set value="0" xpath="/ignored/@addFilter"/>
                      <set value="" xpath="/ignored/@filterName"/>
                      <set value="1" xpath="/ignored/@havingCond"/>
                      <if expr="[../@schemaOverride]==false">
                        <set expr="[../../../@schema]" xpath="../@schema"/>
                        <set expr="[../../../@recipientLink]" xpath="../@recipientLink"/>
                      </if>
                      <set expr="Iif(Substring([../@schema], 0, 4)=='temp' AND [../@recipientLink]=='', 1, 0)" xpath="/tmp/@useTempSchema"/>
                    </enter>
                    <container desc="Select the schema of the target items to  generate and the associated schema concerned by the filtering." firstActivatedIf="count(where) == 0" img="xtk:filter32.png" name="typePage" title="Targeting and filtering dimension">
                      <input xpath="../@schemaOverride"/>
                      <input expr="iif([../@schemaOverride], NodeValue('../@schema'), [../../../@schema])" type="expr" xpath="../@schema"/>
                      <input expr="iif([../@schemaOverride], NodeValue('../@recipientLink'), [../../../@recipientLink])" type="expr" xpath="../@recipientLink"/>
                      <container type="visibleGroup" visibleIf="![../@schemaOverride]">
                        <input label="Filtering dimension" readOnly="true" type="targetSchemaLink" xpath="../@schema" xpathLink="../@recipientLink"/>
                      </container>
                      <container type="visibleGroup" visibleIf="[../@schemaOverride]">
                        <input checkedValue="0" label="Database schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                        <input checkedValue="1" label="Temporary schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                        <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==0">
                          <input label="Targeting dimension" type="targetSchema" xpath="../@schema" xpathLink="../@recipientLink">
                            <form entity-schema="xtk:schema" label="Please select a document" name="entitySchema" namespace="xtk" nothingToSave="true">
                              <input monoSelection="true" notifyFolderKeyPath="" schema="xtk:schema" type="linkListChoice" xpath=".">
                                <input alias="@_cs" expr="[.]"/>
                                <input xpath="[.]"/>
                                <input xpath="@namespace"/>
                                <input xpath="@name"/>
                                <orderBy>
                                  <node expr="@label"/>
                                </orderBy>
                              </input>
                            </form>
                          </input>
                          <input label="Filtering dimension" type="targetSchemaLink" xpath="../@schema" xpathLink="../@recipientLink"/>
                        </container>
                        <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==1">
                          <input label="Schema" recurse="true" type="ExclusionMainSetEdit" xpath="/tmp/@srcDataSet" xpathActivityName="../../../@name"/>
                          <input expr="Iif([/tmp/@useTempSchema]=1 AND [/tmp/@srcDataSet]!='', wkfSchemaName([/tmp/@srcDataSet]), NodeValue('../@schema'))" type="expr" xpath="../@schema"/>
                        </container>
                      </container>
                      <static label="List of restriction filters" type="separator"/>
                      <input dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="../@schema" xpathWhere="where"/>
                    </container>
                    <container desc="Please enter the definition of the target element" enabledButtonLabelIf="[/ignored/@currentFilterStack] == true" img="xtk:filter32.png" name="targetPage" nextButtonLabel="Refine target >" nextPage="typePage" title="Target element">
                      <container type="visibleGroup" visibleIf="SubString([../@schema],0,5)!='temp:'">
                        <container name="targetPageFocus" style="flat" type="notebook">
                          <container label="Criteria">
                            <static label="Filter settings" type="separator"/>
                            <input propagateXPathToCtx="/ignored/@currentOrderId|/@currentOrderId" type="filterView" valuesContext="true" xpath="." xpathFilter="/ignored/@filterName" xpathQueryLabel="humanCond" xpathSchema="../@schema" xpathsContext="tmp/@segmentation"/>
                          </container>
                          <container label="Preview">
                            <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="/ignored/previewList" xpathSchema="../@schema" xpathTargetPart="."/>
                          </container>
                        </container>
                      </container>
                      <container type="visibleGroup" visibleIf="SubString([../@schema],0,5)='temp:'">
                        <static label="Filter settings" type="separator"/>
                        <input propagateXPathToCtx="/ignored/@currentOrderId|/@currentOrderId" type="filterView" valuesContext="true" xpath="." xpathFilter="/ignored/@filterName" xpathQueryLabel="humanCond" xpathSchema="../@schema" xpathsContext="tmp/@segmentation"/>
                      </container>
                      <leave>
                        <set value="1" xpath="/ignored/@addFilter"/>
                        <set value="" xpath="/ignored/@filterName"/>
                        <set translatedExpr="'Query: '+humanCond" xpath="humanCond"/>
                      </leave>
                    </container>
                  </form>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[filter/@enabled]" xpath="filter">
                <input fontBold="true" label=" " noBorder="true" readOnly="true" type="memo" xpath="humanCond"/>
              </container>
              <container colcount="2" colspan="2">
                <static colspan="2" label="Record count limitation" type="separator"/>
                <input checkedValue="false" colspan="2" label="Do not limit the number of records" type="radioButton" xpath="limiter/@enabled"/>
                <input checkedValue="true" label="Limit the selected records" type="radioButton" xpath="limiter/@enabled"/>
                <container enabledIf="[limiter/@enabled]" type="enabledGroup">
                  <input label="Edit..." type="subFormLink" xpath="limiter">
                    <form label="Record count limitation" name="limitWizard" nothingToSave="true" type="wizard">
                      <enter>
                        <if expr="@type=''">
                          <set value="percent" xpath="@type"/>
                        </if>
                      </enter>
                      <container desc="Select the required limitation type." img="nms:pictoprofile.png" name="typePage" title="Type of limit">
                        <enter>
                          <if expr="!(@order or @random)">
                            <set value="true" xpath="@random"/>
                          </if>
                          <set expr="Iif(@random, Iif(@order, 2, 0), 1)" xpath="/tmp/extract/@subSetSelection"/>
                        </enter>
                        <input checkedValue="0" label="Activate random sampling" type="radioButton" xpath="/tmp/extract/@subSetSelection"/>
                        <input checkedValue="1" label="Keep only the first records after sorting" type="radioButton" xpath="/tmp/extract/@subSetSelection"/>
                        <input checkedValue="2" label="Keep the first ones after sorting (criteria, random)" type="radioButton" xpath="/tmp/extract/@subSetSelection"/>
                        <input expr="Iif([/tmp/extract/@subSetSelection]=0 OR [/tmp/extract/@subSetSelection]=2, true, false)" type="expr" xpath="@random"/>
                        <input expr="Iif([/tmp/extract/@subSetSelection]=1 OR [/tmp/extract/@subSetSelection]=2, true, false)" type="expr" xpath="@order"/>
                      </container>
                      <container desc="Select the sort order for the selected records" img="nms:pictoprofile.png" name="orderPage" title="Sorting" visibleIf="@order">
                        <container ref="xtk:workflow:lib/tabs/schemaSelector" xpath="../../.."/>
                        <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" xpathSchema="../../../@schema" zoom="false">
                          <input colSize="20" xpath="@label"/>
                          <input choiceType="sortAggregate" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathRecipientLink="../../../../../@recipientLink" xpathSchema="../../../../../@schema"/>
                          <input colSize="15" editable="true" xpath="@sortDesc"/>
                        </input>
                        <input type="help" xpath="/@help"/>
                      </container>
                      <container colcount="2" desc="Select the data limitation values." img="nms:pictoprofile.png" name="limitPage" title="Limits">
                        <input checkedValue="percent" label="Size (in %)" nolabel="true" type="RadioButton" xpath="@type"/>
                        <container type="visibleGroup" visibleIf="@type='percent'">
                          <input nolabel="true" xpath="@percent"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@type!='percent'">
                          <static/>
                        </container>
                        <input checkedValue="segmentPercent" label="Size (as a % of the segment)" nolabel="true" type="RadioButton" xpath="@type"/>
                        <container type="visibleGroup" visibleIf="@type='segmentPercent'">
                          <input nolabel="true" xpath="@percent"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@type!='segmentPercent'">
                          <static/>
                        </container>
                        <input checkedValue="number" label="Maximum size" nolabel="true" type="RadioButton" xpath="@type"/>
                        <container type="visibleGroup" visibleIf="@type='number'">
                          <input nolabel="true" xpath="@number"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@type!='number'">
                          <static/>
                        </container>
                        <input checkedValue="grouped" colspan="2" label="By data grouping" nolabel="true" type="RadioButton" xpath="@type"/>
                        <input checkedValue="groupedPercent" colspan="2" label="By data grouping (as a %)" nolabel="true" type="RadioButton" xpath="@type"/>
                        <container colspan="2" type="visibleGroup" visibleIf="@type='grouped' OR @type='groupedPercent'">
                          <static label="Click 'Next' to enter the additional information." type="help"/>
                        </container>
                        <container colcount="2" colspan="2">
                          <input applicableIf="HasPackage('nms:centralLocal')" checkedValue="distribution" label="By data distribution " nolabel="true" type="RadioButton" xpath="@type"/>
                          <container applicableIf="HasPackage('nms:centralLocal')" type="visibleGroup" visibleIf="@type='distribution'">
                            <input createMode="none" nolabel="true" notifyPathList="@distributionXPath|../@distributionXPath,@type|../@distributionType,@targetSchema|/ignored/distribution/@targetSchema" xpath="localDistribution" zoom="true">
                              <sysFilter>
                                <condition expr="@targetSchema=$(../../../@schema)"/>
                              </sysFilter>
                            </input>
                          </container>
                          <container applicableIf="HasPackage('nms:centralLocal')" type="visibleGroup" visibleIf="@type!='distribution'">
                            <static/>
                          </container>
                        </container>
                      </container>
                      <container desc="Select the data to group." img="nms:pictoprofile.png" name="groupPage" title="Data grouping" visibleIf="@type='grouped' OR @type='groupedPercent'">
                        <input editable="false" name="groupList" nolabel="true" toolbarCaption="Group the data" type="groupByList" xpath="groupBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/groupBy" xpathSchema="../../../@schema" zoom="false">
                          <input colSize="20" xpath="@label"/>
                          <input choiceType="group" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../../../../@schema"/>
                        </input>
                      </container>
                      <container desc="Select the data grouping by limitation values" img="nms:pictoprofile.png" name="groupPageLimit" title="Data grouping" visibleIf="@type='grouped' OR @type='groupedPercent'">
                        <input checkedValue="false" label="All data groupings are the same size" type="RadioButton" xpath="@enableGroupByLimit"/>
                        <input checkedValue="true" label="Limitations by grouping value" type="RadioButton" xpath="@enableGroupByLimit"/>
                        <container type="visibleGroup" visibleIf="@enableGroupByLimit">
                          <input nolabel="true" type="EnumEditList" xpath="groupByLimit" xpathSchema="../../../@schema" xpathType="groupBy/node[1]/@expr">
                            <input xpath="@grpValue"/>
                            <input xpath="@limit"/>
                            <input hidden="true" xpath="@label"/>
                          </input>
                          <container colcount="2">
                            <static label="Otherwise use the following value:"/>
                            <input nolabel="true" xpath="@defaultLimit"/>
                          </container>
                        </container>
                        <container type="visibleGroup" visibleIf="@enableGroupByLimit==false">
                          <container colcount="2">
                            <static/>
                            <input label="Value" xpath="@defaultLimit"/>
                          </container>
                        </container>
                      </container>
                      <leave>
                        <if expr="HasPackage('nms:centralLocal')">
                          <check expr="@type != 'distribution' or (@type == 'distribution' and [@localDistribution-id] != 0)">
                            <error>You must specify a distribution template.</error>
                          </check>
                        </if>
                        <if expr="@order and @random">
                          <set translatedExpr="'Order by '+[orderBy/@displayOrder]+' and random sampling,'" xpath="/ignored/@limiterType"/>
                        </if>
                        <if expr="@order and @random==false">
                          <set translatedExpr="'Order by '+[orderBy/@displayOrder]" xpath="/ignored/@limiterType"/>
                        </if>
                        <if expr="@random and @order==false">
                          <set translatedExpr="'Random sampling'" xpath="/ignored/@limiterType"/>
                        </if>
                        <if expr="@type == 'percent'">
                          <set translatedExpr="[/ignored/@limiterType]+' limited to '+@percent+' %'" xpath="humanCond"/>
                        </if>
                        <if expr="@type == 'segmentPercent'">
                          <set translatedExpr="[/ignored/@limiterType]+' limited to '+@percent+' % of the segment'" xpath="humanCond"/>
                        </if>
                        <if expr="@type == 'number'">
                          <set translatedExpr="[/ignored/@limiterType]+' limited to '+@number" xpath="humanCond"/>
                        </if>
                        <if expr="@type == 'grouped' OR @type == 'groupedPercent'">
                          <set translatedExpr="[/ignored/@limiterType]+' with limit by data grouping \''+[groupBy/@displayGroup]+'\''" xpath="humanCond"/>
                        </if>
                        <if expr="@type == 'distribution'">
                          <set translatedExpr="[/ignored/@limiterType]+' with limit by data grouping \''+[@localDistribution-cs]+'\''" xpath="humanCond"/>
                        </if>
                      </leave>
                    </form>
                  </input>
                </container>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[limiter/@enabled]" xpath="limiter">
                <input fontBold="true" label=" " noBorder="true" readOnly="true" type="memo" xpath="humanCond"/>
              </container>
            </container>
          </container>
          <container name="advancedQueryParams">
            <input hideCalculated="true" hideMappedAsXml="true" label="Link used to identify recipients" nolabel="false" type="pathEdit" useLink11Path="true" xpath="@recipientLink"/>
            <static type="help">If the link is specified, generates a population made of documents pointed to by the link (the query fetches foreign keys of the link, not the primary keys of the document type used by the query).</static>
          </container>
          <container name="schemaSelector">
            <container type="visibleGroup" visibleIf="[/tmp/@acceptTempSchema]==1">
              <input checkedValue="0" label="Database schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
              <input checkedValue="1" label="Temporary schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]!=1">
              <input label="Targeting dimension" type="targetSchema" xpath="@schema" xpathLink="@recipientLink">
                <form entity-schema="xtk:schema" label="Please select a document" name="entitySchema" namespace="xtk" nothingToSave="true">
                  <input monoSelection="true" notifyFolderKeyPath="" schema="xtk:schema" type="linkListChoice" xpath=".">
                    <input alias="@_cs" expr="[.]"/>
                    <input xpath="[.]"/>
                    <input xpath="@namespace"/>
                    <input xpath="@name"/>
                    <orderBy>
                      <node expr="@label"/>
                    </orderBy>
                  </input>
                </form>
              </input>
              <input label="Filtering dimension" type="targetSchemaLink" xpath="@schema" xpathLink="@recipientLink"/>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==1">
              <input label="Schema" recurse="true" type="ExclusionMainSetEdit" xpath="/tmp/@srcDataSet" xpathActivityName="@name"/>
              <input expr="Iif([/tmp/@useTempSchema]=1, wkfSchemaName([/tmp/@srcDataSet]), NodeValue('@schema'))" type="expr" xpath="@schema"/>
            </container>
          </container>
          <form alwaysActiveFirstPage="true" label="Query" name="queryWizard" nothingToSave="true" type="wizard">
            <enter>
              <if expr="@schema==''">
                <set value="nms:recipient" xpath="@schema"/>
              </if>
              <set expr="@schema" xpath="/ignored/@schema"/>
              <set value="" xpath="/ignored/@filterName"/>
              <set value="1" xpath="/ignored/@currentFilterStack"/>
              <set value="0" xpath="/ignored/@addFilter"/>
              <set value="1" xpath="/ignored/@havingCond"/>
              <set expr="Iif(wkfSourceActivity(@name)!='', 1, 0)" xpath="/tmp/@acceptTempSchema"/>
              <set value="0" xpath="/tmp/@useTempSchema"/>
            </enter>
            <container desc="Select the schema of the target items to  generate and the associated schema concerned by the filtering." firstActivatedIf="count(where) == 0" img="xtk:filter32.png" name="typePage" title="Targeting and filtering dimension">
              <container ref="xtk:workflow:lib/tabs/schemaSelector"/>
              <static label="List of restriction filters" type="separator"/>
              <input dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="@schema" xpathWhere="where"/>
            </container>
            <container desc="Specify the filtering conditions used to select the records" enabledButtonLabelIf="[/ignored/@currentFilterStack] == true" img="xtk:filter32.png" name="targetPage" nextButtonLabel="Refine target >" nextPage="typePage" title="Filter">
              <container name="targetPageFocus" style="flat" type="notebook">
                <container label="Criteria">
                  <input xpath="@label"/>
                  <static label="Filter settings" type="separator"/>
                  <input propagateXPathToCtx="/ignored/@currentOrderId|/@currentOrderId" type="filterView" valuesContext="true" xpath="." xpathFilter="/ignored/@filterName" xpathLabel="@label" xpathQueryLabel="humanCond" xpathSchema="@schema" xpathsContext="tmp/@segmentation"/>
                </container>
                <container label="Preview">
                  <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="/ignored/previewList" xpathTargetPart="."/>
                </container>
              </container>
              <leave>
                <set value="1" xpath="/ignored/@addFilter"/>
                <set value="" xpath="/ignored/@filterName"/>
              </leave>
            </container>
            <leave>
              <set expr="Iif([@recipientLink]='' and SubString(@schema, 0, 5)='temp:', true, false)" xpath="@useSource"/>
            </leave>
          </form>
          <container label="Historization settings" name="fileHistory">
            <container label="Storage directory" type="frame">
              <input xpath="@useDefault"/>
              <container type="visibleGroup" visibleIf="!@useDefault">
                <input xpath="@tmpDirectory"/>
              </container>
            </container>
            <container label="Purge settings" type="frame">
              <input xpath="@maxFiles"/>
              <input xpath="@maxSizeMo"/>
            </container>
          </container>
          <container name="colSelector" style="flat" type="notebook">
            <container label="Data" name="data">
              <container hideUnboundPath="false" name="selectCtrl" showCollections="true" type="querySelectContainer" xpath=".">
                <container name="vpaned" type="vpaned">
                  <container name="schema">
                    <static fontBold="true" label="Available fields:"/>
                    <container colcount="2">
                      <static img="xtk:filter.png" type="image"/>
                      <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                    </container>
                    <input checkDuplicates="false" hideMappedAsXml="true" name="schemaView" type="SchemaView" useUnboundPath="true" xpath="/tmp/selectCtrl/in/@schema" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="select/node/@expr" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                  </container>
                  <container name="output" xpathsToLoad="output*">
                    <static fontBold="true" label="Output columns:"/>
                    <input alwaysActive="true" expr="Iif([/tmp/outputColumn/itn/@current]=='' OR NodeValue([/tmp/outputColumn/itn/@current] + '/../@expr')=='', '', '/'+ UnExpandXPath(NodeValue([/tmp/outputColumn/itn/@current] + '/../@expr')))" type="expr" xpath="/tmp/outputColumn/in/@startPath"/>
                    <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" useTreeView="true" xpath="select/node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupBy="groupBy/node" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHaving="having/condition" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="/tmp/selectCtrl/in/@schema" xpathSelection="/tmp/outputColumn/itn/@current" zoom="false">
                      <input colSize="20" xpath="@label"/>
                      <input colSize="35" type="pathedit" useUnboundPath="true" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/selectCtrl/in/@schema" xpathStartPath="/tmp/outputColumn/in/@startPath"/>
                      <input colSize="20" xpath="@alias"/>
                      <input colSize="20" xpath="@groupBy"/>
                      <input colSize="35" label="Enabled if" type="pathedit" useUnboundPath="true" xpath="@enabledIf" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/selectCtrl/in/@schema" xpathStartPath="/tmp/outputColumn/in/@startPath"/>
                      <form label="Column definition" name="colDetail">
                        <input xpath="@label"/>
                        <container name="extraFields"/>
                        <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                        <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                          <container colcount="2" cols-width="100,1">
                            <container>
                              <static fontBold="true" label="Available fields:"/>
                              <container colcount="2">
                                <static img="xtk:filter.png" type="image"/>
                                <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                              </container>
                              <input type="schemaview" xpath="/tmp/selectCtrl/in/@schema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                            </container>
                            <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                          </container>
                          <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                        </container>
                        <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                      </form>
                    </input>
                    <input img="xtk:properties.png" label="Advanced parameters..." type="subFormLink" xpath=".">
                      <form label="Advanced parameters">
                        <enter>
                          <if expr="NodeName([.])='query' OR NodeName([.])='incremental' OR NodeName([.])='dbImport'">
                            <set expr="@noAutoPk" xpath="/tmp/@noAutoPk"/>
                            <set expr="@noAutoPkFilter" xpath="/tmp/@noAutoPkFilter"/>
                          </if>
                          <if expr="NodeName([.])='query'">
                            <set expr="@useSource" xpath="/tmp/@useSource"/>
                          </if>
                          <if expr="NodeName([.])='enrich' OR NodeName([.])='changeAxis'">
                            <set expr="@noAutoPkFilter" xpath="/tmp/@noAutoPkFilter"/>
                          </if>
                          <if expr="NodeName([.])='enrich'">
                            <set expr="@addAutoPk" xpath="/tmp/@addAutoPk"/>
                          </if>
                        </enter>
                        <container type="visibleGroup" visibleIf="NodeName([.])!='enrich' AND NodeName([.])!='changeAxis' AND NodeName([.])!='dedup'">
                          <input xpath="@keepAllExtraData"/>
                        </container>
                        <input xpath="@groupBy"/>
                        <input xpath="@distinct"/>
                        <container type="visibleGroup" visibleIf="NodeName([.])='query' OR NodeName([.])='incremental' OR NodeName([.])='dbImport'">
                          <input label="Disable automatic adding of the primary keys of the targeting dimension" type="checkbox" xpath="/tmp/@noAutoPk"/>
                          <input label="Disable automatic filtering of 0 ID records" type="checkbox" xpath="/tmp/@noAutoPkFilter"/>
                        </container>
                        <container type="visibleGroup" visibleIf="NodeName([.])='query'">
                          <input label="Use inbound event data" type="checkbox" xpath="/tmp/@useSource"/>
                        </container>
                        <container type="visibleGroup" visibleIf="NodeName([.])='enrich' OR NodeName([.])='changeAxis'">
                          <input label="Disable automatic filtering of 0 ID records" type="checkbox" xpath="/tmp/@noAutoPkFilter"/>
                        </container>
                        <container type="visibleGroup" visibleIf="NodeName([.])='enrich'">
                          <input label="Add an identifier for each line of the result." type="checkbox" xpath="/tmp/@addAutoPk"/>
                        </container>
                        <leave>
                          <if expr="NodeName([.])='query' OR NodeName([.])='incremental' OR NodeName([.])='dbImport'">
                            <set expr="[/tmp/@noAutoPk]" xpath="@noAutoPk"/>
                            <set expr="[/tmp/@noAutoPkFilter]" xpath="@noAutoPkFilter"/>
                          </if>
                          <if expr="NodeName([.])='query'">
                            <set expr="[/tmp/@useSource]" xpath="@useSource"/>
                          </if>
                          <if expr="NodeName([.])='enrich' OR NodeName([.])='changeAxis'">
                            <set expr="[/tmp/@noAutoPkFilter]" xpath="@noAutoPkFilter"/>
                          </if>
                          <if expr="NodeName([.])='enrich'">
                            <set expr="[/tmp/@addAutoPk]" xpath="@addAutoPk"/>
                          </if>
                        </leave>
                      </form>
                    </input>
                    <input xpath="@keepAllExtraData"/>
                  </container>
                </container>
                <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
              </container>
            </container>
            <container label="Properties" name="collection">
              <container name="contentDesc">
                <input alwaysActive="true" editable="false" img="xtk:xtklinkn.png" noEditCollection="true" nolabel="true" processExprParams="true" type="customizeCondition" xpath="conditionLink" xpathSchema="/tmp/selectCtrl/in/@schema" xpathSelect="select/node" xpathStartPath="/tmp/selectCtrl/in/@startPath" zoom="true">
                  <input xpath="@label"/>
                  <input label="Columns to create" xpath="@lineCount"/>
                  <input xpath="where/@displayFilter"/>
                  <input xpath="orderBy/@displayOrder"/>
                  <input hidden="true" xpath="@schema"/>
                  <form label="Filtering for a collection of personalization information" type="wizard">
                    <enter>
                      <set value="0" xpath="/tmp/@useOrderByValuesAsRank"/>
                      <if expr="@lineCount > 1">
                        <if expr="@groupBy==1">
                          <set value="2" xpath="/tmp/@singleRow"/>
                          <set expr="@useOrderByValuesAsRank" xpath="/tmp/@useOrderByValuesAsRank"/>
                        </if>
                        <if expr="@groupBy!=1">
                          <set value="0" xpath="/tmp/@singleRow"/>
                        </if>
                      </if>
                      <if expr="@lineCount==1">
                        <if expr="@groupBy==0">
                          <set value="1" xpath="/tmp/@singleRow"/>
                        </if>
                        <if expr="@singleRow==0 AND @groupBy==0">
                          <set value="0" xpath="/tmp/@singleRow"/>
                        </if>
                        <if expr="@merge==1 AND @groupBy==0">
                          <set value="3" xpath="/tmp/@singleRow"/>
                        </if>
                        <if expr="@groupBy==1">
                          <set value="2" xpath="/tmp/@singleRow"/>
                          <set expr="@useOrderByValuesAsRank" xpath="/tmp/@useOrderByValuesAsRank"/>
                        </if>
                      </if>
                      <if expr="@lineCount==0">
                        <set value="-1" xpath="/tmp/@singleRow"/>
                      </if>
                      <if expr="SubString(@expr, 0, 13)!='Propositions(' AND $(BUILD_NUMBER)>6797">
                        <set expr="wkfBuildTargetDataLink(@schema, [/ignored/@targetExtension])" xpath="@schema"/>
                      </if>
                    </enter>
                    <container desc="Enter information used to specify which offer will be selected." img="xtk:report/editor/insertColumnRight.png" name="offerParameters" title="Selection parameters" visibleIf="SubString(@expr, 0, 13)='Propositions('">
                      <enter>
                        <set expr="IndexOf(@expr, ',')" xpath="/ignored/queryAdd/@firstComma"/>
                        <set expr="IndexOf(SubString(@expr, [/ignored/queryAdd/@firstComma]+1), ',')" xpath="/ignored/queryAdd/@secondComma"/>
                        <set expr="IndexOf(SubString(@expr, [/ignored/queryAdd/@firstComma]+[/ignored/queryAdd/@secondComma]+2), ',')" xpath="/ignored/queryAdd/@thirdComma"/>
                        <set expr="Iif( [/ignored/queryAdd/@thirdComma]!=-1, 'dynamic', 'forced')" xpath="/tmp/queryAdd/@calcOffer"/>
                        <set expr="IndexOf(@expr, '#')" xpath="/ignored/queryAdd/@firstHash"/>
                        <set expr="IndexOf(SubString(@expr, [/ignored/queryAdd/@firstHash]+1), '#')" xpath="/ignored/queryAdd/@secondHash"/>
                        <if expr="[/tmp/queryAdd/@calcOffer]='dynamic'">
                          <set expr="SubString(@expr, 13, [/ignored/queryAdd/@firstComma]-13)" xpath="/tmp/queryAdd/@offerSpaceIdentifier"/>
                          <set expr="SubString(@expr, [/ignored/queryAdd/@firstComma]+2, [/ignored/queryAdd/@secondComma]-1)" xpath="/tmp/queryAdd/@offerCategoryIdentifier"/>
                          <set expr="SubString(@expr, [/ignored/queryAdd/@firstComma]+[/ignored/queryAdd/@secondComma]+4, [/ignored/queryAdd/@firstHash]-7-[/ignored/queryAdd/@firstComma]-[/ignored/queryAdd/@secondComma])" xpath="/tmp/queryAdd/@offerThemes"/>
                          <set value="nms:offerCategory" xpath="/ignored/queryDefCateg/@schema"/>
                          <set value="get" xpath="/ignored/queryDefCateg/@operation"/>
                          <set value="[.]" xpath="/ignored/queryDefCateg/select/node/@expr"/>
                          <set value="@offerCategory-cs" xpath="/ignored/queryDefCateg/select/node/@alias"/>
                          <set value="@id" xpath="/ignored/queryDefCateg/select/node[2]/@expr"/>
                          <set value="@offerCategory-id" xpath="/ignored/queryDefCateg/select/node[2]/@alias"/>
                          <set value="@name" xpath="/ignored/queryDefCateg/select/node[3]/@expr"/>
                          <set value="@offerCategory-name" xpath="/ignored/queryDefCateg/select/node[3]/@alias"/>
                          <set expr="Iif( IndexOf([/tmp/queryAdd/@offerCategoryIdentifier], '\'')==-1, '@id='+[/tmp/queryAdd/@offerCategoryIdentifier], '@name='+[/tmp/queryAdd/@offerCategoryIdentifier])" xpath="/ignored/queryDefCateg/where/condition/@expr"/>
                          <soapCall name="ExecuteQuery" service="xtk:queryDef">
                            <param exprIn="[/ignored/queryDefCateg]" type="DOMDocument"/>
                            <param type="DOMDocument" xpathOut="/ignored/queryAddCateg"/>
                          </soapCall>
                          <set expr="[/ignored/queryAddCateg/@offerCategory-cs]" xpath="/tmp/queryAdd/@offerCategory-cs"/>
                          <set expr="[/ignored/queryAddCateg/@offerCategory-cs]" xpath="/tmp/queryAdd/offerCategory/@offerCategory-cs"/>
                          <set expr="[/ignored/queryAddCateg/@offerCategory-id]" xpath="/tmp/queryAdd/@offerCategory-id"/>
                          <set expr="[/ignored/queryAddCateg/@offerCategory-id]" xpath="/tmp/queryAdd/offerCategory/@id"/>
                          <set expr="[/ignored/queryAddCateg/@offerCategory-name]" xpath="/tmp/queryAdd/@offerCategory-name"/>
                        </if>
                        <if expr="[/tmp/queryAdd/@calcOffer]='forced'">
                          <set expr="SubString(@expr, 13, [/ignored/queryAdd/@firstComma]-13)" xpath="/tmp/queryAdd/@offerIdentifier"/>
                          <set expr="SubString(@expr, [/ignored/queryAdd/@firstComma]+2, [/ignored/queryAdd/@secondComma]-1)" xpath="/tmp/queryAdd/@offerSpaceIdentifier"/>
                          <set value="nms:offer" xpath="/ignored/queryDefOffer/@schema"/>
                          <set value="get" xpath="/ignored/queryDefOffer/@operation"/>
                          <set value="[.]" xpath="/ignored/queryDefOffer/select/node/@expr"/>
                          <set value="@offer-cs" xpath="/ignored/queryDefOffer/select/node/@alias"/>
                          <set value="@id" xpath="/ignored/queryDefOffer/select/node[2]/@expr"/>
                          <set value="@offer-id" xpath="/ignored/queryDefOffer/select/node[2]/@alias"/>
                          <set value="@name" xpath="/ignored/queryDefOffer/select/node[3]/@expr"/>
                          <set value="@offer-name" xpath="/ignored/queryDefOffer/select/node[3]/@alias"/>
                          <set expr="Iif( IndexOf([/tmp/queryAdd/@offerIdentifier], '\'')==-1, '@id='+[/tmp/queryAdd/@offerIdentifier], '@name='+[/tmp/queryAdd/@offerIdentifier])" xpath="/ignored/queryDefOffer/where/condition/@expr"/>
                          <soapCall name="ExecuteQuery" service="xtk:queryDef">
                            <param exprIn="[/ignored/queryDefOffer]" type="DOMDocument"/>
                            <param type="DOMDocument" xpathOut="/ignored/queryAddOffer"/>
                          </soapCall>
                          <set expr="[/ignored/queryAddOffer/@offer-cs]" xpath="/tmp/queryAdd/@offer-cs"/>
                          <set expr="[/ignored/queryAddOffer/@offer-id]" xpath="/tmp/queryAdd/@offer-id"/>
                          <set expr="[/ignored/queryAddOffer/@offer-id]" xpath="/tmp/queryAdd/offer/@id"/>
                          <set expr="[/ignored/queryAddOffer/@offer-name]" xpath="/tmp/queryAdd/offer/@name"/>
                        </if>
                        <if expr="IndexOf([/tmp/queryAdd/@offerSpaceIdentifier], '\'')!=-1">
                          <set expr="SubString([/tmp/queryAdd/@offerSpaceIdentifier], 1, IndexOf([/tmp/queryAdd/@offerSpaceIdentifier], ':')-1)" xpath="/tmp/queryAdd/@offerEnv-name"/>
                          <set expr="SubString([/tmp/queryAdd/@offerSpaceIdentifier], IndexOf([/tmp/queryAdd/@offerSpaceIdentifier], ':')+1)" xpath="/tmp/queryAdd/@offerSpace-name"/>
                          <set expr="SubString([/tmp/queryAdd/@offerSpace-name], 0, StrLen([/tmp/queryAdd/@offerSpace-name])-1)" xpath="/tmp/queryAdd/@offerSpace-name"/>
                        </if>
                        <set value="nms:offerSpace" xpath="/ignored/queryDefSpace/@schema"/>
                        <set value="get" xpath="/ignored/queryDefSpace/@operation"/>
                        <set value="[.]" xpath="/ignored/queryDefSpace/select/node/@expr"/>
                        <set value="@offerSpace-cs" xpath="/ignored/queryDefSpace/select/node/@alias"/>
                        <set value="[@env-id]" xpath="/ignored/queryDefSpace/select/node[2]/@expr"/>
                        <set value="[@channel]" xpath="/ignored/queryDefSpace/select/node[3]/@expr"/>
                        <set value="'\'nms:offerView\''" xpath="/ignored/queryDefSpace/select/node[4]/@expr"/>
                        <set value="@id" xpath="/ignored/queryDefSpace/select/node[5]/@expr"/>
                        <set value="@name" xpath="/ignored/queryDefSpace/select/node[6]/@expr"/>
                        <set value="[env/@name]" xpath="/ignored/queryDefSpace/select/node[7]/@expr"/>
                        <set value="@env-name" xpath="/ignored/queryDefSpace/select/node[7]/@alias"/>
                        <set expr="Iif(IndexOf([/tmp/queryAdd/@offerSpaceIdentifier], '\'')==-1 , '@id='+[/tmp/queryAdd/@offerSpaceIdentifier], '@name=\'' + [/tmp/queryAdd/@offerSpace-name] + '\' AND [env/@name]=\'' + [/tmp/queryAdd/@offerEnv-name] + '\'')" xpath="/ignored/queryDefSpace/where/condition/@expr"/>
                        <soapCall name="ExecuteQuery" service="xtk:queryDef">
                          <param exprIn="[/ignored/queryDefSpace]" type="DOMDocument"/>
                          <param type="DOMDocument" xpathOut="/ignored/queryAddSpace"/>
                        </soapCall>
                        <set expr="[/ignored/queryAddSpace/@offerSpace-cs]" xpath="/tmp/queryAdd/@offerSpace-cs"/>
                        <set expr="[/ignored/queryAddSpace/@env-id]" xpath="/tmp/queryAdd/@env-id"/>
                        <set expr="[/ignored/queryAddSpace/@env-id]" xpath="/tmp/queryAdd/env/@id"/>
                        <set expr="[/ignored/queryAddSpace/@env-name]" xpath="/tmp/queryAdd/@offerEnv-name"/>
                        <set expr="[/ignored/queryAddSpace/@id]" xpath="/tmp/queryAdd/@offerSpace-id"/>
                        <set expr="[/ignored/queryAddSpace/@id]" xpath="/tmp/queryAdd/offerSpace/@id"/>
                        <set expr="[/ignored/queryAddSpace/@name]" xpath="/tmp/queryAdd/@offerSpace-name"/>
                        <set expr="[/ignored/queryAddSpace/@channel]" xpath="/tmp/queryAdd/@channel"/>
                        <set value="nms:offerView" xpath="/tmp/queryAdd/@outputSchema"/>
                        <set expr="SubString(@expr, [/ignored/queryAdd/@firstHash]+1, [/ignored/queryAdd/@secondHash])" xpath="/tmp/queryAdd/@contactDate"/>
                        <set expr="@lineCount" xpath="/tmp/queryAdd/@offerCount"/>
                      </enter>
                      <container maxLabelWidth="200" type="visibleGroup" visibleIf="[/tmp/queryAdd/@calcOffer]='dynamic'" xpath="/tmp/queryAdd">
                        <input computeStringAlias="@offerSpace-cs" createMode="none" img="nms:offerSpace.png" label="Space" notifyPathList="@name|@offerSpace-name,@_cs|@offerSpace-cs,env/@propositionSchema|@propositionSchema,@outputSchema|@outputSchema,@channel|@channel,@env-id|@env-id,env/@name|@offerEnv-name,@defaultCategory-id|/tmp/@defaultCategoryId,defaultCategory/@label|/tmp/@defaultCategoryCs,@defaultThemes|/tmp/@defaultThemes" required="true" schema="nms:offerSpace" type="linkEdit" xpath="@offerSpace-id">
                          <enter name="onChange">
                            <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory/@id"/>
                            <set expr="[/tmp/@defaultCategoryCs]" xpath="/tmp/defaultCategory/@_cs"/>
                            <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory"/>
                            <set expr="[/tmp/@defaultThemes]" xpath="@offerThemes"/>
                          </enter>
                          <sysFilter>
                            <condition expr="[env/@live]=true"/>
                          </sysFilter>
                        </input>
                        <input computeStringAlias="@offerCategory-cs" img="nms:offerCategory.png" label="Category" notifyPathList="@_cs|@offerCategory-cs" schema="nms:offerCategory" type="linkEdit" xpath="offerCategory" xpathRefresh="/tmp/defaultCategory">
                          <sysFilter>
                            <condition expr="@model = 'nmsOfferCategory' or @model = 'nmsOfferEnv'"/>
                            <condition expr="[@env-id]=$long(/tmp/queryAdd/@env-id)"/>
                          </sysFilter>
                        </input>
                        <input label="Themes" xpath="@offerThemes"/>
                        <input label="Contact date" type="datetime" xpath="@contactDate"/>
                        <input label="Number of offers to keep" type="number" xpath="@offerCount"/>
                      </container>
                      <container type="visibleGroup" visibleIf="[/tmp/queryAdd/@calcOffer]='forced'" xpath="/tmp/queryAdd">
                        <input computeStringAlias="@offerSpace-cs" createMode="none" img="nms:offerSpace.png" label="Space" notifyPathList="@name|@offerSpace-name,@_cs|@offerSpace-cs,env/@propositionSchema|@propositionSchema,@outputSchema|@outputSchema,@channel|@channel,@env-id|@env-id,env/@name|@offerEnv-name" required="true" schema="nms:offerSpace" type="linkEdit" xpath="@offerSpace-id">
                          <sysFilter>
                            <condition expr="[env/@live]=true"/>
                          </sysFilter>
                        </input>
                        <input computeStringAlias="@offer-cs" img="nms:offer.png" label="Offer" notifyPathList="@name|@offer-name,@_cs|@offer-cs" schema="nms:offer" type="linkEdit" xpath="@offer-id">
                          <sysFilter>
                            <condition expr="@status = 6"/>
                            <condition expr="[category/@env-id]=$long(/tmp/queryAdd/@env-id)"/>
                          </sysFilter>
                        </input>
                        <input label="Contact date" type="datetime" xpath="@contactDate"/>
                      </container>
                      <leave>
                        <if expr="[/tmp/queryAdd/offerCategory]!=[/tmp/queryAdd/offerCategory/@id]">
                          <set value="nms:offerCategory" xpath="/ignored/queryDefCategCheck/@schema"/>
                          <set value="get" xpath="/ignored/queryDefCategCheck/@operation"/>
                          <set value="[.]" xpath="/ignored/queryDefCategCheck/select/node/@expr"/>
                          <set value="@id" xpath="/ignored/queryDefCategCheck/select/node[2]/@expr"/>
                          <set value="@name" xpath="/ignored/queryDefCategCheck/select/node[3]/@expr"/>
                          <set expr="'@id='+[/tmp/queryAdd/offerCategory]" xpath="/ignored/queryDefCategCheck/where/condition/@expr"/>
                          <soapCall name="ExecuteQuery" service="xtk:queryDef">
                            <param exprIn="[/ignored/queryDefCategCheck]" type="DOMDocument"/>
                            <param type="DOMDocument" xpathOut="/ignored/queryAddCateg"/>
                          </soapCall>
                          <set expr="[/ignored/queryAddCateg/@name]" xpath="/tmp/queryAdd/@offerCategory-name"/>
                        </if>
                        <if expr="[/tmp/queryAdd/@calcOffer]='dynamic'">
                          <set expr="'Propositions(\'' + [/tmp/queryAdd/@offerEnv-name] + ':' + [/tmp/queryAdd/@offerSpace-name] + '\', \'' + [/tmp/queryAdd/@offerCategory-name] + '\', \'' + [/tmp/queryAdd/@offerThemes]+ '\', #' + [/tmp/queryAdd/@contactDate] + '#)'" xpath="@expr"/>
                        </if>
                        <if expr="[/tmp/queryAdd/@calcOffer]='forced'">
                          <set expr="'Propositions(\'' + [/tmp/queryAdd/@offer-name] + '\', \'' + [/tmp/queryAdd/@offerEnv-name] + ':' + [/tmp/queryAdd/@offerSpace-name] + '\', #' + [/tmp/queryAdd/@contactDate]+ '#)'" xpath="@expr"/>
                          <set expr="[/tmp/queryAdd/@offer-id]" xpathExpr="'../select/node[@alias=&quot;' + @alias + '&quot;]/node[@alias=&quot;@offer-id&quot;]/@expr'"/>
                        </if>
                        <set expr="[/tmp/queryAdd/@offerSpace-id]" xpathExpr="'../select/node[@alias=&quot;' + @alias + '&quot;]/node[@alias=&quot;@offerSpace-id&quot;]/@expr'"/>
                        <set expr="[/tmp/queryAdd/@channel]" xpathExpr="'../select/node[@alias=&quot;' + @alias + '&quot;]/node[@alias=&quot;@channel&quot;]/@expr'"/>
                        <set expr="'\'nms:offerView\''" xpathExpr="'../select/node[@alias=&quot;' + @alias + '&quot;]/node[@alias=&quot;@offerViewSchema&quot;]/@expr'"/>
                        <set expr="[/tmp/queryAdd/@offerCount]" xpath="@lineCount"/>
                        <set expr="[/tmp/queryAdd/@offerCount]=1" xpath="@singleRow"/>
                        <if expr="[/tmp/queryAdd/@offerCount]>1">
                          <reset xpath="where"/>
                          <set value="@rank" xpath="orderBy/node/@expr"/>
                        </if>
                        <if expr="[/tmp/queryAdd/@offerCount]=1">
                          <reset xpath="orderBy"/>
                          <set value="@rank=1" xpath="where/condition[@internalId='1']/@expr"/>
                        </if>
                      </leave>
                    </container>
                    <container desc="Enter information for identifying the join between the work table and the external data." name="dataParameters" title="Join parameters" visibleIf="SubString(@expr, 0, 13)!='Propositions(' AND NodeValue('../extension/schema[@extendedSchema=&quot;' + [/tmp/selectCtrl/in/@schema] + '&quot;]/element/element[@name=&quot;' + @xpath + '&quot;]/@target')!=''">
                      <enter>
                        <set expr="NodeValue('../extension/schema[@extendedSchema=&quot;' + [/tmp/selectCtrl/in/@schema] + '&quot;]/element/element[@name=&quot;' + @xpath + '&quot;]/@target')" xpath="/tmp/queryAddData/@linkSchema"/>
                        <set expr="[/tmp/selectCtrl/in/@schema]" xpath="/tmp/queryAddData/@targetSchema"/>
                        <copyElement exprSrc="'../extension/schema[@extendedSchema=&quot;' + [/tmp/selectCtrl/in/@schema] + '&quot;]/element/element[@name=&quot;' + @xpath + '&quot;]'" xpathDst="/tmp/queryAddData/element"/>
                        <set expr="Iif(NodeCount([/tmp/queryAddData/element/condition])>0, 1, 0)" xpath="/tmp/queryAddData/@advancedJoin"/>
                        <set expr="wkfAddLinkDefToSchema([/tmp/queryAddData/@targetSchema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [/tmp/queryAddData/@advancedJoin]==1, [/tmp/queryAddData/@linkSchema], ''))" xpath="/tmp/queryAddData/@targetSchema"/>
                      </enter>
                      <input label="Schema" readOnly="true" type="schemaEdit" xpath="/tmp/queryAddData/@linkSchema"/>
                      <input checkedValue="0" label="Use a simple join" nolabel="false" type="radioButton" xpath="/tmp/queryAddData/@advancedJoin"/>
                      <input checkedValue="1" label="Advanced join conditions" nolabel="false" type="radioButton" xpath="/tmp/queryAddData/@advancedJoin"/>
                      <input expr="wkfAddLinkDefToSchema([/tmp/queryAddData/@targetSchema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [/tmp/queryAddData/@advancedJoin]==1, [/tmp/queryAddData/@linkSchema], ''))" type="expr" xpath="/tmp/queryAddData/@targetSchema"/>
                      <container type="visibleGroup" visibleIf="[/tmp/queryAddData/@advancedJoin]!=1">
                        <static label=" " nolabel="false" type="help">Select below the source and target fields that will be matched to build the join condition.</static>
                        <input label=" " toolbarCaption="Join conditions" type="list" xpath="/tmp/queryAddData/element/join">
                          <input label="Remote field" type="pathEdit" xpath="@xpath-dst" xpathSchema="/tmp/queryAddData/@linkSchema"/>
                          <input label="Local field" type="pathEdit" xpath="@xpath-src" xpathSchema="/tmp/queryAddData/@targetSchema"/>
                        </input>
                      </container>
                      <container type="visibleGroup" visibleIf="[/tmp/queryAddData/@advancedJoin]==1">
                        <static label=" " nolabel="false" type="help">Select below the relationship conditions between source and target records. The 'joinTarget (Dynamic link)' link enables you to reference target fields to define joins.</static>
                        <input label=" " name="filterList" noSaveFilter="true" toolbarAlign="horizontal" toolbarCaption="Join conditions" type="conditionList" xpath="/tmp/queryAddData/element" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="/tmp/queryAddData/@targetSchema">
                          <input colSize="15" label=" " xpath="/@bool-operator"/>
                          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                          <input colSize="15" label="Operator" xpath="/@operator"/>
                          <input colSize="30" label="Value" xpath="/@rightExpr"/>
                        </input>
                      </container>
                      <leave>
                        <copyElement exprDst="'../extension/schema[@extendedSchema=&quot;' + [/tmp/selectCtrl/in/@schema] + '&quot;]/element/element[@name=&quot;' + @xpath + '&quot;]'" xpathSrc="/tmp/queryAddData/element"/>
                        <setModified/>
                      </leave>
                    </container>
                    <container desc="Enter information used to specify how many collection elements you want to keep." img="xtk:report/editor/insertColumnRight.png" name="parameters" title="General parameters" visibleIf="SubString(@expr, 0, 13)!='Propositions('">
                      <input enum="xtk:queryDef:rowConditionType" label="Data collected" type="sysEnum" xpath="/tmp/@singleRow"/>
                      <container backcolor="tooltip" type="visibleGroup" visibleIf="[/tmp/@singleRow]==1">
                        <static type="warning">This mode optimizes the generated SQL query thanks to a direct join on the collection elements. \nWarning: if the initial condition isn't complied with, the result may be false (missing lines or duplicates).</static>
                      </container>
                      <container type="visibleGroup" visibleIf="[/tmp/@singleRow]==0 OR [/tmp/@singleRow]==2">
                        <input xpath="@lineCount"/>
                      </container>
                      <container type="visibleGroup" visibleIf="[/tmp/@singleRow]==2 AND @lineCount > 1">
                        <input label="Group aggregates based on the values in the sort columns" type="checkBox" xpath="/tmp/@useOrderByValuesAsRank"/>
                        <static type="help">E.g.: In case of an aggregate calculation with a grouping on the last 5 years: - if the option is checked, aggregates will be calculated for the same 5 years for the entire population - if the option isn't checked, aggregates will be calculated for the last 5 years for each element of the population.</static>
                      </container>
                      <leave>
                        <if expr="[/tmp/@singleRow]==0">
                          <set value="0" xpath="@singleRow"/>
                          <set value="0" xpath="@groupBy"/>
                        </if>
                        <if expr="[/tmp/@singleRow]==1">
                          <set value="1" xpath="@singleRow"/>
                          <set value="0" xpath="@groupBy"/>
                          <set value="1" xpath="@lineCount"/>
                        </if>
                        <if expr="[/tmp/@singleRow]==2">
                          <set value="1" xpath="@singleRow"/>
                          <set value="1" xpath="@groupBy"/>
                          <set expr="[/tmp/@useOrderByValuesAsRank]" xpath="@useOrderByValuesAsRank"/>
                        </if>
                        <if expr="[/tmp/@singleRow]==3">
                          <set value="0" xpath="@singleRow"/>
                          <set value="1" xpath="@merge"/>
                          <set value="1" xpath="@lineCount"/>
                        </if>
                        <if expr="[/tmp/@singleRow]==-1">
                          <set value="0" xpath="@lineCount"/>
                        </if>
                      </leave>
                    </container>
                    <container desc="Enter the filtering condition used to specify which collection elements you want to keep." img="xtk:filter32.png" name="where" title="Filter" visibleIf="@lineCount>0 AND SubString(@expr, 0, 13)!='Propositions('">
                      <container buildQueryXPath="." ref="xtk:queryDef:where"/>
                    </container>
                    <container desc="Specify the sort order used to indicates which lines to keep, when there are more lines eligible than specified previously." img="xtk:filter32.png" name="orderBy" title="Sort" visibleIf="(@singleRow==0 OR @singleRow==2) AND @lineCount>0 AND SubString(@expr, 0, 13)!='Propositions('">
                      <container type="visibleGroup" visibleIf="[/tmp/@useOrderByValuesAsRank]">
                        <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                          <input colSize="20" label="Label" xpath="@label"/>
                          <input colSize="35" editable="true" label="Expression" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                          <input colSize="15" editable="true" label="Descending sort" type="checkbox" xpath="@sortDesc"/>
                          <input colSize="15" editable="true" label="Identifier" type="edit" xpath="@alias"/>
                        </input>
                        <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@help"/>
                      </container>
                      <container type="visibleGroup" visibleIf="![/tmp/@useOrderByValuesAsRank]">
                        <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                          <input colSize="20" label="Label" xpath="@label"/>
                          <input colSize="35" editable="true" label="Expression" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                          <input colSize="15" editable="true" label="Descending sort" type="checkbox" xpath="@sortDesc"/>
                        </input>
                        <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@help"/>
                      </container>
                    </container>
                  </form>
                </input>
              </container>
            </container>
            <container label="Reconciliation &amp;&amp; deduplication" name="reconc">
              <input editable="false" nolabel="true" toolbarCaption="List of references searched for" type="list" xpath="reconc" xpathToIgnore="reconc/condition" zoom="true" zoomOnAdd="true">
                <input editable="true" label="Identifier" xpath="@name"/>
                <input editable="true" label="Description" xpath="@label"/>
                <input label="Destination" xpath="@schema"/>
                <form label="Link definition" name="reconcDetail">
                  <enter>
                    <set expr="Iif(Substring(@schema, 0, 4)=='temp', 1, 0)" xpath="/tmp/@useTempSchema"/>
                    <set expr="Iif(NodeCount([join/condition])==0 AND NodeCount(keys)==0, 0, Iif(NodeCount(keys)==0, 1, 2))" xpath="/tmp/@advancedJoin"/>
                  </enter>
                  <static label="Description" type="separator"/>
                  <input xpath="@name"/>
                  <input xpath="@label"/>
                  <static label="Definition" type="separator"/>
                  <container>
                    <input checkedValue="0" label="Database schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                    <input checkedValue="1" label="Temporary schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==0">
                    <input schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==1">
                    <input label="Schema" type="ExclusionMainSetEdit" xpath="@srcDataSet" xpathActivityName="../@name"/>
                    <input expr="wkfSchemaName(@srcDataSet)" type="expr" xpath="@schema"/>
                  </container>
                  <input expr="wkfAddLinkDefToSchema([/tmp/selectCtrl/in/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [/tmp/@advancedJoin]!=0, @schema, ''))" type="expr" xpath="/ignored/@advancedJoinReconcSchema">
                    <enter>
                      <if expr="[/tmp/@advancedJoin]!='' AND [/tmp/@advancedJoin]!=1 AND NodeCount([join/condition])>0">
                        <msgBox translatedExpr="'Do you want to delete the advanced join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                        <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                          <reset xpath="join/condition[*]"/>
                          <refresh xpath="join"/>
                        </if>
                        <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                          <set value="1" xpath="/tmp/@advancedJoin"/>
                        </if>
                      </if>
                      <if expr="[/tmp/@advancedJoin]!='' AND [/tmp/@advancedJoin]!=0 AND NodeCount([condition])>0">
                        <msgBox translatedExpr="'Do you want to delete the join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                        <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                          <reset xpath="condition[*]"/>
                        </if>
                        <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                          <set value="0" xpath="/tmp/@advancedJoin"/>
                        </if>
                      </if>
                    </enter>
                  </input>
                  <static label="Join conditions" type="separator"/>
                  <input checkedValue="0" label="Use a simple join" nolabel="false" type="radioButton" xpath="/tmp/@advancedJoin"/>
                  <input checkedValue="1" label="Advanced join conditions" nolabel="false" type="radioButton" xpath="/tmp/@advancedJoin"/>
                  <input checkedValue="2" label="Reconciliation rules" nolabel="false" type="radioButton" xpath="/tmp/@advancedJoin"/>
                  <container type="visibleGroup" visibleIf="[/tmp/@advancedJoin]==0">
                    <static label=" " nolabel="false" type="help">Select below the source and target fields that will be matched to build the join condition.</static>
                    <input label=" " toolbarCaption="Join conditions" type="list" xpath="condition">
                      <input type="pathEdit" xpath="@srcExpr" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                      <input choiceType="export" hideMappedAsXml="true" type="pathEdit" xpath="@dstExpr" xpathSchema="../@schema"/>
                    </input>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@advancedJoin]==1">
                    <static label=" " nolabel="false" type="help">Select below the relationship conditions between source and target records. The 'joinTarget (Dynamic link)' link enables you to reference target fields to define joins.</static>
                    <input label=" " name="filterList" noSaveFilter="true" toolbarAlign="horizontal" toolbarCaption="Join conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="/tmp/selectCtrl/in/@schema">
                      <input colSize="15" label=" " xpath="/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/@operator"/>
                      <input colSize="30" label="Value" xpath="/@rightExpr"/>
                    </input>
                  </container>
                  <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@advancedJoin]=2">
                    <static label=" " nolabel="false" type="help">Select the conditions for reconciling source and target records below. When reconciliation criteria aren't reliable enough, you can refine reconciliation using proximity scores. The 'joinTarget (Dynamic link)' link lets you reference the fields of the target to define the join.</static>
                    <container label=" " nolabel="false" style="down" type="notebook">
                      <container label="Identification">
                        <input editable="false" nolabel="true" prebuildSubForm="false" toolbarCaption="Reconciliations" type="list" xpath="keys" xpathToIgnore="keys/scoreRule" zoom="true" zoomOnAdd="true">
                          <input editable="true" xpath="@active"/>
                          <input editable="true" expr="Iif(@label!='', @label, [join/@displayFilter])" label="Identification conditions" xpath="@label"/>
                          <input expr="Iif(@scoresApplied!='none', @minScore, '')" label="Required score"/>
                          <input expr="Iif(@scoresApplied=='all', [/ignored/@allLabel], Iif(@scoresApplied=='select', GroupConcat(scoreRule, &quot; '[' + @name + ']' &quot; ), ''))" label="Scores taken into account"/>
                          <form title="Reconciliation rule" type="wizard">
                            <enter>
                              <set expr="Iif(@scoresApplied=='none' OR @scoresApplied=='', 0, 1)" xpath="/tmp/@ruleReconcWithScore"/>
                              <set expr="Iif(@scoresApplied!='select', 0, 1)" xpath="/tmp/@ruleReconcRuleSel"/>
                            </enter>
                            <container desc="Specify below the conditions for identifying the target record" title="Join conditions">
                              <input label="label" xpath="@label"/>
                              <input label=" " name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Reconciliation conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="join/@displayFilter" xpathSchema="/tmp/selectCtrl/in/@schema">
                                <input colSize="15" label=" " xpath="/@bool-operator"/>
                                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                                <input colSize="15" label="Operator" xpath="/@operator"/>
                                <input colSize="30" label="Value" xpath="/@rightExpr"/>
                              </input>
                              <input checkedValue="1" label="Refine reconciliation using proximity scores" nolabel="true" type="checkBox" unCheckedValue="0" xpath="/tmp/@ruleReconcWithScore"/>
                            </container>
                            <container desc="Select below the proximity scores to be taken into account to refine reconciliation, then define the reconciliation approval threshold." title="Proximity scores" visibleIf="[/tmp/@ruleReconcWithScore]=1">
                              <enter>
                                <reset xpath="/tmp/ruleReconcSel"/>
                                <copyElement list="true" xpathDst="/tmp/ruleReconcSel/rules" xpathSrc="../scoreRule"/>
                                <forEach xpath="scoreRule">
                                  <set value="1" xpathExpr="'/tmp/ruleReconcSel/rules/scoreRule[@name=\''+@name+'\']/@sel'"/>
                                </forEach>
                              </enter>
                              <input checkedValue="0" label="All calculation rules" nolabel="true" type="radioButton" xpath="/tmp/@ruleReconcRuleSel"/>
                              <input checkedValue="1" label="A selection of rules" nolabel="true" type="radioButton" xpath="/tmp/@ruleReconcRuleSel"/>
                              <container enabledIf="[/tmp/@ruleReconcRuleSel]==1" type="enabledGroup">
                                <input noToolbar="true" nolabel="true" type="list" xpath="/tmp/ruleReconcSel/rules/scoreRule">
                                  <input colSize="10" label="Selected" type="checkBox" xpath="@sel"/>
                                  <input label="Proximity score" xpath="@name"/>
                                  <input label="Score" xpath="@score"/>
                                </input>
                              </container>
                              <static type="help">Specify below the minimum proximity score required to approve reconciliation.</static>
                              <input label="Minimum score" type="number" xpath="@minScore"/>
                            </container>
                            <leave>
                              <set expr="Iif([/tmp/@ruleReconcWithScore]==0, 'none', IIf([/tmp/@ruleReconcRuleSel]==0, 'all', 'select'))" xpath="@scoresApplied"/>
                              <if expr="[/tmp/@ruleReconcRuleSel]==1 AND [/tmp/@ruleReconcWithScore]==1">
                                <reset xpath="scoreRule[*]"/>
                                <copyElement filter="@sel=1" list="true" xpathDst="." xpathSrc="/tmp/ruleReconcSel/rules/scoreRule"/>
                              </if>
                            </leave>
                          </form>
                        </input>
                      </container>
                      <container label="Proximity scores">
                        <input editable="false" nolabel="true" prebuildSubForm="false" toolbarCaption="Calculation rules of the proximity score" type="list" xpath="scoreRule" zoom="true" zoomOnAdd="true">
                          <input editable="true" xpath="@active"/>
                          <input label="Name" xpath="@name"/>
                          <input label="Score" xpath="@score"/>
                          <input label="Condition" xpath="join/@displayFilter"/>
                          <form colcount="2" label="Proximity score">
                            <input label="Name" xpath="@name"/>
                            <input label="Score" type="number" xpath="@score"/>
                            <input colspan="2" name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Conditions for triggering score adding" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="join/@displayFilter" xpathSchema="/tmp/selectCtrl/in/@schema">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            </input>
                          </form>
                        </input>
                      </container>
                    </container>
                  </container>
                  <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath=".">
                    <form label="Link definition: advanced parameters">
                      <enter>
                        <set expr="Iif(@singleRow==0, Iif(NodeCount([orderBy/node])=0, 1, 2), 0)" xpath="/tmp/@linkDedup"/>
                        <set expr="wkfBuildTargetDataLink(@schema, [/tmp/selectCtrl/in/@schema])" xpath="/tmp/@linkDedupSchema"/>
                      </enter>
                      <static label="Link handling" type="separator"/>
                      <static label="The expression below lets you limit the records for which a link will be calculated" type="help"/>
                      <input type="pathEdit" xpath="@enabledIf" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                      <input xpath="@allowEmptyPart"/>
                      <static label="Deduplication" type="separator"/>
                      <input checkedValue="1" label="Choose for me from those that match a filter" type="radioButton" xpath="/tmp/@linkDedup"/>
                      <container type="visibleGroup" visibleIf="[/tmp/@linkDedup]=1">
                        <container type="visibleGroup" visibleIf="NodeCount([where/condition])=0">
                          <input label="Add a filter for target records..." nolabel="false" type="subformLink" xpath=".">
                            <form label="Link target filter">
                              <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                                <input colSize="15" label=" " xpath="/@bool-operator"/>
                                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                                <input colSize="15" label="Operator" xpath="/@operator"/>
                                <input colSize="30" label="Value" xpath="/@rightExpr"/>
                              </input>
                            </form>
                          </input>
                        </container>
                        <container type="visibleGroup" visibleIf="NodeCount([where/condition])>0">
                          <input label="Edit the filter..." nolabel="false" type="subformLink" xpath=".">
                            <form label="Link target filter">
                              <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                                <input colSize="15" label=" " xpath="/@bool-operator"/>
                                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                                <input colSize="15" label="Operator" xpath="/@operator"/>
                                <input colSize="30" label="Value" xpath="/@rightExpr"/>
                              </input>
                            </form>
                          </input>
                          <input label=" " lineCount="4" xpath="where/@displayFilter"/>
                        </container>
                      </container>
                      <input checkedValue="0" label="Do not deduplicate linked records (Expert mode - only one record matches the criteria)" type="radioButton" xpath="/tmp/@linkDedup"/>
                      <container type="visibleGroup" visibleIf="[/tmp/@linkDedup]=0">
                        <container type="visibleGroup" visibleIf="NodeCount([where/condition])=0">
                          <input label="Add a filter for target records..." nolabel="false" type="subformLink" xpath=".">
                            <form label="Link target filter">
                              <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                                <input colSize="15" label=" " xpath="/@bool-operator"/>
                                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                                <input colSize="15" label="Operator" xpath="/@operator"/>
                                <input colSize="30" label="Value" xpath="/@rightExpr"/>
                              </input>
                            </form>
                          </input>
                        </container>
                        <container type="visibleGroup" visibleIf="NodeCount([where/condition])>0">
                          <input label="Edit the filter..." nolabel="false" type="subformLink" xpath=".">
                            <form label="Link target filter">
                              <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                                <input colSize="15" label=" " xpath="/@bool-operator"/>
                                <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                                <input colSize="15" label="Operator" xpath="/@operator"/>
                                <input colSize="30" label="Value" xpath="/@rightExpr"/>
                              </input>
                            </form>
                          </input>
                          <input label=" " lineCount="4" xpath="where/@displayFilter"/>
                        </container>
                      </container>
                      <input checkedValue="2" label="Specify the selection and deduplication conditions of records" type="radioButton" xpath="/tmp/@linkDedup"/>
                      <container type="visibleGroup" visibleIf="[/tmp/@linkDedup]=2">
                        <container style="flat" type="notebook">
                          <container label="Filter">
                            <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="@schema">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            </input>
                          </container>
                          <container label="Sort">
                            <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" xpathSchema="@schema" zoom="false">
                              <input colSize="20" label="Label" xpath="@label"/>
                              <input choiceType="sortAggregate" colSize="35" editable="true" label="Expression" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                              <input colSize="15" editable="true" label="Descending sort" type="checkbox" xpath="@sortDesc"/>
                            </input>
                          </container>
                        </container>
                      </container>
                      <container type="visibleGroup" visibleIf="[/tmp/@advancedJoin]==2">
                        <input nolabel="true" xpath="@flattenTree"/>
                        <static type="help">When using several reconciliation rules, records can be reconciled two by two without a main record being identified. Checking the box above will automatically select a record to be used as a reference for all records reconciled two by two.</static>
                      </container>
                      <leave>
                        <set expr="Iif([/tmp/@linkDedup]>0, 0, 1)" xpath="@singleRow"/>
                      </leave>
                    </form>
                  </input>
                  <leave>
                    <set expr="wkfAddLinkDefToSchema([/tmp/selectCtrl/in/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], '')" xpath="/ignored/@advancedJoinReconcSchema"/>
                  </leave>
                </form>
              </input>
            </container>
            <container label="Simple join" name="links">
              <input editable="false" nolabel="true" toolbarCaption="List of links" type="list" xpath="links" xpathToIgnore="links/condition" zoom="true" zoomOnAdd="true">
                <input editable="true" label="Identifier" xpath="@name"/>
                <input editable="true" label="Description" xpath="@label"/>
                <input label="Destination" xpath="@schema"/>
                <input editable="true" label="Cardinality" xpath="@cardinality"/>
                <form label="Link definition" name="reconcDetail">
                  <enter>
                    <set expr="Iif(Substring(@schema, 0, 4)=='temp', Iif(NodeValue('../extension/schema[@name=\''+Substring(@schema, 5)+'\']/element/@sqltable')!='', 2, 1), 0)" xpath="/tmp/@useTempSchema"/>
                    <set expr="Iif(NodeCount([join/condition])==0, 0, 1)" xpath="/tmp/@advancedJoin"/>
                  </enter>
                  <static label="Description" type="separator"/>
                  <input xpath="@name"/>
                  <input xpath="@label"/>
                  <static label="Definition" type="separator"/>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]!=2">
                    <input checkedValue="0" label="Database schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                    <input checkedValue="1" label="Temporary schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==0">
                    <input schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==1">
                    <input label="Schema" type="ExclusionMainSetEdit" xpath="@srcDataSet" xpathActivityName="../@name"/>
                    <input expr="wkfSchemaName(@srcDataSet)" type="expr" xpath="@schema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==2">
                    <input readOnly="true" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                  </container>
                  <static label="Join conditions" type="separator"/>
                  <input expr="wkfAddLinkDefToSchema([/tmp/selectCtrl/in/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [/tmp/@advancedJoin]==1, @schema, ''))" type="expr" xpath="/ignored/@advancedJoinLinksSchema">
                    <enter>
                      <if expr="[/tmp/@advancedJoin]!='' AND [/tmp/@advancedJoin]!=1 AND NodeCount([join/condition])>0">
                        <msgBox translatedExpr="'Do you want to delete the advanced join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                        <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                          <reset xpath="join/condition[*]"/>
                          <refresh xpath="join"/>
                        </if>
                        <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                          <set value="1" xpath="/tmp/@advancedJoin"/>
                        </if>
                      </if>
                      <if expr="[/tmp/@advancedJoin]!='' AND [/tmp/@advancedJoin]!=0 AND NodeCount([condition])>0">
                        <msgBox translatedExpr="'Do you want to delete the join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                        <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                          <reset xpath="condition[*]"/>
                        </if>
                        <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                          <set value="0" xpath="/tmp/@advancedJoin"/>
                        </if>
                      </if>
                    </enter>
                  </input>
                  <input checkedValue="0" label="Use a simple join" nolabel="false" type="radioButton" xpath="/tmp/@advancedJoin"/>
                  <input checkedValue="1" label="Advanced join conditions" nolabel="false" type="radioButton" xpath="/tmp/@advancedJoin"/>
                  <container type="visibleGroup" visibleIf="[/tmp/@advancedJoin]!=1">
                    <static label=" " nolabel="false" type="help">Select below the source and target fields that will be matched to build the join condition.</static>
                    <input label=" " toolbarCaption="Join conditions" type="list" xpath="condition">
                      <input type="pathEdit" xpath="@srcExpr" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                      <input type="pathEdit" xpath="@dstExpr" xpathSchema="../@schema"/>
                    </input>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@advancedJoin]==1">
                    <static label=" " nolabel="false" type="help">Select below the relationship conditions between source and target records. The 'joinTarget (Dynamic link)' link enables you to reference target fields to define joins.</static>
                    <input label=" " name="filterList" noSaveFilter="true" toolbarAlign="horizontal" toolbarCaption="Join conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="/tmp/selectCtrl/in/@schema">
                      <input colSize="15" label=" " xpath="/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/@operator"/>
                      <input colSize="30" label="Value" xpath="/@rightExpr"/>
                    </input>
                  </container>
                  <static label="Cardinality" type="separator"/>
                  <container>
                    <input checkedValue="0" label="Type 1N collection link" type="radioButton" xpath="@cardinality"/>
                    <input checkedValue="1" label="Type 11 simple link" type="radioButton" xpath="@cardinality"/>
                    <input checkedValue="2" label="Type 11 simple link which may have a non-existent target" type="radioButton" xpath="@cardinality"/>
                  </container>
                  <container type="visibleGroup" visibleIf="@cardinality=1 OR @cardinality=2">
                    <static type="warning">Defining a 1-1 cardinality link can have a negative impact on future joins.</static>
                  </container>
                  <leave>
                    <set expr="0" xpath="/tmp/@useTempSchema"/>
                    <set expr="wkfAddLinkDefToSchema([/tmp/selectCtrl/in/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], '')" xpath="/ignored/@advancedJoinLinksSchema"/>
                  </leave>
                </form>
              </input>
            </container>
          </container>
        </container>
        <container name="subforms" xpath=".">
          <form label="Journal" name="zoomTask">
            <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Messages in the journal of the selected activity" type="linkList" xpath="log" xpathRefresh="/ignored/@selectedActivity">
              <sysFilter>
                <condition enabledIf="$(/ignored/@selectedActivity) !='' " expr="@activity = $(/ignored/@selectedActivity)"/>
              </sysFilter>
              <input xpath="@logDate"/>
              <input xpath="@message"/>
              <orderBy>
                <node expr="@logDate" sortDesc="true"/>
              </orderBy>
            </input>
          </form>
          <form label="Expiration" name="timeout" type="notebook">
            <container ref="xtk:workflow:lib/tabs/timeoutTransitionPage"/>
            <container ref="xtk:workflow:lib/tabs/schemaTransitionPage"/>
          </form>
          <form label="Transition" name="extractOutput" type="notebook">
            <enter>
              <set expr="wkfTargetSchema([../../@name], @name, 1)" xpath="/ignored/@transitionSchema"/>
            </enter>
            <container ref="xtk:workflow:lib/tabs/filterTransitionPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedExtractOutputPage"/>
            <container ref="xtk:workflow:lib/tabs/schemaTransitionPage"/>
          </form>
          <form label="Result" name="resultContainer" type="notebook">
            <container colcount="2" img="xtk:properties.png" label="General" name="tabGeneral">
              <input xpath="@label"/>
              <input xpath="@name"/>
              <input xpath="@code"/>
              <input xpath="@target"/>
              <input colspan="2" xpath="@enabled"/>
              <input colspan="2" xpath="comment"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/schemaTransitionPage"/>
          </form>
          <form label="Result" name="result" type="notebook">
            <enter>
              <set expr="wkfTargetSchema([../../@name], @name, 1)" xpath="/ignored/@transitionSchema"/>
            </enter>
            <container ref="xtk:workflow:lib/subforms/resultContainer/tabGeneral"/>
            <container ref="xtk:workflow:lib/tabs/schemaTransitionPage"/>
          </form>
          <form label="Result" name="remainder" type="notebook">
            <enter>
              <set expr="wkfTargetSchema([../../@name], '', 2)" xpath="/ignored/@transitionSchema"/>
            </enter>
            <container ref="xtk:workflow:lib/subforms/resultContainer/tabGeneral"/>
            <container ref="xtk:workflow:lib/tabs/schemaTransitionPage"/>
          </form>
          <form label="Transition" name="test" type="notebook">
            <enter>
              <set expr="wkfTargetSchema([../../@name],@name,1)" xpath="/ignored/@transitionSchema"/>
            </enter>
            <container img="xtk:properties.png" label="General">
              <input xpath="@label"/>
              <static label="Condition" type="separator"/>
              <input nolabel="true" xpath="condition">
                <container>
                  <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
              <static label="Comment" type="separator"/>
              <input nolabel="true" xpath="comment"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedTransitionPage"/>
            <container ref="xtk:workflow:lib/tabs/schemaTransitionPage"/>
          </form>
          <form label="Transition" name="transitionBase" type="notebook">
            <enter>
              <set expr="wkfTargetSchema([../../@name],@name,1)" xpath="/ignored/@transitionSchema"/>
            </enter>
            <container colcount="2" img="xtk:properties.png" label="General">
              <input xpath="@label"/>
              <input xpath="@name"/>
              <input xpath="@enabled"/>
              <input xpath="@target"/>
              <input colspan="2" xpath="comment"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/schemaTransitionPage"/>
          </form>
          <form label="View population" name="transitionExtensions" nothingToEdit="true" nothingToSave="true">
            <enter>
              <set expr="wkfTargetSchema([../../@name], @name, 1)" xpath="/ignored/@schema"/>
              <set value="" xpath="/ignored/@tmpDataPreviewError"/>
            </enter>
            <container type="notebook">
              <container img="xtk:sql.png" label="Data">
                <container type="visibleGroup" visibleIf="[/ignored/@tmpDataPreviewError]!=''">
                  <static fontBold="true" label=" " nolabel="true">Unable to read data from the base, the table has been purged or the current workflow configuration is no longer compatible with its structure.</static>
                  <input img="xtk:logwarn.png" label="Display errors during data loading..." prebuildSubForm="false" type="subFormLink">
                    <form label="Detail of errors during data loading" nothingToEdit="true" nothingToSave="true">
                      <input lineCount="7" nolabel="true" readOnly="true" xpath="/ignored/@tmpDataPreviewError"/>
                    </form>
                  </input>
                </container>
                <input name="resultPreviewQuery" nolabel="true" serialize="false" toolbarCaption="Records of the target" type="tmpDataPreviewList" xpath="/ignored/transitionExtensions/@tableName" xpathError="/ignored/@tmpDataPreviewError" xpathSchemaName="/ignored/transitionExtensions/@targetSchema"/>
              </container>
              <container img="xtk:schema.png" label="Schema">
                <input type="schemaview" xpath="/ignored/transitionExtensions/@targetSchema" xpathHelp="/ignored/selectCtrl/itn/@help"/>
                <input type="help" xpath="/ignored/selectCtrl/itn/@help"/>
              </container>
            </container>
          </form>
          <form name="transition" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="done" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="error" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="initial" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="default" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="refused" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="validated" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="fileExists" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="fileDoesNotExist" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="noFile" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="noMail" ref="xtk:workflow:lib/subforms/transitionBase"/>
          <form name="start" type="notebook">
            <container img="xtk:miniatures/mini-start.png">
              <input xpath="@label"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/lightActivityPage"/>
          </form>
          <form name="end" type="notebook">
            <container img="xtk:miniatures/mini-end.png">
              <input xpath="@label"/>
              <input xpath="@stop"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/lightActivityPage"/>
          </form>
          <form name="fork" type="notebook">
            <container img="xtk:miniatures/mini-fork.png">
              <input xpath="@label"/>
              <input label="Transitions" type="list" xpath="transitions/transition" zoom="true">
                <form name="trans">
                  <input xpath="@name"/>
                  <input xpath="@label"/>
                </form>
                <input xpath="@name"/>
                <input xpath="@label"/>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="andjoin" type="notebook">
            <container img="xtk:miniatures/mini-start.png">
              <input xpath="@label"/>
              <input type="ExclusionMainSetEdit" xpath="@mainSet"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="schedule" type="notebook">
            <container img="xtk:miniatures/mini-clock.png">
              <input xpath="@label"/>
              <container img="nms:calendar-large.png" label="Execution schedule" type="frame">
                <input type="scheduler" xpath="period"/>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="wait" type="notebook">
            <container img="xtk:miniatures/mini-hourglass.png">
              <input xpath="@label"/>
              <input xpath="@delay"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="timefilter" type="notebook">
            <container img="xtk:miniatures/mini-hourglass.png">
              <input xpath="@label"/>
              <input xpath="@runnableStart"/>
              <input xpath="@runnableEnd"/>
              <input xpath="@retryLater"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="subworkflow" type="notebook">
            <enter>
              <set expr="wkfBuildOutput(@name)" xpath="/ignored/@subWkfStops"/>
            </enter>
            <container img="xtk:miniatures/mini-workflowjob.png">
              <input xpath="@label"/>
              <input createMode="none" img="xtk:miniatures/mini-workflowjob.png" xpath="workflow"/>
              <input expr="wkfBuildOutput(Iif([@workflow-id]=0, @name, @name))" type="expr" xpath="/ignored/@subWkfStops"/>
              <static label="Configuration script" type="separator"/>
              <input nolabel="true" xpath="startScript">
                <container>
                  <input menuId="wfSubWorkflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="jumpin" type="notebook">
            <container img="xtk:miniatures/mini-jump-1.png">
              <input xpath="@label"/>
              <input xpath="@number"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="jumpout" type="notebook">
            <container img="xtk:miniatures/mini-jump-1.png">
              <input xpath="@label"/>
              <input xpath="@number"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="signal" type="notebook">
            <container img="xtk:miniatures/mini-signal.png">
              <input xpath="@label"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/lightActivityPage"/>
          </form>
          <form name="extern" type="notebook">
            <container img="xtk:miniatures/mini-shell.png">
              <input xpath="@label"/>
              <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@command"/>
              <input type="JstEdit" xpath="additionnalArgs">
                <container>
                  <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
              <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@workingDirectory"/>
              <input xpath="@wait"/>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="jstest" type="notebook">
            <container img="xtk:miniatures/mini-condition.png">
              <input xpath="@label"/>
              <static label="Conditional forks" type="separator"/>
              <input label="Conditions" type="list" xpath="transitions/test">
                <input xpath="@label"/>
                <input menuId="workflowMenuBuilder" noBorder="true" options="notJst" type="scriptEdit" xpath="condition"/>
              </input>
              <static label="Default branching" type="separator"/>
              <input label="Use default connection" xpath="transitions/default/@enabled"/>
              <container type="visibleGroup" visibleIf="[transitions/default/@enabled]">
                <input label="Label" xpath="transitions/default/@label"/>
              </container>
              <static type="help">The default choice creates a transition which is activated if none of the above conditions is satisfied.</static>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="js" type="notebook">
            <container img="xtk:miniatures/mini-script.png">
              <input xpath="@label"/>
              <input xpath="script">
                <container>
                  <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="jsx" type="notebook">
            <container img="xtk:miniatures/mini-script.png">
              <input xpath="@label"/>
              <container type="hpaned">
                <container>
                  <input xpath="call">
                    <container>
                      <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                    </container>
                  </input>
                </container>
                <container>
                  <input xpath="recall">
                    <container>
                      <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                    </container>
                  </input>
                </container>
              </container>
              <container colspan="2" toolbarCaption="Transitions" type="notebookList" xpath="transitions/transition" xpath-label="@label">
                <container colcount="2">
                  <input xpath="@label"/>
                  <input xpath="@name"/>
                </container>
              </container>
            </container>
            <container img="xtk:miniatures/mini-clock.png" label="Schedule">
              <container img="nms:calendar-large.png" label="Execution schedule" type="frame">
                <input type="scheduler" xpath="period"/>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="sql" type="notebook">
            <container img="xtk:miniatures/mini-execsql.png">
              <input xpath="@label"/>
              <input useDesc="true" xpath="@useEntity"/>
              <container type="visibleGroup" visibleIf="@useEntity">
                <input img="xtk:sql.png" noPropagateImg="true" xpath="sql"/>
              </container>
              <container type="visibleGroup" visibleIf="!@useEntity">
                <input contentType="sql" type="JstEdit" xpath="script">
                  <container>
                    <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                  </container>
                </input>
              </container>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="multiscript" type="notebook">
            <container img="xtk:miniatures/mini-multiscript.png">
              <input xpath="@label"/>
              <input xpath="@language"/>
              <container type="visibleGroup" visibleIf="@language='other'">
                <input xpath="@command"/>
              </container>
              <input contentType="text" xpath="script">
                <container>
                  <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="directorywatcher" type="notebook">
            <container img="xtk:miniatures/mini-txt.png" label="Directory">
              <input xpath="@label"/>
              <container label="Downloading files" type="frame">
                <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@directory"/>
                <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@pattern"/>
                <input useDesc="true" xpath="@stopAfterFirst"/>
              </container>
              <input img="xtk:import.png" label="File historization settings..." nolabel="false" type="subFormLink" xpath=".">
                <form name="fileHistory" ref="xtk:workflow:lib/tabs/fileHistory"/>
              </input>
              <input label="Process file nonexistence" xpath="transitions/noFile/@enabled"/>
              <input label="Process errors" xpath="transitions/error/@enabled"/>
            </container>
            <container img="xtk:miniatures/mini-clock.png" label="Schedule" name="planningActivityPage">
              <input nolabel="true" xpath="@usePeriod"/>
              <container type="visibleGroup" visibleIf="@usePeriod">
                <container img="nms:calendar-large.png" label="Execution schedule" type="frame">
                  <input type="scheduler" xpath="period"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="nlmodule" type="notebook">
            <container img="xtk:miniatures/mini-exec.png">
              <input xpath="@label"/>
              <input contentType="sql" type="JstEdit" xpath="params">
                <container>
                  <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="import" type="notebook">
            <container img="xtk:miniatures/mini-import.png">
              <input xpath="@label"/>
              <input form="xtk:import" img="xtk:import.png" xpath="model">
                <sysFilter>
                  <condition expr="@isModel = 1 and @jobType = 'import'"/>
                </sysFilter>
              </input>
              <container label="File to import" type="frame">
                <input checkedValue="0" label="Specified in the transition" type="RadioButton" xpath="@importType"/>
                <input checkedValue="1" label="Explicit" type="RadioButton" xpath="@importType"/>
                <container type="visibleGroup" visibleIf="@importType=1">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@file"/>
                </container>
              </container>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container img="xtk:script.png" label="Script">
              <static type="help">Import modification script</static>
              <input nolabel="true" xpath="script">
                <container>
                  <input menuId="wfImportMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="export" type="notebook">
            <container img="xtk:miniatures/mini-export.png">
              <input xpath="@label"/>
              <container label="Export" type="frame">
                <input checkedValue="0" label="Specified in the transition" type="RadioButton" xpath="@exportSel"/>
                <input checkedValue="1" label="Explicit" type="RadioButton" xpath="@exportSel"/>
                <input checkedValue="2" label="Calculated by a script" type="RadioButton" xpath="@exportSel"/>
                <input checkedValue="3" label="New, created from a template" type="RadioButton" xpath="@exportSel"/>
                <input checkedValue="4" label="Specified in the activity" type="RadioButton" xpath="@exportSel"/>
                <container type="visibleGroup" visibleIf="@exportSel=1">
                  <input createMode="none" enumImage="@status" folderFilterChoice="@model = 'xtkJobInstance'" form="xtk:export" img="xtk:miniatures/mini-export.png" noAutoComplete="true" xpath="export">
                    <sysFilter>
                      <condition expr="@isModel = 0"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="@exportSel=2">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="exportIdScript"/>
                </container>
                <container type="visibleGroup" visibleIf="@exportSel=3">
                  <input form="xtk:export" img="xtk:export.png" newEntityFormChoice="true" xpath="model">
                    <sysFilter>
                      <condition expr="@isModel = 1 and @jobType = 'export'"/>
                    </sysFilter>
                  </input>
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@file"/>
                </container>
                <container type="visibleGroup" visibleIf="@exportSel=4">
                  <input img="xtk:miniatures/mini-export.png" label="Edit the file format..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form img="xtk:export32.png" label="Extraction file format" type="wizard">
                      <enter>
                        <set value="" xpath="/tmp/@schemaChoice"/>
                        <set expr="wkfTargetSchema(@name)" xpath="extraction/source/@schema"/>
                        <set expr="[extraction/source/@schema]" xpath="/tmp/selectCtrl/in/@schema"/>
                        <set value="export" xpath="/tmp/selectCtrl/in/@choiceType"/>
                      </enter>
                      <container ref="xtk:exportSource:column" xpath="extraction"/>
                      <container ref="xtk:exportSource:conditionLink" visibleIf="[extraction/source/conditionLink/@xpath]!=''" xpath="extraction"/>
                      <container ref="xtk:exportSource:sort" xpath="extraction"/>
                      <container ref="xtk:exportSource:destInfo" xpath="extraction"/>
                      <container ref="xtk:exportSource:mapping" xpath="extraction"/>
                    </form>
                  </input>
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@file"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@exportSel!=4">
                <container label="Content to export" type="frame">
                  <input checkedValue="0" label="Specified in the export wizard" type="RadioButton" xpath="@targetSel"/>
                  <input checkedValue="1" label="Specified by the inbound event" type="RadioButton" xpath="@targetSel"/>
                </container>
              </container>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container img="xtk:script.png" label="Script">
              <static type="help">Export modification script</static>
              <input nolabel="true" xpath="script">
                <container>
                  <input menuId="wfExportMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="Iif(@exportSel=4, 1, @targetSel)" xpath="@targetSel"/>
            </leave>
          </form>
          <form name="fileTransfer" type="notebook">
            <enter>
              <if expr="[@extAccount-id]!=0">
                <set value="nms:extAccount" xpath="/ignored/queryDefExtAcc/@schema"/>
                <set value="get" xpath="/ignored/queryDefExtAcc/@operation"/>
                <set value="[.]" xpath="/ignored/queryDefExtAcc/select/node[1]/@expr"/>
                <set value="@id" xpath="/ignored/queryDefExtAcc/select/node[2]/@expr"/>
                <set value="@type" xpath="/ignored/queryDefExtAcc/select/node[3]/@expr"/>
                <set expr="'@id='+[@extAccount-id]" xpath="/ignored/queryDefExtAcc/where/condition/@expr"/>
                <soapCall name="ExecuteQuery" service="xtk:queryDef">
                  <param exprIn="[/ignored/queryDefExtAcc]" type="DOMDocument"/>
                  <param type="DOMDocument" xpathOut="extAccount"/>
                </soapCall>
              </if>
              <if expr="[@extAccount-id]=0">
                <reset xpath="extAccount"/>
              </if>
            </enter>
            <container img="nms:miniatures/mini-ftp.png">
              <input xpath="@label"/>
              <input xpath="@action"/>
              <container type="visibleGroup" visibleIf="EV([@action], 'upload')">
                <container label="Source" type="frame">
                  <input xpath="@useIncomingFile"/>
                  <container type="visibleGroup" visibleIf="@useIncomingFile == false">
                    <container label="Files" nolabel="false" toolbarAlign="horizontal" type="notebookList" xpath="localFile" zoom="false" zoomOnAdd="false">
                      <container>
                        <input editable="true" label="Source" menuId="workflowMenuBuilder" type="scriptEdit" xpath="@path"/>
                      </container>
                    </container>
                  </container>
                </container>
              </container>
              <container label="Remote server" type="frame">
                <input xpath="@useExtAccount"/>
                <container type="visibleGroup" visibleIf="[@useExtAccount]">
                  <input img="nms:extAccount.png" noAutoComplete="true" notifyPathList="@type" xpath="extAccount">
                    <sysFilter>
                      <condition expr="@type IN (4, 14)"/>
                    </sysFilter>
                  </input>
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@filePath"/>
                </container>
                <container type="visibleGroup" visibleIf="[@useExtAccount] == false">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@url"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV([@action], 'upload')">
                <input xpath="@archiveFiles"/>
              </container>
              <input img="xtk:import.png" label="File historization settings..." nolabel="false" type="subFormLink" xpath=".">
                <form name="fileHistory" ref="xtk:workflow:lib/tabs/fileHistory"/>
              </input>
              <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form label="Advanced parameters" maxLabelWidth="60">
                  <input nolabel="true" xpath="@deleteFiles"/>
                  <input nolabel="true" xpath="@verboseMode"/>
                  <container type="visibleGroup" visibleIf="EV([@action], 'fileList')">
                    <input nolabel="true" xpath="@listFiles"/>
                  </container>
                  <container type="visibleGroup" visibleIf="EV([extAccount/@type], 'ftp')">
                    <input nolabel="true" xpath="@useSSL"/>
                    <input label="Passive mode" type="separator"/>
                    <input nolabel="true" xpath="@disablePasv"/>
                  </container>
                  <container propagateConstraints="false" type="visibleGroup" visibleIf="@disablePasv">
                    <input xpath="@portAddress"/>
                    <static type="help">Tells the remote server (or the FTP proxy) to which address or network interface to connect when the passive mode is not possible. The value '-' means the default address of the system.</static>
                  </container>
                </form>
              </input>
              <input label="Process missing file" xpath="transitions/noFile/@enabled"/>
              <input label="Process errors" xpath="transitions/error/@enabled"/>
              <input expr="EV([@action], 'fileExistence')" type="expr" xpath="transitions/fileExists/@enabled"/>
              <input expr="EV([@action], 'fileExistence')" type="expr" xpath="transitions/fileDoesNotExist/@enabled"/>
              <input expr="EV([@action], 'fileExistence') == false" type="expr" xpath="transitions/done/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/planningActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form applicableIf="HasPackage('nms:aamIntegration') and IsIMSLoggedIn()" name="exportToAAM" type="notebook">
            <enter>
              <set expr="GetLinkSchema(wkfTargetSchema(@name), 'target')" xpath="/tmp/@schema"/>
              <set expr="Iif([/tmp/@schema]!='',[/tmp/@schema],[../../@schema])" xpath="@schema"/>
            </enter>
            <container img="nms:miniatures/mini-exportToAAM.png">
              <input xpath="@label"/>
              <static label="Adobe Marketing Cloud audiences" type="separator"/>
              <input img="nms:miniatures/mini-exportToAAM.png" label="Select a shared audience" nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form label="Select an 'Adobe Marketing Cloud' audience" nothingToEdit="true">
                  <input sessionToken="true" type="audiencePicker" urlExpr="$(serverUrl)+ '/nms/audienceSelector.jssp?allowCreate=true'" xpath="@traitId"/>
                </form>
              </input>
              <container type="visibleGroup" visibleIf="@segmentId != ''">
                <value fontBold="true" xpath="@segmentId"/>
              </container>
              <container type="visibleGroup" visibleIf="@segmentName != ''">
                <value fontBold="true" xpath="@segmentName"/>
              </container>
              <input createMode="none" img="nms:amcDataSource.png" noAutoComplete="true" xpath="amcDataSource">
                <sysFilter>
                  <condition expr="[mapping/@schema] = $(@schema)"/>
                </sysFilter>
              </input>
              <input readOnly="true" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
              <container name="hidden" type="visibleGroup" visibleIf="false">
                <input readOnly="true" xpath="@traitId"/>
              </container>
              <container xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <static colspan="2" label="Complement" type="separator"/>
                <input colspan="2" xpath="remainder/@enabled"/>
                <container colspan="2" type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="httpTransfer" type="notebook">
            <container img="nms:miniatures/mini-http.png">
              <input xpath="@label"/>
              <input xpath="@action"/>
              <container label="Web file" type="frame">
                <container>
                  <input checkedValue="0" label="Explicit URL" type="radioButton" xpath="@urlSource"/>
                  <input checkedValue="1" label="External account" type="radioButton" xpath="@urlSource"/>
                  <input checkedValue="2" label="Adobe Campaign instance" type="radioButton" xpath="@urlSource"/>
                </container>
                <container type="visibleGroup" visibleIf="[@urlSource] == 1">
                  <input img="nms:extAccount.png" noAutoComplete="true" xpath="extAccount">
                    <sysFilter>
                      <condition expr="@type = 5"/>
                    </sysFilter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="[@urlSource] == 0">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@url"/>
                </container>
                <container type="visibleGroup" visibleIf="[@urlSource] == 1 or [@urlSource] == 2">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@filePath"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV([@action],'post')">
                <input nolabel="true" toolbarCaption="POST parameters" type="list" xpath="postParameters/postParameter" zoom="true">
                  <form>
                    <container>
                      <input xpath="@name"/>
                      <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="value"/>
                    </container>
                  </form>
                  <input xpath="@name"/>
                  <input xpath="value"/>
                </input>
              </container>
              <input img="xtk:import.png" label="File historization settings..." nolabel="false" type="subFormLink" xpath=".">
                <form name="fileHistory" ref="xtk:workflow:lib/tabs/fileHistory"/>
              </input>
              <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form label="Advanced parameters" maxLabelWidth="60">
                  <input xpath="@followRedirs"/>
                  <input xpath="@addHeaders"/>
                  <input xpath="@ignoreRespCode"/>
                </form>
              </input>
              <input label="Process errors" xpath="transitions/error/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/planningActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="inmail" type="notebook">
            <container colcount="2" img="nms:miniatures/mini-inmail.png">
              <input colspan="2" xpath="@label"/>
              <container colspan="2" label="POP3 server" type="frame">
                <input colspan="2" xpath="@useExtAccount"/>
                <container type="visibleGroup" visibleIf="[@useExtAccount]">
                  <input img="nms:extAccount.png" noAutoComplete="true" xpath="extAccount">
                    <sysFilter>
                      <condition boolOperator="OR" expr="@type = 6"/>
                      <condition expr="@type = 99"/>
                    </sysFilter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="[@useExtAccount] == false">
                  <input xpath="@server"/>
                  <input xpath="@account"/>
                  <input xpath="@password"/>
                  <input xpath="@port"/>
                  <input xpath="@encryptionType"/>
                </container>
                <input useDesc="true" xpath="@stopAfterFirst"/>
              </container>
              <static colspan="2" label="Script" type="separator"/>
              <input colspan="2" nolabel="true" xpath="script">
                <container>
                  <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
              <static colspan="2" type="help">The script must return a value (in the 'nms:workflow:workflow:inmailAction' enumeration) which indicates the action to be carried out each time a message is received.</static>
              <container colcount="2" colspan="2">
                <input nolabel="true" xpath="@bypassCorruptedPart"/>
                <input label="Process email nonexistence" xpath="transitions/noMail/@enabled"/>
                <input label="Process errors" nolabel="true" xpath="transitions/error/@enabled"/>
                <input img="xtk:properties.png" label="Advanced parameters..." type="subFormLink" xpath=".">
                  <form label="Advanced parameters">
                    <input xpath="@commitAfter"/>
                    <static type="help">Messages are deleted after so many messages are processed (0 means process all messages in one single transaction).</static>
                    <static type="warning">This property should only be used when messages are systematically deleted from the POP3 mailbox.</static>
                  </form>
                </input>
              </container>
            </container>
            <container img="xtk:miniatures/mini-clock.png" label="Schedule" name="planningActivityPage">
              <input nolabel="true" xpath="@usePeriod"/>
              <container type="visibleGroup" visibleIf="@usePeriod">
                <container img="nms:calendar-large.png" label="Execution schedule" type="frame">
                  <input type="scheduler" xpath="period"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="inSms" type="notebook">
            <container img="nms:miniatures/mini-sms.png">
              <input xpath="@label"/>
              <container label="SMS routing" type="frame">
                <input img="nms:extAccount.png" noAutoComplete="true" xpath="extAccount">
                  <sysFilter>
                    <condition expr="@messageType = 1 and @type=3"/>
                  </sysFilter>
                </input>
              </container>
              <input img="nms:miniatures/mini-query.png" label="Filters messages to process..." type="subFormLink" xpath="filter">
                <form label="Edit filter">
                  <input nolabel="true" schema="nms:inSMS" toolbarAlign="horizontal" toolbarCaption="Filters messages to process" type="conditionlist" xpath="where" xpathCurrentLookupPath="/ignored/where/lookupPath" xpathHelp="helpCond">
                    <input colSize="15" label=" " xpath="/ignored/brlog/@bool-operator"/>
                    <input colSize="30" label="Expression" xpath="/ignored/brlog/@leftExpr"/>
                    <input colSize="15" label="Operator" xpath="/ignored/brlog/@operator"/>
                    <input colSize="30" label="Value" xpath="/ignored/brlog/@rightExpr"/>
                  </input>
                </form>
              </input>
              <input fontBold="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="filter/helpCond"/>
              <static label="Script" type="separator"/>
              <input nolabel="true" xpath="script">
                <container>
                  <input menuId="wfInSmsMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
              <static type="help">The script must return a value (in the 'nms:workflow:inSmsAction' enumeration) which indicates the action to be carried out each time an SMS is received.</static>
              <input label="Process errors" nolabel="true" xpath="transitions/error/@enabled"/>
              <input type="expr" xpath="transitions/done/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/planningActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="validation" type="notebook">
            <container colcount="2" img="nms:miniatures/mini-validation.png">
              <input colspan="2" xpath="@label"/>
              <input xpath="@assigneeType"/>
              <container type="visibleGroup" visibleIf="[@assigneeType]=0">
                <input createMode="none" img="xtk:group.png" noZoom="true" xpath="assignee">
                  <sysFilter>
                    <condition expr="@type=1"/>
                  </sysFilter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[@assigneeType]=1">
                <input createMode="none" img="xtk:operator.png" noZoom="true" xpath="operator">
                  <sysFilter>
                    <condition expr="@type=0"/>
                  </sysFilter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[@assigneeType]=2">
                <input label="Assignee" readOnly="true" required="true" xpath="assigneeFilter/@humanCond"/>
              </container>
              <input label="Advanced settings..." nolabel="true" type="subFormLink" xpath=".">
                <form label="Advanced parameters">
                  <enter>
                    <set value="xtk:operator" xpath="assigneeFilter/@schema"/>
                  </enter>
                  <input createMode="none" folderFilterChoice="@model = 'nmsDeliveryModel'" img="nms:email.png" noAutoComplete="true" xpath="scenario">
                    <sysFilter>
                      <condition expr="@isModel = 1"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@label"/>
                    </orderBy>
                  </input>
                  <container type="visibleGroup" visibleIf="[@assigneeType]=2" xpath="assigneeFilter">
                    <static label="Assignee" type="separator"/>
                    <container ref="xtk:queryDef:where"/>
                    <input expr="[/@helpCond]" type="expr" xpath="@humanCond"/>
                  </container>
                </form>
              </input>
              <input xpath="@multiple"/>
              <static colspan="2" label="Message" type="separator"/>
              <input colspan="2" menuId="workflowMenuBuilder" type="scriptEdit" xpath="@title"/>
              <container colspan="2" style="flat" type="contentEditor" xpath="message">
                <container label="HTML" name="tabHtml">
                  <input bodyMode="false" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                    </container>
                  </input>
                </container>
                <container label="Source" name="tabSource">
                  <input fullToolbar="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathTidy="/tmp/tidy/@doTidy" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                    </container>
                  </input>
                </container>
              </container>
              <container colspan="2" toolbarCaption="Possible answers" type="notebookList" xpath="transitions/transition" xpath-label="@label">
                <container colcount="2">
                  <input xpath="@label"/>
                  <input xpath="@name"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/timeoutsActivityPage"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="alert" type="notebook">
            <container colcount="2" img="nms:miniatures/mini-alert.png">
              <input colspan="2" xpath="@label"/>
              <input xpath="@assigneeType"/>
              <container type="visibleGroup" visibleIf="[@assigneeType]=0">
                <input createMode="none" img="xtk:group.png" noZoom="true" xpath="assignee">
                  <sysFilter>
                    <condition expr="@type=1"/>
                  </sysFilter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[@assigneeType]=1">
                <input createMode="none" img="xtk:operator.png" noZoom="true" xpath="operator">
                  <sysFilter>
                    <condition expr="@type=0"/>
                  </sysFilter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[@assigneeType]=2">
                <input label="Assignee" readOnly="true" required="true" xpath="assigneeFilter/@humanCond"/>
              </container>
              <input img="xtk:properties.png" label="Advanced parameters..." nolabel="true" type="subFormLink" xpath=".">
                <form label="Advanced parameters">
                  <enter>
                    <set value="xtk:operator" xpath="assigneeFilter/@schema"/>
                  </enter>
                  <input createMode="none" folderFilterChoice="@model = 'nmsDeliveryModel'" img="nms:email.png" noAutoComplete="true" xpath="scenario">
                    <sysFilter>
                      <condition expr="@isModel = 1"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@label"/>
                    </orderBy>
                  </input>
                  <container type="visibleGroup" visibleIf="[@assigneeType]=2" xpath="assigneeFilter">
                    <static label="Assignee" type="separator"/>
                    <container ref="xtk:queryDef:where"/>
                    <input expr="[/@helpCond]" type="expr" xpath="@humanCond"/>
                  </container>
                </form>
              </input>
              <static/>
              <static colspan="2" label="Message" type="separator"/>
              <input colspan="2" menuId="workflowMenuBuilder" type="scriptEdit" xpath="@title"/>
              <container colspan="2" style="flat" type="contentEditor" xpath="message">
                <container label="HTML" name="tabHtml">
                  <input bodyMode="false" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                    </container>
                  </input>
                </container>
                <container label="Source" name="tabSource">
                  <input fullToolbar="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathTidy="/tmp/tidy/@doTidy" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                    </container>
                  </input>
                </container>
              </container>
              <input label="Process errors" nolabel="true" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="notification" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name, 'all', 3)" xpath="/ignored/@targetExtension"/>
            </enter>
            <container img="nms:miniatures/mini-notification.png">
              <input xpath="@label"/>
              <input createMode="none" enumImage="@messageType" folderFilterChoice="@model = 'nmsDeliveryModel'" img="nms:deliveryModel.png" noAutoComplete="true" xpath="scenario">
                <sysFilter>
                  <condition expr="@isModel = 1"/>
                  <condition enabledIf="HasPackage('nms:campaign')" expr="[@operation-id] = 0"/>
                </sysFilter>
                <orderBy>
                  <node expr="@label"/>
                </orderBy>
              </input>
              <container label="Recipients" type="frame">
                <input checkedValue="0" label="Specified by the inbound events" type="RadioButton" xpath="@targetType"/>
                <input checkedValue="1" label="Specified in the delivery template" type="RadioButton" xpath="@targetType"/>
                <input checkedValue="2" label="File specified in the input event" type="RadioButton" xpath="@targetType"/>
                <input checkedValue="3" label="Specified by a script" type="RadioButton" xpath="@targetType"/>
                <container type="visibleGroup" visibleIf="@targetType=3">
                  <input label=" " xpath="script">
                    <container>
                      <input menuId="workflowMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                    </container>
                  </input>
                </container>
              </container>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="delivery" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name, 'all', 3)" xpath="/ignored/@targetExtension"/>
            </enter>
            <container img="nms:miniatures/mini-delivery.png">
              <input xpath="@label"/>
              <container label="Delivery" type="frame">
                <input checkedValue="0" label="Specified in the transition" type="RadioButton" xpath="@deliverySel"/>
                <input checkedValue="1" label="Explicit" type="RadioButton" xpath="@deliverySel"/>
                <input checkedValue="2" label="Computed by a script" type="RadioButton" xpath="@deliverySel"/>
                <input checkedValue="3" label="New, created from a template" type="RadioButton" xpath="@deliverySel"/>
                <container type="visibleGroup" visibleIf="@deliverySel=1">
                  <input createMode="none" enumImage="@messageType" folderFilterChoice="@model like 'nmsDelivery%'" img="nms:miniatures/mini-delivery.png" noAutoComplete="true" xpath="delivery">
                    <sysFilter>
                      <condition expr="@isModel = 0"/>
                      <condition expr="@state &lt;= 15"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="@deliverySel=2">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="deliveryIdScript"/>
                </container>
                <container type="visibleGroup" visibleIf="@deliverySel=3">
                  <input boldLineExpr="@builtIn = 1" createMode="none" enumImage="@messageType" folderFilterChoice="@model = 'nmsDeliveryModel'" img="nms:deliveryModel.png" label="Template" noAutoComplete="true" xpath="scenario">
                    <sysFilter>
                      <condition expr="@isModel = 1"/>
                      <condition enabledIf="HasPackage('nms:campaign')" expr="[@operation-id] = 0"/>
                    </sysFilter>
                  </input>
                </container>
              </container>
              <container label="Recipients" type="frame">
                <input checkedValue="0" label="Specified by the inbound event(s)" type="RadioButton" xpath="@targetSel"/>
                <input checkedValue="1" label="Specified in the delivery" type="RadioButton" xpath="@targetSel"/>
                <input checkedValue="2" label="File(s) specified in the input event(s)" type="RadioButton" xpath="@targetSel"/>
              </container>
              <container label="Content" type="frame">
                <input checkedValue="1" label="Specified by the inbound event" type="RadioButton" xpath="@contentType"/>
                <input checkedValue="0" label="Specified in the delivery" type="RadioButton" xpath="@contentType"/>
                <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="@targetSel=0">
                  <static label="Offers" type="separator"/>
                  <input checkedValue="1" label="Specified by the inbound event(s)" type="RadioButton" xpath="@offerSel"/>
                  <input checkedValue="0" label="Configured in the delivery" type="RadioButton" xpath="@offerSel"/>
                </container>
              </container>
              <container label="Action to perform" type="frame">
                <input checkedValue="0" label="Save" type="RadioButton" xpath="@actionType"/>
                <input checkedValue="4" label="Estimate the target" type="RadioButton" xpath="@actionType"/>
                <input checkedValue="1" label="Prepare" type="RadioButton" xpath="@actionType"/>
                <input checkedValue="3" label="Send a proof" type="RadioButton" xpath="@actionType"/>
                <input checkedValue="2" label="Prepare and start" type="RadioButton" xpath="@actionType"/>
              </container>
              <input label="Generate an outbound transition" xpath="transitions/done/@enabled"/>
              <container type="visibleGroup" visibleIf="[transitions/done/@enabled] and @targetSel != 2">
                <input xpath="@ignoreTarget"/>
              </container>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container img="xtk:script.png" label="Script">
              <static type="help">Delivery object modification script.</static>
              <input nolabel="true" xpath="script">
                <container>
                  <input menuId="wfDeliveryMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form maxLabelWidth="50" name="predictiveExtract" type="notebook">
            <enter>
              <if expr="@schema==''">
                <set value="nms:recipient" xpath="@schema"/>
              </if>
              <set value="false" xpath="transitions/extractOutput/filter/@enabled"/>
              <if expr="[transitions/extractOutput/limiter/@type]=''">
                <set value="percent" xpath="transitions/extractOutput/limiter/@type"/>
              </if>
              <if expr="[transitions/extractOutput/limiter/@limiterPredictiveType]=''">
                <set value="manual" xpath="transitions/extractOutput/limiter/@limiterPredictiveType"/>
              </if>
              <set value="1" xpath="transitions/extractOutput/limiter/@enabled"/>
              <set value="1" xpath="transitions/extractOutput/limiter/@predictive"/>
              <set value="0" xpath="transitions/extractOutput/limiter/@random"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-predictive-extract.png" label="Split" xpath="transitions/extractOutput">
              <container colcount="2" colspan="2" label="Predictive selection" type="frame">
                <input colspan="2" xpath="limiter/predictiveModel">
                  <sysFilter>
                    <condition expr="@isModel = 0"/>
                    <condition expr="@state >= 4"/>
                  </sysFilter>
                  <orderBy>
                    <node expr="@lastModified" sortDesc="true"/>
                  </orderBy>
                </input>
                <static colspan="2" label="Selection rule" type="separator"/>
                <input checkedValue="manual" colspan="2" label="Limit population size" type="radioButton" xpath="limiter/@limiterPredictiveType"/>
                <container colcount="3" colspan="2" enabledIf="[limiter/@limiterPredictiveType] = 'manual'" type="EnabledGroup">
                  <static/>
                  <container colcount="2" desc="Select the data limitation values" img="nms:pictoprofile.png" name="limitPage" title="Limits" xpath="limiter">
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="true">
                      <input checkedValue="percent" label="Size (in %)" type="RadioButton" xpath="@type"/>
                      <container enabledIf="@type=='percent'" type="EnabledGroup">
                        <input nolabel="true" xpath="@percent"/>
                      </container>
                    </container>
                    <container colcount="2" colspan="2" type="visibleGroup" visibleIf="true">
                      <input checkedValue="number" label="Maximum size" type="RadioButton" xpath="@type"/>
                      <container enabledIf="@type=='number'" type="EnabledGroup">
                        <input nolabel="true" xpath="@number"/>
                      </container>
                    </container>
                  </container>
                </container>
                <input checkedValue="stickToBudget" colspan="2" label="Respect a budget" type="radioButton" xpath="limiter/@limiterPredictiveType"/>
                <container colcount="3" colspan="2" enabledIf="[limiter/@limiterPredictiveType] = 'stickToBudget'" type="EnabledGroup">
                  <static/>
                  <input xpath="limiter/@deliveryBudget"/>
                  <input xpath="limiter/@unitDeliveryCost"/>
                </container>
                <input checkedValue="maximizeProfit" colspan="2" label="Maximize profit" type="radioButton" xpath="limiter/@limiterPredictiveType"/>
                <container colcount="3" colspan="2" enabledIf="[limiter/@limiterPredictiveType] = 'maximizeProfit'" type="EnabledGroup">
                  <static/>
                  <input xpath="limiter/@unitTransactionProfit"/>
                  <input xpath="limiter/@unitDeliveryCost"/>
                </container>
              </container>
              <container colcount="2" colspan="2" label="Results" type="frame">
                <input xpath="@label"/>
                <input xpath="@code"/>
              </container>
            </container>
            <container label="General">
              <input xpath="@label"/>
              <container ref="xtk:workflow:lib/tabs/schemaSelector"/>
              <container label="Results" type="frame" xpath="transitions">
                <input nolabel="false" xpath="remainder/@enabled"/>
                <static type="help">If this option is checked, a complementary subset will contain all remaining records.</static>
                <container type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <if expr="[transitions/extractOutput/limiter/@enabled] == false">
                <set value="false" xpath="transitions/extractOutput/limiter/@order"/>
                <set value="false" xpath="transitions/extractOutput/limiter/@random"/>
              </if>
              <if expr="[transitions/extractOutput/limiter/@enabled]=false and ([transitions/extractOutput/limiter/@random] or [transitions/extractOutput/limiter/@order])">
                <set value="true" xpath="transitions/extractOutput/limiter/@enabled"/>
              </if>
            </leave>
          </form>
          <form name="deliveryOperation" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name, 'all', 3)" xpath="/ignored/@targetExtension"/>
            </enter>
            <container editFormTarget="nms:delivery" name="editTargetProperties" newFormTarget="nms:newDelivery" propagateXPathToCtx="@messageType|/tmp/@messageType, ../../@id|/tmp/@workflowId,/tmp/@parentId,/tmp/@budgetId, /tmp/@budgetLabel, /tmp/@commitmentLevel, /tmp/parameter/*|/tmp/parameter, /tmp/process/*|/tmp/process, /tmp/controlGroup/*|/tmp/controlGroup, /tmp/measure/*|/tmp/measure, /tmp/seedList/*|/tmp/seedList, /tmp/@linkedOperation-id,/ignored/@targetExtension|/tmp/@targetExtension,/ignored/@deliveryRecurring|/tmp/@deliveryRecurring" targetMenuLabel="Edit the delivery..." type="visibleGroup" visibleIf="false">
              <enter>
                <set expr="wkfTargetSchema(@name, 'all', 3)" xpath="/ignored/@targetExtension"/>
                <set expr="iif(NodeName([.]) == 'deliveryRecurring', 1, 0)" xpath="/ignored/@deliveryRecurring"/>
              </enter>
              <leave>
                <if expr="NodeName([.]) == 'deliveryRecurring'">
                  <set expr="[@delivery-id]" xpath="@scenario-id"/>
                </if>
              </leave>
            </container>
            <container img="nms:miniatures/mini-delivery.png" visibleIf="[@delivery-id]!=0">
              <input xpath="@label"/>
              <static label="Workflow execution settings" type="separator"/>
              <container type="visibleGroup" visibleIf="true">
                <input label="Generate an outbound transition" xpath="transitions/done/@enabled"/>
              </container>
              <container type="visibleGroup" visibleIf="[transitions/done/@enabled]">
                <input xpath="@ignoreTarget"/>
              </container>
              <container type="visibleGroup" visibleIf="true">
                <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
              </container>
              <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="true">
                <input label="Use offers linked to the inbound event" type="checkBox" xpath="@offerSel"/>
              </container>
            </container>
            <container img="nms:miniatures/mini-delivery.png" visibleIf="[@delivery-id]=0">
              <input xpath="@label"/>
              <static label="Workflow execution settings" type="separator"/>
              <container type="visibleGroup" visibleIf="true">
                <input label="Generate an outbound transition" nolabel="false" xpath="transitions/done/@enabled"/>
              </container>
              <container type="visibleGroup" visibleIf="[transitions/done/@enabled]">
                <input nolabel="false" xpath="@ignoreTarget"/>
              </container>
              <container type="visibleGroup" visibleIf="true">
                <input label="Process errors" nolabel="false" xpath="transitions/error[@name='error']/@enabled"/>
              </container>
              <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="true">
                <input label="Use offers linked to the inbound event" nolabel="false" type="checkBox" xpath="@offerSel"/>
              </container>
            </container>
            <container img="xtk:script.png" label="Script">
              <static type="help">Delivery object modification script.</static>
              <input nolabel="true" xpath="script">
                <container>
                  <input menuId="wfDeliveryMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="deliveryOutline" type="notebook" xpathsToLoad="@messageType">
            <enter>
              <set value="0" xpath="/ignored/@addFilterRule"/>
              <if expr="HasPackage('nms:interaction')">
                <if expr="@maxPropositionCount>0">
                  <set value="1" xpath="/tmp/@callOfferEngine"/>
                </if>
              </if>
            </enter>
            <container img="nms:miniatures/mini-deliveryOutline.png">
              <input xpath="@label"/>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
              <input createMode="none" fullLoad="true" img="nms:deliveryOutline.png" notifyPathList="@messageType|../@messageType" xpath="deliveryOutline">
                <sysFilter>
                  <condition expr="[@operation-id]=$(../../@operation-id)"/>
                </sysFilter>
              </input>
              <input xpath="@contactDate"/>
              <static applicableIf="HasPackage('nms:interaction')" label="Offer selection" type="separator"/>
              <input applicableIf="HasPackage('nms:interaction')" checkedValue="1" label="Restrict the number of propositions selected" type="checkBox" unCheckedValue="0" xpath="/tmp/@callOfferEngine"/>
              <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="[/tmp/@callOfferEngine]">
                <input label="Number of propositions" xpath="@maxPropositionCount"/>
                <input createMode="none" img="nms:offerSpace.png" xpath="offerSpace">
                  <sysFilter>
                    <condition expr="[env/@live]=true"/>
                  </sysFilter>
                </input>
                <static type="help">Indicate the number of propositions to be kept among those referenced in the composition and the foreseen space.</static>
              </container>
              <container ref="nms:delivery:lib/typology"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <if expr="[/tmp/@callOfferEngine]=0 AND HasPackage('nms:interaction')">
                <set value="0" xpath="@maxPropositionCount"/>
              </if>
            </leave>
          </form>
          <form name="controlDelivery" type="notebook">
            <container img="nms:miniatures/mini-control-delivery.png">
              <input xpath="@label"/>
              <container label="Delivery" type="frame">
                <input checkedValue="0" label="Specified in the transition" type="RadioButton" xpath="@deliverySel"/>
                <input checkedValue="1" label="Explicit" type="RadioButton" xpath="@deliverySel"/>
                <input checkedValue="2" label="Computed by a script" type="RadioButton" xpath="@deliverySel"/>
                <container type="visibleGroup" visibleIf="@deliverySel=1">
                  <input createMode="none" folderFilterChoice="@model like 'nmsDelivery%'" img="nms:email.png" noAutoComplete="true" xpath="delivery">
                    <sysFilter>
                      <condition expr="@isModel = 0"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="@deliverySel=2">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="deliveryIdScript"/>
                </container>
              </container>
              <container label="Action to perform" type="frame">
                <input checkedValue="1" label="Start" type="RadioButton" xpath="@actionType"/>
                <input checkedValue="2" label="Pause" type="RadioButton" xpath="@actionType"/>
                <input checkedValue="3" label="Stop" type="RadioButton" xpath="@actionType"/>
              </container>
              <input label="Generate an outbound transition" xpath="transitions/done/@enabled"/>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="incremental" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name)" xpath="/ignored/@targetExtension"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-incremental.png">
              <input colspan="2" xpath="@label"/>
              <input alwaysActive="true" expr="@schema" type="expr" xpath="/tmp/selectCtrl/in/@schema"/>
              <static colspan="2" label="Target selection" type="separator"/>
              <input colspan="2" img="nms:miniatures/mini-query.png" label="Edit query..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form ref="xtk:workflow:lib/tabs/queryWizard"/>
              </input>
              <input colspan="2" fontBold="true" label=" " lineCount="5" noBorder="true" readOnly="true" type="edit" xpath="humanCond"/>
              <static colspan="2" label="Complementary information" type="separator"/>
              <input img="xtk:xtklinkn.png" label="Add data..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <enter name="onClick">
                  <set value="0" xpath="/tmp/queryAdd/@dataTypeReadOnly"/>
                </enter>
                <form label="Additional data" ref="xtk:workflow:lib/subforms/queryAdd" type="wizard"/>
              </input>
              <container type="visibleGroup" visibleIf="NodeCount([select/node])==0"/>
              <container type="visibleGroup" visibleIf="NodeCount([select/node])>=1">
                <input align="right" img="nms:list.png" label="Edit additional data..." prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Additional columns">
                    <enter>
                      <set expr="wkfTargetSchema(@name, '', 1)" xpath="/ignored/@targetExtension"/>
                      <set value="aggregate" xpath="/tmp/selectCtrl/in/@choiceType"/>
                    </enter>
                    <container style="flat" type="notebook">
                      <container ref="xtk:workflow:lib/tabs/colSelector/data"/>
                      <container ref="xtk:workflow:lib/tabs/colSelector/collection"/>
                    </container>
                  </form>
                </input>
              </container>
              <input alwaysActive="true" expr="GroupConcat([select/descendant::node], &quot; ' [' + [@label] + '] ' &quot; )" type="expr" xpath="/tmp/selectCtrl/out/@humanSelect"/>
              <input colspan="2" fontBold="true" label=" " lineCount="5" noBorder="true" readOnly="true" type="edit" xpath="/tmp/selectCtrl/out/@humanSelect"/>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
              </container>
            </container>
            <container img="nl:smallcalendar.png" label="Scheduling &amp;&amp; History">
              <container label="Scheduling" type="frame">
                <input nolabel="true" xpath="@usePeriod"/>
                <container type="visibleGroup" visibleIf="@usePeriod">
                  <input type="scheduler" xpath="period"/>
                </container>
              </container>
              <container label="History" type="frame">
                <input xpath="@history"/>
                <input xpath="@keepHistory"/>
                <input xpath="@sqlTableHisto"/>
                <static label="Overloads the name of the SQL table used to keep history." type="help"/>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form label="Additional data" name="queryAdd" type="wizard">
            <enter>
              <set expr="[/tmp/queryAdd/@dataTypeReadOnly]" xpath="/ignored/queryAdd/@dataTypeReadOnly"/>
              <set expr="[/tmp/queryAdd/@reverseLink]" xpath="/ignored/queryAdd/@reverseLink"/>
              <set expr="Iif([/tmp/queryAdd/@dataType]='', 'linkedData', [/tmp/queryAdd/@dataType])" xpath="/ignored/queryAdd/@dataType"/>
              <reset xpath="/tmp/queryAdd"/>
              <set expr="[/ignored/queryAdd/@dataTypeReadOnly]" xpath="/tmp/queryAdd/@dataTypeReadOnly"/>
              <set expr="[/ignored/queryAdd/@reverseLink]" xpath="/tmp/queryAdd/@reverseLink"/>
              <set expr="[/ignored/queryAdd/@dataType]" xpath="/tmp/queryAdd/@dataType"/>
              <set expr="NodeName([.])" xpath="/tmp/queryAdd/@entityName"/>
              <set expr="@name" xpath="/tmp/queryAdd/@activityName"/>
              <set value="" xpath="/tmp/queryAdd/@collName"/>
              <set expr="GroupConcat(conditionLink, &quot; '|' + @alias + '|' &quot;)" xpath="/tmp/queryAdd/@collNameList"/>
              <if expr="FieldExists('xtk:workflow', 'activities/'+[/tmp/queryAdd/@entityName]+'/links')">
                <set expr="[/tmp/queryAdd/@collNameList] + GroupConcat(links, &quot; '|' + @name + '|' &quot;)" xpath="/tmp/queryAdd/@collNameList"/>
              </if>
              <if expr="FieldExists('xtk:workflow', 'activities/'+[/tmp/queryAdd/@entityName]+'/reconc')">
                <set expr="[/tmp/queryAdd/@collNameList] + GroupConcat(reconc, &quot; '|' + @name + '|' &quot;)" xpath="/tmp/queryAdd/@collNameList"/>
              </if>
              <set value="" xpath="/tmp/queryAdd/@label"/>
              <set expr="[/tmp/selectCtrl/in/@schema]" xpath="/tmp/queryAdd/@schema"/>
              <set value="[.]" xpath="/tmp/queryAdd/@schemaRoot"/>
              <set expr="[/tmp/selectCtrl/in/@schema]" xpath="/tmp/queryAdd/@filterSchema"/>
              <if expr="[/tmp/queryAdd/@dataTypeReadOnly]!=1">
                <set value="linkedData" xpath="/tmp/queryAdd/@dataType"/>
              </if>
              <set value="0" xpath="/tmp/queryAdd/@lineCount"/>
              <set value="0" xpath="/tmp/queryAdd/@useOrderByValuesAsRank"/>
              <set expr="Iif([/tmp/queryAdd/@reverseLink]=1, -1,1)" xpath="/tmp/queryAdd/@rowCount"/>
            </enter>
            <container desc="You can select data linked to the filtering dimension, external data, an offer proposition, a predictive scoring, depending on the applications installed on your instance." img="xtk:filter32.png" title="Select the type of data to add" visibleIf="[/tmp/queryAdd/@dataTypeReadOnly]!=1 AND (HasPackage('nms:federatedDataAccess') OR HasPackage('nms:coreInteraction') OR HasPackage('nms:predictive') OR FieldExists('xtk:workflow', 'activities/'+NodeName([.])+'/reconc'))" xpath="/tmp/queryAdd">
              <container colcount="2" enabledIf="[/tmp/queryAdd/@dataTypeReadOnly]!=1" type="enabledGroup">
                <input img="xtk:filter32.png" rowspan="2" type="image"/>
                <input checkedValue="linkedData" label="Data linked to the filtering dimension" nolabel="true" type="radioButton" xpath="@dataType"/>
                <static>Lets you select data from the Adobe Campaign database.</static>
                <input applicableIf="HasPackage('nms:federatedDataAccess')" img="nms:activities/dbImport.png" rowspan="2" type="image"/>
                <input applicableIf="HasPackage('nms:federatedDataAccess')" checkedValue="extSharedData" label="External data" nolabel="true" type="radioButton" xpath="@dataType"/>
                <static applicableIf="HasPackage('nms:federatedDataAccess')">Lets you select data from an external database.</static>
                <input applicableIf="HasPackage('nms:coreInteraction')" img="nms:activities/offerSelection.png" rowspan="2" type="image"/>
                <input applicableIf="HasPackage('nms:coreInteraction')" checkedValue="offer" label="An offer proposition" nolabel="true" type="radioButton" xpath="@dataType"/>
                <static applicableIf="HasPackage('nms:coreInteraction')">Adds a set of columns to store the best proposition generated by the offer engine.</static>
                <input applicableIf="HasPackage('nms:predictive')" img="nms:activities/predictive.png" rowspan="2" type="image"/>
                <input applicableIf="HasPackage('nms:predictive')" checkedValue="score" label="A predictive score" nolabel="true" type="radioButton" xpath="@dataType"/>
                <static applicableIf="HasPackage('nms:predictive')">Adds a column to store the score computed by the selected predictive model.</static>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="FieldExists('xtk:workflow', 'activities/'+@entityName+'/reconc')">
                  <input img="nms:activities/links.png" rowspan="2" type="image"/>
                  <input checkedValue="linkDefColl" label="A link" nolabel="true" type="radioButton" xpath="@dataType"/>
                  <static>Adds the required column(s) for storing a reference to data in the Adobe Campaign database.</static>
                </container>
              </container>
            </container>
            <container desc="Select the link for accessing additional data." img="xtk:filter32.png" title="Select fields to add" visibleIf="[/tmp/queryAdd/@dataType]='linkedData' OR [/tmp/queryAdd/@dataType]='distantData' OR [/tmp/queryAdd/@dataType]=''" xpath="/tmp/queryAdd">
              <input checkedValue="linkedData" label="Data of the filtering dimension" nolabel="true" type="radioButton" xpath="@dataType"/>
              <input checkedValue="distantData" label="Data linked to the filtering dimension" nolabel="true" type="radioButton" xpath="@dataType"/>
              <input expr="Iif(@dataType='linkedData', 0, NodeValue('@lineCount'))" type="expr" xpath="@lineCount"/>
              <container type="visibleGroup" visibleIf="@dataType='distantData'">
                <container colcount="2">
                  <static img="xtk:filter.png" type="image"/>
                  <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/@search"/>
                </container>
                <input dblClickAction="wizNext" expandXPath="true" type="schemaView" useUnboundPath="true" xpath="/tmp/queryAdd/@schema" xpathExpr="/tmp/queryAdd/@filterLink" xpathFilter="462" xpathHelp="/tmp/@help" xpathSearchPath="/tmp/@search" xpathStartPath="/tmp/@startPath"/>
                <input type="help" xpath="/tmp/@help"/>
              </container>
              <leave>
                <if expr="[/tmp/queryAdd/@dataType]='linkedData' AND [/tmp/queryAdd/@recipientLink]=''">
                  <set expr="@schema" xpath="collection/@schema"/>
                </if>
                <if expr="[/tmp/queryAdd/@reverseLink]!=1 AND (([/tmp/queryAdd/@dataType]='linkedData' AND [/tmp/queryAdd/@recipientLink]!='') OR [/tmp/queryAdd/@dataType]='distantData')">
                  <set value="0" xpath="@rowCount"/>
                  <set value="3" xpath="@lineCount"/>
                </if>
                <if expr="[/tmp/queryAdd/@dataType]='linkedData'">
                  <set expr="ExtractRight(@schema, ':')" xpath="@collName"/>
                  <set expr="LabelOf('/tmp/queryAdd/@schemaRoot', '/tmp/queryAdd/@schema')" xpath="@label"/>
                </if>
                <if expr="[/tmp/queryAdd/@dataType]='distantData'">
                  <set expr="ExtractRight(GetLinkSchema(@schema, @filterLink), ':')" xpath="@collName"/>
                  <set expr="LabelOf('/tmp/queryAdd/@filterLink', '/tmp/queryAdd/@schema')" xpath="@label"/>
                </if>
              </leave>
            </container>
            <container desc="Select external data source." img="nms:activities/dbImport.png" title="Select fields to add" visibleIf="[/tmp/queryAdd/@dataType]='extSharedData' OR [/tmp/queryAdd/@dataType]='externalData'" xpath="/tmp/queryAdd">
              <input checkedValue="extSharedData" label="Using an external account" type="radioButton" xpath="@dataType"/>
              <input checkedValue="externalData" label="Locally defining the data source" type="radioButton" xpath="@dataType"/>
              <container type="visibleGroup" visibleIf="@dataType='extSharedData'">
                <input createMode="none" img="nms:miniatures/mini-dbImport.png" label="External account" notifyPathList="@name|dataSourceDesc/@name,@NChar|dataSourceDesc/@NChar,@unicodeData|dataSourceDesc/@unicodeData" schema="nms:extAccount" type="linkEdit" xpath="@dataSource-id">
                  <sysFilter>
                    <condition expr="@type = 7"/>
                  </sysFilter>
                </input>
                <static type="help">Select the external account for accessing additional data, then click next to select the table.</static>
              </container>
              <container type="visibleGroup" visibleIf="@dataType='externalData'" xpath="dataSourceDesc">
                <input enum="xtk:workflow:provider" label="Engine" type="sysenum" xpath="@provider"/>
                <static label="Database server" type="separator"/>
                <input label="Server" xpath="@server"/>
                <container type="visibleGroup" visibleIf="[@provider]=='Oracle'">
                  <static type="help">TNS name (defined on the application server) used to access the database server.</static>
                </container>
                <container type="visibleGroup" visibleIf="[@provider]=='PostgreSQL'">
                  <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
                </container>
                <container type="visibleGroup" visibleIf="[@provider]=='MSSQL'">
                  <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
                  <static label="Authentication mode used to access SQL Server" type="separator"/>
                  <input checkedValue="false" label="SQL Server authentication" type="RadioButton" xpath="/tmp/@integratedSecurity"/>
                  <input checkedValue="true" label="Windows NT authentication (integrated security)" type="RadioButton" xpath="/tmp/@integratedSecurity"/>
                </container>
                <container type="visibleGroup" visibleIf="[@provider]=='DB2'">
                  <static type="help">Host name or 'host:port' combination used to access the database server.</static>
                </container>
                <container type="visibleGroup" visibleIf="[@provider]=='MySQL'">
                  <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
                </container>
                <static label="Authentication settings" type="separator"/>
                <input label="User" xpath="@login"/>
                <input crypt="true" label="Password" type="passwordedit" xpath="@password"/>
                <container type="visibleGroup" visibleIf="[@provider]!='Oracle' AND [@provider]!='Teradata'">
                  <static label="Database" type="separator"/>
                  <input label="Database" xpath="@dbName"/>
                </container>
                <input label="Unicode database" type="checkbox" xpath="@unicodeData"/>
                <container type="visibleGroup" visibleIf="[@provider]='Oracle' OR [@provider]='MSSQL'">
                  <input xpath="@NChar"/>
                </container>
                <input enum="xtk:common:timezone" label="Time zone" type="sysenum" xpath="@timezone"/>
              </container>
              <leave>
                <if expr="[/tmp/queryAdd/@reverseLink]!=1 ">
                  <set value="0" xpath="@rowCount"/>
                  <set value="3" xpath="@lineCount"/>
                </if>
              </leave>
            </container>
            <container desc="Select the space and the offer category you want to use to generate propositions." img="nms:activities/offerSelection.png" title="Offer proposition" visibleIf="[/tmp/queryAdd/@dataType]='offer'" xpath="/tmp/queryAdd">
              <enter>
                <if expr="@collName==''">
                  <set value="proposition" xpath="@collName"/>
                  <set value="proposition" xpath="@label"/>
                  <set expr="Iif(HasPackage('nms:interaction'), 'dynamic', 'forced')" xpath="@calcOffer"/>
                  <set value="1" xpath="@offerCount"/>
                </if>
              </enter>
              <static type="help">Select an identifier and a label, to easily find propositions during the rest of the segmentation.</static>
              <input label="Identifier" required="true" size="24" xpath="@collName"/>
              <container type="visibleGroup" visibleIf="IndexOf(@collNameList, '|' + @collName + '|')>=0">
                <static type="warning">The identifier above is already used. If you keep it, the configuration of the search engine below will replace the existing one.</static>
              </container>
              <input label="Label" xpath="@label"/>
              <input applicableIf="HasPackage('nms:interaction')" checkedValue="dynamic" label="Search for the best offer in a category" type="radioButton" xpath="@calcOffer"/>
              <input applicableIf="HasPackage('nms:interaction')" checkedValue="forced" label="A predefined offer" type="radioButton" xpath="@calcOffer"/>
              <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="@calcOffer='dynamic'">
                <static type="help">Call to the engine to calculate the best available offer for the incoming population. Adds columns to the incoming population to store the best proposition. Proposition historization will take place later when the proposition is used in a delivery.</static>
                <input computeStringAlias="@offerSpace-cs" createMode="none" img="nms:offerSpace.png" label="Space" notifyPathList="@name|@offerSpace-name,@_cs|@offerSpace-cs,env/@propositionSchema|@propositionSchema,@outputSchema|@outputSchema,@channel|@channel,@env-id|@env-id,env/@name|@offerEnv-name,@defaultCategory-id|/tmp/@defaultCategoryId,defaultCategory/@label|/tmp/@defaultCategoryCs,@defaultThemes|/tmp/@defaultThemes" required="true" schema="nms:offerSpace" type="linkEdit" xpath="@offerSpace-id">
                  <enter name="onChange">
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory/@id"/>
                    <set expr="[/tmp/@defaultCategoryCs]" xpath="/tmp/defaultCategory/@_cs"/>
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory"/>
                    <set expr="[/tmp/@defaultThemes]" xpath="@offerThemes"/>
                  </enter>
                  <sysFilter>
                    <condition expr="[env/@live]=true"/>
                  </sysFilter>
                </input>
                <container maxLabelWidth="200" type="visibleGroup" visibleIf="[@offerSpace-id]!='' AND [@offerSpace-id]!=0">
                  <input computeStringAlias="@offerCategory-cs" img="nms:offerCategory.png" label="Category" notifyPathList="@_cs|@offerCategory-cs" schema="nms:offerCategory" type="linkEdit" xpath="offerCategory" xpathRefresh="/tmp/defaultCategory">
                    <sysFilter>
                      <condition expr="@model IN ('nmsOfferCategory', 'nmsOfferEnv')"/>
                      <condition expr="[@env-id]=$long(/tmp/queryAdd/@env-id)"/>
                    </sysFilter>
                  </input>
                  <input label="Themes" xpath="@offerThemes"/>
                  <input label="Contact date" type="datetime" xpath="@contactDate"/>
                  <input label="Number of offers to keep" type="number" xpath="@offerCount"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@calcOffer='forced'">
                <static type="help">Adds columns to the incoming population to store a proposition for the chosen offer. Proposition historization will take place later when the proposition is used in a delivery.</static>
                <input computeStringAlias="@offerSpace-cs" createMode="none" img="nms:offerSpace.png" label="Space" notifyPathList="@name|@offerSpace-name,@_cs|@offerSpace-cs,env/@propositionSchema|@propositionSchema,@outputSchema|@outputSchema,@channel|@channel,@env-id|@env-id,env/@name|@offerEnv-name" required="true" schema="nms:offerSpace" type="linkEdit" xpath="@offerSpace-id">
                  <sysFilter>
                    <condition expr="[env/@live]=true"/>
                  </sysFilter>
                </input>
                <input computeStringAlias="@offer-cs" createMode="none" img="nms:offer.png" label="Offer" notifyPathList="@_cs|@offer-cs,@name|@offer-name" schema="nms:offer" type="linkEdit" xpath="@offer-id">
                  <sysFilter>
                    <condition expr="@status = 6"/>
                    <condition expr="[category/@env-id]=$long(/tmp/queryAdd/@env-id)"/>
                  </sysFilter>
                </input>
                <input label="Contact date" type="datetime" xpath="@contactDate"/>
              </container>
            </container>
            <container desc="Select the predictive model to apply for score computing" img="nms:packages/predictive.png" title="Configuring score computing" visibleIf="[/tmp/queryAdd/@dataType]='score'" xpath="/tmp/queryAdd">
              <enter>
                <if expr="@collName==''">
                  <set value="score" xpath="@collName"/>
                  <set value="score" xpath="@label"/>
                </if>
              </enter>
              <static type="help">Select an identifier and a label, to easily find the stored values during the rest of segmentation.</static>
              <input label="Identifier" required="true" size="24" xpath="@collName"/>
              <container type="visibleGroup" visibleIf="IndexOf(@collNameList, '|' + @collName + '|')>=0">
                <static type="warning">The identifier above is already used. If you keep it, the score computed by the predictive model below will replace the existing one.</static>
              </container>
              <input label="Label" xpath="@label"/>
              <static type="help">Select the predictive model for computing a score for each individual of the inbound population.</static>
              <input createMode="none" label="Predictive model" notifyPathList="@internalName|@predictiveModel-name,@_cs|predictiveModel/@_cs,@id|predictiveModel/@id" schema="nms:predictiveModel" type="linkEdit" xpath="@predictiveModel-id">
                <sysFilter>
                  <condition expr="@isModel = 0"/>
                  <condition expr="@state >= 4"/>
                </sysFilter>
                <orderBy>
                  <node expr="@lastModified" sortDesc="true"/>
                </orderBy>
              </input>
            </container>
            <container desc="Select the table, then associate the data with the filtering dimension" img="nms:activities/dbImport.png" title="Select fields to add" visibleIf="[/tmp/queryAdd/@dataType]='extSharedData' OR [/tmp/queryAdd/@dataType]='externalData'" xpath="/tmp/queryAdd">
              <enter>
                <if expr="[/tmp/queryAdd/@dataType]='extSharedData'">
                  <set expr="'nms:extAccount:' + [dataSourceDesc/@name]" xpath="@dataSource"/>
                </if>
                <if expr="[/tmp/queryAdd/@dataType]='externalData'">
                  <set expr="'{' + [dataSourceDesc/@provider] + ':' + [dataSourceDesc/@login] + ':' + [dataSourceDesc/@dbName] + '/' + Iif(SubString([dataSourceDesc/@password], 0, 13)=='__PLAINTEXT__', SubString([dataSourceDesc/@password], 13), [dataSourceDesc/@password] ) + '@' + [dataSourceDesc/@server] + Iif([dataSourceDesc/@unicodeData], ';unicodeData=1', ';unicodeData=0') + Iif([dataSourceDesc/@NChar], ';NChar=1', ';NChar=0') + ';timezone=' + [dataSourceDesc/@timezone] + '}'" xpath="@dataSource"/>
                </if>
                <set expr="Iif(@advancedJoin=='', 0, @advancedJoin)" xpath="@advancedJoin"/>
              </enter>
              <input label="Table name" xpath="@tableName">
                <input img="xtk:choiceField.png" modeless="false" name="btnChoiceTable" prebuildSubForm="false" xpath=".">
                  <enter name="onClick">
                    <soapCall name="BuildTableList" service="xtk:sqlSchema">
                      <param exprIn="@dataSource" type="string"/>
                      <param exprIn="'%' + [/ignored/dbImport/@tableFilter] + '%'" type="string"/>
                      <param type="DOMDocument" xpathOut="/ignored/dbImport/tableList"/>
                    </soapCall>
                  </enter>
                  <form colcount="2" label="Select the table">
                    <input catchReturnKey="true" label="Filter" xpath="/ignored/dbImport/@tableFilter"/>
                    <input label="Filter" type="button">
                      <enter>
                        <soapCall name="BuildTableList" service="xtk:sqlSchema">
                          <param exprIn="@dataSource" type="string"/>
                          <param exprIn="'%' + [/ignored/dbImport/@tableFilter] + '%'" type="string"/>
                          <param type="DOMDocument" xpathOut="/ignored/dbImport/tableList"/>
                        </soapCall>
                      </enter>
                    </input>
                    <input colspan="2" dblClickAction="btnOk" editable="false" entitySchema="xtk:sqlSchema" noToolbar="true" nolabel="true" readOnly="true" type="list" xpath="/ignored/dbImport/tableList/table" xpathSelection="/tmp/dbImport/@tableName">
                      <input editable="false" label="Table name" xpath="@name"/>
                    </input>
                    <leave>
                      <set expr="NodeValue([/tmp/dbImport/@tableName]+'/@name')" xpath="@tableName"/>
                    </leave>
                  </form>
                </input>
              </input>
              <input expr="wkfExternalSchema(@tableName, @dataSource, @tableName)" type="expr" xpath="@targetSchema"/>
              <input expr="@tableName" type="expr" xpath="@collName"/>
              <container type="visibleGroup" visibleIf="IndexOf(@collNameList, '|' + @collName + '|')>=0">
                <static type="warning">The identifier above is already used, the new configuration will replace the existing one.</static>
              </container>
              <input expr="@tableName" type="expr" xpath="@label"/>
              <container type="visibleGroup" visibleIf="[/tmp/queryAdd/@reverseLink]=1">
                <input label="Identifier" required="true" size="24" xpath="@collName"/>
                <input label="Label" xpath="@label"/>
              </container>
              <container type="visibleGroup" visibleIf="@targetSchema!=''">
                <static label="Join conditions" type="separator"/>
                <input checkedValue="0" label="Use a simple join" nolabel="false" type="radioButton" xpath="@advancedJoin"/>
                <input checkedValue="1" label="Advanced join conditions" nolabel="false" type="radioButton" xpath="@advancedJoin"/>
                <input applicableIf="$(BUILD_NUMBER)>6819" expr="wkfAddLinkDefToSchema(@filterSchema, 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [@advancedJoin]==1, @targetSchema, ''))" type="expr" xpath="/ignored/@advancedJoinQueryAddSchema">
                  <enter>
                    <if expr="@advancedJoin!='' AND @advancedJoin!=1 AND NodeCount([element/condition])>0">
                      <msgBox translatedExpr="'Do you want to delete the advanced join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                      <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                        <reset xpath="element/condition[*]"/>
                        <refresh xpath="element"/>
                      </if>
                      <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                        <set value="1" xpath="@advancedJoin"/>
                      </if>
                    </if>
                    <if expr="@advancedJoin!='' AND @advancedJoin!=0 AND NodeCount([element/join])>0">
                      <msgBox translatedExpr="'Do you want to delete the join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                      <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                        <reset xpath="element/join[*]"/>
                      </if>
                      <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                        <set value="0" xpath="@advancedJoin"/>
                      </if>
                    </if>
                  </enter>
                </input>
                <container type="visibleGroup" visibleIf="@advancedJoin!=1" xpath="element">
                  <static label=" " nolabel="false" type="help">Select below the source and target fields that will be matched to build the join condition.</static>
                  <input label=" " toolbarCaption="Join conditions" type="list" xpath="join">
                    <input label="Remote field" schemaExpr="[../../@targetSchema]" type="pathEdit" xpath="@xpath-dst"/>
                    <input label="Local field" schemaExpr="[../../@filterSchema]" type="pathEdit" xpath="@xpath-src"/>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="@advancedJoin==1" xpath="element">
                  <static label=" " nolabel="false" type="help">Select below the relationship conditions between source and target records. The 'joinTarget (Dynamic link)' link enables you to reference target fields to define joins.</static>
                  <input label=" " name="filterList" noSaveFilter="true" toolbarAlign="horizontal" toolbarCaption="Join conditions" type="conditionList" xpath="." xpathCurrentLookupPath="/lookupPath/where" xpathSchema="../@filterSchema">
                    <input colSize="15" label=" " xpath="/@bool-operator"/>
                    <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                    <input colSize="15" label="Operator" xpath="/@operator"/>
                    <input colSize="30" label="Value" xpath="/@rightExpr"/>
                  </input>
                </container>
              </container>
              <leave>
                <if expr="@tableName=='' OR ([@dataSource-id]==0 AND [dataSourceDesc/@server]='')">
                  <reset xpath="extension"/>
                </if>
                <if expr="@tableName!='' AND ([@dataSource-id]!=0 OR [dataSourceDesc/@server]!='')">
                  <set expr="wkfExternalSchema(@tableName, @dataSource, @tableName, 'extension')" xpath="/ignored/dbImport/@schema"/>
                </if>
              </leave>
            </container>
            <container desc="Enter information used to specify how many collection elements you want to keep." img="xtk:report/editor/insertColumnRight.png" name="parameters" title="General parameters" visibleIf="[/tmp/queryAdd/@reverseLink]!=1 AND (([/tmp/queryAdd/@dataType]='linkedData' AND [/tmp/queryAdd/@recipientLink]!='') OR [/tmp/queryAdd/@dataType]='distantData' OR [/tmp/queryAdd/@dataType]='extSharedData' OR [/tmp/queryAdd/@dataType]='externalData')" xpath="/tmp/queryAdd">
              <static type="help">Select an identifier and a label to easily find the stored values during the rest of segmentation.</static>
              <input label="Identifier" required="true" size="24" xpath="@collName"/>
              <container type="visibleGroup" visibleIf="IndexOf(@collNameList, '|' + @collName + '|')>=0">
                <static type="warning">The identifier above is already used, the new configuration will replace the existing one.</static>
              </container>
              <input label="Label" xpath="@label"/>
              <input enum="xtk:queryDef:rowConditionType" label="Data collected" type="sysEnum" xpath="@rowCount"/>
              <input expr="Iif(@rowCount>1, 1, Iif(@rowCount=-1, 0, NodeValue('/tmp/queryAdd/@lineCount')))" type="expr" xpath="@lineCount"/>
              <container type="visibleGroup" visibleIf="@rowCount==0 OR @rowCount==2">
                <input label="Lines to retrieve" type="number" xpath="@lineCount"/>
              </container>
              <container backcolor="tooltip" type="visibleGroup" visibleIf="@rowCount==1">
                <static type="warning">This mode optimizes the generated SQL query thanks to a direct join on the collection elements. \nWarning: if the initial condition isn't complied with, the result may be false (missing lines or duplicates).</static>
              </container>
              <container type="visibleGroup" visibleIf="@rowCount==2 AND @lineCount > 1">
                <input label="Group aggregates based on the values in the sort columns" type="checkBox" xpath="@useOrderByValuesAsRank"/>
                <static type="help">E.g.: In case of an aggregate calculation with a grouping on the last 5 years: - if the option is checked, aggregates will be calculated for the same 5 years for the entire population - if the option isn't checked, aggregates will be calculated for the last 5 years for each element of the population.</static>
              </container>
              <leave>
                <check expr="@collName!=''">
                  <error>Please specify an identifier for the storage of additional data.</error>
                </check>
                <set translatedExpr="Iif(@rowCount=0, 'Several rows'+' - ' + @lineCount, Iif(@rowCount=1, 'Aggregates', 'Single row'))" xpath="@collectDesc"/>
              </leave>
            </container>
            <container descExpr="'Enter the filtering condition for determining which collection elements to keep.\nAs a reminder, you have chosen to recover ' + Iif([/tmp/queryAdd/@rowCount]=0, [/tmp/queryAdd/@lineCount] + ' line(s)', Iif([/tmp/queryAdd/@rowCount]=1, 'a single row', 'aggregates'))" img="xtk:filter32.png" title="Filter" visibleIf="[/tmp/queryAdd/@lineCount]>0" xpath="/tmp/queryAdd/collection">
              <enter>
                <if expr="[../@dataType]='extSharedData' or [../@dataType]='externalData'">
                  <set expr="[../@targetSchema]" xpath="@schema"/>
                </if>
                <if expr="[../@dataType]='distantData'">
                  <set expr="GetLinkSchema([../@filterSchema], [../@filterLink])" xpath="@schema"/>
                </if>
                <if expr="[../@dataType]='distantData' AND $(BUILD_NUMBER)>6797">
                  <set expr="wkfBuildTargetDataLink(GetLinkSchema([../@filterSchema], [../@filterLink]), [../@filterSchema])" xpath="@schema"/>
                </if>
                <if expr="[../@dataType]='linkedData'">
                  <set expr="[../@schema]" xpath="@schema"/>
                </if>
              </enter>
              <container buildQueryXPath="." ref="xtk:queryDef:where"/>
            </container>
            <container descExpr="'Indicate the sorting order which defines the lines to be kept in case the number of eligible lines exceeds the number of lines to recover following filtering.\nAs a reminder, you have chosen to recover ' + [/tmp/queryAdd/@lineCount] + ' line(s)'" img="xtk:filter32.png" title="Sort" visibleIf="[/tmp/queryAdd/@rowCount]==3 OR [/tmp/queryAdd/@rowCount]==0 OR ([/tmp/queryAdd/@rowCount]==2 AND [/tmp/queryAdd/@lineCount]>1)" xpath="/tmp/queryAdd/collection">
              <container type="visibleGroup" visibleIf="[/tmp/queryAdd/@useOrderByValuesAsRank]">
                <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                  <input colSize="20" label="Label" xpath="@label"/>
                  <input colSize="35" editable="true" label="Expression" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                  <input colSize="15" editable="true" label="Descending" type="checkbox" xpath="@sortDesc"/>
                  <input colSize="20" editable="true" label="Identifier" type="edit" xpath="@alias"/>
                </input>
                <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@help"/>
              </container>
              <container type="visibleGroup" visibleIf="![/tmp/queryAdd/@useOrderByValuesAsRank]">
                <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                  <input colSize="20" label="Label" xpath="@label"/>
                  <input colSize="35" editable="true" label="Expression" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                  <input colSize="15" editable="true" label="Descending" type="checkbox" xpath="@sortDesc"/>
                </input>
                <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@help"/>
              </container>
            </container>
            <container desc="Select the data to keep." img="xtk:filter32.png" title="Data to add" visibleIf="[/tmp/queryAdd/@rowCount]!=-1 AND ([/tmp/queryAdd/@dataType]='linkedData' OR [/tmp/queryAdd/@dataType]='distantData' OR [/tmp/queryAdd/@dataType]='extSharedData' OR [/tmp/queryAdd/@dataType]='externalData')" xpath="/tmp/queryAdd/collection">
              <enter>
                <set expr="Iif([/tmp/queryAdd/@rowCount]=2 OR ([/tmp/selectCtrl/in/@recipientLink]!='' AND @recipientLink=''), 'aggregate', '')" xpath="/tmp/selectCtrl/in/@choiceType"/>
              </enter>
              <container hideUnboundPath="false" name="selectCtrl" type="querySelectContainer" xpath=".">
                <container name="vpaned" type="vpaned">
                  <container name="schema">
                    <static fontBold="true" label="Available fields:"/>
                    <container colcount="2">
                      <static img="xtk:filter.png" type="image"/>
                      <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                    </container>
                    <input checkDuplicates="false" hideMappedAsXml="true" name="schemaView" showLinks1="true" type="SchemaView" xpath="/tmp/queryAdd/collection/@schema" xpathFilter="85" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="select/node/@expr"/>
                  </container>
                  <container name="output" xpathsToLoad="output*">
                    <static fontBold="true" label="Output columns:"/>
                    <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" xpath="select/node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupBy="groupBy/node" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHaving="having/condition" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="/tmp/queryAdd/collection/@schema" xpathSelection="/tmp/outputColumn/itn/@current" zoom="false">
                      <input colSize="20" label="Label" xpath="@label"/>
                      <input colSize="35" label="Expression" type="pathedit" useUnboundPath="true" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/queryAdd/collection/@schema"/>
                      <input colSize="20" label="Alias" xpath="@alias"/>
                      <input colSize="20" label="Group" type="checkbox" xpath="@groupBy"/>
                      <input colSize="20" label="Enabled if" type="pathedit" useUnboundPath="false" xpath="@enabledIf" xpathSchema="/tmp/queryAdd/collection/@schema"/>
                      <form label="Column definition" name="colDetail">
                        <input xpath="@label"/>
                        <container name="extraFields"/>
                        <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="/tmp/queryAdd/collection/@schema"/>
                        <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                          <container colcount="2" cols-width="100,1">
                            <container>
                              <static fontBold="true" label="Available fields:"/>
                              <container colcount="2">
                                <static img="xtk:filter.png" type="image"/>
                                <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                              </container>
                              <input type="schemaview" xpath="/tmp/queryAdd/collection/@schema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                            </container>
                            <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                          </container>
                          <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                        </container>
                        <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                      </form>
                    </input>
                  </container>
                </container>
                <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
              </container>
            </container>
            <container desc="Select the type of link and the target of your link." img="nms:activities/links.png" title="Link definition" visibleIf="SubString([/tmp/queryAdd/@dataType],0,7)='linkDef'" xpath="/tmp/queryAdd">
              <enter>
                <if expr="[linkedDef/@useTempSchema]==''">
                  <set value="0" xpath="linkedDef/@useTempSchema"/>
                </if>
              </enter>
              <static label="Link type" type="separator"/>
              <container colcount="2">
                <input img="xtk:xtklinkn.png" type="image"/>
                <input checkedValue="linkDefColl" label="Define a collection" type="radioButton" xpath="@dataType"/>
                <input img="xtk:xtklink1.png" type="image"/>
                <input checkedValue="linkDef" label="Define a link whose target is always available" type="radioButton" xpath="@dataType"/>
                <input img="xtk:xtklink0.png" type="image"/>
                <input checkedValue="linkDefExt" label="Define a link whose target may not exist in the database" type="radioButton" xpath="@dataType"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/queryAdd/@entityName]='enrich'">
                  <input img="xtk:xtklinkr.png" type="image"/>
                  <input checkedValue="linkDefRef" label="Define a link by searching for a reference among several options" type="radioButton" xpath="@dataType"/>
                  <static colspan="2" type="help">This last option lets you define possible deduplication conditions in case of insufficient join conditions.</static>
                </container>
              </container>
              <static label="Link target" type="separator"/>
              <container>
                <input checkedValue="0" label="Database schema" type="RadioButton" xpath="linkedDef/@useTempSchema"/>
                <input checkedValue="1" label="Temporary schema" type="RadioButton" xpath="linkedDef/@useTempSchema"/>
                <container type="visibleGroup" visibleIf="[linkedDef/@useTempSchema]==0">
                  <input label="Target schema" schema="xtk:schema" type="schemaEdit" xpath="linkedDef/@schema"/>
                </container>
                <container type="visibleGroup" visibleIf="[linkedDef/@useTempSchema]==1">
                  <input label="Target schema" type="ExclusionMainSetEdit" xpath="linkedDef/@srcDataSet" xpathActivityName="@activityName"/>
                  <input expr="wkfSchemaName([linkedDef/@srcDataSet])" type="expr" xpath="linkedDef/@schema"/>
                </container>
              </container>
              <leave>
                <check expr="[linkedDef/@schema]!=''">
                  <error>Please define the link target.</error>
                </check>
              </leave>
            </container>
            <container desc="Enter the keys for linking the document to the target of your link" img="nms:activities/links.png" title="Link definition" visibleIf="SubString([/tmp/queryAdd/@dataType], 0, 7)='linkDef'" xpath="/tmp/queryAdd/linkedDef">
              <enter>
                <set expr="Iif(@advancedJoin=='', 0, @advancedJoin)" xpath="@advancedJoin"/>
                <if expr="[../@collName]=''">
                  <set expr="ExtractRight(@schema, ':')" xpath="../@collName"/>
                  <set value="[.]" xpath="../@rootXPath"/>
                  <set expr="LabelOf('/tmp/queryAdd/@rootXPath', '/tmp/queryAdd/linkedDef/@schema')" xpath="../@label"/>
                </if>
                <set value="-2" xpath="/tmp/queryAdd/@rowCount"/>
              </enter>
              <input label="Identifier" required="true" xpath="../@collName"/>
              <container type="visibleGroup" visibleIf="IndexOf([../@collNameList], '|' + [../@collName] + '|')>=0">
                <static type="warning">The identifier above is already used, the new configuration will replace the existing one</static>
              </container>
              <input label="Label" xpath="../@label"/>
              <static label="Join conditions" type="separator"/>
              <input checkedValue="0" label="Use a simple join" nolabel="false" type="radioButton" xpath="@advancedJoin"/>
              <input checkedValue="1" label="Advanced join conditions" nolabel="false" type="radioButton" xpath="@advancedJoin"/>
              <container type="visibleGroup" visibleIf="[/tmp/queryAdd/@dataType] = 'linkDefRef'">
                <input checkedValue="2" label="Reconciliation rules" nolabel="false" type="radioButton" xpath="@advancedJoin"/>
              </container>
              <input expr="wkfAddLinkDefToSchema([/tmp/queryAdd/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [@advancedJoin]!=0, @schema, ''))" type="expr" xpath="/ignored/@advancedJoinQueryAddSchema">
                <enter>
                  <if expr="@advancedJoin!='' AND @advancedJoin!=1 AND NodeCount([join/condition])>0">
                    <msgBox translatedExpr="'Do you want to delete the advanced join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                    <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                      <reset xpath="join/condition[*]"/>
                      <refresh xpath="join"/>
                    </if>
                    <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                      <set value="1" xpath="@advancedJoin"/>
                    </if>
                  </if>
                  <if expr="@advancedJoin!='' AND @advancedJoin!=0 AND NodeCount([condition])>0">
                    <msgBox translatedExpr="'Do you want to delete the join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                    <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                      <reset xpath="condition[*]"/>
                    </if>
                    <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                      <set value="0" xpath="@advancedJoin"/>
                    </if>
                  </if>
                </enter>
              </input>
              <container type="visibleGroup" visibleIf="@advancedJoin==0">
                <static label=" " nolabel="false" type="help">Select below the source and target fields that will be matched to build the join condition.</static>
                <input label=" " toolbarCaption="Join conditions" type="list" xpath="condition">
                  <input label="Source" type="pathEdit" xpath="@srcExpr" xpathSchema="/tmp/queryAdd/@schema"/>
                  <input label="Target" type="pathEdit" xpath="@dstExpr" xpathSchema="../@schema"/>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="@advancedJoin==1">
                <static label=" " nolabel="false" type="help">Select below the relationship conditions between source and target records. The 'joinTarget (Dynamic link)' link enables you to reference target fields to define joins.</static>
                <input label=" " name="filterList" noSaveFilter="true" toolbarAlign="horizontal" toolbarCaption="Join conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="/tmp/queryAdd/@schema">
                  <input colSize="15" label=" " xpath="/@bool-operator"/>
                  <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                  <input colSize="15" label="Operator" xpath="/@operator"/>
                  <input colSize="30" label="Value" xpath="/@rightExpr"/>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@advancedJoin=2">
                <static label=" " nolabel="false" type="help">Select the conditions for reconciling source and target records below. When reconciliation criteria aren't reliable enough, you can refine reconciliation using proximity scores. The 'joinTarget (Dynamic link)' link lets you reference the fields of the target to define the join.</static>
                <container label=" " nolabel="false" style="down" type="notebook">
                  <container label="Identification">
                    <input editable="false" nolabel="true" prebuildSubForm="false" toolbarCaption="Reconciliations" type="list" xpath="keys" xpathToIgnore="keys/scoreRule" zoom="true" zoomOnAdd="true">
                      <input editable="true" expr="Iif(@label!='', @label, [join/@displayFilter])" label="Identification conditions" xpath="@label"/>
                      <input expr="Iif(@scoresApplied!='none', @minScore, '')" label="Required score"/>
                      <input expr="Iif(@scoresApplied=='all', [/ignored/@allLabel], Iif(@scoresApplied=='select', GroupConcat(scoreRule, &quot; '[' + @name + ']' &quot; ), ''))" label="Scores taken into account"/>
                      <form title="Reconciliation rule" type="wizard">
                        <enter>
                          <set value="true" xpath="@active"/>
                          <set expr="Iif(@id!='', @id, Gid())" xpath="@id"/>
                          <set expr="Iif(@scoresApplied=='none' OR @scoresApplied=='', 0, 1)" xpath="/tmp/@ruleReconcWithScore"/>
                          <set expr="Iif(@scoresApplied!='select', 0, 1)" xpath="/tmp/@ruleReconcRuleSel"/>
                        </enter>
                        <container desc="Specify below the conditions for identifying the target record" title="Join conditions">
                          <input label="label" xpath="@label"/>
                          <input label=" " name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Reconciliation conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="join/@displayFilter" xpathSchema="/tmp/selectCtrl/in/@schema">
                            <input colSize="15" label=" " xpath="/@bool-operator"/>
                            <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                            <input colSize="15" label="Operator" xpath="/@operator"/>
                            <input colSize="30" label="Value" xpath="/@rightExpr"/>
                          </input>
                          <input checkedValue="1" label="Refine reconciliation using proximity scores" nolabel="true" type="checkBox" unCheckedValue="0" xpath="/tmp/@ruleReconcWithScore"/>
                        </container>
                        <container desc="Select below the proximity scores to be taken into account to refine reconciliation, then define the reconciliation approval threshold." title="Proximity scores" visibleIf="[/tmp/@ruleReconcWithScore]=1">
                          <enter>
                            <reset xpath="/tmp/ruleReconcSel"/>
                            <copyElement list="true" xpathDst="/tmp/ruleReconcSel/rules" xpathSrc="../scoreRule"/>
                            <forEach xpath="scoreRule">
                              <set value="1" xpathExpr="'/tmp/ruleReconcSel/rules/scoreRule[@name=\''+@name+'\']/@sel'"/>
                            </forEach>
                          </enter>
                          <input checkedValue="0" label="All calculation rules" nolabel="true" type="radioButton" xpath="/tmp/@ruleReconcRuleSel"/>
                          <input checkedValue="1" label="A selection of rules" nolabel="true" type="radioButton" xpath="/tmp/@ruleReconcRuleSel"/>
                          <container enabledIf="[/tmp/@ruleReconcRuleSel]==1" type="enabledGroup">
                            <input noToolbar="true" nolabel="true" type="list" xpath="/tmp/ruleReconcSel/rules/scoreRule">
                              <input colSize="10" label="Selected" type="checkBox" xpath="@sel"/>
                              <input label="Proximity score" xpath="@name"/>
                              <input label="Score" xpath="@score"/>
                            </input>
                          </container>
                          <static type="help">Specify below the minimum proximity score required to approve reconciliation.</static>
                          <input label="Minimum score" type="number" xpath="@minScore"/>
                        </container>
                        <leave>
                          <set expr="Iif([/tmp/@ruleReconcWithScore]==0, 'none', IIf([/tmp/@ruleReconcRuleSel]==0, 'all', 'select'))" xpath="@scoresApplied"/>
                          <if expr="[/tmp/@ruleReconcRuleSel]==1 AND [/tmp/@ruleReconcWithScore]==1">
                            <reset xpath="scoreRule[*]"/>
                            <copyElement filter="@sel=1" list="true" xpathDst="." xpathSrc="/tmp/ruleReconcSel/rules/scoreRule"/>
                          </if>
                        </leave>
                      </form>
                    </input>
                  </container>
                  <container label="Proximity scores">
                    <input editable="false" nolabel="true" prebuildSubForm="false" toolbarCaption="Calculation rules of the proximity score" type="list" xpath="scoreRule" zoom="true" zoomOnAdd="true">
                      <input label="Name" xpath="@name"/>
                      <input label="Score" xpath="@score"/>
                      <input label="Condition" xpath="join/@displayFilter"/>
                      <form colcount="2" label="Proximity score">
                        <enter>
                          <set value="true" xpath="@active"/>
                          <set expr="Iif(@id!='', @id, Gid())" xpath="@id"/>
                        </enter>
                        <input label="Name" xpath="@name"/>
                        <input label="Score" type="number" xpath="@score"/>
                        <input colspan="2" name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Conditions for triggering score adding" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="join/@displayFilter" xpathSchema="/tmp/selectCtrl/in/@schema">
                          <input colSize="15" label=" " xpath="/@bool-operator"/>
                          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                          <input colSize="15" label="Operator" xpath="/@operator"/>
                          <input colSize="30" label="Value" xpath="/@rightExpr"/>
                        </input>
                      </form>
                    </input>
                  </container>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="[../@dataType]=='linkDefRef'">
                <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath=".">
                  <form label="Link definition: advanced parameters">
                    <enter>
                      <set expr="Iif(@singleRow!=1, Iif(NodeCount([where/condition])=0 AND NodeCount([orderBy/node])=0, 1, 2), 0)" xpath="/tmp/@linkDedup"/>
                      <set expr="wkfBuildTargetDataLink(@schema, [/tmp/selectCtrl/in/@schema])" xpath="/tmp/@linkDedupSchema"/>
                    </enter>
                    <static label="Link handling" type="separator"/>
                    <input type="pathEdit" xpath="@enabledIf" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                    <input label="Authorize empty values during reconciliation" type="checkBox" xpath="@allowEmptyPart"/>
                    <static label="Deduplication" type="separator"/>
                    <input checkedValue="1" label="Choose for me from those that match a filter" type="radioButton" xpath="/tmp/@linkDedup"/>
                    <container type="visibleGroup" visibleIf="[/tmp/@linkDedup]=1">
                      <container type="visibleGroup" visibleIf="NodeCount([where/condition])=0">
                        <input label="Add a filter for target records..." nolabel="false" type="subformLink" xpath=".">
                          <form label="Link target filter">
                            <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            </input>
                          </form>
                        </input>
                      </container>
                      <container type="visibleGroup" visibleIf="NodeCount([where/condition])>0">
                        <input label="Edit the filter..." nolabel="false" type="subformLink" xpath=".">
                          <form label="Link target filter">
                            <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            </input>
                          </form>
                        </input>
                        <input label=" " lineCount="4" xpath="where/@displayFilter"/>
                      </container>
                    </container>
                    <input checkedValue="0" label="Do not deduplicate linked records (Expert mode - only one record matches the criteria)" type="radioButton" xpath="/tmp/@linkDedup"/>
                    <container type="visibleGroup" visibleIf="[/tmp/@linkDedup]=2">
                      <container type="visibleGroup" visibleIf="NodeCount([where/condition])=0">
                        <input label="Add a filter for target records..." nolabel="false" type="subformLink" xpath=".">
                          <form label="Link target filter">
                            <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            </input>
                          </form>
                        </input>
                      </container>
                      <container type="visibleGroup" visibleIf="NodeCount([where/condition])>0">
                        <input label="Edit the filter..." nolabel="false" type="subformLink" xpath=".">
                          <form label="Link target filter">
                            <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            </input>
                          </form>
                        </input>
                        <input label=" " lineCount="4" xpath="where/@displayFilter"/>
                      </container>
                    </container>
                    <input checkedValue="2" label="Specify the selection and deduplication conditions of records" type="radioButton" xpath="/tmp/@linkDedup"/>
                    <container type="visibleGroup" visibleIf="[/tmp/@linkDedup]=2">
                      <container style="flat" type="notebook">
                        <container label="Filter">
                          <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="@schema">
                            <input colSize="15" label=" " xpath="/@bool-operator"/>
                            <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                            <input colSize="15" label="Operator" xpath="/@operator"/>
                            <input colSize="30" label="Value" xpath="/@rightExpr"/>
                          </input>
                        </container>
                        <container label="Sort">
                          <input editable="false" name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" xpathSchema="@schema" zoom="false">
                            <input colSize="20" label="Label" xpath="@label"/>
                            <input choiceType="sortAggregate" colSize="35" editable="true" label="Expression" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                            <input colSize="15" editable="true" label="Descending sort" type="checkbox" xpath="@sortDesc"/>
                          </input>
                        </container>
                      </container>
                    </container>
                    <leave>
                      <set expr="Iif([/tmp/@linkDedup]>0, 0, 1)" xpath="@singleRow"/>
                      <if expr="[/tmp/@linkDedup]=1">
                        <reset xpath="orderBy"/>
                      </if>
                    </leave>
                  </form>
                </input>
              </container>
            </container>
            <leave>
              <set expr="wkfAddLinkDefToSchema([/tmp/queryAdd/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], '')" xpath="/ignored/@advancedJoinQueryAddSchema"/>
              <set expr="ToIdentifier([/tmp/queryAdd/@collName])" xpath="/tmp/queryAdd/@collName"/>
              <check expr="[/tmp/queryAdd/@collName]!=''">
                <error>Please specify an identifier for the storage of additional data.</error>
              </check>
              <if expr="[/tmp/queryAdd/@dataType]='extSharedData' OR [/tmp/queryAdd/@dataType]='externalData'">
                <set expr="Iif([/tmp/queryAdd/@dataType]='extSharedData', 'nms:extAccount:'+[/tmp/queryAdd/dataSourceDesc/@name], 'crypted:'+AESEncrypt([/tmp/queryAdd/@dataSource]))" xpath="/tmp/queryAdd/extension/element/@dataSource"/>
                <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/extension/@label"/>
                <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/extension/element/@label"/>
                <copyElement exprDst="'extension/schema[@name=\''+[/tmp/queryAdd/@tableName]+'\']'" xpathSrc="/tmp/queryAdd/extension"/>
                <set expr="[/tmp/queryAdd/@targetSchema]" xpath="/tmp/queryAdd/element/@target"/>
                <set expr="@name + '_' + ToIdentifier([/tmp/queryAdd/@tableName])" xpath="/tmp/queryAdd/element/@name"/>
                <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/element/@label"/>
                <set value="1" xpath="/tmp/queryAdd/element/@unbound"/>
                <set value="link" xpath="/tmp/queryAdd/element/@type"/>
                <if expr="[/tmp/queryAdd/@reverseLink]=1">
                  <set expr="@name + '_' + ExtractRight([/tmp/selectCtrl/in/@schema], ':')" xpath="/tmp/queryAdd/element/@revLink"/>
                </if>
                <copyElement exprDst="'extension/schema[@name=\''+ ExtractRight([/tmp/selectCtrl/in/@schema], ':')+'\']/element[@name=\''+ ExtractRight([/tmp/selectCtrl/in/@schema], ':')+'\']/element[@name=\'' + @name + '_' + ToIdentifier([/tmp/queryAdd/@tableName]) + '\']'" xpathSrc="/tmp/queryAdd/element"/>
                <set expr="Extract([/tmp/selectCtrl/in/@schema], ':')" xpathExpr="'extension/schema[@name=\''+ ExtractRight([/tmp/selectCtrl/in/@schema], ':')+'\']/@namespace'"/>
                <set expr="[/tmp/selectCtrl/in/@schema]" xpathExpr="'extension/schema[@name=\''+ ExtractRight([/tmp/selectCtrl/in/@schema], ':')+'\']/@extendedSchema'"/>
              </if>
              <if expr="[/tmp/queryAdd/@reverseLink]!=1 AND SubString([/tmp/queryAdd/@dataType],0,7)!='linkDef'">
                <set expr="[/tmp/queryAdd/@collName]" xpath="/tmp/queryAdd/collection/@alias"/>
                <if expr="[/tmp/queryAdd/@dataType]='linkedData' AND [/tmp/queryAdd/@recipientLink]!=''">
                  <set expr="GetRevXPath([/tmp/queryAdd/@schema], [/tmp/queryAdd/@recipientLink])" xpath="/tmp/queryAdd/collection/select/@expr"/>
                </if>
                <if expr="[/tmp/queryAdd/@dataType]='distantData'">
                  <set expr="[/tmp/queryAdd/@filterLink]" xpath="/tmp/queryAdd/collection/select/@expr"/>
                </if>
                <if expr="[/tmp/queryAdd/@dataType]='extSharedData' OR [/tmp/queryAdd/@dataType]='externalData'">
                  <set expr="@name + '_' + ToIdentifier([/tmp/queryAdd/@tableName])" xpath="/tmp/queryAdd/collection/select/@expr"/>
                </if>
                <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/collection/select/@label"/>
                <set expr="ExpandXPath([/tmp/queryAdd/collection/select/@expr])" xpath="/tmp/queryAdd/collection/select/@expr"/>
                <set expr="[/tmp/queryAdd/@collName]" xpath="/tmp/queryAdd/collection/select/@alias"/>
                <set value="1" xpath="/tmp/queryAdd/collection/select/@noComputeString"/>
                <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/collection/@label"/>
                <if expr="[/tmp/queryAdd/@dataType]='linkedData' OR [/tmp/queryAdd/@dataType]='distantData' OR [/tmp/queryAdd/@dataType]='extSharedData' OR [/tmp/queryAdd/@dataType]='externalData'">
                  <set expr="Iif(StartWith([/tmp/queryAdd/collection/select/@expr], '['), SubString([/tmp/queryAdd/collection/select/@expr], 1, StrLen([/tmp/queryAdd/collection/select/@expr])-2),[/tmp/queryAdd/collection/select/@expr])" xpath="/tmp/queryAdd/collection/@xpath"/>
                </if>
                <if expr="[/tmp/queryAdd/@dataType]='score'">
                  <set expr="'ToDouble(PredictiveScore(\''+[/tmp/queryAdd/@predictiveModel-name]+'\'))'" xpath="/tmp/queryAdd/collection/select/@expr"/>
                </if>
                <if expr="[/tmp/queryAdd/@dataType]='offer'">
                  <set expr="NodeValue('/tmp/queryAdd/offerCategory')" xpath="/tmp/queryAdd/@offerCategory-id"/>
                  <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/collection/@label"/>
                  <set expr="@name + '_prop_' + [/tmp/queryAdd/@collName]" xpath="/tmp/queryAdd/collection/@xpath"/>
                  <set value="nms:offerView" xpath="/tmp/queryAdd/@outputSchema"/>
                  <if expr="[/tmp/queryAdd/@calcOffer]='forced'">
                    <set expr="'Propositions(\'' + [/tmp/queryAdd/@offer-name] + '\', \'' + [/tmp/queryAdd/@offerEnv-name] + ':' + [/tmp/queryAdd/@offerSpace-name]+'\', #'+[/tmp/queryAdd/@contactDate]+'#)'" xpath="/tmp/queryAdd/collection/@expr"/>
                    <set expr="[/tmp/queryAdd/@offer-id]" xpath="/tmp/queryAdd/collection/select/node/@expr"/>
                    <set value="@offer-id" xpath="/tmp/queryAdd/collection/select/node/@alias"/>
                    <set value="[@offer-id]" xpath="/tmp/queryAdd/@channelXPath"/>
                    <set expr="LabelOf('/tmp/queryAdd/@channelXPath', '/tmp/queryAdd/@outputSchema')" xpath="/tmp/queryAdd/collection/select/node/@label"/>
                  </if>
                  <if expr="[/tmp/queryAdd/@calcOffer]!='forced'">
                    <if expr="[/tmp/queryAdd/@offerCategory-id]!='' AND [/tmp/queryAdd/@offerCategory-id]!=0">
                      <set value="nms:offerCategory" xpath="/ignored/queryDefCategCheck/@schema"/>
                      <set value="get" xpath="/ignored/queryDefCategCheck/@operation"/>
                      <set value="[.]" xpath="/ignored/queryDefCategCheck/select/node/@expr"/>
                      <set value="@id" xpath="/ignored/queryDefCategCheck/select/node[2]/@expr"/>
                      <set value="@name" xpath="/ignored/queryDefCategCheck/select/node[3]/@expr"/>
                      <set expr="'@id='+[/tmp/queryAdd/@offerCategory-id]" xpath="/ignored/queryDefCategCheck/where/condition/@expr"/>
                      <soapCall name="ExecuteQuery" service="xtk:queryDef">
                        <param exprIn="[/ignored/queryDefCategCheck]" type="DOMDocument"/>
                        <param type="DOMDocument" xpathOut="/ignored/queryAddCateg"/>
                      </soapCall>
                      <set expr="[/ignored/queryAddCateg/@name]" xpath="/tmp/queryAdd/@offerCategory-name"/>
                    </if>
                    <set expr="'Propositions('+[/tmp/queryAdd/@offerSpace-id]+', '+Iif([/tmp/queryAdd/@offerCategory-id]='', 0, [/tmp/queryAdd/@offerCategory-id])+', \''+[/tmp/queryAdd/@offerThemes]+'\', #'+[/tmp/queryAdd/@contactDate]+'#)'" xpath="/tmp/queryAdd/collection/@expr"/>
                  </if>
                  <set expr="[/tmp/queryAdd/@propositionSchema]" xpath="/tmp/queryAdd/collection/@schema"/>
                  <set expr="@name + '_prop_' + [/tmp/queryAdd/@collName]" xpath="/tmp/queryAdd/collection/select/@expr"/>
                  <set expr="[/tmp/queryAdd/@channel]" xpath="/tmp/queryAdd/collection/select/node[-1]/@expr"/>
                  <set expr="NodeCount([/tmp/queryAdd/collection/select/node])" xpath="/tmp/queryAdd/@nodeCount"/>
                  <set value="@channel" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@alias'"/>
                  <set value="nms:delivery:@messageType" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@ref'"/>
                  <set value="[offerSpace/@channel]" xpath="/tmp/queryAdd/@channelXPath"/>
                  <set expr="LabelOf('/tmp/queryAdd/@channelXPath', '/tmp/queryAdd/collection/@schema')" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@label'"/>
                  <set expr="[/tmp/queryAdd/@offerSpace-id]" xpath="/tmp/queryAdd/collection/select/node[-1]/@expr"/>
                  <set expr="NodeCount([/tmp/queryAdd/collection/select/node])" xpath="/tmp/queryAdd/@nodeCount"/>
                  <set value="@offerSpace-id" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@alias'"/>
                  <set value="[@offerSpace-id]" xpath="/tmp/queryAdd/@channelXPath"/>
                  <set expr="LabelOf('/tmp/queryAdd/@channelXPath', '/tmp/queryAdd/collection/@schema')" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@label'"/>
                  <set expr="'\'nms:offerView\''" xpath="/tmp/queryAdd/collection/select/node[-1]/@expr"/>
                  <set expr="NodeCount([/tmp/queryAdd/collection/select/node])" xpath="/tmp/queryAdd/@nodeCount"/>
                  <set value="@offerViewSchema" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@alias'"/>
                  <set value="nms:offerView" xpath="/tmp/queryAdd/@channelXPath"/>
                  <set expr="SchemaLabel('/tmp/queryAdd/@channelXPath')" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@label'"/>
                  <set value="offer" xpath="/tmp/queryAdd/collection/select/node[-1]/@expr"/>
                  <set expr="NodeCount([/tmp/queryAdd/collection/select/node])" xpath="/tmp/queryAdd/@nodeCount"/>
                  <set value="offer" xpath="/tmp/queryAdd/@channelXPath"/>
                  <set expr="LabelOf('/tmp/queryAdd/@channelXPath', '/tmp/queryAdd/@outputSchema')" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@label'"/>
                  <set value="offerSpace" xpath="/tmp/queryAdd/collection/select/node[-1]/@expr"/>
                  <set expr="NodeCount([/tmp/queryAdd/collection/select/node])" xpath="/tmp/queryAdd/@nodeCount"/>
                  <set value="offerSpace" xpath="/tmp/queryAdd/@channelXPath"/>
                  <set translatedExpr="'Location'" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@label'"/>
                  <set expr="@name + '_prop_' + [/tmp/queryAdd/@collName]" xpath="/tmp/queryAdd/collection/select/node[-1]/@expr"/>
                  <set expr="NodeCount([/tmp/queryAdd/collection/select/node])" xpath="/tmp/queryAdd/@nodeCount"/>
                  <set translatedExpr="'Representation'" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@label'"/>
                  <set value="offerView" xpathExpr="'/tmp/queryAdd/collection/select/node[' + [/tmp/queryAdd/@nodeCount] + ']/@alias'"/>
                  <set expr="ExtractRight([/tmp/selectCtrl/in/@schema], ':')" xpath="/tmp/queryAdd/@targetSchemaName"/>
                  <set expr="'extension/schema[@name=\''+ ExtractRight([/tmp/selectCtrl/in/@schema], ':')+'\']'" xpath="/tmp/queryAdd/@schemaExpr"/>
                  <set expr="Extract([/tmp/selectCtrl/in/@schema], ':')" xpathExpr="[/tmp/queryAdd/@schemaExpr] + '/@namespace'"/>
                  <set expr="[/tmp/selectCtrl/in/@schema]" xpathExpr="[/tmp/queryAdd/@schemaExpr] + '/@extendedSchema'"/>
                  <set expr="[/tmp/queryAdd/@schemaExpr] + '/element[@name=\''+ [/tmp/queryAdd/@targetSchemaName] +'\']/element[@name=\''+ @name + '_prop_' + [/tmp/queryAdd/@collName]+'\']'" xpath="/tmp/queryAdd/@linkToPropXPath"/>
                  <set value="link" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@type'"/>
                  <set expr="[/tmp/queryAdd/@label]" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@label'"/>
                  <set expr="[/tmp/queryAdd/@propositionSchema]" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@target'"/>
                  <set value="1" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@unbound'"/>
                  <set expr="ExtractRight([/tmp/queryAdd/@propositionSchema], ':')" xpath="/tmp/queryAdd/@targetPropSchemaName"/>
                  <set expr="'extension/schema[@name=\''+ ExtractRight([/tmp/queryAdd/@propositionSchema], ':')+'\']'" xpath="/tmp/queryAdd/@schemaExpr"/>
                  <set expr="Extract([/tmp/queryAdd/@propositionSchema], ':')" xpathExpr="[/tmp/queryAdd/@schemaExpr] + '/@namespace'"/>
                  <set expr="[/tmp/queryAdd/@propositionSchema]" xpathExpr="[/tmp/queryAdd/@schemaExpr] + '/@extendedSchema'"/>
                  <set expr="[/tmp/queryAdd/@schemaExpr] + '/element[@name=\''+ [/tmp/queryAdd/@targetPropSchemaName] +'\']/element[@name=\''+ @name + '_prop_' + [/tmp/queryAdd/@collName]+'\']'" xpath="/tmp/queryAdd/@linkToPropXPath"/>
                  <set value="link" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@type'"/>
                  <set translatedExpr="'Representation'" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@label'"/>
                  <set expr="[/tmp/queryAdd/@outputSchema]" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@target'"/>
                  <set value="0" xpathExpr="[/tmp/queryAdd/@linkToPropXPath] + '/@unbound'"/>
                </if>
                <if expr="([/tmp/queryAdd/@dataType]='linkedData' AND [/tmp/queryAdd/@recipientLink]='')">
                  <copyElement list="true" xpathDst="select" xpathSrc="/tmp/queryAdd/collection/select/node"/>
                </if>
                <if expr="([/tmp/queryAdd/@dataType]!='linkedData' OR [/tmp/queryAdd/@recipientLink]!='')">
                  <copyElement exprDst="'select/node['+Iif([/tmp/queryAdd/@collName]=='', '@expr=\'' + [/tmp/queryAdd/collection/select/@expr] + '\'', '@alias=\'' + [/tmp/queryAdd/@collName] + '\'')+']'" xpathSrc="/tmp/queryAdd/collection/select"/>
                </if>
              </if>
              <reset xpath="/tmp/queryAdd/collection/select"/>
              <if expr="[/tmp/queryAdd/@rowCount]=0">
                <set value="0" xpath="/tmp/queryAdd/collection/@singleRow"/>
                <set value="0" xpath="/tmp/queryAdd/collection/@groupBy"/>
                <set expr="[/tmp/queryAdd/@lineCount]" xpath="/tmp/queryAdd/collection/@lineCount"/>
              </if>
              <if expr="[/tmp/queryAdd/@rowCount]=1 OR [/tmp/queryAdd/@dataType]='offer'">
                <set expr="Iif([/tmp/queryAdd/@calcOffer]='dynamic' AND [/tmp/queryAdd/@dataType]='offer', [/tmp/queryAdd/@offerCount]=1, 1)" xpath="/tmp/queryAdd/collection/@singleRow"/>
                <set expr="Iif([/tmp/queryAdd/@calcOffer]='dynamic' AND [/tmp/queryAdd/@dataType]='offer', [/tmp/queryAdd/@offerCount], 1)" xpath="/tmp/queryAdd/collection/@lineCount"/>
                <set value="0" xpath="/tmp/queryAdd/collection/@groupBy"/>
                <if expr="[/tmp/queryAdd/@dataType]='offer'">
                  <if expr="[/tmp/queryAdd/@offerCount]>1">
                    <set value="@rank" xpath="/tmp/queryAdd/collection/orderBy/node/@expr"/>
                  </if>
                  <if expr="[/tmp/queryAdd/@offerCount]=1">
                    <set value="@rank=1" xpath="/tmp/queryAdd/collection/where/condition[@internalId='1']/@expr"/>
                  </if>
                </if>
              </if>
              <if expr="[/tmp/queryAdd/@rowCount]=2">
                <set value="1" xpath="/tmp/queryAdd/collection/@singleRow"/>
                <set value="1" xpath="/tmp/queryAdd/collection/@groupBy"/>
                <set expr="[/tmp/queryAdd/@lineCount]" xpath="/tmp/queryAdd/collection/@lineCount"/>
                <set expr="[/tmp/queryAdd/@useOrderByValuesAsRank]" xpath="/tmp/queryAdd/collection/@useOrderByValuesAsRank"/>
              </if>
              <if expr="[/tmp/queryAdd/@rowCount]=3">
                <set value="0" xpath="/tmp/queryAdd/collection/@singleRow"/>
                <set value="0" xpath="/tmp/queryAdd/collection/@groupBy"/>
                <set value="1" xpath="/tmp/queryAdd/collection/@merge"/>
                <set expr="1" xpath="/tmp/queryAdd/collection/@lineCount"/>
              </if>
              <if expr="[/tmp/queryAdd/@rowCount]=-1 OR [/tmp/queryAdd/@reverseLink]=1">
                <set value="0" xpath="/tmp/queryAdd/collection/@lineCount"/>
              </if>
              <if expr="[/tmp/queryAdd/@dataType]='linkDef' OR [/tmp/queryAdd/@dataType]='linkDefColl' OR [/tmp/queryAdd/@dataType]='linkDefExt'">
                <set expr="Iif([/tmp/queryAdd/@dataType]='linkDefColl', 0, Iif([/tmp/queryAdd/@dataType]='linkDef', 1, 2))" xpath="/tmp/queryAdd/linkedDef/@cardinality"/>
                <set expr="[/tmp/queryAdd/@collName]" xpath="/tmp/queryAdd/linkedDef/@name"/>
                <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/linkedDef/@label"/>
                <set expr="Gid()" xpath="/tmp/queryAdd/linkedDef/@id"/>
                <copyElement exprDst="'links[@name=\''+ [/tmp/queryAdd/@collName] + '\']'" xpathSrc="/tmp/queryAdd/linkedDef"/>
              </if>
              <if expr="[/tmp/queryAdd/@dataType]='linkDefRef'">
                <set expr="[/tmp/queryAdd/@collName]" xpath="/tmp/queryAdd/linkedDef/@name"/>
                <set expr="[/tmp/queryAdd/@label]" xpath="/tmp/queryAdd/linkedDef/@label"/>
                <set expr="Gid()" xpath="/tmp/queryAdd/linkedDef/@id"/>
                <copyElement exprDst="'reconc[@name=\''+ [/tmp/queryAdd/@collName] + '\']'" xpathSrc="/tmp/queryAdd/linkedDef"/>
              </if>
              <if expr="[/tmp/queryAdd/@dataTypeReadOnly]!=1 AND [/tmp/queryAdd/@dataType]!='score' AND SubString([/tmp/queryAdd/@dataType],0,7)!='linkDef'">
                <if expr="([/tmp/queryAdd/@dataType]!='linkedData' OR [/tmp/queryAdd/@recipientLink]!='')">
                  <set expr="Gid()" xpath="/tmp/queryAdd/collection/@id"/>
                  <copyElement exprDst="'conditionLink['+Iif([/tmp/queryAdd/@collName]=='', '@expr=\'' + [/tmp/queryAdd/collection/@expr] + '\'', '@alias=\'' + [/tmp/queryAdd/@collName] + '\'')+']'" xpathSrc="/tmp/queryAdd/collection"/>
                </if>
              </if>
              <if expr="[/tmp/queryAdd/@reverseLink]=1">
                <set expr="[/tmp/queryAdd/@targetSchema]" xpath="@schema"/>
                <set expr="[/tmp/queryAdd/element/@revLink]" xpath="@recipientLink"/>
              </if>
              <refresh xpath="."/>
            </leave>
          </form>
          <form label="Query" name="query" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name)" xpath="/ignored/@targetExtension"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-query.png">
              <input colspan="2" xpath="@label"/>
              <input alwaysActive="true" expr="@schema" type="expr" xpath="/tmp/selectCtrl/in/@schema"/>
              <input alwaysActive="true" expr="@recipientLink" type="expr" xpath="/tmp/selectCtrl/in/@recipientLink"/>
              <static colspan="2" label="Target selection" type="separator"/>
              <input img="nms:miniatures/mini-query.png" label="Edit query..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form ref="xtk:workflow:lib/tabs/queryWizard"/>
              </input>
              <container type="visibleGroup" visibleIf="NodeCount([select/node])==0"/>
              <container type="visibleGroup" visibleIf="NodeCount([select/node])>=1">
                <input align="right" img="nms:miniatures/mini-piechart.png" label="Refine the target using additional data..." margin-right="5" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Refine the target using additional data...">
                    <enter>
                      <set expr="wkfTargetSchema(@name)" xpath="/tmp/addFilter/@schema"/>
                    </enter>
                    <input name="havingList" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionlist" xpath="outputFilter" xpathCurrentLookupPath="/lookupPath/having" xpathHelp="/@helpHaving" xpathSchema="/tmp/addFilter/@schema">
                      <input colSize="15" label=" " xpath="/having/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/having/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/having/@operator"/>
                      <input colSize="30" label="Value" xpath="/having/@rightExpr"/>
                    </input>
                  </form>
                </input>
              </container>
              <input alwaysActive="true" translatedExpr="iif([outputFilter/@displayFilter]=='undefined', humanCond, humanCond + '\n' + [outputFilter/@displayFilter])" type="expr" xpath="/tmp/selectCtrl/out/humanCond"/>
              <input colspan="2" fontBold="true" label=" " lineCount="5" noBorder="true" readOnly="true" type="edit" xpath="/tmp/selectCtrl/out/humanCond"/>
              <static colspan="2" label="Complementary information" type="separator"/>
              <input img="xtk:xtklinkn.png" label="Add data..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <enter name="onClick">
                  <set value="0" xpath="/tmp/queryAdd/@dataTypeReadOnly"/>
                </enter>
                <form label="Additional data" ref="xtk:workflow:lib/subforms/queryAdd" type="wizard"/>
              </input>
              <container type="visibleGroup" visibleIf="NodeCount([select/node])==0"/>
              <container type="visibleGroup" visibleIf="NodeCount([select/node])>=1">
                <input align="right" img="nms:list.png" label="Edit additional data..." margin-right="5" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Additional columns">
                    <enter>
                      <set expr="wkfTargetSchema(@name, '', 1)" xpath="/ignored/@targetExtension"/>
                      <set value="aggregate" xpath="/tmp/selectCtrl/in/@choiceType"/>
                    </enter>
                    <container style="flat" type="notebook">
                      <container ref="xtk:workflow:lib/tabs/colSelector/data"/>
                      <container ref="xtk:workflow:lib/tabs/colSelector/collection"/>
                    </container>
                  </form>
                </input>
              </container>
              <input alwaysActive="true" expr="GroupConcat([select/descendant::node], &quot; ' [' + [@label] + '] ' &quot; )" type="expr" xpath="/tmp/selectCtrl/out/@humanSelect"/>
              <input colspan="2" fontBold="true" label=" " lineCount="3" noBorder="true" readOnly="true" type="edit" xpath="/tmp/selectCtrl/out/@humanSelect"/>
              <container colspan="2" xpath="transitions">
                <static label="Results" type="separator"/>
                <container colcount="2">
                  <input xpath="result/@label"/>
                  <input xpath="result/@code"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form label="Edit schema" name="schemaEdit" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@mainSet)" xpath="/tmp/selectCtrl/in/@schema"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-schemaEdit.png">
              <input colspan="2" xpath="@label"/>
              <input colspan="2" type="ExclusionMainSetEdit" xpath="@mainSet"/>
              <static colspan="2" label=" " type="help">Select above the population for which the schema will be modified.</static>
              <input colspan="2" expr="wkfTargetSchema(@mainSet)" type="expr" xpath="/tmp/selectCtrl/in/@schema"/>
              <input colspan="2" xpath="@hideSourceColumn"/>
              <container colspan="2" type="visibleGroup" visibleIf="[/tmp/selectCtrl/in/@schema]!='' OR NodeCount([select/node])>0">
                <static label="Modifications and expressions" type="separator"/>
                <container allowDistinct="false" extraColumns="@alias" hideUnboundPath="true" name="selectCtrl" type="querySelectContainer" xpath=".">
                  <container name="vpaned" type="vpaned">
                    <container name="schema">
                      <static fontBold="true" label="Available fields:"/>
                      <container colcount="2">
                        <static img="xtk:filter.png" type="image"/>
                        <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                      </container>
                      <input name="schemaView" type="SchemaView" useUnboundPath="true" xpath="/tmp/selectCtrl/in/@schema" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="select/node/@expr" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                    </container>
                    <container name="output" xpathsToLoad="output*">
                      <static fontBold="true" label="Output columns:"/>
                      <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" xpath="select/node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupBy="groupBy/node" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHaving="having/condition" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="/tmp/selectCtrl/in/@schema" xpathStartPath="/tmp/selectCtrl/in/@startPath" zoom="false">
                        <input colSize="20" xpath="@label"/>
                        <input colSize="35" type="pathedit" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/selectCtrl/in/@schema" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                        <form label="Column definition" name="colDetail">
                          <input xpath="@label"/>
                          <container name="extraFields"/>
                          <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                          <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                            <container colcount="2" cols-width="100,1">
                              <container>
                                <static fontBold="true" label="Available fields:"/>
                                <container colcount="2">
                                  <static img="xtk:filter.png" type="image"/>
                                  <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                                </container>
                                <input type="schemaview" xpath="/tmp/selectCtrl/in/@schema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                              </container>
                              <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                            </container>
                            <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                          </container>
                          <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                        </form>
                      </input>
                    </container>
                  </container>
                  <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                </container>
              </container>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
              </container>
            </container>
            <container img="xtk:xtklink1.png" label="Links">
              <static type="help">Create the links between your working data and database data here. For each link, you can use one or more reconciliation conditions.</static>
              <input editable="false" nolabel="true" toolbarCaption="List of links" type="list" xpath="links" xpathToIgnore="links/condition" zoom="true" zoomOnAdd="true">
                <input editable="true" label="Identifier" xpath="@name"/>
                <input editable="true" label="Description" xpath="@label"/>
                <input label="Destination" xpath="@schema"/>
                <input editable="true" label="Cardinality" xpath="@cardinality"/>
                <form label="Link definition" name="reconcDetail">
                  <enter>
                    <set expr="Iif(Substring(@schema, 0, 4)=='temp', 1, 0)" xpath="/tmp/@useTempSchema"/>
                    <set expr="Iif(NodeCount([join/condition])==0, 0, 1)" xpath="/tmp/@advancedJoin"/>
                  </enter>
                  <static label="Description" type="separator"/>
                  <input xpath="@name"/>
                  <input xpath="@label"/>
                  <static label="Definition" type="separator"/>
                  <container>
                    <input checkedValue="0" label="Database schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                    <input checkedValue="1" label="Temporary schema" type="RadioButton" xpath="/tmp/@useTempSchema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==0">
                    <input schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@useTempSchema]==1">
                    <input label="Schema" type="ExclusionMainSetEdit" xpath="@srcDataSet" xpathActivityName="../@name"/>
                    <input expr="wkfSchemaName(@srcDataSet)" type="expr" xpath="@schema"/>
                  </container>
                  <static label="Join conditions" type="separator"/>
                  <input expr="wkfAddLinkDefToSchema([/tmp/selectCtrl/in/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [/tmp/@advancedJoin]==1, @schema, ''))" type="expr" xpath="/ignored/@advancedJoinLinksSchema">
                    <enter>
                      <if expr="[/tmp/@advancedJoin]!='' AND [/tmp/@advancedJoin]!=1 AND NodeCount([join/condition])>0">
                        <msgBox translatedExpr="'Do you want to delete the advanced join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                        <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                          <reset xpath="join/condition[*]"/>
                          <refresh xpath="element"/>
                        </if>
                        <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                          <set value="1" xpath="/tmp/@advancedJoin"/>
                        </if>
                      </if>
                      <if expr="[/tmp/@advancedJoin]!='' AND [/tmp/@advancedJoin]!=0 AND NodeCount([condition])>0">
                        <msgBox translatedExpr="'Do you want to delete the join conditions?'" type="yesno" xpathOut="/tmp/@eraseAdvancedJoin"/>
                        <if expr="[/tmp/@eraseAdvancedJoin]='yes'">
                          <reset xpath="condition[*]"/>
                        </if>
                        <if expr="[/tmp/@eraseAdvancedJoin]='no'">
                          <set value="0" xpath="/tmp/@advancedJoin"/>
                        </if>
                      </if>
                    </enter>
                  </input>
                  <input checkedValue="0" label="Use a simple join" nolabel="false" type="radioButton" xpath="/tmp/@advancedJoin"/>
                  <input checkedValue="1" label="Advanced join conditions" nolabel="false" type="radioButton" xpath="/tmp/@advancedJoin"/>
                  <container type="visibleGroup" visibleIf="[/tmp/@advancedJoin]!=1">
                    <static label=" " nolabel="false" type="help">Select below the source and target fields that will be matched to build the join condition.</static>
                    <input label=" " toolbarCaption="Join conditions" type="list" xpath="condition">
                      <input type="pathEdit" xpath="@srcExpr" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                      <input type="pathEdit" xpath="@dstExpr" xpathSchema="../@schema"/>
                    </input>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/@advancedJoin]==1">
                    <static label=" " nolabel="false" type="help">Select below the relationship conditions between source and target records. The 'joinTarget (Dynamic link)' link enables you to reference target fields to define joins.</static>
                    <input label=" " name="filterList" noSaveFilter="true" toolbarAlign="horizontal" toolbarCaption="Join conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="/tmp/selectCtrl/in/@schema">
                      <input colSize="15" label=" " xpath="/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/@operator"/>
                      <input colSize="30" label="Value" xpath="/@rightExpr"/>
                    </input>
                  </container>
                  <container>
                    <input checkedValue="0" label="Type 1N collection link" type="radioButton" xpath="@cardinality"/>
                    <input checkedValue="1" label="Type 11 simple link" type="radioButton" xpath="@cardinality"/>
                    <input checkedValue="2" label="Type 11 simple link which may have a non-existent target" type="radioButton" xpath="@cardinality"/>
                  </container>
                  <container type="visibleGroup" visibleIf="@cardinality=1 OR @cardinality=2">
                    <static type="warning">Defining a 1-1 cardinality link can have a negative impact on future joins.</static>
                  </container>
                  <leave>
                    <set expr="0" xpath="/tmp/@useTempSchema"/>
                    <set expr="wkfAddLinkDefToSchema([/tmp/selectCtrl/in/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], '')" xpath="/ignored/@advancedJoinLinksSchema"/>
                  </leave>
                </form>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form label="Add additional data" name="enrich" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name, 'src')" xpath="/ignored/@targetExtension"/>
              <set expr="[/ignored/@targetExtension]" xpath="/tmp/selectCtrl/in/@schema"/>
              <set expr="Iif(NodeCount([mainReconc/join/condition])==0, Iif(NodeCount([mainReconc/keys])==0, 0, 2), 1)" xpath="/tmp/@advancedReconc"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-enrich.png">
              <input colspan="2" xpath="@label"/>
              <input colspan="2" type="ExclusionMainSetEdit" xpath="@mainSet"/>
              <static colspan="2" label=" " nolabel="false" type="help">Select the population which to which the additional data will be added.</static>
              <input expr="wkfTargetSchema(@name, Iif(@mainSet!='', 'src', ''))" type="expr" xpath="/tmp/selectCtrl/in/@schema"/>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@mainSet != ''">
                <static colspan="2" label="Complementary information" type="separator"/>
                <input colspan="2" xpath="@keepAllExtraData"/>
                <input img="xtk:xtklinkn.png" label="Add data..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <enter name="onClick">
                    <set value="0" xpath="/tmp/queryAdd/@dataTypeReadOnly"/>
                  </enter>
                  <form label="Additional data" ref="xtk:workflow:lib/subforms/queryAdd" type="wizard"/>
                </input>
                <container type="visibleGroup" visibleIf="NodeCount([select/node])==0 AND NodeCount([links])==0 AND NodeCount([reconc])==0"/>
                <container type="visibleGroup" visibleIf="NodeCount([select/node])>=1 OR NodeCount([links])>=1 OR NodeCount([reconc])>=1">
                  <input align="right" img="nms:list.png" label="Edit additional data..." margin-right="5" prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="Select additional columns">
                      <enter>
                        <set value="aggregate" xpath="/tmp/selectCtrl/in/@choiceType"/>
                      </enter>
                      <container style="flat" type="notebook">
                        <container ref="xtk:workflow:lib/tabs/colSelector/data"/>
                        <container ref="xtk:workflow:lib/tabs/colSelector/collection"/>
                        <container ref="xtk:workflow:lib/tabs/colSelector/reconc"/>
                        <container ref="xtk:workflow:lib/tabs/colSelector/links"/>
                      </container>
                    </form>
                  </input>
                </container>
                <input alwaysActive="true" translatedExpr="Iif(NodeCount([select/node])>0, Iif(NodeCount(links)>0 OR NodeCount(reconc)>0, 'Data:\n', '') + GroupConcat([select/descendant::node], &quot; ' [' + [@label] + '] ' &quot; ), '') + Iif(NodeCount(links)>0, '\nLinks:\n' + GroupConcat([links], &quot; ' [' + [@label] + '] ' &quot;), '') + Iif(NodeCount(reconc)>0, '\nReconciliations :\n' + GroupConcat([reconc], &quot; ' [' + [@label] + '] ' &quot;), '')" type="expr" xpath="/tmp/selectCtrl/out/@humanSelect"/>
                <input colspan="2" fontBold="true" label=" " lineCount="5" margin-right="5" noBorder="true" readOnly="true" type="edit" xpath="/tmp/selectCtrl/out/@humanSelect"/>
                <input colspan="2" img="nms:miniatures/mini-piechart.png" label="Refine the target using additional data..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Refine the target using additional data...">
                    <enter>
                      <set expr="wkfTargetSchema(@name)" xpath="/tmp/addFilter/@schema"/>
                    </enter>
                    <input name="havingList" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionlist" xpath="outputFilter" xpathCurrentLookupPath="/lookupPath/having" xpathHelp="/@helpHaving" xpathSchema="/tmp/addFilter/@schema">
                      <input colSize="15" label=" " xpath="/having/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/having/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/having/@operator"/>
                      <input colSize="30" label="Value" xpath="/having/@rightExpr"/>
                    </input>
                  </form>
                </input>
                <container colspan="2" type="visibleGroup" visibleIf="NodeCount(outputFilter)>0">
                  <input fontBold="true" label=" " lineCount="4" margin-right="5" noBorder="true" readOnly="true" type="edit" xpath="outputFilter/@displayFilter"/>
                </container>
              </container>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
              </container>
            </container>
            <container img="xtk:xtklink1.png" label="Reconciliation">
              <input nolabel="true" xpath="mainReconc/@enabled"/>
              <container colcount="2" type="visibleGroup" visibleIf="[mainReconc/@enabled]" xpath="mainReconc">
                <static colspan="2" label="Targeting dimension" type="separator"/>
                <static colspan="2" type="help">Create here the identification conditions for your targeting dimension.</static>
                <input colspan="2" required="true" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                <input colspan="2" expr="wkfAddLinkDefToSchema([/tmp/selectCtrl/in/@schema], 'joinTarget', [/ignored/@advancedJoinLinkLabel], Iif( [/tmp/@advancedReconc]!=0, @schema, ''))" type="expr" xpath="/ignored/@advancedReconcSchema"/>
                <static colspan="2" label="Reconciliation conditions" type="separator"/>
                <input checkedValue="0" colspan="2" label="Use simple reconciliation keys" nolabel="true" type="radioButton" xpath="/tmp/@advancedReconc"/>
                <input checkedValue="1" colspan="2" label="Advanced reconciliation conditions" nolabel="true" type="radioButton" xpath="/tmp/@advancedReconc"/>
                <input checkedValue="2" colspan="2" label="Reconciliation rules" nolabel="true" type="radioButton" xpath="/tmp/@advancedReconc"/>
                <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@advancedReconc]=0">
                  <static type="help">Select below the source and target fields that will be matched to build the reconciliation condition.</static>
                  <input nolabel="true" toolbarAlign="vertical" type="list" xpath="condition">
                    <input type="pathEdit" xpath="@srcExpr" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                    <input type="pathEdit" xpath="@dstExpr" xpathSchema="../@schema"/>
                  </input>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@advancedReconc]=1">
                  <static type="help">Select below the conditions which allow reconciliation between source and target records. The 'joinTarget (Dynamic link)' link enables you to reference target fields to define joins.</static>
                  <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Reconciliation conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="/tmp/selectCtrl/in/@schema">
                    <input colSize="15" label=" " xpath="/@bool-operator"/>
                    <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                    <input colSize="15" label="Operator" xpath="/@operator"/>
                    <input colSize="30" label="Value" xpath="/@rightExpr"/>
                  </input>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@advancedReconc]=2">
                  <static type="help">Select the conditions for reconciling source and target records below. When reconciliation criteria aren't reliable enough, you can refine reconciliation using proximity scores. The 'joinTarget (Dynamic link)' link lets you reference the fields of the target to define the join.</static>
                  <container style="down" type="notebook">
                    <container label="Identification">
                      <input editable="false" nolabel="true" prebuildSubForm="false" toolbarCaption="Reconciliations" type="list" xpath="keys" xpathToIgnore="keys/scoreRule" zoom="true" zoomOnAdd="true">
                        <input editable="true" xpath="@active"/>
                        <input editable="true" expr="Iif(@label!='', @label, [join/@displayFilter])" label="Identification conditions" xpath="@label"/>
                        <input expr="Iif(@scoresApplied!='none', @minScore, '')" label="Required score"/>
                        <input expr="Iif(@scoresApplied=='all', [/ignored/@allLabel], Iif(@scoresApplied=='select', GroupConcat(scoreRule, &quot; '[' + @name + ']' &quot; ), ''))" label="Scores taken into account"/>
                        <form title="Reconciliation rule" type="wizard">
                          <enter>
                            <set expr="Iif(@scoresApplied=='none' OR @scoresApplied=='', 0, 1)" xpath="/tmp/@ruleReconcWithScore"/>
                            <set expr="Iif(@scoresApplied!='select', 1, 0)" xpath="/tmp/@ruleReconcRuleSel"/>
                          </enter>
                          <container desc="Specify below the conditions for identifying the target record" title="Join conditions">
                            <input xpath="@label"/>
                            <input label=" " name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Reconciliation conditions" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="join/@displayFilter" xpathSchema="/tmp/selectCtrl/in/@schema">
                              <input colSize="15" label=" " xpath="/@bool-operator"/>
                              <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                              <input colSize="15" label="Operator" xpath="/@operator"/>
                              <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            </input>
                            <input checkedValue="1" label="Refine reconciliation using proximity scores" nolabel="true" type="checkBox" unCheckedValue="0" xpath="/tmp/@ruleReconcWithScore"/>
                          </container>
                          <container desc="Select below the proximity scores to be taken into account to refine reconciliation, then define the reconciliation approval threshold." title="Proximity scores" visibleIf="[/tmp/@ruleReconcWithScore]=1">
                            <enter>
                              <reset xpath="/tmp/ruleReconcSel"/>
                              <copyElement list="true" xpathDst="/tmp/ruleReconcSel/rules" xpathSrc="../scoreRule"/>
                              <forEach xpath="scoreRule">
                                <set value="1" xpathExpr="'/tmp/ruleReconcSel/rules/scoreRule[@name=\''+@name+'\']/@sel'"/>
                              </forEach>
                            </enter>
                            <input checkedValue="0" label="All calculation rules" nolabel="true" type="radioButton" xpath="/tmp/@ruleReconcRuleSel"/>
                            <input checkedValue="1" label="A selection of rules" nolabel="true" type="radioButton" xpath="/tmp/@ruleReconcRuleSel"/>
                            <container enabledIf="[/tmp/@ruleReconcRuleSel]==1" type="enabledGroup">
                              <input noToolbar="true" nolabel="true" type="list" xpath="/tmp/ruleReconcSel/rules/scoreRule">
                                <input colSize="10" label="Selected" type="checkBox" xpath="@sel"/>
                                <input label="Proximity score" xpath="@name"/>
                                <input label="Score" xpath="@score"/>
                              </input>
                            </container>
                            <static type="help">Specify below the minimum proximity score required to approve reconciliation.</static>
                            <input label="Minimum score" xpath="@minScore"/>
                          </container>
                          <leave>
                            <set expr="Iif([/tmp/@ruleReconcWithScore]==0, 'none', IIf([/tmp/@ruleReconcRuleSel]==0, 'all', 'select'))" xpath="@scoresApplied"/>
                            <if expr="[/tmp/@ruleReconcRuleSel]==1 AND [/tmp/@ruleReconcWithScore]==1">
                              <reset xpath="scoreRule[*]"/>
                              <copyElement filter="@sel=1" list="true" xpathDst="." xpathSrc="/tmp/ruleReconcSel/rules/scoreRule"/>
                            </if>
                          </leave>
                        </form>
                      </input>
                    </container>
                    <container label="Proximity scores">
                      <input editable="false" nolabel="true" prebuildSubForm="false" toolbarCaption="Calculation rules of the proximity score" type="list" xpath="scoreRule" zoom="true" zoomOnAdd="true">
                        <input editable="true" xpath="@active"/>
                        <input xpath="@name"/>
                        <input xpath="@score"/>
                        <input label="condition" xpath="join/@displayFilter"/>
                        <form colcount="2" label="Proximity score">
                          <input xpath="@name"/>
                          <input label="Score" xpath="@score"/>
                          <input colspan="2" name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Conditions for triggering score adding" type="conditionList" xpath="join" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="join/@displayFilter" xpathSchema="/tmp/selectCtrl/in/@schema">
                            <input colSize="15" label=" " xpath="/@bool-operator"/>
                            <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                            <input colSize="15" label="Operator" xpath="/@operator"/>
                            <input colSize="30" label="Value" xpath="/@rightExpr"/>
                          </input>
                        </form>
                      </input>
                    </container>
                  </container>
                </container>
                <input nolabel="true" xpath="@outerJoin"/>
                <input align="right" label="Advanced parameters..." type="subFormLink" xpath=".">
                  <form label="Filter and deduplication" type="wizard">
                    <container desc="Specify below the filtering conditions to be taken into account during reconciliation" title="Refine reconciliation">
                      <input label=" " name="filterList" noSaveFilter="true" toolbarAlign="horizontal" toolbarCaption="Restriction" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="where/@displayFilter" xpathSchema="@schema">
                        <input colSize="15" label=" " xpath="/@bool-operator"/>
                        <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                        <input colSize="15" label="Operator" xpath="/@operator"/>
                        <input colSize="30" label="Value" xpath="/@rightExpr"/>
                      </input>
                      <static label="Reconciliation parameters" type="separator"/>
                      <container type="visibleGroup" visibleIf="[/tmp/@advancedReconc]==2">
                        <input nolabel="true" xpath="@flattenTree"/>
                        <static type="help">When using several reconciliation rules, records can be reconciled two by two without a main record being identified. Checking the box above will automatically select a record to be used as a reference for all records reconciled two by two.</static>
                      </container>
                      <input nolabel="true" xpath="@dedup"/>
                      <static type="help">Click next to define the selection sequence of the main record among duplicates. If no selection is made, a record will be chosen at random.</static>
                    </container>
                    <container desc="Select the deduplication criteria" title="Deduplication" visibleIf="@dedup">
                      <container style="down" toolbarAlign="horizontal" toolbarCaption="Selection sequence" type="notebookList" xpath="orderedValue" xpath-label="@label">
                        <container>
                          <input enum="xtk:workflow:dedupReconcType" xpath="@dedupType"/>
                          <container type="visibleGroup" visibleIf="@dedupType='order'">
                            <static type="help">Records for which the expression below is entered will be kept as a priority</static>
                          </container>
                          <input hideCalculated="true" hideMappedAsXml="false" label="Expression" nolabel="false" type="pathedit" xpath="@expr" xpathLabel="@label" xpathSchema="../@schema"/>
                          <container type="visibleGroup" visibleIf="@dedupType='order'">
                            <input label=" " nolabel="false" type="EnumEditList" xpath="value" xpathSchema="@schema" xpathType="@expr">
                              <input xpath="@value"/>
                            </input>
                            <static label="Other values" type="separator"/>
                            <input checkedValue="0" label="Indifferent" type="radioButton" xpath="@orderType"/>
                          </container>
                          <container type="visibleGroup" visibleIf="@dedupType='order' OR @dedupType='expr'">
                            <input checkedValue="1" label="Keep the smallest value" type="radioButton" xpath="@orderType"/>
                            <input checkedValue="2" label="Keep the largest value" type="radioButton" xpath="@orderType"/>
                          </container>
                        </container>
                      </container>
                    </container>
                  </form>
                </input>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form label="Changing the targeting dimension" maxLabelWidth="50" name="changeAxis" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(wkfSourceActivity(@name), wkfTransitionName(wkfSourceActivity(@name), @name), 1)" xpath="/ignored/@orgSchema"/>
              <set expr="Iif(@schema!='' and @recipientLink!='', wkfTargetSchema([@name], 'src'), '')" xpath="/ignored/@srcSchema"/>
              <set expr="Iif([configuration/@number]>1, 2, [configuration/@number])" xpath="/tmp/@useLimit"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-changeAxis.png">
              <input colspan="2" xpath="@label"/>
              <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@orgSchema]==''">
                <static type="warning">This activity requires an inbound population.</static>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@orgSchema]!=''">
                <input choiceType="xpath" label="Change dimension" nolabel="false" type="pathEdit" useTablePath="true" useUnboundPath="true" xpath="@recipientLink" xpathSchema="/ignored/@orgSchema"/>
                <input expr="GetLinkSchema([/ignored/@orgSchema], [@recipientLink])" type="expr" xpath="@schema"/>
                <container type="visibleGroup" visibleIf="[@schema]==''">
                  <static label=" " nolabel="false" type="warning">You must select the link which enables you to change the targeting dimension.</static>
                </container>
                <container type="visibleGroup" visibleIf="[@schema]!=''">
                  <input label="Targeting document" readOnly="true" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                </container>
              </container>
              <input checkedValue="1" colspan="2" label="Keep a single item in the new targeting document" nolabel="false" type="radioButton" xpath="/tmp/@useLimit"/>
              <input checkedValue="0" colspan="2" label="Keep all records" nolabel="false" type="radioButton" xpath="/tmp/@useLimit"/>
              <input checkedValue="2" colspan="2" label="Limit the number of items in the new targeting document" nolabel="false" type="radioButton" xpath="/tmp/@useLimit"/>
              <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@useLimit]==2">
                <input label="Limit" xpath="configuration/@number"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@schema!='' and @recipientLink!=''">
                <container xpath="configuration">
                  <static label="Deduplication parameters" type="separator"/>
                  <input img="nms:miniatures/mini-dedup.png" label="Edit configuration..." nolabel="false" prebuildSubForm="false" type="DedupFormLink" xpath=".">
                    <form img="nms:activities/dedup.png" label="Deduplication" name="queryWizard" nothingToSave="true" type="wizard">
                      <enter>
                        <set expr="Iif([/tmp/@useLimit]==2, @number, [/tmp/@useLimit])" xpath="@number"/>
                        <set expr="wkfTargetSchema([../@name], 'src')" xpath="/ignored/@srcSchema"/>
                      </enter>
                      <container desc="Please specify the list of fields or expressions which are used to find duplicates in case of identical values." name="groupDedup" title="Identification of duplicates">
                        <input nolabel="true" toolbarCaption="List of fields" type="list" xpath="groupExpr" xpathChoiceTarget="@expr">
                          <input hideCalculated="false" hideMappedAsXml="true" label="Expression" type="pathedit" xpath="@expr" xpathLabel="@label" xpathSchema="/ignored/@srcSchema"/>
                          <input xpath="@label"/>
                        </input>
                      </container>
                      <container desc="If necessary, enter filtering conditions to restrict the eligible elements of the new dimension." name="groupFlt" title="Filtering of the new targeting dimension">
                        <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathSchema="../@schema">
                          <input colSize="15" label=" " xpath="/@bool-operator"/>
                          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                          <input colSize="15" label="Operator" xpath="/@operator"/>
                          <input colSize="30" label="Value" xpath="/@rightExpr"/>
                        </input>
                      </container>
                      <container desc="Please select the method used to identify the records to keep." name="group" title="Deduplication method" visibleIf="([/tmp/@useLimit]!=0 OR [../@keepRank])">
                        <input xpath="@type"/>
                        <container type="visibleGroup" visibleIf="@type='choice'">
                          <static label="Randomly select which duplicates to keep." type="help"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@type='order'">
                          <static label="The record priority order is based on the following, for one or more fields (or expressions)." type="help"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@type='noEmpty'">
                          <static label="Records for which the expression is not empty have priority." type="help"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@type='expr'">
                          <static label="Keep records for which the specified expression has the smallest or largest value." type="help"/>
                        </container>
                        <container type="visibleGroup" visibleIf="@type='order'">
                          <container style="down" toolbarAlign="horizontal" toolbarCaption="List of values" type="notebookList" xpath="orderedValue" xpath-label="@label">
                            <container>
                              <input hideCalculated="true" hideMappedAsXml="false" label="Expression" nolabel="false" type="pathedit" xpath="@expr" xpathLabel="@label" xpathSchema="/ignored/@srcSchema"/>
                              <input label=" " nolabel="false" type="EnumEditList" xpath="value" xpathSchema="/ignored/@srcSchema" xpathType="@expr">
                                <input xpath="@value"/>
                              </input>
                              <static label="Other values" type="separator"/>
                              <input checkedValue="0" label="Indifferent" type="radioButton" xpath="@orderType"/>
                              <input checkedValue="1" label="Keep the smallest value" type="radioButton" xpath="@orderType"/>
                              <input checkedValue="2" label="Keep the largest value" type="radioButton" xpath="@orderType"/>
                            </container>
                          </container>
                        </container>
                        <container type="visibleGroup" visibleIf="@type='expr'">
                          <input nolabel="true" style="down" toolbarAlign="horizontal" toolbarCaption="List of expressions" type="list" xpath="orderedExpr" xpath-label="@label">
                            <input hideMappedAsXml="true" label="Expression" type="pathedit" xpath="@expr" xpathSchema="/ignored/@srcSchema"/>
                            <input label="Keep" xpath="@compType"/>
                          </input>
                        </container>
                        <container type="visibleGroup" visibleIf="@type='noEmpty'">
                          <input hideMappedAsXml="true" label="Expression" nolabel="false" type="pathedit" xpath="orderedExpr/@expr" xpathSchema="/ignored/@srcSchema"/>
                        </container>
                      </container>
                      <leave>
                        <set value="1" xpath="/ignored/@display"/>
                      </leave>
                    </form>
                  </input>
                  <input fontBold="true" label=" " lineCount="5" noBorder="true" readOnly="true" type="edit" xpath="display"/>
                </container>
              </container>
            </container>
            <container colcount="2" img="nms:miniatures/mini-enrich.png" label="Result">
              <static colspan="2" label="Complementary information" type="separator"/>
              <input xpath="@keepAllExtraData"/>
              <container type="visibleGroup" visibleIf="[/tmp/@useLimit]!=1">
                <input xpath="@keepRank"/>
              </container>
              <container type="visibleGroup" visibleIf="[/tmp/@useLimit]==1">
                <input xpath="configuration/@includeMainInDuplicates"/>
              </container>
              <input img="xtk:xtklinkn.png" label="Add data..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <enter name="onClick">
                  <set expr="wkfTargetSchema(@name, 'src')" xpath="/tmp/selectCtrl/in/@schema"/>
                  <set value="aggregate" xpath="/tmp/selectCtrl/in/@choiceType"/>
                  <set value="0" xpath="/tmp/queryAdd/@dataTypeReadOnly"/>
                </enter>
                <form label="Additional data" ref="xtk:workflow:lib/subforms/queryAdd" type="wizard"/>
              </input>
              <input align="right" img="nms:list.png" label="Edit additional data..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form label="Select additional columns">
                  <enter>
                    <set expr="Iif([/tmp/@useLimit]==2, [configuration/@number], [/tmp/@useLimit])" xpath="configuration/@number"/>
                    <set expr="wkfTargetSchema(@name, 'src')" xpath="/tmp/selectCtrl/in/@schema"/>
                    <set value="aggregate" xpath="/tmp/selectCtrl/in/@choiceType"/>
                  </enter>
                  <container style="flat" type="notebook">
                    <container ref="xtk:workflow:lib/tabs/colSelector/data"/>
                    <container ref="xtk:workflow:lib/tabs/colSelector/collection"/>
                  </container>
                </form>
              </input>
              <input alwaysActive="true" expr="GroupConcat([select/descendant::node], &quot; ' [' + [@label] + '] ' &quot; )" type="expr" xpath="/tmp/selectCtrl/out/@humanSelect"/>
              <input colspan="2" fontBold="true" label=" " lineCount="5" noBorder="true" readOnly="true" type="edit" xpath="/tmp/selectCtrl/out/@humanSelect"/>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
                <static colspan="2" label="Complement" type="separator"/>
                <input colspan="2" xpath="remainder/@enabled"/>
                <container colspan="2" type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                </container>
                <static colspan="2" type="help">If this option is checked, all duplicates are saved in a second set.</static>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="Iif([/tmp/@useLimit]==2, [configuration/@number], [/tmp/@useLimit])" xpath="configuration/@number"/>
            </leave>
          </form>
          <form name="dbImport" type="notebook">
            <enter>
              <if expr="@tableName!='' AND ([@dataSource-id]!=0 OR [dataSourceDesc/@server]!='')">
                <set expr="Iif(EV(@inline, 'extAccount')=false, Iif(EV(@inline,'server'), [dataSourceDesc/@name], '{' + [dataSourceDesc/@provider] + ':' + [dataSourceDesc/@login] + ':' + [dataSourceDesc/@dbName] + '/' + [dataSourceDesc/@password] + '@' + [dataSourceDesc/@server] + Iif([dataSourceDesc/@unicodeData], ';unicodeData=1', ';unicodeData=0') + Iif([dataSourceDesc/@NChar], ';NChar=1', ';NChar=0') + ';timezone=' + [dataSourceDesc/@timezone] + '}'), 'nms:extAccount:'+[@dataSource-id])" xpath="/tmp/extDataSource/@desc"/>
                <set expr="wkfTargetSchema(@name, 'src')" xpath="/tmp/selectCtrl/in/@schema"/>
                <set value="select" xpath="/tmp/selectCtrl/in/@choiceType"/>
              </if>
            </enter>
            <container img="nms:miniatures/mini-dbImport.png">
              <input xpath="@label"/>
              <static label="Connection settings" type="separator"/>
              <static type="help">To access external data, you can either use an external account (shared connection) already defined or add a new connection, usable only in this workflow.</static>
              <input checkedValue="0" label="Shared external data source" type="radioButton" xpath="@inline"/>
              <input checkedValue="1" label="Local external data source" type="radioButton" xpath="@inline"/>
              <input checkedValue="2" label="Server-defined external data source" type="radioButton" xpath="@inline"/>
              <container type="visibleGroup" visibleIf="EV(@inline,'inline')">
                <input img="xtk:dbcnx.png" label="Define the data source..." nolabel="false" type="subFormLink" xpath="dataSourceDesc">
                  <form label="Connection setting">
                    <static>Select the database engine to use from the list of supported ones.</static>
                    <input enum="xtk:workflow:provider" label="Engine" xpath="@provider"/>
                    <static label="Database server" type="separator"/>
                    <input xpath="@server"/>
                    <container type="visibleGroup" visibleIf="[@provider]=='Oracle'">
                      <static type="help">TNS name (defined on the application server) used to access the database server.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[@provider]=='PostgreSQL'">
                      <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[@provider]=='MSSQL'">
                      <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
                      <static label="Authentication mode used to access SQL Server" type="separator"/>
                      <input checkedValue="false" label="SQL Server authentication" type="RadioButton" xpath="/tmp/@integratedSecurity"/>
                      <input checkedValue="true" label="Windows NT authentication (integrated security)" type="RadioButton" xpath="/tmp/@integratedSecurity"/>
                    </container>
                    <container type="visibleGroup" visibleIf="[@provider]=='DB2'">
                      <static type="help">Host name or host:port name used to access the database server.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[@provider]=='MySQL'">
                      <static type="help">DNS name (or IP address) valid on the application server to access the database server.</static>
                    </container>
                    <static label="Authentication settings" type="separator"/>
                    <input xpath="@login"/>
                    <input crypt="true" type="passwordedit" xpath="@password"/>
                    <container type="visibleGroup" visibleIf="[@provider]!='Oracle' AND [@provider]!='Teradata'">
                      <static label="Database to use" type="separator"/>
                      <input xpath="@dbName"/>
                    </container>
                    <input xpath="@unicodeData"/>
                    <container type="visibleGroup" visibleIf="[@provider]='Oracle' OR [@provider]='MSSQL'">
                      <input xpath="@NChar"/>
                    </container>
                    <input enum="xtk:common:timezone" type="sysenum" xpath="@timezone"/>
                  </form>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="EV(@inline, 'extAccount')">
                <input img="nms:miniatures/mini-dbImport.png" notifyPathList="@name|../dataSourceDesc/@name,@NChar|../dataSourceDesc/@NChar,@unicodeData|../dataSourceDesc/@unicodeData" xpath="dataSource">
                  <sysFilter>
                    <condition expr="@type = 7"/>
                  </sysFilter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="EV(@inline, 'server')">
                <input xpath="dataSourceDesc/@name"/>
              </container>
              <input alwaysActive="true" expr="Iif(EV(@inline, 'extAccount')=false, Iif(EV(@inline,'server'), [dataSourceDesc/@name], '{' + [dataSourceDesc/@provider] + ':' + [dataSourceDesc/@login] + ':' + [dataSourceDesc/@dbName] + '/' + [dataSourceDesc/@password] + '@' + [dataSourceDesc/@server] + Iif([dataSourceDesc/@unicodeData], ';unicodeData=1', ';unicodeData=0') + Iif([dataSourceDesc/@NChar], ';NChar=1', ';NChar=0') + ';timezone=' + [dataSourceDesc/@timezone] + '}'), 'nms:extAccount:'+[dataSourceDesc/@name])" type="expr" xpath="/tmp/extDataSource/@desc"/>
              <input label="Table name" xpath="@tableName">
                <input img="xtk:choiceField.png" modeless="false" name="btnChoiceTable" prebuildSubForm="false" xpath=".">
                  <enter name="onClick">
                    <soapCall name="BuildTableList" service="xtk:sqlSchema">
                      <param exprIn="[/tmp/extDataSource/@desc]" type="string"/>
                      <param exprIn="'%' + [/ignored/dbImport/@tableFilter] + '%'" type="string"/>
                      <param type="DOMDocument" xpathOut="/ignored/dbImport/tableList"/>
                    </soapCall>
                    <setModified/>
                  </enter>
                  <form colcount="2" label="Select the table">
                    <input catchReturnKey="true" label="Filter" xpath="/ignored/dbImport/@tableFilter"/>
                    <input label="Filter" type="button">
                      <enter>
                        <soapCall name="BuildTableList" service="xtk:sqlSchema">
                          <param exprIn="[/tmp/extDataSource/@desc]" type="string"/>
                          <param exprIn="'%' + [/ignored/dbImport/@tableFilter] + '%'" type="string"/>
                          <param type="DOMDocument" xpathOut="/ignored/dbImport/tableList"/>
                        </soapCall>
                      </enter>
                    </input>
                    <input colspan="2" dblClickAction="btnOk" editable="false" entitySchema="xtk:sqlSchema" noToolbar="true" nolabel="true" readOnly="true" type="list" xpath="/ignored/dbImport/tableList/table" xpathSelection="/tmp/dbImport/@tableName">
                      <input editable="false" label="Table name" xpath="@name"/>
                    </input>
                    <leave>
                      <set expr="NodeValue([/tmp/dbImport/@tableName]+'/@name')" xpath="@tableName"/>
                    </leave>
                  </form>
                </input>
              </input>
              <input img="xtk:properties.png" label="Advanced..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form label="Advanced parameters">
                  <container>
                    <static label="Table name selection" type="separator"/>
                    <input checkedValue="2" label="Identical to the template" type="RadioButton" xpath="@importType"/>
                    <input checkedValue="0" label="Specified in the transition" type="RadioButton" xpath="@importType"/>
                    <input checkedValue="1" label="Explicit" type="RadioButton" xpath="@importType"/>
                    <container type="visibleGroup" visibleIf="@importType=1">
                      <input label="Computed name" menuId="workflowMenuBuilder" type="scriptEdit" xpath="@script"/>
                      <static type="help">This script allows the use of a table whose name is computed at any execution time.</static>
                    </container>
                    <static label="" type="separator"/>
                    <input img="nms:list.png" label="Update schema structure" prebuildSubForm="false" type="urlButton">
                      <enter>
                        <soapCall name="UpdateTempSchemasFromDatabase" service="xtk:builder">
                          <param exprIn="[extension]" type="DOMElement"/>
                          <param type="DOMElement" xpathOut="extension"/>
                          <param type="string" xpathOut="/ignored/@warning"/>
                        </soapCall>
                        <setModified/>
                        <if expr="[/ignored/@warning] == ''">
                          <msgBox translatedExpr="'Updated schemas'"/>
                        </if>
                      </enter>
                    </input>
                    <container type="visibleGroup" visibleIf="[/ignored/@warning] != ''">
                      <input type="warning" xpath="/ignored/@warning"/>
                    </container>
                  </container>
                </form>
              </input>
              <container type="visibleGroup" visibleIf="@tableName != ''">
                <container colcount="2" label="Information collected" type="frame">
                  <input colspan="2" xpath="@keepAllExtraData"/>
                  <input img="nms:list.png" label="Select the columns to extract..." prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="Select extra columns">
                      <enter>
                        <set expr="wkfTargetSchema(@name, 'src')" xpath="/tmp/selectCtrl/in/@schema"/>
                      </enter>
                      <container style="flat" type="notebook">
                        <container ref="xtk:workflow:lib/tabs/colSelector/data"/>
                        <container ref="xtk:workflow:lib/tabs/colSelector/collection"/>
                        <container ref="xtk:workflow:lib/tabs/colSelector/links"/>
                      </container>
                    </form>
                  </input>
                  <input align="right" img="nms:miniatures/mini-dbImport.png" label="Add a linked table..." prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="Link configuration" type="wizard">
                      <enter>
                        <reset xpath="/tmp/dbImportAdd"/>
                        <set expr="wkfTargetSchema(@name, 'src')" xpath="/tmp/dbImportAdd/@targetSchema"/>
                        <set value="linkDefColl" xpath="/tmp/dbImportAdd/@dataType"/>
                      </enter>
                      <container desc="Select the type of link you want to create, then choose the target table where data is stored." title="Definition of the link target">
                        <static label="Link type" type="separator"/>
                        <container colcount="2">
                          <input img="xtk:xtklinkn.png" type="image"/>
                          <input checkedValue="linkDefColl" label="Define a collection" type="radioButton" xpath="/tmp/dbImportAdd/@dataType"/>
                          <input img="xtk:xtklink1.png" type="image"/>
                          <input checkedValue="linkDef" label="Define a link whose target is always available" type="radioButton" xpath="/tmp/dbImportAdd/@dataType"/>
                          <input img="xtk:xtklink0.png" type="image"/>
                          <input checkedValue="linkDefExt" label="Define a link whose target may not exist in the database" type="radioButton" xpath="/tmp/dbImportAdd/@dataType"/>
                        </container>
                        <static label="Link target" type="separator"/>
                        <input label="Table name" xpath="/tmp/dbImportAdd/@tableName">
                          <input img="xtk:choiceField.png" modeless="false" name="btnChoiceTable" prebuildSubForm="false" xpath=".">
                            <enter name="onClick">
                              <soapCall name="BuildTableList" service="xtk:sqlSchema">
                                <param exprIn="[/tmp/extDataSource/@desc]" type="string"/>
                                <param exprIn="'%' + [/ignored/dbImport/@tableFilter] + '%'" type="string"/>
                                <param type="DOMDocument" xpathOut="/ignored/dbImport/tableList"/>
                              </soapCall>
                              <setModified/>
                            </enter>
                            <form colcount="2" label="Select the table">
                              <input catchReturnKey="true" label="Filter" xpath="/ignored/dbImport/@tableFilter"/>
                              <input label="Filter" type="button">
                                <enter>
                                  <soapCall name="BuildTableList" service="xtk:sqlSchema">
                                    <param exprIn="[/tmp/extDataSource/@desc]" type="string"/>
                                    <param exprIn="'%' + [/ignored/dbImport/@tableFilter] + '%'" type="string"/>
                                    <param type="DOMDocument" xpathOut="/ignored/dbImport/tableList"/>
                                  </soapCall>
                                </enter>
                              </input>
                              <input colspan="2" dblClickAction="btnOk" editable="false" entitySchema="xtk:sqlSchema" noToolbar="true" nolabel="true" readOnly="true" type="list" xpath="/ignored/dbImport/tableList/table" xpathSelection="/tmp/dbImport/@tableName">
                                <input editable="false" label="Table name" xpath="@name"/>
                              </input>
                              <leave>
                                <set expr="NodeValue([/tmp/dbImport/@tableName]+'/@name')" xpath="/tmp/dbImportAdd/@tableName"/>
                                <set expr="[/tmp/dbImportAdd/@tableName]" xpath="/tmp/dbImportAdd/@tableLabel"/>
                              </leave>
                            </form>
                          </input>
                        </input>
                        <input label="Label" xpath="/tmp/dbImportAdd/@tableLabel"/>
                      </container>
                      <container descExpr="'In the list below, add join conditions between \'' + @tableName + '\' and \'' + [/tmp/dbImportAdd/@tableName] + '\''" title="Join definition">
                        <enter>
                          <set expr="wkfExternalSchema([/tmp/dbImportAdd/@tableName], [/tmp/extDataSource/@desc], [/tmp/dbImportAdd/@tableName], 'extension/schema[@name=\''+[/tmp/dbImportAdd/@tableName]+'\']')" xpath="/tmp/dbImportAdd/@linkSchema"/>
                          <set expr="[/tmp/dbImportAdd/@tableLabel]" xpathExpr="'extension/schema[@name=\''+[/tmp/dbImportAdd/@tableName]+'\']/@label'"/>
                          <set expr="[/tmp/dbImportAdd/@tableLabel]" xpathExpr="'extension/schema[@name=\''+[/tmp/dbImportAdd/@tableName]+'\']/element/@label'"/>
                        </enter>
                        <input nolabel="true" toolbarCaption="Join conditions" type="list" xpath="/tmp/dbImportAdd/element/condition">
                          <input label="Remote field" type="pathEdit" xpath="@dstExpr" xpathSchema="/tmp/dbImportAdd/@linkSchema"/>
                          <input label="Local field" type="pathEdit" xpath="@srcExpr" xpathSchema="/tmp/dbImportAdd/@targetSchema"/>
                        </input>
                      </container>
                      <leave>
                        <set expr="[/tmp/dbImportAdd/@tableName]" xpath="/tmp/dbImportAdd/element/@name"/>
                        <set expr="[/tmp/dbImportAdd/@tableLabel]" xpath="/tmp/dbImportAdd/element/@label"/>
                        <set expr="[/tmp/dbImportAdd/@linkSchema]" xpath="/tmp/dbImportAdd/element/@schema"/>
                        <set expr="Iif([/tmp/dbImportAdd/@dataType]='linkDefColl', 0, Iif([/tmp/dbImportAdd/@dataType]='linkDef', 1, 2))" xpath="/tmp/dbImportAdd/element/@cardinality"/>
                        <copyElement exprDst="'links[@name=\'' + [/tmp/dbImportAdd/@tableName] + '\']'" xpathSrc="/tmp/dbImportAdd/element"/>
                      </leave>
                    </form>
                  </input>
                  <input alwaysActive="true" translatedExpr="Iif(NodeCount([select/node])>0, Iif(NodeCount(links)>0, 'Data:\n', '') + GroupConcat([select/descendant::node], &quot; ' [' + [@label] + '] ' &quot; ), '') + Iif(NodeCount(links)>0, '\nLinks:\n' + GroupConcat([links], &quot; ' [' + [@label] + '] ' &quot;), '')" type="expr" xpath="/tmp/selectCtrl/out/@humanSelect"/>
                  <input colspan="2" fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/tmp/selectCtrl/out/@humanSelect"/>
                </container>
                <container label="Source filtering" type="frame">
                  <input img="nms:miniatures/mini-query.png" label="Edit query..." prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="Query">
                      <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="humanCond" xpathSchema="/tmp/selectCtrl/in/@schema">
                        <input colSize="15" label=" " xpath="/@bool-operator"/>
                        <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                        <input colSize="15" label="Operator" xpath="/@operator"/>
                        <input colSize="30" label="Value" xpath="/@rightExpr"/>
                      </input>
                      <leave>
                        <set expr="SubString(humanCond, IndexOf(humanCond, ':')+2)" xpath="@label"/>
                      </leave>
                    </form>
                  </input>
                  <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="humanCond"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <if expr="@tableName=='' OR ([@dataSource-id]==0 AND [dataSourceDesc/@server]='')">
                <reset xpath="extension"/>
              </if>
              <if expr="@tableName!='' AND ([@dataSource-id]!=0 OR [dataSourceDesc/@server]!='')">
                <set expr="wkfExternalSchema(@tableName, [/tmp/extDataSource/@desc], @tableName, 'extension/schema[@name=\'' + @tableName + '\']')" xpath="/ignored/dbImport/@schema"/>
              </if>
            </leave>
          </form>
          <form maxLabelWidth="50" name="fileImport" type="notebook">
            <enter>
              <set value="1" xpath="/ignored/@hideSQLName"/>
              <set expr="Iif(@preproc!='', 2, Iif(@md5!='', 3, @importType))" xpath="/tmp/@fileHandling"/>
              <set expr="Iif([@dataSource-id]!=0, 1, 0)" xpath="/tmp/@dataSourceTarget"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-fileImport.png" label="Data">
              <input colspan="2" xpath="@label"/>
              <container colcount="2" colspan="2" xpath="source">
                <static colspan="2" label="File format" type="separator"/>
                <container colcount="2" colspan="2" importList="true" name="autoDetect" type="importAutoDetectContainer" xpath="dataSourceConfig" xpathAutoDetect="../name" xpathLastParsed="../@lastParsedDataSource" xpathUploadFile="../@upload">
                  <container colspan="2" type="visibleGroup" visibleIf="[../@upload]">
                    <input filters="Text, CSV or XML files (*.txt;*.csv;*.tab;*.xml)|*.txt;*.csv;*.tab;*.xml|All (*.*)|*.*|" label="Sample file" type="fileEdit" xpath="../name" xpathType="../@format"/>
                  </container>
                  <container colspan="2" type="visibleGroup" visibleIf="[../@upload]==false">
                    <input label="Sample file" xpath="../name"/>
                  </container>
                  <input label="Use a sample file on the local computer" xpath="../@upload"/>
                  <input xpath="../../@collectLineNumber"/>
                  <input img="xtk:refresh.png" label="Auto-Detect format" name="autoDetectBtn1" nolabel="false" type="urlButton"/>
                  <input img="xtk:fileEdit.png" label="Click here to change the file format..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form ref="nms:importList:lib/fileFormat"/>
                  </input>
                </container>
                <static colspan="2" label="Preview" type="separator"/>
                <input colspan="2" name="PreviewList" type="fileParsingPreviewList" xpath="dataSourceConfig" xpathIndex="/tmp/columns/@current"/>
              </container>
              <container colcount="2" colspan="2">
                <static colspan="2" label="Name of the file to load" type="separator"/>
                <input checkedValue="0" colspan="2" label="Specified in the transition" type="RadioButton" xpath="/tmp/@fileHandling"/>
                <input checkedValue="1" colspan="2" label="Calculated" type="RadioButton" xpath="/tmp/@fileHandling"/>
                <input checkedValue="2" colspan="2" label="Pre-process the file" type="RadioButton" xpath="/tmp/@fileHandling"/>
                <input checkedValue="3" colspan="2" label="Upload a file from the local machine" type="RadioButton" xpath="/tmp/@fileHandling"/>
                <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@fileHandling]==0">
                  <static/>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@fileHandling]=1">
                  <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@file"/>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@fileHandling]=2">
                  <input label="Command" menuId="workflowMenuBuilder" type="scriptEdit" xpath="@preproc"/>
                </container>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/@fileHandling]=3">
                  <container colspan="2">
                    <input filters="Text, CSV or XML files (*.txt;*.csv;*.tab;*.xml)|*.txt;*.csv;*.tab;*.xml|All (*.*)|*.*|" label="File name" type="fileEdit" xpath="@file"/>
                    <input alwaysActive="true" expr="FileUploaded([@file], [@md5])" type="expr" xpath="/ignored/file/@uploadStatus"/>
                  </container>
                  <container colcount="2" colspan="2">
                    <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == -1">
                      <static img="xtk:logwarn.png" label=" " nolabel="false">The file no longer exists on the local disk and has not been uploaded.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 0">
                      <static img="xtk:loginfo.png" label=" " nolabel="false">The local file has not been uploaded onto the server.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 1">
                      <static img="xtk:logwarn.png" label=" " nolabel="false">The local file is different from the one on the server.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 2">
                      <static img="xtk:xtkcheck.png" label=" " nolabel="false">File exists on server, but not on the local disk.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 3">
                      <static img="xtk:xtkcheck.png" label=" " nolabel="false">File already exists on server.</static>
                    </container>
                    <input img="xtk:upload.png" label="Upload on server..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                      <form label="Updating file on server">
                        <enter>
                          <set value="" xpath="/ignored/@performedUpload"/>
                          <set expr="@file" xpath="/ignored/resource/@fileName"/>
                          <set expr="@md5==''" xpath="/ignored/resource/@md5Empty"/>
                        </enter>
                        <input label="File" required="true" type="fileEdit" xpath="/ignored/resource/@fileName"/>
                        <static type="help">Click on 'Upload' to start the file transfer to the server.</static>
                        <container exprTransferType="true" keyIsMd5="true" methodName="NONE" notResTable="true" type="resourceTransferContainer" xpathFile="/ignored/resource/@fileName" xpathOutList="@md5,/ignored/@performedUpload">
                          <input name="JobLogsList" type="JobLogList"/>
                          <container colcount="2">
                            <value dataType="timespan" label="Elapsed" xpath="/tmp/execution/@elapsed"/>
                            <value dataType="timespan" label="Estimated left" xpath="/tmp/execution/@remaining"/>
                          </container>
                          <container colcount="2" enabledIf="[/ignored/@performedUpload] == ''" type="enabledGroup">
                            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathElapsed="/tmp/timing/@elapsed" xpathRemaining="/tmp/timing/@remaining"/>
                            <input enabledIf="[/ignored/resource/@fileName]!= '' " img="xtk:upload.png" label="&amp;Upload" name="JobSubmitButton" type="flatbutton"/>
                          </container>
                        </container>
                      </form>
                    </input>
                  </container>
                </container>
              </container>
              <container colspan="2" rowspan="2">
                <static colspan="2" label="Target database" type="separator"/>
                <input checkedValue="0" colspan="2" label="Default" type="RadioButton" xpath="/tmp/@dataSourceTarget"/>
                <input checkedValue="1" colspan="2" label="External database" type="RadioButton" xpath="/tmp/@dataSourceTarget"/>
                <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@dataSourceTarget]==1">
                  <input img="nms:miniatures/mini-dbImport.png" xpath="dataSource">
                    <sysFilter>
                      <condition expr="@type = 7"/>
                    </sysFilter>
                  </input>
                </container>
              </container>
              <container colspan="2">
                <static label="Reject management" type="separator"/>
                <input xpath="@maxErrorCount"/>
                <input label="Keep the rejects in a file" xpath="transitions/remainder/@enabled"/>
                <container type="visibleGroup" visibleIf="[transitions/remainder/@enabled]">
                  <input label="Rejection file" menuId="workflowMenuBuilder" type="scriptEdit" xpath="transitions/remainder/@file"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="Iif([/tmp/@dataSourceTarget]=1, [@dataSource-id], 0)" xpath="@dataSource-id"/>
              <set expr="Iif([/tmp/@fileHandling]&lt;2, [/tmp/@fileHandling], 1)" xpath="@importType"/>
              <set expr="Iif([/tmp/@fileHandling]=2, '', @file)" xpath="@file"/>
              <set expr="Iif([/tmp/@fileHandling]=2, @preproc, '')" xpath="@preproc"/>
              <set expr="Iif([/tmp/@fileHandling]=3, @md5, '')" xpath="@md5"/>
            </leave>
          </form>
          <form maxLabelWidth="50" name="soapImport" type="notebook">
            <enter>
              <set expr="Iif(@URL!='', 1, 0)" xpath="/tmp/@useWSDL"/>
            </enter>
            <container img="nms:miniatures/mini-soapImport.png" label="SOAP call">
              <input xpath="@label"/>
              <container type="hpaned">
                <container>
                  <container label="Result format" type="frame">
                    <input checkedValue="0" label="Use an example XML" type="radioButton" xpath="/tmp/@useWSDL"/>
                    <input checkedValue="1" label="Use a WSDL" type="radioButton" xpath="/tmp/@useWSDL"/>
                    <container colcount="2" type="visibleGroup" visibleIf="[/tmp/@useWSDL]=1">
                      <input label="Access URL" xpath="@URL"/>
                      <input label="Generate the skeletal code..." type="subFormLink" xpath=".">
                        <form label="Web service description" type="wizard">
                          <enter>
                            <soapCall name="describeWSDL" service="xtk:workflow">
                              <param exprIn="@URL" type="string"/>
                              <param type="DOMElement" xpathOut="/tmp/wsdlDescription"/>
                            </soapCall>
                            <set expr="[/tmp/wsdlDescription/service[1]/@name]" xpath="@serviceName"/>
                            <setModified/>
                          </enter>
                          <container desc="In the list below, select the function for recovering the data to insert into the database." img="nms:activities/soapImport.png" title="Select function">
                            <value fontBold="true" xpath="@serviceName"/>
                            <input columnIndex="true" editable="false" noToolbar="true" nolabel="true" type="list" xpath="/tmp/wsdlDescription/service[1]/operation" xpathIndex="/tmp/wsdlDescription/@callIndex">
                              <input label="Function" xpath="@name"/>
                              <input label="Prototype" xpath="@label"/>
                            </input>
                            <input expr="Iif([/tmp/wsdlDescription/@callIndex]>=0, NodeValue('/tmp/wsdlDescription/service[1]/operation['+[/tmp/wsdlDescription/@callIndex] + ']/@name'), '')" type="expr" xpath="@callName"/>
                            <input expr="Iif(sample=='' AND [/tmp/wsdlDescription/@callIndex]>=0, NodeValue('/tmp/wsdlDescription/service[1]/operation['+[/tmp/wsdlDescription/@callIndex] + ']/sample'), sample)" type="expr" xpath="/tmp/wsdlDescription/sampleResult"/>
                          </container>
                          <container desc="Here is an example of a call of the selected function. You can change it to specify the expected result." title="Example of a result" visibleIf="[/tmp/wsdlDescription/sampleResult]!=''">
                            <enter/>
                            <input label="Example of a result" lineCount="7" xpath="/tmp/wsdlDescription/sampleResult"/>
                            <input xpath="@collectionResult"/>
                          </container>
                          <leave>
                            <copyElement exprSrc="'/tmp/wsdlDescription/service[1]/operation['+[/tmp/wsdlDescription/@callIndex] + ']'" xpathDst="/tmp/wsdlSelectedCall"/>
                            <set expr="@collectionResult" xpath="/tmp/wsdlSelectedCall/@useCollection"/>
                            <soapCall name="generateSOAPCode" service="xtk:workflow">
                              <param exprIn="[/tmp/wsdlSelectedCall]" type="DOMElement"/>
                              <param type="DOMElement" xpathOut="/tmp/wsdlCalls"/>
                            </soapCall>
                            <set value="yes" xpath="/tmp/wsdlCalls/@validate"/>
                            <if expr="soapInit!='' OR soapCall!=''">
                              <msgBox translatedExpr="'Replace the existing code with the new skeletal code?&quot;" type="yesno" xpathOut="/tmp/wsdlCalls/@validate"/>
                            </if>
                            <if expr="[/tmp/wsdlCalls/@validate]=='yes'">
                              <set expr="[/tmp/wsdlCalls/init]" xpath="soapInit"/>
                              <set expr="[/tmp/wsdlCalls/call]" xpath="soapCall"/>
                              <set expr="[/tmp/wsdlDescription/sampleResult]" xpath="sample"/>
                            </if>
                          </leave>
                        </form>
                      </input>
                      <value colspan="2" fontBold="true" xpath="@serviceName"/>
                      <value colspan="2" fontBold="true" xpath="@callName"/>
                    </container>
                    <container type="visibleGroup" visibleIf="[/tmp/@useWSDL]=0">
                      <input filters="XML files (*.xml)|*.xml|All (*.*)|*.*|" label="Sample file" type="fileEdit" useInlineXML="false" xpath="/tmp/@sampleFile" xpathLoadContent="sample"/>
                    </container>
                    <container colcount="2" importList="true" modeSource="xml" name="autoDetect" type="importAutoDetectContainer" xpath="dataSourceConfig" xpathAutoDetect="../sample" xpathLastParsed="../@lastParsedDataSource" xpathUploadFile="/tmp/@upload">
                      <input colspan="2" xpath="../sample"/>
                      <input img="xtk:fileEdit.png" label="Click here to view and edit analysis results..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                        <form colcount="2" label="File format">
                          <input columnIndex="true" editable="false" img="xtk:xml.png" noToolbar="true" nolabel="true" notitle="true" type="list" xpath="dataSourceColumn" xpathIndex="/tmp/columns/@current" xpathToIgnore="dataSourceColumn/valueMapping">
                            <input xpath="@label"/>
                          </input>
                          <container type="collectionItemGroup" xpath="dataSourceColumn" xpathIndex="/tmp/columns/@current">
                            <input xpath="@label"/>
                            <container type="visibleGroup" visibleIf="@typeXform!=''">
                              <input label="Data type" type="sysEnum" xpath="@typeXform"/>
                            </container>
                            <container type="visibleGroup" visibleIf="@typeXform=''">
                              <input xpath="@type"/>
                            </container>
                            <container type="visibleGroup" visibleIf="@type=='date' OR @typeXform=='date'">
                              <input xpath="@dateFormat"/>
                            </container>
                            <container type="visibleGroup" visibleIf="@type=='time' OR @typeXform=='time'">
                              <input xpath="@timeFormat"/>
                            </container>
                            <container type="visibleGroup" visibleIf="@type=='datetime' OR @typeXform=='datetime'">
                              <input xpath="@dateFormat"/>
                            </container>
                            <container type="visibleGroup" visibleIf="@type=='double' OR @typeXform=='double'">
                              <input xpath="@numFormat"/>
                            </container>
                            <input xpath="@ignore"/>
                            <container type="visibleGroup" visibleIf="!@ignore">
                              <input xpath="@allowNullValues"/>
                              <input xpath="@name"/>
                              <container type="visibleGroup" visibleIf="[/ignored/@hideSQLName]!=1">
                                <input xpath="@sqlname"/>
                                <static type="help">If the SQL name is not specified a default name will be used instead.</static>
                              </container>
                              <input align="right" label="Advanced parameters..." type="subFormLink" xpath=".">
                                <form label="Configure column data" maxLabelWidth="50">
                                  <enter>
                                    <if expr="@stringXform=''">
                                      <set expr="'none'" xpath="@stringXform"/>
                                    </if>
                                    <if expr="@spaceXform=''">
                                      <set expr="'none'" xpath="@spaceXform"/>
                                    </if>
                                    <if expr="@typeXform=''">
                                      <set expr="@type" xpath="@typeXform"/>
                                      <if expr="EV(@typeXform, 'date', 'time', 'datetime')">
                                        <set value="/" xpath="@dateSep"/>
                                        <set value=" " xpath="@dateTimeSep"/>
                                        <set value=":" xpath="@timeSep"/>
                                      </if>
                                    </if>
                                    <if expr="@typeXform=@type">
                                      <set expr="'string'" xpath="@type"/>
                                    </if>
                                  </enter>
                                  <input expr="Iif(EV(@typeXform, 'date','time', 'datetime')=false, '', '/')" type="expr" xpath="@dateSep"/>
                                  <input expr="Iif(EV(@typeXform, 'date','time', 'datetime')=false, '', ' ')" type="expr" xpath="@dateTimeSep"/>
                                  <input expr="Iif(EV(@typeXform, 'date','time', 'datetime')=false, '', ':')" type="expr" xpath="@timeSep"/>
                                  <input label="Data type" xpath="@typeXform"/>
                                  <input xpath="@allowNullValues"/>
                                  <container type="visibleGroup" visibleIf="@typeXform='string'">
                                    <input xpath="@width"/>
                                    <input label="Data transformation" xpath="@stringXform"/>
                                    <input label="White space management" xpath="@spaceXform"/>
                                  </container>
                                  <container type="visibleGroup" visibleIf="@typeXform=='date'">
                                    <container label="Format and separator" maxLabelWidth="300" type="frame">
                                      <input xpath="@dateFormat"/>
                                      <container colcount="2" type="visibleGroup" visibleIf="EV(@dateFormat, 'ymdnosep')=false">
                                        <input label="Year, month, day" width="5" xpath="@dateSep"/>
                                      </container>
                                    </container>
                                  </container>
                                  <container type="visibleGroup" visibleIf="@typeXform=='time'">
                                    <container label="Format and separator" maxLabelWidth="300" type="frame">
                                      <input xpath="@timeFormat"/>
                                      <container colcount="2" type="visibleGroup" visibleIf="EV(@dateFormat, 'ymdnosep')=false">
                                        <input label="Hour, minute, second" width="5" xpath="@timeSep"/>
                                      </container>
                                    </container>
                                  </container>
                                  <container type="visibleGroup" visibleIf="@typeXform=='datetime'">
                                    <container label="Format and separators" maxLabelWidth="300" type="frame">
                                      <input xpath="@dateFormat"/>
                                      <container colcount="2" type="visibleGroup" visibleIf="EV(@dateFormat, 'ymdnosep')=false">
                                        <input label="Year, month, day" width="5" xpath="@dateSep"/>
                                        <input label="Hour, minute, second" width="5" xpath="@timeSep"/>
                                        <input label="Date, hour" width="5" xpath="@dateTimeSep"/>
                                      </container>
                                    </container>
                                  </container>
                                  <container type="visibleGroup" visibleIf="@typeXform=='double'">
                                    <input xpath="@numFormat"/>
                                  </container>
                                  <container colcount="2" label="Mapping" maxLabelWidth="300" type="frame">
                                    <input nolabel="true" type="list" xpath="valueMapping">
                                      <input label="Value" xpath="@src"/>
                                      <input label="Result" xpath="@dst"/>
                                    </input>
                                  </container>
                                  <input xpath="@colProcessing"/>
                                  <container type="visibleGroup" visibleIf="EV(@colProcessing, 'defaultOnErr', 'defaultOnMissing')">
                                    <input xpath="@default"/>
                                  </container>
                                  <leave>
                                    <if expr="@typeXform!=@type">
                                      <set expr="'string'" xpath="@type"/>
                                    </if>
                                  </leave>
                                </form>
                              </input>
                            </container>
                          </container>
                        </form>
                      </input>
                      <input align="right" img="xtk:refresh.png" label="Re-analyze the example" name="autoDetectBtn1" nolabel="false" type="urlButton"/>
                    </container>
                    <input xpath="@collectLineNumber"/>
                    <input xpath="@collectionResult"/>
                  </container>
                </container>
                <container>
                  <static label="Code" type="separator"/>
                  <container type="notebook">
                    <container label="Initialization">
                      <static label="This script lets you initialize communication with the server." type="help"/>
                      <input nolabel="true" type="jsedit" xpath="soapInit">
                        <container>
                          <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                        </container>
                      </input>
                    </container>
                    <container label="Iteration">
                      <static label="Each result of the script call above will be stored in the work table. \nTo end this SOAP session, please return 'null'" type="help"/>
                      <input nolabel="true" type="jsedit" xpath="soapCall">
                        <container>
                          <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                        </container>
                      </input>
                    </container>
                    <container label="Finalization">
                      <static label="This script lets you free all possible resources used during previous calls." type="help"/>
                      <input nolabel="true" type="jsedit" xpath="soapEnd">
                        <container>
                          <input menuId="workflowMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                        </container>
                      </input>
                    </container>
                  </container>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <if expr="[/tmp/@useWSDL]='0'">
                <set value="" xpath="@URL"/>
              </if>
            </leave>
          </form>
          <form name="fileExport" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name)" xpath="/ignored/@orgSchema"/>
            </enter>
            <container img="xtk:miniatures/mini-export.png">
              <input xpath="@label"/>
              <container label="File to extract" type="frame">
                <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@file"/>
                <input img="xtk:export.png" label="Edit the file format..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form img="xtk:export32.png" label="Extraction file format" type="wizard">
                    <enter>
                      <set value="" xpath="/tmp/@schemaChoice"/>
                      <set expr="wkfTargetSchema(@name, '', 1)" xpath="extraction/source/@schema"/>
                      <set expr="[extraction/source/@schema]" xpath="/tmp/selectCtrl/in/@schema"/>
                      <set value="export" xpath="/tmp/selectCtrl/in/@choiceType"/>
                    </enter>
                    <container ref="xtk:exportSource:column" xpath="extraction"/>
                    <container ref="xtk:exportSource:conditionLink" visibleIf="[extraction/source/conditionLink/@xpath]!=''" xpath="extraction"/>
                    <container ref="xtk:exportSource:sort" xpath="extraction"/>
                    <container ref="xtk:exportSource:destInfo" xpath="extraction"/>
                    <container ref="xtk:exportSource:mapping" xpath="extraction"/>
                  </form>
                </input>
                <container type="visibleGroup" visibleIf="[/ignored/@orgSchema]==''">
                  <static type="warning">This activity requires an inbound population.</static>
                </container>
              </container>
              <input label="Generate an outbound transition" xpath="transitions/done/@enabled"/>
              <input label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container img="xtk:script.png" label="Script">
              <static type="help">Export modification script</static>
              <input nolabel="true" xpath="script">
                <container>
                  <input menuId="wfExportMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                </container>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="union" type="notebook">
            <enter>
              <set expr="Iif(@useKeyForReconciliation, 0, Iif(nodeCount(joinKeys)==0, 1, 2))" xpath="/tmp/@joinType"/>
              <set expr="wkfTargetSchema(@name)" xpath="/tmp/@joinSchema"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-union.png">
              <input colspan="2" xpath="@label"/>
              <container colspan="2" label="Reconciliation" type="frame">
                <input checkedValue="0" label="Keys only" type="RadioButton" xpath="/tmp/@joinType"/>
                <input checkedValue="1" label="All shared columns" type="RadioButton" xpath="/tmp/@joinType"/>
                <input checkedValue="2" label="A selection of columns" type="RadioButton" xpath="/tmp/@joinType"/>
                <container type="visibleGroup" visibleIf="[/tmp/@joinType]==1">
                  <input type="ExclusionMainSetEdit" xpath="@mainSet"/>
                  <static type="help">Select the population above for which the characteristics will be kept for the rest of the workflow</static>
                </container>
                <container type="visibleGroup" visibleIf="[/tmp/@joinType]==2">
                  <input type="ExclusionMainSetEdit" xpath="@mainSet"/>
                  <static type="help">Select the population above for which the characteristics will be kept for the rest of the workflow</static>
                  <static label="Columns used for the join" type="separator"/>
                  <input label=" " toolbarAlign="vertical" type="list" xpath="joinKeys">
                    <input type="pathEdit" xpath="@xpath" xpathSchema="/tmp/@joinSchema"/>
                  </input>
                </container>
              </container>
              <input colspan="2" xpath="@useOnlyCommonColumns"/>
              <input colspan="2" xpath="@enableLimit"/>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@enableLimit">
                <input label="Number" xpath="@limit"/>
                <static label="This field specifies the maximum number of records in the inbound populations." type="help"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@enableLimit">
                <static label="Priorities of inbound populations" type="separator"/>
                <input editable="false" hideEditButtons="true" label=" " toolbarAlign="vertical" type="UnionLimitList" xpath="eventLimit">
                  <input xpath="@label"/>
                  <input xpath="@name"/>
                </input>
                <static label="Inbound populations are used up in priority order until the maximum number of records is reached." type="help"/>
              </container>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="Iif([/tmp/@joinType]==0, 1, 0)" xpath="@useKeyForReconciliation"/>
            </leave>
          </form>
          <form name="intersection" type="notebook">
            <enter>
              <set expr="Iif(@useKeyForReconciliation, 0, Iif(nodeCount(joinKeys)==0, 1, 2))" xpath="/tmp/@joinType"/>
              <set expr="wkfTargetSchema(@name)" xpath="/tmp/@joinSchema"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-intersection.png">
              <input colspan="2" xpath="@label"/>
              <container colspan="2" label="Reconciliation" type="frame">
                <input checkedValue="0" label="Keys only" type="RadioButton" xpath="/tmp/@joinType"/>
                <input checkedValue="1" label="All shared columns" type="RadioButton" xpath="/tmp/@joinType"/>
                <input checkedValue="2" label="A selection of columns" type="RadioButton" xpath="/tmp/@joinType"/>
                <container type="visibleGroup" visibleIf="[/tmp/@joinType]==1">
                  <input type="ExclusionMainSetEdit" xpath="@mainSet"/>
                  <static type="help">Select the population above for which the characteristics will be kept for the rest of the workflow</static>
                </container>
                <container type="visibleGroup" visibleIf="[/tmp/@joinType]==2">
                  <input type="ExclusionMainSetEdit" xpath="@mainSet"/>
                  <static type="help">Select the population above for which the characteristics will be kept for the rest of the workflow</static>
                  <static label="Columns used for the join" type="separator"/>
                  <input label=" " toolbarAlign="vertical" type="list" xpath="joinKeys">
                    <input type="pathEdit" xpath="@xpath" xpathSchema="/tmp/@joinSchema"/>
                  </input>
                </container>
              </container>
              <input colspan="2" xpath="@useOnlyCommonColumns"/>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
                <static colspan="2" label="Complement" type="separator"/>
                <input colspan="2" xpath="remainder/@enabled"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                  <input xpath="remainder/@code"/>
                </container>
                <static colspan="2" type="help">The complement set is the union of the inputs minus the intersection.</static>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="Iif([/tmp/@joinType]==0, 1, 0)" xpath="@useKeyForReconciliation"/>
            </leave>
          </form>
          <form name="exclusion" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name)" xpath="/tmp/@exclusionSetSchema"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-exclusion.png">
              <input colspan="2" xpath="@label"/>
              <input colspan="2" type="ExclusionMainSetEdit" xpath="@mainSet"/>
              <static colspan="2" type="help">Select the population above from which records included in the other populations will be excluded.</static>
              <input colspan="2" expr="wkfSchemaName(@mainSet)" type="expr" xpath="/tmp/@exclusionSetSchema"/>
              <static colspan="2" label="Exclusion rules for incompatible targeting dimensions" type="separator"/>
              <input colspan="2" editable="false" label=" " type="list" xpath="exclusionSet" zoom="true" zoomOnAdd="true">
                <input type="ExclusionMainSetEdit" xpath="@name" xpathActivityName="../@name"/>
                <input xpath="@excludeType"/>
                <input xpath="@excludeAxis"/>
                <input xpath="@excludePath"/>
                <form label="Exception definition" maxLabelWidth="60">
                  <enter>
                    <set expr="wkfSchemaName(@name)" xpath="/tmp/@exclusionExceptionSchema"/>
                  </enter>
                  <input type="ExclusionMainSetEdit" xpath="@name" xpathActivityName="../@name"/>
                  <input expr="wkfSchemaName(@name)" type="expr" xpath="/tmp/@exclusionExceptionSchema"/>
                  <input label="Change dimension" xpath="@excludeType"/>
                  <container type="visibleGroup" visibleIf="EV(@excludeType, 'axis')">
                    <input label="Link" nolabel="false" type="pathEdit" useTablePath="true" xpath="@excludeAxis" xpathSchema="/tmp/@exclusionExceptionSchema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="EV(@excludeType, 'id')">
                    <input label="Field" nolabel="false" type="pathEdit" xpath="@excludePath" xpathSchema="/tmp/@exclusionExceptionSchema"/>
                  </container>
                  <container type="visibleGroup" visibleIf="EV(@excludeType, 'join')">
                    <input nolabel="true" toolbarCaption="Columns used for the join" type="List" xpath="joinKeys">
                      <input type="pathEdit" xpath="@xpathSrc" xpathSchema="/tmp/@exclusionExceptionSchema"/>
                      <input type="pathEdit" xpath="@xpathDst" xpathSchema="/tmp/@exclusionSetSchema"/>
                    </input>
                  </container>
                </form>
              </input>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
                <static colspan="2" label="Complement" type="separator"/>
                <input colspan="2" xpath="remainder/@enabled"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                  <input xpath="remainder/@code"/>
                </container>
                <static colspan="2" type="help">The complement set is the intersection between the union of the inputs and the primary set.</static>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="extract" type="notebook">
            <enter>
              <set expr="wkfSourceActivity(@name, 1)!=''" xpath="/ignored/@hasMultipleSource"/>
              <if expr="![/ignored/@hasMultipleSource]">
                <set value="" xpath="@mainSet"/>
              </if>
              <if expr="[/ignored/@hasMultipleSource] AND @mainSet=''">
                <set expr="wkfSourceActivity(@name)" xpath="@mainSet"/>
              </if>
              <set expr="wkfTargetSchema(@name, Iif(@mainSet='', '', 'src'))" xpath="/ignored/@targetExtension"/>
              <set expr="wkfSchemaName(wkfSourceActivity(@name), wkfTransitionName(wkfSourceActivity(@name), @name))" xpath="/ignored/@extractSource"/>
              <refresh xpath="/workflow"/>
              <set value="0" xpath="/tmp/@acceptTempSchema"/>
              <set value="0" xpath="/tmp/@useTempSchema"/>
              <set value="" xpath="/ignored/@splitType"/>
              <if expr="SubString(@schema, 0, 5)!='temp:' or [@recipientLink]!=''">
                <set value="linkedData" xpath="/ignored/@splitType"/>
              </if>
              <if expr="NodeValue('extension/schema[@name=\''+ExtractRight(@schema,':')+'\']/element/@dataSource')!=''">
                <set value="extSharedData" xpath="/ignored/@splitType"/>
              </if>
              <if expr="[/ignored/@splitType]='' and [@recipientLink]=''">
                <set value="targetData" xpath="/ignored/@splitType"/>
                <if expr="SubString(@schema, 0, 5)='temp:'">
                  <set expr="[/ignored/@extractSource]" xpath="@schema"/>
                </if>
              </if>
              <forEach xpath="transitions/extractOutput">
                <if expr="!@schemaOverride">
                  <set expr="[../../@schema]" xpath="@schema"/>
                  <set expr="[../../@recipientLink]" xpath="@recipientLink"/>
                </if>
                <if expr="@schemaOverride and SubString(@schema, 0, 5)='temp:' and [/ignored/@hasMultipleSource]==false">
                  <set expr="[/ignored/@extractSource]" xpath="@schema"/>
                </if>
              </forEach>
              <if expr="@schema==''">
                <set value="nms:recipient" xpath="@schema"/>
              </if>
              <set translatedExpr="'Add data...'" xpath="/ignored/@strAddData"/>
              <set translatedExpr="'Edit linked data...'" xpath="/ignored/@strEditLinkedData"/>
            </enter>
            <container img="nms:miniatures/mini-piechart.png" label="Sub-sets" xpath="transitions/extractOutput">
              <container style="down" toolbarAlign="horizontal" toolbarCaption="Sub-set computation parameters" type="notebookList" xpath="." xpath-label="@label">
                <container img="nms:subset.png" ref="xtk:workflow:lib/tabs/filterTransitionPage"/>
              </container>
            </container>
            <container colcount="2" label="General" ref="xtk:workflow:lib/tabs/extractGene"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="[transitions/remainder/@enabled]==1 AND [@alwaysExtractFromSource]==0" xpath="transitions/remainder/@enabled"/>
            </leave>
          </form>
          <form name="offerCells" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name)" xpath="/ignored/@targetExtension"/>
              <set expr="wkfSchemaName(wkfSourceActivity(@name), wkfTransitionName(wkfSourceActivity(@name), @name))" xpath="/ignored/@extractSource"/>
              <refresh xpath="/workflow"/>
              <set value="0" xpath="/tmp/@acceptTempSchema"/>
              <set value="0" xpath="/tmp/@useTempSchema"/>
              <set value="" xpath="/ignored/@splitType"/>
              <if expr="SubString(@schema, 0, 5)!='temp:' or [@recipientLink]!=''">
                <set value="linkedData" xpath="/ignored/@splitType"/>
              </if>
              <if expr="NodeValue('extension/schema[@name=\''+ExtractRight(@schema,':')+'\']/element/@dataSource')!=''">
                <set value="extSharedData" xpath="/ignored/@splitType"/>
              </if>
              <if expr="[/ignored/@splitType]='' and [@recipientLink]=''">
                <set value="targetData" xpath="/ignored/@splitType"/>
                <if expr="SubString(@schema, 0, 5)='temp:'">
                  <set expr="[/ignored/@extractSource]" xpath="@schema"/>
                </if>
              </if>
              <forEach xpath="transitions/extractOutput">
                <if expr="!@schemaOverride">
                  <set expr="[../../@schema]" xpath="@schema"/>
                  <set expr="[../../@recipientLink]" xpath="@recipientLink"/>
                </if>
              </forEach>
              <if expr="@schema==''">
                <set value="nms:recipient" xpath="@schema"/>
              </if>
              <set value="proposition/offerSpace" xpath="select/node[1]/@alias"/>
              <set value="link" xpath="select/node[1]/@type"/>
              <set value="nms:offerSpace" xpath="select/node[1]/@dataType"/>
              <set value="nms:proposition" xpath="/ignored/offerCells/@schema"/>
              <set value="offerSpace" xpath="/ignored/offerCells/@xpath"/>
              <set expr="LabelOf('/ignored/offerCells/@xpath', '/ignored/offerCells/@schema')" xpath="select/node[1]/@label"/>
              <set value="proposition/@channel" xpath="select/node[2]/@alias"/>
              <set value="nms:offerSpace" xpath="/ignored/offerCells/@schema"/>
              <set value="@channel" xpath="/ignored/offerCells/@xpath"/>
              <set expr="LabelOf('/ignored/offerCells/@xpath', '/ignored/offerCells/@schema')" xpath="select/node[2]/@label"/>
              <set value="byte" xpath="select/node[2]/@type"/>
              <set value="nms:offerSpace:@channel" xpath="select/node[2]/@ref"/>
              <set value="proposition/@offerViewSchema" xpath="select/node[3]/@alias"/>
              <set value="nms:offerView" xpath="/ignored/offerCells/@schema"/>
              <set expr="SchemaLabel('/ignored/offerCells/@schema')" xpath="select/node[3]/@label"/>
              <set value="string" xpath="select/node[3]/@type"/>
              <set value="nms:offerView" xpath="select/node[3]/@value"/>
              <if expr="NodeValue('select/node[1]/@value')!=''">
                <set value="nms:offerSpace" xpath="/ignored/queryDef/@schema"/>
                <set value="get" xpath="/ignored/queryDef/@operation"/>
                <set value="[@env-id]" xpath="/ignored/queryDef/select/node[1]/@expr"/>
                <set expr="'@id='+NodeValue('select/node[1]/@value')" xpath="/ignored/queryDef/where/condition/@expr"/>
                <soapCall name="ExecuteQuery" service="xtk:queryDef">
                  <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                  <param type="DOMDocument" xpathOut="/ignored/offerSpace"/>
                </soapCall>
              </if>
            </enter>
            <container img="nms:miniatures/mini-offerCells.png" label="Cells" xpath="transitions/extractOutput">
              <input editable="false" nolabel="true" ordered="true" prebuildSubForm="false" toolbarAlign="horizontal" toolbarCaption="Sub-set computation parameters" type="list" xpath="." xpathRefresh="../*" xpathToIgnore="filter/where,limiter/orderBy,limiter/groupBy" zoom="true">
                <form name="cellDetail" type="notebook">
                  <enter>
                    <if expr="@schema=''">
                      <set expr="[../../@schema]" xpath="@schema"/>
                      <set expr="[../../@recipientLink]" xpath="@recipientLink"/>
                      <set value="false" xpath="@schemaOverride"/>
                    </if>
                    <copyElement xpathDst="select/node[1]" xpathSrc="../../select/node[1]"/>
                    <copyElement xpathDst="select/node[2]" xpathSrc="../../select/node[2]"/>
                    <copyElement xpathDst="select/node[3]" xpathSrc="../../select/node[3]"/>
                    <set value="proposition/offer" xpath="select/node[4]/@alias"/>
                    <set value="link" xpath="select/node[4]/@type"/>
                    <set value="nms:offer" xpath="select/node[4]/@dataType"/>
                    <set value="nms:proposition" xpath="/ignored/offerCells/@schema"/>
                    <set value="offer" xpath="/ignored/offerCells/@xpath"/>
                    <set expr="LabelOf('/ignored/offerCells/@xpath', '/ignored/offerCells/@schema')" xpath="select/node[4]/@label"/>
                  </enter>
                  <container colcount="2" img="nms:subset.png" label="Selection">
                    <input xpath="@label"/>
                    <input xpath="@code"/>
                    <container ref="xtk:workflow:lib/tabs/filterTransitionPage/splitSelection"/>
                    <container colspan="2" type="visibleGroup" visibleIf="[/ignored/offerSpace/@env-id]!=''">
                      <container xpath="select/node[1]">
                        <input computeStringAlias="@valueLabel" label="Space" readOnly="true" schema="nms:offerSpace" type="linkEdit" xpath="@value"/>
                      </container>
                      <container xpath="select/node[4]">
                        <input computeStringAlias="@valueLabel" label="Offer" notifyPathList="@_cs|@valueLabel" schema="nms:offer" type="linkEdit" xpath="@value">
                          <sysFilter>
                            <condition expr="@status = 6"/>
                            <condition expr="[category/@env-id]=$long(/ignored/offerSpace/@env-id)"/>
                          </sysFilter>
                        </input>
                      </container>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="[/ignored/offerSpace/@env-id]=''">
                      <static label="Please enter a space in the activity's 'Main' tab." type="warning"/>
                    </container>
                  </container>
                  <container ref="xtk:workflow:lib/tabs/advancedExtractOutputPage"/>
                </form>
                <input editable="true" xpath="@label"/>
                <input editable="true" xpath="filter/@enabled"/>
                <input editable="false" expr="Iif([filter/@enabled], [filter/humanCond], '')" label="Filter"/>
                <input editable="true" xpath="limiter/@enabled"/>
                <input editable="false" expr="Iif([limiter/@enabled], [limiter/humanCond], '')" label="Limit"/>
                <input editable="true" xpath="@forExclusion"/>
                <input editable="false" xpath="@code"/>
              </input>
            </container>
            <container colcount="2" label="Main">
              <input colspan="2" xpath="@label"/>
              <container colspan="2" type="visibleGroup" visibleIf="@mainSet!=''">
                <input type="ExclusionMainSetEdit" xpath="@mainSet"/>
              </container>
              <container colspan="2">
                <static label="Filtering settings" type="separator"/>
                <input checkedValue="linkedData" label="Use data from the target and additional data" nolabel="false" type="radioButton" xpath="/ignored/@splitType"/>
                <input checkedValue="targetData" label="Use the additional data only" nolabel="false" type="radioButton" xpath="/ignored/@splitType"/>
                <input applicableIf="HasPackage('nms:federatedDataAccess')" checkedValue="extSharedData" label="Use external data" nolabel="false" type="radioButton" xpath="/ignored/@splitType"/>
                <container type="visibleGroup" visibleIf="[/ignored/@splitType]='linkedData'">
                  <container ref="xtk:workflow:lib/tabs/schemaSelector"/>
                </container>
                <container type="visibleGroup" visibleIf="[/ignored/@splitType]='targetData'">
                  <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="@schema"/>
                </container>
                <input expr="Iif([/ignored/@splitType]='targetData', [/ignored/@extractSource], NodeValue('@schema'))" type="expr" xpath="@schema"/>
                <input expr="Iif([/ignored/@splitType]='targetData', '', NodeValue('@recipientLink'))" type="expr" xpath="@recipientLink"/>
                <container applicableIf="HasPackage('nms:federatedDataAccess')" type="visibleGroup" visibleIf="[/ignored/@splitType]='extSharedData' OR [/ignored/@splitType]='externalData'">
                  <input label="Targeting dimension" type="targetSchema" xpath="@schema" xpathLink="@recipientLink">
                    <form entity-schema="xtk:schema" label="Please select a document" name="entitySchema" namespace="xtk" nothingToSave="true">
                      <input monoSelection="true" notifyFolderKeyPath="" schema="xtk:schema" type="linkListChoice" xpath=".">
                        <input alias="@_cs" expr="[.]"/>
                        <input xpath="[.]"/>
                        <input xpath="@namespace"/>
                        <input xpath="@name"/>
                        <orderBy>
                          <node expr="@label"/>
                        </orderBy>
                      </input>
                    </form>
                  </input>
                  <input label="Filtering dimension" readOnly="true" type="targetSchemaLink" xpath="@schema" xpathLink="@recipientLink"/>
                  <input img="xtk:xtklinkn.png" labelExpr="Iif(NodeCount([extension])==0, [/ignored/@strAddData], [/ignored/@strEditLinkedData])" nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
                    <enter name="onClick">
                      <set expr="@schema" xpath="/tmp/selectCtrl/in/@schema"/>
                      <set value="1" xpath="/tmp/queryAdd/@dataTypeReadOnly"/>
                      <set value="1" xpath="/tmp/queryAdd/@reverseLink"/>
                      <set expr="[/ignored/@splitType]" xpath="/tmp/queryAdd/@dataType"/>
                    </enter>
                    <form label="Additional data" ref="xtk:workflow:lib/subforms/queryAdd" type="wizard"/>
                  </input>
                </container>
              </container>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input colspan="2" xpath="../@alwaysExtractFromSource"/>
                <input colspan="2" xpath="../@concatenateSegmentCode"/>
                <input colspan="2" xpath="done/@enabled"/>
                <input expr="wkfTargetSchema(Iif([../@concatenateSegmentCode] and [done/@enabled], NodeValue('../@name'), NodeValue('../@name')), Iif([../@mainSet]='', '', 'src'))" type="expr" xpath="/ignored/@ignoredSchema"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[done/@enabled]">
                  <input xpath="done/@label"/>
                  <input xpath="done/@code"/>
                </container>
                <container type="visibleGroup" visibleIf="![../@alwaysExtractFromSource]">
                  <input colspan="2" xpath="remainder/@enabled"/>
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[remainder/@enabled]">
                    <input xpath="remainder/@label"/>
                    <input xpath="remainder/@code"/>
                  </container>
                  <static colspan="2" type="help">If this option is checked, a complementary subset will contain all remaining records.</static>
                </container>
                <static colspan="2" type="help">Select the space whose offers you want to use.</static>
                <container colspan="2" xpath="../select/node[1]">
                  <input computeStringAlias="@valueLabel" label="Space" notifyPathList="@_cs|@valueLabel,@channel|../../select/node[2]/@value,@env-id|/ignored/offerSpace/@env-id" schema="nms:offerSpace" type="linkEdit" xpath="@value">
                    <sysFilter>
                      <condition expr="[env/@live]=true"/>
                    </sysFilter>
                  </input>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="[transitions/remainder/@enabled]==1 AND [@alwaysExtractFromSource]==0" xpath="transitions/remainder/@enabled"/>
              <forEach xpath="transitions/extractOutput">
                <copyElement xpathDst="select/node[1]" xpathSrc="../../select/node[1]"/>
                <copyElement xpathDst="select/node[2]" xpathSrc="../../select/node[2]"/>
                <copyElement xpathDst="select/node[3]" xpathSrc="../../select/node[3]"/>
              </forEach>
            </leave>
          </form>
          <form name="extractCells" type="notebook">
            <enter>
              <set expr="wkfTargetSchema(@name)" xpath="/ignored/@targetExtension"/>
              <set expr="wkfSchemaName(wkfSourceActivity(@name), wkfTransitionName(wkfSourceActivity(@name), @name))" xpath="/ignored/@extractSource"/>
              <refresh xpath="/workflow"/>
              <set value="0" xpath="/tmp/@acceptTempSchema"/>
              <set value="0" xpath="/tmp/@useTempSchema"/>
              <set value="" xpath="/ignored/@splitType"/>
              <if expr="SubString(@schema, 0, 5)!='temp:' or [@recipientLink]!=''">
                <set value="linkedData" xpath="/ignored/@splitType"/>
              </if>
              <if expr="NodeValue('extension/schema[@name=\''+ExtractRight(@schema,':')+'\']/element/@dataSource')!=''">
                <set value="extSharedData" xpath="/ignored/@splitType"/>
              </if>
              <if expr="[/ignored/@splitType]='' and [@recipientLink]=''">
                <set value="targetData" xpath="/ignored/@splitType"/>
                <if expr="SubString(@schema, 0, 5)='temp:'">
                  <set expr="[/ignored/@extractSource]" xpath="@schema"/>
                </if>
              </if>
              <forEach xpath="transitions/extractOutput">
                <if expr="!@schemaOverride">
                  <set expr="[../../@schema]" xpath="@schema"/>
                  <set expr="[../../@recipientLink]" xpath="@recipientLink"/>
                </if>
              </forEach>
              <if expr="@schema==''">
                <set value="nms:recipient" xpath="@schema"/>
              </if>
            </enter>
            <container img="nms:miniatures/mini-cells.png" label="Cells" xpath="transitions/extractOutput">
              <input editable="false" nolabel="true" ordered="true" prebuildSubForm="false" toolbarAlign="horizontal" toolbarCaption="Sub-set computation parameters" type="list" xpath="." xpathRefresh="../*" xpathToIgnore="filter/where,limiter/orderBy,limiter/groupBy" zoom="true">
                <form name="cellDetail" type="notebook">
                  <enter>
                    <if expr="@schema=''">
                      <set expr="[../../@schema]" xpath="@schema"/>
                      <set expr="[../../@recipientLink]" xpath="@recipientLink"/>
                      <set value="false" xpath="@schemaOverride"/>
                    </if>
                  </enter>
                  <container ref="xtk:workflow:lib/tabs/filterTransitionPage"/>
                  <container ref="xtk:workflow:lib/tabs/advancedExtractOutputPage"/>
                </form>
                <input editable="true" xpath="@label"/>
                <input editable="true" xpath="filter/@enabled"/>
                <input editable="false" expr="Iif([filter/@enabled], [filter/humanCond], '')" label="Filter"/>
                <input editable="true" xpath="limiter/@enabled"/>
                <input editable="false" expr="Iif([limiter/@enabled], [limiter/humanCond], '')" label="Limit"/>
                <input editable="true" xpath="@forExclusion"/>
                <input editable="false" xpath="@code"/>
              </input>
            </container>
            <container colcount="2" label="General" ref="xtk:workflow:lib/tabs/extractGene"/>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <set expr="[transitions/remainder/@enabled]==1 AND [@alwaysExtractFromSource]==0" xpath="transitions/remainder/@enabled"/>
            </leave>
          </form>
          <form name="dedup" type="notebook">
            <enter>
              <set expr="Iif(@merge, wkfTargetSchema(@name), wkfTargetSchema(wkfSourceActivity(@name), wkfTransitionName(wkfSourceActivity(@name), @name), 1))" xpath="/tmp/selectCtrl/in/@schema"/>
              <set expr="@schema" xpath="/tmp/mergeCollection/@schema"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-dedup.png">
              <input colspan="2" xpath="@label"/>
              <static colspan="2" label="Deduplication parameters" type="separator"/>
              <input colspan="2" img="nms:miniatures/mini-dedup.png" label="Edit configuration..." nolabel="false" prebuildSubForm="false" type="DedupFormLink" xpath=".">
                <form label="Deduplication" name="queryWizard" nothingToSave="true" type="wizard">
                  <enter>
                    <if expr="@schema==''">
                      <set value="nms:recipient" xpath="@schema"/>
                    </if>
                    <set expr="" xpath="/ignored/@display"/>
                    <set value="-1" xpath="/ignored/dedup/@type"/>
                    <if expr="count(groupExpr)==1 and [groupExpr[1]/@expr]=='@email'">
                      <set value="0" xpath="/ignored/dedup/@type"/>
                    </if>
                    <if expr="count(groupExpr)==1 and [groupExpr[1]/@expr]=='@mobilePhone'">
                      <set value="1" xpath="/ignored/dedup/@type"/>
                    </if>
                    <if expr="count(groupExpr)==1 and [groupExpr[1]/@expr]=='@phone'">
                      <set value="2" xpath="/ignored/dedup/@type"/>
                    </if>
                    <if expr="count(groupExpr)==1 and [groupExpr[1]/@expr]=='@fax'">
                      <set value="3" xpath="/ignored/dedup/@type"/>
                    </if>
                    <if expr="count(groupExpr)==6 and [groupExpr[1]/@expr]=='[postalAddress/@line1]' AND [groupExpr[2]/@expr]=='[postalAddress/@line6]' AND [groupExpr[3]/@expr]=='[postalAddress/@line2]' AND [groupExpr[4]/@expr]=='[postalAddress/@line3]' AND [groupExpr[5]/@expr]=='[postalAddress/@line4]' AND [groupExpr[6]/@expr]=='[postalAddress/@line5]'">
                      <set value="4" xpath="/ignored/dedup/@type"/>
                    </if>
                    <if expr="[/ignored/dedup/@type]==-1">
                      <set value="5" xpath="/ignored/dedup/@type"/>
                    </if>
                    <set value="1" xpath="/tmp/@acceptTempSchema"/>
                    <set expr="Iif(Substring(@schema, 0, 4)=='temp', 1, 0) AND @recipientLink=''" xpath="/tmp/@useTempSchema"/>
                    <set expr="Substring(@schema, 5)" xpath="/tmp/@srcDataSet"/>
                  </enter>
                  <container desc="Please select the targeting type for the target element." name="typePage" title="Targeting dimension">
                    <container ref="xtk:workflow:lib/tabs/schemaSelector"/>
                    <container type="visibleGroup" visibleIf="@schema=='nms:recipient'">
                      <input checkedValue="0" label="Email" type="RadioButton" xpath="/ignored/dedup/@type"/>
                      <input checkedValue="1" label="SMS" type="RadioButton" xpath="/ignored/dedup/@type"/>
                      <input checkedValue="2" label="Phone" type="RadioButton" xpath="/ignored/dedup/@type"/>
                      <input checkedValue="3" label="Fax" type="RadioButton" xpath="/ignored/dedup/@type"/>
                      <input checkedValue="4" label="Postal address" type="RadioButton" xpath="/ignored/dedup/@type"/>
                      <input checkedValue="5" label="Other" type="RadioButton" xpath="/ignored/dedup/@type"/>
                    </container>
                    <leave>
                      <if expr="@schema='nms:recipient'">
                        <if expr="[/ignored/dedup/@type]!=5">
                          <reset xpath="groupExpr[*]"/>
                          <if expr="[/ignored/dedup/@type]==0">
                            <set value="@email" xpath="groupExpr[1]/@expr"/>
                            <set translatedExpr="'Email'" xpath="groupExpr[1]/@label"/>
                          </if>
                          <if expr="[/ignored/dedup/@type]==1">
                            <set value="@mobilePhone" xpath="groupExpr[1]/@expr"/>
                            <set translatedExpr="'Mobile'" xpath="groupExpr[1]/@label"/>
                          </if>
                          <if expr="[/ignored/dedup/@type]==2">
                            <set value="@phone" xpath="groupExpr[1]/@expr"/>
                            <set translatedExpr="'Telephone'" xpath="groupExpr[1]/@label"/>
                          </if>
                          <if expr="[/ignored/dedup/@type]==3">
                            <set value="@fax" xpath="groupExpr[1]/@expr"/>
                            <set translatedExpr="'Fax'" xpath="groupExpr[1]/@label"/>
                          </if>
                          <if expr="[/ignored/dedup/@type]==4">
                            <set value="[postalAddress/@line1]" xpath="groupExpr[1]/@expr"/>
                            <set translatedExpr="'Postal address (Last name, first name)'" xpath="groupExpr[1]/@label"/>
                            <set value="[postalAddress/@line6]" xpath="groupExpr[2]/@expr"/>
                            <set translatedExpr="'Postal address (Zip code, city)'" xpath="groupExpr[2]/@label"/>
                            <set value="[postalAddress/@line2]" xpath="groupExpr[3]/@expr"/>
                            <set translatedExpr="'Postal address (line 2)'" xpath="groupExpr[3]/@label"/>
                            <set value="[postalAddress/@line3]" xpath="groupExpr[4]/@expr"/>
                            <set translatedExpr="'Postal address (line 3)'" xpath="groupExpr[4]/@label"/>
                            <set value="[postalAddress/@line4]" xpath="groupExpr[5]/@expr"/>
                            <set translatedExpr="'Postal address (Street)'" xpath="groupExpr[5]/@label"/>
                            <set value="[postalAddress/@line5]" xpath="groupExpr[6]/@expr"/>
                            <set translatedExpr="'Postal address (line 5)'" xpath="groupExpr[6]/@label"/>
                          </if>
                        </if>
                      </if>
                    </leave>
                  </container>
                  <container desc="Please specify the list of fields or expressions which are used to find duplicates in case of identical values." name="group" title="Identification of duplicates" visibleIf="[/ignored/dedup/@type]=5 or @schema!='nms:recipient'">
                    <input nolabel="true" toolbarCaption="List of fields" type="list" xpath="groupExpr" xpathChoiceTarget="@expr">
                      <input hideCalculated="false" hideMappedAsXml="true" label="Expression" type="pathedit" xpath="@expr" xpathLabel="@label" xpathSchema="../@schema"/>
                      <input xpath="@label"/>
                    </input>
                  </container>
                  <container desc="Please select the method used to identify the records to keep." name="group" title="Deduplication method">
                    <input label="Doubles to keep" xpath="@number"/>
                    <input xpath="@type"/>
                    <container type="visibleGroup" visibleIf="@type='choice'">
                      <static label="Randomly select which duplicates to keep." type="help"/>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='order'">
                      <static label="The record priority order is based on the following, for one or more fields (or expressions)." type="help"/>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='noEmpty'">
                      <static label="Records for which the expression is not empty have priority." type="help"/>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='expr'">
                      <static label="Keep records for which the specified expression has the smallest or largest value." type="help"/>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='order'">
                      <container style="down" toolbarAlign="horizontal" toolbarCaption="List of values" type="notebookList" xpath="orderedValue" xpath-label="@label">
                        <container>
                          <input hideCalculated="true" hideMappedAsXml="false" label="Expression" nolabel="false" type="pathedit" xpath="@expr" xpathLabel="@label" xpathSchema="../@schema"/>
                          <input label=" " nolabel="false" type="EnumEditList" xpath="value" xpathSchema="../@schema" xpathType="@expr">
                            <input xpath="@value"/>
                          </input>
                          <static label="Other values" type="separator"/>
                          <input checkedValue="0" label="Indifferent" type="radioButton" xpath="@orderType"/>
                          <input checkedValue="1" label="Keep the smallest value" type="radioButton" xpath="@orderType"/>
                          <input checkedValue="2" label="Keep the largest value" type="radioButton" xpath="@orderType"/>
                        </container>
                      </container>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='expr' or @type='noEmpty'">
                      <input hideMappedAsXml="true" label="Expression" nolabel="false" type="pathedit" xpath="@expr" xpathSchema="@schema"/>
                    </container>
                    <container type="visibleGroup" visibleIf="@type='expr'">
                      <input checkedValue="0" label="Keep the records with the smallest value" type="radioButton" xpath="@compType"/>
                      <input checkedValue="1" label="Keep the records with the largest value" type="radioButton" xpath="@compType"/>
                    </container>
                    <input align="right" label="Advanced parameters..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
                      <form label="Deduplication parameter">
                        <input xpath="@noAutoPkFilter"/>
                        <container enabledIf="[@number]==1" type="enabledGroup">
                          <static label="When keeping a single record, you can create a record merging data from the selected duplicates." type="help"/>
                          <input xpath="@merge"/>
                          <input xpath="@multipleMergeCriteria"/>
                        </container>
                        <container enabledIf="[@number]!=1" type="enabledGroup">
                          <static label="If necessary, you can keep the sequence of records selected by the deduplication process." type="help"/>
                          <input xpath="@keepRank"/>
                        </container>
                      </form>
                    </input>
                  </container>
                  <leave>
                    <set value="1" xpath="/ignored/@display"/>
                    <set expr="Iif(@merge, wkfTargetSchema(@name), wkfTargetSchema(wkfSourceActivity(@name), wkfTransitionName(wkfSourceActivity(@name), @name), 1))" xpath="/tmp/selectCtrl/in/@schema"/>
                    <set expr="@schema" xpath="/tmp/mergeCollection/@schema"/>
                  </leave>
                </form>
              </input>
              <input colspan="2" fontBold="true" label=" " lineCount="5" noBorder="true" readOnly="true" type="edit" xpath="display"/>
              <container colcount="2" colspan="2" xpath="transitions">
                <static colspan="2" label="Results" type="separator"/>
                <input xpath="result/@label"/>
                <input xpath="result/@code"/>
                <static colspan="2" label="Complement" type="separator"/>
                <input colspan="2" xpath="remainder/@enabled"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                  <input xpath="remainder/@code"/>
                </container>
                <static colspan="2" type="help">If this option is checked, all duplicates are saved in a second set.</static>
              </container>
            </container>
            <container colcount="2" img="nms:miniatures/mini-enrich.png" label="Merge" visibleIf="@number=1 AND @merge=1 AND @multipleMergeCriteria=0">
              <static colspan="2" label="Select merged data" type="separator"/>
              <static colspan="2" type="Help">Select the data you wish to keep during the merge process below. The 'Taken into account' expression linked to each column allows you to keep the record value only if the expression is true.</static>
              <container colspan="2" label="Data" name="data">
                <container hideUnboundPath="false" name="selectCtrl" showCollections="true" type="querySelectContainer" xpath=".">
                  <container name="vpaned" type="vpaned">
                    <container name="schema">
                      <static fontBold="true" label="Available fields:"/>
                      <container colcount="2">
                        <static img="xtk:filter.png" type="image"/>
                        <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                      </container>
                      <input checkDuplicates="false" hideMappedAsXml="true" name="schemaView" type="SchemaView" useUnboundPath="true" xpath="@schema" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="select/node/@expr" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                    </container>
                    <container name="output" xpathsToLoad="output*">
                      <static fontBold="true" label="Output columns:"/>
                      <input alwaysActive="true" expr="Iif([/tmp/outputColumn/itn/@current]=='' OR NodeValue([/tmp/outputColumn/itn/@current] + '/../@expr')=='', '', '/'+ UnExpandXPath(NodeValue([/tmp/outputColumn/itn/@current] + '/../@expr')))" type="expr" xpath="/tmp/outputColumn/in/@startPath"/>
                      <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" xpath="select/node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupBy="groupBy/node" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHaving="having/condition" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="@schema" xpathSelection="/tmp/outputColumn/itn/@current" zoom="false">
                        <input colSize="20" xpath="@label"/>
                        <input colSize="35" type="pathedit" useUnboundPath="true" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="../../@schema" xpathStartPath="/tmp/outputColumn/in/@startPath"/>
                        <input colSize="30" xpath="@alias"/>
                        <input colSize="45" label="Enabled if" type="pathedit" useUnboundPath="true" xpath="@enabledIf" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="../../@schema" xpathStartPath="/tmp/outputColumn/in/@startPath"/>
                        <form label="Column definition" name="colDetail">
                          <input xpath="@label"/>
                          <container name="extraFields"/>
                          <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="../../@schema"/>
                          <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                            <container colcount="2" cols-width="100,1">
                              <container>
                                <static fontBold="true" label="Available fields:"/>
                                <container colcount="2">
                                  <static img="xtk:filter.png" type="image"/>
                                  <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                                </container>
                                <input type="schemaview" xpath="@schema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                              </container>
                              <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                            </container>
                            <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                          </container>
                          <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                        </form>
                      </input>
                      <input xpath="@distinct"/>
                      <input xpath="@keepAllExtraData"/>
                    </container>
                  </container>
                  <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                </container>
              </container>
            </container>
            <container img="nms:miniatures/mini-enrich.png" label="Merge" visibleIf="@number=1 AND @merge=1 AND @multipleMergeCriteria=1">
              <static type="Help">Select the data you wish to keep during the merge process below. The 'Taken into account' expression linked to each column allows you to keep the record value only if the expression is true.</static>
              <input addChildButton="false" editable="false" name="columnList" nolabel="true" ordered="false" prebuildSubForm="false" toolbarAlign="horizontal" toolbarCaption="Select merged data" type="columnList" useTreeView="true" xpath="select/node" xpathSchema="@schema" zoom="true" zoomOnAdd="true">
                <input colSize="20" editable="true" xpath="@label"/>
                <input colSize="35" type="pathedit" useUnboundPath="true" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/mergeCollection/@schema" xpathStartPath="/tmp/outputColumn/in/@startPath"/>
                <input colSize="30" xpath="@alias"/>
                <input colSize="45" expr="Iif(NodeName([..])=='node', @enabledIf, NodeValue('../../conditionLink[@alias=\'' + @alias + '\']/where/@displayFilter'))" label="Enabled if" type="pathedit" useUnboundPath="true" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/mergeCollection/@schema" xpathStartPath="/tmp/outputColumn/in/@startPath"/>
                <form label="Select data to be merged" type="wizard">
                  <enter>
                    <reset xpath="/tmp/mergeCollection"/>
                    <set expr="Iif(NodeName([..])='node', 1, 0)" xpath="/tmp/mergeCollection/@onlyLast"/>
                    <set expr="Iif(NodeName([..])='node', '../', '')" xpath="/tmp/mergeCollection/@startNodePath"/>
                    <set expr="NodeValue([/tmp/mergeCollection/@startNodePath]+'../../@schema')" xpath="/tmp/mergeCollection/@schema"/>
                    <if expr="@expr=='' and [/tmp/mergeCollection/@onlyLast]=0">
                      <set value="duplicates" xpath="@expr"/>
                    </if>
                    <set expr="NodeValue([/tmp/mergeCollection/@startNodePath]+'@expr')" xpath="/tmp/mergeCollection/node/@expr"/>
                    <if expr="NodeValue([/tmp/mergeCollection/@startNodePath]+'@alias')!=''">
                      <set expr="NodeValue([/tmp/mergeCollection/@startNodePath]+'@alias')" xpath="/tmp/mergeCollection/@oldAlias"/>
                      <set expr="NodeValue([/tmp/mergeCollection/@startNodePath]+'@label')" xpath="/tmp/mergeCollection/node/@label"/>
                      <set expr="NodeValue([/tmp/mergeCollection/@startNodePath]+'@alias')" xpath="/tmp/mergeCollection/node/@alias"/>
                      <set expr="NodeValue([/tmp/mergeCollection/@startNodePath]+'@expr')" xpath="/tmp/mergeCollection/node/@expr"/>
                      <set expr="GetLinkSchema([/tmp/mergeCollection/@schema], [/tmp/mergeCollection/node/@expr])" xpath="/tmp/mergeCollection/@collectionSchema"/>
                      <copyElement exprSrc="[/tmp/mergeCollection/@startNodePath]+'node'" list="true" xpathDst="/tmp/mergeCollection/node"/>
                      <copyElement exprSrc="[/tmp/mergeCollection/@startNodePath]+'../../conditionLink[@alias=\'' + [/tmp/mergeCollection/@oldAlias] + '\']'" xpathDst="/tmp/mergeCollection/conditionLink"/>
                    </if>
                    <set expr="Iif([/tmp/mergeCollection/node/@expr]='duplicates', false, true)" xpath="/tmp/mergeCollection/@useOtherCollection"/>
                  </enter>
                  <container desc="Indicate the identifier of the group of fields to be merged" title="Identifier and label" xpath="/tmp/mergeCollection/node">
                    <input label="Identifier" required="true" type="computeNameEdit" xpath="@alias"/>
                    <input label="Label" xpath="@label"/>
                    <input label="Specify a collection (expert mode)" type="checkBox" xpath="/tmp/mergeCollection/@useOtherCollection"/>
                    <container type="visibleGroup" visibleIf="[/tmp/mergeCollection/@useOtherCollection]">
                      <input dblClickAction="wizNext" expandXPath="true" type="schemaView" useUnboundPath="true" xpath="/tmp/mergeCollection/@schema" xpathExpr="@expr" xpathFilter="462" xpathHelp="/tmp/@help" xpathSearchPath="/tmp/@search"/>
                      <input type="help" xpath="/tmp/@help"/>
                    </container>
                    <leave>
                      <check expr="@alias!=''">
                        <error>Please specify an identifier for the storage of additional data.</error>
                      </check>
                      <if expr="[/tmp/mergeCollection/@useOtherCollection]=false">
                        <set value="duplicates" xpath="/tmp/mergeCollection/node/@expr"/>
                      </if>
                      <set expr="GetLinkSchema([/tmp/mergeCollection/@schema], [/tmp/mergeCollection/node/@expr])" xpath="/tmp/mergeCollection/@collectionSchema"/>
                    </leave>
                  </container>
                  <container desc="Indicate the conditions that enable you to select the records to be taken into account" title="Filter" xpath="/tmp/mergeCollection">
                    <input noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Enabling conditions" type="conditionList" xpath="conditionLink/where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="conditionLink/@humanCond" xpathSchema="@collectionSchema">
                      <input colSize="15" label=" " xpath="/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/@operator"/>
                      <input colSize="30" label="Value" xpath="/@rightExpr"/>
                    </input>
                  </container>
                  <container desc="Indicate the sequence to be applied to records taken into account" title="Sort" xpath="/tmp/mergeCollection">
                    <input editable="false" noZoomOnAdd="true" nolabel="true" ordered="true" type="columnList" xpath="conditionLink/orderBy/node" xpathSchema="/tmp/mergeCollection/@collectionSchema" zoom="false">
                      <input colSize="20" label="Label" xpath="@label"/>
                      <input choiceType="sortAggregate" colSize="35" editable="true" label="Expression" type="pathedit" xpath="@expr" xpathLabel="@label" xpathSchema="/tmp/mergeCollection/@collectionSchema"/>
                      <input colSize="15" editable="true" label="Descending" type="checkbox" xpath="@sortDesc"/>
                    </input>
                  </container>
                  <container desc="Select the fields you want to keep" title="Fields to be kept" xpath="/tmp/mergeCollection/node">
                    <container hideUnboundPath="false" name="selectCtrl" showCollections="true" type="querySelectContainer" xpath=".">
                      <container name="vpaned" type="vpaned">
                        <container name="schema">
                          <static fontBold="true" label="Available fields:"/>
                          <container colcount="2">
                            <static img="xtk:filter.png" type="image"/>
                            <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                          </container>
                          <input checkDuplicates="false" hideMappedAsXml="true" name="schemaView" type="SchemaView" useUnboundPath="true" xpath="/tmp/mergeCollection/@collectionSchema" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="node/@expr" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                        </container>
                        <container name="output" xpathsToLoad="output*">
                          <static fontBold="true" label="Output columns:"/>
                          <input alwaysActive="true" expr="Iif([/tmp/outputColumn/itn/@current]=='' OR NodeValue([/tmp/outputColumn/itn/@current] + '/../@expr')=='', '', '/'+ UnExpandXPath(NodeValue([/tmp/outputColumn/itn/@current] + '/../@expr')))" type="expr" xpath="/tmp/outputColumn/in/@startPath"/>
                          <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" xpath="node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupBy="groupBy/node" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHaving="having/condition" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="/tmp/mergeCollection/@collectionSchema" xpathSelection="/tmp/outputColumn/itn/@current" zoom="false">
                            <input colSize="20" label="Label" xpath="@label"/>
                            <input colSize="35" label="Expression" type="pathedit" useUnboundPath="true" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathLabel="@label" xpathSchema="/tmp/mergeCollection/@collectionSchema"/>
                            <input colSize="30" label="Alias" xpath="@alias"/>
                            <input colSize="45" label="Enabled if" type="pathedit" useUnboundPath="true" xpath="@enabledIf" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/mergeCollection/@collectionSchema"/>
                            <form label="Column definition" name="colDetail">
                              <input xpath="@label"/>
                              <container name="extraFields"/>
                              <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="/tmp/mergeCollection/@collectionSchema"/>
                              <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                                <container colcount="2" cols-width="100,1">
                                  <container>
                                    <static fontBold="true" label="Available fields:"/>
                                    <container colcount="2">
                                      <static img="xtk:filter.png" type="image"/>
                                      <input catchReturnKey="true" label="Find" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                                    </container>
                                    <input type="schemaview" xpath="/tmp/mergeCollection/@collectionSchema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                                  </container>
                                  <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                                </container>
                                <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                              </container>
                              <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                            </form>
                          </input>
                        </container>
                      </container>
                      <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                    </container>
                  </container>
                  <leave>
                    <if expr="[/tmp/mergeCollection/@oldAlias]!=''">
                      <reset expr="[/tmp/mergeCollection/@startNodePath]+'../../conditionLink[@alias=\'' + [/tmp/mergeCollection/@oldAlias] + '\']'"/>
                      <reset expr="[/tmp/mergeCollection/@startNodePath]+'node[@alias=\'' + [/tmp/mergeCollection/@oldAlias] + '\']'"/>
                    </if>
                    <set expr="[/tmp/mergeCollection/node/@alias]" xpath="/tmp/mergeCollection/conditionLink/@alias"/>
                    <set expr="[/tmp/mergeCollection/node/@expr]" xpath="/tmp/mergeCollection/conditionLink/@xpath"/>
                    <set value="1" xpath="/tmp/mergeCollection/conditionLink/@lineCount"/>
                    <set value="1" xpath="/tmp/mergeCollection/conditionLink/@merge"/>
                    <set value="0" xpath="/tmp/mergeCollection/conditionLink/@singleRow"/>
                    <set value="0" xpath="/tmp/mergeCollection/conditionLink/@groupBy"/>
                    <copyElement exprDst="[/tmp/mergeCollection/@startNodePath]+'../../conditionLink[@alias=\'' + [/tmp/mergeCollection/node/@alias] + '\']'" xpathSrc="/tmp/mergeCollection/conditionLink"/>
                    <copyElement exprDst="[/tmp/mergeCollection/@startNodePath]+'.'" xpathSrc="/tmp/mergeCollection/node"/>
                  </leave>
                </form>
              </input>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <if expr="@number>1">
                <set value="false" xpath="@merge"/>
              </if>
              <if expr="@number&lt;=1">
                <set value="false" xpath="@keepRank"/>
              </if>
              <if expr="!@merge">
                <reset xpath="select"/>
              </if>
            </leave>
          </form>
          <form name="saveGroup" type="notebook">
            <enter>
              <set expr="Iif([savedGroup/@computeName]==false, 0, Iif([savedGroup/@computeFolder]==false, 1, 2))" xpath="/tmp/@computeMode"/>
              <if expr="HasPackage('nms:federatedDataAccess')">
                <set expr="Iif([savedGroup/@dataSourceTarget]=='', 0, [savedGroup/@dataSourceTarget])" xpath="savedGroup/@dataSourceTarget"/>
              </if>
            </enter>
            <container img="nms:miniatures/mini-group.png">
              <input xpath="@label"/>
              <static label="Select list" type="separator"/>
              <input checkedValue="0" label="Specified explicitly" type="RadioButton" xpath="/tmp/@computeMode"/>
              <input checkedValue="1" label="Create the list if necessary (Computed name)" type="RadioButton" xpath="/tmp/@computeMode"/>
              <input checkedValue="2" label="Create the list if necessary (Computed Folder and Name)" type="RadioButton" xpath="/tmp/@computeMode"/>
              <input expr="[/tmp/@computeMode]>0" type="expr" xpath="savedGroup/@computeName"/>
              <input expr="[/tmp/@computeMode]=2" type="expr" xpath="savedGroup/@computeFolder"/>
              <container type="visibleGroup" visibleIf="[savedGroup/@computeName]">
                <container type="visibleGroup" visibleIf="![savedGroup/@computeFolder]">
                  <input img="nms:fldrcpgrp.png" label="In the folder" xpath="savedGroup/folder">
                    <sysFilter>
                      <condition boolOperator="OR" expr="@model = 'nmsGroup'"/>
                      <condition enabledIf="HasPackage('crm:lead')" expr="@model = 'crmListImport'"/>
                    </sysFilter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="[savedGroup/@computeFolder]">
                  <input label="Folder (computed)" menuId="workflowMenuBuilder" type="scriptEdit" xpath="savedGroup/folderScript"/>
                </container>
                <input label="Label (computed)" menuId="workflowMenuBuilder" type="scriptEdit" xpath="savedGroup/script"/>
              </container>
              <container type="visibleGroup" visibleIf="![savedGroup/@computeName]">
                <container type="visibleGroup" visibleIf="[savedGroup/@dedicatedTable]">
                  <input createMode="none" notifyPathList="@label|../../transitions/result/@label" xpath="savedGroup/group">
                    <sysFilter>
                      <condition expr="@type > 0"/>
                    </sysFilter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="![savedGroup/@dedicatedTable]">
                  <input notifyPathList="@label|../../transitions/result/@label" xpath="savedGroup/group">
                    <sysFilter>
                      <condition expr="@type = 0"/>
                    </sysFilter>
                  </input>
                </container>
              </container>
              <static label="Save type" type="separator"/>
              <input xpath="savedGroup/@dedicatedTable"/>
              <input xpath="savedGroup/@recycle"/>
              <container applicableIf="HasPackage('nms:federatedDataAccess')" type="visibleGroup" visibleIf="[savedGroup/@dedicatedTable]" xpath="savedGroup">
                <static label="Database used for storing the list table" type="separator"/>
                <input checkedValue="0" label="Adobe Campaign database" type="RadioButton" xpath="@dataSourceTarget"/>
                <input checkedValue="1" label="Database of the targeting dimension (recommended)" type="RadioButton" xpath="@dataSourceTarget"/>
                <input checkedValue="2" label="External database" type="RadioButton" xpath="@dataSourceTarget"/>
                <container type="visibleGroup" visibleIf="@dataSourceTarget==2">
                  <input img="nms:miniatures/mini-dbImport.png" xpath="dataSource">
                    <sysFilter>
                      <condition expr="@type = 7"/>
                    </sysFilter>
                  </input>
                </container>
              </container>
              <container xpath="transitions/result">
                <static label="Transition" type="separator"/>
                <input label="Generate an outbound transition" xpath="@enabled"/>
                <container type="visibleGroup" visibleIf="@enabled">
                  <input xpath="@label"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <if expr="HasPackage('nms:federatedDataAccess')">
                <set expr="Iif([savedGroup/@dataSourceTarget]==2, [savedGroup/@dataSource-id], 0)" xpath="savedGroup/@dataSource-id"/>
              </if>
            </leave>
          </form>
          <form name="readGroup" type="notebook">
            <enter>
              <set expr="Iif([readGroup/@computeName]==false, 0, Iif([readGroup/@computeFolder]==false, 1, 2))" xpath="/tmp/@computeMode"/>
            </enter>
            <container img="nms:miniatures/mini-prefill.png">
              <input xpath="@label"/>
              <static label="Select list to use" type="separator"/>
              <input checkedValue="0" label="Specified explicitly" type="RadioButton" xpath="/tmp/@computeMode"/>
              <input checkedValue="1" label="Name computed by a script" type="RadioButton" xpath="/tmp/@computeMode"/>
              <input checkedValue="2" label="Folder and name computed by a script" type="RadioButton" xpath="/tmp/@computeMode"/>
              <input expr="[/tmp/@computeMode]>0" type="expr" xpath="readGroup/@computeName"/>
              <input expr="[/tmp/@computeMode]=2" type="expr" xpath="readGroup/@computeFolder"/>
              <container type="visibleGroup" visibleIf="![readGroup/@computeName]">
                <input createMode="none" xpath="readGroup/group">
                  <enter name="onChange">
                    <if expr="[readGroup/@group-id]!=0">
                      <set value="nms:group" xpath="/ignored/queryDefGroup/@schema"/>
                      <set value="get" xpath="/ignored/queryDefGroup/@operation"/>
                      <set value="@type" xpath="/ignored/queryDefGroup/select/node[1]/@expr"/>
                      <set value="@schema" xpath="/ignored/queryDefGroup/select/node[2]/@expr"/>
                      <set value="extension" xpath="/ignored/queryDefGroup/select/node[3]/@expr"/>
                      <set value="true" xpath="/ignored/queryDefGroup/select/node[3]/@anyType"/>
                      <set expr="'@id='+[readGroup/@group-id]" xpath="/ignored/queryDefGroup/where/condition/@expr"/>
                      <soapCall name="ExecuteQuery" service="xtk:queryDef">
                        <param exprIn="[/ignored/queryDefGroup]" type="DOMDocument"/>
                        <param type="DOMDocument" xpathOut="/ignored/group"/>
                      </soapCall>
                      <copyElement xpathDst="extension" xpathSrc="/ignored/group/extension"/>
                      <set expr="iif([/ignored/group/@type]=2, '', [/ignored/group/@schema])" xpath="@schema"/>
                      <set expr="[readGroup/@group-cs]" xpath="@label"/>
                    </if>
                  </enter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[readGroup/@computeName]">
                <container type="visibleGroup" visibleIf="![readGroup/@computeFolder]">
                  <input img="nms:fldrcpgrp.png" label="In the folder" xpath="readGroup/folder">
                    <sysFilter>
                      <condition boolOperator="OR" expr="@model = 'nmsGroup'"/>
                      <condition enabledIf="HasPackage('crm:lead')" expr="@model = 'crmListImport'"/>
                    </sysFilter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="[readGroup/@computeFolder]">
                  <input label="Folder (computed)" menuId="workflowMenuBuilder" type="scriptEdit" xpath="readGroup/folderScript"/>
                </container>
                <input label="Label (computed)" menuId="workflowMenuBuilder" type="scriptEdit" xpath="readGroup/script"/>
                <static label="List template (used to define the structure)" type="separator"/>
                <input createMode="none" xpath="readGroup/group">
                  <enter name="onChange">
                    <if expr="[readGroup/@group-id]!=0">
                      <set value="nms:group" xpath="/ignored/queryDefGroup/@schema"/>
                      <set value="get" xpath="/ignored/queryDefGroup/@operation"/>
                      <set value="@type" xpath="/ignored/queryDefGroup/select/node[1]/@expr"/>
                      <set value="@schema" xpath="/ignored/queryDefGroup/select/node[2]/@expr"/>
                      <set value="extension" xpath="/ignored/queryDefGroup/select/node[3]/@expr"/>
                      <set value="true" xpath="/ignored/queryDefGroup/select/node[3]/@anyType"/>
                      <set expr="'@id='+[readGroup/@group-id]" xpath="/ignored/queryDefGroup/where/condition/@expr"/>
                      <soapCall name="ExecuteQuery" service="xtk:queryDef">
                        <param exprIn="[/ignored/queryDefGroup]" type="DOMDocument"/>
                        <param type="DOMDocument" xpathOut="/ignored/group"/>
                      </soapCall>
                      <copyElement xpathDst="extension" xpathSrc="/ignored/group/extension"/>
                      <set expr="iif([/ignored/group/@type]=2, '', [/ignored/group/@schema])" xpath="@schema"/>
                    </if>
                  </enter>
                  <sysFilter>
                    <condition expr="[folder/@model]!='crmListImport'"/>
                  </sysFilter>
                </input>
              </container>
              <container visibleIf="Iif([readGroup/@group-id]!=0, NodeValue('extension/element/@name'), '')!=''">
                <static label="Source filtering" type="separator"/>
                <input img="nms:miniatures/mini-query.png" label="Edit query..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Query">
                    <enter>
                      <set expr="LoadSchema('extension')" xpath="/tmp/selectCtrl/in/@schema"/>
                    </enter>
                    <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="humanCond" xpathSchema="/tmp/selectCtrl/in/@schema">
                      <input colSize="15" label=" " xpath="/@bool-operator"/>
                      <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                      <input colSize="15" label="Operator" xpath="/@operator"/>
                      <input colSize="30" label="Value" xpath="/@rightExpr"/>
                    </input>
                    <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="humanCond"/>
                    <leave>
                      <set expr="SubString(humanCond, 10)" xpath="@label"/>
                    </leave>
                  </form>
                </input>
                <input fontBold="true" label=" " lineCount="15" noBorder="true" readOnly="true" type="edit" xpath="humanCond"/>
              </container>
              <static label="Transition" type="separator"/>
              <input xpath="transitions/result/@label"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="readSurvey" type="notebook">
            <container label="General">
              <input xpath="@label"/>
              <input createMode="none" img="nms:webForm.png" xpath="survey">
                <sysFilter>
                  <condition expr="[facet/@survey] = true"/>
                </sysFilter>
                <enter name="onChange">
                  <set value="nms:webApp" xpath="/ignored/queryDef/@schema"/>
                  <set value="get" xpath="/ignored/queryDef/@operation"/>
                  <set value="@schema" xpath="/ignored/queryDef/select/node[1]/@expr"/>
                  <set value="archivedFieldsSchema" xpath="/ignored/queryDef/select/node[2]/@expr"/>
                  <set expr="'@id='+[@survey-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/tmp/queryDef"/>
                  </soapCall>
                  <copyElement xpathDst="extension/schema" xpathSrc="/tmp/queryDef/archivedFieldsSchema"/>
                  <set expr="[/tmp/queryDef/@schema]" xpath="@targetSchema"/>
                </enter>
              </input>
              <container type="visibleGroup" visibleIf="[@survey-id]!=0">
                <container label="Information collected" type="frame">
                  <input nolabel="false" xpath="@keepAllExtraData"/>
                  <input img="nms:list.png" label="Select the columns to extract..." prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="Select extra columns">
                      <enter>
                        <set expr="wkfTargetSchema(@name)" xpath="/tmp/@ignoredSchema"/>
                        <set expr="loadSchema('extension/schema')" xpath="/tmp/@ignoredWebAppSchema"/>
                        <set expr="'temp:'+NodeValue('extension/schema/element/@name')" xpath="/tmp/selectCtrl/in/@schema"/>
                      </enter>
                      <container style="flat" type="notebook">
                        <container ref="xtk:workflow:lib/tabs/colSelector/data"/>
                        <container ref="xtk:workflow:lib/tabs/colSelector/collection"/>
                      </container>
                    </form>
                  </input>
                  <input alwaysActive="true" expr="GroupConcat([select/descendant::node], &quot; ' [' + [@label] + '] ' &quot; )" type="expr" xpath="/tmp/selectCtrl/out/@humanSelect"/>
                  <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/tmp/selectCtrl/out/@humanSelect"/>
                </container>
                <container label="Source filtering" type="frame">
                  <input img="nms:miniatures/mini-query.png" label="Edit query..." prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="Query">
                      <enter>
                        <set expr="wkfTargetSchema(@name)" xpath="/tmp/@ignoredSchema"/>
                        <set expr="'temp:'+NodeValue('extension/schema/element/@name')" xpath="/tmp/selectCtrl/in/@schema"/>
                      </enter>
                      <input name="filterList" noSaveFilter="true" nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="humanCond" xpathSchema="/tmp/selectCtrl/in/@schema">
                        <input colSize="15" label=" " xpath="/@bool-operator"/>
                        <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                        <input colSize="15" label="Operator" xpath="/@operator"/>
                        <input colSize="30" label="Value" xpath="/@rightExpr"/>
                      </input>
                      <leave>
                        <set expr="SubString(humanCond, IndexOf(humanCond, ':')+2)" xpath="@label"/>
                      </leave>
                    </form>
                  </input>
                  <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="humanCond"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <soapCall name="readSurveySchema" service="xtk:workflow">
                <param exprIn="[.]" type="DOMElement"/>
                <param type="DOMElement" xpathOut="."/>
              </soapCall>
            </leave>
          </form>
          <form name="setOfService" type="notebook">
            <container img="nms:miniatures/mini-setService.png">
              <input xpath="@label"/>
              <input checkedValue="1" label="Registration" type="RadioButton" xpath="@subscribeType"/>
              <input checkedValue="0" label="Unsubscription" type="RadioButton" xpath="@subscribeType"/>
              <input xpath="@sendConfirmation"/>
              <container label="Select the service" type="frame">
                <container defaultColumns="@label" exprOut1="@label" filterEditField="@label" newEntityFormChoice="true" nodeModel="nmsSetOfServices" schema="nms:service" setOnClick="true" type="navTreeEntityList" xpath="@service-id" xpathOut1="transitions/result/@label"/>
              </container>
              <container xpath="transitions/result">
                <static label="Transition" type="separator"/>
                <input label="Generate an outbound transition" xpath="@enabled"/>
                <container type="visibleGroup" visibleIf="@enabled">
                  <input xpath="@label"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="writer" type="notebook">
            <enter>
              <if expr="@schema==''">
                <set value="nms:recipient" xpath="@schema"/>
              </if>
              <set expr="wkfTargetSchema(wkfSourceActivity(@name), wkfTransitionName(wkfSourceActivity(@name), @name), 1)" xpath="/ignored/@writerSchema"/>
              <set expr="Iif([/ignored/@writerSchema]!='' AND [primaryKeyNode/@calcExpr]!='' AND @schema==GetLinkSchema([/ignored/@writerSchema], UnExpandXPath([primaryKeyNode/@calcExpr])), wkfAlterWriterSchema(@name), '')" xpath="/ignored/@writerTarget"/>
              <set expr="Iif(NodeCount(primaryKeyNode)>0, Iif([primaryKeyNode/@dstExpr]!='', 2, 1), Iif(EV(@operationType, 'merge'), 1, 0))" xpath="/tmp/@targetDimension"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-writer.png">
              <input colspan="2" xpath="@label"/>
              <input xpath="@operationType"/>
              <input xpath="@transactionSize"/>
              <input expr="Iif(EV(@operationType, 'merge'), 1, NodeValue('/tmp/@targetDimension'))" type="expr" xpath="/tmp/@targetDimension"/>
              <static colspan="2" label="Record identification" type="separator"/>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@operationType, 'merge')=false">
                <input checkedValue="0" label="Directly using the targeting dimension" type="radioButton" xpath="/tmp/@targetDimension"/>
                <input checkedValue="1" label="Using one or more links" type="radioButton" xpath="/tmp/@targetDimension"/>
                <input checkedValue="2" label="Using reconciliation keys" type="radioButton" xpath="/tmp/@targetDimension"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@operationType, 'merge')">
                <static label=" " nolabel="false">Select the links for identifying the primary record</static>
                <input expr="Iif([/ignored/@writerSchema]!='' AND [primaryKeyNode/@calcExpr]!='' AND @schema==GetLinkSchema([/ignored/@writerSchema], UnExpandXPath([primaryKeyNode/@calcExpr])), wkfAlterWriterSchema(@name), '')" type="expr" xpath="/ignored/@writerTarget"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@targetDimension]=0">
                <input type="schemaEdit" xpath="@schema"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@targetDimension]=1">
                <input editable="true" label=" " lineCount="6" ordered="true" toolbarCaption="List of links that can be used to find the records (by order of priority)" type="list" xpath="primaryKeyNode">
                  <input choiceType="xpath" label="Identifier" nolabel="false" type="pathEdit" useTablePath="true" xpath="@calcExpr" xpathSchema="/ignored/@writerSchema"/>
                  <input type="pathedit" xpath="@enabledIf" xpathSchema="/ignored/@writerSchema"/>
                </input>
                <input expr="Iif(NodeCount(primaryKeyNode)==0, '', GetLinkSchema([/ignored/@writerSchema], [primaryKeyNode/@calcExpr]))" type="expr" xpath="@schema"/>
                <input readOnly="true" type="schemaEdit" xpath="@schema"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@targetDimension]=2">
                <input type="schemaEdit" xpath="@schema"/>
                <input editable="true" label=" " lineCount="6" ordered="true" toolbarCaption="Keys for finding records" type="list" xpath="primaryKeyNode">
                  <input choiceType="xpath" colSize="35" hideCalculated="true" hideMappedAsXml="true" type="pathedit" xpath="@dstExpr" xpathSchema="../@schema"/>
                  <input label="Identifier" type="pathEdit" xpath="@calcExpr" xpathSchema="/ignored/@writerSchema"/>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@operationType, 'insertOrUpdate')">
                <static label="Fields to update" type="separator"/>
                <input editable="true" label=" " ordered="true" toolbarAlign="vertical" type="list" xpath="node" xpathHelp="/ignored/@help" xpathSchema="@schema">
                  <container>
                    <input img="xtk:wand.png" label="Automatically associate fields with the same name" textAlign="toolTip" type="flatButton" xpath="/ignored/@dummyBoolean">
                      <enter>
                        <set expr="wkfBuildAutomatedWriter([../@name])" xpath="/ignored/@magicAssociation"/>
                      </enter>
                    </input>
                  </container>
                  <input choiceType="xpath" colSize="35" hideMappedAsXml="true" type="pathedit" xpath="@dstExpr" xpathSchema="../@schema"/>
                  <input type="dynedit" xpath="@calcExpr" xpathDynamicSchema="../@schema" xpathDynamicType="@dstExpr" xpathLabel="@valueLabel" xpathSchema="/ignored/@writerSchema"/>
                  <input type="pathedit" xpath="@enabledIf" xpathSchema="/ignored/@writerSchema"/>
                  <input xpath="@enabledOperation"/>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@operationType, 'insert', 'update')">
                <static label="Fields to update" type="separator"/>
                <input editable="true" label=" " ordered="true" toolbarAlign="vertical" type="list" xpath="node" xpathHelp="/ignored/@help" xpathSchema="@schema">
                  <container>
                    <input img="xtk:wand.png" label="Automatically associate fields with the same name" textAlign="toolTip" type="flatButton">
                      <enter>
                        <set expr="wkfBuildAutomatedWriter([../@name])" xpath="/ignored/@magicAssociation"/>
                      </enter>
                    </input>
                  </container>
                  <input choiceType="xpath" colSize="35" hideMappedAsXml="true" type="pathedit" xpath="@dstExpr" xpathSchema="../@schema"/>
                  <input type="dynedit" xpath="@calcExpr" xpathDynamicSchema="../@schema" xpathDynamicType="@dstExpr" xpathLabel="@valueLabel" xpathSchema="/ignored/@writerSchema"/>
                  <input type="pathedit" xpath="@enabledIf" xpathSchema="/ignored/@writerSchema"/>
                </input>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@operationType, 'merge')">
                <static label="Fields and collections of the target record to be updated" type="separator"/>
                <static type="help">the "Targeting dimension (target)" link represents the secondary record</static>
                <input editable="false" label=" " noZoomOnAdd="true" ordered="true" prebuildSubForm="false" toolbarAlign="vertical" type="list" xpath="node" xpathHelp="/ignored/@help" xpathSchema="@schema" zoom="true" zoomOnAdd="false">
                  <form label="Updating collection elements" type="wizard">
                    <enter>
                      <set expr="GetLinkSchema([/ignored/@writerSchema], UnExpandXPath(@calcExpr))" xpath="/ignored/@outputSchemaCollection"/>
                      <set expr="GetLinkSchema([../@schema], UnExpandXPath(@dstExpr))" xpath="/ignored/@inputSchemaCollection"/>
                    </enter>
                    <container label="Select the destination field or collection, then the expression used to calculate its value in the source data" title="Update">
                      <container type="visibleGroup" visibleIf="GetLinkCardinality([../@schema], @dstExpr)==0 OR @dstExpr=''">
                        <input enum="xtk:workflow:mergeType" label="Merge type" type="sysenum" xpath="@operationType"/>
                      </container>
                      <input choiceType="xpath" hideMappedAsXml="true" nolabel="false" type="pathedit" useUnboundPath="true" xpath="@dstExpr" xpathSchema="../@schema"/>
                      <input choiceType="condition" hideCalculated="true" hideMappedAsXml="true" nolabel="false" type="pathedit" useUnboundPath="true" xpath="@calcExpr" xpathLabel="@valueLabel" xpathSchema="/ignored/@writerSchema"/>
                      <static label="Calculation parameters" type="separator"/>
                      <input xpath="@onlyIfNotExists"/>
                      <input label="Condition" nolabel="false" schemaExpr="Iif(GetLinkCardinality([../@schema], @dstExpr)==0, GetLinkSchema([/ignored/@writerSchema], UnExpandXPath(@calcExpr)),[/ignored/@writerSchema])" type="pathedit" xpath="@enabledIf"/>
                      <container type="visibleGroup" visibleIf="@operationType='replace'">
                        <static type="help">Select the condition used to identify the records to be deleted from the target</static>
                        <input label=" " nolabel="false" schemaExpr="Iif(GetLinkCardinality([../@schema], @dstExpr)==0, GetLinkSchema([/ignored/@writerSchema], UnExpandXPath(@calcExpr)),[/ignored/@writerSchema])" type="pathedit" xpath="@replacedIf"/>
                      </container>
                    </container>
                    <container title="Identification settings of updated collection elements" visibleIf="[/ignored/@inputSchemaCollection]!=[/ignored/@outputSchemaCollection] AND @dstExpr!=''">
                      <static type="help">Select the join conditions for reconciling the records in the destination collection based on those in the source</static>
                      <input editable="true" label=" " ordered="true" toolbarCaption="Identification keys" type="list" xpath="primaryKeyNode">
                        <input choiceType="xpath" colSize="35" hideMappedAsXml="true" type="pathedit" xpath="@dstExpr" xpathSchema="/ignored/@inputSchemaCollection"/>
                        <input label="Identifier" type="pathEdit" xpath="@calcExpr" xpathSchema="/ignored/@outputSchemaCollection"/>
                      </input>
                    </container>
                    <container title="Updated fields in the target collection" visibleIf="[/ignored/@inputSchemaCollection]!=[/ignored/@outputSchemaCollection] AND @dstExpr!=''">
                      <static type="help">Select the fields to be updated in the target collection.</static>
                      <input editable="true" nolabel="true" ordered="true" toolbarAlign="vertical" type="list" xpath="node" xpathHelp="/ignored/@help" xpathSchema="@schema">
                        <input choiceType="xpath" colSize="35" hideMappedAsXml="true" type="pathedit" xpath="@dstExpr" xpathSchema="/ignored/@inputSchemaCollection"/>
                        <input choiceType="condition" hideCalculated="true" hideMappedAsXml="true" type="dynedit" xpath="@calcExpr" xpathDynamicSchema="/ignored/@inputSchemaCollection" xpathDynamicType="@dstExpr" xpathLabel="@valueLabel" xpathSchema="/ignored/@outputSchemaCollection"/>
                        <input schemaExpr="Iif(GetLinkCardinality([/ignored/@inputSchemaCollection], @dstExpr)==0, GetLinkSchema([/ignored/@inputSchemaCollection], @dstExpr),[/ignored/@outputSchemaCollection])" type="pathedit" xpath="@enabledIf"/>
                      </input>
                    </container>
                  </form>
                  <container>
                    <input img="xtk:wand.png" label="Automatically associate fields with the same name" textAlign="toolTip" type="flatButton">
                      <enter>
                        <set expr="wkfBuildAutomatedWriter([../@name])" xpath="/ignored/@magicAssociation"/>
                      </enter>
                    </input>
                  </container>
                  <input choiceType="xpath" colSize="35" editable="true" hideMappedAsXml="true" label="Destination (main)" type="pathedit" useUnboundPath="true" xpath="@dstExpr" xpathSchema="../@schema"/>
                  <input choiceType="condition" editable="true" hideCalculated="true" hideMappedAsXml="true" label="Source expression (secondary)" type="dynedit" useUnboundPath="true" xpath="@calcExpr" xpathDynamicSchema="../@schema" xpathDynamicType="@dstExpr" xpathLabel="@valueLabel" xpathSchema="/ignored/@writerSchema"/>
                  <input editable="true" schemaExpr="Iif(GetLinkCardinality([../@schema], @dstExpr)==0, GetLinkSchema([/ignored/@writerSchema], UnExpandXPath(@calcExpr)),[/ignored/@writerSchema])" type="pathedit" xpath="@enabledIf"/>
                  <input editable="false" xpath="@operationType"/>
                </input>
              </container>
              <container colspan="2">
                <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink" xpath=".">
                  <form label="Advanced parameters" name="advancedWriter" xpathsToLoadOpt="@operationType">
                    <container type="visibleGroup" visibleIf="EV(@operationType, 'delete')=false">
                      <container type="notebook">
                        <container label="General">
                          <container>
                            <input xpath="@noAutoPK"/>
                            <input xpath="@noAudit"/>
                            <input xpath="@noPreservation"/>
                            <input xpath="@updateAllColumns"/>
                          </container>
                          <container type="visibleGroup" visibleIf="@updateAllColumns">
                            <input xpath="@noUpdateLinks"/>
                          </container>
                          <static label="Enabled if" type="separator"/>
                          <input type="pathedit" xpath="@enabledIf" xpathSchema="/ignored/@writerSchema"/>
                          <static label="You can specify handling conditions for elements of the source. \nAn empty handling condition will not filter the source." type="help"/>
                        </container>
                        <container label="Doubles">
                          <static label="You can specify the conditions based on which duplicates will be taken into account. \nIf you ignore records which concern the same target, only the first one in the order specified below will be taken into account." type="help"/>
                          <input xpath="@ignoreDuplicates"/>
                          <input nolabel="true" toolbarCaption="Order in which duplicates are taken into account" type="list" xpath="orderedExpr">
                            <input type="pathEdit" xpath="@expr" xpathSchema="/ignored/@writerSchema"/>
                            <input type="checkBox" xpath="@desc"/>
                          </input>
                        </container>
                      </container>
                    </container>
                    <container type="visibleGroup" visibleIf="EV(@operationType, 'delete')=true">
                      <static label="Enabled if" type="separator"/>
                      <input type="pathedit" xpath="@enabledIf" xpathSchema="/ignored/@writerSchema"/>
                      <static label="You can specify handling conditions for elements of the source. \nAn empty handling condition will not filter the source." type="help"/>
                    </container>
                  </form>
                </input>
              </container>
              <static colspan="2" label="Transitions" type="separator"/>
              <container colspan="2" xpath="transitions">
                <input label="Generate an outbound transition" xpath="done/@enabled"/>
                <container type="visibleGroup" visibleIf="[done/@enabled]">
                  <input xpath="done/@label"/>
                </container>
                <input label="Generate an outbound transition for the rejects" xpath="remainder/@enabled"/>
                <container type="visibleGroup" visibleIf="[remainder/@enabled]">
                  <input xpath="remainder/@label"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <if expr="[/tmp/@targetDimension]==0">
                <reset xpath="primaryKeyNode[*]"/>
              </if>
            </leave>
          </form>
          <form maxLabelWidth="60" name="content" type="notebook">
            <container addSchemaMenu="nms:recipient" menuId="targetIdForProperties" type="customMenuBuilder"/>
            <container img="nms:miniatures/mini-content.png">
              <input xpath="@label"/>
              <static label="Content" type="separator"/>
              <input checkedValue="0" label="Specified in the transition" type="RadioButton" xpath="@contentSel"/>
              <input checkedValue="1" label="Explicit" type="RadioButton" xpath="@contentSel"/>
              <input checkedValue="2" label="Calculated by a script" type="RadioButton" xpath="@contentSel"/>
              <input checkedValue="3" label="New, created from a publication template" type="RadioButton" xpath="@contentSel"/>
              <container type="visibleGroup" visibleIf="@contentSel=1">
                <input img="ncm:content.png" xpath="content"/>
              </container>
              <container type="visibleGroup" visibleIf="@contentSel=2">
                <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="contentIdScript"/>
              </container>
              <container type="visibleGroup" visibleIf="@contentSel=3">
                <input img="ncm:publishing.png" xpath="publishing"/>
                <input img="ncm:channel.png" xpath="channel">
                  <sysFilter>
                    <condition expr="@entity = 'ncm:channel'"/>
                  </sysFilter>
                </input>
              </container>
              <static label="Update content" type="separator"/>
              <input menuId="targetIdForProperties" type="scriptEdit" xpath="@subject"/>
              <static label="Enables you to override the subject of the delivery action associated with the content." type="help"/>
              <input label="Access to data from an XML feed" xpath="@activeTransform"/>
              <container type="visibleGroup" visibleIf="@activeTransform">
                <input menuId="workflowMenuBuilder" type="scriptEdit" xpath="@url"/>
                <static/>
                <input form="ncm:xslt" img="xtk:xslt.png" xpath="xslt">
                  <sysFilter>
                    <condition expr="@namespace NOT IN ('xtk', 'nl', 'nms', 'ncm', 'nis')"/>
                  </sysFilter>
                </input>
                <static label="A style sheet can be used to transform the data from the XML feed." type="help"/>
              </container>
              <static label="Action to perform" type="separator"/>
              <container>
                <input checkedValue="0" label="Save" type="RadioButton" xpath="@actionType"/>
                <input checkedValue="1" label="Generate" type="RadioButton" xpath="@actionType"/>
                <container type="visibleGroup" visibleIf="@actionType=1">
                  <input xpath="@publishingDir"/>
                  <static label="If the folder is not specified, the publication will be made to the default folder." type="help"/>
                </container>
              </container>
              <container xpath="transitions/done">
                <static label="Transition" type="separator"/>
                <input label="Generate an outbound transition" xpath="@enabled"/>
                <container type="visibleGroup" visibleIf="@enabled">
                  <input xpath="@label"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="localValidation" type="notebook">
            <enter>
              <set value="0" xpath="/ignored/@addReminder"/>
            </enter>
            <container colcount="2" img="nms:miniatures/mini-localValidation.png">
              <input colspan="2" xpath="@label"/>
              <static colspan="2" label="Action to perform" type="separator"/>
              <input checkedValue="0" colspan="2" label="Target approval notification" type="radioButton" xpath="@distributionAction"/>
              <input checkedValue="1" colspan="2" label="Delivery feedback report" type="radioButton" xpath="@distributionAction"/>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@distributionAction, 'report')">
                <static label="Delivery" type="separator"/>
                <input checkedValue="0" label="Specified in the transition" type="radioButton" xpath="@deliverySel"/>
                <input checkedValue="1" label="Explicit" type="radioButton" xpath="@deliverySel"/>
                <container type="visibleGroup" visibleIf="@deliverySel=1">
                  <input createMode="none" folderFilterChoice="@model like 'nmsDelivery%'" img="nms:email.png" noAutoComplete="true" xpath="delivery">
                    <sysFilter>
                      <condition expr="@isModel = 0"/>
                    </sysFilter>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@distributionAction, 'notif')">
                <static label="Distribution context" type="separator"/>
                <input checkedValue="0" label="Specified in the transition" type="radioButton" xpath="@distributionSel"/>
                <input checkedValue="1" label="Explicit" type="radioButton" xpath="@distributionSel"/>
                <container type="visibleGroup" visibleIf="EV(@distributionSel, 'explicit')">
                  <input createMode="none" img="nms:localDistribution.png" xpath="localDistribution"/>
                </container>
              </container>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@distributionAction, 'notif')">
                <static colspan="2" label="Approval management" type="separator"/>
                <input colspan="2" xpath="@earlyValidation"/>
                <input xpath="validation/@type"/>
                <container type="visibleGroup" visibleIf="EV([validation/@type], 'delay')">
                  <input xpath="validation/@delay"/>
                </container>
                <container type="visibleGroup" visibleIf="EV([validation/@type], 'date')">
                  <input xpath="validation/@date"/>
                </container>
              </container>
              <input colspan="2" createMode="none" folderFilterChoice="@model = 'nmsDeliveryModel'" img="nms:deliveryModel.png" xpath="deliveryModel">
                <sysFilter>
                  <condition expr="@isModel = 1"/>
                </sysFilter>
              </input>
              <container colspan="2" type="visibleGroup" visibleIf="[@deliveryModel-id]!=0">
                <input colspan="2" menuId="workflowMenuBuilder" type="scriptEdit" xpath="@subject"/>
                <container colspan="2" type="visibleGroup" visibleIf="EV(@distributionAction, 'notif')">
                  <input nolabel="false" xpath="description"/>
                </container>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@distributionAction, 'notif')">
                <container colspan="2" ref="nms:operation:lib/reminder"/>
                <static label="Complement" type="separator"/>
                <input xpath="transitions/remainder/@enabled"/>
                <container type="visibleGroup" visibleIf="[transitions/remainder/@enabled]">
                  <input xpath="transitions/remainder/@label"/>
                </container>
                <static type="help">If this option is checked, non approved targets are saved in a second set.</static>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
            <leave>
              <check expr="EV(@distributionSel, 'event') or [@localDistribution-id] != 0">
                <error>You must correctly specify the data.</error>
              </check>
              <if expr="@earlyValidation=1">
                <soapCall name="WakeupTask" service="xtk:workflow">
                  <param exprIn="'operationMgt'" type="string"/>
                  <param exprIn="''" type="string"/>
                  <param exprIn="'scheduler'" type="string"/>
                </soapCall>
              </if>
            </leave>
          </form>
          <form name="offer" type="notebook">
            <container colcount="2" img="nms:miniatures/mini-offer.png">
              <input colspan="2" xpath="@label"/>
              <static colspan="2" label="Lets you favor an offer for a defined population for a given period." type="help"/>
              <container colcount="2" colspan="2" label="Offer conditions" type="frame">
                <input colspan="2" createMode="none" img="nms:offer.png" required="true" xpath="offer"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[@offer-id]!=0">
                  <input xpath="@startDate"/>
                  <input xpath="@endDate"/>
                  <input choiceType="xpath" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@weightExpr" xpathSchema="../filter/@schema"/>
                  <static/>
                </container>
              </container>
              <input colspan="2" label="Generate an outbound transition" xpath="transitions/done/@enabled"/>
              <input colspan="2" label="Process errors" xpath="transitions/error[@name='error']/@enabled"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="offerSelection" type="notebook">
            <container img="nms:miniatures/mini-offer.png" maxLabelWidth="200">
              <input xpath="@label"/>
              <static type="help">Calls the engine to calculate the best offers that can be proposed to an inbound population. Generates an output table containing the population enriched with the best offers in columns. Does not generate history for the propositions.</static>
              <container colspan="2">
                <static label="Offers to consider" type="separator"/>
                <input createMode="none" img="nms:offerSpace.png" notifyPathList="@defaultCategory-id|/tmp/@defaultCategoryId,defaultCategory/@label|/tmp/@defaultCategoryCs,@defaultThemes|/tmp/@defaultThemes" required="true" xpath="offerSpace">
                  <enter name="onChange">
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory/@id"/>
                    <set expr="[/tmp/@defaultCategoryCs]" xpath="/tmp/defaultCategory/@_cs"/>
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory"/>
                    <set expr="[/tmp/@defaultThemes]" xpath="@offerThemes"/>
                  </enter>
                  <sysFilter>
                    <condition expr="[env/@live]=true"/>
                  </sysFilter>
                </input>
                <container type="visibleGroup" visibleIf="[@offerSpace-id]!=0">
                  <input img="nms:offerCategory.png" xpath="offerCategory" xpathRefresh="/tmp/defaultCategory">
                    <sysFilter>
                      <condition expr="@model = 'nmsOfferCategory' or @model = 'nmsOfferEnv'"/>
                    </sysFilter>
                  </input>
                  <input xpath="@offerThemes"/>
                  <input xpath="@maxPropositionCount"/>
                  <input xpath="@contactDate"/>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="task" type="notebook">
            <container editFormTarget="nms:task" name="editTargetProperties" newFormTarget="nms:task" notifyPathList="@type|/tmp/@taskType" propagateXPathToCtx="/tmp/@newFromWorkflow,../../@id|/tmp/@workflowId" propagateXPathToCtxOnAdd="/tmp/@newTask,/tmp/@operationId,../../@id|/tmp/@workflowId,/tmp/@newFromWorkflow,../../@isModel|/operation/@isModel" targetMenuLabel="Edit the task..." type="visibleGroup" visibleIf="false">
              <enter>
                <set value="1" xpath="/tmp/@newTask"/>
                <set expr="[/tmp/@parentId]" xpath="/tmp/@operationId"/>
                <set value="1" xpath="/tmp/@newFromWorkflow"/>
              </enter>
              <leave>
                <if expr="([transitions/refused/@enabled] and [/tmp/@taskType]=3) or ([transitions/refused/@enabled]=false and [/tmp/@taskType]!=3)">
                  <set expr="iif ([/tmp/@taskType]=3, false, true)" xpath="transitions/refused/@enabled"/>
                  <set expr="iif ([/tmp/@taskType]=3, 'nms:activities/alert.png', 'nms:activities/task.png')" xpath="@img"/>
                </if>
              </leave>
            </container>
            <container img="nms:miniatures/mini-tak.png">
              <input xpath="@label"/>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
          <form name="mscrmWorkflow" ref="crm:workflow:mscrmWorkflow"/>
          <form name="oodWorkflow" ref="crm:workflow:oodWorkflow"/>
          <form name="sfdcWorkflow" ref="crm:workflow:sfdcWorkflow"/>
          <form name="crmConnectorDataMgt" ref="crm:workflow:crmConnectorDataMgt"/>
          <form name="crmWebex" ref="crm:workflow:crmWebex"/>
          <form name="buildAggregate" type="notebook">
            <enter>
              <set value="0" xpath="/ignored/@updateType"/>
              <if expr="NodeCount([where/condition])!=0">
                <set value="1" xpath="/ignored/@updateType"/>
              </if>
            </enter>
            <container img="xtk:miniatures/mini-buildAggregate.png">
              <input xpath="@label"/>
              <input choiceButton="true" createMode="none" img="xtk:olapCube.png" xpath="cube"/>
              <container type="visibleGroup" visibleIf="[@cube-id] > 0">
                <input choiceButton="true" createMode="none" img="xtk:olapAggregate.png" xpath="aggregate">
                  <sysFilter>
                    <condition expr="[@cube-id]=$(@cube-id)"/>
                  </sysFilter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[@cube-id] > 0 AND [@aggregate-id] > 0">
                <static label="Aggregate update" type="separator"/>
                <input checkedValue="0" label="Full update" type="RadioButton" xpath="/ignored/@updateType"/>
                <input checkedValue="1" label="Partial update" type="RadioButton" xpath="/ignored/@updateType"/>
                <container type="visibleGroup" visibleIf="[/ignored/@updateType]=1">
                  <input label="Edit the update condition..." nolabel="false" type="subformlink" xpath=".">
                    <form label="Editing the update condition">
                      <enter>
                        <soapCall name="GetAggregateSchema" service="xtk:olapCube">
                          <param exprIn="." type="DOMElement"/>
                          <param type="DOMElement" xpathOut="/tmp/tempSchemas"/>
                        </soapCall>
                        <copyElement xpathDst="tempSchemas/schema" xpathSrc="/tmp/tempSchemas"/>
                        <set expr="LoadSchema('tempSchemas/schema')" xpath="@schema"/>
                      </enter>
                      <container type="visibleGroup" visibleIf="@schema != ''">
                        <container img="xtk:filter.png" label="Filter" type="queryWhereContainer">
                          <input nolabel="true" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathHelp="/@helpCond">
                            <input colSize="15" label=" " xpath="/@bool-operator"/>
                            <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                            <input colSize="15" label="Operator" xpath="/@operator"/>
                            <input colSize="30" label="Value" xpath="/@rightExpr"/>
                            <input colSize="30" label="Taken into account if" xpath="/@enabledIf"/>
                          </input>
                          <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/@helpCond"/>
                        </container>
                      </container>
                      <leave>
                        <set value="" xpath="@schema"/>
                      </leave>
                    </form>
                  </input>
                </container>
              </container>
            </container>
            <container ref="xtk:workflow:lib/tabs/advancedActivityPage"/>
          </form>
        </container>
      </container>
      <container colcount="2" img="xtk:workflow.png" label="Diagram" name="diagram">
        <container menuId="workflowMenuBuilder" type="workflowMenuBuilder"/>
        <container menuId="wfDeliveryMenuBuilder" type="wfDeliveryMenuBuilder"/>
        <container menuId="wfSubWorkflowMenuBuilder" type="wfSubWorkflowMenuBuilder"/>
        <container menuId="wfImportMenuBuilder" type="wfImportMenuBuilder"/>
        <container menuId="wfExportMenuBuilder" type="wfExportMenuBuilder"/>
        <container menuId="wfInSmsMenuBuilder" type="wfInSmsMenuBuilder"/>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@isModel">
          <input xpath="@label"/>
          <input xpath="@internalName"/>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="!@isModel">
          <input xpath="@label"/>
          <container type="visibleGroup" visibleIf="[/ignored/operationCtx]=false">
            <input readOnly="true" xpath="@state"/>
          </container>
          <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[/ignored/operationCtx]=true">
            <input readOnly="true" xpath="process/@processState"/>
          </container>
        </container>
        <container colspan="2" name="diagram">
          <input hideEditButtonsExpr="HasNamedRight('workflow')=false or @isModel or [/ignored/@hideEditButtons]='true' or [/ignored/@hideEditButtons]='1'" type="workflowedit" xpath="." xpathHidePalette="/ignored/@hidePalette" xpathSelectedActivity="/ignored/@selectedActivity" xpathStartButtonCmd="/ignored/@startButtonCmd" xpathStartButtonEnable="/ignored/@startButtonEnable" xpathStartButtonImg="/ignored/@startButtonImg">
            <enter name="duplicate">
              <set expr="NormalizeXPath(NodePath([.]))" xpath="/tmp/elemDup/@path"/>
              <set expr="'$(entityPath)'+'/'" xpath="/tmp/elemDup/@entitypath"/>
              <set expr="Iif( StartWith([/tmp/elemDup/@path],[/tmp/elemDup/@entitypath]) , SubString([/tmp/elemDup/@path],StrLen([/tmp/elemDup/@entitypath])) , '')" xpath="/tmp/elemDup/@relativepath"/>
              <if expr="GetLinkSchema('xtk:workflow',[/tmp/elemDup/@relativepath])=='nms:delivery'">
                <set expr="[$(entityPath)/@operation-id]" xpath="@operation-id"/>
                <set expr="[$(entityPath)/@id]" xpath="@workflow-id"/>
                <set expr="[@folderProcess-id]" xpath="folderProcess/@id"/>
                <reset xpath="/ignored/queryDefDup"/>
                <set value="xtk:folder" xpath="/ignored/queryDefDup/@schema"/>
                <set value="select" xpath="/ignored/queryDefDup/@operation"/>
                <set value="@id" xpath="/ignored/queryDefDup/select/node[1]/@expr"/>
                <set value="@label" xpath="/ignored/queryDefDup/select/node[2]/@expr"/>
                <if expr="[@folder-id]!=0">
                  <set expr="'@id=' + [@folder-id] + ' OR @id=' + [@folderProcess-id] +''" xpath="/ignored/queryDefDup/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDefDup]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/tmp/queryDefDup"/>
                  </soapCall>
                  <if expr="[/tmp/queryDefDup/folder[1]/@id]==[@folder-id]">
                    <set expr="[/tmp/queryDefDup/folder[1]/@label]" xpath="folder/@_cs"/>
                    <set expr="[/tmp/queryDefDup/folder[2]/@label]" xpath="folderProcess/@_cs"/>
                  </if>
                  <if expr="[/tmp/queryDefDup/folder[2]/@id]==[@folder-id]">
                    <set expr="[/tmp/queryDefDup/folder[2]/@label]" xpath="folder/@_cs"/>
                    <set expr="[/tmp/queryDefDup/folder[1]/@label]" xpath="folderProcess/@_cs"/>
                  </if>
                </if>
              </if>
            </enter>
            <input type="separator"/>
            <input enabledIf="[/workflow/@id] != 0" img="xtk:properties.png" label="Properties" type="flatSubFormButton">
              <form label="Workflow properties" type="notebook" xpathsToLoadOpt="operation/@type">
                <enter>
                  <set value="0" xpath="/tmp/@acceptTempSchema"/>
                </enter>
                <container colcount="2" label="General">
                  <input xpath="@label"/>
                  <input xpath="@internalName"/>
                  <container applicableIf="HasPackage('nms:campaign')" colspan="2" type="visibleGroup" visibleIf="[@operation-id]!=0">
                    <input xpath="folder">
                      <sysFilter>
                        <condition enabledIf="$(@isModel)" expr="@model = 'xtkWorkflowModel'"/>
                        <condition enabledIf="$(@isModel)=false" expr="@model = 'xtkWorkflow'"/>
                      </sysFilter>
                    </input>
                  </container>
                  <container colspan="2" type="visibleGroup" visibleIf="@isModel">
                    <input img="xtk:workflow.png" xpath="folderProcess">
                      <sysFilter>
                        <condition expr="@model = 'xtkWorkflow'"/>
                      </sysFilter>
                    </input>
                  </container>
                  <container applicableIf="HasPackage('nms:campaign')" colspan="2" type="visibleGroup" visibleIf="[@operation-id]!=0 and @recurrentMdl and @isModel=false">
                    <input img="xtk:workflow.png" xpath="folderProcess">
                      <sysFilter>
                        <condition expr="@model = 'xtkWorkflow'"/>
                      </sysFilter>
                    </input>
                  </container>
                  <input colspan="2" xpath="@timezone"/>
                  <input colspan="2" createMode="none" noZoom="true" xpath="supervisor">
                    <sysFilter>
                      <condition expr="@type = 1"/>
                    </sysFilter>
                  </input>
                  <container colspan="2" label="Segmentation" type="frame">
                    <input useDesc="true" xpath="@keepResult"/>
                    <static nolabel="true" type="help">This enables you to perform analysis on intermediate populations generated by the workflow and on the final populations even if the workflow is finished (until these populations are purged by the cleanup task).</static>
                    <container ref="xtk:workflow:lib/tabs/schemaSelector"/>
                    <static type="help">Targeting and filtering dimensions used by default in query-related activities (query, split...).</static>
                  </container>
                  <static colspan="2" label="Description" type="separator"/>
                  <input colspan="2" nolabel="true" xpath="desc"/>
                </container>
                <container label="Execution">
                  <container applicableIf="HasPackage('nms:campaign')" label="Execution" type="visibleGroup" visibleIf="[@operation-id]!=0">
                    <container label="Scheduler" type="frame">
                      <input xpath="process/@priority"/>
                      <input useDesc="true" xpath="process/@forecasted"/>
                      <container type="visibleGroup" visibleIf="EV([operation/@type], 'recurrent')">
                        <input xpath="@recurrentMdl"/>
                      </container>
                    </container>
                  </container>
                  <container label="Execution" type="frame">
                    <input xpath="@affinity"/>
                    <input xpath="@history"/>
                    <input nolabel="false" xpath="@showSQL"/>
                    <input label="Execute in the engine (do not use in production)" xpath="@inProcess"/>
                    <input xpath="@production"/>
                  </container>
                  <container label="Error management" type="frame">
                    <input xpath="@onError"/>
                    <container type="visibleGroup" visibleIf="@onError=1">
                      <input xpath="@errorLimit"/>
                      <static type="help">If the number of consecutive errors is not equal to zero, the process will be suspended after this number of consecutive errors on a given task.</static>
                    </container>
                    <input boldLineExpr="@builtIn = 1" folderFilterChoice="@model = 'nmsDeliveryModel'" form="nms:delivery" xpath="scenario">
                      <sysFilter>
                        <condition expr="@isModel = 1"/>
                      </sysFilter>
                      <orderBy>
                        <node expr="@builtIn" sortDesc="true"/>
                        <node expr="@label"/>
                      </orderBy>
                    </input>
                  </container>
                </container>
                <container img=" " label="SQL logs" ref="xtk:workflow:sql"/>
                <container label="Script">
                  <input nolabel="true" xpath="script"/>
                </container>
                <container colcount="2" label="Advanced">
                  <static colspan="2" label="Background image" type="separator"/>
                  <input colspan="2" hideImage="true" noPropagateImg="true" schema="xtk:image" type="linkedit" xpath="@background"/>
                  <static colspan="2" label="Audit" type="separator"/>
                  <input noZoom="true" readOnly="true" xpath="createdBy"/>
                  <value xpath="@created"/>
                  <input noZoom="true" readOnly="true" xpath="modifiedBy"/>
                  <value xpath="@lastModified"/>
                </container>
                <container label="Variables">
                  <static label="Variables" type="separator"/>
                  <input colspan="2" nolabel="true" type="sourceEdit" xpath="variables"/>
                </container>
              </form>
            </input>
          </input>
          <container name="detail" type="visibleGroup" visibleIf="[/tmp/@taskState]">
            <container name="noteBook" type="notebook">
              <container label="Tasks">
                <input enumImage="@status" hideEditButtons="true" lineCount="10" nolabel="true" refresh="true" toolbarCaption="Tasks for the selected activity" type="linkList" xpath="task" xpathObjectId="@objectId" xpathObjectSchema="@objectSchema" xpathRefresh="/ignored/@selectedActivity" zoom="true">
                  <sysFilter>
                    <condition enabledIf="$(/ignored/@selectedActivity) !='' " expr="@activity = $(/ignored/@selectedActivity)"/>
                  </sysFilter>
                  <input xpath="@creationDate"/>
                  <input xpath="@status"/>
                  <input xpath="@activity"/>
                  <input xpath="@duration"/>
                  <input xpath="@nextProcessingDate"/>
                  <orderBy>
                    <node expr="@creationDate" sortDesc="true"/>
                  </orderBy>
                </input>
              </container>
              <container label="Journal">
                <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" lineCount="10" nolabel="true" refresh="true" toolbarCaption="Messages in the journal of the selected activity" type="linkList" xpath="log" xpathRefresh="/ignored/@selectedActivity">
                  <input xpath="@logDate"/>
                  <input xpath="@message"/>
                  <sysFilter>
                    <condition enabledIf="$(/ignored/@selectedActivity) !='' " expr="@activity = $(/ignored/@selectedActivity)"/>
                  </sysFilter>
                  <orderBy>
                    <node expr="@logDate" sortDesc="true"/>
                    <node expr="@id"/>
                  </orderBy>
                </input>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container img="xtk:logs.png" label="Audit" name="log" visibleIf="!@isModel">
        <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Messages in the journal" type="linkList" xpath="log">
          <input xpath="@logDate"/>
          <input xpath="@activity"/>
          <input xpath="@message"/>
          <orderBy>
            <node expr="@logDate" sortDesc="true"/>
            <node expr="@id"/>
          </orderBy>
        </input>
      </container>
      <container img="xtk:sql.png" label="SQL logs" name="sql" visibleIf="@showSQL">
        <input nolabel="true" readOnly="true" type="wkfJobLogSQLEdit" xpath="@id"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" label="Event" md5="54F09DC5E97731B0248BE31E13E64FB6" name="workflowEvent" namespace="xtk" xtkschema="xtk:form">
      <container name="general">
        <input xpath="@id"/>
        <input xpath="@status"/>
        <input xpath="@transition"/>
      </container>
      <container name="dates">
        <input xpath="@creationDate"/>
        <input xpath="@processingDate"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" md5="1A450404AA7D2B9BFDF4A563EBAF0DCF" name="workflowJob" namespace="xtk" xtkschema="xtk:form">
      <container>
        <static type="warning">Modifying these parameters can prevent the workflow to function properly.</static>
        <input readOnly="true" xpath="workflow"/>
        <input xpath="@command"/>
        <input xpath="@nextProcessingDate"/>
        <input xpath="@affinity"/>
        <input xpath="@hostname"/>
        <input xpath="login"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Elementary task" md5="114A5E293C2C4E820C6C68E85EB4BE66" name="workflowTask" namespace="xtk" xpathsToLoad="@workflow-id,variables" xtkschema="xtk:form">
      <container type="notebook">
        <container colcount="2" label="General" name="general" readOnly="true">
          <input xpath="@taskIdentifier"/>
          <input xpath="@status"/>
          <input xpath="@creationDate"/>
          <input xpath="@processingDate"/>
          <input xpath="@processingCount"/>
          <input xpath="@nextProcessingDate"/>
          <input xpath="@timeout"/>
          <input xpath="@abortReason"/>
          <input xpath="@hostname"/>
          <input xpath="@activity"/>
          <input xpath="@objectId"/>
          <input xpath="@objectSchema"/>
        </container>
        <container label="Approval" name="validation" readOnly="true" visibleIf="[@assigneeType] != 0 OR [assignee/@id] != 0">
          <value xpath="@title"/>
          <input readOnly="true" type="dhtml" xpath="message"/>
          <container type="visibleGroup" visibleIf="@assigneeType=0">
            <input xpath="assignee"/>
          </container>
          <container type="visibleGroup" visibleIf="@assigneeType=1">
            <input xpath="operator"/>
          </container>
          <container type="visibleGroup" visibleIf="@assigneeType=2">
            <input xpath="@assigneeFilter"/>
          </container>
          <input hideEditButtons="true" nolabel="true" toolbarCaption="Replies" type="list" xpath="responses/response">
            <input xpath="@operatorId"/>
            <input xpath="@choice"/>
            <input xpath="comment"/>
          </input>
        </container>
        <container label="Variables" name="variables">
          <static label="Event variables"/>
          <input nolabel="true" type="sourceEdit" xpath="eventVariables"/>
          <static label="Task variables"/>
          <input nolabel="true" type="sourceEdit" xpath="variables"/>
        </container>
        <container label="Journal" name="log">
          <input hideEditButtons="true" nolabel="true" refresh="true" toolbarCaption="Messages in the journal of the task" type="linkList" xpath="log">
            <input xpath="@logDate"/>
            <input xpath="@message"/>
            <orderBy>
              <node expr="@logDate"/>
              <node expr="@id"/>
            </orderBy>
          </input>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="xtk:xslt" entitySchema="xtk:form" img="xtk:form.png" label="Stylesheet" md5="8F18EA007DB708EA3E76E6BAA86C3715" name="xslt" namespace="xtk" screen="SchemaEdit,CheckEdit" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input expr="@namespace='xtk' or @namespace='nl' or @namespace='nms' or @namespace='ncm' or  @namespace='crm'" type="expr" xpath="/tmp/@factory"/>
      <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@factory]">
        <container label="Warning" type="frame">
          <static type="warning">This is an application built-in object. It cannot be modified.</static>
        </container>
        <input addButtonResourceMenu="true" contentType="xsl" nolabel="true" readOnly="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="data"/>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="![/tmp/@factory]">
        <container style="flat" type="notebook">
          <container label="Edit">
            <input addButtonResourceMenu="true" contentType="xsl" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="data"/>
          </container>
          <container label="Preview">
            <static img="xtk:preview.png" label="Stylesheet preview (please specify content and generate)" type="separator"/>
            <container colcount="4">
              <input computeStringExpr="@computeString + ' (' + [channel/@fullName] + ')'" label="Content" name="content" schema="ncm:content" serialize="true" type="articleEdit" xpath="/ignored/content">
                <orderBy>
                  <node expr="[@channel-id]"/>
                </orderBy>
              </input>
              <input enum="xtk:xslt:format" label="Format" name="format" serialize="true" type="sysEnum" xpath="/ignored/@format"/>
              <input img="xtk:process.png" label="Generate" name="process" type="buttonProcessRes"/>
              <static/>
            </container>
            <input name="previewBrowser" type="browser"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form _decorated="true" entity-schema="xtk:none" entitySchema="xtk:form" img="xtk:workflow16x16.png" label="Monitoring" md5="B55AB60BCC952641C089108ECC8309AE" name="monitoring" namespace="nl" screen="webBrowser" xtkschema="xtk:form">
      <enter>
        <set expr="$(serverUrl)+'/nl/jsp/monitor.jsp?console=true'" xpath="/tmp/@url"/>
      </enter>
      <input sessionToken="true" type="UrlViewer" urlExpr="[/tmp/@url]"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" label="Navigation hierarchy" md5="B16594000B4490EFC500B171EF6584F3" name="navtree" namespace="nl" screen="SchemaEdit,CheckEdit" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <container colspan="2" style="flat" type="notebook">
        <container label="Edit">
          <input nolabel="true" toolbar="true" type="SourceEdit" xpath="."/>
        </container>
        <container label="Preview">
          <static img="xtk:preview.png" label="Preview of the generated navigation tree" type="separator"/>
          <input nolabel="true" readOnly="true" type="NavTreePreview" xpath="."/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:serverOptions" entitySchema="xtk:form" img="nl:serverOptions32.png" label="Instance configuration wizard" maxLabelWidth="60" md5="F7366A5633BDC480A1721805ED3F3464" name="serverOptions" namespace="nl" type="wizard" xpathsToLoad="baseOption/defaultCountry/@label,baseOption/tracking/server/extAccount/@label" xtkschema="xtk:form">
      <enter>
        <set value="xtk" xpath="@namespace"/>
        <set value="serverOptions" xpath="@name"/>
        <set expr="[baseOption/email/header/@defaultFromAddr]!=''" xpath="/tmp/@email"/>
        <set expr="[baseOption/tracking/server/extAccount/@name]!=''" xpath="/tmp/@externalTracking"/>
      </enter>
      <container desc="Please specify the general information for the instance" title="General parameters">
        <container label="General information" type="frame">
          <input xpath="baseOption/serverApp/@customerId"/>
          <input xpath="baseOption/serverApp/@expOrganization"/>
          <input label="Namespace" xpath="serverConf/shared/module/@defaultNameSpace"/>
          <static type="help">The default namespace lets you state where configurations specific to you will be stored, in view of simplifying future updates.</static>
          <input xpath="baseOption/packageServersOptions/@instancePrefix"/>
          <static type="help">The instance object prefix lets you identify the source of objects exported as packages.</static>
        </container>
        <container colcount="2" label="Technical options" type="frame">
          <static colspan="2">Select the technical options of the Adobe Campaign platform you want to use:</static>
          <input label="Email channel" type="checkbox" xpath="/tmp/@email"/>
          <container enabledIf="[/tmp/@email]" margin-left="20" type="enabledGroup">
            <input label="Management of bounced emails" type="checkbox" xpath="bounceMailbox/@active"/>
          </container>
          <input colspan="2" label="Tracking" type="checkbox" xpath="baseOption/tracking/@activated"/>
          <input colspan="2" label="LDAP integration" xpath="baseOption/ldap/@active"/>
        </container>
        <static type="warning">You may have to disconnect/reconnect, or even restart the server, so that some changes are taken into account.</static>
      </container>
      <container applicableIf="HasPackage('nms:messageCenterExec')" desc="Please specify the execution instance parameters" img="nms:packages/mcControl.png" title="Message Center" xpath="baseOption/messageCenterExec">
        <input xpath="@cellId"/>
        <static label="The identifier must be different for each execution instance." type="warning"/>
        <container type="visibleGroup" visibleIf="HasPackage('nms:messageCenterControl')">
          <input img="nms:prepare.png" label="Create the archiving workflow" type="button">
            <enter onSuccess="Archiving workflow created and started">
              <soapCall name="UpdateMCSynchWkf" service="nms:extAccount">
                <param exprIn="0" type="int"/>
              </soapCall>
            </enter>
          </input>
        </container>
        <container label="Warning (orange) and alert thresholds (red) of pending real time events" type="frame">
          <container colcount="3">
            <static label=""/>
            <static label="Warning"/>
            <static label="Alert"/>
            <static label="Number of events pending in queue"/>
            <input nolabel="true" xpath="@rtQueueWarning"/>
            <input nolabel="true" xpath="@rtQueueAlert"/>
            <static label="Error rate (%)"/>
            <input nolabel="true" xpath="@rtErrorWarning"/>
            <input nolabel="true" xpath="@rtErrorAlert"/>
            <static label="Outgoing throughput (messages per second)"/>
            <input nolabel="true" xpath="@rtThroughputWarning"/>
            <input nolabel="true" xpath="@rtThroughputAlert"/>
            <static label="Average time in queue (in seconds)"/>
            <input nolabel="true" xpath="@rtAvgQueueTimeWarning"/>
            <input nolabel="true" xpath="@rtAvgQueueTimeAlert"/>
            <static label="Average sending time (in seconds)"/>
            <input nolabel="true" xpath="@rtAvgDeliveryTimeWarning"/>
            <input nolabel="true" xpath="@rtAvgDeliveryTimeAlert"/>
            <static label="Average processing time (in seconds)"/>
            <input nolabel="true" xpath="@rtAvgProcessTimeWarning"/>
            <input nolabel="true" xpath="@rtAvgProcessTimeAlert"/>
            <static label="Maximum number of queued events"/>
            <input nolabel="true" xpath="@rtMaxQueueWarning"/>
            <input nolabel="true" xpath="@rtMaxQueueAlert"/>
            <static label="Minimum number of queued events"/>
            <input nolabel="true" xpath="@rtMinQueueWarning"/>
            <input nolabel="true" xpath="@rtMinQueueAlert"/>
            <static label="Average queuing events"/>
            <input nolabel="true" xpath="@rtAvgQueueWarning"/>
            <input nolabel="true" xpath="@rtAvgQueueAlert"/>
          </container>
        </container>
        <leave>
          <check expr="[@cellId]>0">
            <error>Identifier 0 is reserved for the control instance.</error>
          </check>
        </leave>
      </container>
      <container desc="Please specify default email header parameters" title="Email channel" visibleIf="[/tmp/@email]" xpath="baseOption/email">
        <container type="frame" xpath="header">
          <input xpath="@fromName"/>
          <input img="nms:sendemail.png" xpath="@defaultFromAddr"/>
          <input xpath="@replyToName"/>
          <input img="nms:sendemail.png" xpath="@defaultReplyToAddr"/>
          <input img="nms:sendemail.png" xpath="@defaultErrorAddr"/>
          <input lineCount="2" xpath="@fromMask"/>
          <input lineCount="2" xpath="@errorMask"/>
        </container>
        <container colcount="2" type="frame" xpath="addressChars">
          <static colspan="2" type="help">Select a pre-built configuration, or enter your list of characters.</static>
          <input label="European only" nolabel="true" type="button" xpath=".">
            <enter>
              <set value="0123456789_.-'+abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ" xpath="."/>
            </enter>
          </input>
          <input label="US only" nolabel="true" type="button" xpath=".">
            <enter>
              <set value="0123456789_.-abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ" xpath="."/>
            </enter>
          </input>
          <input colspan="2" nolabel="true" xpath="."/>
        </container>
        <input label="Advanced parameters..." type="subFormLink">
          <form label="Advanced parameters" maxLabelWidth="200" xpath="baseOption/email">
            <container type="frame" xpath="delivery">
              <input xpath="@msgValidityDuration"/>
              <input xpath="@msgWebValidityDuration"/>
              <input unbound-width="true" xpath="@excludeBlackListed"/>
              <input xpath="@excludeDuplicates"/>
            </container>
            <container type="frame" xpath="retry">
              <input xpath="@period"/>
              <input xpath="@count"/>
            </container>
            <container type="frame" xpath="../listHygiene/quarantineEmail">
              <input xpath="@significantErrorDelayEmail"/>
              <input xpath="@maxSoftErrorEmail"/>
            </container>
          </form>
        </input>
      </container>
      <container desc="Bounce handling settings" title="Management of bounced emails" visibleIf="[/tmp/@email] and [bounceMailbox/@active]">
        <container colcount="2" type="frame" xpath="bounceMailbox">
          <input xpath="@label"/>
          <input xpath="@encryptionType"/>
          <input xpath="@server"/>
          <input xpath="@port"/>
          <input xpath="@account"/>
          <input xpath="@password"/>
          <input align="right" colspan="2" img="nms:prepare.png" label="&amp;Test" type="flatButton">
            <enter onSuccess="Connection test successful">
              <soapCall name="TestAccount" service="nms:extAccount">
                <param exprIn="@type" type="byte"/>
                <param exprIn="@server" type="string"/>
                <param exprIn="@account" type="string"/>
                <param exprIn="@password" type="string"/>
                <param exprIn="@port" type="string"/>
                <param exprIn="''" type="string"/>
              </soapCall>
            </enter>
          </input>
        </container>
        <container label="Unprocessed bounce mails" type="frame" xpath="serverConf/inMail">
          <input img="nms:sendemail.png" xpath="@defaultForwardAddress"/>
          <input img="nms:sendemail.png" xpath="@errorForwardAddress"/>
          <input xpath="../shared/mailExchanger/@mxAddress"/>
          <static type="help">When an address is empty, mails are not transferred but deleted.</static>
        </container>
      </container>
      <container desc="Please specify the tracking parameters" title="Tracking configuration" visibleIf="[baseOption/tracking/@activated]" xpath="baseOption/tracking">
        <enter>
          <set expr="[server/@instance]" xpath="/tmp/@instance"/>
        </enter>
        <container type="frame" xpath="server">
          <static type="help">External and secure external URLs are the ones used in the mails sent and must use a publicly known DNS alias which can point to a load balancer in the case of a tracking server farm. Internal URLs are the ones used by the application server to contact the different tracking servers.</static>
          <input xpath="@url"/>
          <input xpath="@secureUrl"/>
          <input label="Externalize tracking management" type="checkbox" xpath="/tmp/@externalTracking"/>
          <container type="visibleGroup" visibleIf="![/tmp/@externalTracking]">
            <input xpath="@urlList"/>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/@externalTracking]" xpath="extAccount">
            <input choiceButton="true" computeStringAlias="@label" createMode="none" form="nms:extAccount" img="nms:tracking.png" noAutoComplete="true" noZoom="true" notifyPathList="@label,@name" schema="nms:extAccount" type="linkEdit" xpath="@name">
              <orderBy>
                <node expr="@label"/>
              </orderBy>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/@externalTracking]">
            <input label="Instance name" xpath="/tmp/@instance"/>
            <input img="nms:prepare.png" label="Enable the tracking instance" nolabel="false" type="button">
              <enter onSuccess="Tracking instance enabled successfully">
                <check expr="[/tmp/@instance]!=''">
                  <error>The name of instance may not be empty.</error>
                </check>
                <soapCall name="RegisterExternalInstance" service="nms:trackingUrl">
                  <param exprIn="[extAccount/@name]" type="string"/>
                  <param exprIn="[/tmp/@instance]" type="string"/>
                  <param exprIn="''" type="string"/>
                  <param exprIn="false" type="boolean"/>
                </soapCall>
                <set expr="[/tmp/@instance]" xpath="@instance"/>
              </enter>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="@instance = ''">
            <static fontBold="true" img="nms:canceled.png">You are not registered to the tracking server(s). To register, please specify tracking parameters and start registration.</static>
          </container>
          <container type="visibleGroup" visibleIf="@instance != ''">
            <static img="nms:finished.png">You are already registered to the tracking server(s). You can register again to force the tracking configuration.</static>
          </container>
          <container type="visibleGroup" visibleIf="[/tmp/@externalTracking]!=1">
            <input img="xtk:passwd.png" label="Registration on the tracking server(s)..." nolabel="false" type="subFormLink">
              <form label="Recording of tracking" leftButtonType="trackingButton#Validate#xtk:runtask.png" maxLabelWidth="35" xpath="baseOption/tracking/server">
                <enter>
                  <set expr="Iif([baseOption/tracking/server/@urlList]!='', [baseOption/tracking/server/@urlList], Iif([baseOption/tracking/server/@secureUrl]!='', [baseOption/tracking/server/@secureUrl], [baseOption/tracking/server/@url]))" xpath="/tmp/tracking/@trServerUrl"/>
                  <set value="update" xpath="/tmp/tracking/@trMode"/>
                </enter>
                <container img="nms:check32.png" label="Tracking server(s)" type="frame">
                  <value fontBold="true" label="Internal URL(s) of the tracking server(s)" xpath="/tmp/tracking/@trServerUrl"/>
                  <input checkedValue="update" label="Add support for tracking in an existing instance" type="RadioButton" xpath="/tmp/tracking/@trMode"/>
                  <input checkedValue="create" label="Create a new instance dedicated to tracking" type="RadioButton" xpath="/tmp/tracking/@trMode"/>
                  <input checkedValue="register" label="Approve a tracking instance already pre-configured for you" type="RadioButton" xpath="/tmp/tracking/@trMode"/>
                  <container type="visibleGroup" visibleIf="[/tmp/tracking/@trMode]!='register'">
                    <container type="visibleGroup" visibleIf="[/tmp/tracking/@trMode]='update'">
                      <static type="help">This choice is used when an instance has already been created for other needs (delivery server...) on the server(s) which will be used as tracking server(s). Enter the password of the 'internal' password on the redirection server(s), so that the tracking instance can be configured. Note: when there is more than one tracking server, they must all use the same password.</static>
                    </container>
                    <container type="visibleGroup" visibleIf="[/tmp/tracking/@trMode]='create'">
                      <static type="help">This choice is recommended when the instance on the server is dedicated to tracking, and does not contain other activated modules. Enter the password of the 'internal' password on the redirection server(s), so that the tracking instance can be configured. Note: when there is more than one tracking server, they must all use the same password.</static>
                    </container>
                    <input label="Password of the 'internal' account" type="PasswordEdit" xpath="/tmp/tracking/@internalPassword"/>
                    <container type="visibleGroup" visibleIf="[/tmp/tracking/@trMode]='create'">
                      <input label="Name of the instance to create" xpath="@instance"/>
                      <input xpath="@password"/>
                      <input label="Associated DNS masks" xpath="/tmp/tracking/@host"/>
                    </container>
                    <container type="visibleGroup" visibleIf="[/tmp/tracking/@trMode]='update'">
                      <input label="Instance name" xpath="@instance"/>
                      <input xpath="@password"/>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="[/tmp/tracking/@trMode]=='register'">
                    <static type="help">This option is used when you do not have access to the password of the 'internal' account: in this case, a tracking account must have already been configured for you on the tracking server(s). Enter the password of the 'tracking' account on the redirection server(s), so that the tracking instance can be approved.</static>
                    <input label="Name of the instance to approve" xpath="@instance"/>
                    <input xpath="@password"/>
                  </container>
                </container>
                <static label=" "/>
                <static label="Click 'Approve' to register on the tracking server(s)." type="help"/>
                <container type="visibleGroup" visibleIf="[/tmp/tracking/@errorMsg] == 'yes'">
                  <static fontBold="true" img="nms:alarmon.png" label="An error occurred while registering with the tracking server(s)."/>
                </container>
                <container type="visibleGroup" visibleIf="[/tmp/tracking/@errorMsg] == 'no'">
                  <static fontBold="true" img="nms:finished.png" label="Registration on the tracking server(s) successfully completed."/>
                </container>
              </form>
            </input>
          </container>
        </container>
        <container type="frame" xpath="parsing">
          <input xpath="@urlDelimiters"/>
          <input img="xtk:jst.png" label="Tracking URL generation formula..." nolabel="false" type="subFormLink">
            <form label="Tracking URL generation formula" xpath="baseOption/tracking">
              <static label="Tracking URL generation formula." type="help"/>
              <input nolabel="true" type="jstEdit" xpath="clickFormula"/>
            </form>
          </input>
          <input img="xtk:jst.png" label="Open detection generation formula..." nolabel="false" type="subFormLink">
            <form label="Open detection generation formula" xpath="baseOption/tracking">
              <static label="Open detection generation formula." type="help"/>
              <input nolabel="true" type="jstEdit" xpath="openFormula"/>
            </form>
          </input>
          <input img="xtk:jst.png" label="Web tracking tags creation formula..." nolabel="false" type="subFormLink">
            <form label="Web Tracking tags creation formula" xpath="baseOption/tracking">
              <static label="Web Tracking tags creation formula." type="help"/>
              <input nolabel="true" type="jstEdit" xpath="webFormula"/>
            </form>
          </input>
        </container>
        <container label="Web tracking" type="frame">
          <input xpath="@webTrackingMode"/>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:mobile')" colcount="2" desc="Please specify default parameters for mobile delivery (SMS, WAP Push, MMS)" title="Mobile channel" xpath="baseOption/sms">
        <container colcount="2" colspan="2" type="frame" xpath="../../smsAccount">
          <input colspan="2" xpath="@label"/>
          <input xpath="@server"/>
          <input xpath="@port"/>
          <input xpath="@account"/>
          <input xpath="@password"/>
          <input xpath="@mobileConnector"/>
          <static/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'netsize')">
            <input xpath="params/@endPointSend"/>
            <input xpath="params/@endPointReceipt"/>
            <input xpath="params/@endPointNotif"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'smppGen', 'smppmBlox')">
            <input xpath="params/@systemType"/>
            <input xpath="params/@systemTypeMO"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'smppGen', 'smppTele2')">
            <input xpath="params/@sourceNpi"/>
            <input xpath="params/@sourceTon"/>
            <input xpath="params/@destinationNpi"/>
            <input xpath="params/@destinationTon"/>
            <input xpath="params/@sourceAddress"/>
          </container>
        </container>
        <container colspan="2" type="frame" xpath="headerSMS">
          <input xpath="@priority"/>
        </container>
        <input label="Advanced parameters..." type="subFormLink">
          <form label="Advanced parameters" maxLabelWidth="200" xpath="baseOption">
            <container type="frame" xpath="sms/retrySMS">
              <input xpath="@period"/>
              <input xpath="@count"/>
            </container>
            <container type="frame" xpath="listHygiene/quarantineMobile">
              <input xpath="@significantErrorDelayMobile"/>
              <input xpath="@maxSoftErrorMobile"/>
            </container>
          </form>
        </input>
      </container>
      <container applicableIf="HasPackage('nms:paper')" desc="Please specify default parameters for postal delivery" title="Direct Mail channel" xpath="baseOption/paper">
        <container label="Sender Address" type="frame" xpath="senderAddress">
          <input label="Company name" xpath="@line1"/>
          <input label="Recipient or service identity" xpath="@line2"/>
          <input label="Geographical address detail" xpath="@line3"/>
          <input label="Number and label of street" xpath="@line4"/>
          <input label="Special (county...)" xpath="@line5"/>
          <input label="ZIP/Postcode and Locality" xpath="@line6"/>
          <input label="Country" xpath="@line7"/>
        </container>
      </container>
      <container desc="Please specify the regional settings used by some data quality checks (data policies)." title="Regional settings" xpath="baseOption">
        <container xpath="defaultCountry">
          <input choiceButton="true" computeStringAlias="@label" createMode="none" form="nms:country" img="nms:world.png" noAutoComplete="true" noZoom="true" notifyPathList="@label" schema="nms:country" type="linkEdit" xpath="@code">
            <sysFilter>
              <condition expr="@itu!='' and @phoneExit!='' and @phoneFormat!=''"/>
            </sysFilter>
            <orderBy>
              <node expr="@label"/>
            </orderBy>
          </input>
        </container>
        <container label="Phone numbers" type="frame" xpath="dataPolicy/phone">
          <input useDesc="false" xpath="@inputDefaultInternat"/>
          <static label="Phone numbers must all be entered in international format" type="help"/>
          <input useDesc="false" xpath="@outputAllInternat"/>
          <static label="Store all phone numbers (even domestic) using the international format (for instance, a number entered as 425 555 0199 will be stored and displayed as +1 425 555 0199)" type="help"/>
        </container>
      </container>
      <container desc="Please specify the URLs used to access the platform from the public Internet" title="Access from the Internet" xpath="baseOption">
        <container label="Server(s) exposed on the Internet" type="frame" xpath="serverApp">
          <input xpath="@url"/>
          <static label="URL used to access the application server exposed on the Internet (web forms &amp; surveys)." type="help"/>
          <input xpath="@urlIntranet"/>
          <static label="URL used to access the application server (Intranet, forms &amp; approvals)." type="help"/>
          <input xpath="@urlMirror"/>
          <static label="URL used to access the mirror page server exposed on the Internet." type="help"/>
        </container>
        <container label="Publication options for Web forms and surveys" type="frame" xpath="webFormServersOptions">
          <input xpath="@publishing"/>
          <container type="visibleGroup" visibleIf="@publishing == 'tracking'">
            <static label=" " type="help">Web forms and surveys will be published automatically on the various tracking servers.</static>
          </container>
          <container type="visibleGroup" visibleIf="@publishing == 'other'">
            <static label=" " type="help">Web forms and surveys will be published on Adobe Campaign servers using the following parameters:</static>
            <input xpath="@internalURLs"/>
            <input xpath="@instance"/>
            <input xpath="@password"/>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:purl')">
          <container label="pURL publication options" type="frame" xpath="purlServersOptions">
            <input xpath="@pURLPurgeDelay"/>
            <input xpath="@publishing"/>
            <container type="visibleGroup" visibleIf="@publishing == 'tracking'">
              <static label=" " type="help">The pURLs will be automatically published to the different tracking servers.</static>
            </container>
            <container type="visibleGroup" visibleIf="@publishing == 'other'">
              <static label=" " type="help">pURLs will be published to Adobe Campaign servers using the following parameters:</static>
              <input xpath="@internalURLs"/>
              <input xpath="@instance"/>
              <input xpath="@password"/>
            </container>
          </container>
        </container>
      </container>
      <container desc="Please specify the automatic public resource upload settings (resources exposed on the Internet)" title="Public resource management" xpath="baseOption">
        <enter>
          <if expr="[fileRes/@publicURL]=''">
            <set expr="[tracking/server/@url] + '/res/'" xpath="fileRes/@publicURL"/>
            <setModified/>
          </if>
        </enter>
        <input label="New public resource URL" xpath="fileRes/@publicURL"/>
        <container label="Delivery image detection" type="frame">
          <input xpath="email/image/@defaultIgnoredImage"/>
          <static label=" " type="help">The list of masks makes it possible to ignore the corresponding URLs when uploading the images (eg. "http://mydomain.com/images/*").</static>
        </container>
        <container label="Publication options" type="frame" xpath="email/image">
          <input xpath="@publishing"/>
          <container type="visibleGroup" visibleIf="@publishing == 'tracking'">
            <static label=" " type="help">The files will be automatically copied to the different tracking servers.</static>
          </container>
          <container type="visibleGroup" visibleIf="@publishing == 'script'">
            <static label=" " type="help">A script will be used to copy the files from the Web module to the media servers.</static>
            <input xpath="@publishingScript"/>
          </container>
          <container type="visibleGroup" visibleIf="@publishing == 'list'">
            <static label=" " type="help">The files will be copied to the different media servers. These URLs will be used to contact these media servers to send the files.</static>
            <input xpath="@mediaServers"/>
            <input xpath="@instance"/>
            <input xpath="@password"/>
          </container>
        </container>
      </container>
      <container desc="Old-data purge settings" title="Purge data" xpath="baseOption/cleanup">
        <container type="frame">
          <static label="Specify the durations for which data is kept for the following items." type="help"/>
          <input xpath="@trackingStatPurgeDelay"/>
          <input xpath="@broadLogPurgeDelay"/>
          <input xpath="@trackingLogPurgeDelay"/>
          <input xpath="@recycledDeliveryPurgeDelay"/>
          <input xpath="@rejectsPurgeDelay"/>
          <input xpath="@visitorPurgeDelay"/>
          <input applicableIf="HasPackage('nms:coreInteraction')" xpath="@propositionPurgeDelay"/>
          <input applicableIf="HasPackage('nms:messageCenterExec')" xpath="@eventPurgeDelay"/>
          <input applicableIf="HasPackage('nms:messageCenterExec')" xpath="@eventStatPurgeDelay"/>
          <input applicableIf="HasPackage('nms:messageCenterControl')" xpath="@eventHistoPurgeDelay"/>
          <input xpath="@pipelineDiscardPurgeDelay"/>
        </container>
      </container>
      <container desc="Settings used when authenticating a user against an LDAP directory" title="LDAP settings" visibleIf="[baseOption/ldap/@active] == '1'" xpath="baseOption/ldap">
        <enter>
          <set expr="[@dnBase] == [@rightBase] AND [@dnScope] == [@rightScope]" xpath="/tmp/@sameSearchParam"/>
        </enter>
        <container type="frame">
          <input required="true" xpath="@server"/>
          <static label=" " type="help">Address of the server where the directory is installed (the port is optional). Ex: ldap.domain.com:389</static>
          <container type="visibleGroup" visibleIf="substring(@server, -4)==':636'">
            <static label=" " type="warning">Using the 636 port requires an LDAPS (LDAP on SSL) connection</static>
          </container>
          <input xpath="@mechanism"/>
          <container padding-top="10">
            <input checkedValue="false" label="Automatically compose the unique user ID" nolabel="true" type="RadioButton" xpath="@dnSearch"/>
            <input checkedValue="true" label="Search DN in directory" nolabel="true" type="RadioButton" xpath="@dnSearch"/>
          </container>
        </container>
      </container>
      <container desc="User identification computation parameters" title="LDAP authentication" visibleIf="[baseOption/ldap/@active] == '1' AND [baseOption/ldap/@dnSearch] == '0'" xpath="baseOption/ldap">
        <input xpath="@dn"/>
        <static label=" " type="help">Unique identifer of the user in the ($(login) directory is replaced with the login).
E.g. cn=$(login),dc=domain,dc=com</static>
        <input label="Enable synchronization of user rights from authorizations and groups in the directory" nolabel="true" xpath="@rights"/>
        <container enabledIf="@dnSearch=='0' AND @rights == '1'" type="enabledGroup">
          <input xpath="@appDN"/>
          <input crypt="true" reversible="true" type="passwordedit" xpath="@appPwd"/>
          <container type="visibleGroup" visibleIf="@dnSearch=='0'">
            <static label=" " type="help">LDAP DN and password enabling search. Leave the fields empty if searching is enabled for anonymous connections.</static>
          </container>
        </container>
      </container>
      <container desc="Search parameters for identifying a user via an LDAP directory" title="LDAP authentication" visibleIf="[baseOption/ldap/@active] == '1' AND [baseOption/ldap/@dnSearch] == '1'" xpath="baseOption/ldap">
        <container enabledIf="@dnSearch" type="enabledGroup">
          <input xpath="@appDN"/>
          <input crypt="true" reversible="true" type="passwordedit" xpath="@appPwd"/>
          <static label=" " type="help">LDAP DN and password enabling search. Leave the fields empty if searching is enabled for anonymous connections.</static>
          <container>
            <input xpath="@dnBase"/>
            <input xpath="@dnScope"/>
            <static label=" " type="help">Base DN and scope of search
E.g. dc=domain,dc=com</static>
          </container>
          <input xpath="@dnFilter"/>
          <static label=" " type="help">Filter to find the user in the directory ($(login) is replaced with the login).
E.g. cn=$(login)</static>
        </container>
        <input label="Enable synchronization of user rights from authorizations and groups in the directory" nolabel="true" xpath="@rights"/>
      </container>
      <container desc="LDAP search parameters for retrieving user authorizations" title="Configure LDAP authorizations" visibleIf="[baseOption/ldap/@active] == '1' AND [baseOption/ldap/@rights] == '1'" xpath="baseOption/ldap">
        <enter>
          <set expr="Iif([@dnSearch], [/tmp/@sameSearchParam], false)" xpath="/tmp/@sameSearchParam"/>
          <set expr="Iif([/tmp/@sameSearchParam], [@dnBase], [@rightBase])" xpath="@rightBase"/>
          <set expr="Iif([/tmp/@sameSearchParam], [@dnScope], [@rightScope])" xpath="@rightScope"/>
        </enter>
        <container label="Authorization search parameters" type="frame">
          <container enabledIf="@rights == '1'" type="enabledGroup">
            <container enabledIf="@dnSearch=='1'" type="enabledGroup">
              <input label="Reuse the DN search parameters" nolabel="true" type="checkbox" xpath="/tmp/@sameSearchParam"/>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/@sameSearchParam]">
              <container enabledIf="false" type="enabledGroup">
                <input xpath="@dnBase"/>
                <input xpath="@dnScope"/>
                <static label=" "/>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="![/tmp/@sameSearchParam]">
              <input xpath="@rightBase"/>
              <input xpath="@rightScope"/>
              <static label=" " type="help">Base DN to start the search from
E.g. dc=domain,dc=com</static>
            </container>
            <input xpath="@rightFilter"/>
            <static label=" " type="help">Filter to obtain the list of user authorizations or groups in the directory.
The $(login) and $(userdn) variables are replaced by the user login and DN respectively.
E.g. (&amp;(objectclass=group)(cn=NEOLANE_*)(member=$(userdn)))</static>
            <input xpath="@rightName"/>
            <static label=" " type="help">Attribute containing the group or authorization name.
E.g. cn</static>
            <input xpath="@rightMask"/>
            <static label=" " type="help">Expression to extract the name of the corresponding user right in Adobe Campaign from the group name. Each group identified in the regular expression will be interpreted as the name of a right that will be associated with the user. 
E.g. ADOBE_(.*)</static>
          </container>
        </container>
        <input label="Enable the connection of users declared in the LDAP directory if the operator is not declared in Adobe Campaign" nolabel="true" xpath="@autoOperator"/>
        <leave>
          <set expr="Iif([/tmp/@sameSearchParam], [@dnBase], [@rightBase])" xpath="@rightBase"/>
          <set expr="Iif([/tmp/@sameSearchParam], [@dnScope], [@rightScope])" xpath="@rightScope"/>
        </leave>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" md5="31A6F9AD5940D56CA6EA47EF7EFF30AB" name="address" namespace="nms" xtkschema="xtk:form">
      <input xpath="@address"/>
      <input xpath="@created"/>
      <input xpath="@status"/>
      <input xpath="@lastModified"/>
      <static colspan="2" label="Errors" type="separator"/>
      <container colcount="2" colspan="2">
        <input xpath="@lastErrorDate"/>
        <input xpath="@consecutiveError"/>
        <input colspan="2" xpath="@quarantineReason"/>
        <input colspan="2" xpath="quarantineText"/>
        <input colspan="2" readOnly="true" xpath="delivery"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" md5="FC0EC5029B9A3623B9D020344D76DBA7" name="calendar" namespace="nms" xtkschema="xtk:form">
      <input xpath="@name"/>
      <input xpath="@label"/>
      <input colspan="2" img="nl:smallcalendar.png" label=" " nolabel="true" toolbarCaption="List of days" type="list" xpath="day" zoom="false">
        <input xpath="@date"/>
        <input xpath="@desc"/>
      </input>
      <static colspan="2" label="Comment" type="separator"/>
      <input colspan="2" lineCount="4" nolabel="true" xpath="comment"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Typology" maxLabelWidth="50" md5="3D465EB04A7C4A4F682959F768A2C076" name="typology" namespace="nms" type="iconbox" xtkschema="xtk:form">
      <container colcount="2" img="xtk:properties.png" label="General">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input xpath="@type"/>
        <static/>
        <container colspan="2" type="visibleGroup" visibleIf="EV(@type, 'none')">
          <container label="Management of affinities with IP addresses" type="frame">
            <input label="Affinity" xpath="@IPAffinity"/>
            <static type="help">Managing affinities with IP addresses enables better control of outgoing SMTP traffic by associating different IP addresses with each type of traffic depending on the typology of its delivery action.</static>
          </container>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="EV(@type, 'none')">
          <static/>
        </container>
        <static colspan="2" label="Description" type="separator"/>
        <input colspan="2" nolabel="true" xpath="desc"/>
      </container>
      <container img="nms:typorule.png" label="Rules" visibleIf="EV(@type, 'none')">
        <input choicePath="/tmp/choiceList" img="nms:typorule.png" keyName="id" labelFormChoice="Add rules" newEntityFormChoice="true" nolabel="true" promptDeleteLabel="Do you want to remove the selected rules?" selectionPath="/tmp/entityList" toolbarCaption="Typology rules to apply" type="linkList" xpath="rules" xpathChoiceTarget="rule" xpathEditTarget="rule" zoom="true">
          <input xpath="rule/@label"/>
          <input xpath="rule/@messageType"/>
          <input xpath="rule/@ruleStep"/>
          <input xpath="rule/@order"/>
        </input>
      </container>
      <container img="nms:typorule.png" label="Rules" visibleIf="EV(@type, 'filter')">
        <input choicePath="/tmp/choiceList" filterFormChoice="[@ruleType]='sql'" img="nms:typorule.png" keyName="id" labelFormChoice="Add rules" newEntityFormChoice="true" nolabel="true" promptDeleteLabel="Do you want to remove the selected rules?" selectionPath="/tmp/entityList" toolbarCaption="Typology rules to apply" type="linkList" xpath="rules" xpathChoiceTarget="rule" xpathEditTarget="rule" zoom="true">
          <input xpath="rule/@label"/>
          <input xpath="rule/@messageType"/>
          <input xpath="rule/@ruleStep"/>
          <input xpath="rule/@order"/>
        </input>
      </container>
      <container applicableIf="HasPackage('nms:centralLocal')" img="nms:packages/mini-centralLocal.png" label="Distributed marketing">
        <container colspan="2" label="Typology rule remapping when copied from central to local level" type="frame">
          <input createMode="none" noZoom="true" xpath="localOrgUnit"/>
          <input createMode="none" xpath="centralTypology">
            <sysFilter>
              <condition expr="@id!=$(@id)"/>
              <condition expr="@type=$(@type)"/>
            </sysFilter>
          </input>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Typology rule" maxLabelWidth="50" md5="5CD34FB8A5D02E48BEE1A1B5C850AA26" name="typologyRule" namespace="nms" xpathsToLoad="where/*,where/condition/*,contextFilter/*,         contextFilter/where/*,contextFilter/where/condition/*" xpathsToLoadOpt="businessRanking/deliveryFilter/*,         businessRanking/deliveryFilter/where/*,         businessRanking/deliveryFilter/where/condition/*,         propositionConsistency/propositionFilter/*,         propositionConsistency/propositionFilter/where/*,         propositionConsistency/propositionFilter/where/condition/*" xtkschema="xtk:form">
      <enter>
        <set value="nms:delivery" xpath="/ignored/@deliverySchema"/>
        <if expr="HasPackage('nms:campaignOptimization')">
          <set expr="[businessRanking/@thresholdLink]!=''" xpath="/tmp/@useGrouping"/>
        </if>
        <set value="1" xpath="/ignored/@currentDeliveryId"/>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="previewSQL">
          <form label="Native SQL query generated from the filter" name="form" nothingToEdit="true" nothingToSave="true">
            <enter>
              <soapCall name="BuildQuery" service="xtk:queryDef">
                <param exprIn="." type="DOMElement"/>
                <param type="string" xpathOut="/tmp/@previewSQL"/>
              </soapCall>
            </enter>
            <static label="Native SQL query generated to populate the list." type="help"/>
            <input contentType="sql" nolabel="true" readOnly="true" type="codeEdit" wrap="true" xpath="/tmp/@previewSQL"/>
          </form>
        </container>
        <container name="recipientFilter">
          <input img="nms:recipient.png" label="Edit the query from the targeting dimension..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
            <form label="Edit filtering query" nothingToSave="true" type="wizard">
              <enter>
                <set value="1" xpath="/ignored/@currentFilterStack"/>
                <set value="0" xpath="/ignored/@addFilter"/>
                <set value="" xpath="/ignored/@filterName"/>
              </enter>
              <container colcount="2" desc="Select the type of the target element" firstActivatedIf="count(where) == 0" img="nms:pictoprofile.png" name="typePage" title="Target type">
                <static colspan="2" label="List of restriction filters" type="separator"/>
                <input colspan="2" dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="@schema" xpathWhere="where"/>
              </container>
              <container desc="Please enter the definition of the target element" enabledButtonLabelIf="[/ignored/@currentFilterStack] == true" img="nms:pictoprofile.png" name="targetPage" nextButtonLabel="Refine the target>" nextPage="typePage" title="Target element">
                <container name="targetPageFocus" style="flat" type="notebook">
                  <container label="Criteria">
                    <input xpath="@label"/>
                    <static label="Filter settings" type="separator"/>
                    <input propagateXPathToCtx="/ignored/@currentDeliveryId|/@currentDeliveryId,/ignored/@currentOfferId|/@currentOfferId" type="filterView" xpath="." xpathFilter="/ignored/@filterName" xpathLabel="@label" xpathQueryLabel="humanCond" xpathSchema="@schema"/>
                  </container>
                  <container label="Preview">
                    <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="/ignored/previewList" xpathSchema="@schema" xpathTargetPart="."/>
                  </container>
                </container>
                <leave>
                  <set value="1" xpath="/ignored/@addFilter"/>
                  <set value="" xpath="/ignored/@filterName"/>
                </leave>
              </container>
            </form>
          </input>
          <container type="visibleGroup" visibleIf="humanCond!=''">
            <input fontBold="true" label=" " noBorder="true" readOnly="true" type="memo" xpath="humanCond"/>
          </container>
        </container>
        <container name="deliveryFilter">
          <input img="nms:delivery.png" label="Limit the deliveries..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="deliveryFilter">
            <form label="Query" nothingToSave="true" xpath=".">
              <input name="deliveryFilter" nolabel="true" propagateXPathToCtx="/ignored/@currentDeliveryId|/@currentDeliveryId" schema="nms:delivery" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionlist" xpath="where" xpathCurrentLookupPath="/ignored/delivery/lookupPath" xpathHelp="/ignored/delivery/humanCond">
                <input colSize="15" label=" " xpath="/ignored/delivery/@bool-operator"/>
                <input colSize="30" label="Expression" xpath="/ignored/delivery/@leftExpr"/>
                <input colSize="15" label="Operator" xpath="/ignored/delivery/@operator"/>
                <input colSize="30" label="Value" xpath="/ignored/delivery/@rightExpr"/>
              </input>
              <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/ignored/delivery/humanCond"/>
              <input checkModify="true" label="Generated SQL query..." type="subFormLink">
                <enter name="onClick">
                  <set value="nms:delivery" xpath="@schema"/>
                </enter>
                <form label="Native SQL query generated from the filter" ref="nms:typologyRule:lib/previewSQL/form" xpath="."/>
              </input>
              <leave>
                <set expr="[/ignored/delivery/humanCond]" xpath="humanCond"/>
              </leave>
            </form>
          </input>
          <container type="visibleGroup" visibleIf="[deliveryFilter/humanCond]!=''">
            <input fontBold="true" label=" " noBorder="true" readOnly="true" type="memo" xpath="deliveryFilter/humanCond"/>
          </container>
        </container>
        <container name="propositionFilter">
          <input img="nms:offer.png" label="Limit propositions..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="propositionFilter">
            <form label="Query" nothingToSave="true" xpath=".">
              <input name="propositionFilter" nolabel="true" propagateXPathToCtx="/ignored/@currentOfferId|/@currentOfferId" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionlist" xpath="where" xpathCurrentLookupPath="/ignored/offer/lookupPath" xpathHelp="/ignored/offer/humanCond" xpathSchema="../../@propositionSchema">
                <input colSize="15" label=" " xpath="/ignored/offer/@bool-operator"/>
                <input colSize="30" label="Expression" xpath="/ignored/offer/@leftExpr"/>
                <input colSize="15" label="Operator" xpath="/ignored/offer/@operator"/>
                <input colSize="30" label="Value" xpath="/ignored/offer/@rightExpr"/>
              </input>
              <input fontBold="true" lineCount="4" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/ignored/offer/humanCond"/>
              <input checkModify="true" label="Generated SQL query..." type="subFormLink">
                <enter name="onClick">
                  <set expr="[../../@propositionSchema]" xpath="@schema"/>
                </enter>
                <form label="Native SQL query generated from the filter" ref="nms:typologyRule:lib/previewSQL/form" xpath="."/>
              </input>
              <leave>
                <set expr="[/ignored/offer/humanCond]" xpath="humanCond"/>
              </leave>
            </form>
          </input>
          <container type="visibleGroup" visibleIf="[propositionFilter/humanCond]!=''">
            <input fontBold="true" label=" " noBorder="true" readOnly="true" type="memo" xpath="propositionFilter/humanCond"/>
          </container>
        </container>
      </container>
      <container type="iconbox">
        <container colcount="2" img="xtk:properties.png" label="General">
          <input xpath="@label"/>
          <input xpath="@name"/>
          <input xpath="@ruleType"/>
          <input xpath="@messageType"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@ruleType == 'javascript'">
            <input xpath="@ruleStep"/>
            <input xpath="@level"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@ruleType == 'volume' or @ruleType == 'propositionConsistency'">
            <input colspan="2" xpath="@active"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@ruleType != 'volume' and @ruleType != 'propositionConsistency'">
            <input xpath="@order"/>
            <input xpath="@active"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@ruleType != 'javascript'" xpath="contextFilter">
            <container type="visibleGroup" visibleIf="[../@ruleType] != 'propositionConsistency'">
              <container label="Calculation parameters" type="frame">
                <input xpath="../@forceOnPrepareMessage"/>
                <input xpath="../@validity"/>
                <container type="visibleGroup" visibleIf="[../@validity]>0 and [../@validity]&lt;43200">
                  <static type="warning">Re-arbitration is executed automaticaly during the night: enter a minimum value of 12h.</static>
                </container>
                <static type="help">Enter the maximum period during which targeting can be saved, once the delivery target has been estimated. Once this period is up, all rules are re-applied, either during daily re-arbitration or during personalization. The value 0 indicates that the validity of the rule is permanent.</static>
              </container>
            </container>
            <static label="Application conditions" type="separator"/>
            <container type="visibleGroup" visibleIf="[../@ruleType]=='sql'">
              <input checkedValue="0" label="All deliveries and outlines" type="radioButton" xpath="@contextType"/>
              <input checkedValue="2" label="Depending on the delivery" type="radioButton" xpath="@contextType"/>
              <input applicableIf="HasPackage('nms:campaign')" checkedValue="1" label="Depending on the outline" type="radioButton" xpath="@contextType"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@contextType, 'all')=false OR [../@ruleType]!='sql'">
              <input colspan="2" img="nms:miniatures/mini-query.png" label="Edit the rule application conditions..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
                <form label="Query" nothingToSave="true" xpath=".">
                  <enter>
                    <if expr="[../@ruleType]!='sql'">
                      <set value="2" xpath="@contextType"/>
                    </if>
                    <set expr="Iif([../@ruleType]='propositionConsistency', 'nms:offer', Iif(EV(@contextType,'delivery'), 'nms:delivery', 'nms:deliveryOutline'))" xpath="/ignored/@conditionSchema"/>
                  </enter>
                  <input name="contextFilter" nolabel="true" propagateXPathToCtx="/ignored/@currentOfferId|/@currentOfferId" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionlist" xpath="where" xpathCurrentLookupPath="/ignored/context/lookupPath" xpathHelp="/ignored/context/humanCond" xpathSchema="/ignored/@conditionSchema">
                    <input colSize="15" label=" " xpath="/ignored/context/@bool-operator"/>
                    <input colSize="30" label="Expression" xpath="/ignored/context/@leftExpr"/>
                    <input colSize="15" label="Operator" xpath="/ignored/context/@operator"/>
                    <input colSize="30" label="Value" xpath="/ignored/context/@rightExpr"/>
                  </input>
                  <input fontBold="true" lineCount="3" noBorder="true" nolabel="true" readOnly="true" type="edit" xpath="/ignored/context/humanCond"/>
                  <input checkModify="true" label="Generated SQL query..." type="subFormLink">
                    <enter name="onClick">
                      <set expr="[/ignored/@conditionSchema]" xpath="@schema"/>
                    </enter>
                    <form label="Native SQL query generated from the filter" ref="nms:typologyRule:lib/previewSQL/form" xpath="contextFilter"/>
                  </input>
                  <leave>
                    <set expr="[/ignored/context/humanCond]" xpath="humanCond"/>
                  </leave>
                </form>
              </input>
              <container type="visibleGroup" visibleIf="NodeCount([where/condition])>0">
                <input colspan="2" fontBold="true" label=" " lineCount="4" noBorder="true" readOnly="true" type="memo" xpath="humanCond"/>
              </container>
            </container>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="desc"/>
        </container>
        <container applicableIf="HasPackage('nms:campaignOptimization')" colcount="2" img="nms:businessRanking.png" label="Pressure" visibleIf="@ruleType == 'businessRanking'" xpath="businessRanking">
          <input colspan="2" schema="xtk:schema" type="schemaEdit" xpath="../@schema"/>
          <container colcount="2" colspan="2" label="Sliding period" type="frame">
            <input xpath="@periodRanking"/>
            <input xpath="@boxingUnit"/>
            <input colspan="2" useDesc="true" xpath="@activeForecast"/>
          </container>
          <container colcount="2" colspan="2" label="Maximum number of messages" type="frame">
            <input xpath="@thresholdType"/>
            <container type="visibleGroup" visibleIf="EV(@thresholdType, 'constant')">
              <input label="Quantity" width="7" xpath="@threshold"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="EV(@thresholdType, 'constant') and @threshold=0">
              <static type="warning">Warning: a threshold of zero blocks all messages for the affected period.</static>
            </container>
            <container type="visibleGroup" visibleIf="EV(@thresholdType, 'formula')">
              <input label="Formula" nolabel="false" propagateXPathToCtx="/ignored/@currentDeliveryId|/@currentDeliveryId" type="pathEdit" xpath="thresholdFormula" xpathSchema="../@schema"/>
            </container>
            <input colspan="2" label="Count messages on a linked dimension" type="checkBox" xpath="/tmp/@useGrouping"/>
            <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@useGrouping]">
              <input label="Count link" nolabel="false" type="pathEdit" useLink11Path="true" xpath="@thresholdLink" xpathSchema="../@schema"/>
            </container>
          </container>
          <container colspan="2" label="Default formula for computing delivery weight" type="frame">
            <input label="Weight formula" nolabel="false" propagateXPathToCtx="/ignored/@currentDeliveryId|/@currentDeliveryId" type="pathEdit" xpath="weightFormula" xpathSchema="../@schema"/>
          </container>
          <static colspan="2" label="Messages to count" type="separator"/>
          <container colspan="2" ref="nms:typologyRule:lib/recipientFilter" xpath=".."/>
          <container colspan="2" ref="nms:typologyRule:lib/deliveryFilter" xpath="."/>
        </container>
        <container applicableIf="HasPackage('nms:interaction')" img="nms:offer.png" label="Offer presentation" visibleIf="@ruleType == 'propositionConsistency'" xpath="propositionConsistency">
          <input schema="xtk:schema" type="schemaEdit" xpath="../@schema"/>
          <input required="true" schema="xtk:schema" type="schemaEdit" xpath="../@propositionSchema"/>
          <container label="Sliding period" type="frame">
            <input xpath="@period"/>
          </container>
          <container label="Maximum number of propositions" type="frame">
            <input label="Quantity" width="7" xpath="@threshold"/>
          </container>
          <static label="Propositions to count" type="separator"/>
          <input xpath="@sameChannel"/>
          <input xpath="@offerSet"/>
          <input xpath="@status"/>
          <container ref="nms:typologyRule:lib/recipientFilter" xpath=".."/>
          <container ref="nms:typologyRule:lib/propositionFilter" xpath="."/>
        </container>
        <container img="xtk:javascript.png" label="Code" visibleIf="@ruleType == 'javascript'">
          <input nolabel="true" toolbar="true" type="jstEdit" xpath="code"/>
        </container>
        <container applicableIf="HasPackage('nms:campaignOptimization')" img="nms:periodVolume.png" label="Capacity" visibleIf="@ruleType == 'volume'">
          <input nolabel="true" xpath="volume/@preventOverConsumption"/>
          <input nolabel="true" xpath="volume/@noMaxSpeed"/>
          <container type="visibleGroup" visibleIf="[volume/@preventOverConsumption]">
            <static type="help">For each delivery, enter the formula for specifying which messages need to be saved in case of surplus.</static>
          </container>
          <container type="visibleGroup" visibleIf="[volume/@preventOverConsumption]=false">
            <static type="help">Consumption lines will be generated for the extra volume. Availability lines below are just an approximation.</static>
          </container>
          <container applicableIf="HasPackage('nms:centralLocal')" type="visibleGroup" visibleIf="@messageType==5 or EV(@messageType, 'phone')">
            <container label="Distribution settings for organizational entities." type="frame">
              <input nolabel="true" xpath="volume/@useSubChannels"/>
              <container enabledIf="[volume/@useSubChannels]" type="enabledGroup">
                <input schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
                <input label="Formula" nolabel="false" type="pathEdit" xpath="volume/channelFormula" xpathSchema="@schema"/>
              </container>
            </container>
          </container>
          <input editable="false" form="nms:volumeLineConsumption" formOnAdd="nms:volumeLineScheduler" img="nms:periodVolume.png" nolabel="true" toolbarCaption="Availability lines" type="linklist" xpath="volumeLine" zoom="true" zoomOnAdd="true">
            <input editable="true" xpath="@start"/>
            <input editable="true" xpath="@end"/>
            <input editable="true" xpath="@initial"/>
            <input editable="true" xpath="@consumed"/>
            <input hidden="true" xpath="@id"/>
            <input xpath="@remaining"/>
            <orderBy>
              <node expr="@start"/>
            </orderBy>
          </input>
        </container>
        <container applicableIf="HasPackage('nms:campaignOptimization')" img="nms:miniatures/mini-delivery.png" label="Consumptions" visibleIf="@ruleType == 'volume'">
          <input form="nms:volumeLineConsumption" hideEditButtons="true" img="nms:miniatures/mini-delivery.png" name="consumed" nolabel="true" refresh="true" toolbarCaption="Consumption lines" type="linklist" xpath="volumeConsumed" xpathEditTarget="volumeLine" zoom="true">
            <input xpath="@date"/>
            <input xpath="delivery"/>
            <input xpath="@consumed"/>
            <input hidden="true" xpath="@volumeLine-id"/>
            <orderBy>
              <node expr="@date" sortDesc="true"/>
            </orderBy>
          </input>
        </container>
        <container img="xtk:filter.png" label="Filter" visibleIf="@ruleType == 'sql'">
          <input schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
          <static label="Messages to exclude" type="separator"/>
          <container ref="nms:typologyRule:lib/recipientFilter" xpath="."/>
        </container>
        <container img="nms:typofolder.png" label="Typologies">
          <input choicePath="/tmp/choiceList" img="nms:typofolder.png" keyName="id" labelFormChoice="Add typologies" newEntityFormChoice="true" nolabel="true" promptDeleteLabel="Do you want to remove the rule from the selected typologies?" selectionPath="/tmp/entityList" toolbarCaption="Typologies applying the rule" type="linkList" xpath="typologies" xpathChoiceTarget="typology" xpathEditTarget="typology" zoom="true">
            <input xpath="typology/@label"/>
            <input xpath="typology/desc"/>
          </input>
        </container>
        <container applicableIf="HasPackage('nms:centralLocal')" img="nms:packages/mini-centralLocal.png" label="Distributed marketing" visibleIf="@ruleType != 'propositionConsistency'">
          <container colspan="2" label="Typology rule remapping when copied from central to local level" type="frame">
            <input createMode="none" noZoom="true" xpath="localOrgUnit"/>
            <input createMode="none" xpath="centralTypologyRule">
              <sysFilter>
                <condition expr="@id!=$(@id)"/>
                <condition expr="@ruleType=$(@ruleType)"/>
                <condition expr="@messageType=$(@messageType)"/>
                <condition expr="[@localOrgUnit-id]=0"/>
              </sysFilter>
            </input>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="nms:group32.png" label="List-purge wizard" md5="3928329BD9B47EC30E0ADF00337F452B" name="clearGroup" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Click 'Start' to launch the job." name="finish" title="Purge list">
        <enter>
          <set value="0" xpath="properties/progress/@current"/>
          <set value="1" xpath="properties/progress/@max"/>
          <set value="true" xpath="@doNotPersist"/>
        </enter>
        <value fontBold="true" label="List" xpath="userArgs/@_cs"/>
        <container type="jobProgressContainer">
          <soapCall name="ClearGroup" service="nms:recipient">
            <param exprIn="[/userArgs/group]" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="xtk:massUpdate32.png" label="Folder cleanup wizard" md5="069AD0F6F6EEA4B5B4CFD4F7E8CFD30B" name="clearRcpFolder" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <container desc="Click 'Start' to launch the job." name="finish" title="Purge folder">
        <enter>
          <set value="0" xpath="properties/progress/@current"/>
          <set value="1" xpath="properties/progress/@max"/>
          <set value="true" xpath="@doNotPersist"/>
        </enter>
        <value fontBold="true" label="Folder" xpath="userArgs/@_cs"/>
        <container type="jobProgressContainer">
          <soapCall name="ClearFolder" service="nms:recipient">
            <param exprIn="[/userArgs/folder]" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form editionMode="dialog" entity-schema="nms:delivery" entitySchema="xtk:form" img="xtk:form.png" label="Delivery" maxLabelWidth="50" md5="9F7338538CFDCF3017DA6DC0C3AAB1CC" name="delivery" namespace="nms" readOnlyExpr="[/tmp/@readOnly]" xpathsToLoad="@mapping-id,desc,@folder-id,@folderProcess-id,@internalName,@state,         @isModel,content/*,targets/*,targets/fileFormat/*,         targets/deliveryFile/*,targets/proofFile/*,forecast/*,         advancedParameters/*,scheduling/*,scenario/*,execution/*,output/*,         tracking/*,properties/@deliveryState,properties/@toDeliver,         properties/@midRemoteId,properties/@midAccountUsedName,         properties/@midAccountUsedCs,properties/@FCPid,properties/@FCPLastNum,         @deliveryProvider-id,typology,typology/@id,typology/@IPAffinity,         @typology-id,fcpParameters/*,FCPSeed/*,variables/*,folder,folder/@id,         folderProcess,folderProcess/@id,mapping/*,deliveryProvider,         deliveryProvider/@id,deliveryProvider/@messageType,         deliveryProvider/@deliveryMode,deliveryProvider/@account,         deliveryProvider/@mobileConnector,deliveryProvider/@active,         deliveryProvider/@label,mailParameters/*,ruleFilter/*,typologyFilter/*,         output/*,output/extraction/source/select/*,@deliveryCode,@mirrorURL,         @priority,@contentModTime,@useDce,@useAEM,@contentEditingMode" xpathsToLoadOpt="@coupon-id,coupon,coupon/@id,coupon/@code,coupon/@type,         measure/*,validation/*,@maxPropositionCount,@offerThemes,offerCategory,         offerCategory/@id,@offerCategory-id,offerAnonymousCategory,offerAnonymousCategory/@id,@offerAnonymousCategory-id,@useTargetOffers,@offerSpace-id,         offerSpace,offerSpace/@id,offerSpace/@disablePropositionStorage,offerSpace/env/@id,offerSpace/@anonymousFallback,         offerSpace/env/@propositionSchema,offerSpace/representationFields/*,         offerSpace/rendering/@useHtmlFunction,offerSpace/rendering/@useTextFunction,         deliveryOutline/@label,         deliveryOutline/dlvOutlineItem/*,operation/@id,         operation/@linkedOperation-id,         operation/parameter/@useLinkedDeliveryValidation,operation/@owner-id,         @operation-id,operation/parameter/@useMeasure,hypothesis/*,         operation/parameter/@useBudget,operation/parameter/@useLandingPage,operation/parameter/@useValidation,         supplier/@deliveryModel-id,@targetAssignee-id,targetAssignee,         @contentAssignee-id,contentAssignee,@budgetAssignee-id,budgetAssignee,         @extractionAssignee-id,extractionAssignee,budgetParameters/*,         seedMember/*,output/seedList/*,publishing,outlineRuleFilter/*,         outlineTypologyFilter/*,volume/*,volume/rule/*,@targetStatus,         @contentStatus,@budgetStatus,@extractionStatus,@sandboxStatus,         smsParameters/*,@workflow-id,@linkedDelivery-id,linkedDelivery/*,         @landingPage-id,landingPage/*,document/*,linkedDelivery/mapping/*,triggerMessage/*,         @webAnalyticsAccount-id,webAnalyticsAccount/*,webAnalytics/*,@cmsAccount-id,cmsAccount/*,remoteContent/*,         @currentOrderId" xtkschema="xtk:form">
      <enter>
        <if expr="HasPackage('nms:campaign')">
          <if expr="[@operation-id]!=0 and ([operation/parameter/@useBudget]=='' and [operation/parameter/@useValidation]=='')">
            <set value="nms:operation" xpath="/ignored/queryDefInit/@schema"/>
            <set value="get" xpath="/ignored/queryDefInit/@operation"/>
            <set value="[parameter/@useBudget]" xpath="/ignored/queryDefInit/select/node[1]/@expr"/>
            <set value="[parameter/@useValidation]" xpath="/ignored/queryDefInit/select/node[2]/@expr"/>
            <set expr="'@id='+[@operation-id]" xpath="/ignored/queryDefInit/where/condition/@expr"/>
            <soapCall name="ExecuteQuery" service="xtk:queryDef">
              <param exprIn="[/ignored/queryDefInit]" type="DOMDocument"/>
              <param type="DOMDocument" xpathOut="/ignored/tmp/operationQuery"/>
            </soapCall>
            <set expr="[/ignored/tmp/operationQuery/parameter/@useBudget]" xpath="/ignored/tmp/parameter/@useBudget"/>
            <set expr="[/ignored/tmp/operationQuery/parameter/@useValidation]" xpath="/ignored/tmp/parameter/@useValidation"/>
          </if>
        </if>
        <if expr="[/delivery/mapping/@id]=0 AND [@mapping-id]!=0 AND [@mapping-id]!=''">
          <set value="nms:deliveryMapping" xpath="/ignored/queryDefMapping/@schema"/>
          <set value="get" xpath="/ignored/queryDefMapping/@operation"/>
          <set value="[@id]" xpath="/ignored/queryDefMapping/select/node[1]/@expr"/>
          <set value="@name" xpath="/ignored/queryDefMapping/select/node[2]/@expr"/>
          <set value="@label" xpath="/ignored/queryDefMapping/select/node[3]/@expr"/>
          <set value="@schema" xpath="/ignored/queryDefMapping/select/node[4]/@expr"/>
          <set value="@email" xpath="/ignored/queryDefMapping/select/node[5]/@expr"/>
          <set value="@fax" xpath="/ignored/queryDefMapping/select/node[6]/@expr"/>
          <set value="@sms" xpath="/ignored/queryDefMapping/select/node[7]/@expr"/>
          <set value="@paper" xpath="/ignored/queryDefMapping/select/node[8]/@expr"/>
          <set value="@phone" xpath="/ignored/queryDefMapping/select/node[9]/@expr"/>
          <set value="@agency" xpath="/ignored/queryDefMapping/select/node[10]/@expr"/>
          <set value="@format" xpath="/ignored/queryDefMapping/select/node[11]/@expr"/>
          <set value="@blackListEmail" xpath="/ignored/queryDefMapping/select/node[12]/@expr"/>
          <set value="@blackListSms" xpath="/ignored/queryDefMapping/select/node[13]/@expr"/>
          <set value="@blackListPhone" xpath="/ignored/queryDefMapping/select/node[14]/@expr"/>
          <set value="@blackListFax" xpath="/ignored/queryDefMapping/select/node[15]/@expr"/>
          <set value="@blackListPaper" xpath="/ignored/queryDefMapping/select/node[16]/@expr"/>
          <set value="@blackListAgency" xpath="/ignored/queryDefMapping/select/node[17]/@expr"/>
          <set value="@externalId" xpath="/ignored/queryDefMapping/select/node[18]/@expr"/>
          <set value="@recipientLink" xpath="/ignored/queryDefMapping/select/node[19]/@expr"/>
          <set value="@targetSchema" xpath="/ignored/queryDefMapping/select/node[20]/@expr"/>
          <set value="@countryCode" xpath="/ignored/queryDefMapping/select/node[21]/@expr"/>
          <set value="[storage/@broadLogSchema]" xpath="/ignored/queryDefMapping/select/node[22]/@expr"/>
          <set value="[storage/@exclusionType]" xpath="/ignored/queryDefMapping/select/node[23]/@expr"/>
          <set value="[storage/@broadLogExclSchema]" xpath="/ignored/queryDefMapping/select/node[24]/@expr"/>
          <set value="[storage/@trackingLogSchema]" xpath="/ignored/queryDefMapping/select/node[25]/@expr"/>
          <set value="[storage/extraField/@dstXPath]" xpath="/ignored/queryDefMapping/select/node[26]/@expr"/>
          <set value="[storage/extraField/@srcExpr]" xpath="/ignored/queryDefMapping/select/node[27]/@expr"/>
          <set value="[.]" xpath="/ignored/queryDefMapping/select/node[28]/@expr"/>
          <set value="@_cs" xpath="/ignored/queryDefMapping/select/node[28]/@alias"/>
          <set expr="'@id=' + [@mapping-id]" xpath="/ignored/queryDefMapping/where/condition/@expr"/>
          <soapCall name="ExecuteQuery" service="xtk:queryDef">
            <param exprIn="[/ignored/queryDefMapping]" type="DOMDocument"/>
            <param type="DOMDocument" xpathOut="mapping"/>
          </soapCall>
        </if>
        <set value="false" xpath="/ignored/@limitEdition"/>
        <set value="delivery-id" xpath="/tmp/@seedListKey"/>
        <set value="nms:delivery" xpath="/ignored/@schema"/>
        <set expr="[scheduling/@extraction]" xpath="/ignored/@extraction"/>
        <set value="0" xpath="/ignored/@hasParentDelivery"/>
        <if expr="[/ignored/@operationId]=''">
          <set value="0" xpath="/ignored/@operationId"/>
        </if>
        <if expr="HasPackage('nms:campaign')">
          <set expr="[@workflow-id]" xpath="/ignored/@workflow-id"/>
          <set expr="[@budget-id]" xpath="/ignored/@budgetId"/>
          <set expr="[budgetParameters/@estimatedCost]" xpath="/ignored/@estimatedCost"/>
          <set expr="[budgetParameters/@realCost]" xpath="/ignored/@realCost"/>
          <set expr="[budgetParameters/@commitmentLevel]" xpath="/ignored/@commitmentLevel"/>
          <set value="false" xpath="/ignored/@calculateBudget"/>
          <set expr="[/ignored/tmp/parameter/@useValidation] or [operation/parameter/@useValidation]" xpath="/ignored/@useValidation"/>
          <set expr="iif ([/ignored/tmp/@linkedOperation-id] != '', [/ignored/tmp/@linkedOperation-id], [operation/@linkedOperation-id])" xpath="/ignored/@linkedOperation-id"/>
          <set expr="@isModel" xpath="/ignored/@isModel"/>
          <set expr="Iif([@linkedDelivery-id]!=0, 1, 0)" xpath="/ignored/@hasParentDelivery"/>
          <set value="0" xpath="/ignored/@addFilterRule"/>
          <set value="0" xpath="/ignored/@addReminder"/>
          <set value="1" xpath="/ignored/@nbRemaCalculationLines"/>
          <if expr="HasPackage('nms:response')">
            <set expr="[/ignored/tmp/parameter/@useMeasure] or [operation/parameter/@useMeasure]" xpath="/ignored/@useMeasure"/>
            <set expr="[budgetParameters/@totalMargin]" xpath="/ignored/@totalMargin"/>
            <set expr="[budgetParameters/@totalRealized]" xpath="/ignored/@totalRealized"/>
          </if>
          <if expr="[validation/@assignEdition] and HasNamedRight('admin')=false">
            <soapCall name="CheckValidationAccess" service="nms:operation">
              <param exprIn="validation" type="DOMElement"/>
              <param exprIn="[operation/@owner-id]" type="int"/>
              <param exprIn="6" type="byte"/>
              <param type="boolean" xpathOut="/ignored/@limitEdition"/>
            </soapCall>
          </if>
        </if>
        <if expr="HasPackage('nms:coreInteraction')">
          <set expr="AddOfferViewToBLogSchema([offerSpace/env/@propositionSchema], 'nms:offerView')" xpath="/ignored/@offerViewSchema"/>
          <copyElement xpathDst="/ignored/offerSpace" xpathSrc="/delivery/offerSpace"/>
        </if>
        <if expr="HasPackage('ncm:content')">
          <set expr="[@publishing-name]!='' and [@publishing-namespace]!=''" xpath="/ignored/@hasContent"/>
        </if>
        <if expr="[smsParameters/smsContent]!=''">
          <set expr="[smsParameters/smsContent]" xpath="content/sms/source"/>
          <set value="" xpath="smsParameters/smsContent"/>
        </if>
        <set translatedExpr="'Population resulting from upstream targeting'" xpath="/ignored/@strPopFromWkf"/>
        <set translatedExpr="'Population from a file'" xpath="/ignored/@strPopFromFile"/>
        <set translatedExpr="'Population not defined'" xpath="/ignored/@strPopEmpty"/>
        <set translatedExpr="'Calculated during analysis...'" xpath="/ignored/@strSimulation"/>
        <set translatedExpr="'Provisional analysis'" xpath="/ignored/@strForecast"/>
        <set translatedExpr="'Send a proof'" xpath="/ignored/@strFCP"/>
        <set translatedExpr="'Send to the main target'" xpath="/ignored/@strSend"/>
        <set value="nms:delivery" xpath="/tmp/schema/@delivery"/>
        <set value="nms:extAccount" xpath="/tmp/schema/@provider"/>
        <set expr="Iif([@mapping-id]==0, 'nms:broadLogMid', [mapping/storage/@broadLogSchema])" xpath="/ignored/@dynamicLinkListSchema"/>
        <set expr="Iif([mapping/@name]='mapEventHisto', 'nms:eventHisto', [mapping/@targetSchema])" xpath="/ignored/@dynamicLinkListObjectSchema"/>
        <set expr="Iif([mapping/@name]='mapEventHisto', 'nms:eventHistoPreview', Iif([mapping/@name]='mapRtEvent', 'nms:rtEventPreview', Iif([mapping/@name]='mapBatchEvent', 'nms:batchEventPreview', '')))" xpath="/ignored/@dynamicLinkListObjectForm"/>
        <set value="true" xpath="/ignored/@fileNameEraseLabel"/>
        <if expr="[/ignored/tmp/@targetExtension]!=''">
          <set expr="[/ignored/tmp/@targetExtension]" xpath="@_targetExtensionSchema"/>
        </if>
        <if expr="HasPackage('nms:messageCenter')">
          <set expr="iif (EV([triggerMessage/@publicationStatus], 'notApplicable')=false, 1, 0)" xpath="/ignored/@triggerMessage"/>
          <set expr="iif ([/ignored/@triggerMessage]=0 or NodeCount(FCPSeed)>1, 1, 0)" xpath="/ignored/@showAllSeedMembers"/>
          <if expr="[/ignored/@triggerMessage]">
            <set expr="@messageType" xpath="/ignored/@messageType"/>
            <if expr="NodeCount(FCPSeed)=0">
              <set translatedExpr="'New'" xpath="FCPSeed/@label"/>
              <set expr="GetOption('XtkInstancePrefix')+'SDM'+CounterValue('nmsSeedMember')" xpath="FCPSeed/@internalName"/>
              <set value=" " xpath="FCPSeed/custom_nms_rtEvent/ctx"/>
              <set expr="@id" xpath="FCPSeed/@proof-id"/>
            </if>
          </if>
        </if>
        <if expr="HasPackage('nms:social')">
          <set expr="iif (EV(@messageType, 'facebook', 'twitter'), 1, 0)" xpath="/ignored/@socialMessage"/>
          <set expr="iif (EV(@messageType, 'facebook'), 1, 0)" xpath="/ignored/@facebookMessage"/>
        </if>
        <if expr="HasPackage('nms:mobileApp')">
          <set expr="iif(EV(@messageType, 'ios', 'android'), 1, 0)" xpath="/ignored/@pushMessage"/>
        </if>
        <set expr="[targets/deliveryTarget/@serialization]" xpath="/ignored/deliveryTargetSerialization"/>
        <set expr="[targets/proofTarget/@serialization]" xpath="/ignored/proofTargetSerialization"/>
        <set value="true" xpath="/ignored/@showTracking"/>
        <if expr="HasPackage('nms:webAnalytics')">
          <if expr="[@webAnalyticsAccount-id]!=0">
            <set value="false" xpath="/ignored/@showTracking"/>
          </if>
        </if>
        <if expr="[scheduling/@contactDate]=''">
          <set expr="''" xpath="scheduling/@contactDate"/>
        </if>
        <if expr="HasPackage('nms:campaign')">
          <set expr="iif ([targets/@deliveryLimitExpr]!='', true, false)" xpath="/tmp/@hasDeliveryLimitExpr"/>
          <set expr="iif ([scheduling/@contactDateExpr] != '' or [scheduling/@extractionExpr] != '', true, false)" xpath="/tmp/@hasDateExpr"/>
        </if>
        <if expr="HasPackage('nms:campaign')">
          <set expr="[@operation-id]!=0 AND  NodeCount([deliveryOutline/dlvOutlineItem/offer])>0" xpath="/ignored/@hasDlvOutlineOffers"/>
        </if>
        <if expr="HasPackage('nms:mobileApp')">
          <reset xpath="/tmp/notificationCustomFields"/>
          <reset xpath="/tmp/notificationSounds"/>
          <if expr="NodeExists([content/iosCustomFields/source]) OR NodeExists([content/androidCustomFields/source])">
            <copyElement exprSrc="'content/' + Iif(@messageType=41, 'ios', 'android') + 'CustomFields/source'" xpathDst="/tmp/notificationCustomFields"/>
          </if>
          <if expr="NodeExists([content/iosAvailableSounds/source]) OR NodeExists([content/androidAvailableSounds/source])">
            <copyElement exprSrc="'content/' + Iif(@messageType=41, 'ios', 'android') + 'AvailableSounds/source'" xpathDst="/tmp/notificationSounds"/>
          </if>
        </if>
        <set expr="Iif(@useDce, 1, Iif(HasPackage('nms:aemIntegration') and @useAEM, 2, 0))" xpath="/delivery/@contentEditingMode"/>
        <set expr="'false'" xpath="/ignored/@isAEMContent"/>
        <set expr="'false'" xpath="/ignored/@isLinkedToContent"/>
        <if expr="HasPackage('nms:aemIntegration')">
          <set expr="Iif([/delivery/@contentEditingMode]=2, 'true', 'false')" xpath="/ignored/@isAEMContent"/>
          <set expr="Iif([/delivery/@contentEditingMode]=2 and [remoteContent/@remotePath] != '', 'true', 'false')" xpath="/ignored/@isLinkedToContent"/>
        </if>
      </enter>
      <container name="menuBuilder">
        <container menuId="deliveryMenuBuilder" name="deliveryMenuBuilder" type="deliveryMenuBuilder">
          <form label="Selection of a field of the target" name="selectTargetDlg" nothingToSave="true">
            <enter>
              <set expr="[/delivery/mapping/@schema]" xpath="/tmp/customSelect/@schema"/>
            </enter>
            <container showCollections="true" type="customizeSelect" xpath="/tmp/customSelect/@schema" xpathName="@label" xpathOut="@cmd"/>
            <container type="visibleGroup" visibleIf="![/tmp/@isIncludeView]">
              <container ref="nms:delivery:lib/editTargetQuery"/>
            </container>
          </form>
          <form label="Select a field of the recipient" name="selectRecipientDlg" nothingToSave="true">
            <container showCollections="true" type="customizeSelect" xpath="/tmp/schema/@recipient" xpathName="@label" xpathOut="@cmd"/>
            <container type="visibleGroup" visibleIf="![/tmp/@isIncludeView]">
              <container ref="nms:delivery:lib/editRecipientQuery"/>
            </container>
          </form>
          <form label="Selection of a property of the delivery" name="selectDeliveryDlg" nothingToSave="true">
            <container schema="nms:delivery" type="customizeSelect" xpathOut="@cmd"/>
          </form>
          <form label="Select a routing account property" name="selectProviderDlg" nothingToSave="true">
            <container objectName="provider" schema="nms:extAccount" type="customizeSelect" xpathOut="@cmd"/>
          </form>
          <form colcount="2" label="Insert a barcode" name="insertBarcode" nothingToSave="true" xpath="/tmp/barcode/">
            <enter>
              <set value="QRCode" xpath="/tmp/barcode/@type"/>
              <set value="1" xpath="/tmp/barcode/@scale"/>
              <set value="100" xpath="/tmp/barcode/@height"/>
              <set value="100" xpath="/tmp/barcode/@width"/>
              <set value="H" xpath="/tmp/barcode/@errCorr"/>
              <set value="23" xpath="/tmp/barcode/@errPercent"/>
              <set value="30" xpath="/tmp/barcode/@margin"/>
            </enter>
            <input colspan="2" enum="nms:common:barcodeType" label="Type" type="sysenum" xpath="@type"/>
            <input colspan="2" label="Value" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="@valueExpr"/>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type!='QRCode' AND @type!='AZTEC'">
              <input enum="nms:common:barcodeScale" label="Scale" type="sysenum" xpath="@scale"/>
              <input label="Height" type="number" xpath="@height"/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type='QRCode'">
              <input colspan="2" enum="nms:common:qrcodeErrCorr" label="Error correction" type="sysenum" xpath="@errCorr"/>
              <input label="Width" type="number" xpath="@height"/>
              <input label="Height" type="number" xpath="@width"/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type='AZTEC'">
              <input desc="Error correction percentage" label="Error correction (%)" maxValue="95" minValue="5" type="number" xpath="@errPercent"/>
              <input label="Width" minValue="0" type="number" xpath="@height"/>
              <input digitCount="2" label="Scale" minValue="0" type="number" xpath="@scale"/>
              <input checkedValue="Binary" label="Binary format" type="checkbox" unCheckedValue="UTF-8" xpath="@encoding"/>
            </container>
          </form>
          <form colcount="1" label="Insert an image served by Adobe Target" name="insertTargetImage" nothingToSave="true" xpath="/tmp/targetImage/">
            <input label="Default image" required="true" type="string" xpath="@defaultUrl"/>
            <input applicableIf="HasPackage('nms:aemIntegration') OR (HasPackage('nms:macIntegration') and IsIMSLoggedIn())" img="xtk:upload.png" label="Select a shared asset " prebuildSubForm="false" type="subFormLink" visibleIf="@useAEM=1 OR HasPackage('nms:macIntegration')" xpath=".">
              <form disableExplicitSave="true" label="Select a shared asset " xpath=".">
                <input sessionToken="true" type="aemPicker" xpath="@defaultUrl"/>
              </form>
            </input>
            <input label="Target location (rawbox)" required="true" type="string" xpath="@rawMboxName"/>
            <input label="Additional decision parameters" type="list" xpath="additionalparameters">
              <input label="Name" xpath="@label"/>
              <input label="Select" type="subFormLink" xpath="@value">
                <form name="selectTargetRecipient" nothingToSave="true">
                  <container schema="nms:recipient" showCollections="true" type="customizeSelect" xpathOut="."/>
                </form>
              </input>
            </input>
            <leave>
              <check expr="@defaultUrl!=''">
                <error>Default image is not specified</error>
              </check>
              <check expr="@rawMboxName!=''">
                <error>The Target location (rawbox) is not specified</error>
              </check>
            </leave>
          </form>
          <form applicableIf="HasPackage('nms:purl')" label="Insert a link to a Microsite (pURL)" name="insertPurl" nothingToSave="true" xpath="/tmp/purl">
            <enter>
              <reset xpath="/tmp/purl"/>
              <set value="0" xpath="/tmp/purl/@type"/>
            </enter>
            <static img="nms:circle-one.png" label="Please select a link to a Microsite"/>
            <container defaultColumns="webApp,[.],@name" exprOut1="@name" exprOut2="@url" schema="nms:purl" setOnClick="true" sharedUserConfig="true" type="navTreeEntityList" xpath="." xpathOut1="@name" xpathOut2="@url">
              <sysFilter>
                <condition enabledIf="$(/delivery/scheduling/@contactDate)!=''" expr="[webApp/@startDate]='' OR [webApp/@startDate] &lt;= #$noescaping(/delivery/scheduling/@contactDate)#"/>
                <condition enabledIf="$(/delivery/scheduling/@contactDate)!=''" expr="[webApp/@endDate]='' OR [webApp/@endDate] >= #$noescaping(/delivery/scheduling/@contactDate)#"/>
                <condition expr="@isModel=0"/>
                <condition expr="[webApp/@appState]=10"/>
              </sysFilter>
            </container>
            <static img="nms:circle-two.png" label="Specify the link format in the delivery"/>
            <input checkedValue="0" label="Enter the label of the link" type="radioButton" xpath="/tmp/purl/@type"/>
            <input checkedValue="1" label="Use the URL as a link label" type="radioButton" xpath="/tmp/purl/@type"/>
            <input checkedValue="2" label="Insert the link without activating it" type="radioButton" xpath="/tmp/purl/@type"/>
            <container type="visibleGroup" visibleIf="[/tmp/purl/@type]=0">
              <input label="Link label" required="true" xpath="@urlLabel"/>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/purl/@type]=1">
              <static type="warning">This option may alter message deliverability: their content may be considered fraudulent.</static>
            </container>
            <leave>
              <if expr="[/tmp/purl/@type]=0">
                <check expr="@urlLabel!=''">
                  <error>Please enter the label of the link.</error>
                </check>
              </if>
              <if expr="[/tmp/purl/@type]=1">
                <set expr="[/tmp/purl/@url]" xpath="/tmp/purl/@urlLabel"/>
              </if>
              <if expr="[/tmp/purl/@type]=2">
                <set value="" xpath="/tmp/purl/@urlLabel"/>
              </if>
              <check expr="[/tmp/purl/@name]!=''">
                <error>Please select a Microsite.</error>
              </check>
            </leave>
          </form>
          <form label="Select a personalization block" name="selectIncDlg" nothingToSave="true">
            <container defaultColumns="@label,@name" exprOut1="@name" exprOut2="@label" nodeModel="nmsIncludeView" schema="nms:includeView" sharedUserConfig="true" type="navTreeEntityList" xpath="." xpathOut1="@name" xpathOut2="@label">
              <sysFilter>
                <condition expr="@visible=1 and @contentType IN (0,1)"/>
              </sysFilter>
            </container>
            <input label="Include the HTML source code of the block" type="checkBox" xpath="/ignored/customizeBtnOut/subForm/@inlineMode"/>
          </form>
          <form label="Option selection" name="selectOptDlg" nothingToSave="true">
            <container defaultColumns="@name,@dataType,desc" exprOut1="@name" schema="xtk:option" sharedUserConfig="true" type="navTreeEntityList" xpath="." xpathOut1="@name"/>
          </form>
        </container>
      </container>
      <container name="toolbar" type="visibleGroup" visibleIf="false">
        <input img="nl:smallcalendar.png" insertAfter="" label="Scheduling" name="planning" prebuildSubForm="false" type="flatSubFormButton" visibleIf="[/ignored/@dlvNotReady]='' and [/delivery/@FCP]=0 and [/ignored/@hasParentDelivery]!=1 and [/ignored/@limitEdition]=false and EV([/delivery/@deliveryMode], 'external')=false and [/ignored/@triggerMessage]!=1 and EV([/delivery/@deliveryMode], 'descriptive')=false">
          <form label="Scheduling" maxLabelWidth="50" readOnlyExpr="[/tmp/@readOnly]">
            <enter>
              <set expr="([scheduling/@contactDate]!=## or [/ignored/@contactDateExpr]!='') AND [scheduling/@delayed]=0" xpath="/ignored/@activeForecast"/>
              <set expr="[scheduling/@contactDate]" xpath="/ignored/@contactDate"/>
              <set expr="iif ([scheduling/@validationMode]='manual', true, false)" xpath="/tmp/@validationMode"/>
              <switch>
                <case expr="[/ignored/@activeForecast]">
                  <set value="2" xpath="/tmp/@planningType"/>
                </case>
                <case expr="[scheduling/@delayed]">
                  <set value="1" xpath="/tmp/@planningType"/>
                </case>
                <default>
                  <set value="0" xpath="/tmp/@planningType"/>
                </default>
              </switch>
            </enter>
            <input checkedValue="0" label="No scheduling (no contact date)" nolabel="true" type="radioButton" xpath="/tmp/@planningType"/>
            <input checkedValue="2" label="Schedule delivery (no automatic execution)" nolabel="true" type="radioButton" xpath="/tmp/@planningType"/>
            <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'descriptive')=false">
              <input checkedValue="1" label="Schedule delivery (automatic execution when the scheduled date is reached)" nolabel="true" type="radioButton" xpath="/tmp/@planningType"/>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/@planningType]=1">
              <container img="nms:calendar-large.png" label="Postpone the delivery" type="frame">
                <container colspan="2" ref="nms:delivery:lib/dateSchedulingDef"/>
                <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'descriptive')=false and EV(@deliveryMode, 'external')=false">
                  <input label="Confirm the delivery before sending" type="checkbox" xpath="/tmp/@validationMode"/>
                </container>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/@planningType]=2">
              <container img="nms:calendar-large.png" label="Provisional analysis" type="frame">
                <container colspan="2" ref="nms:delivery:lib/dateSchedulingDef"/>
              </container>
            </container>
            <leave>
              <if expr="HasPackage('nms:campaign')">
                <check expr="[scheduling/@extraction] != '' or ([/tmp/@hasDateExpr] and [/ignored/@extractionExpr] != '') or [scheduling/@delayExtraction]=0">
                  <error>An extraction date is necessary for the extraction wait period to be applied to it.</error>
                </check>
              </if>
              <if expr="EV(@deliveryMode, 'descriptive')=false and [/tmp/@planningType]=2 AND [/ignored/@operationId]=0 AND EV(@state, 'targetPrepPending', 'targetReady', 'preparationError')=false">
                <set expr="EVal(@state, 'targetPrepPending')" xpath="@state"/>
              </if>
              <if expr="EV(@deliveryMode, 'descriptive')=false and [/tmp/@planningType]=1">
                <if expr="[/tmp/@validationMode]=true">
                  <set value="manual" xpath="scheduling/@validationMode"/>
                </if>
                <if expr="[/tmp/@validationMode]=false">
                  <set value="auto" xpath="scheduling/@validationMode"/>
                </if>
              </if>
              <if expr="[/tmp/@planningType]=0">
                <set value="" xpath="scheduling/@contactDate"/>
                <set value="0" xpath="scheduling/@delayed"/>
              </if>
              <if expr="[/tmp/@planningType]=1">
                <set value="1" xpath="scheduling/@delayed"/>
                <check expr="@isModel or ([/tmp/@hasDateExpr] and [/ignored/@contactDateExpr] != '') or ([scheduling/@contactDate] != '' and ([scheduling/@delayed]=false or [/ignored/@contactDate]==[scheduling/@contactDate] or [scheduling/@contactDate]>=GetDate()))">
                  <error>The start date must be later than the current date.</error>
                </check>
              </if>
              <if expr="[/tmp/@planningType]=2">
                <if expr="EV(@deliveryMode, 'descriptive')=false">
                  <set value="0" xpath="scheduling/@delayed"/>
                </if>
                <check expr="@isModel or ([/tmp/@hasDateExpr] and [/ignored/@contactDateExpr] != '') or ([scheduling/@contactDate] != '' and ([/ignored/@contactDate]==[scheduling/@contactDate] or [scheduling/@contactDate]>=GetDate()))">
                  <error>The contact date must be later than the current date.</error>
                </check>
              </if>
              <if expr="[scenario/@setDirectDates]=0 and [scheduling/@contactDate]!=''">
                <set expr="DateAdd([scheduling/@contactDate], [scenario/@validityDuration])" xpath="scheduling/@validityDate"/>
              </if>
            </leave>
          </form>
        </input>
        <input img="nms:bat.png" insertAfter="" label="Send a proof" name="Send" prebuildSubForm="false" type="flatSubFormButton" visibleIf="![/tmp/@readOnly] and [/delivery/@FCP]=0 and [/delivery/@isModel]==false and [/ignored/@dlvNotReady]='' and [/ignored/@dlvNotInDatabase]!='1' and [/delivery/@deliveryMode]!=2 and EV([/delivery/@deleteStatus], 'recycled') = false">
          <form label="Send a proof" nothingToEdit="true" nothingToSave="true">
            <enter>
              <set value="1" xpath="@launchFCP"/>
              <set value="false" xpath="@outOfProcess"/>
              <set value="prepareda" xpath="@module"/>
              <set value="false" xpath="/ignored/@showMappingChoice"/>
              <set value="false" xpath="/ignored/@start"/>
              <set value="false" xpath="/ignored/@enableStart"/>
              <set value="false" xpath="/ignored/@analyzed"/>
              <set expr="iif ((EV(@deliveryMode, 'external') and NodeCount([output/extraction/source/select/node])>0 and (([/ignored/@operationId]=0 and [output/@downloadDestFile]=true) or [output/outputScript]!='')) or ((EV(@deliveryMode, 'external')=false and ([content/html/source]!='' or [content/text/source]!='' or [content/sms/source]!='' or [content/twitterMsg/source]!='' or [/ignored/@facebookMessage]=1 or [content/iosMessage/source]!='' or [content/androidMessage/source]!='' or @messageType > Eval(@messageType, 'other')))), true, false)" xpath="/ignored/@hasDeliveryContent"/>
              <set expr="@state" xpath="/ignored/@deliveryState"/>
              <set value="0" xpath="/ignored/@actionMode"/>
              <if expr="[targets/proofTarget/@nonEmpty]">
                <setModified/>
              </if>
              <if expr="[/ignored/@deliveryState]=''">
                <set expr="@state" xpath="/ignored/@deliveryState"/>
              </if>
              <set value="false" xpath="/ignored/@showTarget"/>
              <set value="nl:arrow_ntf_orange.png" xpath="/ignored/@img"/>
              <if expr="[/delivery/@FCP]=0">
                <set value="" xpath="properties/@FCPid"/>
              </if>
              <set expr="(EV([targets/@targetMode],'file') and [targets/proofFile/name]!='') or [targets/proofTarget/@nonEmpty]" xpath="/ignored/@targetNoEmptyInit"/>
              <reset xpath="/ignored/queryDef"/>
              <set value="nms:delivery" xpath="/ignored/queryDef/@schema"/>
              <set expr="'@id='+[@id]" xpath="/ignored/queryDef/where/condition/@expr"/>
              <set value="getIfExists" xpath="/ignored/queryDef/@operation"/>
              <set value="[properties/@FCPLastNum]" xpath="/ignored/queryDef/select/node[1]/@expr"/>
              <set value="@FCPLastNum" xpath="/ignored/queryDef/select/node[1]/@alias"/>
              <soapCall name="ExecuteQuery" service="xtk:queryDef">
                <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                <param type="DOMDocument" xpathOut="/ignored/queryDefRes"/>
              </soapCall>
              <set expr="[/ignored/queryDefRes/@FCPLastNum]" xpath="properties/@FCPLastNum"/>
            </enter>
            <container backcolor="white" colcount="2" padding-bottom="4" padding-left="8" padding-right="8" padding-top="4">
              <static font-size="16" label="Send a proof" unbound-width="true"/>
              <static img="nms:mail-list.png" rowspan="2" type="image" valign="center"/>
              <static label="Indicate the proof target and start delivery preparation."/>
            </container>
            <static type="separator"/>
            <container ref="nms:delivery:lib/wizSend/pgProof"/>
            <leave>
              <if expr="[/ignored/@deliveryState]!=@state">
                <set expr="[/ignored/@deliveryState]" xpath="@state"/>
                <set expr="[/ignored/@deliveryState]" xpath="properties/@deliveryState"/>
              </if>
              <set value="0" xpath="/delivery/@launchFCP"/>
              <if expr="EV([/delivery/@deliveryMode], 'external')">
                <if expr="[/ignored/@operationId]!=0">
                  <soapCall name="WakeupTask" service="xtk:workflow">
                    <param exprIn="'supplierMgt'" type="string"/>
                    <param exprIn="''" type="string"/>
                    <param exprIn="'scheduler'" type="string"/>
                  </soapCall>
                </if>
              </if>
            </leave>
          </form>
        </input>
        <input img="nms:sendemail.png" insertAfter="" label="Send" name="Send" prebuildSubForm="false" type="flatSubFormButton" visibleIf="![/tmp/@readOnly] and [/delivery/@deliveryMode]!=2 and ([/delivery/@FCP]=0 or ([/delivery/@FCP]=1 AND [/delivery/@state]=0)) and [/delivery/@isModel]==false and [/ignored/@dlvNotReady]='' and [/delivery/targets/@targetMode]&lt;4 and ([/ignored/tmp/@workflowId]&lt;=0 or [/ignored/@operationId]='' or [/delivery/@FCP]=1) and [/ignored/@limitEdition]=false and [/delivery/@deliveryMode]!=2 and [/ignored/@triggerMessage]!=1 and EV([/delivery/@deleteStatus], 'recycled') = false">
          <form label="Send to the main target" nothingToEdit="true" nothingToSave="true">
            <enter>
              <set value="0" xpath="@launchFCP"/>
              <set expr="[advancedParameters/@outOfProcessMode]" xpath="@outOfProcess"/>
              <set value="prepareda" xpath="@module"/>
              <set value="false" xpath="/ignored/@start"/>
              <set value="false" xpath="/ignored/@enableStart"/>
              <set value="false" xpath="/ignored/@analyzed"/>
              <set value="" xpath="/ignored/@deliveryState"/>
              <set expr="iif ((EV(@deliveryMode, 'external') and NodeCount([output/extraction/source/select/node])>0 and (([/ignored/@operationId]=0 and [output/@downloadDestFile]=true) or [output/outputScript]!='')) or ((EV(@deliveryMode, 'external')=false and ([content/html/source]!='' or [content/pdf/name]!='' or [content/text/source]!='' or [content/sms/source]!='' or [content/twitterMsg/source]!='' or [/ignored/@facebookMessage]=1 or [content/iosMessage/source]!='' or [content/androidMessage/source]!='' or @messageType > Eval(@messageType, 'other')))), true, false)" xpath="/ignored/@hasDeliveryContent"/>
              <set value="false" xpath="/ignored/@showMappingChoice"/>
              <set expr="(EV([targets/@targetMode],'file') and [targets/deliveryFile/name]!='') or [targets/deliveryTarget/@nonEmpty]" xpath="/ignored/@targetNoEmptyInit"/>
              <if expr="@FCP=0">
                <set value="" xpath="properties/@FCPid"/>
              </if>
              <if expr="[targets/deliveryTarget/@nonEmpty]">
                <setModified/>
              </if>
              <set value="2" xpath="/ignored/@actionMode"/>
              <if expr="[/ignored/@hasDeliveryContent] and ([/ignored/@contentStatus]=2 or [/ignored/@useContentValidation]=false) and [/ignored/@useTargetValidation]=false">
                <set value="-1" xpath="/ignored/@actionMode"/>
                <if expr="EV([properties/@deliveryState], 'edition')=false">
                  <if expr="[scheduling/@delayed]">
                    <set value="1" xpath="/ignored/@actionMode"/>
                  </if>
                  <if expr="![scheduling/@delayed]">
                    <set value="0" xpath="/ignored/@actionMode"/>
                  </if>
                </if>
              </if>
              <if expr="[/ignored/@deliveryState]!='' and [/ignored/@deliveryState]!=@state">
                <set expr="[/ignored/@deliveryState]" xpath="@state"/>
                <set expr="[/ignored/@deliveryState]" xpath="properties/@deliveryState"/>
              </if>
              <set value="false" xpath="/ignored/@showTarget"/>
              <set value="nl:arrow_ntf_orange.png" xpath="/ignored/@img"/>
              <set value="false" xpath="/ignored/@showAction"/>
              <set value="nl:arrow_ntf_orange.png" xpath="/ignored/@imgAction"/>
            </enter>
            <container backcolor="white" colcount="2" padding-bottom="4" padding-left="8" padding-right="8" padding-top="4">
              <static font-size="16" label="Send to the main target" unbound-width="true"/>
              <static img="nms:mail-list.png" rowspan="2" type="image" valign="center"/>
              <static label="Indicate the main target and start delivery preparation."/>
            </container>
            <static type="separator"/>
            <container ref="nms:delivery:lib/wizSend/pgTarget"/>
            <leave>
              <if expr="[/ignored/@start] and [/delivery/@launchFCP]=0">
                <reload/>
                <setNotifySaved/>
              </if>
            </leave>
          </form>
        </input>
        <input collection="/delivery/attachment" enabledIf="![/tmp/@readOnly]" form="nms:uploadAttachment" img="nms:attachment.png" label="Attach" prebuildSubForm="false" textAlign="toolTip" type="fileTransferButton" visibleIf="EV([/delivery/@messageType], 'mail') and [/ignored/@dlvNotReady]='' and [/ignored/@limitEdition]=false and [/ignored/@hasParentDelivery]!=1">
          <enter name="onClick">
            <set expr="[/tmp/@uploadFile]" xpath="name"/>
            <set value="normal" xpath="@type"/>
          </enter>
        </input>
        <input img="nms:tracking.png" label="Tracking &amp;&amp; Images" name="tracking" prebuildSubForm="false" textAlign="toolTip" type="flatSubFormButton" visibleIf="[/delivery/mapping/storage/@trackingLogSchema]!='' and [/ignored/@dlvNotReady]='' and EV([/delivery/@deliveryMode], 'external')=false and ([/ignored/@socialMessage]=1 or [/ignored/@pushMessage]=1 or EV([/delivery/@messageType], 'mail') or (EV([/delivery/@messageType], 'sms') and EV([/delivery/smsParameters/@mobileMsgType], 'sms', 'wapPush', 'mms'))) and [/ignored/@limitEdition]=false and [/ignored/@hasParentDelivery]!=1">
          <form label="Tracking &amp; Images" readOnlyExpr="[/tmp/@readOnly]" type="notebook">
            <container label="Tracking">
              <input nolabel="true" xpath="tracking/@enabled"/>
              <container enabledIf="[tracking/@enabled]" type="enabledGroup">
                <container type="visibleGroup" visibleIf="EV(@messageType, 'mail')">
                  <input nolabel="true" xpath="tracking/@openEnabled"/>
                </container>
                <input flatMode="false" type="urlTree" xpath="content"/>
              </container>
            </container>
            <container label="Images" visibleIf="EV([/delivery/@messageType], 'mail') AND GetOption('NmsDelivery_ImagePublishing')!='none'">
              <container colcount="2" xpath="content">
                <input nolabel="true" xpath="@uploadImages"/>
                <container enabledIf="@uploadImages" type="enabledGroup">
                  <input nolabel="true" xpath="@multipartRelated"/>
                </container>
              </container>
              <container colcount="2" enabledIf="[content/@uploadImages]" type="enabledGroup">
                <input colspan="2" flatMode="false" type="ImageSelector" xpath="content/html" xpathMultipart="content/@multipartRelated"/>
                <static colspan="2" label="Error(s):" type="separator"/>
                <input colspan="2" flatMode="false" lineCount="6" name="imageSelectorErrorList" type="LogList"/>
                <input xpath="content/@publicURL"/>
                <static rowspan="2" type="help">If empty, the value defined in the deployment wizard is used.</static>
                <input img="xtk:upload.png" label="Upload the images straightaway..." prebuildSubForm="false" type="subFormLink" xpath="content/html/source">
                  <form label="Upload images" nothingToEdit="true" nothingToSave="true">
                    <container ref="nms:delivery:lib/imageUpload"/>
                  </form>
                </input>
              </container>
            </container>
            <container label="Images" visibleIf="EV([/delivery/@messageType], 'sms') AND EV([/delivery/smsParameters/@mobileMsgType], 'mms') AND GetOption('XtkFileRes_PublicationMode')!='none'" xpath="content">
              <input nolabel="true" xpath="@uploadImages"/>
              <input flatMode="false" type="ImageSelector" xpath="mms"/>
              <static label="Error(s):" type="separator"/>
              <input flatMode="false" lineCount="6" name="imageSelectorErrorList" type="LogList"/>
              <input xpath="@publicURL"/>
              <input img="xtk:upload.png" label="Upload the images straightaway..." prebuildSubForm="false" type="subFormLink" xpath=".">
                <form label="Upload images" nothingToEdit="true" nothingToSave="true">
                  <container ref="nms:delivery:lib/imageUpload"/>
                </form>
              </input>
            </container>
            <container label="Advanced" xpath="tracking">
              <container type="visibleGroup" visibleIf="[/ignored/@showTracking]">
                <static img="nms:tracking.png" label="Tracked-URL calculation formula:"/>
                <input fullToolbar="true" htmlMode="false" name="ctClickFormula" nolabel="true" type="htmlSource" xpath="clickFormula" xpathInsert="/ignored/customizeTrackingClick">
                  <container>
                    <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTrackingClick"/>
                  </container>
                </input>
              </container>
              <static img="nms:tracking.png" label="Open URL computation formula:"/>
              <input fullToolbar="true" htmlMode="false" name="ctOpenFormula" nolabel="true" type="htmlSource" xpath="openFormula" xpathInsert="/ignored/customizeTrackingOpen">
                <container>
                  <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTrackingOpen"/>
                </container>
              </input>
            </container>
          </form>
        </input>
        <input applicableIf="HasPackage('nms:coreInteraction')" img="nms:offer.png" label="Offers" name="offers" prebuildSubForm="false" textAlign="toolTip" type="flatSubFormButton" visibleIf="[/ignored/@dlvNotReady]='' and [/ignored/@limitEdition]=false and EV([/delivery/@deliveryMode], 'descriptive')=false">
          <form label="Offer management" readOnlyExpr="[/tmp/@readOnly]">
            <enter>
              <set expr="Iif(hasPackage('nms:campaign') OR hasPackage('nms:interaction'), @useTargetOffers, 1)" xpath="@useTargetOffers"/>
            </enter>
            <container label="Offer selection" type="frame">
              <container type="visibleGroup" visibleIf="(hasPackage('nms:campaign') OR hasPackage('nms:interaction')) AND ([/ignored/tmp/@workflowId] OR [/ignored/@workflow-id] OR @isModel)">
                <input checkedValue="0" label="Use a call to the offer engine or offers defined in the delivery outline" nolabel="true" type="radioButton" xpath="@useTargetOffers"/>
                <input checkedValue="1" label="Use the offers prepared during targeting" nolabel="true" type="radioButton" xpath="@useTargetOffers"/>
              </container>
              <container maxLabelWidth="200" type="visibleGroup" visibleIf="!@useTargetOffers">
                <input createMode="none" notifyPathList="@defaultCategory-id|/tmp/@defaultCategoryId,@disablePropositionStorage,defaultCategory/@label|/tmp/@defaultCategoryCs,@defaultThemes|/tmp/@defaultThemes" xpath="offerSpace">
                  <enter name="onChange">
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory/@id"/>
                    <set expr="[/tmp/@defaultCategoryCs]" xpath="/tmp/defaultCategory/@_cs"/>
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory"/>
                    <set expr="[/tmp/@defaultThemes]" xpath="@offerThemes"/>
                    <set value="nms:offerSpace" xpath="/ignored/queryDefOfferSpace/@schema"/>
                    <set value="get" xpath="/ignored/queryDefOfferSpace/@operation"/>
                    <set value="[representationFields/@xpath]" xpath="/ignored/queryDefOfferSpace/select/node[1]/@expr"/>
                    <set value="@id" xpath="/ignored/queryDefOfferSpace/select/node[2]/@expr"/>
                    <set value="@name" xpath="/ignored/queryDefOfferSpace/select/node[3]/@expr"/>
                    <set value="[env/@id]" xpath="/ignored/queryDefOfferSpace/select/node[4]/@expr"/>
                    <set value="[env/@name]" xpath="/ignored/queryDefOfferSpace/select/node[5]/@expr"/>
                    <set value="[env/@propositionSchema]" xpath="/ignored/queryDefOfferSpace/select/node[6]/@expr"/>
                    <set value="[.]" xpath="/ignored/queryDefOfferSpace/select/node[7]/@expr"/>
                    <set value="[rendering/@useTextFunction]" xpath="/ignored/queryDefOfferSpace/select/node[8]/@expr"/>
                    <set value="[rendering/@useHtmlFunction]" xpath="/ignored/queryDefOfferSpace/select/node[9]/@expr"/>
                    <if expr="HasPackage('nms:interaction')">
                      <set value="@anonymousFallback" xpath="/ignored/queryDefOfferSpace/select/node[10]/@expr"/>
                    </if>
                    <set expr="'@id='+[/delivery/offerSpace/@id]" xpath="/ignored/queryDefOfferSpace/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/ignored/queryDefOfferSpace]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/ignored/offerSpace"/>
                    </soapCall>
                    <if expr="[/ignored/offerSpace/@id]!=0">
                      <set expr="[/ignored/offerSpace/env/@id]" xpath="/delivery/offerSpace/env/@id"/>
                      <set expr="[/ignored/offerSpace/env/@propositionSchema]" xpath="/delivery/offerSpace/env/@propositionSchema"/>
                    </if>
                    <if expr="[/ignored/offerSpace/@id]=0">
                      <reset xpath="/delivery/offerSpace/env"/>
                    </if>
                    <if expr="[/ignored/@triggerMessage]=1">
                      <if expr="[/ignored/offerSpace/@id]!=0">
                        <soapCall name="GetUrls" service="nms:offerSpace">
                          <param exprIn="[/delivery/offerSpace/@id]" type="int"/>
                          <param type="string" xpathOut="/delivery/triggerMessage/@offerSpaceUrl"/>
                        </soapCall>
                      </if>
                      <if expr="[/ignored/offerSpace/@id]=0">
                        <set expr="''" xpath="/delivery/triggerMessage/@offerSpaceUrl"/>
                      </if>
                      <set expr="@id" xpath="/delivery/triggerMessage/@templateId"/>
                    </if>
                  </enter>
                  <sysFilter>
                    <condition expr="[env/@live]=true"/>
                    <condition expr="@channel=$(@messageType)"/>
                  </sysFilter>
                </input>
                <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="[@offerSpace-id]=0">
                  <static fontBold="true" img="xtk:logmsg.png" type="help">To call upon offer representations within the delivery content, please enter a space.</static>
                </container>
                <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="[@offerSpace-id]!=0">
                  <static fontBold="true" type="help">To activate the offer engine during preparation, please enter the following parameters.</static>
                  <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="![/ignored/@hasDlvOutlineOffers]">
                    <input xpath="offerCategory" xpathRefresh="/tmp/defaultCategory">
                      <sysFilter>
                        <condition expr="(@model ='nmsOfferCategory' AND [@env-id] = $(/ignored/offerSpace/env/@id)) OR ( @model = 'nmsOfferEnv' AND @id = $(/ignored/offerSpace/env/@id))"/>
                      </sysFilter>
                    </input>
                    <input xpath="@offerThemes"/>
                  </container>
                  <container type="visibleGroup" visibleIf="HasPackage('nms:campaign')=false">
                    <input xpath="offerCategory" xpathRefresh="/tmp/defaultCategory">
                      <sysFilter>
                        <condition expr="(@model ='nmsOfferCategory' AND [@env-id] = $(/ignored/offerSpace/env/@id)) OR ( @model = 'nmsOfferEnv' AND @id = $(/ignored/offerSpace/env/@id))"/>
                      </sysFilter>
                    </input>
                    <input xpath="@offerThemes"/>
                  </container>
                  <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="[/ignored/@triggerMessage]=1 AND [/ignored/offerSpace/@anonymousFallback]">
                    <input xpath="offerAnonymousCategory">
                      <sysFilter>
                        <condition expr="@model IN ('nmsOfferCategory', 'nmsOfferEnv')"/>
                      </sysFilter>
                    </input>
                  </container>
                  <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 AND [/ignored/@hasDlvOutlineOffers]==false">
                    <static type="help">If offers were defined in the delivery outline, the category and the themes will not be taken into account. If no category is specified, all the offers in the environment will be eligible. If no theme is specified, all the themes will be eligible.</static>
                  </container>
                  <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]=0">
                    <static type="help">If no category is specified, all offers in the environment will be eligible. If no theme is specified, all themes will be eligible.</static>
                  </container>
                  <container type="visibleGroup" visibleIf="HasPackage('nms:campaign')=false">
                    <static type="help">If no category is specified, all offers in the environment will be eligible. If no theme is specified, all themes will be eligible.</static>
                  </container>
                  <input minValue="0" xpath="@maxPropositionCount"/>
                </container>
              </container>
              <container maxLabelWidth="200" type="visibleGroup" visibleIf="@useTargetOffers">
                <input createMode="none" notifyPathList="@defaultCategory-id|/tmp/@defaultCategoryId,@disablePropositionStorage,defaultCategory/@label|/tmp/@defaultCategoryCs,@defaultThemes|/tmp/@defaultThemes" xpath="offerSpace">
                  <enter name="onChange">
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory/@id"/>
                    <set expr="[/tmp/@defaultCategoryCs]" xpath="/tmp/defaultCategory/@_cs"/>
                    <set expr="[/tmp/@defaultCategoryId]" xpath="/tmp/defaultCategory"/>
                    <set expr="[/tmp/@defaultThemes]" xpath="@offerThemes"/>
                    <set value="nms:offerSpace" xpath="/ignored/queryDefOfferSpace/@schema"/>
                    <set value="get" xpath="/ignored/queryDefOfferSpace/@operation"/>
                    <set value="[representationFields/@xpath]" xpath="/ignored/queryDefOfferSpace/select/node[1]/@expr"/>
                    <set value="@id" xpath="/ignored/queryDefOfferSpace/select/node[2]/@expr"/>
                    <set value="[env/@id]" xpath="/ignored/queryDefOfferSpace/select/node[3]/@expr"/>
                    <set value="[env/@propositionSchema]" xpath="/ignored/queryDefOfferSpace/select/node[4]/@expr"/>
                    <set value="[.]" xpath="/ignored/queryDefOfferSpace/select/node[5]/@expr"/>
                    <set value="[rendering/@useTextFunction]" xpath="/ignored/queryDefOfferSpace/select/node[6]/@expr"/>
                    <set value="[rendering/@useHtmlFunction]" xpath="/ignored/queryDefOfferSpace/select/node[7]/@expr"/>
                    <set expr="'@id='+[/delivery/offerSpace/@id]" xpath="/ignored/queryDefOfferSpace/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/ignored/queryDefOfferSpace]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/ignored/offerSpace"/>
                    </soapCall>
                  </enter>
                  <sysFilter>
                    <condition expr="[env/@live]=true"/>
                    <condition expr="@channel=$(@messageType)"/>
                  </sysFilter>
                </input>
                <input minValue="0" xpath="@maxPropositionCount"/>
                <static type="help">If offers have been defined in the targeting workflow using the "Offer engine" or the "Delivery outline" activity, you can indicate (above) the space as well as the number of offers configured in the activity to get help when entering your delivery content.</static>
              </container>
            </container>
            <static/>
            <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
              <input nolabel="true" xpath="targets/@excludeOnMissingOffer"/>
              <static type="help">Exclusion occurs during targeting if the offers are referenced in the delivery outline or if they are prepared during targeting. \nIt takes place during message personalization if the offers are selected automatically by the offer engine.</static>
            </container>
            <input nolabel="true" xpath="targets/@emptyReprForMissingOffer"/>
            <static type="help">A representation display request cancels sending if no offers are available.\nIf this box is checked, the message is not cancelled, an empty representation will be generated.</static>
            <input expr="Iif(@useTargetOffers, '', AddOfferViewToBLogSchema([offerSpace/env/@propositionSchema], 'nms:offerView'))" type="expr" xpath="/ignored/@offerViewSchema"/>
          </form>
        </input>
        <input img="nms:response.png" label="Delivery measurement" name="measure" prebuildSubForm="false" textAlign="toolTip" type="flatSubFormButton" visibleIf="[/ignored/@dlvNotReady]='' and [/delivery/@FCP]=0 and [/ignored/@limitEdition]=false and EV([/delivery/@deliveryMode], 'descriptive')=false">
          <form label="Delivery measurement" maxLabelWidth="50" readOnlyExpr="false">
            <container ref="nms:delivery:lib/measureROI" xpath="forecast"/>
            <container applicableIf="HasPackage('nms:response')" type="visibleGroup" visibleIf="[/delivery/@operation-id]!=0 and [/delivery/@operation-id]!='' and [/ignored/@useMeasure] and HasPackage('nms:response')">
              <static label="Calculation of effective ROI" type="separator"/>
              <container colspan="2" type="visibleGroup" visibleIf="!@isModel">
                <container ref="nms:operation:lib/hypothesis"/>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="@isModel" xpath="measure">
                <container ref="nms:operation:lib/hypothesis"/>
              </container>
            </container>
          </form>
        </input>
        <input applicableIf="HasPackage('nms:campaign')" img="nms:budget.png" label="Expenses and revenue" prebuildSubForm="true" textAlign="toolTip" type="flatSubFormButton" visibleIf="[/ignored/@dlvNotReady]='' and [/ignored/@useBudget] and [/delivery/@FCP]=0 and ([/ignored/@hasParentDelivery]!=1 or [/ignored/@linkedOperation-id]!=0) and [/ignored/@limitEdition]=false">
          <form label="Expenses and revenue" maxLabelWidth="50" readOnlyExpr="[/tmp/@readOnly]">
            <container ref="nms:delivery:lib/budget"/>
          </form>
        </input>
        <input applicableIf="HasPackage('nms:campaign')" img="nms:document.png" label="Documents" name="document" prebuildSubForm="false" textAlign="toolTip" type="flatSubFormButton" visibleIf="[/delivery/@operation-id]!=0 and [/ignored/@useValidation] and [/ignored/@dlvNotReady]=''">
          <form label="Referenced documents" maxLabelWidth="50" readOnlyExpr="[/tmp/@readOnly]">
            <container ref="nms:plan:lib/document"/>
            <container applicableIf="HasPackage('nms:mrm')" ref="nms:plan:lib/asset"/>
          </form>
        </input>
        <input img="xtk:properties.png" label="Properties" name="advanced" prebuildSubForm="false" type="flatSubFormButton" visibleIf="[/ignored/@dlvNotReady]='' and [/ignored/@limitEdition]=false">
          <form label="Delivery properties" maxLabelWidth="50" readOnlyExpr="[/tmp/@readOnly]" type="notebook">
            <enter>
              <set expr="iif ([scheduling/@validationMode]='manual', true, false)" xpath="/tmp/@validationMode"/>
            </enter>
            <container label="General" propagateConstraints="false">
              <container ref="nms:delivery:lib/general"/>
            </container>
            <container label="Analysis" propagateConstraints="false" visibleIf="EV(@deliveryMode, 'descriptive')=false">
              <container label="Label and code of the delivery" type="frame">
                <input xpath="scenario/@useLabelScript"/>
                <container type="visibleGroup" visibleIf="[scenario/@useLabelScript]">
                  <input label="Label" menuId="deliveryMenuBuilder" options="noRcp" type="scriptEdit" xpath="scenario/labelScript"/>
                </container>
                <input xpath="scenario/@useDeliveryCodeScript"/>
                <container type="visibleGroup" visibleIf="[scenario/@useDeliveryCodeScript]">
                  <input label="Delivery code" menuId="deliveryMenuBuilder" options="noRcp" type="scriptEdit" xpath="scenario/deliveryCodeScript"/>
                </container>
                <input xpath="scenario/@useFolderScript"/>
                <container type="visibleGroup" visibleIf="[scenario/@useFolderScript]">
                  <input label="Folder" menuId="deliveryMenuBuilder" options="noRcp" type="scriptEdit" xpath="scenario/folderScript"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="![/ignored/@operationId] or ([/ignored/@operationId] and EV(@deliveryMode, 'external')=false and [/ignored/@useValidation]=false)">
                <container label="Approval" type="frame">
                  <input xpath="scheduling/@validationMode"/>
                  <container type="visibleGroup" visibleIf="EV([scheduling/@validationMode], 'manual')">
                    <static type="help">User must approve the delivery after the analysis phase so that delivery can start.</static>
                  </container>
                  <container type="visibleGroup" visibleIf="EV([scheduling/@validationMode], 'secure')">
                    <static type="help">Delivery automatically starts if the analysis step does not generate warnings.</static>
                  </container>
                  <container type="visibleGroup" visibleIf="EV([scheduling/@validationMode], 'auto')">
                    <static type="help">Delivery will automatically start at the end of the analysis.</static>
                  </container>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')">
                <container label="Results and behaviors after delivery" type="frame" xpath="output">
                  <input useDesc="true" xpath="@feedbackMode"/>
                </container>
              </container>
              <input xpath="advancedParameters/@outOfProcessMode"/>
              <container type="visibleGroup" visibleIf="[/ignored/@workflow-id]==0 OR [/ignored/@workflow-id]==''">
                <input useDesc="true" xpath="advancedParameters/@showSQL"/>
              </container>
              <container type="visibleGroup" visibleIf="@deliveryMode != 0">
                <input useDesc="true" xpath="content/@ignoreScripts"/>
                <static type="help">JavaScript tags (delimited by &lt;% %&gt; tags) found in contents are not interpreted but left as is in the contents sent.</static>
              </container>
              <container name="broadlogOptions" type="visibleGroup" visibleIf="@FCP=0" xpath="targets">
                <input useDesc="true" xpath="@skipIgnoredLogs"/>
                <container type="visibleGroup" visibleIf="EV(@targetMode, 'database', 'evtDatabase')">
                  <container type="visibleGroup" visibleIf="FieldExists([../mapping/storage/@broadLogSchema], '@externalId')">
                    <input nolabel="false" type="pathEdit" xpath="@externalId" xpathSchema="../mapping/@schema"/>
                    <static colspan="2" label="Overrides the mapping computation formula. The external identifier is computed for each message and saved in the associated delivery log." type="help"/>
                  </container>
                </container>
              </container>
            </container>
            <container applicableIf="HasPackage('nms:webAnalytics')" label="Web Analytics" propagateConstraints="false" visibleIf="HasPackage('nms:webAnalytics') and EV(@deliveryMode, 'descriptive')=false">
              <container label="Tracked URLs" type="frame">
                <input createMode="none" fullLoad="true" notifyPathList="webAnalyticsParams/@partner,webAnalyticsParams/clickFormula" xpath="webAnalyticsAccount">
                  <sysFilter>
                    <condition expr="@type = 8"/>
                    <condition expr="@active = 1"/>
                  </sysFilter>
                </input>
                <static type="help">The URLs tracked in the delivery are enriched based on the formula defined in the Web Analytics account.</static>
              </container>
              <container type="visibleGroup" visibleIf="EV([webAnalyticsAccount/webAnalyticsParams/@partner], 'adobeGenesis')">
                <container label="Delivery settings exchanged with the partner" type="frame">
                  <input xpath="@internalName"/>
                  <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[operation/@id]!=0">
                    <input readOnly="true" xpath="operation/@label"/>
                    <input readOnly="true" xpath="operation/@nature"/>
                  </container>
                  <input xpath="webAnalytics/@tag1"/>
                  <input xpath="webAnalytics/@tag2"/>
                  <input xpath="webAnalytics/@tag3"/>
                  <static type="help">These settings are sent to the partner to enrich Web Analytics reports.</static>
                </container>
              </container>
            </container>
            <container label="Personalization" propagateConstraints="false" visibleIf="( EV([targets/@targetMode],'file')==false or [targets/@noReconciliation]==false ) and [/ignored/@hasParentDelivery]!=1 and [/delivery/@deliveryMode]!=2">
              <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external') == false">
                <container type="visibleGroup" visibleIf="[mapping/@recipientLink] != '' or [mapping/@schema] == 'nms:recipient'">
                  <container ref="nms:delivery:lib/editRecipientQuery"/>
                </container>
                <container type="visibleGroup" visibleIf="( [mapping/@schema] != 'nms:recipient' or [mapping/@recipientLink] != '' )">
                  <container ref="nms:delivery:lib/editTargetQuery"/>
                </container>
              </container>
              <container applicableIf="HasPackage('nms:coupon')" type="visibleGroup" visibleIf="[@coupon-id]!=0">
                <input img="nms:campaign.png" label="Edit the query to load the coupon..." prebuildSubForm="false" type="subFormLink" xpath="/delivery/content/extraCoupon">
                  <form img="nms:pictoprofile.png" label="Edit query to load the coupon" type="wizard">
                    <container desc="Enter the fields of the coupon to load for the personalization." title="Fields of the coupon to load">
                      <enter>
                        <set value="nms:coupon" xpath="/tmp/selectCtrl/in/@schema"/>
                        <set value="/" xpath="/tmp/selectCtrl/in/@startPath"/>
                      </enter>
                      <container extraColumns="@alias" ref="xtk:queryDef:hidden/selectCtrl" showCollections="true" xpath="custom"/>
                    </container>
                    <container desc="Please edit the filtering condition and sort order for each collection link. This is used to limit linked records to load." title="Collection personalization information" visibleIf="NodeExists([custom/conditionLink])" xpath="custom">
                      <input alwaysActive="true" editable="false" img="xtk:xtklinkn.png" name="cc" noEditCollection="true" nolabel="true" prebuildSubForm="true" type="customizeCondition" xpath="conditionLink" xpathSchema="/tmp/schema/@coupon" xpathSelect="select/node" zoom="true">
                        <input xpath="@label"/>
                        <input xpath="@lineCount"/>
                        <input xpath="where/@displayFilter"/>
                        <input xpath="orderBy/@displayOrder"/>
                        <input hidden="true" xpath="@schema"/>
                        <form img="nms:pictoprofile.png" label="Filtering for a collection of personalization information" type="wizard">
                          <container desc="Enter information used to specify how many collection elements you want to keep." name="parameters" title="General parameters">
                            <static type="help">If you know that there is only one collection element that fulfills the filtering condition you will enter,\n
  select the following option (this improves performance by avoiding sub-queries).</static>
                            <input xpath="@singleRow"/>
                            <container enabledIf="!@singleRow" type="enabledGroup">
                              <static type="help">Number of collection elements to return.</static>
                              <input xpath="@lineCount"/>
                            </container>
                            <leave>
                              <if expr="@singleRow">
                                <set value="1" xpath="@lineCount"/>
                              </if>
                            </leave>
                          </container>
                          <container desc="Enter the filtering condition used to specify which collection elements you want to keep." name="where" title="Filter">
                            <container buildQueryXPath="." ref="xtk:queryDef:where"/>
                          </container>
                          <container desc="Specify the sort order used to indicates which lines to keep, when there are more lines eligible than specified previously." name="orderBy" title="Sort" visibleIf="@singleRow == false">
                            <input name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                              <input colSize="20" xpath="@label"/>
                              <input choiceType="sort" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                              <input colSize="15" editable="true" xpath="@sortDesc"/>
                            </input>
                            <input type="help" xpath="/@help"/>
                          </container>
                        </form>
                      </input>
                    </container>
                  </form>
                </input>
              </container>
              <static label="Extra script objects" type="separator"/>
              <container xpath="content">
                <input useDesc="true" xpath="@addExtraObject"/>
                <container type="visibleGroup" visibleIf="@addExtraObject">
                  <input editable="false" nolabel="true" prebuildSubForm="false" type="list" xpath="extraObject" zoom="true" zoomOnAdd="true">
                    <input xpath="@jsName"/>
                    <input xpath="@array"/>
                    <input xpath="@schema"/>
                    <input xpath="@startPath"/>
                    <form label="Extra script object" type="wizard">
                      <container desc="Please specify the schema and the filtering criteria for the object to load." title="Object definition">
                        <input noTransaction="false" schema="xtk:schema" type="schemaEdit" xpath="@schema" xpathStartPath="@startPath"/>
                        <input checkSiblingNodes="true" exprDefault="Iif(@startPath!='/', ExtractRight(@startPath,'/'), ExtractRight(@schema,':'))" type="dlvJsNameEdit" xpath="@jsName"/>
                        <input useDesc="true" xpath="@array"/>
                        <static type="help">This option enables you to retrieve more than one line of data from a JavaScript table.\n
  By default, one single record is kept respecting the sort order.</static>
                        <leave>
                          <if expr="@jsName=''">
                            <set expr="Iif(@startPath!='/', ExtractRight(@startPath,'/'), ExtractRight(@schema,':'))" xpath="@jsName"/>
                          </if>
                        </leave>
                      </container>
                      <container desc="Please specify the fields of the object to load for personalization." name="load" title="Object fields to load" visibleIf="@schema != ''">
                        <enter>
                          <set expr="@schema" xpath="/tmp/selectCtrl/in/@schema"/>
                          <set expr="@startPath" xpath="/tmp/selectCtrl/in/@startPath"/>
                          <set expr="@schema" xpath="custom/@schema"/>
                          <set expr="@startPath" xpath="custom/@startPath"/>
                        </enter>
                        <container extraColumns="@alias" ref="xtk:queryDef:hidden/selectCtrl" showCollections="true" xpath="custom"/>
                      </container>
                      <container desc="Specify the data sort order." name="orderBy" title="Sort">
                        <container type="visibleGroup" visibleIf="@array==false">
                          <static type="help">Specify the sort order used to determine the record to keep if there is more than one candidate.</static>
                        </container>
                        <container colcount="2" type="visibleGroup" visibleIf="@array">
                          <input label="Limit the number of records retrieved to " xpath="@useLineCount"/>
                          <container enabledIf="@useLineCount" type="enabledGroup">
                            <input label=" " xpath="@lineCount"/>
                          </container>
                          <static colspan="2" type="help">Specify sort order for records in the JavaScript table.</static>
                        </container>
                        <input name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathChoiceTarget="@expr" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                          <input colSize="20" xpath="@label"/>
                          <input choiceType="sort" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                          <input colSize="15" editable="true" xpath="@sortDesc"/>
                        </input>
                        <input type="help" xpath="/@help"/>
                      </container>
                      <container desc="Specify below the filtering conditions to use to select the properties of the JavaScript object." name="where" title="Filter">
                        <container style="flat" type="notebook">
                          <container label="Criteria">
                            <container buildQueryXPath="." ref="xtk:queryDef:where"/>
                          </container>
                          <container label="Preview">
                            <input hideEditButtons="true" name="entityPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="." xpathSchema="@schema" xpathTargetPart="."/>
                          </container>
                        </container>
                      </container>
                      <container desc="Please edit the filtering condition and sort order for each collection link. This is used to limit linked records to load." name="extraObjectCustomLinks" title="Collection personalization information" visibleIf="NodeExists([custom/conditionLink])" xpath="custom">
                        <container ref="xtk:exportSource:lib/conditionLinkRef"/>
                      </container>
                    </form>
                  </input>
                </container>
                <static type="help">The extra script objects are loaded during the analysis phase. These objects are the same for all recipients of the delivery.</static>
              </container>
            </container>
            <container colcount="2" label="Typology" propagateConstraints="false" visibleIf="EV(@deliveryMode, 'descriptive')=false">
              <container colspan="2" label="Typology" type="frame">
                <input colspan="2" label="Typology" notifyPathList="@IPAffinity" xpath="typology"/>
                <static colspan="2" type="help">The typology is set of verification rules to be performed on all messages during the analysis phase.</static>
              </container>
              <container applicableIf="HasPackage('nms:campaignOptimization')" colspan="2" label="Pressure parameters" type="frame" xpath="forecast">
                <input xpath="@weightType"/>
                <container type="visibleGroup" visibleIf="EV(@weightType, 'constant')">
                  <input width="7" xpath="@weight"/>
                </container>
                <container type="visibleGroup" visibleIf="EV(@weightType, 'formula')">
                  <input label="Formula" nolabel="false" schemaExpr="GetLinkSchema([/delivery/mapping/@schema], [/delivery/mapping/@recipientLink])" type="pathEdit" xpath="weightFormula"/>
                </container>
                <static type="help">The delivery weight is used to determine delivery priority in 'pressure' typology rules.</static>
                <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[../@operation-id]!=0">
                  <input readOnly="true" xpath="../validation/@sandboxMode"/>
                  <input xpath="../validation/@sandboxModeEnforced"/>
                </container>
                <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[../@operation-id]==0">
                  <input xpath="../validation/@sandboxMode"/>
                </container>
                <container type="visibleGroup" visibleIf="HasPackage('nms:campaign')==false">
                  <input xpath="../validation/@sandboxMode"/>
                </container>
              </container>
              <container applicableIf="HasPackage('nms:campaignOptimization')" colspan="2" label="Capacity settings" type="frame" xpath="volume">
                <input createMode="none" fullLoad="true" img="nms:periodVolume.png" xpath="rule">
                  <sysFilter>
                    <condition expr="@active=1"/>
                    <condition expr="@ruleType='volume'"/>
                    <condition>
                      <condition boolOperator="OR" enabledIf="$(../@messageType)!=''" expr="@messageType=$(../@messageType)"/>
                      <condition expr="@messageType=127"/>
                    </condition>
                  </sysFilter>
                </input>
                <static label="Importance of the recipient" type="separator"/>
                <input label="Formula" nolabel="false" schemaExpr="GetLinkSchema([/delivery/mapping/@schema], [/delivery/mapping/@recipientLink])" type="pathEdit" xpath="weightFormula"/>
                <static type="help">The importance of the recipient is used to determine which recipients are kept when the 'capacity' typology rules are exceeded.</static>
                <container type="visibleGroup" visibleIf="EV([../@messageType], 'phone') or [../@messageType]=5">
                  <static img="nms:phone.png" label="Estimation of used capacity" type="separator"/>
                  <input xpath="@rate"/>
                  <input xpath="@duration"/>
                </container>
              </container>
            </container>
            <container colcount="2" label="Delivery" propagateConstraints="false" visibleIf="@deliveryMode!=0 and EV(@deliveryMode, 'descriptive')=false">
              <container colcount="2" colspan="2" label="Delivery" type="frame">
                <input colspan="2" xpath="@priority"/>
                <input colspan="2" width="7" xpath="advancedParameters/@splitValue"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')==false">
                  <input label="Send using multiple waves" xpath="scheduling/waves/@enabled"/>
                  <container type="visibleGroup" visibleIf="[scheduling/waves/@enabled]">
                    <input label="Define waves..." nolabel="true" prebuildSubForm="true" type="subFormLink">
                      <form label="Waves definition" maxLabelWidth="60" xpath="scheduling/waves">
                        <input checkedValue="0" label="Schedule multiple waves of the same size" type="RadioButton" xpath="@mode"/>
                        <container colcount="2" enabledIf="EV(@mode, 'split')" type="enabledGroup">
                          <input xpath="@splitSize"/>
                          <input xpath="@splitDelay"/>
                        </container>
                        <input checkedValue="1" label="Schedule waves according to a calendar" type="RadioButton" xpath="@mode"/>
                        <container enabledIf="EV(@mode, 'calendar')" type="enabledGroup">
                          <input editable="true" label="Calendar" type="list" xpath="calendar/calendarItem">
                            <input colSize="20" xpath="@start"/>
                            <input colSize="50" xpath="@size"/>
                          </input>
                        </container>
                        <static type="help">Start or Period specifies the delay between the start of two consecutive waves. The size specifies the number of messages in the wave, either as an absolute number or as a percentage.</static>
                        <leave>
                          <soapCall name="ValidateWavesDefinition" service="nms:delivery">
                            <param exprIn="[scheduling/waves]" type="DOMElement"/>
                            <param type="DOMElement" xpathOut="scheduling/waves"/>
                          </soapCall>
                        </leave>
                      </form>
                    </input>
                  </container>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="EV(@messageType, 'mail')">
                  <input xpath="advancedParameters/@verifyMode"/>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="EV(@messageType, 'sms')" xpath="smsParameters">
                  <static label="SMS parameters" type="separator"/>
                  <input menuId="deliveryMenuBuilder" type="scriptEdit" xpath="@sourceAddress"/>
                  <container type="visibleGroup" visibleIf="[../deliveryProvider/@mobileConnector] == 4">
                    <input xpath="@serviceType"/>
                    <input xpath="@mbloxServiceId"/>
                  </container>
                  <input xpath="@smsMode"/>
                  <input xpath="@smsPriority"/>
                  <input xpath="@smsAppType"/>
                  <input maxValue="255" minValue="0" xpath="@maxSmsPerMessage"/>
                  <container type="visibleGroup" visibleIf="[../deliveryProvider/@mobileConnector]>=2">
                    <static label="Character encoding" type="separator"/>
                    <container xpath="../advancedParameters">
                      <input useDesc="true" xpath="@forceCodepage"/>
                      <container type="visibleGroup" visibleIf="@forceCodepage">
                        <input defaultIfInvalid="GSM7" enum="nms:extAccount:smppCharset" noInvalidErr="true" xpath="@codepage"/>
                      </container>
                    </container>
                  </container>
                </container>
              </container>
              <container colspan="2" label="Retries" type="frame">
                <container xpath="mailParameters">
                  <input width="7" xpath="../execution/@retryPeriod"/>
                  <input width="7" xpath="../execution/@maxRetry"/>
                  <static type="help">Retries are performed on messages with errors after the first attempt. A retry is also made each day until the end of the delivery period.</static>
                </container>
              </container>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@messageType, 'mail')">
                <container label="Mail formats" type="frame">
                  <container margin-left="40">
                    <container enabledIf="[mapping/@format] != ''" type="enabledGroup">
                      <input checkedValue="preferences" label="Use recipient preferences" type="RadioButton" xpath="content/@formatSelection"/>
                    </container>
                    <input checkedValue="multipart" label="Let recipient mail client choose the most appropriate format (multipart-alternative)" type="RadioButton" xpath="content/@formatSelection"/>
                    <input checkedValue="text" label="Send all messages in text format (HTML used for the mirror page)" type="RadioButton" xpath="content/@formatSelection"/>
                    <container margin-left="20" type="visibleGroup" visibleIf="EV([content/@formatSelection], 'multipart') and [mapping/@format] != ''">
                      <static img="xtk:logwarn.png">Leave the choice to the email reader of the recipient implies that both versions of the document are sent using the multipart-alternative format.\nThis option then reduces the throughput of the delivery.</static>
                    </container>
                    <container margin-left="20" type="visibleGroup" visibleIf="EV([content/@formatSelection], 'text')">
                      <static img="xtk:logwarn.png">The message will be sent in text format for all recipients. The HTML format is defined for the mirror page only.</static>
                    </container>
                  </container>
                </container>
              </container>
            </container>
            <container label="Validity" propagateConstraints="false" visibleIf="[/delivery/@deliveryMode]!=2">
              <container label="Validity period" type="frame">
                <container type="visibleGroup" visibleIf="![scenario/@setDirectDates]">
                  <input xpath="scenario/@validityDuration"/>
                </container>
                <container type="visibleGroup" visibleIf="[scenario/@setDirectDates]">
                  <input xpath="scheduling/@validityDate"/>
                </container>
                <container type="visibleGroup" visibleIf="[scenario/@setDirectDates] == false">
                  <input xpath="scenario/@webValidityDuration"/>
                </container>
                <container type="visibleGroup" visibleIf="[scenario/@setDirectDates]">
                  <input xpath="scheduling/@webValidityDate"/>
                </container>
                <input nolabel="false" xpath="scenario/@setDirectDates"/>
                <static type="help">The delivery duration specifies the period during which messages can be sent.\n
  The resource validity limit specifies for how long the resources referenced by the delivery (mirror pages, images...) are kept.</static>
              </container>
              <container type="visibleGroup" visibleIf="EV(@messageType, 'mail')">
                <container label="Mirror page management" type="frame" xpath="mailParameters">
                  <input label="Mode" useDesc="true" xpath="@mirrorPagePolicy"/>
                  <container type="visibleGroup" visibleIf="EV(@mirrorPagePolicy,'default')">
                    <static type="help">The mirror page is generated only if necessary.</static>
                  </container>
                  <container type="visibleGroup" visibleIf="EV(@mirrorPagePolicy,'fromMsgId')">
                    <static type="help">This option is needed to be able to visualize the content of each message sent. The mirror page preview is accessible from the list of delivery logs.</static>
                  </container>
                </container>
              </container>
              <container label="Tracking" type="frame">
                <container type="visibleGroup" visibleIf="![scenario/@setDirectDates]">
                  <input label="Expiration date" xpath="scenario/@trackingDuration"/>
                </container>
                <container type="visibleGroup" visibleIf="[scenario/@setDirectDates]">
                  <input xpath="tracking/@expiration"/>
                </container>
                <static type="help">You can specify here a validity limit date for redirection URLs on the tracking server.</static>
                <static label="Substitution URL for expired redirection URLs" type="Separator"/>
                <input label="URL" xpath="tracking/@errorUrl"/>
              </container>
            </container>
            <container label="SMTP" propagateConstraints="false" visibleIf="EV(@messageType, 'mail') and EV(@deliveryMode, 'external', 'descriptive')=false">
              <container type="visibleGroup" visibleIf="EV(@messageType, 'mail') and IsUnicode()" xpath="advancedParameters">
                <container label="Character encoding" type="frame">
                  <input useDesc="true" xpath="@forceCodepage"/>
                  <container type="visibleGroup" visibleIf="@forceCodepage">
                    <input xpath="@codepage"/>
                  </container>
                </container>
              </container>
              <container label="Bounce mails" type="frame" xpath="mailParameters">
                <input label="Use the default error address defined for the platform" type="checkbox" xpath="@useDefaultErrorAddress"/>
                <container type="visibleGroup" visibleIf="@useDefaultErrorAddress==false">
                  <input img="nms:sendemail.png" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="errorAddress"/>
                </container>
                <static type="help">Bounce mails (mailer daemon) for the delivery are received at an error address and automatically analyzed by the inMail process.</static>
                <input img="nms:sendemail.png" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="bounceAddress"/>
                <static type="help">Unprocessed bounce mails are forwarded to the following address if it is provided, otherwise to the default forwarding address defined for the instance.</static>
              </container>
              <static label="Additional SMTP headers" type="separator"/>
              <container xpath="mailParameters">
                <input fullToolbar="true" htmlMode="false" nolabel="true" type="htmlSource" xpath="headers" xpathInsert="/ignored/customizeSMTPHeaders" xpathUrl="/tmp/urlTree/@toSelect">
                  <container>
                    <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeSMTPHeaders"/>
                  </container>
                </input>
                <static type="help">This script can return a list of additional SMTP headers,\n
  as a list of one header per line (name: value). Values are automatically encoded if necessary.</static>
              </container>
            </container>
            <container label="Variables" propagateConstraints="false" visibleIf="[/delivery/@deliveryMode]!=2" xpath="variables">
              <input editable="false" nolabel="true" prebuildSubForm="false" toolbarAlign="horizontal" type="list" xpath="var" xpathRefresh="/delivery/variables/var*" zoom="true" zoomOnAdd="true">
                <input editable="true" xpath="@name"/>
                <input editable="true" xpath="desc"/>
                <input editable="true" xpath="@required"/>
                <input xpath="@dataType"/>
                <input label="Value" xpath="Iif(![@calculated],Iif([@dataType]==7,@timeStampValue,Iif([@dataType]==6,@stringValue,Iif([@dataType]==5,@doubleValue,Iif([@dataType]==3,@longValue,memoValue)))),'')"/>
                <input label="Expression" xpath="Iif([@calculated],expr,'')"/>
                <form label="Definition of a delivery parameter">
                  <input xpath="@name"/>
                  <input xpath="@required"/>
                  <input xpath="desc"/>
                  <input xpath="@dataType"/>
                  <container type="visibleGroup" visibleIf="!@calculated">
                    <container ref="xtk:option:editVariantValue"/>
                  </container>
                  <container type="visibleGroup" visibleIf="@calculated">
                    <input nolabel="false" type="pathEdit" xpath="expr" xpathSchema="/tmp/schema/@delivery"/>
                  </container>
                  <input xpath="@calculated"/>
                </form>
              </input>
              <static type="help">Delivery parameters are used to define values constant for all messages of the delivery. These parameters are available in the query editors and in the personalization scripts.</static>
            </container>
            <container applicableIf="HasPackage('nms:campaign')" label="Approvals" propagateConstraints="false" visibleIf="[/delivery/@operation-id]!=0 and [/ignored/@useValidation] and [/ignored/@dlvNotReady]='' and [/delivery/@FCP]=0 and EV([/delivery/@deliveryMode], 'descriptive')=false">
              <container colcount="2" readOnlyIf="[/tmp/@readOnly] and HasNamedRight('approvalAdministration')=false" type="readOnlyGroup">
                <container colcount="2" colspan="2" label="Job reviews" type="frame" xpath="validation">
                  <container colspan="2" readOnlyIf="HasNamedRight('approvalAdministration')=false or [../@state] > Eval([../@state], 'ready')" type="readOnlyGroup">
                    <container colcount="2" colspan="2" ref="nms:delivery:lib/validation"/>
                  </container>
                </container>
              </container>
            </container>
            <container label="Advanced" propagateConstraints="false" visibleIf="EV(@deliveryMode, 'descriptive')=false">
              <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 and EV(@deliveryMode, 'descriptive')=false">
                <container label="Message preparation by the scheduler" type="frame" xpath="scheduling/messagePreparation">
                  <input xpath="@priority"/>
                  <input useDesc="true" xpath="@forecasted"/>
                </container>
              </container>
              <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@linkedDelivery-id]=0">
                <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')">
                  <container label="Extraction file" type="frame">
                    <input label="File name computation script" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="output/outputScript"/>
                    <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0">
                      <input label="Enable file to be downloaded locally" xpath="output/@downloadDestFile"/>
                    </container>
                  </container>
                </container>
              </container>
              <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@linkedDelivery-id]=0 and (([@operation-id]!=0 and EV(@deliveryMode, 'external')=false) or (@isModel and [@operation-id]=0))">
                <container ref="nms:delivery:lib/supplier"/>
              </container>
              <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 and EV(@deliveryMode, 'external')=false">
                <container label="Delivery outline" type="frame">
                  <input createMode="none" fullLoad="true" xpath="deliveryOutline">
                    <sysFilter>
                      <condition expr="[@operation-id]=$(@operation-id)"/>
                      <condition>
                        <condition boolOperator="OR" expr="@messageType=$(@messageType)"/>
                        <condition expr="@messageType=127"/>
                      </condition>
                    </sysFilter>
                  </input>
                </container>
              </container>
              <container applicableIf="HasPackage('nms:coupon')">
                <container label="Coupon management" type="frame">
                  <input notifyPathList="@id,@code,@type" xpath="coupon"/>
                </container>
              </container>
              <container applicableIf="HasPackage('ncm:content')" type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')=false and EV(@deliveryMode, 'descriptive')=false">
                <container label="Content template" type="frame">
                  <input label="Template" xpath="publishing"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')==false and EV(@deliveryMode, 'descriptive')=false">
                <input xpath="/delivery/@contentEditingMode">
                  <enter name="onChange">
                    <if expr="[/delivery/@contentEditingMode]=0">
                      <set expr="false" xpath="@useDce"/>
                      <set expr="false" xpath="@useAEM"/>
                    </if>
                    <if expr="[/delivery/@contentEditingMode]=1">
                      <set expr="true" xpath="@useDce"/>
                      <set expr="false" xpath="@useAEM"/>
                    </if>
                    <if expr="[/delivery/@contentEditingMode]=2">
                      <set expr="false" xpath="@useDce"/>
                      <set expr="true" xpath="@useAEM"/>
                    </if>
                  </enter>
                </input>
                <container applicableIf="HasPackage('nms:aemIntegration')" type="visibleGroup" visibleIf="[/delivery/@contentEditingMode]=2 OR [/delivery/@contentEditingMode]=1">
                  <input xpath="cmsAccount">
                    <sysFilter>
                      <condition expr="@type=12"/>
                    </sysFilter>
                    <enter name="onChange">
                      <if expr="[../cmsAccount/@id] !=0">
                        <set expr="true" xpath="@useAEM"/>
                      </if>
                    </enter>
                  </input>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@FCP=false and EV(@deliveryMode, 'descriptive')=false">
                <input img="nms:bat.png" label="Proof properties..." type="subFormLink" xpath=".">
                  <form label="Proof properties">
                    <container label="Parameters" type="frame">
                      <container enabledIf="[targets/@deduplicate] or [targets/@noRcpIdDedup] == false" type="enabledGroup">
                        <input useDesc="true" xpath="fcpParameters/@ignoreDeduplicate"/>
                      </container>
                      <container enabledIf="[targets/@useBlackList]" type="enabledGroup">
                        <input useDesc="true" xpath="fcpParameters/@ignoreBlacklist"/>
                      </container>
                      <container enabledIf="[targets/@useQuarantine]" type="enabledGroup">
                        <input useDesc="true" xpath="fcpParameters/@ignoreQuarantaine"/>
                      </container>
                      <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')" xpath="fcpParameters">
                        <static img="xtk:export.png" label="Use a specific output file" type="separator"/>
                        <input useDesc="true" xpath="@useSpecificOutputFile"/>
                        <container label="Specific output file" type="frame">
                          <container enabledIf="@useSpecificOutputFile" type="enabledGroup" xpath="fcpOutput">
                            <input useDesc="true" xpath="@downloadDestFile"/>
                            <container type="visibleGroup" visibleIf="@downloadDestFile">
                              <input defExt="txt" filters="Text files (*.txt;*.tab)|*.txt;*.tab|CSV files (*.csv)|*.csv|XML files (*.xml)|*.xml|All (*.*)|*.*|" label="Local file" required="true" type="saveFileEdit" xpath="@fileName"/>
                            </container>
                            <container type="visibleGroup" visibleIf="@downloadDestFile = 'false'">
                              <input menuId="deliveryMenuBuilder" type="scriptEdit" xpath="outputScript"/>
                            </container>
                          </container>
                        </container>
                      </container>
                      <static label="Label of the proof" type="separator"/>
                      <input nolabel="false" xpath="fcpParameters/@keepDeliveryCode"/>
                      <input xpath="fcpParameters/@labelPrefix"/>
                      <container type="visibleGroup" visibleIf="EV(@messageType, 'mail')">
                        <container type="visibleGroup" visibleIf="EV([fcpParameters/@fcpMailFormat], 'normal') == false">
                          <input nolabel="true" useDesc="true" xpath="fcpParameters/@addFormatInPrefix"/>
                        </container>
                      </container>
                    </container>
                  </form>
                </input>
              </container>
            </container>
            <leave>
              <if expr="HasPackage('nms:campaign')">
                <check expr="[validation/@assignEdition]=false or [validation/@useContentValidation]=false or [validation/edition/@primaryAssignee-id]!=0">
                  <error>Please select the operator in charge of content editing.</error>
                </check>
                <check expr="[validation/@externalValidation]=false or [validation/@useContentValidation]=false or [validation/external/@primaryAssignee-id]!=0">
                  <error>Please enter the operator in charge of external content validation.</error>
                </check>
              </if>
              <if expr="[scenario/@setDirectDates]=0 and [scheduling/@contactDate]!=''">
                <set expr="DateAdd([scheduling/@contactDate], [scenario/@validityDuration])" xpath="scheduling/@validityDate"/>
              </if>
              <if expr="HasPackage('nms:campaign')">
                <if expr="[@workflow-id]=0 and [validation/@useTargetValidation]=false and ([validation/@useBudgetValidation] or ([validation/@useExtractionValidation] and EV(@deliveryMode, 'external')))">
                  <set value="true" xpath="validation/@useTargetValidation"/>
                </if>
                <if expr="[@operation-id]!=0 and [/delivery/@FCP]=0 and [/ignored/@useValidation]">
                  <if expr="[/tmp/@validationMode]=true">
                    <set value="manual" xpath="scheduling/@validationMode"/>
                  </if>
                  <if expr="[/tmp/@validationMode]=false">
                    <set value="auto" xpath="scheduling/@validationMode"/>
                  </if>
                </if>
              </if>
              <if expr="HasPackage('nms:webAnalytics')">
                <set expr="Iif([@webAnalyticsAccount-id]!=0,false,true)" xpath="/ignored/@showTracking"/>
              </if>
            </leave>
          </form>
        </input>
        <input applicableIf="HasPackage('nms:aemIntegration')" img="nms:aemLink.png" label="Synchronize" prebuildSubForm="false" type="flatSubFormButton" visibleIf="[/ignored/@isAEMContent]='true' and [/ignored/@isLinkedToContent]='false' and [/ignored/@currentPage]!='pageModel' and [/delivery/@state] &lt;= EVal([/delivery/@state], 'ready')">
          <form label="Synchronize with AEM content">
            <enter>
              <set value="false" xpath="/ignored/@aemContentPicked"/>
            </enter>
            <input type="aemContentPicker"/>
            <leave>
              <set value="true" xpath="/ignored/@aemContentPicked"/>
              <soapCall name="aemLinkContent" service="nms:delivery">
                <param exprIn="/delivery" type="DOMElement"/>
                <param exprIn="[/tmp/@aemContentName]" type="string"/>
                <param type="DOMElement" xpathOut="/ignored/aemContent"/>
              </soapCall>
              <set expr="[/ignored/aemContent/@permalink]" xpath="remoteContent/@remotePath"/>
              <set expr="[/ignored/aemContent/@label]" xpath="remoteContent/@remoteLabel"/>
              <set expr="[/ignored/aemContent/@approved]" xpath="remoteContent/@remoteValidation"/>
              <set expr="GetDate()" xpath="remoteContent/@lastSync"/>
              <set expr="[/ignored/aemContent/subject]" xpath="mailParameters/subject"/>
              <set expr="[/ignored/aemContent/html]" xpath="content/html/source"/>
              <set expr="[/ignored/aemContent/text]" xpath="content/text/source"/>
            </leave>
          </form>
        </input>
        <input applicableIf="HasPackage('nms:aemIntegration')" img="nms:aemUnlink.png" label="Desynchronize" prebuildSubForm="false" type="flatSubFormButton" visibleIf="[/ignored/@isLinkedToContent]='true' and [/ignored/@currentPage]!='pageModel' and [/delivery/@state] &lt;= EVal([/delivery/@state], 'ready')">
          <form label="Desynchronize from AEM content">
            <enter>
              <setModified/>
              <set translatedExpr="'Are you sure you want to stop synchronization with AEM content '+[remoteContent/@remoteLabel]+' ('+[remoteContent/@remotePath]+')?'" xpath="/ignored/@aemUnlinkConfirmation"/>
            </enter>
            <value height="3" nolabel="true" xpath="/ignored/@aemUnlinkConfirmation"/>
            <leave>
              <soapCall name="aemUnlinkContent" service="nms:delivery">
                <param exprIn="/delivery" type="DOMElement"/>
                <param type="boolean" xpathOut="/ignored/@isUnlinked"/>
              </soapCall>
              <if expr="[/ignored/@isUnlinked]">
                <set expr="''" xpath="remoteContent/@remotePath"/>
                <set expr="''" xpath="remoteContent/@remoteLabel"/>
                <set expr="false" xpath="remoteContent/@remoteValidation"/>
                <set expr="GetDate()" xpath="remoteContent/@lastSync"/>
              </if>
            </leave>
          </form>
        </input>
        <input img="xtk:html.png" label="Preview" prebuildSubForm="false" type="flatSubFormButton" visibleIf="false">
          <form label="Preview" maxLabelWidth="50" readOnlyExpr="[/tmp/@readOnly]">
            <container type="notebook">
              <container img="xtk:html.png" label="HTML" name="htmlContent" visibleIf="EV(@messageType, 'mail')" xpath="content/html/source">
                <container ref="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabPreview"/>
              </container>
              <container img="xtk:textfile.png" label="Text" name="textContent" visibleIf="EV(@messageType, 'mail')" xpath="content/text/source">
                <container ref="nms:delivery:lib/content/Text/textContentEditor/notebook/tabPreview"/>
              </container>
              <container img="nms:mobile.png" label="SMS" name="smsContent" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'sms', 'wapPush')" xpath="smsParameters">
                <container ref="nms:delivery:edit/mobileDefinition/parameters/smsContentEditor/notebook/tabPreview"/>
              </container>
              <container img="nms:mms.png" label="MMS" name="mmsContent" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'mms')" xpath="content/mms/source">
                <container ref="nms:delivery:edit/mobileDefinition/parameters/mmsContentEditor/notebook/tabPreview"/>
              </container>
              <container applicableIf="HasPackage('nms:social')" img="nms:facebook.png" label="Facebook" name="facebookContent" visibleIf="EV(@messageType, 'facebook')" xpath="content/html/source">
                <container ref="nms:delivery:lib/content/Facebook/facebookContentEditor/tabPreview"/>
              </container>
              <container applicableIf="HasPackage('nms:social')" img="nms:twitter.png" label="Tweet" name="tweetContent" visibleIf="EV(@messageType, 'twitter')" xpath="content/twitterMsg/source">
                <container ref="nms:delivery:lib/content/Tweet/tweetContentEditor/tabPreview"/>
              </container>
              <container applicableIf="HasPackage('nms:mobileApp')" img="nms:ios.png" label="iOS" name="iOSContent" visibleIf="EV(@messageType, 'ios')" xpath="content">
                <container ref="nms:delivery:lib/content/iOS/iOSContentEditor/tabPreview"/>
              </container>
              <container applicableIf="HasPackage('nms:mobileApp')" img="nms:android.png" label="Android" name="androidContent" visibleIf="EV(@messageType, 'android')" xpath="content">
                <container ref="nms:delivery:lib/content/android/androidContentEditor/tabPreview"/>
              </container>
            </container>
          </form>
        </input>
      </container>
      <input expr="( !@isModel and @state > EVal(@state, 'ready') ) or ( @midSourcing and EV(@state,'ready') )" type="expr" xpath="/tmp/@readOnly"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[@operation-id]" type="expr" xpath="/ignored/@operationId"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[validation/@useTargetValidation] and [@operation-id]!=0" type="expr" xpath="/ignored/@useTargetValidation"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[validation/@useContentValidation] and [@operation-id]!=0" type="expr" xpath="/ignored/@useContentValidation"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="@contentStatus" type="expr" xpath="/ignored/@contentStatus"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="@targetStatus" type="expr" xpath="/ignored/@targetStatus"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[@workflow-id]" type="expr" xpath="/ignored/tmp/@workflowId"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[/ignored/tmp/parameter/@useBudget] or [operation/parameter/@useBudget]" type="expr" xpath="/ignored/@useBudget"/>
      <input applicableIf="HasPackage('crm:lead')" expr="[/ignored/tmp/parameter/@useLandingPage] or [operation/parameter/@useLandingPage]" type="expr" xpath="/ignored/@useLandingPage"/>
      <input expr="[mapping/storage/@broadLogSchema]" type="expr" xpath="/ignored/@extractionSchema"/>
      <input alwaysActive="true" expr="Iif(EV([targets/@targetMode], 'file'), 'specificTarget', [fcpParameters/@fcpMode])" type="expr" xpath="fcpParameters/@fcpMode"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[targets/@deliveryLimitExpr]" type="expr" xpath="/ignored/@deliveryLimitExpr"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[scheduling/@extractionExpr]" type="expr" xpath="/ignored/@extractionExpr"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[scheduling/@contactDateExpr]" type="expr" xpath="/ignored/@contactDateExpr"/>
      <input applicableIf="HasPackage('nms:aemIntegration')" expr="Iif([/delivery/@contentEditingMode]=2, 'true', 'false')" type="expr" xpath="/ignored/@isAEMContent"/>
      <input applicableIf="HasPackage('nms:aemIntegration')" expr="Iif([/delivery/@contentEditingMode]=2 and [remoteContent/@remotePath] != '', 'true', 'false')" type="expr" xpath="/ignored/@isLinkedToContent"/>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="deliveryMapping">
          <input boldLineExpr="@builtIn = 1" createMode="none" noZoom="true" notifyPathList="@name, @label, @schema, @email, @fax, @sms, @paper, @phone, @agency, @format, @blackListEmail, @blackListSms, @blackListPhone, @blackListFax, @blackListPaper, @blackListAgency, @externalId, @recipientLink, @targetSchema, @countryCode, storage/@broadLogSchema, storage/@trackingLogSchema, storage/@exclusionType, storage/@broadLogExclSchema,storage/extraField/@dstXPath,storage/extraField/@srcExpr" xpath="."/>
        </container>
        <container name="imageUpload" type="deliveryImageUploader" xpathCurProgress="/tmp/@uploadCurrent" xpathImageConfig="../imageConfig" xpathMaxProgress="/tmp/@uploadMax">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/tmp/@uploadCurrent" xpathMax="/tmp/@uploadMax"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
        <container name="measureROI">
          <container label="ROI assessment settings" type="frame">
            <input xpath="@simuResponseType"/>
            <container type="visibleGroup" visibleIf="EV(@simuResponseType, 'formula')">
              <input nolabel="false" schemaExpr="GetLinkSchema([/delivery/mapping/@schema], [/delivery/mapping/@recipientLink])" type="pathEdit" xpath="simuResponseRateFormula"/>
              <input nolabel="false" schemaExpr="GetLinkSchema([/delivery/mapping/@schema], [/delivery/mapping/@recipientLink])" type="pathEdit" xpath="simuRevenueFormula"/>
              <static label="Margin calculation mode" type="separator"/>
              <input checkedValue="1" label="Margin rate in %" nolabel="false" type="radioButton" xpath="@simuMarginType"/>
              <input checkedValue="0" label="Unit margin" nolabel="false" type="radioButton" xpath="@simuMarginType"/>
              <input nolabel="false" schemaExpr="GetLinkSchema([/delivery/mapping/@schema], [/delivery/mapping/@recipientLink])" type="pathEdit" xpath="simuMarginFormula"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@simuResponseType, 'constant')">
              <input xpath="@simuResponseRate"/>
              <input xpath="@simuRevenue"/>
              <static label="Margin calculation mode" type="separator"/>
              <input checkedValue="1" label="Margin rate in %" nolabel="false" type="radioButton" xpath="@simuMarginType"/>
              <input checkedValue="0" label="Unit margin" nolabel="false" type="radioButton" xpath="@simuMarginType"/>
              <input xpath="@simuMargin"/>
            </container>
          </container>
        </container>
        <container name="validation">
          <input nolabel="true" xpath="@useContentValidation"/>
          <container enabledIf="@useContentValidation" type="enabledGroup">
            <container colcount="2" ref="nms:operation:lib/assignee" xpath="content"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@useContentValidation">
            <input xpath="@assignEdition"/>
            <container enabledIf="@assignEdition" type="enabledGroup">
              <container colcount="2" ref="nms:operation:lib/assignee" xpath="edition"/>
            </container>
            <input xpath="@externalValidation"/>
            <container enabledIf="@externalValidation" type="enabledGroup">
              <container colcount="2" ref="nms:operation:lib/assignee" xpath="external"/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'external') and EV([../@deliveryMode], 'descriptive')=false">
              <input xpath="@useFCPValidation"/>
              <static/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'external')=false and EV([../@deliveryMode], 'descriptive')=false">
              <input label="Enable proof sending" xpath="@useFCPValidation"/>
              <static/>
            </container>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'descriptive')=false">
            <input nolabel="true" xpath="@useTargetValidation"/>
            <container enabledIf="@useTargetValidation" type="enabledGroup">
              <container colcount="2" ref="nms:operation:lib/assignee" xpath="target"/>
            </container>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@useBudget]">
            <input nolabel="true" xpath="@useBudgetValidation"/>
            <container enabledIf="@useBudgetValidation" type="enabledGroup">
              <container colcount="2" ref="nms:operation:lib/assignee" xpath="budget"/>
            </container>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'external') and [/ignored/@hasParentDelivery]!=1">
            <input nolabel="true" xpath="@useExtractionValidation"/>
            <container enabledIf="@useExtractionValidation" type="enabledGroup">
              <container colcount="2" ref="nms:operation:lib/assignee" xpath="extraction"/>
            </container>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../validation/@sandboxMode], 'sandbox') AND EV([../validation/@sandboxModeEnforced],'operationDriven')">
            <static img="nms:businessRanking.png" label="Inclusion in provisional calendar:"/>
            <container colcount="2" ref="nms:operation:lib/assignee" xpath="forecast"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'external')=false and EV([../@deliveryMode], 'descriptive')=false and [/ignored/@hasParentDelivery]!=1">
            <static img="nms:campaign.png" label="Delivery start:"/>
            <container colcount="2" ref="nms:operation:lib/assignee" xpath="starting"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'external') and @useContentValidation=false">
            <input colspan="2" label="Enable proof validation" nolabel="true" xpath="@useFCPValidation"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'descriptive')=false and EV([../@deliveryMode], 'external')=false and [/ignored/@hasParentDelivery]!=1">
            <input label="Confirm the delivery before sending" nolabel="true" type="checkbox" xpath="/tmp/@validationMode"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'descriptive')=false">
            <static type="separator"/>
            <input readOnly="true" xpath="@sandboxMode"/>
          </container>
        </container>
        <container name="extraction">
          <container ref="nms:delivery:lib/deliveryLimitDef"/>
          <container>
            <static label="Limits the size of the population extracted. If it is set to zero, all possible members of the target will be extracted." type="help"/>
          </container>
          <container applicableIf="HasPackage('nms:campaign')" colspan="2" type="visibleGroup" visibleIf="[@operation-id]!=0">
            <container type="visibleGroup" visibleIf="[@deliveryOutline-id]=0">
              <input img="nms:deliveryOutline.png" label="Select a delivery outline..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="deliveryOutline">
                <form label="Select a delivery outline" nothingToSave="true">
                  <input img="nms:deliveryOutline.png" monoSelection="true" schema="nms:deliveryOutline" toolbarCaption="List of delivery outlines" type="linkListChoice" xpath="." xpathOut="/ignored/deliveryOutlineList">
                    <input xpath="[.]"/>
                    <sysFilter>
                      <condition expr="[@operation-id]=$(../@operation-id)"/>
                      <condition>
                        <condition boolOperator="OR" expr="@messageType=$(../@messageType)"/>
                        <condition expr="@messageType=127"/>
                      </condition>
                    </sysFilter>
                  </input>
                  <leave>
                    <set expr="[/ignored/deliveryOutlineList/deliveryOutline/@id]" xpath="@id"/>
                    <set expr="[/ignored/deliveryOutlineList/deliveryOutline/@_cs]" xpath="@_cs"/>
                    <set expr="[/ignored/deliveryOutlineList/deliveryOutline/@id]" xpath="../@deliveryOutline-id"/>
                  </leave>
                </form>
              </input>
            </container>
            <container colspan="2" padding-right="10" type="visibleGroup" visibleIf="[@deliveryOutline-id]!=0">
              <input createMode="none" fullLoad="true" xpath="deliveryOutline" xpathRefresh="/ignored/deliveryOutlineList/deliveryOutline">
                <sysFilter>
                  <condition expr="[@operation-id]=$(@operation-id)"/>
                  <condition>
                    <condition boolOperator="OR" expr="@messageType=$(@messageType)"/>
                    <condition expr="@messageType=127"/>
                  </condition>
                </sysFilter>
              </input>
            </container>
          </container>
        </container>
        <container name="extractionDef">
          <input img="nms:extraction.png" label="Edit the extraction file format..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
            <form img="xtk:export32.png" label="Extraction file format" type="wizard">
              <enter>
                <set value="1" xpath="/tmp/@useTargetingDimension"/>
                <if expr="[/tmp/@schemaChoice]=''">
                  <set value="0" xpath="/tmp/@useTargetingDimension"/>
                  <set expr="[../mapping/storage/@broadLogSchema]" xpath="extraction/source/@schema"/>
                  <set expr="[../mapping/storage/@broadLogSchema]" xpath="/tmp/selectCtrl/in/@schema"/>
                  <set value="export" xpath="/tmp/selectCtrl/in/@choiceType"/>
                </if>
                <if expr="HasPackage('nms:purl')">
                  <set value="true" xpath="/tmp/selectCtrl/in/@addPURL"/>
                </if>
                <if expr="FieldExists([/tmp/selectCtrl/in/@schema], 'targetData')=false and [/ignored/@operationId]!=0 and [/ignored/tmp/@workflowId]!=0">
                  <set value="0" xpath="/ignored/@hasTargetData"/>
                  <forEach xpath="extraction/source/select/node">
                    <if expr="StartWith(@expr, '[targetData/')">
                      <set value="1" xpath="/ignored/@hasTargetData"/>
                    </if>
                  </forEach>
                  <if expr="[/ignored/@hasTargetData]=1">
                    <set expr="mappingSchemaExt([/tmp/selectCtrl/in/@schema])" xpath="/tmp/selectCtrl/in/@schema"/>
                  </if>
                </if>
              </enter>
              <container desc="Select the targeting dimension of the file to be extracted." title="Targeting dimension" visibleIf="[/tmp/@schemaChoice]!=''">
                <input checkedValue="1" label="Extract delivery logs from the targeting dimension" nolabel="true" type="radioButton" xpath="/tmp/@useTargetingDimension"/>
                <container type="visibleGroup" visibleIf="[/tmp/@useTargetingDimension]==1">
                  <input label="Targeting dimension" type="schemaEdit" xpath="/tmp/@schemaChoice"/>
                  <input expr="Iif([/tmp/@useTargetingDimension]==1,GetLinkSchema([/tmp/@schemaChoice], 'broadLog'), NodeValue('extraction/source/@schema'))" type="expr" xpath="extraction/source/@schema"/>
                  <input label="Delivery logs" readOnly="true" type="schemaEdit" xpath="extraction/source/@schema"/>
                </container>
                <input checkedValue="0" label="Select the delivery logs to extract" nolabel="true" type="radioButton" xpath="/tmp/@useTargetingDimension"/>
                <container type="visibleGroup" visibleIf="[/tmp/@useTargetingDimension]==0">
                  <input label="Delivery logs" type="schemaEdit" xpath="extraction/source/@schema"/>
                </container>
                <leave>
                  <check expr="[extraction/source/@schema]!=''">
                    <error>You must specify the targeting dimension (table of individuals contacts, for example 'nms:recipient', not the delivery logs table).</error>
                  </check>
                </leave>
              </container>
              <container desc="Select the data to extract when exporting the file." name="column" title="Data to extract" xpath="extraction/source">
                <enter>
                  <set expr="@schema" xpath="/tmp/selectCtrl/in/@schema"/>
                  <set expr="@startPath" xpath="/tmp/selectCtrl/in/@startPath"/>
                  <set value="export" xpath="/tmp/selectCtrl/in/@choiceType"/>
                </enter>
                <container allowDistinct="true" allowGroupBy="true" allowUnexpandMemo="true" columnListType="exportColumnList" extraColumns="@groupBy, @alias" ref="xtk:queryDef:hidden/selectCtrl" showCollections="true">
                  <form label="Select a pURL" name="pURL">
                    <input extraColumns="@schema,@url,@name,@label" monoSelection="true" schema="nms:purl" setOnClick="true" type="linkListChoice" xpath="/tmp/purl" xpathOut="/tmp/selection">
                      <input xpath="[.]"/>
                      <sysFilter>
                        <condition enabledIf="$(/delivery/scheduling/@contactDate)!=''" expr="[webApp/@startDate]='' OR [webApp/@startDate] &lt;= #$noescaping(/delivery/scheduling/@contactDate)#"/>
                        <condition enabledIf="$(/delivery/scheduling/@contactDate)!=''" expr="[webApp/@endDate]='' OR [webApp/@endDate] >= #$noescaping(/delivery/scheduling/@contactDate)#"/>
                        <condition expr="@isModel=0"/>
                      </sysFilter>
                    </input>
                  </form>
                </container>
                <leave>
                  <if expr="[/tmp/selectCtrl/out/@group] == false">
                    <reset xpath="groupBy"/>
                    <reset xpath="having"/>
                  </if>
                </leave>
              </container>
              <container ref="xtk:exportSource:conditionLink" visibleIf="[extraction/source/conditionLink/@xpath]!=''" xpath="extraction"/>
              <container ref="xtk:exportSource:sort" xpath="extraction"/>
              <container ref="xtk:exportSource:destInfo" xpath="extraction"/>
              <container ref="xtk:exportSource:mapping" xpath="extraction"/>
            </form>
          </input>
        </container>
        <container applicableIf="HasPackage('nms:campaign')" name="supplier" type="visibleGroup" visibleIf="[@operation-id]!=0 or @isModel">
          <container name="supplier">
            <container colspan="2" readOnlyIf="[/ignored/@limitEdition] and [/ignored/@contentStatus]!=10" type="readOnlyGroup">
              <container label="Service provider" type="frame">
                <container type="visibleGroup" visibleIf="@messageType != 9">
                  <input alwaysActive="true" createMode="none" img="nms:supplier.png" notifyPathList="@deliveryModel-id, extraction/outputScript|../output/outputScript" xpath="supplierModel" xpathRefresh="/tmp/supplier">
                    <enter name="onChange">
                      <if expr="[@supplierModel-id]!=0">
                        <soapCall name="ApplyExtractionDef" service="nms:supplier">
                          <param exprIn="[@supplierModel-id]" type="int"/>
                          <param exprIn="[mapping/storage/@broadLogSchema]" type="string"/>
                          <param exprIn="output/extraction" type="DOMElement"/>
                          <param type="DOMElement" xpathOut="output/extraction"/>
                        </soapCall>
                        <soapCall name="initCostCenterList" service="nms:supplier">
                          <param exprIn="[@supplierModel-id]" type="int"/>
                          <param exprIn="@messageType" type="byte"/>
                          <param exprIn="budgetParameters" type="DOMElement"/>
                          <param type="DOMElement" xpathOut="budgetParameters"/>
                        </soapCall>
                      </if>
                    </enter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="@messageType=9">
                  <input alwaysActive="true" createMode="none" img="nms:supplier.png" xpath="supplierModel" xpathRefresh="/tmp/supplier">
                    <enter name="onChange">
                      <soapCall name="initCostCenterList" service="nms:supplier">
                        <param exprIn="[@supplierModel-id]" type="int"/>
                        <param exprIn="@messageType" type="byte"/>
                        <param exprIn="budgetParameters" type="DOMElement"/>
                        <param type="DOMElement" xpathOut="budgetParameters"/>
                      </soapCall>
                    </enter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="[@supplierModel-id]!=0 and NodeCount([budgetParameters/costCenter])">
                  <input editable="false" hideEditButtons="false" label="Cost categories" noToolbar="true" type="list" xpath="budgetParameters/costCenter">
                    <input editable="true" label="Label" noEdition="true" xpath="costCenter" zoom="true"/>
                    <input editable="true" label="Type" noZoom="true" notifyPathList="@stockLine-id|../@stockLine-id" xpath="costType" xpathMandatory="@mandatory">
                      <sysFilter>
                        <condition expr="[@costCenter-id]=$(@costCenter-id)"/>
                      </sysFilter>
                    </input>
                    <input blankIfEmpty="true" digitCount="5" editable="true" xpath="@amount"/>
                    <input createMode="none" editable="true" img="nms:expenseLine.png" noZoom="true" xpath="category">
                      <sysFilter>
                        <condition expr="@type=0"/>
                      </sysFilter>
                    </input>
                    <input hidden="true" xpath="@id"/>
                    <input hidden="true" xpath="@costCenter-id"/>
                    <input hidden="true" xpath="@costCenter-cs"/>
                    <input hidden="true" xpath="@costType-cs"/>
                    <input hidden="true" xpath="@costType-id"/>
                    <input hidden="true" xpath="@mandatory"/>
                    <orderBy>
                      <node expr="costCenter"/>
                    </orderBy>
                  </input>
                </container>
              </container>
            </container>
          </container>
        </container>
        <container name="mainTarget">
          <container type="visibleGroup" visibleIf="[/ignored/@showMappingChoice]">
            <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[/ignored/tmp/@workflowId] and [/ignored/@triggerMessage]!=1">
              "&gt;
              <input checkedValue="3" label="Resulting from upstream targeting" nolabel="false" type="RadioButton" xpath="@targetMode"/>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
              <input checkedValue="0" label="Defined in the database" nolabel="false" type="RadioButton" xpath="@targetMode"/>
            </container>
            <container type="visibleGroup" visibleIf="![/ignored/tmp/@workflowId] and [/ignored/@triggerMessage]!=1">
              <input checkedValue="1" label="Defined in an external file" nolabel="false" type="RadioButton" xpath="@targetMode"/>
            </container>
            <container enabledIf="EV(@targetMode, 'file')==false or @noReconciliation==false" ref="nms:delivery:lib/deliveryMapping" type="enabledGroup" xpath="../mapping"/>
          </container>
          <container type="visibleGroup" visibleIf="EV(@targetMode, 'database')">
            <container name="database" ref="nms:delivery:lib/databaseTarget"/>
          </container>
          <container name="file" type="visibleGroup" visibleIf="EV(@targetMode, 'file')">
            <container readOnlyIf="HasPackage('crm:lead')" type="readOnlyGroup">
              <input useDesc="true" xpath="@noReconciliation"/>
            </container>
            <value label="Delivery target population" xpath="deliveryFile/name"/>
            <input img="xtk:import.png" label="File format definition..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="fileFormat">
              <form img="xtk:import32.png" label="Format of the file containing the delivery recipients" maxLabelWidth="60" type="wizard">
                <enter>
                  <set value="text" xpath="source/@type"/>
                  <set value="xtkDataStore" xpath="destination/@type"/>
                  <set value="deliveryFileTarget" xpath="@name"/>
                  <set expr="[../../mapping/@schema]" xpath="destination/@schema"/>
                  <set expr="[../@noReconciliation]" xpath="/tmp/dlvFromFile/@noReconciliation"/>
                  <if expr="@useDefaultUserRcpFolder">
                    <set value="0" xpath="@folder-id"/>
                    <set value="" xpath="@folder-cs"/>
                  </if>
                  <if expr="[@group-id] == 0">
                    <set value="0" xpath="/tmp/relationEntity/@groupOpt"/>
                    <set translatedExpr="'Do not include in a list'" xpath="/tmp/relationEntity/@groupLabel"/>
                  </if>
                  <if expr="[@group-id] != 0 and [@clearGroup] == 0">
                    <set value="1" xpath="/tmp/relationEntity/@groupOpt"/>
                    <set translatedExpr="'Add to list \''+[@group-cs]+'\''" xpath="/tmp/relationEntity/@groupLabel"/>
                  </if>
                  <if expr="[@group-id] != 0 and @clearGroup == 1">
                    <set value="2" xpath="/tmp/relationEntity/@groupOpt"/>
                    <set translatedExpr="'Recreate list \''+[@group-cs]+'\' (optimized mode, but erase the content of the list before import)'" xpath="/tmp/relationEntity/@groupLabel"/>
                  </if>
                  <if expr="[@folder-id] == 0 and @useDefaultUserRcpFolder == 0">
                    <set value="0" xpath="/tmp/relationEntity/@folderOpt"/>
                    <set translatedExpr="'Do not import into a folder'" xpath="/tmp/relationEntity/@folderLabel"/>
                  </if>
                  <set value="1" xpath="/tmp/relationEntity/@folderOpt"/>
                  <set translatedExpr="'Add in the default folder of the operator'" xpath="/tmp/relationEntity/@folderLabel"/>
                  <if expr="[@folder-id] != 0 and @useDefaultUserRcpFolder == 0">
                    <set value="2" xpath="/tmp/relationEntity/@folderOpt"/>
                    <set translatedExpr="'Add in folder \''+[@folder-cs]+'\''" xpath="/tmp/relationEntity/@folderLabel"/>
                  </if>
                  <if expr="[@service-id] == 0">
                    <set value="0" xpath="/tmp/relationEntity/@serviceOpt"/>
                    <set translatedExpr="'Do not subscribe to a service'" xpath="/tmp/relationEntity/@serviceLabel"/>
                  </if>
                  <if expr="[@service-id] != 0">
                    <set value="1" xpath="/tmp/relationEntity/@serviceOpt"/>
                    <set translatedExpr="'Subscribe to service \''+[@service-cs]+'\''" xpath="/tmp/relationEntity/@serviceLabel"/>
                  </if>
                </enter>
                <container desc="Specify the file containing the recipients for the delivery" name="sourceInfos" title="Source file">
                  <enter>
                    <set expr="[../deliveryFile/name]" xpath="/tmp/deliveryFile/former/name"/>
                    <set expr="[../deliveryFile/@upload]" xpath="/tmp/deliveryFile/former/@upload"/>
                    <set expr="FileUploaded([../deliveryFile/name], [../deliveryFile/@md5])" xpath="/ignored/file/@uploadStatus"/>
                    <set value="1" xpath="/ignored/resource/@notInResTable"/>
                  </enter>
                  <container name="autoDetect" type="importAutoDetectContainer" xpath="source/dataSourceConfig" xpathAutoDetect="../../../deliveryFile/name" xpathLastParsed="../@lastParsedDataSource" xpathUploadFile="../../../deliveryFile/@upload">
                    <container colcount="2">
                      <container colcount="2" colspan="2" name="targetFile" xpath="../../../deliveryFile">
                        <static colspan="2" label="Delivery target population" type="separator"/>
                        <container colspan="2" type="visibleGroup" visibleIf="@upload">
                          <input filters="Text, CSV or XML files (*.txt;*.csv;*.tab;*.xml)|*.txt;*.csv;*.tab;*.xml|All (*.*)|*.*|" label="Local file" type="fileEdit" xpath="name"/>
                        </container>
                        <container colspan="2" type="visibleGroup" visibleIf="![@upload]">
                          <input label="Server file" xpath="name"/>
                        </container>
                        <container ref="xtk:importSource:sourceInfos/autoDetect/file/upload" xpath="."/>
                        <input colspan="2" img="xtk:refresh.png" label="Auto-Detect format" name="autoDetectBtn1" nolabel="false" type="urlButton"/>
                      </container>
                      <container ref="xtk:importSource:sourceInfos/autoDetect/file/format" xpath=".."/>
                      <container colspan="1" ref="xtk:importSource:sourceInfos/autoDetect/advanced" xpath="."/>
                    </container>
                    <static img="xtk:preview.png" label="Preview of data to import" type="separator"/>
                    <input name="PreviewList" type="fileParsingPreviewList" xpath="." xpathIndex="/tmp/columns/@current"/>
                  </container>
                </container>
                <container desc="Please map source fields with destination fields and specify the address field for the delivery." name="mapping" title="Field mapping">
                  <container ref="xtk:importSource:mappingInfos/mappingList"/>
                  <container colcount="2">
                    <container type="visibleGroup" visibleIf="EV([../../@messageType], 'paper') == false">
                      <input type="importDbColumnSelect" xpath="../@addressField" xpathCalculatedFields="../fileFormat/source/calculatedFields/calculatedField" xpathSource="../fileFormat/source/dataSourceConfig/dataSourceColumn"/>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="EV([../../@messageType], 'paper')">
                      <container colcount="3" label="Fields from the postal address" type="frame">
                        <input allowNone="true" optional="@line1" type="importDbColumnSelect" xpath="../postalAddress/@line1Field"/>
                        <input allowNone="true" optional="@line2" type="importDbColumnSelect" xpath="../postalAddress/@line2Field"/>
                        <input allowNone="true" optional="@line3" type="importDbColumnSelect" xpath="../postalAddress/@line3Field"/>
                        <input allowNone="true" optional="@line4" type="importDbColumnSelect" xpath="../postalAddress/@line4Field"/>
                        <input allowNone="true" optional="@line5" type="importDbColumnSelect" xpath="../postalAddress/@line5Field"/>
                        <input allowNone="true" optional="@line6" type="importDbColumnSelect" xpath="../postalAddress/@line6Field"/>
                        <input allowNone="true" optional="@line7" type="importDbColumnSelect" xpath="../postalAddress/@line7Field"/>
                        <input colspan="2" label="Advanced postal address fields..." nolabel="false" type="subFormLink" xpath=".">
                          <form label="Advanced fields of the postal address">
                            <input allowNone="true" optional="@addrDefined" type="importDbColumnSelect" xpath="../postalAddress/@addrDefinedField"/>
                            <input allowNone="true" optional="@addrQuality" type="importDbColumnSelect" xpath="../postalAddress/@addrQualityField"/>
                            <input allowNone="true" optional="@addrLastCheck" type="importDbColumnSelect" xpath="../postalAddress/@addrLastCheckField"/>
                            <input allowNone="true" optional="@addrErrorCount" type="importDbColumnSelect" xpath="../postalAddress/@addrErrorCountField"/>
                          </form>
                        </input>
                      </container>
                    </container>
                    <static/>
                    <container enabledIf="[../@useBlackList]" type="enabledGroup">
                      <input allowNone="true" type="importDbColumnSelect" xpath="../@blackListField"/>
                    </container>
                    <container enabledIf="EV([../../@messageType], 'mail')" type="enabledGroup">
                      <input allowNone="true" type="importDbColumnSelect" xpath="../@formatField"/>
                    </container>
                    <container type="visibleGroup" visibleIf="FieldExists([../../mapping/storage/@broadLogSchema], '@externalId')">
                      <input allowNone="true" type="importDbColumnSelect" xpath="../@externalIdField"/>
                    </container>
                    <container type="visibleGroup" visibleIf="FieldExists([../../mapping/storage/@broadLogSchema], '@segmentCode')">
                      <input allowNone="true" type="importDbColumnSelect" xpath="../@segmentCodeField"/>
                    </container>
                  </container>
                </container>
                <container ref="xtk:importSource:reconciliationInfos" visibleIf="[../@noReconciliation]==false"/>
                <container ref="xtk:importSource:group" visibleIf="[../@noReconciliation]==false and [destination/@schema] == 'nms:recipient'"/>
              </form>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="EV([../@deliveryMode], 'external')=false and [/ignored/@showMappingChoice]">
            <input nolabel="true" xpath="@addProofInTarget"/>
            <static type="help">Use to automatically add recipients from the proof to the main target.</static>
          </container>
        </container>
        <container colcount="2" name="proofTarget">
          <container colspan="2" type="visibleGroup" visibleIf="EV([targets/@targetMode], 'file') == false and EV(@messageType, 'paper')==false and @messageType!=5 and [/ignored/@triggerMessage]!=1 and [/ignored/@pushMessage]!=1">
            <input label="Targeting mode" useDesc="true" xpath="fcpParameters/@fcpMode"/>
          </container>
          <container colcount="2" colspan="2" name="visibleSpecTarget" type="visibleGroup" visibleIf="EV([fcpParameters/@fcpMode], 'specificTarget')">
            <container colcount="2" colspan="2" name="fcpSpecificTarget" xpath="targets">
              <container colspan="2" type="visibleGroup" visibleIf="EV(@targetMode, 'database', 'evtDatabase')">
                <container ref="nms:delivery:lib/databaseTarget/target" xpath="proofTarget"/>
              </container>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@targetMode, 'file')" xpath="proofFile">
                <static colspan="2" label="Proof target" type="separator"/>
                <container colspan="2" type="visibleGroup" visibleIf="@upload">
                  <input filters="Text, CSV or XML files (*.txt;*.csv;*.tab;*.xml)|*.txt;*.csv;*.tab;*.xml|All (*.*)|*.*|" label="Local file" type="fileEdit" xpath="name"/>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="![@upload]">
                  <input label="Server file" xpath="name"/>
                </container>
                <container ref="xtk:importSource:sourceInfos/autoDetect/file/upload" xpath="."/>
                <static colspan="2" img="xtk:logwarn.png" label=" " nolabel="false">The file specified for the proof must have the same format as the main delivery target file.</static>
              </container>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV([fcpParameters/@fcpMode], 'substituteAddress')">
            <input editable="true" prebuildSubForm="false" type="list" xpath="fcpParameters/substitution" zoom="true" zoomOnAdd="false">
              <input xpath="@address"/>
              <input editable="false" xpath="profile/rcp/@cs"/>
              <input xpath="@desc"/>
              <form label="Definition of a stand-in proof recipient">
                <enter>
                  <set expr="Iif([profile/rcp/@key]=='', true, false)" xpath="/ignored/fcp/@random"/>
                </enter>
                <input xpath="@address"/>
                <input xpath="@desc"/>
                <input checkedValue="true" label="Randomly chose a profile from the main target" nolabel="false" type="RadioButton" xpath="/ignored/fcp/@random"/>
                <input checkedValue="false" label="Select a profile (must be included in the target)" nolabel="false" type="RadioButton" xpath="/ignored/fcp/@random"/>
                <container type="visibleGroup" visibleIf="[/ignored/fcp/@random] == false">
                  <input hideEditButtons="true" label=" " monoSelection="true" type="targetPreviewList" xpath="/ignored/previewList" xpathParams="/delivery/variables" xpathSelection="profile" xpathTargets="/delivery/targets"/>
                </container>
                <leave>
                  <if expr="[/ignored/fcp/@random] == true">
                    <set value="" xpath="profile/rcp/@key"/>
                    <set translatedExpr="'Random'" xpath="profile/rcp/@cs"/>
                  </if>
                </leave>
              </form>
            </input>
            <static type="help">You can select recipients from the above delivery and replace their addresses in the proof.</static>
          </container>
          <container colspan="2" name="visibleSeedList" type="visibleGroup" visibleIf="EV([fcpParameters/@fcpMode], 'seedList')">
            <container name="fcpSeedList">
              <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]=1 and [/ignored/@showAllSeedMembers]=0 and NodeCount(FCPSeed)=1">
                <container colcount="2" ref="nms:seedMember:lib/rtEvent" xpath="FCPSeed/custom_nms_rtEvent"/>
                <input img="nms:unknownad.png" label="Add other seed addresses" type="urlButton">
                  <enter>
                    <set value="1" xpath="/ignored/@showAllSeedMembers"/>
                  </enter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1 or [/ignored/@showAllSeedMembers]">
                <input img="nms:unknownad.png" label="Import seed templates..." prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form forceToSaveEntity="true" label="Select the seed addresses">
                    <container defaultColumns="@label,[custom_nms_recipient/@email],[custom_nms_broadLog/postalAddress/address/serialized]" multiSelection="true" nodeModel="nmsSeedList" schema="nms:seedMember" sharedUserConfig="true" type="navTreeEntityList" xpath="/ignored/seedMember">
                      <sysFilter>
                        <condition expr="@isModel=1"/>
                      </sysFilter>
                    </container>
                    <leave>
                      <reset xpath="/ignored/FCPSeedList"/>
                      <soapCall name="getAsModel" noRefresh="true" service="nms:seedMember">
                        <param exprIn="'proof-id'" type="string"/>
                        <param exprIn="@id" type="int"/>
                        <param exprIn="/tmp/navTreeEntityList/output/nmsSeedList" type="DOMElement"/>
                        <param exprIn="/ignored/FCPSeedList" type="DOMElement"/>
                        <param type="DOMElement" xpathOut="/ignored/FCPSeedList"/>
                      </soapCall>
                      <copyElement list="true" nodeName="FCPSeed" xpathDst="." xpathSrc="/ignored/FCPSeedList/seedMember"/>
                      <set value="*" xpath="/tmp/seedMember"/>
                    </leave>
                  </form>
                </input>
                <input editable="false" form="nms:seedMember" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" toolbarCaption="List of seed addresses" type="list" xpath="FCPSeed" xpathRefresh="/tmp/seedMember" zoom="true" zoomOnAdd="true">
                  <input editable="true" xpath="@label"/>
                </input>
                <container>
                  <container label="Dynamic condition on the seed-address templates" type="frame" xpath="fcpParameters/seedList">
                    <input img="nms:miniatures/mini-incremental.png" label="Edit the dynamic condition..." type="subFormLink" xpath=".">
                      <form label="Dynamic condition">
                        <input nolabel="true" schema="nms:seedMember" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="/@helpCond">
                          <input colSize="15" label=" " xpath="/@bool-operator"/>
                          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                          <input colSize="15" label="Operator" xpath="/@operator"/>
                          <input colSize="30" label="Value" xpath="/@rightExpr"/>
                        </input>
                        <input expr="[/@helpCond]" type="expr" xpath="@humanCond"/>
                      </form>
                    </input>
                    <container type="visibleGroup" visibleIf="NodeCount([where/condition])>0">
                      <input fontBold="true" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="@humanCond"/>
                    </container>
                  </container>
                </container>
              </container>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV([fcpParameters/@fcpMode], 'mixedMode')">
            <container style="flat" type="notebook">
              <container label="Proof recipients" ref="nms:delivery:lib/proofTarget/visibleSpecTarget/fcpSpecificTarget"/>
              <container label="Proof seed addresses" ref="nms:delivery:lib/proofTarget/visibleSeedList/fcpSeedList"/>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="EV(@messageType, 'mail') and [content/html/source]!='' and [content/text/source]!='' and [/ignored/@showMappingChoice]">
            <static img="nms:email.png" label="Formats of the messages to send to all recipients in the proof target" type="separator"/>
            <input checkedValue="normal" label="Single message (normal behavior)" type="RadioButton" xpath="fcpParameters/@fcpMailFormat"/>
            <input checkedValue="textMultipart" label="Send two messages (text and multipart-alternative)" type="RadioButton" xpath="fcpParameters/@fcpMailFormat"/>
            <input checkedValue="allFormats" label="Send three messages (text, HTML and multipart-alternative)" type="RadioButton" xpath="fcpParameters/@fcpMailFormat"/>
          </container>
        </container>
        <container name="editRecipientQuery">
          <input img="nms:recipient.png" label="Edit the recipient profile loading query..." prebuildSubForm="false" type="subFormLink" xpath="/delivery">
            <form img="nms:pictoprofile.png" label="Edit the recipient profile load query" type="wizard">
              <enter>
                <set expr="GetLinkSchema([mapping/@schema], [mapping/@recipientLink])" xpath="/tmp/selectCtrl/in/@schema"/>
                <set value="" xpath="/tmp/selectCtrl/in/@startPath"/>
                <set expr="[/tmp/selectCtrl/in/@schema]" xpath="/tmp/@rcpLinkSchemaCondLink"/>
              </enter>
              <container desc="Please enter the information of recipients to load for personalization." title="Fields of the recipient to load">
                <container extraColumns="@alias" ref="xtk:queryDef:hidden/selectCtrl" showCollections="true" xpath="content/customRecipient"/>
              </container>
              <container desc="Please edit the filtering condition and sort order for each collection link. This is used to limit linked records to load." name="clt" title="Collection personalization information" visibleIf="NodeExists([content/customRecipient/conditionLink])" xpath="content/customRecipient">
                <input alwaysActive="true" editable="false" img="xtk:xtklinkn.png" name="cc" noEditCollection="true" nolabel="true" prebuildSubForm="true" type="customizeCondition" xpath="conditionLink" xpathSchema="/tmp/@rcpLinkSchemaCondLink" xpathSelect="select/node" zoom="true">
                  <input xpath="@label"/>
                  <input xpath="@lineCount"/>
                  <input xpath="where/@displayFilter"/>
                  <input xpath="orderBy/@displayOrder"/>
                  <input hidden="true" xpath="@schema"/>
                  <form img="nms:pictoprofile.png" label="Filtering for a collection of personalization information" type="wizard">
                    <container desc="Enter information used to specify how many collection elements you want to keep." name="parameters" title="General parameters">
                      <static type="help">If you know that there is only one collection element that fulfills the filtering condition you will enter,\n
select the following option (this improves performance by avoiding sub-queries).</static>
                      <input xpath="@singleRow"/>
                      <container enabledIf="!@singleRow" type="enabledGroup">
                        <static type="help">Number of collection elements to return.</static>
                        <input xpath="@lineCount"/>
                      </container>
                      <leave>
                        <if expr="@singleRow">
                          <set value="1" xpath="@lineCount"/>
                        </if>
                      </leave>
                    </container>
                    <container desc="Enter the filtering condition used to specify which collection elements you want to keep." name="where" title="Filter">
                      <container buildQueryXPath="." ref="xtk:queryDef:where"/>
                    </container>
                    <container desc="Specify the sort order used to indicates which lines to keep, when there are more lines eligible than specified previously." name="orderBy" title="Sort" visibleIf="@singleRow == false">
                      <input name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                        <input colSize="20" xpath="@label"/>
                        <input choiceType="true" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                        <input colSize="15" editable="true" xpath="@sortDesc"/>
                      </input>
                      <input type="help" xpath="/@help"/>
                    </container>
                  </form>
                </input>
              </container>
            </form>
          </input>
        </container>
        <container name="editTargetQuery">
          <input img="nms:segment.png" label="Edit the target record load query..." prebuildSubForm="false" type="subFormLink" xpath="/delivery">
            <form img="nms:pictoprofile.png" label="Editing the target record load query" type="wizard">
              <enter>
                <set expr="[mapping/@schema]" xpath="/tmp/selectCtrl/in/@schema"/>
                <set value="" xpath="/tmp/selectCtrl/in/@startPath"/>
                <set expr="[/tmp/selectCtrl/in/@schema]" xpath="/tmp/@targetSchemaCondLink"/>
              </enter>
              <container desc="Please specify data from records in the target for personalization." title="Fields of the target to load">
                <container extraColumns="@alias" ref="xtk:queryDef:hidden/selectCtrl" showCollections="true" xpath="content/customTarget"/>
              </container>
              <container desc="Please edit the filtering condition and sort order for each collection link. This is used to limit linked records to load." name="clt" title="Collection personalization information" visibleIf="NodeExists([content/customTarget/conditionLink])" xpath="content/customTarget">
                <input alwaysActive="true" editable="false" img="xtk:xtklinkn.png" name="cc" noEditCollection="true" nolabel="true" prebuildSubForm="true" type="customizeCondition" xpath="conditionLink" xpathSchema="/tmp/@targetSchemaCondLink" xpathSelect="select/node" zoom="true">
                  <input xpath="@label"/>
                  <input xpath="@lineCount"/>
                  <input xpath="where/@displayFilter"/>
                  <input xpath="orderBy/@displayOrder"/>
                  <input hidden="true" xpath="@schema"/>
                  <form img="nms:pictoprofile.png" label="Filtering for a collection of personalization information" type="wizard">
                    <container desc="Enter information used to specify how many collection elements you want to keep." name="parameters" title="General parameters">
                      <static type="help">If you know that there is only one collection element that fulfills the filtering condition you will enter,\n
select the following option (this improves performance by avoiding sub-queries).</static>
                      <input xpath="@singleRow"/>
                      <container enabledIf="!@singleRow" type="enabledGroup">
                        <static type="help">Number of collection elements to return.</static>
                        <input xpath="@lineCount"/>
                      </container>
                      <leave>
                        <if expr="@singleRow">
                          <set value="1" xpath="@lineCount"/>
                        </if>
                      </leave>
                    </container>
                    <container desc="Enter the filtering condition used to specify which collection elements you want to keep." name="where" title="Filter">
                      <container buildQueryXPath="." ref="xtk:queryDef:where"/>
                    </container>
                    <container desc="Specify the sort order used to indicates which lines to keep, when there are more lines eligible than specified previously." name="orderBy" title="Sort" visibleIf="@singleRow == false">
                      <input name="sortList" nolabel="true" toolbarCaption="Sort columns" type="orderByList" xpath="orderBy/node" xpathCurrentLookupPath="/lookupPath/orderBy" xpathHelp="/@help" zoom="false">
                        <input colSize="20" xpath="@label"/>
                        <input choiceType="true" colSize="35" editable="true" type="pathedit" xpath="@expr" xpathSchema="../../@schema"/>
                        <input colSize="15" editable="true" xpath="@sortDesc"/>
                      </input>
                      <input type="help" xpath="/@help"/>
                    </container>
                  </form>
                </input>
              </container>
            </form>
          </input>
        </container>
        <container name="wizSend">
          <container name="pgTarget">
            <input alwaysActive="true" expr="EV([targets/@targetMode],'file') or [targets/deliveryTarget/@nonEmpty]" type="expr" xpath="/ignored/@targetNoEmpty"/>
            <input expr="([/ignored/@analyzed] and [/ignored/@start] and EV([properties/@deliveryState], 'targetReady', 'ready')) or ([/ignored/@start] and EV([properties/@deliveryState], 'startPending', 'started', 'finished'))" type="expr" xpath="/ignored/@deliveryTargeted"/>
            <container backcolor="tooltip" padding="5" type="visibleGroup" visibleIf="![/ignored/@targetNoEmpty]">
              <static img="nms:caution.png">No main delivery target has been indicated.\nPlease define the population to be targeted from the list below.</static>
            </container>
            <container backcolor="tooltip" padding="5" type="visibleGroup" visibleIf="[/ignored/@targetNoEmpty] and [/ignored/@deliveryTargeted] and [/ignored/@enableStart]=false and HasNamedRight('deliveryValidate')">
              <container backcolor="tooltip" type="visibleGroup" visibleIf="![scheduling/@delayed]">
                <static img="nms:checked.png">The delivery has started.\nYou may close the window.</static>
              </container>
              <container backcolor="tooltip" colcount="2" type="visibleGroup" visibleIf="[scheduling/@delayed]">
                <static img="nms:checked.png" rowspan="2" type="image" vAlign="center"/>
                <static>Delivery started.</static>
                <value fontBold="true" label="Delivery scheduled for" xpath="scheduling/@contactDate"/>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@targetNoEmpty] and [/ignored/@deliveryTargeted] and [/ignored/@enableStart] and [/ignored/@targetStatus]!=1 and [/ignored/@targetStatus]!=3">
              <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="[/ignored/@actionMode]=2 or [/ignored/@useTargetValidation]">
                <static img="nms:caution.png" rowspan="3" type="image" vAlign="center"/>
                <static>Target calculation complete.</static>
                <value colspan="2" fontBold="true" xpath="properties/@toDeliver"/>
                <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]=false">
                  <static>You may change targeting and restart delivery analysis or close the window.</static>
                </container>
                <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]">
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[scheduling/@delayed]">
                    <value fontBold="true" label="Delivery scheduled for" xpath="scheduling/@contactDate"/>
                  </container>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@actionMode]=2 and [/ignored/@useTargetValidation]=false">
                    <static>Please choose the desired action and submit target for approval.</static>
                  </container>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]">
                    <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="![/ignored/@isTargetModified]">
                      <static>Please submit target for approval or change the target and restart the delivery analysis.</static>
                    </container>
                    <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@isTargetModified]">
                      <static type="warning">The target has been altered. Please run another delivery analysis.</static>
                    </container>
                  </container>
                </container>
              </container>
              <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="[/ignored/@actionMode]!=2 and [/ignored/@useTargetValidation]=false">
                <static img="nms:caution.png" rowspan="10" type="image" vAlign="center"/>
                <static>Delivery preparation is complete.</static>
                <value colspan="2" fontBold="true" xpath="properties/@toDeliver"/>
                <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[scheduling/@delayed]">
                  <value colspan="2" fontBold="true" label="Delivery scheduled for" xpath="scheduling/@contactDate"/>
                </container>
                <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="![/ignored/@isTargetModified]">
                  <static colspan="2">Please confirm the sending of messages or change the target and restart the delivery analysis.</static>
                </container>
                <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@isTargetModified]">
                  <static type="warning">The target has been altered. Please run another delivery analysis.</static>
                </container>
              </container>
            </container>
            <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="[/ignored/@targetNoEmpty] and ([/ignored/@targetStatus]=1 or [/ignored/@targetStatus]=3)">
              <static img="nms:checked.png" rowspan="3" type="image" vAlign="center"/>
              <container backcolor="tooltip" type="visibleGroup" visibleIf="![/ignored/@useContentValidation] or [/ignored/@contentStatus]=2">
                <static>The target was submitted for approval.</static>
              </container>
              <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@useContentValidation] and [/ignored/@contentStatus]!=2">
                <static>The target was submitted for approval.\nThe delivery may not be sent until its content is approved.</static>
              </container>
              <value fontBold="true" xpath="properties/@toDeliver"/>
              <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[scheduling/@delayed]">
                <value fontBold="true" label="Delivery scheduled for" xpath="scheduling/@contactDate"/>
              </container>
              <static colspan="2">You can change targeting and restart the analysis to submit it for approval again.</static>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@deliveryTargeted] and [/ignored/@enableStart]">
              <input imgExpr="[/ignored/@img]" label="Change the main delivery target" type="urlButton">
                <enter name="onClick">
                  <set expr="![/ignored/@showTarget]" xpath="/ignored/@showTarget"/>
                  <set expr="Iif([/ignored/@showTarget], 'nl:arrow_orange.png', 'nl:arrow_ntf_orange.png')" xpath="/ignored/@img"/>
                </enter>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@targetNoEmpty]">
              <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'preparationError')=false and ([/ignored/@actionMode]=2 and [/ignored/@start]=false and ([/ignored/@hasDeliveryContent]=false or ([/ignored/@useContentValidation] and [/ignored/@contentStatus]!=2))) and [/ignored/@useTargetValidation]=false">
                <static img="nms:caution.png" rowspan="3" type="image" vAlign="center"/>
                <container backcolor="tooltip" type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'edition') and [/ignored/@useContentValidation]=false">
                  <static>The delivery content has not been entered yet.</static>
                  <static colspan="2">You can start target analysis to evaluate the delivery potential.</static>
                </container>
                <container backcolor="tooltip" type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'edition') and [/ignored/@useContentValidation] and [/ignored/@contentStatus]=0 and [/ignored/@useTargetValidation]=false">
                  <static>The delivery content is pending approval.</static>
                  <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'edition')">
                    <static>Please start target analysis to evaluate the delivery potential.</static>
                  </container>
                </container>
                <container backcolor="tooltip" type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'edition')=false and ([/ignored/@useTargetValidation]=false or [/ignored/@useContentValidation])">
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@useContentValidation] and [/ignored/@contentStatus]!=2 and [/ignored/@useTargetValidation]=false">
                    <static>The target has been calculated. The delivery content is pending approval.</static>
                  </container>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="![/ignored/@useContentValidation] or [/ignored/@contentStatus]=2">
                    <static>The target has been calculated.</static>
                  </container>
                  <value colspan="2" fontBold="true" xpath="properties/@toDeliver"/>
                  <static colspan="2">You can start target analysis to evaluate the delivery potential again.</static>
                </container>
              </container>
              <container backcolor="tooltip" padding="5" type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'preparationError')">
                <static img="nms:exclam.png">An error occurred when preparing the delivery.\nPlease restart the analysis.</static>
              </container>
              <container type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'preparationError')=false and ((([/ignored/@hasDeliveryContent] and ([/ignored/@contentStatus]=2 or [/ignored/@useContentValidation]=false)) or [/ignored/@useTargetValidation]) and [/ignored/@start]=false)">
                <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf=" EV([properties/@deliveryState], 'edition')">
                  <static img="nms:caution.png" rowspan="3" type="image" vAlign="center"/>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]=false and [/ignored/@actionMode]=-1">
                    <static>The delivery is ready to be sent (content and targeting entered).\nPlease select the desired action.</static>
                  </container>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation] and [/ignored/@actionMode]=-1">
                    <static>The delivery is subjected to target approval.\n
  Please start the analysis to calculate the delivery target.</static>
                  </container>
                  <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]=false and [/ignored/@actionMode]!=2 and [/ignored/@actionMode]!=-1">
                    <static>Please start the analysis to prepare delivery sending.\nOnce this process is complete, the delivery will be ready to send.</static>
                  </container>
                  <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]=false and [/ignored/@actionMode]=2 and [/ignored/@actionMode]!=-1">
                    <static>The delivery is ready to send.\nPlease start the analysis to calculate the delivery target.</static>
                  </container>
                  <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation] and [/ignored/@actionMode]!=-1">
                    <static>Please start the analysis to calculate the delivery target.\nOnce this process is complete, targeting is ready to be approved.</static>
                  </container>
                </container>
                <container type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'edition')=false and EV([properties/@deliveryState], 'preparationError')=false">
                  <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation] and [/ignored/@targetStatus]!=1 and [/ignored/@targetStatus]!=3">
                    <container backcolor="tooltip" colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@targetStatus]=0">
                      <static img="nms:caution.png" rowspan="3" type="image" vAlign="center"/>
                      <static>The target has been calculated.</static>
                      <value fontBold="true" xpath="properties/@toDeliver"/>
                      <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[scheduling/@delayed]">
                        <value fontBold="true" label="Delivery scheduled for" xpath="scheduling/@contactDate"/>
                      </container>
                      <static colspan="2">Please submit target for approval or change the target and restart the delivery analysis.</static>
                    </container>
                    <container backcolor="tooltip" colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@targetStatus]=2">
                      <static img="nms:checked.png" rowspan="3" type="image" vAlign="center"/>
                      <static>The target has been approved.</static>
                      <value fontBold="true" xpath="properties/@toDeliver"/>
                      <static colspan="2">You can change targeting and restart the analysis to submit it for approval again.</static>
                    </container>
                  </container>
                  <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]=false">
                    <static img="nms:caution.png" rowspan="3" type="image" vAlign="center"/>
                    <static>The target has been calculated.</static>
                    <value fontBold="true" xpath="properties/@toDeliver"/>
                    <static colspan="2">Please confirm sending or change the target and restart the analysis.</static>
                  </container>
                  <container type="visibleGroup" visibleIf="[/ignored/@useTargetValidation]=false">
                    <input imgExpr="[/ignored/@imgAction]" label="Change the delivery action" type="urlButton">
                      <enter name="onClick">
                        <set expr="![/ignored/@showAction]" xpath="/ignored/@showAction"/>
                        <set expr="Iif([/ignored/@showAction], 'nl:arrow_orange.png', 'nl:arrow_ntf_orange.png')" xpath="/ignored/@imgAction"/>
                      </enter>
                    </input>
                  </container>
                </container>
                <container type="visibleGroup" visibleIf="(EV([properties/@deliveryState], 'edition') and [/ignored/@useTargetValidation]=false) or [/ignored/@showAction]">
                  <container label="Action on delivery" type="frame">
                    <container colcount="2" colspan="2" margin-left="50">
                      <container colcount="3" colspan="2">
                        <static img="nms:campaign.png" type="image"/>
                        <input checkedValue="0" label="Deliver as soon as possible" nolabel="false" type="radioButton" xpath="/ignored/@actionMode"/>
                        <container type="visiblegroup" visibleIf="[scheduling/@contactDate]!='' and [/ignored/@actionMode]=0">
                          <static label="The contact date already entered will be ignored." type="warning"/>
                        </container>
                        <container type="visiblegroup" visibleIf="[scheduling/@contactDate]='' or [/ignored/@actionMode]!=0">
                          <static/>
                        </container>
                        <static colspan="3">Target calculation and content preparation for immediate sending of the delivery.</static>
                      </container>
                      <container colcount="3" colspan="2">
                        <static img="nms:businessRanking.png" type="image"/>
                        <input checkedValue="1" label="Postpone the delivery" nolabel="true" type="radioButton" xpath="/ignored/@actionMode"/>
                        <container type="visibleGroup" visibleIf="[/ignored/@actionMode]=1">
                          <input xpath="scheduling/@contactDate"/>
                        </container>
                        <container type="visibleGroup" visibleIf="[/ignored/@actionMode]!=1">
                          <static/>
                        </container>
                        <static colspan="3" label="Target calculation and content preparation for postponed sending of the delivery starting from the contact date."/>
                      </container>
                      <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@socialMessage]!=1 AND [/ignored/@pushMessage]!=1">
                        <static img="nms:recipientActivity.png" type="image"/>
                        <input checkedValue="2" label="Estimate the population to be targeted" nolabel="true" type="radioButton" xpath="/ignored/@actionMode"/>
                        <static colspan="2" label="This action lets you calculate the delivery target to evaluate its potential."/>
                      </container>
                    </container>
                  </container>
                </container>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@showTarget] or ([/ignored/@targetNoEmptyInit]=false and [/ignored/@deliveryTargeted]=false)">
              <container type="visibleGroup" visibleIf="EV([targets/@targetMode],'file')">
                <static label="Main target" type="separator"/>
              </container>
              <container ref="nms:delivery:lib/mainTarget" xpath="targets"/>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@targetNoEmpty] and [/ignored/@actionMode]!=-1">
              <container ref="nms:delivery:lib/prepareDelivery"/>
            </container>
            <static type="separator"/>
            <leave>
              <check expr="[/ignored/@targetNoEmpty]">
                <error>Please enter a population to be targeted.</error>
              </check>
            </leave>
          </container>
          <container name="pgProof">
            <input alwaysActive="true" expr="(EV([targets/@targetMode],'file') and [targets/proofFile/name]!='') or ([targets/proofTarget/@nonEmpty] and EV([targets/@targetMode],'file')=false) or EV([fcpParameters/@fcpMode], 'specificTarget')=false" type="expr" xpath="/ignored/@targetNoEmpty"/>
            <input expr="[/ignored/@targetNoEmpty] and [/ignored/@analyzed] and [/ignored/@start] and EV([properties/@deliveryState], 'ready', 'startPending', 'started', 'finished')" type="expr" xpath="/ignored/@deliveryAnalyzed"/>
            <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="![/ignored/@targetNoEmpty]">
              <static img="nms:caution.png" vAlign="center">No proof target has been entered.\nPlease define the population to be targeted from the list below.</static>
            </container>
            <container backcolor="tooltip" padding="5" type="visibleGroup" visibleIf="[/ignored/@deliveryAnalyzed] and [/ignored/@enableStart]=false and HasNamedRight('deliveryValidate')">
              <static img="nms:checked.png">The delivery has started.\nYou may close the window.</static>
            </container>
            <container backcolor="tooltip" colcount="2" padding="5" type="visibleGroup" visibleIf="[/ignored/@deliveryAnalyzed] and [/ignored/@enableStart]">
              <static img="nms:caution.png" rowspan="3" type="image" vAlign="center"/>
              <static>Delivery preparation is complete.</static>
              <value colspan="2" fontBold="true" xpath="properties/@toDeliver"/>
              <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="![/ignored/@isTargetModified]">
                <static>Please confirm the sending of messages or change the target and restart the delivery analysis.</static>
              </container>
              <container backcolor="tooltip" colspan="2" type="visibleGroup" visibleIf="[/ignored/@isTargetModified]">
                <static type="warning">The target has been altered. Please run another delivery analysis.</static>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@deliveryAnalyzed] and [/ignored/@enableStart]">
              <input imgExpr="[/ignored/@img]" label="Change the proof target" type="urlButton">
                <enter name="onClick">
                  <set expr="![/ignored/@showTarget]" xpath="/ignored/@showTarget"/>
                  <set expr="Iif([/ignored/@showTarget], 'nl:arrow_orange.png', 'nl:arrow_ntf_orange.png')" xpath="/ignored/@img"/>
                </enter>
              </input>
            </container>
            <container backcolor="tooltip" padding="5" type="visibleGroup" visibleIf="![/ignored/@hasDeliveryContent] and [/ignored/@targetNoEmpty]">
              <static img="nms:exclam.png">The content of the main delivery has not been entered.\nYou may not send the proof.</static>
            </container>
            <container backcolor="tooltip" padding="5" type="visibleGroup" visibleIf="[/ignored/@hasDeliveryContent] and [/ignored/@targetNoEmpty] and [/ignored/@start]=false">
              <static img="nms:caution.png">Please start the proof analysis to prepare delivery sending.\nOnce this process is complete, the delivery will be ready to send.</static>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@deliveryAnalyzed]=false or [/ignored/@showTarget]">
              <container ref="nms:delivery:lib/proofTarget"/>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@hasDeliveryContent] and [/ignored/@targetNoEmpty]">
              <container ref="nms:delivery:lib/prepareDelivery"/>
            </container>
            <static type="separator"/>
            <leave>
              <check expr="[/ignored/@targetNoEmpty]">
                <error>Please enter a population to be targeted.</error>
              </check>
            </leave>
          </container>
        </container>
        <container name="databaseTarget" xpath="deliveryTarget">
          <container name="target">
            <input type="browserSummary" xpath="." xpathSchema="../../mapping/@schema">
              <form label="Select target element" name="brSummaryWizard" nothingToSave="true" type="wizard">
                <enter>
                  <set value="1" xpath="/ignored/@currentFilterStack"/>
                  <set value="0" xpath="/ignored/@addFilter"/>
                  <set value="" xpath="/ignored/@filterName"/>
                </enter>
                <container colcount="2" desc="Select the type of the target element" img="nms:pictoprofile.png" name="typePage" title="Target Type">
                  <static colspan="2" label="List of restriction filters" type="separator"/>
                  <input colspan="2" dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="../../../mapping/@schema" xpathWhere="where"/>
                  <container ref="nms:delivery:lib/segment"/>
                </container>
                <container desc="Please enter the definition of the target element" enabledButtonLabelIf="[/ignored/@currentFilterStack] == true" img="nms:pictoprofile.png" name="targetPage" nextButtonLabel="Refine the target>" nextPage="typePage" title="Target element">
                  <container name="targetPageFocus" style="flat" type="notebook">
                    <container label="Criteria">
                      <input xpath="@label"/>
                      <static label="Filter settings" type="separator"/>
                      <input exprsContext="[../../../mapping/@id]" type="filterView" xpath="." xpathFilter="/ignored/@filterName" xpathLabel="@label" xpathQueryLabel="@computedLabel" xpathSchema="../../../mapping/@schema" xpathsContext="tmp/@targetMapping-id"/>
                      <container ref="nms:delivery:lib/segment"/>
                    </container>
                    <container label="Preview">
                      <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="targetPreviewList" xpath="/ignored/previewList" xpathParams="/delivery/variables" xpathTargetPart="." xpathTargets="/delivery/targets"/>
                    </container>
                  </container>
                  <leave>
                    <set value="1" xpath="/ignored/@addFilter"/>
                    <set value="" xpath="/ignored/@filterName"/>
                  </leave>
                </container>
              </form>
            </input>
          </container>
        </container>
        <container colcount="2" name="general">
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@dlvNotReady]=''">
            <input discardReadOnly="true" xpath="@label"/>
            <input xpath="@internalName"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@dlvNotReady]!=''">
            <input xpath="@label"/>
          </container>
          <container applicableIf="HasPackage('nms:messageCenter')" colspan="2" type="visibleGroup" visibleIf="[/ignored/@triggerMessage]=1">
            <input xpath="triggerMessage/@eventType"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
            <input xpath="@deliveryCode"/>
          </container>
          <input colspan="2" xpath="@nature"/>
          <container applicableIf="HasPackage('crm:lead')" colspan="2" type="visibleGroup" visibleIf="EV(@messageType, 'mail') and ([/ignored/@useLandingPage] or [/ignored/@operationId]=0)">
            <input img="crm:landingPage.png" notifyPathList="[renderApp/@internalName],[renderApp/@id]" writeAccess="true" xpath="landingPage">
              <sysFilter>
                <condition enabledIf="$(/ignored/@operationId)!=0" expr="[@operation-id] = 0 OR [@operation-id] = $long(/ignored/@operationId)"/>
                <condition enabledIf="$(/ignored/@operationId)=0" expr="[@operation-id] = 0"/>
              </sysFilter>
            </input>
          </container>
          <input colspan="2" discardReadOnly="true" xpath="desc"/>
          <container colspan="2" type="visibleGroup" visibleIf="@isModel and ([/ignored/@dlvNotReady]='' or [/tmp/@showFolder]==1)">
            <input img="nms:campaign.png" xpath="folderProcess">
              <sysFilter>
                <condition expr="@model = 'nmsDelivery'"/>
              </sysFilter>
            </input>
            <input img="nms:deliveryModel.png" writeAccess="true" xpath="folder">
              <sysFilter>
                <condition expr="@model = 'nmsDeliveryModel'"/>
              </sysFilter>
            </input>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@isModel=false and ([/ignored/@dlvNotReady]='' or [/tmp/@showFolder]==1) and ([/tmp/processId]==0 or [/tmp/processId]==''or [/tmp/@showFolder]==1)">
            <input img="nms:campaign.png" writeAccess="true" xpath="folder">
              <sysFilter>
                <condition expr="@model = 'nmsDelivery'"/>
              </sysFilter>
            </input>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@dlvNotReady]=''">
            <input enumImage="@messageType" img="nms:extAccount.png" notifyPathList="@messageType,@deliveryMode,@id,@messageType,@deliveryMode,@account,@mobileConnector,@active,@label" xpath="deliveryProvider">
              <enter name="onChange">
                <if expr="HasPackage('nms:mobileApp') AND @isModel">
                  <reset xpath="/delivery/content/iosCheckParams/source[*]"/>
                  <reset xpath="/delivery/content/iosNotifType/source[*]"/>
                  <reset xpath="/delivery/content/androidCheckParams/source[*]"/>
                  <reset xpath="/delivery/content/androidService/source[*]"/>
                  <reset xpath="/delivery/content/androidCollapseKey/source[*]"/>
                  <if expr="EV(@messageType, 'ios')">
                    <set value="0" xpath="/delivery/content/iosNotifType/source"/>
                    <set value="&lt;%   if( appSubscription.mobileApp.password!='' &amp;&amp; appSubscription.mobileApp.uuid !='' &amp;&amp;       appSubscription.mobileApp.certificate!='' &amp;&amp; String(appSubscription.mobileApp.sandbox)!='' &amp;&amp;       appSubscription.mobileApp.label &amp;&amp; appSubscription.mobileApp.img &amp;&amp;       String(message.delivery.idTracking)!='' &amp;&amp; String(message.delivery.idMarketing)!='' )   { %> 'OK' &lt;%   }   else   { %> 'Error' &lt;%   } %>" xpath="/delivery/content/iosCheckParams/source"/>
                  </if>
                  <if expr="EV(@messageType, 'android')">
                    <set value="&lt;%= appSubscription.mobileApp.uuid %>" xpath="/delivery/content/androidService/source"/>
                    <set value="&lt;%= message.id %>" xpath="/delivery/content/androidCollapseKey/source"/>
                    <set value="&lt;%   if( appSubscription.mobileApp.label!='' &amp;&amp; appSubscription.mobileApp.img!='' &amp;&amp;       appSubscription.mobileApp.senderId!='' &amp;&amp; appSubscription.mobileApp.password!='' &amp;&amp;       String(message.delivery.idTracking)!='' &amp;&amp; String(message.delivery.idMarketing)!='' )   { %> 'OK' &lt;%   }   else   { %> 'Error' &lt;%   } %>" xpath="/delivery/content/androidCheckParams/source"/>
                  </if>
                </if>
              </enter>
              <sysFilter>
                <condition expr="@type = 3 and @active = 1"/>
                <condition enabledIf="!$(/delivery/@isModel)" expr="@messageType = $(/delivery/@messageType)"/>
                <condition enabledIf="!$(/delivery/@isModel)" expr="(@deliveryMode = $(/delivery/@deliveryMode) or (@deliveryMode in (1,4) and $(/delivery/@deliveryMode) in (1,4)))"/>
              </sysFilter>
            </input>
            <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 and [@workflow-id]!=0 and (EV(@deliveryMode, 'external') or [@linkedDelivery-id]!=0)">
              <container label="Main delivery" type="frame">
                <input createMode="none" fullLoad="true" label="Deliveries" notifyPathList="@offerSpace-id" xpath="linkedDelivery">
                  <sysFilter>
                    <condition expr="@id!=$(@id)"/>
                    <condition expr="@messageType=$(@messageType)"/>
                    <condition enabledIf="$(@isModel)==false" expr="@isModel=0"/>
                    <condition enabledIf="$(@isModel)" expr="@isModel=1"/>
                    <condition expr="[@linkedDelivery-id]=0 and [@operation-id]!=0 and [@workflow-id]!=0"/>
                    <condition expr="([@operation-id]=$(@operation-id) or [@operation-id]=$long(/ignored/@linkedOperation-id))"/>
                  </sysFilter>
                </input>
                <input expr="Iif([@linkedDelivery-id]!=0, 1, 0)" type="expr" xpath="/ignored/@hasParentDelivery"/>
                <static label="The file extraction is performed from the specified main delivery." type="help"/>
              </container>
            </container>
          </container>
        </container>
        <container img="nms:delivery.png" label="Summary" name="summary">
          <input alwaysActive="true" expr="Coalesce([properties/@outputFile], [properties/@outputLocal])" type="expr" xpath="/ignored/@outputFile"/>
          <input addSelectionInPost="true" entityRefresh="nms:delivery" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/nms/delivery.jssp?id='+@id+ '&amp;standalone=1'"/>
          <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 and (EV(@deliveryMode, 'external') or EV(@deliveryMode, 'descriptive')) and (EV(@state,'finished') or EV(@state,'cancelled'))">
            <container label="Action on delivery" type="frame">
              <input discardReadOnly="true" img="xtk:refresh.png" label="Reinitialize delivery to execute again..." type="subFormLink" xpath=".">
                <form label="Reinitialize delivery...">
                  <enter>
                    <setModified/>
                  </enter>
                  <static type="warning">Reinitializing the delivery resets the status to 'Ready to be delivered' in order to be executed once more.</static>
                  <static label="Click 'OK' to confirm." type="help"/>
                  <leave>
                    <soapCall name="CheckValidationAccess" service="nms:operation">
                      <param exprIn="validation" type="DOMElement"/>
                      <param exprIn="[operation/@owner-id]" type="int"/>
                      <param exprIn="-1" type="byte"/>
                      <param type="boolean" xpathOut="/ignored/@hasAccess"/>
                    </soapCall>
                    <check expr="[/ignored/@hasAccess]">
                      <error>You are not authorized to perform this operation.</error>
                    </check>
                    <set expr="Eval(@state, 'edition')" xpath="@state"/>
                    <set expr="Eval(@contentStatus, 'edition')" xpath="@contentStatus"/>
                    <set expr="Eval(@targetStatus, 'edition')" xpath="@targetStatus"/>
                    <set expr="Eval(@budgetStatus, 'edition')" xpath="@budgetStatus"/>
                    <set expr="Eval(@extractionStatus, 'edition')" xpath="@extractionStatus"/>
                    <set expr="Eval(@sandboxStatus, 'edition')" xpath="@sandboxStatus"/>
                    <if expr="[@linkedDelivery-id]!=0">
                      <set value="" xpath="scheduling/@contactDate"/>
                    </if>
                    <discardReadOnly/>
                  </leave>
                </form>
              </input>
            </container>
          </container>
        </container>
        <container img="nms:properties.png" label="Summary tree" name="summaryTree">
          <container type="visibleGroup" visibleIf="@midSourcing">
            <static fontBold="true" img="xtk:loginfo.png" label="Delivery submitted in mid-sourcing mode"/>
          </container>
          <input alwaysActive="true" expr="([/ignored/@propertiesMode] == 'wizard' and @launchFCP) or @FCP" type="expr" xpath="/ignored/@isFCP"/>
          <input alwaysActive="true" expr="Iif([/ignored/@propertiesMode] == 'wizard', Iif([/ignored/@action]=='edit' and EV(@state,'targetReady','preparationError'), [/ignored/@strForecast], Iif([/ignored/@action]=='FCP', [/ignored/@strFCP], Iif([/ignored/@action]=='send', [/ignored/@strSend], ''))), '')" type="expr" xpath="/ignored/@actionLabel"/>
          <input alwaysActive="true" expr="Iif([/ignored/@isFCP], [targets/proofFile/name], Iif([targets/@addProofInTarget], [targets/deliveryFile/name]+' + '+[targets/proofFile/name] , [targets/deliveryFile/name]))" type="expr" xpath="/ignored/targetFile"/>
          <input alwaysActive="true" expr="SizeInBytesToString([content/html/source])" type="expr" xpath="/ignored/@htmlContentSize"/>
          <input alwaysActive="true" expr="SizeInBytesToString([content/text/source])" type="expr" xpath="/ignored/@textContentSize"/>
          <input alwaysActive="true" expr="Iif([fcpParameters/@labelPrefix]=='', '', '[' + [fcpParameters/@labelPrefix] + '] ')" type="expr" xpath="/ignored/@subjPrefix"/>
          <input alwaysActive="true" expr="Iif([/ignored/@action]=='FCP' and StartWith([mailParameters/subject],[/ignored/@subjPrefix])==false, [/ignored/@subjPrefix], '') + [mailParameters/subject]" type="expr" xpath="/ignored/subject"/>
          <input alwaysActive="true" expr="Coalesce([properties/@outputLocal], [properties/@outputFile])" type="expr" xpath="/ignored/@outputFile"/>
          <input alwaysActive="true" expr="[properties/@midAccountUsedCs]+' ('+[properties/@midAccountUsedName]+')'" type="expr" xpath="/ignored/@multiMidAccount"/>
          <input editable="false" nolabel="true" type="treeEdit">
            <container label="General">
              <input label="Action" visibleIf="[/ignored/@actionLabel] != ''" xpath="/ignored/@actionLabel"/>
              <input editable="true" xpath="@label"/>
              <input editable="true" xpath="@internalName"/>
              <input visibleIf="EV(@messageType, 'sms')==false" xpath="@messageType"/>
              <input xpath="@state"/>
              <input applicableIf="HasPackage('nms:messageCenter')" visibleIf="EV([triggerMessage/@publicationStatus], 'notApplicable')=false" xpath="triggerMessage/@publicationStatus"/>
              <input applicableIf="HasPackage('nms:messageCenter')" visibleIf="[triggerMessage/@eventType]!=''" xpath="triggerMessage/@eventType"/>
              <input editable="true" xpath="@deliveryCode"/>
              <input applicableIf="HasPackage('nms:campaign')" editable="false" visibleIf="[@operation-id]!=0" xpath="@targetStatus"/>
              <input applicableIf="HasPackage('nms:campaign')" editable="false" visibleIf="[@operation-id]!=0" xpath="@contentStatus"/>
              <input applicableIf="HasPackage('nms:campaign')" editable="false" visibleIf="[@budget-id]!=0" xpath="@budgetStatus"/>
              <input applicableIf="HasPackage('nms:campaign')" editable="false" visibleIf="EV(@deliveryMode, 'external')" xpath="@extractionStatus"/>
              <input applicableIf="HasPackage('nms:coupon')" visibleIf="[@coupon-id] != 0" xpath="coupon/@code"/>
              <input editable="true" visibleIf="EV(@state, 'targetReady', 'preparationError') or [scheduling/@delayed] or @state > 15" xpath="scheduling/@contactDate"/>
              <input editable="true" visibleIf="EV(@deliveryMode, 'external')" xpath="scheduling/@extraction"/>
              <input visibleIf="EV(@deliveryMode, 'external')" xpath="scheduling/@extracted"/>
              <input label="Output file" visibleIf="EV(@deliveryMode, 'external')" xpath="/ignored/@outputFile"/>
              <input visibleIf="![/ignored/@isFCP] and EV([targets/@targetMode], 'database')" xpath="targets/deliveryTarget/@serialization"/>
              <input visibleIf="[/ignored/@isFCP] and EV([targets/@targetMode], 'database')" xpath="targets/proofTarget/@serialization"/>
              <input label="Target file" visibleIf="EV([targets/@targetMode], 'file')" xpath="/ignored/targetFile"/>
              <input dynamic="true" xpath="properties/@totalTarget"/>
              <input xpath="properties/@toDeliver"/>
              <input xpath="indicators/@processed"/>
              <input xpath="indicators/@success"/>
              <input applicableIf="HasPackage('nms:campaign')" visibleIf="[properties/@ctrlGrpReject] > 0" xpath="properties/@ctrlGrpReject"/>
              <input label="Subject" visibleIf="EV(@messageType, 'mail')" xpath="/ignored/subject"/>
              <input label="Subject" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'mms')" xpath="content/sms/source"/>
              <input label="Destination URL" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'wapPush')" xpath="content/text/source"/>
              <input visibleIf="EV(@messageType, 'mail')" xpath="mailParameters/senderAddress"/>
              <input visibleIf="EV(@messageType, 'mail')" xpath="mailParameters/senderName"/>
              <input visibleIf="EV(@messageType, 'mail')" xpath="mailParameters/replyAddress"/>
              <input visibleIf="EV(@messageType, 'mail')" xpath="mailParameters/replyName"/>
              <input visibleIf="EV(@messageType, 'mail') and [mailParameters/@useDefaultErrorAddress] == false" xpath="mailParameters/errorAddress"/>
              <input visibleIf="EV(@messageType, 'sms')" xpath="smsParameters/@smsMode"/>
              <input visibleIf="([/ignored/@propertiesMode]=='wizard' or @state &lt;= EVal(@state, 'ready')) and [scenario/@setDirectDates]==false" xpath="scenario/@validityDuration"/>
              <input visibleIf="EV(@deliveryMode, 'external')=false and ([/ignored/@propertiesMode]=='wizard' or @state &lt;= EVal(@state, 'ready')) and [scenario/@setDirectDates]==false" xpath="scenario/@webValidityDuration"/>
              <input visibleIf="EV(@deliveryMode, 'external')=false and ([/ignored/@propertiesMode]!='wizard' and @state > EVal(@state, 'ready')) or [scenario/@setDirectDates]" xpath="scheduling/@validityDate"/>
              <input visibleIf="([/ignored/@propertiesMode]!='wizard' and @state > EVal(@state, 'ready')) or [scenario/@setDirectDates]" xpath="scheduling/@webValidityDate"/>
              <input dynamic="true" visibleIf="EV(@deliveryMode, 'external')" xpath="properties/@outputLine"/>
              <input visibleIf="EV(@deliveryMode, 'external') and [properties/@seedProcessed] > 0" xpath="properties/@seedProcessed"/>
              <input visibleIf="[properties/@importReject]  > 0" xpath="properties/@importReject"/>
              <input visibleIf="[properties/@reject]     > 0" xpath="properties/@reject"/>
              <input label="Folder" visibleIf="@midSourcing == false" xpath="folder"/>
            </container>
            <container label="Mid-sourcing" visibleIf="@midSourcing or EV(@deliveryMode, 'midSourcing')">
              <input label="Mid-sourcing account used" visibleIf="[properties/@midAccountUsedName] != ''" xpath="/ignored/@multiMidAccount"/>
              <input xpath="properties/@midRemoteId"/>
              <input label="Submission date" visibleIf="@midSourcing" xpath="@midSubmitDate"/>
            </container>
            <container collapsed="true" label="Content" visibleIf="EV(@messageType, 'mail')">
              <input visibleIf="[properties/@html]     > 0" xpath="properties/@html"/>
              <input visibleIf="[properties/@text]     > 0" xpath="properties/@text"/>
              <input visibleIf="[properties/@multipart]> 0" xpath="properties/@multipart"/>
              <input xpath="@hasAttachments"/>
              <input label="HTML content" xpath="/ignored/@htmlContentSize"/>
              <input label="Text content" xpath="/ignored/@textContentSize"/>
              <input xpath="content/@formatSelection"/>
              <input xpath="content/@htmlCompression"/>
              <input xpath="content/@multipartRelated"/>
            </container>
            <container collapsed="true" label="Advanced parameters">
              <input xpath="deliveryProvider"/>
              <input visibleIf="EV(@messageType, 'sms')" xpath="smsParameters/@mobileMsgType"/>
              <input xpath="@priority"/>
              <input label="Target" visibleIf="EV([targets/@targetMode], 'address')" xpath="targets/@recipientList"/>
              <input label="Delivery weight" visibleIf="@midSourcing == false and [forecast/weightFormula] == '$(deliveryWeight)'" xpath="forecast/@weight"/>
              <input label="Weighting formula for the delivery" visibleIf="@midSourcing == false and [forecast/weightFormula] &lt;> '$(deliveryWeight)'" xpath="forecast/weightFormula"/>
              <input visibleIf="EV(@messageType, 'mail')" xpath="execution/@maxRetry"/>
              <input visibleIf="EV(@messageType, 'mail')" xpath="execution/@retryPeriod"/>
              <input xpath="targets/@deduplicate"/>
              <input visibleIf="[targets/@noRcpIdDedup]" xpath="targets/@noRcpIdDedup"/>
              <input xpath="targets/@useBlackList"/>
              <input xpath="targets/@useQuarantine"/>
              <input visibleIf="[targets/@useDeliveryLimit]" xpath="targets/@deliveryLimit"/>
              <input visibleIf="@state &lt; EVal(@state, 'ready')" xpath="scheduling/@validationMode"/>
              <input xpath="scheduling/@delayed"/>
              <input xpath="targets/@targetMode"/>
              <input xpath="tracking/@enabled"/>
              <input visibleIf="[tracking/@enabled] and EV(@messageType, 'mail')" xpath="tracking/@openEnabled"/>
            </container>
          </input>
        </container>
        <container name="content">
          <container label="Preview" name="Preview" xpath="..">
            <input name="previewToolbar" type="toolbarCtrl"/>
            <static type="separator"/>
            <container name="headers" xpath="/tmp/html/preview">
              <container colcount="2" name="mail" nolabel="true" vertSpacing="0">
                <container colcount="2">
                  <container type="visibleGroup" visibleIf="[attachmentList/@active] and NodeExists([attachmentList/attachment])">
                    <static img="nms:attachment.png" type="image"/>
                  </container>
                  <container colcount="2">
                    <value label="From" xpath="from"/>
                    <value label="Size" xpath="@size"/>
                    <value label="Subject" xpath="subject"/>
                    <input img="nms:email.png" label="More..." prebuildSubForm="false" type="subFormLink" xpath=".">
                      <form label="Preview results" nothingToEdit="true" nothingToSave="true" type="notebook">
                        <container label="General">
                          <container label="Headers" type="frame">
                            <value label="To" xpath="to"/>
                            <value label="From" xpath="from"/>
                            <value label="Reply to" xpath="replyTo"/>
                            <value label="Subject" xpath="subject"/>
                            <value label="Error address" xpath="returnPath"/>
                            <value label="MIME identifier" xpath="mimeMsgId"/>
                            <value label="Content Type" xpath="contentType"/>
                          </container>
                          <container type="visibleGroup" visibleIf="@wrongContent">
                            <static img="xtk:logwarn.png" nolabel="true">The content displayed in the main window does not match the format that will be sent to the recipient.</static>
                          </container>
                          <value label="Email size" xpath="@size"/>
                          <value label="Content size" xpath="@contentSize"/>
                          <container type="visibleGroup" visibleIf="@needMirrorPage==0">
                            <static label="Mirror page" nolabel="false">unavailable</static>
                          </container>
                          <container type="visibleGroup" visibleIf="@needMirrorPage==1">
                            <static img="xtk:html.png" label="Mirror page" nolabel="false">available</static>
                          </container>
                          <container type="visibleGroup" visibleIf="@needMirrorPage==2">
                            <static img="xtk:html.png" label="Mirror page" nolabel="false">accessible from the message identifier</static>
                          </container>
                        </container>
                        <container label="Attachments">
                          <container type="visibleGroup" visibleIf="[attachmentList/@active]==false or NodeExists([attachmentList/attachment])==false">
                            <static img="xtk:loginfo.png">The email does not contain an attachment</static>
                          </container>
                          <container type="visibleGroup" visibleIf="[attachmentList/@active] and NodeExists([attachmentList/attachment])">
                            <container label="Attachments" type="frame">
                              <input editable="false" img="nms:attachment.png" noToolbar="true" nolabel="true" type="list" xpath="attachmentList/attachment" xpathIndex="/tmp/preview/attachment/@current">
                                <input label="Label" width="25" xpath="@label"/>
                                <input label="File" xpath="@fileName"/>
                                <input label="Name to display" xpath="@display"/>
                                <input label="Size" xpath="@size"/>
                              </input>
                            </container>
                            <container nolabel="true" type="collectionItemGroup" xpath="attachmentList/attachment" xpathIndex="/tmp/preview/attachment/@current">
                              <container type="visibleGroup" visibleIf="@urlSrv != ''">
                                <input format="pdf" type="browser" xpath="@urlSrv"/>
                              </container>
                              <container type="visibleGroup" visibleIf="@notUploaded">
                                <static img="xtk:loginfo.png">This file is not yet uploaded to the server</static>
                              </container>
                            </container>
                          </container>
                        </container>
                        <container label="Anti-spam checking">
                          <input strings="nms:spamReport" type="docViewer" xpath="spamReport" xslt="nms:spamReport.xsl"/>
                        </container>
                        <container label="Data loaded">
                          <input nolabel="true" readOnly="true" type="SourceEdit" xpath="/tmp/rcpQryResult/queryResult"/>
                          <static type="help">This XML document represents all the loaded information in order to build a preview for this recipient.</static>
                        </container>
                      </form>
                    </input>
                    <container colspan="2" type="visibleGroup" visibleIf="[spamReport/@spam] != '' and [spamReport/@spam]==0 and [spamReport/error]==''">
                      <static img="xtk:finished.png" label=" " nolabel="false">Anti-spam checking successful (click 'More...' for further details).</static>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="[spamReport/@spam]==1">
                      <static img="xtk:logwarn.png" label=" " nolabel="false">Anti-spam checking has detected a high risk for this email (click 'More...' for further details).</static>
                    </container>
                    <container colspan="2" type="visibleGroup" visibleIf="[spamReport/error]!='' and [spamReport/@spam]==''">
                      <static img="xtk:logerr.png" label=" " nolabel="false">Anti-spam checking failed (click 'Detail...' for further details).</static>
                    </container>
                  </container>
                </container>
              </container>
            </container>
            <container name="body">
              <input name="ctPreview" nolabel="true" toolbarName="previewToolbar" type="contentPreview" xpath="." xpathRcpQuery="/tmp/rcpQryResult/queryResult" xpathSelection="/ignored/selectPart/rcpList" xpathTargetSchema="/delivery/mapping/@schema" xpathTargets="/delivery/targets">
                <form label="Select a recipient" name="selectTargetForPreview" nothingToSave="true">
                  <input hideEditButtons="true" nolabel="true" showAll="true" type="targetPreviewList" xpath="/ignored/previewList" xpathParams="/delivery/variables" xpathSelection="/ignored/recipientBtn/subForm" xpathTargets="/delivery/targets"/>
                </form>
                <form label="Selection of a seed address for the preview" name="selectSeedForPreview" nothingToSave="true">
                  <container defaultColumns="@label,[custom_nms_recipient/@email],[custom_nms_broadLog/postalAddress/address/serialized]" multiSelection="false" newEntityFormChoice="false" nodeModel="nmsSeedList" schema="nms:seedMember" sharedUserConfig="true" type="navTreeEntityList" xpath="/ignored/seedMember">
                    <sysFilter>
                      <condition expr="@isModel=0 and ([@proof-id]=$(/delivery/@id) or [@delivery-id]=$(/delivery/@id) or ([@delivery-id]=0 and [@proof-id]=0))"/>
                    </sysFilter>
                  </container>
                </form>
                <form label="Selection of a target record for the preview" name="selectTargetPartForPreview" nothingToSave="true">
                  <input hideEditButtons="true" nolabel="true" type="targetPreviewList" xpath="/ignored/previewList" xpathParams="/delivery/variables" xpathSelection="/ignored/recipientBtn/subForm" xpathTargetPart="." xpathTargets=".."/>
                </form>
              </input>
            </container>
          </container>
          <container name="HTML">
            <container type="visibleGroup" visibleIf="EV([../@formatSelection], 'text')">
              <static img="xtk:logwarn.png">HTML format defined for this delivery will not be sent but used only for the mirror page.</static>
            </container>
            <container img="xtk:html.png" label="HTML" name="htmlContentEditor">
              <container name="notebook" style="flat" type="contentEditor" xpath="source">
                <container label="Edit" visibleIf="[/delivery/@contentEditingMode]=1">
                  <input mode="delivery" toolbar="true" type="digitalContentEditor" xpath="." xpathSchema="/delivery/mapping/@schema" xpathUseAEM="/delivery/@useAEM">
                    &gt;
                    <form label="Resource publishing" nothingToEdit="true" nothingToSave="true">
                      <container name="localResourcesUploader" type="localResourcesUploader" xpathCurProgress="/tmp/@uploadCurrent" xpathFilesToDownload="/tmp/localResources" xpathMaxProgress="/tmp/@uploadMax">
                        <input name="JobLogsList" type="JobLogList"/>
                        <container colcount="2">
                          <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/tmp/@uploadCurrent" xpathMax="/tmp/@uploadMax"/>
                        </container>
                      </container>
                      <leave>
                        <set value="true" xpath="/tmp/@uploadImages"/>
                      </leave>
                    </form>
                  </input>
                </container>
                <container label="HTML" name="tabHtml" visibleIf="[/delivery/@contentEditingMode]=0 or [/delivery/@contentEditingMode]=2">
                  <container type="visibleGroup" visibleIf="[/ignored/@isLinkedToContent]='true'">
                    <container readOnly="true">
                      <value xpath="/delivery/mailParameters/subject"/>
                      <input bodyMode="false" fullToolbar="true" localImages="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathImageConfig="../imageConfig" xpathInsert="/ignored/customizeHTMLWysiwyg" xpathUrl="/tmp/urlTree/@toSelect" xpathUseAEM="/delivery/@useAEM">
                        <form label="Upload images" nothingToEdit="true" nothingToSave="true">
                          <container ref="nms:delivery:lib/imageUpload"/>
                          <leave>
                            <set value="true" xpath="../../@uploadImages"/>
                          </leave>
                        </form>
                        <container>
                          <input menuId="deliveryMenuBuilder" options="html" type="customizeBtn" xpath="/ignored/customizeHTMLWysiwyg"/>
                        </container>
                      </input>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="[/ignored/@isLinkedToContent]!='true'">
                    <input bodyMode="false" fullToolbar="true" localImages="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathImageConfig="../imageConfig" xpathInsert="/ignored/customizeHTMLWysiwyg" xpathUrl="/tmp/urlTree/@toSelect" xpathUseAEM="/delivery/@useAEM">
                      <form label="Upload images" nothingToEdit="true" nothingToSave="true">
                        <container ref="nms:delivery:lib/imageUpload"/>
                        <leave>
                          <set value="true" xpath="../../@uploadImages"/>
                        </leave>
                      </form>
                      <container>
                        <input menuId="deliveryMenuBuilder" options="html" type="customizeBtn" xpath="/ignored/customizeHTMLWysiwyg"/>
                      </container>
                    </input>
                  </container>
                </container>
                <container label="Source" name="tabSource" readOnlyIf="[/ignored/@isLinkedToContent]='true'">
                  <input fullToolbar="true" localImages="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathImageConfig="../imageConfig" xpathInsert="/ignored/customizeSrcHTMLWysiwyg" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathTidy="/tmp/tidy/@doTidy" xpathUrl="/tmp/urlTree/@toSelect">
                    <form label="Upload images" name="imageUpload" nothingToEdit="true" nothingToSave="true">
                      <container ref="nms:delivery:lib/imageUpload"/>
                      <leave>
                        <set value="true" xpath="../../@uploadImages"/>
                      </leave>
                    </form>
                    <container>
                      <input menuId="deliveryMenuBuilder" options="html" type="customizeBtn" xpath="/ignored/customizeSrcHTMLWysiwyg"/>
                    </container>
                  </input>
                </container>
                <container label="Preview" name="tabPreview" xpath="..">
                  <input name="previewToolbar" type="toolbarCtrl"/>
                  <static type="separator"/>
                  <container name="headers" xpath="/tmp/html/preview">
                    <container colcount="2" name="mail" nolabel="true" vertSpacing="0">
                      <container colcount="2">
                        <container type="visibleGroup" visibleIf="[attachmentList/@active] and NodeExists([attachmentList/attachment])">
                          <static img="nms:attachment.png" type="image"/>
                        </container>
                        <container colcount="2">
                          <value label="From" xpath="from"/>
                          <value label="Size" xpath="@size"/>
                          <value label="Subject" xpath="subject"/>
                          <input img="nms:email.png" label="More..." prebuildSubForm="false" type="subFormLink" xpath=".">
                            <form label="Preview results" nothingToEdit="true" nothingToSave="true" type="notebook">
                              <container label="General">
                                <container label="Headers" type="frame">
                                  <value label="To" xpath="to"/>
                                  <value label="From" xpath="from"/>
                                  <value label="Reply to" xpath="replyTo"/>
                                  <value label="Subject" xpath="subject"/>
                                  <value label="Error address" xpath="returnPath"/>
                                  <value label="MIME identifier" xpath="mimeMsgId"/>
                                  <value label="Content Type" xpath="contentType"/>
                                </container>
                                <container type="visibleGroup" visibleIf="@wrongContent">
                                  <static img="xtk:logwarn.png" nolabel="true">The content displayed in the main window does not match the format that will be sent to the recipient.</static>
                                </container>
                                <value label="Email size" xpath="@size"/>
                                <value label="Content size" xpath="@contentSize"/>
                                <container type="visibleGroup" visibleIf="@needMirrorPage==0">
                                  <static label="Mirror page" nolabel="false">unavailable</static>
                                </container>
                                <container type="visibleGroup" visibleIf="@needMirrorPage==1">
                                  <static img="xtk:html.png" label="Mirror page" nolabel="false">available</static>
                                </container>
                                <container type="visibleGroup" visibleIf="@needMirrorPage==2">
                                  <static img="xtk:html.png" label="Mirror page" nolabel="false">accessible from the message identifier</static>
                                </container>
                              </container>
                              <container label="Attachments">
                                <container type="visibleGroup" visibleIf="[attachmentList/@active]==false or NodeExists([attachmentList/attachment])==false">
                                  <static img="xtk:loginfo.png">The email does not contain an attachment</static>
                                </container>
                                <container type="visibleGroup" visibleIf="[attachmentList/@active] and NodeExists([attachmentList/attachment])">
                                  <container label="Attachments" type="frame">
                                    <input editable="false" img="nms:attachment.png" noToolbar="true" nolabel="true" type="list" xpath="attachmentList/attachment" xpathIndex="/tmp/preview/attachment/@current">
                                      <input label="Label" width="25" xpath="@label"/>
                                      <input label="File" xpath="@fileName"/>
                                      <input label="Name to display" xpath="@display"/>
                                      <input label="Size" xpath="@size"/>
                                    </input>
                                  </container>
                                  <container nolabel="true" type="collectionItemGroup" xpath="attachmentList/attachment" xpathIndex="/tmp/preview/attachment/@current">
                                    <container type="visibleGroup" visibleIf="@urlSrv != ''">
                                      <input format="pdf" type="browser" xpath="@urlSrv"/>
                                    </container>
                                    <container type="visibleGroup" visibleIf="@notUploaded">
                                      <static img="xtk:loginfo.png">This file is not yet uploaded to the server</static>
                                    </container>
                                  </container>
                                </container>
                              </container>
                              <container label="Anti-spam checking">
                                <input strings="nms:spamReport" type="docViewer" xpath="spamReport" xslt="nms:spamReport.xsl"/>
                              </container>
                              <container label="Data loaded">
                                <input nolabel="true" readOnly="true" type="SourceEdit" xpath="/tmp/rcpQryResult/queryResult"/>
                                <static type="help">This XML document represents all the loaded information in order to build a preview for this recipient.</static>
                              </container>
                              <container label="Deco-mail diagnostic">
                                <container type="visibleGroup" visibleIf="[/tmp/html/preview/@rawSize]>(100*1024)">
                                  <static type="warning">The message size exceeds the maximum size for Deco-mail messages (100 kB).</static>
                                </container>
                                <input format="deco" type="htmlDiagnosticList" xpath="content" xpathRefresh="deco"/>
                              </container>
                            </form>
                          </input>
                          <container colspan="2" type="visibleGroup" visibleIf="[spamReport/@spam] != '' and [spamReport/@spam]==0 and [spamReport/error]==''">
                            <static img="xtk:finished.png" label=" " nolabel="false">Anti-spam checking successful (click 'More...' for further details).</static>
                          </container>
                          <container colspan="2" type="visibleGroup" visibleIf="[spamReport/@spam]==1">
                            <static img="xtk:logwarn.png" label=" " nolabel="false">Anti-spam checking has detected a high risk for this email (click 'More...' for further details).</static>
                          </container>
                          <container colspan="2" type="visibleGroup" visibleIf="[spamReport/error]!='' and [spamReport/@spam]==''">
                            <static img="xtk:logerr.png" label=" " nolabel="false">Anti-spam checking failed (click 'Detail...' for further details).</static>
                          </container>
                        </container>
                      </container>
                    </container>
                  </container>
                  <container name="body">
                    <input name="ctPreview" nolabel="true" toolbarName="previewToolbar" type="contentPreview" xpath="." xpathRcpQuery="/tmp/rcpQryResult/queryResult" xpathSelection="/ignored/selectPart/rcpList" xpathTargetSchema="/delivery/mapping/@schema" xpathTargets="/delivery/targets">
                      <form label="Select a recipient" name="selectTargetForPreview" nothingToSave="true">
                        <input hideEditButtons="true" nolabel="true" showAll="true" type="targetPreviewList" xpath="/ignored/previewList" xpathParams="/delivery/variables" xpathSelection="/ignored/recipientBtn/subForm" xpathTargets="/delivery/targets"/>
                      </form>
                      <form label="Selection of a target record for the preview" name="selectTargetPartForPreview" nothingToSave="true">
                        <input hideEditButtons="true" nolabel="true" type="targetPreviewList" xpath="/ignored/previewList" xpathParams="/delivery/variables" xpathSelection="/ignored/recipientBtn/subForm" xpathTargetPart="." xpathTargets=".."/>
                      </form>
                      <form label="Selection of a seed address for the preview" name="selectSeedForPreview" nothingToSave="true">
                        <container defaultColumns="@label,@internalName" multiSelection="false" newEntityFormChoice="false" nodeModel="nmsSeedList" schema="nms:seedMember" sharedUserConfig="true" type="navTreeEntityList" xpath="/ignored/seedMember">
                          <sysFilter>
                            <condition expr="@isModel=0 and ([@proof-id]=$(/delivery/@id) or [@delivery-id]=$(/delivery/@id) or ([@delivery-id]=0 and [@proof-id]=0))"/>
                          </sysFilter>
                        </container>
                      </form>
                    </input>
                  </container>
                </container>
              </container>
              <container colcount="2" type="visibleGroup" visibleIf="![/tmp/@readOnly]">
                <container type="visibleGroup" visibleIf="[../../tracking/@enabled]">
                  <input label="Display URLs" nolabel="true" type="checkBox" xpath="/tmp/urlTree/@display"/>
                </container>
                <input label="Display the HTML diagnostics" nolabel="true" type="checkBox" xpath="/tmp/htmlDiagnostics/@display"/>
              </container>
              <container colcount="2" name="contUrl">
                <container name="contUrlTree" type="visibleGroup" visibleIf="[../../tracking/@enabled]">
                  <container type="visibleGroup" visibleIf="[/tmp/urlTree/@display] == 'true'">
                    <input lineCount="7" type="urlTree" xpath="." xpathRefresh="/tmp/urlTree/@display" xpathUrl="/tmp/urlTree/@toSelect"/>
                  </container>
                </container>
                <container type="visibleGroup" visibleIf="[/tmp/htmlDiagnostics/@display] == 'true'">
                  <input lineCount="7" type="htmlDiagnosticList" xpath="/delivery/content/html/source" xpathRefresh="/tmp/htmlDiagnostics/@display" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect"/>
                  <input img="xtk:xtkcheck.png" label="Correct the HTML code..." prebuildSubForm="false" type="subFormLink">
                    <form label="HTML code-correction options" nothingToSave="true">
                      <container>
                        <static type="help">Corrects badly formed HTML code. This process may sometimes alter the final appearance of the document.\n
  The default settings are usually adequate for most documents but you may specify certain options.</static>
                        <input label="Compression: Remove comments and strictly unnecessary tags" type="checkBox" xpath="/tmp/tidy/@hide-comments"/>
                        <input label="Compression: Regroup and reuse styles" type="checkBox" xpath="/tmp/tidy/@clean"/>
                        <input label="Improve the code layout" type="checkBox" xpath="/tmp/tidy/@vertical-space"/>
                        <input label="Transform the code into XHTML" type="checkBox" xpath="/tmp/tidy/@output-xhtml"/>
                        <input label="Delete the style information generated with Word (may change the final appearance)" type="checkBox" xpath="/tmp/tidy/@word-2000"/>
                        <input expr="[/tmp/tidy/@hide-comments]" type="expr" xpath="/tmp/tidy/@hide-endtags"/>
                        <input expr="Iif([/tmp/tidy/@vertical-space], 'yes', 'no')" type="expr" xpath="/tmp/tidy/@indent"/>
                        <input expr="Iif([/tmp/tidy/@hide-comments], 'omit', 'auto')" type="expr" xpath="/tmp/tidy/@doctype"/>
                      </container>
                      <leave>
                        <set value="1" xpath="/tmp/tidy/@doTidy"/>
                        <set value="0" xpath="/tmp/htmlDiagnostics/@display"/>
                      </leave>
                    </form>
                  </input>
                </container>
              </container>
            </container>
          </container>
          <container name="Text">
            <container img="xtk:text.png" label="Text" name="textContentEditor">
              <container name="notebook" style="flat" type="contentEditor" xpath="source">
                <container label="Text" name="tabText" readOnlyIf="[/ignored/@isLinkedToContent]='true'">
                  <container type="visibleGroup" visibleIf="[/ignored/@isLinkedToContent]='true'">
                    <value xpath="/delivery/mailParameters/subject"/>
                  </container>
                  <input fullToolbar="true" htmlMode="false" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                      <input ignoreXPath="true" img="nms:htmltotext.png" insertAfter="Open" label="Import HTML" textAlign="toolTip" type="flatButton" visibleIf="[../../../content/html/source]!=''">
                        <enter>
                          <set expr="iif([.]=='', 'yes', 'no')" xpath="/ignored/@overrideTextContent"/>
                          <if expr="[.]!=''">
                            <msgBox translatedExpr="'The existing content will be replaced, are you sure you want to proceed?'" type="yesno" xpathOut="/ignored/@overrideTextContent"/>
                          </if>
                          <if expr="[/ignored/@overrideTextContent]='yes'">
                            <soapCall name="HtmlToText" service="nms:delivery">
                              <param exprIn="[../../html/source]" type="string"/>
                              <param type="string" xpathOut="."/>
                            </soapCall>
                          </if>
                        </enter>
                      </input>
                    </container>
                  </input>
                </container>
                <container label="Preview" name="tabPreview">
                  <input name="previewToolbar" type="toolbarCtrl"/>
                  <static type="separator"/>
                  <container ref="nms:delivery:lib/content/Preview/headers/mail" xpath="/tmp/text/preview"/>
                  <container ref="nms:delivery:lib/content/Preview/body" xpath=".."/>
                </container>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="[../../tracking/@enabled]">
              <input label="Display URLs" nolabel="true" type="checkBox" xpath="/tmp/urlTree/@display"/>
            </container>
            <container name="contUrlTree" ref="nms:delivery:lib/content/HTML/htmlContentEditor/contUrl/contUrlTree" xpath="."/>
          </container>
          <container name="Facebook">
            <container img="nms:facebook.png" label="Facebook" name="facebookContentEditor" xpath="source">
              <container label="Preview" name="tabPreview">
                <input name="previewToolbar" type="toolbarCtrl"/>
                <static type="separator"/>
                <container ref="nms:delivery:lib/content/Preview/body" xpath=".."/>
              </container>
            </container>
          </container>
          <container name="Tweet">
            <container img="nms:twitter.png" label="Tweet" name="tweetContentEditor" xpath="source">
              <container label="Text" name="tabText">
                <input fullToolbar="true" htmlMode="false" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                  <container>
                    <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                  </container>
                </input>
              </container>
              <container label="Preview" name="tabPreview">
                <input name="previewToolbar" type="toolbarCtrl"/>
                <static type="separator"/>
                <container ref="nms:delivery:lib/content/Preview/body" xpath=".."/>
              </container>
            </container>
          </container>
          <container name="iOS">
            <container img="nms:ios.png" label="iOS" name="iOSContentEditor">
              <container colcount="2" label="Content" maxLabelWidth="80" name="tabContent">
                <container colspan="2" label="Alert style" name="notificationType" type="frame">
                  <static label="You can define the level of discretion of the notification" type="help"/>
                  <input checkedValue="0" label="Alert" nolabel="true" type="radiobutton" xpath="iosNotifType/source"/>
                  <input checkedValue="1" label="Badge" nolabel="true" type="radiobutton" xpath="iosNotifType/source"/>
                  <input checkedValue="2" label="Alert and badge" nolabel="true" type="radiobutton" xpath="iosNotifType/source"/>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="[iosNotifType/source]!=1">
                  <input fullToolbar="true" htmlMode="false" label="Message" name="ctSource" nolabel="false" type="htmlSource" xpath="iosMessage/source" xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                    </container>
                  </input>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="[iosNotifType/source]!=0">
                  <input editable="true" label="Value of the badge" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="iosBadge/source"/>
                </container>
                <input colspan="2" enumXPath="/tmp/notificationSounds" label="Play a sound" type="DynEnumCombo" xpath="iosSound/source"/>
                <static colspan="2" label="Application variables" type="separator"/>
                <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
                  <input colspan="2" editable="false" hideEditButtons="true" label=" " nolabel="false" type="list" xpath="/tmp/notificationCustomFields/customFieldsItem">
                    <input label="Key" readOnly="true" type="edit" xpath="@key"/>
                    <input editable="true" label="Value" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="@value"/>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]=1">
                  <input colspan="2" editable="true" label=" " nolabel="false" type="list" xpath="/tmp/notificationCustomFields/customFieldsItem" zoomOnAdd="false">
                    <input label="Key" type="edit" xpath="@key"/>
                    <input label="Value" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="@value"/>
                  </input>
                </container>
              </container>
              <container colcount="2" label="Preview" name="tabPreview">
                <input colspan="2" name="previewToolbar" type="toolbarCtrl"/>
                <value label="Length" xpath="/tmp/sms/preview/@length"/>
                <input label="Data loaded..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="/tmp/rcpQryResult">
                  <form label="Data of the recipient loaded for the preview">
                    <input nolabel="true" readOnly="true" type="SourceEdit" xpath="queryResult"/>
                  </form>
                </input>
                <static colspan="2" type="separator"/>
                <container ref="nms:delivery:lib/content/Preview/body" xpath="iosMessage"/>
                <input sessionToken="true" type="urlViewer" urlExpr="$(serverUrl) + '/nms/deliveryPreview.jssp?alert='+urlUtf8Encode([/tmp/iosMessage/preview/content/iosMessage])+'&amp;messageType=' + [/delivery/@messageType] + '&amp;image='+[/tmp/rcpQryResult/queryResult/message/custom/appSubscription/mobileApp/@img] + '&amp;title='+[/tmp/rcpQryResult/queryResult/message/custom/appSubscription/mobileApp/@label]"/>
              </container>
            </container>
          </container>
          <container name="android">
            <container img="nms:android.png" label="android" name="androidContentEditor">
              <container colcount="2" label="Content" maxLabelWidth="80" name="tabContent">
                <container colspan="2">
                  <input fullToolbar="true" htmlMode="false" label="Message" name="ctSource" nolabel="false" type="htmlSource" xpath="androidMessage/source" xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                    </container>
                  </input>
                </container>
                <static colspan="2" label="Application variables" type="separator"/>
                <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
                  <input colspan="2" editable="false" hideEditButtons="true" label=" " nolabel="false" type="list" xpath="/tmp/notificationCustomFields/customFieldsItem">
                    <input label="Key" readOnly="true" type="edit" xpath="@key"/>
                    <input editable="true" label="Value" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="@value"/>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]=1">
                  <input colspan="2" editable="true" label=" " nolabel="false" type="list" xpath="/tmp/notificationCustomFields/customFieldsItem" zoomOnAdd="false">
                    <input label="Key" type="edit" xpath="@key"/>
                    <input label="Value" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="@value"/>
                  </input>
                </container>
              </container>
              <container colcount="2" label="Preview" name="tabPreview">
                <input colspan="2" name="previewToolbar" type="toolbarCtrl"/>
                <static/>
                <input label="Data loaded..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="/tmp/rcpQryResult">
                  <form label="Data of the recipient loaded for the preview">
                    <input nolabel="true" readOnly="true" type="SourceEdit" xpath="queryResult"/>
                  </form>
                </input>
                <static colspan="2" type="separator"/>
                <container ref="nms:delivery:lib/content/Preview/body" xpath="androidMessage"/>
                <input sessionToken="true" type="urlViewer" urlExpr="$(serverUrl) + '/nms/deliveryPreview.jssp?messageType='+[/delivery/@messageType]+'&amp;alert=' + urlUtf8Encode([/tmp/androidMessage/preview/content/]) +  '&amp;image='+[/tmp/rcpQryResult/queryResult/message/custom/appSubscription/mobileApp/@img] + '&amp;title='+[/tmp/rcpQryResult/queryResult/message/custom/appSubscription/mobileApp/@label]"/>
              </container>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:campaign')" colcount="2" label="Expenses and revenue" name="budget" visibleIf="[/ignored/@useBudget]">
          <container colcount="2" colspan="2" img="nms:budget-max.png" label="Expenses" type="frame">
            <container colcount="4" colspan="2" type="visibleGroup" visibleIf="@isModel=false">
              <container colcount="4" ref="nms:plan:lib/budgetParam"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="@isModel">
              <input createMode="none" noZoom="true" xpath="budget"/>
              <static label=" "/>
            </container>
          </container>
          <container colspan="2" ref="nms:plan:lib/objective" xpath="."/>
        </container>
        <container name="targetFrame" xpath="mailParameters">
          <input alwaysActive="true" colspan="2" expr="Iif([../targets/@targetMode]>=3, [/ignored/@strPopFromWkf], Iif([../targets/@targetMode]=0, Coalesce([../targets/deliveryTarget/@serialization], [/ignored/@strPopEmpty]), [/ignored/@strPopFromFile]))" type="expr" xpath="/tmp/target"/>
          <input discardReadOnly="true" label="To" margin-right="5" prebuildSubForm="false" type="subFormLink" xpath="..">
            <form label="Select target" readOnlyExpr="[/tmp/@readOnly] AND ([/delivery/@FCP]!=1 OR [/delivery/@state]>EVal([/delivery/@state], 'ready'))">
              <container type="notebook">
                <container label="Main target" readOnlyExpr="[/tmp/@readOnly]" xpath="targets">
                  <enter>
                    <set expr="iif ([/ignored/@socialMessage]!=1 or [../@isModel] or [/ignored/@pushMessage]!=1, 1, 0)" xpath="/ignored/@showMappingChoice"/>
                    <if expr="HasPackage('crm:lead')">
                      <set value="true" xpath="@noReconciliation"/>
                    </if>
                  </enter>
                  <container ref="nms:delivery:lib/mainTarget"/>
                </container>
                <container applicableIf="HasPackage('nms:social')" colcount="2" label="Audience" visibleIf="EV(@messageType,'facebook') and [mapping/@name]=='mapService'">
                  <static colspan="2" type="help">Use the Facebook filters to refine the audience. Use commas to enter several values.</static>
                  <input label="Country" lineCount="2" xpath="content/facebookCountries/source"/>
                  <static label="For instance: US,GB,FR"/>
                  <input label="Regions" lineCount="2" xpath="content/facebookRegions/source"/>
                  <static label="For instance: 55 for Wisconsin, 44 for Rhode Island, etc."/>
                  <input label="Cities" lineCount="2" xpath="content/facebookCities/source"/>
                  <static label="For instance: 812057 for London (England), 777934 for Paris (France) "/>
                  <input label="Languages" lineCount="2" xpath="content/facebookLocales/source"/>
                  <static label="For instance: 9 for French (France), 6 for English (US), 24 for English (UK), etc."/>
                </container>
                <container applicableIf="HasPackage('nms:social')" label="Audience" visibleIf="EV(@messageType,'facebook') and ([mapping/@name]=='mapVisitor' or [mapping/@name]=='mapVisitorSub')">
                  <input label="Message display conditions" type="separator"/>
                  <input checkedValue="EVERYONE" label="Everyone" nolabel="true" type="RadioButton" xpath="content/facebookPrivacy/source"/>
                  <input checkedValue="ALL_FRIENDS" label="Only friends of the fan" nolabel="true" type="RadioButton" xpath="content/facebookPrivacy/source"/>
                  <input checkedValue="CUSTOM_SELF" label="Only the fan" nolabel="true" type="RadioButton" xpath="content/facebookPrivacy/source"/>
                  <static type="warning">Please comply with Facebook terms of use regarding the publishing of messages on fans' timelines. Adobe will not be held responsible in case of misuse of this functionality.</static>
                </container>
                <container label="Target of the proofs">
                  <container ref="nms:delivery:lib/proofTarget"/>
                </container>
                <container label="Exclusions" name="targetOptions" propagateConstraints="false" xpath="targets">
                  <enter ref="nms:delivery:lib/overFiltering"/>
                  <container label="Exclusion settings" type="frame">
                    <input label="Edit..." type="subFormLink" xpath=".">
                      <form label="Exclusion settings">
                        <container type="visibleGroup" visibleIf="[../@messageType]!=5">
                          <input nolabel="true" useDesc="true" xpath="@deduplicate"/>
                        </container>
                        <input nolabel="true" useDesc="true" xpath="@useBlackList"/>
                        <container type="visibleGroup" visibleIf="EV([../@messageType],'paper')==false and [../@messageType]!=5">
                          <input nolabel="true" xpath="@useQuarantine"/>
                        </container>
                        <container type="visibleGroup" visibleIf="EV([../@messageType],'paper')">
                          <container colcount="3" enabledIf="[/ignored/postalAddress/@noErrorCount]==false" type="enabledGroup">
                            <input label="Exclude addresses with a number of consecutive errors greater than or equal to " nolabel="true" xpath="@useQuarantine"/>
                            <input nolabel="true" xpath="@maxErrorCount"/>
                          </container>
                          <container type="visibleGroup" visibleIf="[/ignored/postalAddress/@noLastCheck]==false">
                            <input nolabel="true" xpath="@allowUnchecked"/>
                          </container>
                          <container colcount="3" type="visibleGroup" visibleIf="[/ignored/postalAddress/@noQuality]==false">
                            <input label="Exclude address with quality rating lower than" nolabel="true" xpath="@useQuality"/>
                            <input nolabel="true" xpath="@qualityRequired"/>
                          </container>
                        </container>
                        <container ref="nms:delivery:lib/deliveryLimitDef" xpath=".."/>
                        <static type="help">Used to limit the number of messages to send. If the number of messages to send is too large, some messages are removed randomly. If the number of numbers equals zero, the full targeting potential will be used.</static>
                        <container type="visibleGroup" visibleIf="@deduplicate == false and ( EV(@targetMode, 'file')==false or @noReconciliation==false )">
                          <input nolabel="true" xpath="@noRcpIdDedup"/>
                          <static type="help">Used to send the same messages multiple times to recipients belonging to more than one element of the target (for instance a list and a subscription).</static>
                        </container>
                        <leave ref="nms:delivery:lib/overFiltering"/>
                      </form>
                    </input>
                    <input fontBold="true" lineCount="3" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/ignored/humanFilter"/>
                  </container>
                  <container ref="nms:delivery:lib/typology" xpath=".."/>
                </container>
                <container applicableIf="HasPackage('nms:campaign')" label="Control group" visibleIf="(@isModel or [@operation-id]!=0) and @FCP=0" xpath="execution/controlGroup">
                  <container ref="nms:operation:lib/controlGroup" xpath=".."/>
                </container>
                <container label="Seed addresses" visibleIf="@FCP=0 AND [/ignored/@pushMessage]!=1">
                  <input img="nms:unknownad.png" label="Import seed templates..." prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form forceToSaveEntity="true" label="Select the seed addresses">
                      <container defaultColumns="@label,[custom_nms_recipient/@email],[custom_nms_broadLog/postalAddress/address/serialized]" multiSelection="true" newEntityFormChoice="true" nodeModel="nmsSeedList" schema="nms:seedMember" sharedUserConfig="true" type="navTreeEntityList" xpath="/ignored/seedMember">
                        <sysFilter>
                          <condition expr="@isModel=1"/>
                        </sysFilter>
                      </container>
                      <leave>
                        <soapCall name="getAsModel" noRefresh="true" service="nms:seedMember">
                          <param exprIn="'delivery-id'" type="string"/>
                          <param exprIn="@id" type="int"/>
                          <param exprIn="/tmp/navTreeEntityList/output/nmsSeedList" type="DOMElement"/>
                          <param exprIn="." type="DOMElement"/>
                          <param type="DOMElement" xpathOut="."/>
                        </soapCall>
                        <set value="*" xpath="/tmp/seedMember"/>
                      </leave>
                    </form>
                  </input>
                  <input editable="false" form="nms:seedMember" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" toolbarCaption="List of seed addresses" type="list" xpath="seedMember" xpathRefresh="/tmp/seedMember" zoom="true" zoomOnAdd="true">
                    <input editable="true" xpath="@label"/>
                    <input editable="true" xpath="@internalName"/>
                  </input>
                  <container label="Dynamic condition on the seed-address templates" type="frame">
                    <input img="nms:miniatures/mini-incremental.png" label="Edit the dynamic condition..." type="subFormLink" xpath="output/seedList">
                      <form label="Dynamic condition">
                        <input nolabel="true" schema="nms:seedMember" toolbarAlign="horizontal" toolbarCaption="Filter conditions" type="conditionList" xpath="where" xpathCurrentLookupPath="/lookupPath/where" xpathHelp="/@helpCond">
                          <input colSize="15" label=" " xpath="/@bool-operator"/>
                          <input colSize="30" label="Expression" xpath="/@leftExpr"/>
                          <input colSize="15" label="Operator" xpath="/@operator"/>
                          <input colSize="30" label="Value" xpath="/@rightExpr"/>
                        </input>
                        <input expr="[/@helpCond]" type="expr" xpath="@humanCond"/>
                      </form>
                    </input>
                    <container type="visibleGroup" visibleIf="NodeCount([output/seedList/where/condition])>0">
                      <input fontBold="true" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="output/seedList/@humanCond"/>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')">
                    <input xpath="output/seedList/@insertMode"/>
                  </container>
                </container>
              </container>
              <leave>
                <if expr="HasPackage('nms:mobileApp')">
                  <reset xpath="/tmp/notificationCustomFields"/>
                  <reset xpath="/tmp/notificationSounds"/>
                  <copyElement xpathDst="/tmp/notificationCustomFields" xpathSrc="/delivery/targets/deliveryTarget/targetPart/where/ctx/tmp/list/mobileApp/notificationCustomFields"/>
                  <copyElement xpathDst="/tmp/notificationSounds" xpathSrc="/delivery/targets/deliveryTarget/targetPart/where/ctx/tmp/list/mobileApp/notificationSounds"/>
                </if>
              </leave>
            </form>
          </input>
        </container>
        <container name="segment">
          <input colspan="2" nolabel="true" useDesc="true" xpath="@exclusion"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="FieldExists([../../../mapping/storage/@broadLogSchema], '@segmentCode') and @exclusion == false">
            <container colcount="2" colspan="2" label="Segment code" type="frame">
              <input label="Type" xpath="@segmentCodeType"/>
              <container type="visibleGroup" visibleIf="EV(@segmentCodeType, 'calculated')==false">
                <container enabledIf="EV(@segmentCodeType, 'constant')" type="enabledGroup">
                  <input nolabel="true" xpath="@segmentCodeVal"/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="EV(@segmentCodeType, 'calculated')">
                <input nolabel="true" type="pathEdit" xpath="segmentCodeExpr" xpathSchema="../../../mapping/@schema"/>
              </container>
            </container>
          </container>
        </container>
        <container name="typology">
          <static label="Filtering rules" type="separator"/>
          <container type="visibleGroup" visibleIf="NodeCount(typologyFilter)=0 and NodeCount(ruleFilter)=0 and [/ignored/@addFilterRule]!=1">
            <input img="xtk:filter.png" label="Add a filtering rule" type="urlButton">
              <enter>
                <set value="1" xpath="/ignored/@addFilterRule"/>
              </enter>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="NodeCount(typologyFilter)>0 or NodeCount(ruleFilter)>0 or [/ignored/@addFilterRule]=1">
            <input colspan="2" img="nms:typofolder.png" nolabel="true" toolbarCaption="Filtering typology" type="list" xpath="typologyFilter" xpathChoiceTarget="typology">
              <input createMode="none" fullLoad="true" xpath="typology">
                <sysFilter>
                  <condition expr="@type=1"/>
                </sysFilter>
              </input>
            </input>
            <input colspan="2" img="nms:typorule.png" nolabel="true" toolbarCaption="Filtering rules" type="list" xpath="ruleFilter" xpathChoiceTarget="rule">
              <input createMode="none" fullLoad="true" xpath="rule">
                <sysFilter>
                  <condition expr="@active=1"/>
                  <condition expr="@ruleType='sql'"/>
                  <condition>
                    <condition boolOperator="OR" enabledIf="$(../@messageType)!=''" expr="@messageType=$(../@messageType)"/>
                    <condition expr="@messageType=127"/>
                  </condition>
                </sysFilter>
              </input>
            </input>
          </container>
        </container>
        <container name="deliveryLimitDef">
          <container colcount="2" type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')=false or [/ignored/@limitEdition]!=false">
            <container type="visibleGroup" visibleIf="[/tmp/@hasDeliveryLimitExpr] = false">
              <input label="Limit delivery to" xpath="targets/@deliveryLimit"/>
            </container>
            <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[/tmp/@hasDeliveryLimitExpr] = true">
              <container readOnlyIf="@state >= Eval(@state, 'targetReady')" type="readOnlyGroup">
                <input label="Limit delivery to" nolabel="false" schema="nms:delivery" type="pathEdit" xpath="targets/@deliveryLimitExpr"/>
              </container>
            </container>
            <static>messages</static>
          </container>
          <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external') and [/ignored/@limitEdition]=false">
            <container type="visibleGroup" visibleIf="[/tmp/@hasDeliveryLimitExpr] = false">
              <input label="Requested quantity" xpath="targets/@deliveryLimit"/>
            </container>
            <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[/tmp/@hasDeliveryLimitExpr] = true">
              <container readOnlyIf="@state >= Eval(@state, 'targetReady')" type="readOnlyGroup">
                <input label="Requested quantity" nolabel="false" schema="nms:delivery" type="pathEdit" xpath="targets/@deliveryLimitExpr"/>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 and [/ignored/tmp/@workflowId]!=0 and [/ignored/tmp/@workflowId]!=''">
            <container readOnlyIf="@state >= Eval(@state, 'targetReady')" type="readOnlyGroup">
              <input label="Use a calculation formula" type="checkBox" xpath="/tmp/@hasDeliveryLimitExpr"/>
            </container>
          </container>
        </container>
        <container name="contactDateDef">
          <container type="visibleGroup" visibleIf="@isModel=false and EV(@deliveryMode, 'external')=false or [/ignored/@limitEdition]!=false">
            <input xpath="scheduling/@contactDate" xpathTimeZone="scheduling/@contactDateTimeZone"/>
          </container>
          <container type="visibleGroup" visibleIf="@isModel=false and EV(@deliveryMode, 'external') and [/ignored/@limitEdition]=false">
            <input discardReadOnly="true" xpath="scheduling/@contactDate"/>
          </container>
        </container>
        <container name="extractionDateDef">
          <container type="visibleGroup" visibleIf="@isModel=false and [@operation-id]!=0 and (EV(@deliveryMode, 'external')=false or [/ignored/@limitEdition]!=false)">
            <input xpath="scheduling/@extraction"/>
          </container>
          <container type="visibleGroup" visibleIf="@isModel=false and [@operation-id]!=0 and (EV(@deliveryMode, 'external') and [/ignored/@limitEdition]=false)">
            <container type="visibleGroup" visibleIf="@state &lt;= EVal(@state, 'ready') or EV([validation/@sandboxMode], 'complete')=false">
              <input xpath="scheduling/@extraction"/>
            </container>
            <container type="visibleGroup" visibleIf="@state > EVal(@state, 'ready') and EV([validation/@sandboxMode], 'complete')">
              <input readOnly="true" xpath="scheduling/@extracted"/>
            </container>
          </container>
        </container>
        <container name="dateSchedulingDef">
          <container type="visibleGroup" visibleIf="[/tmp/@hasDateExpr] = false">
            <container applicableIf="HasPackage('nms:campaign')" ref="nms:delivery:lib/extractionDateDef"/>
            <container ref="nms:delivery:lib/contactDateDef"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/@hasDateExpr] = true">
            <container applicableIf="HasPackage('nms:campaign')" colcount="2" colspan="2" type="visibleGroup" visibleIf="[@operation-id]!=0">
              <container ref="nms:delivery:lib/extractionDateDef"/>
              <container type="visibleGroup" visibleIf="[/tmp/@hasDateExpr] = true">
                <container readOnlyIf="@state >= Eval(@state, 'targetReady')" type="readOnlyGroup">
                  <input label="Extraction calculation" nolabel="false" schema="nms:delivery" type="pathEdit" xpath="scheduling/@extractionExpr"/>
                </container>
              </container>
            </container>
            <container colcount="2" colspan="2">
              <container ref="nms:delivery:lib/contactDateDef"/>
              <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[/tmp/@hasDateExpr] = true">
                <container readOnlyIf="@state >= Eval(@state, 'targetReady')" type="readOnlyGroup">
                  <input label="Contact date calculation" nolabel="false" schema="nms:delivery" type="pathEdit" xpath="scheduling/@contactDateExpr"/>
                </container>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 and [/ignored/tmp/@workflowId]!=0 and [/ignored/tmp/@workflowId]!=''">
            <container readOnlyIf="@state >= Eval(@state, 'targetReady')" type="readOnlyGroup">
              <input label="Use a calculation formula" type="checkBox" xpath="/tmp/@hasDateExpr"/>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0 and (@state &lt;= EVal(@state, 'ready') or EV([validation/@sandboxMode], 'complete')=false)">
            <static label="On the extraction date, the target and personalization data will be set.\nBy default, extraction is carried out after the delivery approval." type="help"/>
            <container type="visibleGroup" visibleIf="hasPackage('nms:campaignOptimization')">
              <static label="Sales pressure will impact the target from its creation until it is extracted. Sales pressure will take into account the contact date." type="help"/>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:centralLocal')" type="visibleGroup" visibleIf="EV([operation/centralLocal/@centralLocalType], 'mutualized') and EV([operation/centralLocal/@sharedMode], 'localizedWeb', 'localizedOperation')">
            <input xpath="scheduling/@delayExtraction"/>
            <static type="help">Maximum wait period before forced extraction. Only child campaigns whose target has been calculated will be taken into account. If the deadline is equal to zero, extraction will only be carried out once the child campaigns are ready.</static>
          </container>
          <input xpath="scheduling/@contactDateTimeZone"/>
        </container>
        <enter name="overFiltering">
          <set value="" xpath="/ignored/humanFilter"/>
          <if expr="@deduplicate and [../@messageType] != 5">
            <set translatedExpr="'Exclude duplicate addresses.'" xpath="/ignored/humanFilter"/>
          </if>
          <if expr="@useBlackList">
            <set translatedExpr="[/ignored/humanFilter]+'Exclude recipients no longer wishing to be contacted. '" xpath="/ignored/humanFilter"/>
          </if>
          <if expr="@useQuarantine and EV([../@messageType],'paper')==false and [../@messageType]!=5">
            <set translatedExpr="[/ignored/humanFilter]+'Exclude quarantined recipients. '" xpath="/ignored/humanFilter"/>
          </if>
          <if expr="@useQuarantine and EV([../@messageType],'paper')==true and [/ignored/postalAddress/@noErrorCount]==false">
            <set translatedExpr="[/ignored/humanFilter]+'Exclude addresses with a number of consecutive errors greater than or equal to ' + @maxErrorCount + '. '" xpath="/ignored/humanFilter"/>
          </if>
          <if expr="@allowUnchecked and EV([../@messageType],'paper')==true and [/ignored/postalAddress/@noLastCheck]==false">
            <set translatedExpr="[/ignored/humanFilter]+'Authorized unqualified addresses. '" xpath="/ignored/humanFilter"/>
          </if>
          <if expr="@useQuality and EV([../@messageType],'paper')==true and [/ignored/postalAddress/@noQuality]==false">
            <set translatedExpr="[/ignored/humanFilter]+'Exclude addresses with a quality index lower than ' + @qualityRequired + '. '" xpath="/ignored/humanFilter"/>
          </if>
          <if expr="@useDeliveryLimit">
            <set translatedExpr="[/ignored/humanFilter]+'Limit the delivery to '+@deliveryLimit + '. '" xpath="/ignored/humanFilter"/>
          </if>
          <if expr="@deduplicate == false and ( EV(@targetMode, 'file')==false or @noReconciliation==false ) and @noRcpIdDedup">
            <set translatedExpr="[/ignored/humanFilter]+'Save records targeted twice (same identifier).'" xpath="/ignored/humanFilter"/>
          </if>
        </enter>
        <container name="prepareDelivery">
          <container name="submit" prepareRights="deliveryPrepare" type="deliverySubmitContainer" validateRights="deliveryValidate" xpathCurProgress="properties/progress/@current" xpathMaxProgress="properties/progress/@max" xpathMethodName="/ignored/@methodeName" xpathStatus="@status">
            <container type="visibleGroup" visibleIf="[/ignored/@start] and [/ignored/@showTarget]=false">
              <input name="JobLogsList" type="JobLogList"/>
            </container>
            <container colcount="2" type="visibleGroup" visibleIf="[/ignored/@start] and EV([properties/@deliveryState], 'startPending', 'started', 'finished')=false">
              <value dataType="timespan" label="Elapsed" xpath="/tmp/execution/@elapsed"/>
              <value dataType="timespan" label="Estimated left" xpath="/tmp/execution/@remaining"/>
            </container>
            <container colcount="4" type="visibleGroup" visibleIf="EV([properties/@deliveryState], 'startPending', 'started', 'finished')=false">
              <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/execution/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/execution/@remaining"/>
              <input img="xtk:runtask.png" label="&amp;Analyze" name="JobSubmitButton" type="flatbutton">
                <enter>
                  <if expr="[/ignored/@actionMode]=1">
                    <check expr="[scheduling/@contactDate]!='' and [scheduling/@contactDate]>GetDate()">
                      <error>Please enter a valid contact date.</error>
                    </check>
                    <set value="1" xpath="scheduling/@delayed"/>
                  </if>
                  <set value="nms:delivery" xpath="/ignored/ServerSideState/@schema"/>
                  <set value="getIfExists" xpath="/ignored/ServerSideState/@operation"/>
                  <set value="@state" xpath="/ignored/ServerSideState/select/node[1]/@expr"/>
                  <set expr="'@id=' + @id" xpath="/ignored/ServerSideState/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/ServerSideState]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/tmp/ServerSideState"/>
                  </soapCall>
                  <check expr="[/tmp/ServerSideState/@state]='' OR [/tmp/ServerSideState/@state]=@state">
                    <error>Delivery analyzed or being started: please close then reopen this screen to update data.</error>
                  </check>
                  <if expr="@deliveryMode > 0 and [scheduling/@contactDate]&lt;GetDate() and @launchFCP==0">
                    <set expr="GetDate()" xpath="scheduling/@contactDate"/>
                  </if>
                  <if expr="[scenario/@setDirectDates]=0 and [scheduling/@contactDate]!=''">
                    <set expr="DateAdd([scheduling/@contactDate], [scenario/@validityDuration])" xpath="scheduling/@validityDate"/>
                  </if>
                  <set value="true" xpath="/ignored/@start"/>
                  <set value="true" xpath="/ignored/@analyzed"/>
                  <set value="false" xpath="/ignored/@showTarget"/>
                  <set value="nl:arrow_ntf_orange.png" xpath="/ignored/@img"/>
                  <if expr="@launchFCP=1 and [/ignored/@deliveryState]!='' and [/ignored/@deliveryState]!=@state">
                    <set expr="[/ignored/@deliveryState]" xpath="@state"/>
                    <set expr="[/ignored/@deliveryState]" xpath="properties/@deliveryState"/>
                  </if>
                  <if expr="[/ignored/@_isNewEntity]">
                    <set value="insertOrUpdate" xpath="@_operation"/>
                  </if>
                  <if expr="HasPackage('nms:campaign') and [/ignored/@operationId] and [/ignored/tmp/@workflowId]=0 and @launchFCP=0">
                    <set expr="Eval(@targetStatus, 'edition')" xpath="@targetStatus"/>
                    <set expr="Eval(@budgetStatus, 'edition')" xpath="@budgetStatus"/>
                    <set expr="Eval(@extractionStatus, 'edition')" xpath="@extractionStatus"/>
                    <set expr="Eval(@sandboxStatus, 'edition')" xpath="@sandboxStatus"/>
                  </if>
                  <if expr="@launchFCP=1 or ([/ignored/@actionMode]!=2 and [/ignored/@useTargetValidation]=false)">
                    <set value="Prepare" xpath="/ignored/@methodeName"/>
                  </if>
                  <if expr="@launchFCP=0 and ([/ignored/@actionMode]=2 or [/ignored/@useTargetValidation])">
                    <set value="PrepareTarget" xpath="/ignored/@methodeName"/>
                  </if>
                  <set expr="[targets/deliveryTarget/@serialization]" xpath="/ignored/deliveryTargetSerialization"/>
                  <set expr="[targets/proofTarget/@serialization]" xpath="/ignored/proofTargetSerialization"/>
                  <if expr="HasPackage('nms:mobileApp')">
                    <copyElement exprDst="'/delivery/content/' + Iif(@messageType=41, 'ios', 'android') + 'CustomFields/source'" xpathSrc="/tmp/notificationCustomFields"/>
                    <copyElement exprDst="'/delivery/content/' + Iif(@messageType=41, 'ios', 'android') + 'AvailableSounds/source'" xpathSrc="/tmp/notificationSounds"/>
                  </if>
                  <reset xpath="/delivery/offerSpace"/>
                  <if expr="[/ignored/offerSpace/@id] != '' and [/ignored/offerSpace/@id] != 0">
                    <set expr="[/ignored/offerSpace/@id]" xpath="/delivery/offerSpace/@id"/>
                    <set expr="[/ignored/offerSpace/@_cs]" xpath="/delivery/offerSpace/@_cs"/>
                    <set expr="[/ignored/offerSpace/env/@id]" xpath="/delivery/offerSpace/env/@id"/>
                    <set expr="[/ignored/offerSpace/env/@propositionSchema]" xpath="/delivery/offerSpace/env/@propositionSchema"/>
                  </if>
                </enter>
              </input>
              <input expr="(@launchFCP=0 and [/ignored/deliveryTargetSerialization]!='' and [/ignored/deliveryTargetSerialization]!=[targets/deliveryTarget/@serialization]) or                                  (@launchFCP=1 and [/ignored/proofTargetSerialization]!='' and [/ignored/proofTargetSerialization]!=[targets/proofTarget/@serialization])" type="expr" xpath="/ignored/@isTargetModified"/>
              <container type="visibleGroup" visibleIf="![/ignored/@isTargetModified] and (([/ignored/@actionMode]!=2 and [/ignored/@useTargetValidation]=false and EV(@state, 'edition', 'targetPrepPending', 'targetReady', 'ready', 'preparationError') and [/ignored/@hasDeliveryContent]) or @launchFCP=1)">
                <input img="xtk:play.png" label="&amp;Confirm delivery" name="DeliveryPlayButton" type="flatbutton">
                  <enter>
                    <if expr="[/ignored/@actionMode]=0 and @launchFCP=0">
                      <set expr="GetDate()" xpath="scheduling/@contactDate"/>
                      <set value="0" xpath="scheduling/@delayed"/>
                    </if>
                    <if expr="[/ignored/@actionMode]=1">
                      <check expr="[scheduling/@contactDate]!='' and [scheduling/@contactDate]>GetDate()">
                        <error>Please enter a valid contact date.</error>
                      </check>
                      <set value="1" xpath="scheduling/@delayed"/>
                    </if>
                    <set value="true" xpath="/ignored/@start"/>
                    <set value="false" xpath="/ignored/@showTarget"/>
                    <set value="nl:arrow_ntf_orange.png" xpath="/ignored/@img"/>
                    <if expr="[/ignored/@_isNewEntity]">
                      <set value="insertOrUpdate" xpath="@_operation"/>
                    </if>
                  </enter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="![/ignored/@isTargetModified] and [/ignored/@targetStatus]=0 AND [properties/@deliveryState] >= EVal([properties/@deliveryState], 'targetReady') and EV([properties/@deliveryState], 'preparationError')=false and HasPackage('nms:campaign') and @launchFCP=0 and [/ignored/@useTargetValidation]">
                <input img="nms:validation.png" label="&amp;Submit the target for approval" promptLabel="Please confirm the submittal of target approval" type="flatbutton">
                  <enter>
                    <set value="false" xpath="/ignored/@showTarget"/>
                    <set value="nl:arrow_ntf_orange.png" xpath="/ignored/@img"/>
                    <set expr="Eval(@targetStatus, 'inWaiting')" xpath="@targetStatus"/>
                    <set value="nms:delivery" xpath="/ignored/writer/delivery/@xtkschema"/>
                    <set value="update" xpath="/ignored/writer/delivery/@_operation"/>
                    <set expr="@id" xpath="/ignored/writer/delivery/@id"/>
                    <set expr="Eval(@targetStatus, 'edition')" xpath="/ignored/writer/delivery/@targetStatus"/>
                    <set expr="Eval(@budgetStatus, 'edition')" xpath="/ignored/writer/delivery/@budgetStatus"/>
                    <if expr="[validation/@useBudgetValidation] and [@budget-id]!=0">
                      <set expr="Eval(@budgetStatus, 'inWaiting')" xpath="/ignored/writer/delivery/@budgetStatus"/>
                    </if>
                    <set expr="Eval(@extractionStatus, 'edition')" xpath="/ignored/writer/delivery/@extractionStatus"/>
                    <set expr="Eval(@sandboxStatus, 'edition')" xpath="/ignored/writer/delivery/@sandboxStatus"/>
                    <if expr="[validation/@sandboxMode]=1">
                      <set expr="Eval(@sandboxStatus, 'inWaiting')" xpath="/ignored/writer/delivery/@sandboxStatus"/>
                    </if>
                    <soapCall name="Write" service="xtk:persist">
                      <param exprIn="[/ignored/writer/delivery]" type="DOMDocument"/>
                    </soapCall>
                    <soapCall name="DeliveryValidation" service="nms:operation">
                      <param exprIn="@id" type="int"/>
                      <param exprIn="10" type="byte"/>
                      <param exprIn="0" type="boolean"/>
                      <param exprIn="[/tmp/comment]" type="string"/>
                    </soapCall>
                  </enter>
                </input>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container ref="xtk:import:general/warningBuiltIn"/>
      <container applicableIf="HasPackage('nms:messageCenter')" colcount="2" type="visibleGroup" visibleIf="@isModel=false and [/ignored/@triggerMessage]=1">
        <input xpath="@label"/>
        <input xpath="@internalName"/>
      </container>
      <container colcount="2" type="visibleGroup" visibleIf="@isModel">
        <input xpath="@label"/>
        <input xpath="@internalName"/>
        <input alwaysActive="1" expr="Iif(@isModel and NodeExists([deliveryProvider/@messageType]), [deliveryProvider/@messageType], @messageType)" type="expr" xpath="@messageType"/>
        <input alwaysActive="1" expr="Iif(@isModel and NodeExists([deliveryProvider/@deliveryMode]), [deliveryProvider/@deliveryMode], @deliveryMode)" type="expr" xpath="@deliveryMode"/>
      </container>
      <container name="edit" showIconsIf="EV(@deliveryMode, 'descriptive') or (EV(@state, 'edition')=false and [/ignored/@limitEdition]=false)" type="iconbox">
        <container img="xtk:form.png" label="Summary" name="summary" visibleIf="@state > 0 and [/ignored/@limitEdition]=false">
          <container ref="nms:delivery:lib/summary"/>
        </container>
        <container img="nms:miniatures/mini-delivery.png" label="File" name="fileDefinition" visibleIf="EV(@deliveryMode, 'external')" xpathEnum="@messageType">
          <container type="visibleGroup" visibleIf="[/ignored/@limitEdition]=false and [/ignored/@triggerMessage]!='1'">
            <container colcount="2" label="Delivery target population" name="headers" type="frame">
              <container ref="nms:delivery:lib/targetFrame"/>
              <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="![/ignored/@operationId]">
            <container type="notebook">
              <container colcount="2" label="Extraction" xpath="output">
                <input colspan="2" useDesc="true" xpath="@downloadDestFile"/>
                <container colspan="2" type="visibleGroup" visibleIf="@downloadDestFile">
                  <input defExt="txt" filters="Text files (*.txt;*.tab)|*.txt;*.tab|CSV files (*.csv)|*.csv|XML files (*.xml)|*.xml|All (*.*)|*.*|" label="Local file" required="true" type="saveFileEdit" xpath="@fileName"/>
                </container>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@downloadDestFile = 'false'">
                  <input label="File" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="outputScript"/>
                  <static label="Calculation script for the file name to extract." type="help"/>
                </container>
                <container colspan="2" ref="nms:delivery:lib/extractionDef" xpath="."/>
                <container colspan="2" type="visibleGroup" visibleIf="EV([../@deliveryMode], 'external')">
                  <input xpath="../scheduling/@contactDate"/>
                </container>
                <input colspan="2" label="Requested quantity" xpath="../targets/@deliveryLimit"/>
              </container>
              <container label="Preview">
                <input name="outputPreviewToolbar" type="toolbarCtrl"/>
                <static type="separator"/>
                <input nolabel="true" refForForms="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabPreview/body/ctPreview" toolbarName="outputPreviewToolbar" type="outputPreview" xpath="output" xpathRcpQuery="/tmp/rcpQryResult/queryResult" xpathSelection="/ignored/selectPart/rcpList" xpathTargets="/delivery/targets"/>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@operation-id]!=0">
            <container type="visibleGroup" visibleIf="[@linkedDelivery-id]!=0">
              <container colspan="2" label="Main delivery" type="frame">
                <input colspan="2" label="Delivery" readOnly="true" xpath="linkedDelivery"/>
                <static label="The file extraction is performed from the main delivery." type="help"/>
              </container>
              <container colcount="2" label="Extraction" type="frame">
                <container colcount="2" colspan="2" ref="nms:delivery:lib/extraction"/>
              </container>
            </container>
            <container colcount="2" type="visibleGroup" visibleIf="[@linkedDelivery-id]=0">
              <container colspan="2" type="visibleGroup" visibleIf="EV(@deliveryMode, 'external') and [/ignored/@limitEdition]=false">
                <static img="xtk:scheduledtasks.png" label="Schedule" type="separator"/>
                <container ref="nms:delivery:lib/dateSchedulingDef"/>
              </container>
              <container colspan="2" ref="nms:delivery:lib/supplier"/>
              <container colspan="2" type="notebook">
                <container colcount="2" colspan="2" label="Extraction">
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@state >= 25">
                    <input label="Output file" readOnly="true" xpath="/ignored/@outputFile"/>
                    <static label="Location of file on server." type="help"/>
                  </container>
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@state &lt; 25 or EV(@state, 'preparationError')">
                    <input label="File" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="output/outputScript"/>
                    <static label="Calculation script for the file name to extract." type="help"/>
                  </container>
                  <container ref="nms:delivery:lib/extractionDef" xpath="output"/>
                  <container applicableIf="HasPackage('nms:centralLocal')" type="visibleGroup" visibleIf="EV([operation/centralLocal/@sharedMode], 'localizedOperation') and [@linkedDelivery-id]=0 and [operation/@linkedOperation-id]=0">
                    <input nolabel="true" xpath="output/@enableLinkDelivery"/>
                  </container>
                  <container applicableIf="HasPackage('nms:centralLocal')" type="visibleGroup" visibleIf="EV([operation/centralLocal/@sharedMode], 'localizedOperation')=false or [@linkedDelivery-id]!=0 or [operation/@linkedOperation-id]!=0">
                    <static/>
                  </container>
                  <container type="visibleGroup" visibleIf="HasPackage('nms:centralLocal')=false">
                    <static/>
                  </container>
                  <container colcount="2" colspan="2" ref="nms:delivery:lib/extraction"/>
                </container>
                <container label="Preview">
                  <input name="outputPreviewToolbar" type="toolbarCtrl"/>
                  <static type="separator"/>
                  <input nolabel="true" refForForms="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabPreview/body/ctPreview" toolbarName="outputPreviewToolbar" type="outputPreview" xpath="output" xpathRcpQuery="/tmp/rcpQryResult/queryResult" xpathSelection="/ignored/selectPart/rcpList" xpathTargets="/delivery/targets"/>
                </container>
              </container>
            </container>
          </container>
        </container>
        <container img="nms:campaign.png" label="Email" name="emailDefinition" visibleIf="EV(@messageType, 'mail') and @deliveryMode!=0">
          <container collection="/delivery/attachment" form="nms:uploadAttachment" label="Do you want to attach file {1} to the emails?" type="fileDropZone">
            <enter name="onClick">
              <set expr="[/tmp/@uploadFile]" xpath="name"/>
              <set value="normal" xpath="@type"/>
            </enter>
            <input alwaysActive="true" expr="iif([mailParameters/senderName]!='', [mailParameters/senderName]+' &lt;'+[mailParameters/senderAddress]+'>', '&lt;'+[mailParameters/senderAddress]+'>')" type="expr" xpath="/tmp/@sender"/>
            <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@linkedDelivery-id]!=0 and [@workflow-id]!=0">
              <container colcount="2" label="Delivery target population" name="headers" type="frame">
                <container ref="nms:delivery:lib/targetFrame"/>
                <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
              </container>
              <container label="Main delivery" type="frame">
                <input label="Delivery" readOnly="true" xpath="linkedDelivery"/>
                <static label="The content of the email is made from the main delivery." type="help"/>
                <static label="Preview" type="separator"/>
                <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')==false" xpath="linkedDelivery">
                  <container type="notebook">
                    <container img="xtk:html.png" label="HTML content" name="htmlContent" visibleIf="EV(@messageType, 'mail')" xpath="content/html/source">
                      <container ref="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabPreview"/>
                    </container>
                    <container img="xtk:textfile.png" label="Text content" name="textContent" visibleIf="EV(@messageType, 'mail')" xpath="content/text/source">
                      <container ref="nms:delivery:lib/content/Text/textContentEditor/notebook/tabPreview"/>
                    </container>
                  </container>
                </container>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@hasParentDelivery]!=1">
              <container colcount="2" label="Email parameters" name="headers" type="frame" xpath="mailParameters">
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/urlTree/@display]!=true and [/tmp/htmlDiagnostics/@display]!=true and [/ignored/@limitEdition]=false">
                  <input label="From" margin-right="5" prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="Email header parameters" maxLabelWidth="200">
                      <static type="help">Empty values will be replaced by the default platform\n
parameters configured in the deployment wizard.</static>
                      <input img="nms:sendemail.png" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="senderAddress"/>
                      <input menuId="deliveryMenuBuilder" type="scriptEdit" xpath="senderName"/>
                      <input img="nms:sendemail.png" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="replyAddress"/>
                      <input menuId="deliveryMenuBuilder" type="scriptEdit" xpath="replyName"/>
                      <input expr="IIf(replyAddress=='' and senderAddress!='', senderAddress, replyAddress)" type="expr" xpath="replyAddress"/>
                    </form>
                  </input>
                  <input nolabel="true" readOnly="true" xpath="/tmp/@sender"/>
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
                    <container ref="nms:delivery:lib/targetFrame" xpath=".."/>
                    <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
                  </container>
                  <input alwaysActive="true" expr="GroupConcat([/delivery/attachment], &quot; '[' + [@label] + ']' &quot; )" type="expr" xpath="/tmp/attachment"/>
                  <input expr="NodeCount([/delivery/attachment])>0" type="expr" xpath="../@hasAttachments"/>
                  <input label="Attachments" margin-right="5" prebuildSubForm="false" type="subFormLink" xpath="..">
                    <form desc="Please specify the attachments to be included with the emails." label="Edit attached files" title="Attached files" xpath=".">
                      <container collection="/delivery/attachment" form="nms:uploadAttachment" label="Do you want to attach file {1} to the emails?" type="fileDropZone">
                        <enter name="onClick">
                          <set expr="[/tmp/@uploadFile]" xpath="name"/>
                          <set value="normal" xpath="@type"/>
                        </enter>
                        <input delButton="true" editable="false" form="nms:attachment" hideEditButtons="true" img="nms:attachment.png" nolabel="true" prebuildSubForm="false" toolbarCaption="List of attached files" type="list" xpath="attachment" zoom="true" zoomOnAdd="true">
                          <container name="addToolbar">
                            <input collection="." img="xtk:xawadd.png" insertAfter="Add" label="Add" type="fileResAddMenuButton">
                              <command form="nms:uploadAttachment" label="File..." name="file">
                                <enter>
                                  <set expr="[/tmp/@uploadFile]" xpath="name"/>
                                  <set value="normal" xpath="@type"/>
                                </enter>
                              </command>
                              <command form="nms:attachment" label="Calculated attachment..." name="attachement">
                                <enter>
                                  <set value="1" xpath="@resourceType"/>
                                  <setModified/>
                                </enter>
                              </command>
                            </input>
                          </container>
                          <input editable="true" xpath="@label"/>
                          <input width="25" xpath="@type"/>
                          <input xpath="@size"/>
                        </input>
                      </container>
                    </form>
                  </input>
                  <input nolabel="true" readOnly="true" xpath="/tmp/attachment"/>
                </container>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@isLinkedToContent]='false'">
                  <container colcount="2" colspan="2" readOnlyIf="[/ignored/@limitEdition] and [/ignored/@contentStatus]!=10" type="readOnlyGroup">
                    <input label="Subject" margin-right="5" prebuildSubForm="false" type="subFormLink" xpath="subject">
                      <form label="Edit message subject" name="editForm" nothingToSave="true">
                        <static label="Subject" type="separator"/>
                        <input nolabel="true" toolbarAlign="horizontal" type="jstEdit" xpath="." xpathInsert="/ignored/customizeSubject">
                          <container>
                            <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeSubject"/>
                          </container>
                        </input>
                      </form>
                    </input>
                    <input nolabel="true" type="edit" xpath="subject"/>
                  </container>
                </container>
              </container>
              <container applicableIf="HasPackage('nms:aemIntegration')" type="visibleGroup" visibleIf="[/delivery/@contentEditingMode]=2 and [remoteContent/@remotePath] != ''">
                <container backcolor="tooltip" colcount="3" nolabel="true">
                  <static colspan="3" type="separator"/>
                  <static colspan="2" fontBold="true" label="Delivery synchronized with an AEM content. Content will be automatically retrieved at time of analysis."/>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[/delivery/@contentModTime]=''">
                    <input label="Refresh content" type="button">
                      <enter>
                        <soapCall name="aemGetContent" service="nms:delivery">
                          <param exprIn="/delivery" type="DOMElement"/>
                          <param type="DOMElement" xpathOut="/ignored/aemContent"/>
                        </soapCall>
                        <setModified/>
                        <set expr="[/ignored/aemContent/@approved]" xpath="remoteContent/@remoteValidation"/>
                        <set expr="GetDate()" xpath="remoteContent/@lastSync"/>
                        <set expr="[/ignored/aemContent/subject]" xpath="mailParameters/subject"/>
                        <set expr="[/ignored/aemContent/html]" xpath="content/html/source"/>
                        <set expr="[/ignored/aemContent/text]" xpath="content/text/source"/>
                      </enter>
                    </input>
                  </container>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[/delivery/@contentModTime]!=''">
                    <static/>
                  </container>
                  <value label="AEM content label" xpath="remoteContent/@remoteLabel"/>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[remoteContent/@remoteValidation]=true">
                    <static img="xtk:xtkcheck.png" label="AEM content approved"/>
                  </container>
                  <container backcolor="tooltip" type="visibleGroup" visibleIf="[remoteContent/@remoteValidation]=false">
                    <static img="xtk:xtkcancel.png" label="AEM content not approved"/>
                  </container>
                  <value label="Last synchronized" xpath="remoteContent/@lastSync"/>
                  <static colspan="3" type="separator"/>
                </container>
              </container>
              <input applicableIf="HasPackage('ncm:content')" expr="[@publishing-name]!='' and [@publishing-namespace]!=''" type="expr" xpath="/ignored/@hasContent"/>
              <container checkModify="true" type="notebook">
                <container activatedIf="true" applicableIf="HasPackage('ncm:content')" img="xtk:form.png" label="Edit" readOnlyIf="[/tmp/@readOnly] or ([/ignored/@limitEdition] and [/ignored/@contentStatus]!=10)" visibleIf="[/ignored/@hasContent]">
                  <input type="deliveryContent" xpath="content/content"/>
                </container>
                <container applicableIf="HasPackage('ncm:content')" img="xtk:html.png" label="HTML preview" visibleIf="[/ignored/@hasContent]" xpath="content/html">
                  <input name="previewToolbar" type="toolbarCtrl"/>
                  <static type="separator"/>
                  <container ref="nms:delivery:lib/content/Preview/headers/mail" xpath="/tmp/html/preview"/>
                  <container ref="nms:delivery:lib/content/Preview/body"/>
                </container>
                <container applicableIf="HasPackage('ncm:content')" img="xtk:text.png" label="Text preview" visibleIf="[/ignored/@hasContent]" xpath="content/text">
                  <input name="previewToolbar" type="toolbarCtrl"/>
                  <static type="separator"/>
                  <container ref="nms:delivery:lib/content/Preview/headers/mail" xpath="/tmp/text/preview"/>
                  <container ref="nms:delivery:lib/content/Preview/body"/>
                </container>
                <container img="xtk:html.png" label="HTML content" readOnlyIf="[/tmp/@readOnly] or ([/ignored/@limitEdition] and [/ignored/@contentStatus]!=10)" visibleIf="![/ignored/@hasContent]" xpath="content/html">
                  <container ref="nms:delivery:lib/content/HTML"/>
                </container>
                <container img="xtk:text.png" label="Text content" readOnlyIf="[/tmp/@readOnly] or ([/ignored/@limitEdition] and [/ignored/@contentStatus]!=10)" visibleIf="![/ignored/@hasContent]" xpath="content/text">
                  <container ref="nms:delivery:lib/content/Text"/>
                </container>
                <container applicableIf="HasPackage('nms:messageCenter')" img="nms:unknownad.png" label="Seed addresses" visibleIf="[/ignored/@triggerMessage]=1">
                  <container ref="nms:delivery:lib/proofTarget"/>
                </container>
              </container>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:paper')" img="nms:paper.png" label="Direct Mail" name="paperDefinition" visibleIf="EV(@messageType, 'paper') and @deliveryMode!=0">
          <container colcount="2" label="Target" name="headers" type="frame">
            <container ref="nms:delivery:lib/targetFrame"/>
            <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
          </container>
          <container label="Delivery content parameters" type="frame" xpath="content">
            <input xpath="../scheduling/@contactDate"/>
            <input xpath="@hasPdf"/>
            <container enabledIf="@hasPdf" type="enabledGroup">
              <input label="Type" xpath="@pdfType"/>
              <input label="Enable compression" xpath="@pdfCompression"/>
            </container>
          </container>
          <container name="paperContent" type="notebook">
            <container label="Content" name="PDFSimple" visibleIf="EV([content/@pdfType], 'simple') AND [content/@hasPdf]" xpath="content/pdf[1]">
              <container colcount="2" name="editPDFFile">
                <container colspan="2" type="visibleGroup" visibleIf="@upload">
                  <input filters="OpenOffice or Word documents (*.odt;*.doc)|*.odt;*.doc|All Files (*.*)|*.*|" label="Local file" type="fileEdit" xpath="name" xpathCopyName="@label" xpathCopySize="@size"/>
                </container>
                <container colspan="2" type="visibleGroup" visibleIf="@upload == false">
                  <input label="Server file" xpath="name"/>
                </container>
                <input xpath="@label"/>
                <input xpath="@compressMode"/>
                <container ref="xtk:importSource:sourceInfos/autoDetect/file/upload" xpath="."/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([../@pdfType], 'multiple')">
                  <input label="Advanced parameters..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
                    <form label="PDF content advanced parameters">
                      <input useDesc="true" xpath="@filterActive"/>
                      <container enabledIf="@filterActive" type="enabledGroup">
                        <input jst="false" nolabel="true" type="jstEdit" xpath="filterScript" xpathInsert="/ignored/customizePdfFilter">
                          <container>
                            <input menuId="deliveryMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizePdfFilter"/>
                          </container>
                        </input>
                        <static type="help">This script determines whether each recipient should receive the PDF file (if the script returns 'true').</static>
                      </container>
                    </form>
                  </input>
                  <container type="visibleGroup" visibleIf="@filterActive">
                    <static fontBold="true" label="(Filter active)"/>
                  </container>
                </container>
                <container colspan="2" enabledIf="@md5 != '' or ( @upload == false and name != '' )" type="enabledGroup">
                  <container label="Preview" name="tabPreview">
                    <input name="previewToolbar" type="toolbarCtrl"/>
                    <static type="separator"/>
                    <container ref="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabPreview/body" xpath="."/>
                  </container>
                </container>
              </container>
            </container>
            <container name="PDFMultiple" visibleIf="EV([content/@pdfType], 'multiple') AND [content/@hasPdf]" xpath="content">
              <input editable="false" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="list" xpath="pdf" zoom="true" zoomOnAdd="true">
                <input editable="true" xpath="@active"/>
                <input editable="true" xpath="@label"/>
                <input xpath="@compressMode"/>
                <input xpath="@size"/>
                <form colcount="2" label="Content file definition" xpathsToLoad="*">
                  <container ref="nms:delivery:edit/paperDefinition/paperContent/PDFSimple/editPDFFile" xpath="."/>
                </form>
              </input>
            </container>
            <container label="Address">
              <container label="Sender address" maxLabelWidth="200" type="frame" xpath="paperParameters/senderAddress">
                <static type="help">These parameters are required when using Electronic Registered letters.</static>
                <input label="Company name" xpath="@line1"/>
                <input label="Recipient or service identity" xpath="@line2"/>
                <input label="Geographical address detail" xpath="@line3"/>
                <input label="Number and label of street" xpath="@line4"/>
                <input label="Special (county...)" xpath="@line5"/>
                <input label="ZIP/Postcode and Locality" xpath="@line6"/>
                <input label="Country" xpath="@line7"/>
              </container>
              <container label="Address" type="frame" xpath="paperParameters">
                <container enabledIf="@envelope=='C6SW' or @envelope=='C6DW'" type="enabledGroup">
                  <input checkedValue="ownPage" label="Add addresses on a dedicated page" margin-left="20" type="RadioButton" xpath="@addressPos"/>
                  <input checkedValue="firstPage" label="Add addresses on the document first page" margin-left="20" type="RadioButton" xpath="@addressPos"/>
                </container>
              </container>
            </container>
            <container label="Envelopes">
              <container label="Envelopes" type="frame" xpath="paperParameters">
                <input checkedValue="AUTO" label="Auto-detect format *" type="RadioButton" xpath="@envelope"/>
                <input checkedValue="C6SW" label="Small envelop; C6 format (229 x 114 mm) simple window" type="RadioButton" xpath="@envelope"/>
                <container enabledIf="@priceCategory!='recom_R1'" type="enabledGroup">
                  <input checkedValue="C6DW" label="Small envelop; C6 format (229 x 114 mm) double window" type="RadioButton" xpath="@envelope"/>
                </container>
                <input checkedValue="C4" label="Large envelop; C4 format (332 x 230 mm)" type="RadioButton" xpath="@envelope"/>
                <static type="help">* Letters containing less than four sheets are sent in C6 (229 x 114 mm) single-window envelopes; others containing more than four sheets in C4 (332 x 230 mm) envelopes.\n
In any case, a first page containing the address is added.</static>
              </container>
              <container colcount="2" label="Content of letters" type="frame" xpath="paperParameters">
                <container>
                  <input checkedValue="bw" label="Black &amp; white printing" margin-left="20" type="RadioButton" xpath="@colorSupport"/>
                  <input checkedValue="color" label="Color printing" type="RadioButton" xpath="@colorSupport"/>
                </container>
                <container>
                  <input checkedValue="recto" label="Single-sided printing" margin-left="20" type="RadioButton" xpath="@rectoVerso"/>
                  <input checkedValue="rectoverso" label="Double-sided printing" type="RadioButton" xpath="@rectoVerso"/>
                </container>
              </container>
            </container>
            <container label="Postal metering" xpath="paperParameters">
              <container colcount="2" label="Stamping category" type="frame">
                <container>
                  <input checkedValue="letterPrio" label="Letter rate - first class" type="RadioButton" xpath="@priceCategory"/>
                  <input checkedValue="ecoPli" label="Bulk rate (economical)" type="RadioButton" xpath="@priceCategory"/>
                  <input checkedValue="recom_R1" label="Electronic Registered letter from La Poste (R1) ***" type="RadioButton" xpath="@priceCategory"/>
                </container>
                <container enabledIf="@priceCategory='recom_R1'" type="enabledGroup">
                  <input checkedValue="false" label="Without acknowledgement" margin-left="20" type="RadioButton" xpath="@AR"/>
                  <input checkedValue="true" label="With acknowledgement" margin-left="20" type="RadioButton" xpath="@AR"/>
                  <container enabledIf="@AR" type="enabledGroup">
                    <input label="Return email address" margin-left="20" xpath="@emailAR"/>
                  </container>
                </container>
                <static colspan="2" type="help">*** franking/postal meter rates for Electronic Registered letters from La Poste are possible for the following destinations:\n
  Metropolitan France, Overseas Departments, Andorra and Monaco</static>
              </container>
              <container label="Options" type="frame">
                <container enabledIf="@priceCategory!='recom_R1'" type="enabledGroup">
                  <input label="Electronic management of undeliverables (pay for option)" xpath="@handleNPAI"/>
                </container>
                <input useDesc="true" xpath="@printInternalRef"/>
              </container>
            </container>
          </container>
        </container>
        <container img="nms:mobile.png" label="SMS" name="mobileDefinition" visibleIf="EV(@messageType, 'sms') and @deliveryMode!=0">
          <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="[@linkedDelivery-id]!=0 and [@workflow-id]!=0">
            <container colcount="2" label="Delivery target population" name="headers" type="frame">
              <container ref="nms:delivery:lib/targetFrame"/>
              <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
            </container>
            <container label="Main delivery" type="frame">
              <input label="Delivery" readOnly="true" xpath="linkedDelivery"/>
              <static label="The content of the SMS is created from the main delivery." type="help"/>
              <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')==false" xpath="linkedDelivery">
                <container style="flat" type="notebook">
                  <container img="nms:mobile.png" label="SMS" name="smsContent" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'sms', 'wapPush')" xpath="smsParameters">
                    <container ref="nms:delivery:edit/mobileDefinition/parameters/smsContentEditor/notebook/tabPreview"/>
                  </container>
                  <container img="nms:mms.png" label="MMS" name="mmsContent" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'mms')" xpath="content/mms/source">
                    <container ref="nms:delivery:edit/mobileDefinition/parameters/mmsContentEditor/notebook/tabPreview"/>
                  </container>
                </container>
              </container>
            </container>
          </container>
          <container name="parameters" type="visibleGroup" visibleIf="[/ignored/@hasParentDelivery]!=1">
            <container type="visibleGroup" visibleIf="[/ignored/@limitEdition]=false">
              <container colcount="3" label="Message type" type="frame" xpath="smsParameters">
                <input checkedValue="0" label="SMS" type="RadioButton" xpath="@mobileMsgType"/>
                <input checkedValue="1" label="WAP Push" type="RadioButton" xpath="@mobileMsgType"/>
                <input checkedValue="2" label="MMS" type="RadioButton" xpath="@mobileMsgType"/>
                <static colspan="3" type="help">A WAP Push message is like an SMS message but also includes a URL leading to additional content.\n An MMS message is defined using a SMIL format.</static>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!='1'">
                <container label="Delivery target population" type="frame">
                  <container colcount="2">
                    <container ref="nms:delivery:lib/targetFrame"/>
                    <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
                  </container>
                </container>
              </container>
            </container>
            <container name="smsContentEditor" propagateConstraints="false" type="visibleGroup" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'mms')=false">
              <container name="notebook" type="contentEditor" xpath="smsParameters">
                <container img="xtk:text.png" label="Text content" name="tabSMS" readOnlyIf="[/tmp/@readOnly] or ([/ignored/@limitEdition] and [/ignored/@contentStatus]!=10)">
                  <input fullToolbar="true" htmlMode="false" name="ctSource" nolabel="true" type="htmlSource" xpath="../content/sms/source" xpathInsert="/ignored/customizeSMSContent">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeSMSContent"/>
                    </container>
                  </input>
                  <container type="visibleGroup" visibleIf="EV(@mobileMsgType, 'wapPush')">
                    <static label="WAP Push" type="separator"/>
                    <input label="Destination URL" menuId="deliveryMenuBuilder" required="true" type="scriptEdit" xpath="../content/text/source"/>
                  </container>
                </container>
                <container colcount="2" img="xtk:html.png" label="Preview" name="tabPreview">
                  <input colspan="2" name="previewToolbar" type="toolbarCtrl"/>
                  <static colspan="2" type="separator"/>
                  <container colspan="2" type="visibleGroup" visibleIf="EV(@mobileMsgType, 'wapPush')">
                    <value label="Destination URL" xpath="/tmp/sms/preview/@url"/>
                  </container>
                  <value label="Length" xpath="/tmp/sms/preview/@length"/>
                  <input label="Data loaded..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="/tmp/rcpQryResult">
                    <form label="Data of the recipient loaded for the preview">
                      <input nolabel="true" readOnly="true" type="SourceEdit" xpath="queryResult"/>
                    </form>
                  </input>
                  <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/sms/preview/@length] > 160">
                    <static/>
                    <static img="xtk:logwarn.png" label=" " nolabel="true">The content for this recipient exceeds the maximum SMS size of 160 characters.</static>
                  </container>
                  <static colspan="2" type="separator"/>
                  <container ref="nms:delivery:lib/content/Preview/body" xpath="../content/sms"/>
                  <input postXPath="/tmp/sms/preview/content" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl) + '/nms/deliveryPreview.jssp?messageType=43'" utf8EncodePostXPath="true"/>
                </container>
                <container applicableIf="HasPackage('nms:messageCenter')" img="nms:unknownad.png" label="Seed addresses" visibleIf="[/ignored/@triggerMessage]=1">
                  <container ref="nms:delivery:lib/proofTarget" xpath="/delivery"/>
                </container>
              </container>
            </container>
            <container name="mmsContentEditor" propagateConstraints="false" type="visibleGroup" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'mms')">
              <container name="notebook" style="flat" type="contentEditor" xpath="content/mms/source">
                <container label="MMS" name="tabMMS" readOnlyIf="[/tmp/@readOnly] or ([/ignored/@limitEdition] and [/ignored/@contentStatus]!=10)">
                  <input label="Subject" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="../../../content/sms/source"/>
                  <input fullToolbar="true" htmlMode="false" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeMMSContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeMMSContent"/>
                    </container>
                  </input>
                </container>
                <container label="Preview" name="tabPreview">
                  <input name="previewToolbar" type="toolbarCtrl"/>
                  <static type="separator"/>
                  <container colcount="2" xpath="/tmp/mms/preview">
                    <value label="Subject" xpath="subject"/>
                    <input label="Data loaded..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="/tmp/rcpQryResult">
                      <form label="Data of the recipient loaded for the preview">
                        <input nolabel="true" readOnly="true" type="SourceEdit" xpath="queryResult"/>
                      </form>
                    </input>
                  </container>
                  <container ref="nms:delivery:lib/content/Preview/body" xpath=".."/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="[tracking/@enabled]">
                <input label="Display URLs" nolabel="true" type="checkBox" xpath="/tmp/urlTree/@display"/>
              </container>
              <container name="contUrlTree" ref="nms:delivery:lib/content/HTML/htmlContentEditor/contUrl/contUrlTree" xpath="content/mms"/>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:social')" img="nms:facebook.png" label="Facebook" name="facebookDefinition" visibleIf="EV(@messageType, 'facebook') and @deliveryMode!=0">
          <container colcount="3" label="Facebook page" type="frame">
            <container colcount="2">
              <container ref="nms:delivery:lib/targetFrame"/>
              <input alwaysActive="true" lineCount="1" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
            </container>
          </container>
          <input label="Content type" xpath="content/@fcbContentType">
            <enter name="onChange">
              <set expr="[content/@fcbContentType]" xpath="content/facebookContentType/source"/>
            </enter>
          </input>
          <container type="visibleGroup" visibleIf="EV([content/@fcbContentType], 'status', 'statusWithLink', 'statusWithYoutubeLink')">
            <container readOnlyIf="[/tmp/@readOnly]" type="notebook">
              <container img="nms:facebook.png" label="Content">
                <container type="visibleGroup" visibleIf="EV([content/@fcbContentType], 'status', 'statusWithLink', 'statusWithYoutubeLink')">
                  <input fullToolbar="true" htmlMode="false" label="Status" name="ctSource" type="htmlSource" xpath="content/facebookMessage/source" xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                    </container>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="EV([content/@fcbContentType], 'statusWithLink')">
                  <input label="Link" type="separator"/>
                  <input label="Name" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookName/source"/>
                  <input label="Link" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookLink/source"/>
                  <input label="Image" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookPicture/source"/>
                  <input label="Caption" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookCaption/source"/>
                  <input label="Description" toolbar="false" type="CodeEdit" xpath="content/facebookDescription/source" xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                    </container>
                  </input>
                </container>
                <container colcount="2" type="visibleGroup" visibleIf="EV([content/@fcbContentType], 'statusWithYoutubeLink')">
                  <input colspan="2" label="Video link" type="separator"/>
                  <input colspan="2" label="Name" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookName/source"/>
                  <input label="Video code" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookVideoCode/source"/>
                  <static nolabel="true" type="help">For instance, for the following link: 'http://www.youtube.com/watch?v=abc123456', the video code equals 'abc1234566'.</static>
                  <input colspan="2" label="Caption" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookCaption/source"/>
                  <input colspan="2" label="Description" toolbar="false" type="CodeEdit" xpath="content/facebookDescription/source" xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                    </container>
                  </input>
                </container>
              </container>
              <container img="xtk:preview.png" label="Preview" name="tabPreview" xpath="content/html/source">
                <container ref="nms:delivery:lib/content/Facebook/facebookContentEditor/tabPreview"/>
              </container>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="EV([content/@fcbContentType], 'photo')">
            <container readOnlyIf="[/tmp/@readOnly]" type="notebook">
              <container colcount="2" img="nms:facebook.png" label="Content">
                <container type="visibleGroup" visibleIf="EV([content/@fcbContentType], 'photo')">
                  <input label="Album name" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="content/facebookAlbumName/source"/>
                  <input fullToolbar="true" htmlMode="false" label="Description" name="ctSource" nolabel="false" type="htmlSource" xpath="content/facebookAlbumDesc/source" xpathInsert="/ignored/customizeTextContent" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeTextContent"/>
                    </container>
                  </input>
                  <container collection="/delivery/attachment" form="nms:uploadAttachment" label="Do you want to upload the {1} file?" type="fileDropZone">
                    <enter name="onClick">
                      <set expr="[/tmp/@uploadFile]" xpath="name"/>
                      <set value="normal" xpath="@type"/>
                    </enter>
                    <input delButton="true" editable="false" form="nms:attachment" hideEditButtons="true" nolabel="true" prebuildSubForm="false" toolbarCaption="Photos" type="list" xpath="attachment" zoom="false" zoomOnAdd="true">
                      <container name="addToolbar">
                        <input collection="." img="xtk:xawadd.png" insertAfter="Add" label="Add" type="fileResAddMenuButton">
                          <command form="nms:uploadAttachment" label="File..." name="file">
                            <enter>
                              <set expr="[/tmp/@uploadFile]" xpath="name"/>
                              <set value="normal" xpath="@type"/>
                            </enter>
                          </command>
                        </input>
                      </container>
                      <input editable="true" label="Name" xpath="@label"/>
                      <input editable="true" label="Caption" xpath="source"/>
                    </input>
                  </container>
                </container>
              </container>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:social')" img="nms:twitter.png" label="Tweet" name="twitterDefinition" visibleIf="EV(@messageType, 'twitter') and @deliveryMode!=0">
          <container label="Twitter account" type="frame">
            <container colcount="2">
              <container ref="nms:delivery:lib/targetFrame"/>
              <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
            </container>
          </container>
          <container name="notebook" type="contentEditor" xpath="content/twitterMsg/source">
            <container img="nms:twitter.png" label="Content" name="tabText" readOnlyIf="[/tmp/@readOnly]">
              <container ref="nms:delivery:lib/content/Tweet/tweetContentEditor/tabText"/>
            </container>
            <container img="xtk:preview.png" label="Preview" name="tabPreview">
              <container ref="nms:delivery:lib/content/Tweet/tweetContentEditor/tabPreview"/>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:mobileApp')" img="nms:ios.png" label="iOS push" name="iOSDefinition" visibleIf="EV(@messageType, 'ios') and @deliveryMode!=0">
          <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
            <container label="iOS mobile push" type="frame">
              <container colcount="2">
                <container ref="nms:delivery:lib/targetFrame"/>
                <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
              </container>
            </container>
          </container>
          <container name="notebook" type="contentEditor" xpath="content">
            <container img="nms:ios.png" label="Content" name="tabContent" readOnlyIf="[/tmp/@readOnly]">
              <container ref="nms:delivery:lib/content/iOS/iOSContentEditor/tabContent"/>
            </container>
            <container img="xtk:preview.png" label="Preview" name="tabPreview">
              <container ref="nms:delivery:lib/content/iOS/iOSContentEditor/tabPreview"/>
            </container>
            <container applicableIf="HasPackage('nms:messageCenter')" img="nms:unknownad.png" label="Seed addresses" visibleIf="[/ignored/@triggerMessage]=1">
              <container ref="nms:delivery:lib/proofTarget" xpath="/delivery"/>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:mobileApp')" img="nms:android.png" label="Android" name="androidDefinition" visibleIf="EV(@messageType, 'android') and @deliveryMode!=0">
          <container type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
            <container label="Android" type="frame">
              <container colcount="2">
                <container ref="nms:delivery:lib/targetFrame"/>
                <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
              </container>
            </container>
          </container>
          <container name="notebook" type="contentEditor" xpath="content">
            <container img="nms:android.png" label="Content" name="tabContent" readOnlyIf="[/tmp/@readOnly]">
              <container ref="nms:delivery:lib/content/android/androidContentEditor/tabContent"/>
            </container>
            <container img="xtk:preview.png" label="Preview" name="tabPreview">
              <container ref="nms:delivery:lib/content/android/androidContentEditor/tabPreview"/>
            </container>
            <container applicableIf="HasPackage('nms:messageCenter')" img="nms:unknownad.png" label="Seed addresses" visibleIf="[/ignored/@triggerMessage]=1">
              <container ref="nms:delivery:lib/proofTarget" xpath="/delivery"/>
            </container>
          </container>
        </container>
        <container img="nms:fax.png" label="FAX" name="faxDefinition" visibleIf="EV(@messageType, 'fax') and @deliveryMode!=0">
          <container colcount="2" type="visibleGroup" visibleIf="[/ignored/@limitEdition]=false">
            <container ref="nms:delivery:lib/targetFrame"/>
            <input alwaysActive="true" lineCount="2" noBorder="true" nolabel="true" readOnly="true" type="memo" xpath="/tmp/target"/>
          </container>
          <container type="visibleGroup" visibleIf="[/ignored/@limitEdition]=false">
            <container label="Content" type="frame" xpath="content">
              <input xpath="@hasPdf"/>
              <container type="visibleGroup" visibleIf="@hasPdf">
                <input label="Type" xpath="@pdfType"/>
                <input label="Enable compression" xpath="@pdfCompression"/>
              </container>
            </container>
          </container>
          <container name="notebook" propagateConstraints="false" type="contentEditor" xpath="content/text/source">
            <container label="Text content" name="tabText" readOnlyIf="[/tmp/@readOnly] or ([/ignored/@limitEdition] and [/ignored/@contentStatus]!=10)">
              <input fullToolbar="true" htmlMode="false" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeFaxContent">
                <container>
                  <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeFaxContent"/>
                </container>
              </input>
            </container>
            <container label="Text preview" name="tabPreview">
              <input name="previewToolbar" type="toolbarCtrl"/>
              <static type="separator"/>
              <input label="Data loaded..." nolabel="true" prebuildSubForm="false" type="subFormLink" xpath="/tmp/rcpQryResult">
                <form label="Data of the recipient loaded for the preview">
                  <input nolabel="true" readOnly="true" type="SourceEdit" xpath="queryResult"/>
                </form>
              </input>
              <container ref="nms:delivery:lib/content/Preview/body" xpath=".."/>
            </container>
            <container label="PDF content" ref="nms:delivery:edit/paperDefinition/paperContent/PDFSimple/editPDFFile" visibleIf="EV([../@pdfType], 'simple') AND [../@hasPdf]" xpath="../../pdf[1]"/>
            <container label="PDF content" ref="nms:delivery:edit/paperDefinition/paperContent/PDFMultiple" xpath="../../.."/>
          </container>
        </container>
        <container img="nms:miniatures/other.png" label="Other" name="otherDefinition" visibleIf="EV(@deliveryMode, 'descriptive')" xpathEnum="@messageType">
          <container label="Delivery target population" type="frame">
            <container ref="nms:delivery:lib/deliveryMapping" xpath="mapping"/>
          </container>
          <container label="Description" type="frame">
            <input xpath="@nature"/>
            <input xpath="desc"/>
          </container>
        </container>
        <container applicableIf="HasPackage('crm:lead')" img="crm:lead.png" label="Leads" name="leads" ref="crm:common:leads" visibleIf="@FCP=0"/>
        <container img="nms:broadLog.png" label="Delivery" name="broadLog" visibleIf="@state >= EVal(@state, 'ready') and EV(@deliveryMode, 'descriptive')=false and [validation/@sandboxMode]!=2">
          <container type="visibleGroup" visibleIf="EV([mapping/storage/@exclusionType], 'other')">
            <container type="notebook">
              <container label="Logs">
                <input enumImage="@status" hideEditButtons="true" img="nms:broadLog.png" nolabel="true" refresh="true" toolbarCaption="Delivery logs" type="dynamicLinkList" xpath="." xpathId="/ignored/@selectedMessage" xpathObjectSchema="mapping/@targetSchema" xpathSchema="mapping/storage/@broadLogSchema">
                  <input xpath="@lastModified"/>
                  <input xpath="@status"/>
                  <input xpath="msg/@failureReason"/>
                  <input xpath="@address"/>
                  <input xpath="msg/@text"/>
                  <orderBy>
                    <node expr="@lastModified" sortDesc="true"/>
                  </orderBy>
                </input>
              </container>
              <container label="Exclusions">
                <input enumImage="@status" hideEditButtons="true" img="nms:excludeLog.png" nolabel="true" refresh="true" toolbarCaption="Exclusion logs" type="dynamicLinkList" xpath="." xpathId="/ignored/@selectedMessage" xpathObjectSchema="mapping/@targetSchema" xpathSchema="mapping/storage/@broadLogExclSchema">
                  <input xpath="@lastModified"/>
                  <input xpath="@status"/>
                  <input xpath="msg/@failureReason"/>
                  <input xpath="@address"/>
                  <input xpath="msg/@text"/>
                  <orderBy>
                    <node expr="@lastModified" sortDesc="true"/>
                  </orderBy>
                </input>
              </container>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="EV([mapping/storage/@exclusionType], 'other')==false">
            <input enumImage="@status" hideEditButtons="true" img="nms:broadLog.png" nolabel="true" refresh="true" toolbarCaption="Delivery logs" type="dynamicLinkList" xpath="." xpathId="/ignored/@selectedMessage" xpathObjectForm="/ignored/@dynamicLinkListObjectForm" xpathObjectSchema="/ignored/@dynamicLinkListObjectSchema" xpathSchema="/ignored/@dynamicLinkListSchema">
              <input xpath="@lastModified"/>
              <input xpath="@status"/>
              <input xpath="msg/@failureReason"/>
              <input xpath="@address"/>
              <input xpath="msg/@text"/>
              <orderBy>
                <node expr="@lastModified" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="EV(@messageType, 'mail') and EV(@deliveryMode, 'external') == false">
            <container type="visibleGroup" visibleIf="EV([mailParameters/@needMirrorPage], 'fromMsgId', 'yes')">
              <container colcount="2" enabledIf="[/ignored/@selectedMessage] != ''" type="enabledGroup">
                <input discardReadOnly="true" img="xtk:html.png" label="Display the mirror page for this message..." prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form img="xtk:html.png" label="Mirror page content of the selected message">
                    <enter>
                      <soapCall name="GetMirrorURL" service="nms:delivery">
                        <param exprIn="@id" type="int"/>
                        <param exprIn="[/ignored/@selectedMessage]" type="string"/>
                        <param type="string" xpathOut="/ignored/@mirrorPageUrl"/>
                      </soapCall>
                    </enter>
                    <input type="browser" urlMode="true" xpath="/ignored/@mirrorPageUrl"/>
                  </form>
                </input>
                <container type="visibleGroup" visibleIf="EV([mailParameters/@needMirrorPage], 'yes')">
                  <static type="warning">Loading the mirror page can take some time.</static>
                </container>
              </container>
            </container>
          </container>
        </container>
        <container img="nms:broadLog.png" label="Target" name="forecastLog" visibleIf="EV(@state, 'targetReady', 'messagePrepPending') OR (EV(@state, 'preparationError') AND @analysisStep>4)">
          <input type="forecastLogList" xpath="@id">
            <input xpath="@failureReason"/>
            <input xpath="@address"/>
            <input xpath="typologyRule"/>
            <input xpath="@line1"/>
            <input xpath="@line2"/>
            <input xpath="@line3"/>
          </input>
        </container>
        <container img="nms:tracking.png" label="Tracking" name="trackingLog" visibleIf="([tracking/@enabled] AND (@state > EVal(@state, 'messageReady')) OR EV(@messageType, 'other')) and [validation/@sandboxMode]!=2">
          <container type="notebook">
            <container label="Logs">
              <input hideEditButtons="true" img="nms:tracking.png" nolabel="true" refresh="true" toolbarCaption="Tracking logs of the delivery" type="dynamicLinkList" xpath="." xpathObjectForm="/ignored/@dynamicLinkListObjectForm" xpathObjectSchema="/ignored/@dynamicLinkListObjectSchema" xpathSchema="mapping/storage/@trackingLogSchema" zoom="true">
                <input xpath="@logDate"/>
                <input xpath="url/@label"/>
                <input xpath="url/@type"/>
                <input xpathObjectSchema="/ignored/@dynamicLinkListObjectSchema"/>
                <orderBy>
                  <node expr="@logDate" sortDesc="true"/>
                </orderBy>
              </input>
            </container>
            <container label="URLs" name="url" visibleIf="[tracking/@enabled]">
              <input hideEditButtons="true" nolabel="true" toolbarCaption="Tracked URLs" type="linklist" xpath="trackingUrl" zoom="true">
                <input xpath="@label"/>
                <input xpath="@type"/>
                <input xpath="@source"/>
              </input>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:coreInteraction')" img="nms:proposition.png" label="Offers" name="proposition" visibleIf="@state >= EVal(@state, 'ready') and [@offerSpace-id]!=0 and [validation/@sandboxMode]!=2">
          <input hideEditButtons="true" img="nms:proposition.png" nolabel="true" refresh="true" toolbarCaption="Propositions generated by the delivery" type="dynamicLinkList" xpath="." xpathSchema="offerSpace/env/@propositionSchema">
            <input xpath="@eventDate"/>
            <input xpath="offerSpace"/>
            <input xpath="offer"/>
            <input xpath="@rank"/>
            <input xpath="@status"/>
            <orderBy>
              <node expr="@eventDate" sortDesc="true"/>
            </orderBy>
            <sysFilter>
              <condition expr="[broadLog/@delivery-id]=$(@id)"/>
            </sysFilter>
          </input>
        </container>
        <container applicableIf="HasPackage('nms:deliverability')" img="nms:world.png" label="Inbox Rendering" name="rendering" visibleIf="EV(@messageType, 'mail') and EV(@deliveryMode, 'external') == false">
          <input type="UrlViewer" urlExpr="'http://deliverability.neolane.net/dm/inboxRendering.jssp?did=' + Iif([properties/@midRemoteId]!=0, [properties/@midRemoteId], @id) + '&amp;cuid=' + getOption('DmRendering_cuid')" urlMode="true"/>
        </container>
        <container img="xtk:logs.png" label="Audit" name="jobLog" visibleIf="EV(@deliveryMode, 'descriptive')=false">
          <container type="notebook">
            <container label="Journal">
              <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Messages in the journal of the delivery" type="linkList" xpath="log">
                <input xpath="@logDate"/>
                <input xpath="@message"/>
                <orderBy>
                  <node expr="@id" sortDesc="true"/>
                </orderBy>
              </input>
            </container>
            <container label="Causes of exclusions" visibleIf="[/ignored/@triggerMessage]!=1">
              <input hideEditButtons="true" img="xtk:reject.png" nolabel="true" refresh="true" toolbarCaption="Volumes and causes of excluded messages" type="linkList" xpath="dlvExclusion" zoom="false">
                <input xpath="@count"/>
                <input xpath="typologyRule"/>
              </input>
            </container>
            <container label="Proofs" name="fcpList" visibleIf="@FCP=0">
              <input disableDefaultFilter="true" enumImage="@state" hideEditButtons="true" img="nms:bat.png" nolabel="true" refresh="true" toolbarCaption="Delivery proof copies" type="linkList" xpath="proof" zoom="true">
                <input xpath="@label"/>
                <input xpath="properties/@toDeliver"/>
                <input xpath="indicators/@processed"/>
                <input xpath="indicators/@success"/>
              </input>
            </container>
            <container applicableIf="hasPackage('nms:campaign')" label="Approvals" visibleIf="@FCP=0 and hasPackage('nms:campaign') and [/ignored/@useValidation] and @isModel=false">
              <container colspan="2" readOnlyIf="HasNamedRight('approvalAdministration')=false or @state > Eval(@state, 'ready')" type="readOnlyGroup">
                <container type="visibleGroup" visibleIf="EV(@targetStatus, 'inWaiting') or EV(@contentStatus, 'inWaiting', 'available', 'fcpInWaiting', 'inProgress', 'externalInWaiting') or                               EV(@budgetStatus, 'inWaiting') or EV(@extractionStatus, 'inWaiting') or EV(@sandboxStatus, 'inWaiting')">
                  <static img="nl:smallcalendar.png" label="Processing schedule" type="separator"/>
                  <input lineCount="6" nolabel="true" notitle="true" type="treeEdit">
                    <container label="Schedule">
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedTarget]!='' and (EV(@targetStatus, 'inWaiting'))" xpath="scheduling/@expectedTarget"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderTarget]!='' and (EV(@targetStatus, 'inWaiting'))" xpath="scheduling/@reminderTarget"/>
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedContent]!='' and (EV(@contentStatus, 'inWaiting', 'available', 'externalRefused')) or ((EV(@contentStatus, 'refused') and [validation/@assignEdition]=false))" xpath="scheduling/@expectedContent"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderContent]!='' and (EV(@contentStatus, 'inWaiting', 'available', 'externalRefused')) or ((EV(@contentStatus, 'refused') and [validation/@assignEdition]=false))" xpath="scheduling/@reminderContent"/>
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedBudget]!='' and (EV(@budgetStatus, 'inWaiting'))" xpath="scheduling/@expectedBudget"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderBudget]!='' and (EV(@budgetStatus, 'inWaiting'))" xpath="scheduling/@reminderBudget"/>
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedExtraction]!='' and (EV(@extractionStatus, 'inWaiting'))" xpath="scheduling/@expectedExtraction"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderExtraction]!='' and (EV(@extractionStatus, 'inWaiting'))" xpath="scheduling/@reminderExtraction"/>
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedFCP]!='' and (EV(@contentStatus, 'fcpInWaiting'))" xpath="scheduling/@expectedFCP"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderFCP]!='' and (EV(@contentStatus, 'fcpInWaiting'))" xpath="scheduling/@reminderFCP"/>
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedForecast]!='' and (EV(@sandboxStatus, 'inWaiting'))" xpath="scheduling/@expectedForecast"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderForecast]!='' and (EV(@sandboxStatus, 'inWaiting'))" xpath="scheduling/@reminderForecast"/>
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedEdition]!='' and (EV(@contentStatus, 'inProgress')) and [validation/@assignEdition]" xpath="scheduling/@expectedEdition"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderEdition]!='' and (EV(@contentStatus, 'inProgress')) and [validation/@assignEdition]" xpath="scheduling/@reminderEdition"/>
                      <input img="nl:smallcalendar.png" visibleIf="[scheduling/@expectedExternal]!='' and (EV(@contentStatus, 'externalInWaiting')) and [validation/@externalValidation]" xpath="scheduling/@expectedExternal"/>
                      <input img="nms:alarmon.png" visibleIf="[scheduling/@reminderExternal]!='' and (EV(@contentStatus, 'externalInWaiting')) and [validation/@externalValidation]" xpath="scheduling/@reminderExternal"/>
                    </container>
                  </input>
                </container>
              </container>
              <input colspan="2" disableDefaultFilter="true" enumImage="@action" hideEditButtons="true" img="nms:validation.png" nolabel="true" refresh="true" toolbarCaption="Approvals log" type="linklist" xpath="validationLog" zoom="true">
                <input xpath="@date"/>
                <input xpath="@action"/>
                <input xpath="@type"/>
                <input xpath="validatedBy"/>
                <input xpath="comment"/>
                <orderBy>
                  <node expr="@date" sortDesc="true"/>
                </orderBy>
              </input>
            </container>
            <container label="SQL logs" name="sql" visibleIf="[advancedParameters/@showSQL]">
              <input nolabel="true" readOnly="true" type="jobLogSQLEdit" xpath="@id"/>
            </container>
          </container>
        </container>
      </container>
      <leave name="leave">
        <if expr="[targets/@deliveryLimit]>0 and [targets/@useDeliveryLimit]=false">
          <set value="true" xpath="targets/@useDeliveryLimit"/>
        </if>
        <if expr="[targets/@deliveryLimit]=0 and [targets/@useDeliveryLimit]=true">
          <set value="false" xpath="targets/@useDeliveryLimit"/>
        </if>
        <if expr="[targets/proofTarget/@nonEmpty]=false">
          <set expr="iif (NodeCount([fcpParameters/substitution]) > 0 or NodeCount([fcpParameters/seedList/where/condition]) > 0 or NodeCount(FCPSeed) > 0, true, false)" xpath="targets/proofTarget/@nonEmpty"/>
        </if>
        <if expr="[/tmp/processId]!=0 AND [/tmp/processId]!=''">
          <set expr="[/tmp/processId]" xpath="@folder-id"/>
        </if>
        <if expr="@isModel and [tracking/@enabled] and (EV(@deliveryMode, 'external') or EV(@deliveryMode, 'descriptive'))">
          <set value="false" xpath="tracking/@enabled"/>
        </if>
        <check expr="[@folder-id]!=0">
          <error>You must specify the delivery folder.</error>
        </check>
        <if expr="HasPackage('nms:campaign')">
          <set expr="[@linkedDelivery-id]" xpath="/ignored/@_LinkDeliveryId"/>
          <if expr="@isModel=false and [@budget-id]!=0 and [/ignored/@useBudget]">
            <set value="0" xpath="/ignored/@_propagateBudget"/>
            <if expr="HasPackage('nms:response')">
              <set expr="[/ignored/@totalRealized]!=[budgetParameters/@totalRealized] or [/ignored/@totalMargin]!=[budgetParameters/@totalMargin]" xpath="/ignored/@_propagateBudget"/>
            </if>
            <if expr="[/ignored/@_propagateBudget] or                 [/ignored/@realCost]!=[budgetParameters/@realCost] or                 [/ignored/@estimatedCost]!=[budgetParameters/@estimatedCost] or                 [/ignored/@budgetId]!=[@budget-id] or                 [/ignored/@commitmentLevel]!=[budgetParameters/@commitmentLevel]">
              <set value="1" xpath="budgetParameters/@computationState"/>
              <set value="true" xpath="/ignored/@calculateBudget"/>
              <set expr="[@budget-id]" xpath="/ignored/@budgetId"/>
              <set expr="[budgetParameters/@estimatedCost]" xpath="/ignored/@estimatedCost"/>
              <set expr="[budgetParameters/@realCost]" xpath="/ignored/@realCost"/>
              <set expr="[budgetParameters/@commitmentLevel]" xpath="/ignored/@commitmentLevel"/>
              <if expr="HasPackage('nms:response')">
                <set expr="[budgetParameters/@totalMargin]" xpath="/ignored/@totalMargin"/>
                <set expr="[budgetParameters/@totalRealized]" xpath="/ignored/@totalRealized"/>
              </if>
            </if>
          </if>
          <if expr="[/tmp/@hasDateExpr]=false">
            <set value="" xpath="scheduling/@extractionExpr"/>
            <set value="" xpath="scheduling/@contactDateExpr"/>
          </if>
          <if expr="[/tmp/@hasDeliveryLimitExpr]=false">
            <set value="" xpath="targets/@deliveryLimitExpr"/>
          </if>
        </if>
        <if expr="@isModel=false and [/ignored/@_LinkDeliveryId]=0 and HasPackage('nms:campaign')">
          <check expr="[scheduling/@extraction]='' or [scheduling/@contactDate]='' or [scheduling/@contactDate]>[scheduling/@extraction] or ([/tmp/@hasDateExpr] and ([/ignored/@extractionExpr]!='' or [/ignored/@contactDateExpr]!=''))">
            <error>The extraction date is later than the contact date.</error>
          </check>
          <check expr="[scheduling/@extraction] != '' or ([/tmp/@hasDateExpr] and [/ignored/@extractionExpr] != '') or [scheduling/@delayExtraction]=0">
            <error>An extraction date is necessary for the extraction wait period to be applied to it.</error>
          </check>
        </if>
        <if expr="[/ignored/@triggerMessage]">
          <set value="1" xpath="/delivery/triggerMessage/@publicationStatus"/>
        </if>
        <if expr="HasPackage('nms:mobileApp')">
          <copyElement exprDst="'/delivery/content/' + Iif(@messageType=41, 'ios', 'android') + 'CustomFields/source'" xpathSrc="/tmp/notificationCustomFields"/>
          <copyElement exprDst="'/delivery/content/' + Iif(@messageType=41, 'ios', 'android') + 'AvailableSounds/source'" xpathSrc="/tmp/notificationSounds"/>
        </if>
      </leave>
      <postSave>
        <if expr="HasPackage('nms:campaign')">
          <if expr="[/ignored/@calculateBudget]">
            <set value="nms:delivery" xpath="/ignored/writer/delivery/@xtkschema"/>
            <set value="update" xpath="/ignored/writer/delivery/@_operation"/>
            <set expr="@id" xpath="/ignored/writer/delivery/@id"/>
            <set value="1" xpath="/ignored/writer/delivery/budgetParameters/@computationState"/>
            <soapCall name="Write" service="xtk:persist">
              <param exprIn="[/ignored/writer/delivery]" type="DOMDocument"/>
            </soapCall>
            <soapCall name="WakeupTask" service="xtk:workflow">
              <param exprIn="'budgetMgt'" type="string"/>
              <param exprIn="''" type="string"/>
              <param exprIn="'scheduler'" type="string"/>
            </soapCall>
            <set value="false" xpath="/ignored/@calculateBudget"/>
          </if>
        </if>
        <if expr="EV(@deliveryMode, 'external') and [/ignored/@extraction]!=[scheduling/@extraction]">
          <soapCall name="WakeupTask" service="xtk:workflow">
            <param exprIn="'operationMgt'" type="string"/>
            <param exprIn="''" type="string"/>
            <param exprIn="'scheduler'" type="string"/>
          </soapCall>
          <set expr="[scheduling/@extraction]" xpath="/ignored/@extraction"/>
        </if>
      </postSave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:delivery" entitySchema="xtk:form" img="xtk:form.png" label="Delivery" maxLabelWidth="50" md5="D43B9CC44CDE2EB0B52DF090E60A5195" name="deliveryDet" namespace="nms" xpathsToLoad="@mapping-id,@state,@useDce,@useAEM,@contentEditingMode,@isModel,content/*,targets/*,targets/fileFormat/*,         targets/deliveryFile/*,targets/proofFile/*,forecast/*,         advancedParameters/*,scheduling/*,scenario/*,execution/*,output/*,         tracking/*,properties/@midRemoteId,@deliveryProvider-id,typology,         typology/@id,typology/@IPAffinity,@typology-id,fcpParameters/*,         variables/*,folder,folderProcess,mapping/*,         mailParameters/*,@mirrorURL" xpathsToLoadOpt="@workflow-id,@linkedDelivery-id,linkedDelivery/@id,         linkedDelivery/scheduling/*,@maxPropositionCount,@offerThemes,         offerCategory,offerCategory/@id,@offerCategory-id,@useTargetOffers,         @offerSpace-id,offerSpace,offerSpace/@id,         offerSpace/env/@id,offerSpace/env/@propositionSchema,         deliveryOutline/@label,deliveryOutline/dlvOutlineItem/*,         @cmsAccount-id,cmsAccount/*,remoteContent/*" xtkschema="xtk:form">
      <enter>
        <set value="delivery-id" xpath="/tmp/@seedListKey"/>
        <if expr="HasPackage('nms:campaign')">
          <set expr="[@budget-id]" xpath="/tmp/@budgetId"/>
          <set expr="[budgetParameters/@estimatedCost]" xpath="/tmp/@estimatedCost"/>
          <set expr="[/ignored/tmp/@useBudget] or [operation/parameter/@useBudget]" xpath="/ignored/@useBudget"/>
        </if>
        <if expr="HasPackage('nms:response')">
          <set expr="[budgetParameters/@totalMargin]" xpath="/tmp/@totalMargin"/>
          <set expr="[budgetParameters/@totalRealized]" xpath="/tmp/@totalRealized"/>
        </if>
        <set expr="Iif([@mapping-id]==0, 'nms:broadLogMid', [mapping/storage/@broadLogSchema])" xpath="/ignored/@dynamicLinkListSchema"/>
        <set expr="Iif([mapping/@name]='mapEventHisto', 'nms:eventHisto', [mapping/@targetSchema])" xpath="/ignored/@dynamicLinkListObjectSchema"/>
        <set expr="Iif([mapping/@name]='mapEventHisto', 'nms:eventHistoPreview', Iif([mapping/@name]='mapRtEvent', 'nms:rtEventPreview', Iif([mapping/@name]='mapBatchEvent', 'nms:batchEventPreview', '')))" xpath="/ignored/@dynamicLinkListObjectForm"/>
        <set translatedExpr="'Population resulting from upstream targeting'" xpath="/ignored/@strPopFromWkf"/>
        <set translatedExpr="'Population from a file'" xpath="/ignored/@strPopFromFile"/>
        <set translatedExpr="'Population not defined'" xpath="/ignored/@strPopEmpty"/>
        <set value="true" xpath="/ignored/@useDefaultEmptyPreview"/>
      </enter>
      <container type="notebook">
        <container img="nms:campaign.png" label="Dashboard" ref="nms:delivery:lib/summary"/>
        <container img="xtk:form.png" label="Edit" visibleIf="@id!=0">
          <container name="edit" type="iconbox">
            <container img="xtk:properties.png" label="General">
              <container ref="nms:delivery:lib/summaryTree"/>
              <static colspan="2" label="Description" type="separator"/>
              <input colspan="2" lineCount="5" nolabel="true" xpath="desc"/>
            </container>
            <container applicableIf="HasPackage('crm:lead')" img="crm:incomingLead.png" label="Leads" ref="nms:delivery:edit/leads" visibleIf="EV([/delivery/@deliveryMode], 'descriptive')=false"/>
            <container ref="nms:delivery:edit/broadLog"/>
            <container ref="nms:delivery:edit/forecastLog"/>
            <container ref="nms:delivery:edit/trackingLog"/>
            <container applicableIf="HasPackage('nms:coreInteraction')" ref="nms:delivery:edit/proposition"/>
            <container ref="nms:delivery:edit/jobLog"/>
          </container>
        </container>
        <container img="xtk:preview.png" label="Preview" name="preview" visibleIf="EV(@deliveryMode, 'descriptive')=false and @id!=0">
          <container type="notebook">
            <container img="xtk:html.png" label="HTML" name="htmlContent" visibleIf="EV(@messageType, 'mail')" xpath="content/html/source">
              <container ref="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabPreview"/>
            </container>
            <container img="xtk:textfile.png" label="Text" name="textContent" visibleIf="EV(@messageType, 'mail')" xpath="content/text/source">
              <container ref="nms:delivery:lib/content/Text/textContentEditor/notebook/tabPreview"/>
            </container>
            <container img="nms:mobile.png" label="SMS" name="smsContent" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'sms', 'wapPush')" xpath="smsParameters">
              <container ref="nms:delivery:edit/mobileDefinition/parameters/smsContentEditor/notebook/tabPreview"/>
            </container>
            <container img="nms:mms.png" label="MMS" name="mmsContent" visibleIf="EV(@messageType, 'sms') and EV([smsParameters/@mobileMsgType], 'mms')" xpath="content/mms/source">
              <container ref="nms:delivery:edit/mobileDefinition/parameters/mmsContentEditor/notebook/tabPreview"/>
            </container>
            <container img="nms:paper.png" label="Direct Mail" name="paperContent" visibleIf="EV(@messageType, 'paper')" xpath="content/pdf[1]">
              <input name="previewToolbar" type="toolbarCtrl"/>
              <static type="separator"/>
              <container ref="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabPreview/body" xpath="."/>
            </container>
            <container applicableIf="HasPackage('nms:social')" label="Post" name="facebookContent" visibleIf="EV(@messageType, 'facebook')" xpath="content/html/source">
              <container ref="nms:delivery:lib/content/Facebook/facebookContentEditor/tabPreview"/>
            </container>
            <container applicableIf="HasPackage('nms:social')" label="Tweet" name="tweetContent" visibleIf="EV(@messageType, 'twitter')" xpath="content/twitterMsg/source">
              <container ref="nms:delivery:lib/content/Tweet/tweetContentEditor/tabPreview"/>
            </container>
            <container applicableIf="HasPackage('nms:mobileApp')" label="iOS" name="iOSContent" visibleIf="EV(@messageType, 'ios')" xpath="content">
              <container ref="nms:delivery:lib/content/iOS/iOSContentEditor/tabPreview"/>
            </container>
            <container applicableIf="HasPackage('nms:mobileApp')" label="Android" name="androidContent" visibleIf="EV(@messageType, 'android')" xpath="content">
              <container ref="nms:delivery:lib/content/android/androidContentEditor/tabPreview"/>
            </container>
          </container>
        </container>
        <container img="nms:attachment.png" label="Files" name="files" visibleIf="@hasAttachments and EV(@messageType, 'mail') and EV(@deliveryMode, 'external') == false">
          <input editable="false" hideEditButtons="true" nolabel="true" toolbarAlign="vertical" type="linklist" xpath="attachment" zoom="false">
            <input xpath="@label"/>
            <input xpath="@type"/>
          </input>
        </container>
        <container ref="nms:delivery:edit/rendering"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form editionMode="form" entity-schema="nms:delivery" entitySchema="xtk:form" img="xtk:form.png" label="Delivery" margin="3" maxLabelWidth="50" md5="EADE3DAD10A1EE4A15E0DCBF66D971C2" name="newDelivery" namespace="nms" noNewInstance="true" screen="-xawForm" xpathsToLoad="desc,@folder-id,@internalName,@state,@isModel,content/*,         targets/*,targets/fileFormat/*,targets/deliveryFile/*,         targets/proofFile/*,forecast/*,advancedParameters/*,scheduling/*,         scenario/*,execution/*,output/*,tracking/*,properties/@deliveryState,         properties/@midRemoteId,@deliveryProvider-id,typology,typology/@id,         typology/@IPAffinity,@typology-id,fcpParameters/*,variables/*,folder,         folderProcess,mapping/*,deliveryProvider/@deliveryMode,mailParameters/*,         @contentModTime,@useDce,@useAEM,@contentEditingMode" xpathsToLoadOpt="coupon,coupon/@id,coupon/@code,coupon/@type,measure/*,         deliveryOutline/@label,operation/@id,operation/@linkedOperation-id,         @operation-id,operation/measure/@measureType,         operation/budgetParameters/@calculatedDate,         operation/parameter/@useBudget,operation/parameter/@useLandingPage,supplier/@deliveryModel-id,         smsParameters/@smsMode,smsParameters/@smsPriority,         smsParameters/@smsAppType,smsParameters/@maxSmsPerMessage,         triggerMessage/*,@cmsAccount-id,cmsAccount/*,remoteContent/*" xtkschema="xtk:form">
      <enter>
        <set value="1" xpath="/ignored/@dlvNotReady"/>
        <set value="pageModel" xpath="/ignored/@currentPage"/>
        <set value="0" xpath="/ignored/@hasParentDelivery"/>
        <set value="0" xpath="/ignored/@addReminder"/>
        <set value="nms:delivery" xpath="/ignored/@schema"/>
        <set value="0" xpath="/ignored/@operationId"/>
        <if expr="[/ignored/tmp/@messageType]=0 or [/ignored/tmp/@messageType]='' or [/ignored/tmp/@messageType]=127">
          <set value="mail" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=1">
          <set value="sms" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=2">
          <set value="phone" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=3">
          <set value="paper" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=4">
          <set value="fax" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=5">
          <set value="agency" xpath="/ignored/@defaultModel"/>
        </if>
        <set value="true" xpath="/ignored/@fileNameEraseLabel"/>
        <if expr="[/ignored/tmp/@messageType]=120">
          <set value="other" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=20">
          <set value="facebook" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=25">
          <set value="twitter" xpath="/ignored/@defaultModel"/>
        </if>
        <set value="0" xpath="/tmp/@social"/>
        <if expr="[/ignored/tmp/@messageType]=41">
          <set value="ios" xpath="/ignored/@defaultModel"/>
        </if>
        <if expr="[/ignored/tmp/@messageType]=42">
          <set value="android" xpath="/ignored/@defaultModel"/>
        </if>
        <set translatedExpr="'Population resulting from upstream targeting'" xpath="/ignored/@strPopFromWkf"/>
        <set translatedExpr="'Population from a file'" xpath="/ignored/@strPopFromFile"/>
        <set translatedExpr="'Population not defined'" xpath="/ignored/@strPopEmpty"/>
        <set value="true" xpath="/ignored/@showTracking"/>
        <if expr="HasPackage('nms:webAnalytics')">
          <if expr="[@webAnalyticsAccount-id]!=0">
            <set value="false" xpath="/ignored/@showTracking"/>
          </if>
        </if>
        <if expr="HasPackage('nms:campaign')">
          <set expr="iif ([targets/@deliveryLimitExpr]!='', true, false)" xpath="/tmp/@hasDeliveryLimitExpr"/>
          <set expr="iif ([scheduling/@contactDateExpr] != '' or [scheduling/@extractionExpr] != '', true, false)" xpath="/tmp/@hasDateExpr"/>
        </if>
        <set expr="'false'" xpath="/ignored/@isAEMContent"/>
        <set expr="'false'" xpath="/ignored/@isLinkedToContent"/>
        <if expr="HasPackage('nms:aemIntegration')">
          <set expr="Iif([/delivery/@contentEditingMode]=2, 'true', 'false')" xpath="/ignored/@isAEMContent"/>
          <set expr="Iif([/delivery/@contentEditingMode]=2 and [remoteContent/@remotePath] != '', 'true', 'false')" xpath="/ignored/@isLinkedToContent"/>
        </if>
      </enter>
      <input applicableIf="HasPackage('nms:messageCenter')" expr="iif ([/ignored/tmp/@messageCenter]=1, '[triggerMessage/@publicationStatus]!=0', '[triggerMessage/@publicationStatus]=0')" type="expr" xpath="/tmp/@messageFilter"/>
      <input applicableIf="HasPackage('nms:messageCenter')" expr="iif ([/ignored/tmp/@messageCenter]=1, 'emailTriggerMessage', [/ignored/@defaultModel])" type="expr" xpath="/ignored/@defaultModel"/>
      <container colcount="2" type="visibleGroup" visibleIf="[/ignored/@currentPage]='pageModel'and [/tmp/@showFolder]!=1">
        <static colspan="2" img="nms:circle-one.png">Select a delivery template</static>
        <input boldLineExpr="@builtIn = 1" choiceButton="true" colspan="2" defaultModelSearchExpr="Iif([@_instanceModelId]!=0 AND [@_instanceModelId]!='', '@id='+[@_instanceModelId], iif([/tmp/@social]=1, '@internalName=\'facebook\'', '@internalName=\'' + [/ignored/@defaultModel] + '\''))" enumImage="@messageType" folderFilterChoice="@model IN ('nmsDeliveryModel', 'nmsDelivery')" form="nms:delivery" fullLoad="true" label="Delivery template" newFromModelOnChange="true" noZoom="true" notifyPathList="[typology/@id],[typology/@IPAffinity], [mapping/@name], [mapping/@label], [mapping/storage/@trackingLogSchema], [mapping/@lastModified], [mapping/@schema], [mapping/@recipientLink], [mapping/@targetSchema], [mapping/@email], [mapping/@fax], [mapping/@sms], [mapping/@paper], [mapping/@phone], [mapping/@agency], [mapping/@blackListEmail], [mapping/@blackListSms], [mapping/@blackListPhone], [mapping/@blackListFax], [mapping/@blackListPaper], [mapping/@blackListAgency], [mapping/@format], [mapping/@countryCode], [mapping/@segmentCode], [mapping/@externalId], [deliveryProvider/@id], [deliveryProvider/@deliveryMode], [deliveryProvider/@messageType], [deliveryProvider/@mobileConnector], [deliveryProvider/@active], [deliveryProvider/@label], [typology/@id], [mapping/@id], [mapping/storage/@broadLogSchema],[mapping/storage/@exclusionType], [mapping/storage/@broadLogExclSchema],[mapping/storage/extraField/@dstXPath],[mapping/storage/extraField/@srcExpr],[offerSpace/env/@propositionSchema],[offerCategory],[offerCategory/@id],[@offerSpace-id],[offerSpace],[offerSpace/@id],[offerSpace/env/@id],[@offerThemes],[coupon/@code],[coupon/@type],[@contentEditingMode]" schema="nms:delivery" type="linkEdit" xpath="/tmp/@scenario" zoom="false">
          <sysFilter>
            <condition expr="@isModel = 1"/>
            <condition enabledIf="$(/ignored/tmp/@messageType)!=127" expr="@messageType = $byte(/ignored/tmp/@messageType)"/>
            <condition enabledIf="HasPackage('nms:messageCenter')" expr="$noescaping(/tmp/@messageFilter)"/>
            <condition enabledIf="HasPackage('nms:social') and $(/tmp/@social)=1" expr="@messageType IN (20, 25)"/>
          </sysFilter>
          <orderBy>
            <node expr="@builtIn" sortDesc="true"/>
            <node expr="@label"/>
          </orderBy>
          <enter name="onChange">
            <set value="0" xpath="@state"/>
            <if expr="@isModel=false and [/tmp/processId]!=0 AND [/tmp/processId]!=''">
              <set expr="[/tmp/processId]" xpath="@folder-id"/>
            </if>
            <if expr="HasPackage('nms:mobileApp')">
              <reset xpath="/tmp/notificationCustomFields"/>
              <reset xpath="/tmp/notificationSounds"/>
              <if expr="NodeExists([content/iosCustomFields/source]) OR NodeExists([content/androidCustomFields/source])">
                <copyElement exprSrc="'content/' + Iif(@messageType=41, 'ios', 'android') + 'CustomFields/source'" xpathDst="/tmp/notificationCustomFields"/>
              </if>
              <if expr="NodeExists([content/iosAvailableSounds/source]) OR NodeExists([content/androidAvailableSounds/source])">
                <copyElement exprSrc="'content/' + Iif(@messageType=41, 'ios', 'android') + 'AvailableSounds/source'" xpathDst="/tmp/notificationSounds"/>
              </if>
            </if>
            <if expr="HasPackage('nms:campaign') and [/ignored/tmp/@parentId]!=0 and [/ignored/tmp/@parentId]!=''">
              <set value="nms:operation" xpath="/ignored/queryDef/@schema"/>
              <set value="get" xpath="/ignored/queryDef/@operation"/>
              <set value="[parameter/@useBudget]" xpath="/ignored/queryDef/select/node[1]/@expr"/>
              <set value="[parameter/@useValidation]" xpath="/ignored/queryDef/select/node[2]/@expr"/>
              <set value="[@linkedOperation-id]" xpath="/ignored/queryDef/select/node[3]/@expr"/>
              <set value="[@budget-id]" xpath="/ignored/queryDef/select/node[4]/@expr"/>
              <set value="budget" xpath="/ignored/queryDef/select/node[5]/@expr"/>
              <set value="[budgetParameters/@commitmentLevel]" xpath="/ignored/queryDef/select/node[6]/@expr"/>
              <set value="@isModel" xpath="/ignored/queryDef/select/node[7]/@expr"/>
              <set expr="[/ignored/tmp/@workflowId]" xpath="/ignored/@workflow-id"/>
              <if expr="HasPackage('nms:response')">
                <set value="[parameter/@useMeasure]" xpath="/ignored/queryDef/select/node[8]/@expr"/>
              </if>
              <if expr="HasPackage('crm:lead')">
                <set value="[parameter/@useLandingPage]" xpath="/ignored/queryDef/select/node[9]/@expr"/>
              </if>
              <set expr="'@id='+[/ignored/tmp/@parentId]" xpath="/ignored/queryDef/where/condition/@expr"/>
              <soapCall name="ExecuteQuery" service="xtk:queryDef">
                <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                <param type="DOMDocument" xpathOut="/tmp/queryDef"/>
              </soapCall>
              <set expr="[/tmp/queryDef/parameter/@useBudget]" xpath="/ignored/@useBudget"/>
              <set expr="[/tmp/queryDef/parameter/@useValidation]" xpath="/ignored/@useValidation"/>
              <set expr="[/tmp/queryDef/@linkedOperation-id]" xpath="/ignored/@linkedOperation-id"/>
              <if expr="HasPackage('nms:response')">
                <set expr="[/tmp/queryDef/parameter/@useMeasure]" xpath="/ignored/@useMeasure"/>
              </if>
              <if expr="HasPackage('crm:lead')">
                <set expr="[/tmp/queryDef/parameter/@useLandingPage]" xpath="/ignored/@useLandingPage"/>
              </if>
              <set expr="[/ignored/tmp/@parentId]" xpath="/ignored/@operationId"/>
              <set expr="[/ignored/tmp/@parentId]" xpath="@operation-id"/>
              <if expr="[/ignored/@ownerOperationId]!=0">
                <set expr="[/ignored/@ownerOperationId]" xpath="@ownerOperation-id"/>
              </if>
              <set value="1" xpath="/tmp/@newFromOperation"/>
              <if expr="[/ignored/tmp/@workflowId]!=0">
                <set expr="[/ignored/tmp/@workflowId]" xpath="@workflow-id"/>
              </if>
              <if expr="[/ignored/@currentPage]='pageModel' and [/ignored/tmp/@workflowId]!=0 and [/ignored/tmp/@workflowId]!=''">
                <set value="1" xpath="/ignored/@dlvNotInDatabase"/>
              </if>
              <if expr="[/ignored/@useBudget] and [/tmp/queryDef/@budget-id]!=0">
                <set expr="[/tmp/queryDef/@budget-id]" xpath="@budget-id"/>
                <set expr="[/tmp/queryDef/budget/@_cs]" xpath="budget/@_cs"/>
                <set expr="[/tmp/queryDef/budgetParameters/@commitmentLevel]" xpath="budgetParameters/@commitmentLevel"/>
              </if>
              <if expr="[/tmp/queryDef/@isModel]='1' or [/tmp/queryDef/@isModel]='true' or [/ignored/tmp/@deliveryRecurring]=1">
                <set value="true" xpath="@isModel"/>
                <set expr="[@folder-id]" xpath="@folderProcess-id"/>
                <set expr="FolderFromName('nmsDeliveryModelOp')" xpath="@folder-id"/>
                <reset xpath="folderProcess"/>
                <reset xpath="folder"/>
                <reset xpath="/ignored/queryDef"/>
                <set value="xtk:folder" xpath="/ignored/queryDef/@schema"/>
                <set value="getIfExists" xpath="/ignored/queryDef/@operation"/>
                <set value="@label" xpath="/ignored/queryDef/select/node/@expr"/>
                <if expr="[@folder-id]!=0">
                  <set expr="'@id='+[@folder-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/tmp/queryDef"/>
                  </soapCall>
                  <set expr="[/tmp/queryDef/@label]" xpath="folder/@_cs"/>
                </if>
                <if expr="[@folderProcess-id]!=0">
                  <set expr="'@id='+[@folderProcess-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/tmp/queryDef"/>
                  </soapCall>
                  <set expr="[/tmp/queryDef/@label]" xpath="folderProcess/@_cs"/>
                </if>
              </if>
              <if expr="HasPackage('crm:lead') AND [/ignored/@operationId]!=0">
                <set value="crm:landingPage" xpath="/ignored/queryDefLP/@schema"/>
                <set value="select" xpath="/ignored/queryDefLP/@operation"/>
                <set value="@id" xpath="/ignored/queryDefLP/select/node[1]/@expr"/>
                <set value="[.]" xpath="/ignored/queryDefLP/select/node[2]/@expr"/>
                <set expr="'[@operation-id]='+[/ignored/@operationId]" xpath="/ignored/queryDefLP/where/condition/@expr"/>
                <soapCall name="ExecuteQuery" service="xtk:queryDef">
                  <param exprIn="[/ignored/queryDefLP]" type="DOMDocument"/>
                  <param type="DOMDocument" xpathOut="/tmp/queryDefLP"/>
                </soapCall>
                <if expr="NodeCount([/tmp/queryDefLP/landingPage])=1">
                  <set expr="[/tmp/queryDefLP/landingPage/@id]" xpath="@landingPage-id"/>
                  <set expr="[/tmp/queryDefLP/landingPage/@id]" xpath="landingPage/@id"/>
                  <set expr="[/tmp/queryDefLP/landingPage/@_cs]" xpath="landingPage/@_cs"/>
                </if>
              </if>
              <soapCall name="CompleteDeliveryOperation" service="nms:operation">
                <param exprIn="." type="DOMElement"/>
                <param exprIn="/ignored/dummy" type="DOMElement"/>
                <param type="DOMElement" xpathOut="."/>
              </soapCall>
            </if>
            <if expr="HasPackage('nms:social')">
              <if expr="EV(@messageType, 'facebook')">
                <set expr="EVal('nms:delivery:contentDef/@urlType', 'facebookLink')" xpath="content/facebookLink/@urlType"/>
                <set expr="EVal('nms:delivery:contentDef/@trackingType', 'no')" xpath="content/facebookPicture/@trackingType"/>
                <set expr="EVal('nms:delivery:contentDef/@urlType', 'facebookAction')" xpath="content/facebookActionLink/@urlType"/>
              </if>
              <if expr="EV(@messageType, 'twitter')">
                <set expr="EVal('nms:delivery:contentDef/@urlType', 'twitterLink')" xpath="content/twitterMsg/@urlType"/>
              </if>
            </if>
            <if expr="HasPackage('nms:messageCenter')">
              <set expr="iif (EV([triggerMessage/@publicationStatus], 'notApplicable')=false, 1, 0)" xpath="/ignored/@triggerMessage"/>
              <set expr="iif ([/ignored/@triggerMessage]=0 or NodeCount(FCPSeed)>1, 1, 0)" xpath="/ignored/@showAllSeedMembers"/>
              <if expr="[/ignored/@triggerMessage]">
                <set translatedExpr="'New'" xpath="FCPSeed/@label"/>
                <set expr="GetOption('XtkInstancePrefix')+'SDM'+CounterValue('nmsSeedMember')" xpath="FCPSeed/@internalName"/>
                <set value=" " xpath="FCPSeed/custom_nms_rtEvent/ctx"/>
                <set expr="@id" xpath="FCPSeed/@proof-id"/>
                <set expr="@messageType" xpath="/ignored/@messageType"/>
              </if>
            </if>
            <if expr="HasPackage('nms:social')">
              <set expr="iif (EV(@messageType, 'facebook', 'twitter'), 1, 0)" xpath="/ignored/@socialMessage"/>
            </if>
            <if expr="HasPackage('nms:mobileApp')">
              <set expr="iif (EV(@messageType, 'ios', 'android'), 1, 0)" xpath="/ignored/@pushMessage"/>
            </if>
            <if expr="HasPackage('nms:coreInteraction')">
              <set expr="AddOfferViewToBLogSchema([offerSpace/env/@propositionSchema], 'nms:offerView')" xpath="/ignored/@offerViewSchema"/>
              <copyElement xpathDst="/ignored/offerSpace" xpathSrc="/delivery/offerSpace"/>
            </if>
          </enter>
        </input>
        <static colspan="2" img="nms:circle-two.png">Complete or modify parameters</static>
        <container colspan="2" ref="nms:delivery:lib/general"/>
      </container>
      <container type="visibleGroup" visibleIf="[/ignored/@currentPage]='pageModel' and [/tmp/@showFolder]=1">
        <container ref="nms:delivery:lib/general"/>
      </container>
      <container type="visibleGroup" visibleIf="[/ignored/@currentPage]='pageContent'">
        <container type="visibleGroup" visibleIf="EV(@deliveryMode, 'external')">
          <container ref="nms:delivery:edit/fileDefinition"/>
        </container>
        <container type="visibleGroup" visibleIf="EV(@messageType, 'mail') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/emailDefinition"/>
        </container>
        <container applicableIf="HasPackage('nms:paper')" type="visibleGroup" visibleIf="EV(@messageType, 'paper') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/paperDefinition"/>
        </container>
        <container type="visibleGroup" visibleIf="EV(@messageType, 'sms') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/mobileDefinition"/>
        </container>
        <container type="visibleGroup" visibleIf="EV(@messageType, 'fax') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/faxDefinition"/>
        </container>
        <container type="visibleGroup" visibleIf="EV(@messageType, 'other') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/otherDefinition"/>
        </container>
        <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="EV(@messageType, 'facebook') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/facebookDefinition"/>
        </container>
        <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="EV(@messageType, 'twitter') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/twitterDefinition"/>
        </container>
        <container applicableIf="HasPackage('nms:mobileApp')" type="visibleGroup" visibleIf="EV(@messageType, 'ios') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/iOSDefinition"/>
        </container>
        <container applicableIf="HasPackage('nms:mobileApp')" type="visibleGroup" visibleIf="EV(@messageType, 'android') and @deliveryMode!=0">
          <container ref="nms:delivery:edit/androidDefinition"/>
        </container>
      </container>
      <static/>
      <container align="right" colcount="2">
        <container type="visibleGroup" visibleIf="[/ignored/@currentPage]!='pageContent'">
          <input label="Continue" type="button">
            <enter>
              <check expr="([/tmp/@modelId]!='' and [/tmp/@modelId]!=0) OR [/tmp/@showFolder]=1">
                <error>Please select a delivery template.</error>
              </check>
              <set value="prepareda" xpath="@module"/>
              <set value="pageContent" xpath="/ignored/@currentPage"/>
              <set value="" xpath="/ignored/@dlvNotReady"/>
              <if expr="HasPackage('nms:campaign')">
                <if expr="[@workflow-id]!=0">
                  <set value="3" xpath="targets/@targetMode"/>
                </if>
              </if>
            </enter>
          </input>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/@currentPage]='pageContent'">
          <input label="Save" type="button">
            <enter>
              <saveView/>
              <closeForm modalReturn="0"/>
            </enter>
          </input>
        </container>
        <input label="Cancel" name="Cancel" type="button">
          <enter>
            <closeForm modalReturn="2"/>
          </enter>
        </input>
      </container>
      <input applicableIf="HasPackage('ncm:content') and HasPackage('nms:campaign')" expr="[@publishing-name]!='' and [@publishing-namespace]!=''" type="expr" xpath="/ignored/@hasContent"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[@operation-id]!=0 and [validation/@useTargetValidation]" type="expr" xpath="/ignored/@disableStart"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[validation/@useTargetValidation] and [@operation-id]!=0" type="expr" xpath="/ignored/@useTargetValidation"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[validation/@useContentValidation] and [@operation-id]!=0" type="expr" xpath="/ignored/@useContentValidation"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="@contentStatus" type="expr" xpath="/ignored/@contentStatus"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="@targetStatus" type="expr" xpath="/ignored/@targetStatus"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[targets/@deliveryLimitExpr]" type="expr" xpath="/ignored/@deliveryLimitExpr"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[scheduling/@extractionExpr]" type="expr" xpath="/ignored/@extractionExpr"/>
      <input applicableIf="HasPackage('nms:campaign')" expr="[scheduling/@contactDateExpr]" type="expr" xpath="/ignored/@contactDateExpr"/>
      <input expr="iif([/ignored/@ownerOperationId]!='' and [/ignored/@ownerOperationId]!=0, [/ignored/@ownerOperationId], [/ignored/tmp/@parentId])" type="expr" xpath="/ignored/tmp/@parentId"/>
      <container name="toolbar" ref="nms:delivery:toolbar"/>
      <container ref="nms:delivery:menuBuilder"/>
      <input applicableIf="HasPackage('nms:aemIntegration')" expr="Iif([/delivery/@contentEditingMode]=2, 'true', 'false')" type="expr" xpath="/ignored/@isAEMContent"/>
      <input applicableIf="HasPackage('nms:aemIntegration')" expr="Iif([/delivery/@contentEditingMode]=2 and [remoteContent/@remotePath] != '', 'true', 'false')" type="expr" xpath="/ignored/@isLinkedToContent"/>
      <leave ref="nms:delivery:leave"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Seed addresses" md5="189FC1AC74EA2D801D972D368F93D457" name="seedMember" namespace="nms" xtkschema="xtk:form">
      <enter>
        <if expr="NodeCount(targetData) == 0">
          <set value="" xpath="targetData"/>
        </if>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container applicableIf="HasPackage('nms:messageCenter')" name="rtEvent">
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/ignored/@triggerMessage]!=1">
            <input xpath="../@label"/>
            <input xpath="../@internalName"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@triggerMessage]=1">
            <input xpath="../@label"/>
          </container>
          <container colspan="2">
            <container type="visibleGroup" visibleIf="[/ignored/@messageType]=0 or [/ignored/@messageType]=''">
              <input img="nms:sendemail.png" xpath="@email"/>
            </container>
            <container applicableIf="HasPackage('nms:mobile')" type="visibleGroup" visibleIf="[/ignored/@messageType]=1 or [/ignored/@messageType]=''">
              <input xpath="@mobilePhone"/>
            </container>
            <container applicableIf="HasPackage('nms:paper')" type="visibleGroup" visibleIf="[/ignored/@messageType]=3 or [/ignored/@messageType]=''" xpath="postalAddress">
              <static label="Postal address" type="separator"/>
              <input xpath="@line1"/>
              <input xpath="@line2"/>
              <input xpath="@line3"/>
              <input xpath="@line4"/>
              <input xpath="@line5"/>
              <input xpath="@line6"/>
              <input xpath="@line7"/>
            </container>
            <container applicableIf="HasPackage('nms:mobileApp')" type="visibleGroup" visibleIf="[/ignored/@messageType]=41 or [/ignored/@messageType]=42 or [/ignored/@messageType]=''">
              <container type="visibleGroup" visibleIf="[/ignored/@messageType]=''">
                <input createMode="none" noZoom="true" notifyPathList="@uuid|../mobileApp/@uuid,@pushPlatform|../mobileApp/@pushPlatform,@senderId|../mobileApp/@senderId,@password|../mobileApp/@password,@certificate|../mobileApp/@certificate,@sandbox|../mobileApp/@sandbox" xpath="mobileAppLink"/>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/@messageType]=41 or [/ignored/@messageType]=42">
                <input createMode="none" noZoom="true" notifyPathList="@uuid|../mobileApp/@uuid,@pushPlatform|../mobileApp/@pushPlatform,@senderId|../mobileApp/@senderId,@password|../mobileApp/@password,@certificate|../mobileApp/@certificate,@sandbox|../mobileApp/@sandbox" xpath="mobileAppLink">
                  <sysFilter>
                    <condition expr="@pushPlatform = Iif($(/ignored/@messageType) = 41, 0, 1)"/>
                  </sysFilter>
                </input>
              </container>
              <container colcount="2" type="visibleGroup" visibleIf="[@mobileAppLink-id] != 0">
                <input type="edit" xpath="@registrationToken"/>
                <input label="Select a token" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Choose a registration token" nothingToSave="true">
                    <input extraColumns="@registrationToken" monoSelection="true" noZoom="true" nolabel="true" schema="nms:appSubscriptionRcp" type="linkListChoice" xpath="." xpathOut="/tmp/appSubscription">
                      <input label="Terminal name" xpath="device/@deviceName"/>
                      <input xpath="@registrationDate"/>
                      <input xpath="@registrationToken"/>
                      <input xpath="@userKey"/>
                      <input xpath="@disabled"/>
                      <input xpath="@disabledDate"/>
                      <sysFilter>
                        <condition expr="[@mobileApp-id] = $(@mobileAppLink-id)"/>
                      </sysFilter>
                    </input>
                    <leave>
                      <set expr="[/tmp/appSubscription/appSubscriptionRcp/@registrationToken]" xpath="@registrationToken"/>
                    </leave>
                  </form>
                </input>
              </container>
            </container>
            <input xpath="@externalId"/>
            <static label="Content" type="separator"/>
            <input checkModify="false" nolabel="true" type="SourceEdit" xpath="ctx"/>
          </container>
        </container>
      </container>
      <container name="root" setOriginalAsDefault="true">
        <container type="notebook">
          <container colcount="2" label="Recipient" name="recipient" visibleIf="[/ignored/@triggerMessage]!=1">
            <input exprDefault="[custom_nms_recipient/@lastName]+' '+[custom_nms_recipient/@firstName]" xpath="@label"/>
            <input xpath="@internalName"/>
            <input colspan="2" editable="true" nolabel="true" type="treeEdit">
              <container label="Recipient (nms:recipient)" xpath="custom_nms_recipient">
                <input xpath="@salutation"/>
                <input xpath="@firstName"/>
                <input xpath="@middleName"/>
                <input xpath="@lastName"/>
                <input img="nms:sendemail.png" xpath="@email"/>
                <input xpath="@emailFormat"/>
                <input xpath="@mobilePhone"/>
                <input xpath="@phone"/>
                <input xpath="@fax"/>
                <input applicableIf="hasPackage('nms:centralLocal')" xpath="@agency"/>
                <input xpath="@account"/>
                <input xpath="@origin"/>
                <input xpath="@blackList"/>
                <input xpath="@status"/>
                <input xpath="@gender"/>
                <input xpath="@birthDate"/>
                <input xpath="@language"/>
                <input xpath="@company"/>
                <container label="Location (location)" xpath="location">
                  <input xpath="@address1"/>
                  <input xpath="@address2"/>
                  <input xpath="@address3"/>
                  <input xpath="@address4"/>
                  <input xpath="@zipCode"/>
                  <input xpath="@city"/>
                  <input xpath="@stateCode"/>
                  <input xpath="@countryCode"/>
                </container>
              </container>
              <container label="Subscription (nms:subscription)" xpath="custom_nms_subscription">
                <input xpath="@created"/>
                <container label="Service (service)" xpath="service">
                  <input xpath="@label"/>
                  <input xpath="@name"/>
                </container>
              </container>
            </input>
          </container>
          <container colcount="2" label="Address fields" name="address" visibleIf="[/ignored/@triggerMessage]!=1" xpath="custom_nms_broadLog">
            <input xpath="../@label"/>
            <input xpath="../@internalName"/>
            <container colspan="2">
              <static label="Postal address" type="separator"/>
              <container xpath="postalAddress/address">
                <input xpath="@line1"/>
                <input xpath="@line2"/>
                <input xpath="@line3"/>
                <input xpath="@line4"/>
                <input xpath="@line5"/>
                <input xpath="@line6"/>
                <input xpath="@line7"/>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:messageCenter') and $(entityPath)!='/operation'" colcount="2" label="Event" name="rtEvent" ref="nms:seedMember:lib/rtEvent" xpath="custom_nms_rtEvent"/>
          <container label="Additional data" name="targetData" visibleIf="[/ignored/@triggerMessage]!=1" xpath="targetData">
            <container img="xtk:help.png" label="Help" type="frame">
              <static>Please insert the data in XML format which will replace the additional targeting data during the use of this address in a delivery.
E.g.:
&lt;targetData total="9420"&gt;
  &lt;lastOrder1 dataPurchase="2010-02-22" amount="150" number="CMD2010022200401"/&gt;
  &lt;lastOrder2 dataPurchase="2010-01-01" amount="450" number="CMD2010010136340"/&gt;
&lt;targetData&gt;</static>
            </container>
            <input nolabel="true" type="sourceEdit" xpath="."/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:group" entitySchema="xtk:form" img="xtk:import32.png" label="List import" md5="2E23A363FD17A630EB1A2F4710069B37" name="importList" namespace="nms" type="wizard" xpathsToLoad="@doNotPersist" xtkschema="xtk:form">
      <container name="lib" type="visibleGroup" visibleIf="false">
        <form colcount="2" label="File format" name="fileFormat">
          <input expr="@colType" type="expr" xpath="/tmp/initval">
            <enter>
              <forEach xpath="dataSourceColumn">
                <if expr="@typeXform==''">
                  <set expr="@type" xpath="@typeXform"/>
                </if>
                <set value="string" xpath="@type"/>
                <if expr="@intFormat==''">
                  <set value="other" xpath="@intFormat"/>
                </if>
                <if expr="@typeXform=='datetime'">
                  <set expr="@dateFormat + 'his'" xpath="@dateTimeFormat"/>
                </if>
                <if expr="@stringXform==''">
                  <set value="none" xpath="@stringXform"/>
                </if>
                <if expr="@spaceXform==''">
                  <set value="none" xpath="@spaceXform"/>
                </if>
                <if expr="!@colProcessing">
                  <set value="0" xpath="@colProcessing"/>
                </if>
                <if expr="!@allowNullValues">
                  <set value="0" xpath="@allowNullValues"/>
                </if>
                <if expr="!@width">
                  <set value="255" xpath="@width"/>
                </if>
                <if expr="@dateSep==''">
                  <set value="/" xpath="@dateSep"/>
                </if>
                <if expr="@timeSep==''">
                  <set value=":" xpath="@timeSep"/>
                </if>
                <if expr="@dateTimeSep==''">
                  <set value=" " xpath="@dateTimeSep"/>
                </if>
                <if expr="@decimalSep==''">
                  <set value="," xpath="@decimalSep"/>
                </if>
                <if expr="@thousandSep==''">
                  <set value=" " xpath="@thousandSep"/>
                </if>
                <if expr="@dateFormat==''">
                  <set value="ymd" xpath="@dateFormat"/>
                </if>
                <if expr="@dateTimeFormat==''">
                  <set value="ymdhis" xpath="@dateTimeFormat"/>
                </if>
                <if expr="@timeFormat==''">
                  <set value="hhmm" xpath="@timeFormat"/>
                </if>
                <if expr="@numFormat==''">
                  <set value="other" xpath="@numFormat"/>
                </if>
                <if expr="@intFormat==''">
                  <set value="other" xpath="@intFormat"/>
                </if>
              </forEach>
            </enter>
          </input>
          <static colcount="2" colspan="2" label="General" type="separator"/>
          <input colspan="2" xpath="@colType"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[../@format]=='text'">
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@colType==1">
              <container colcount="2" colspan="2">
                <input xpath="@codepage"/>
                <input xpath="@ignoredChar"/>
                <input xpath="@timezone"/>
              </container>
              <input xpath="@firstLineIsTitle"/>
              <input xpath="../../@collectLineNumber"/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@colType==0">
              <container colcount="2" colspan="2">
                <input xpath="@codepage"/>
                <input xpath="@ignoredLines"/>
                <input xpath="@timezone"/>
              </container>
              <input nolabel="true" xpath="@firstLineIsTitle"/>
              <input xpath="../../@collectLineNumber"/>
              <input colspan="2" nolabel="true" xpath="@multiline"/>
              <input xpath="@textQualifier"/>
              <static/>
              <static colspan="2" label="Column separator" type="separator"/>
              <container colcount="5" colspan="2">
                <input xpath="@tabIsSep"/>
                <input xpath="@spaceIsSep"/>
                <input xpath="@semiColumnIsSep"/>
                <input xpath="@commaIsSep"/>
                <input xpath="@otherSep"/>
                <input colspan="5" xpath="@consecutiveDelimiters"/>
              </container>
            </container>
          </container>
          <static colcount="2" colspan="2" label="Columns" type="separator"/>
          <container colspan="2" type="visibleGroup" visibleIf="[../@format]=='text'">
            <input columnIndex="true" disableEditButtonsExpr="@colType==0" editable="true" hideEditButtons="false" img="xtk:text.png" noToolbar="false" nolabel="true" ordered="false" type="list" xpath="dataSourceColumn" xpathRefresh="../*" xpathToIgnore="dataSourceColumn/valueMapping" zoom="true">
              <input xpath="@label"/>
              <input xpath="@name"/>
              <input xpath="@ignore"/>
              <input label="Data type" xpathExpr="Iif(@ignore!=1, '@typeXform', '')"/>
              <input label="Allow NULLs" xpathExpr="Iif(@ignore!=1, '@allowNullValues', '')"/>
              <input label="Length" xpathExpr="Iif(@ignore!=1 AND @typeXform=='string', '@width', '')"/>
              <input label="Format" xpathExpr="Iif(@ignore!=1,                       Iif(@typeXform=='date', '@dateFormat',                       Iif(@typeXform=='datetime', '@dateTimeFormat',                       Iif(@typeXform=='time', '@timeFormat',                       Iif(EV(@typeXform, 'double', 'float'), '@numFormat',                       Iif(EV(@typeXform, 'short', 'long', 'int64'), '@intFormat' , ''))))), '')">
                <enter name="onChange">
                  <switch>
                    <case expr="EV(@typeXform, 'short', 'long', 'int64')">
                      <switch>
                        <case expr="@intFormat='sepComma'">
                          <set value="," xpath="@thousandSep"/>
                        </case>
                        <case expr="@intFormat='sepSpace'">
                          <set value=" " xpath="@thousandSep"/>
                        </case>
                      </switch>
                    </case>
                    <case expr="EV(@typeXform, 'double', 'float')">
                      <switch>
                        <case expr="@numFormat='sepPoint'">
                          <set value="," xpath="@thousandSep"/>
                          <set value="." xpath="@decimalSep"/>
                        </case>
                        <case expr="@numFormat='sepComma'">
                          <set value=" " xpath="@thousandSep"/>
                          <set value="," xpath="@decimalSep"/>
                        </case>
                      </switch>
                    </case>
                    <case expr="EV(@typeXform, 'datetime')">
                      <set expr="SubString(@dateTimeFormat, 0, 3)" xpath="@dateFormat"/>
                    </case>
                  </switch>
                </enter>
              </input>
              <input label="Data transformation" xpathExpr="Iif(@ignore!=1 AND @typeXform='string', '@stringXform', '')"/>
              <input label="White space management" xpathExpr="Iif(@ignore!=1 AND @typeXform='string', '@spaceXform', '')"/>
              <input label="Error processings" xpathExpr="Iif(@ignore!=1, '@colProcessing', '')"/>
              <input label="Default value" xpathExpr="Iif(@ignore!=1 AND EV(@colProcessing, 'defaultOnErr', 'defaultOnMissing'), '@default', '')"/>
              <form label="Column detail">
                <input xpath="@label"/>
                <input xpath="@name"/>
                <input xpath="@ignore"/>
                <container type="visibleGroup" visibleIf="!@ignore">
                  <container type="visibleGroup" visibleIf="[/ignored/@hideSQLName]!=1">
                    <input xpath="@sqlname"/>
                    <static type="help">If the SQL name is not specified a default name will be used instead.</static>
                  </container>
                  <input label="Data type" xpath="@typeXform"/>
                  <input xpath="@allowNullValues"/>
                  <container type="visibleGroup" visibleIf="@typeXform='string'">
                    <container label="Properties" maxLabelWidth="300" type="frame">
                      <input xpath="@width"/>
                      <input label="Data transformation" xpath="@stringXform"/>
                      <input label="White space management" xpath="@spaceXform"/>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="@typeXform=='date'">
                    <container label="Format and separator" maxLabelWidth="300" type="frame">
                      <input xpath="@dateFormat"/>
                      <container colcount="2" type="visibleGroup" visibleIf="EV(@dateFormat, 'ymdnosep')=false">
                        <input label="Year, month, day" width="5" xpath="@dateSep"/>
                      </container>
                      <container type="visibleGroup" visibleIf="EV(@dateFormat, 'ymdnosep', 'ymdsoap')=false">
                        <input alwaysActive="true" expr="Iif(@dateFormat=='ymd', '2001' + @dateSep + '04' + @dateSep + '24',                                           Iif(@dateFormat=='mdy', '04' + @dateSep + '24' + @dateSep + '2001',                                           Iif(@dateFormat=='dmy', '24' + @dateSep + '04' + @dateSep + '2001',                                           Iif(@dateFormat=='myd', '04' + @dateSep + '2001' + @dateSep + '24',                                           Iif(@dateFormat=='dym', '24' + @dateSep + '2001' + @dateSep + '24',                                           Iif(@dateFormat=='ydm', '2001' + @dateSep + '24' + @dateSep + '04', ''))))))" label="Example" type="value"/>
                      </container>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="@typeXform=='time'">
                    <container label="Format and separator" maxLabelWidth="300" type="frame">
                      <input xpath="@timeFormat"/>
                      <container colcount="2">
                        <input label="Hour, minute, second" width="5" xpath="@timeSep"/>
                      </container>
                      <input alwaysActive="true" expr="'13' + @timeSep + '30' + Iif(@timeFormat=='hhmmss', @timeSep + '55', '')" label="Example" type="value"/>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="@typeXform=='datetime'">
                    <container label="Format and separators" maxLabelWidth="300" type="frame">
                      <input label="Date format" xpath="@dateFormat">
                        <enter name="onChange">
                          <set expr="@dateFormat + 'his'" xpath="@dateTimeFormat"/>
                        </enter>
                      </input>
                      <input label="Time format" xpath="@timeFormat"/>
                      <container colcount="3" type="visibleGroup" visibleIf="EV(@dateFormat, 'ymdnosep')=false">
                        <input label="Year, month, day" width="5" xpath="@dateSep"/>
                        <input label="Hour, minute, second" width="5" xpath="@timeSep"/>
                        <input label="Date, hour" width="5" xpath="@dateTimeSep"/>
                      </container>
                      <input alwaysActive="true" expr="Iif(@dateFormat=='ymd', '2001' + @dateSep + '04' + @dateSep + '24' + @dateTimeSep + '23' + @timeSep + '59' + Iif(@timeFormat=='hhmmss', @timeSep + '59', ''),                                           Iif(@dateFormat=='mdy', '04' + @dateSep + '24' + @dateSep + '2001' + @dateTimeSep + '23' + @timeSep + '59' + Iif(@timeFormat=='hhmmss', @timeSep + '59', ''),                                           Iif(@dateFormat=='dmy', '24' + @dateSep + '04' + @dateSep + '2001' + @dateTimeSep + '23' + @timeSep + '59' + Iif(@timeFormat=='hhmmss', @timeSep + '59', ''),                                           Iif(@dateFormat=='myd', '04' + @dateSep + '2001' + @dateSep + '24' + @dateTimeSep + '23' + @timeSep + '59' + Iif(@timeFormat=='hhmmss', @timeSep + '59', ''),                                           Iif(@dateFormat=='dym', '24' + @dateSep + '2001' + @dateSep + '24' + @dateTimeSep + '23' + @timeSep + '59' + Iif(@timeFormat=='hhmmss', @timeSep + '59', ''),                                           Iif(@dateFormat=='ydm', '2001' + @dateSep + '24' + @dateSep + '04' + @dateTimeSep + '23' + @timeSep + '59' + Iif(@timeFormat=='hhmmss', @timeSep + '59', ''),                                           ''))))))" label="Example" type="value"/>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="EV(@typeXform, 'short', 'long', 'int64')">
                    <container label="Format and separators" maxLabelWidth="300" type="frame">
                      <input xpath="@intFormat"/>
                      <input expr="Iif(@intFormat='other', NodeValue('@thousandSep'),                                                                    Iif(@intFormat=='sepComma', ',',                                                                        Iif(@intFormat=='sepSpace', ' ', '')))" type="expr" xpath="@thousandSep"/>
                      <container colcount="2" type="visibleGroup" visibleIf="@intFormat='other'">
                        <input label="Thousand separator" xpath="@thousandSep"/>
                      </container>
                      <input alwaysActive="true" expr="'1' + @thousandSep + '000'" label="Example" type="value"/>
                    </container>
                  </container>
                  <container type="visibleGroup" visibleIf="EV(@typeXform, 'double', 'float')">
                    <container label="Format and separators" maxLabelWidth="300" type="frame">
                      <input xpath="@numFormat"/>
                      <input expr="Iif(@numFormat='other', NodeValue('@thousandSep'), Iif(@numFormat=='sepComma', ' ', ','))" type="expr" xpath="@thousandSep"/>
                      <input expr="Iif(@numFormat='other', NodeValue('@decimalSep'), Iif(@numFormat=='sepComma', ',', '.'))" type="expr" xpath="@decimalSep"/>
                      <container colcount="2" type="visibleGroup" visibleIf="@numFormat='other'">
                        <input label="Thousand separator" xpath="@thousandSep"/>
                        <input label="Decimal separator" xpath="@decimalSep"/>
                      </container>
                      <input alwaysActive="true" expr="'1' + @thousandSep + '000' + @decimalSep + '00'" label="Example" type="value"/>
                    </container>
                  </container>
                  <input label="Remapping" type="list" xpath="valueMapping">
                    <input label="Value" xpath="@src"/>
                    <input label="Result" xpath="@dst"/>
                  </input>
                  <input xpath="@colProcessing"/>
                  <container type="visibleGroup" visibleIf="EV(@colProcessing, 'defaultOnErr', 'defaultOnMissing')">
                    <input xpath="@default"/>
                  </container>
                </container>
              </form>
            </input>
          </container>
          <static fontBold="true" type="help">The dates format defines the breakdown into years/months/days. Separators are specified in the detail window.</static>
          <leave>
            <forEach xpath="dataSourceColumn">
              <set value="string" xpath="@type"/>
            </forEach>
          </leave>
        </form>
      </container>
      <container desc="Please select source file." name="inputFile" title="File to import" xpath="source">
        <container colcount="2" importList="true" name="autoDetect" type="importAutoDetectContainer" xpath="dataSourceConfig" xpathAutoDetect="../name" xpathLastParsed="../@lastParsedDataSource" xpathUploadFile="../@upload">
          <container colspan="2" type="visibleGroup" visibleIf="[../@upload]">
            <input filters="Text, CSV or XML files (*.txt;*.csv;*.tab;*.xml)|*.txt;*.csv;*.tab;*.xml|All (*.*)|*.*|" label="Local file" type="fileEdit" xpath="../name" xpathType="../@format"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[../@upload] == false">
            <input label="Server file" xpath="../name"/>
          </container>
          <container colcount="2" colspan="2" name="upload">
            <input alwaysActive="true" expr="FileUploaded([../name], [../@md5])" type="expr" xpath="/ignored/file/@uploadStatus"/>
            <input label=" " useDesc="true" xpath="../@upload"/>
            <container type="visibleGroup" visibleIf="[../@upload]">
              <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == -1">
                <static img="xtk:logwarn.png" label=" " nolabel="false">The file no longer exists on the local disk and has not been uploaded</static>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 0">
                <static img="xtk:loginfo.png" label=" " nolabel="false">The local file has not been uploaded on the server</static>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 1">
                <static img="xtk:logwarn.png" label=" " nolabel="false">The local file is not equal to the one on the server</static>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 2">
                <static img="xtk:xtkcheck.png" label=" " nolabel="false">File exists on server, but not on the local disk</static>
              </container>
              <container type="visibleGroup" visibleIf="[/ignored/file/@uploadStatus] == 3">
                <static img="xtk:xtkcheck.png" label=" " nolabel="false">File already exists on server</static>
              </container>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[../@upload]">
              <input img="xtk:upload.png" label="Update on server..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath="..">
                <form label="Updating file on server">
                  <enter>
                    <set value="" xpath="/ignored/@performedUpload"/>
                    <set expr="name" xpath="/ignored/resource/@fileName"/>
                    <set expr="@md5==''" xpath="/ignored/resource/@md5Empty"/>
                  </enter>
                  <input label="File" required="true" type="fileEdit" xpath="/ignored/resource/@fileName"/>
                  <static type="help">Click on 'Upload' to start the file transfer to the server.</static>
                  <container exprTransferType="true" keyIsMd5="true" methodName="NONE" notResTable="true" type="resourceTransferContainer" xpathFile="/ignored/resource/@fileName" xpathOutList="@md5,/ignored/@performedUpload">
                    <input name="JobLogsList" type="JobLogList"/>
                    <container colcount="2">
                      <value dataType="timespan" label="Elapsed" xpath="/tmp/execution/@elapsed"/>
                      <value dataType="timespan" label="Estimated left" xpath="/tmp/execution/@remaining"/>
                    </container>
                    <container colcount="2" enabledIf="[/ignored/@performedUpload] == ''" type="enabledGroup">
                      <value name="JobProgressBar" type="ProgressBar" valign="center" xpathElapsed="/tmp/timing/@elapsed" xpathRemaining="/tmp/timing/@remaining"/>
                      <input enabledIf="[/ignored/resource/@fileName] != '' " img="xtk:upload.png" label="&amp;Transfer" name="JobSubmitButton" type="flatbutton"/>
                    </container>
                  </container>
                </form>
              </input>
              <container enabledIf="[/ignored/file/@uploadStatus] > 0" type="enabledGroup">
                <input filename="name" form="xtk:fileResDownload" img="xtk:download.png" label="Download..." nolabel="true" prebuildSubForm="false" type="fileLink" xpath=".."/>
              </container>
            </container>
          </container>
          <input img="xtk:refresh.png" label="Auto-Detect format" name="autoDetectBtn1" nolabel="false" type="urlButton"/>
          <input img="xtk:fileEdit.png" label="Click here to change the file format..." nolabel="false" type="subFormLink" xpath=".">
            <form ref="nms:importList:lib/fileFormat"/>
          </input>
          <input img="xtk:properties.png" label="Advanced parameters..." nolabel="false" type="subFormLink">
            <form label="Advanced parameters">
              <input dlgType="save" filters="Text documents (*.txt)|*.txt|All Files (*.*)|*.*|" title="Rejection file" type="FileEdit" xpath="/group/@rejectFilename"/>
              <input xpath="/group/@errorLimit"/>
            </form>
          </input>
          <static/>
          <static colspan="2" label="Preview" type="separator"/>
          <input colspan="2" name="PreviewList" type="fileParsingPreviewList" xpath="." xpathIndex="/tmp/columns/@current"/>
        </container>
        <leave>
          <check expr="name!=''">
            <error>You must specify a source file.</error>
          </check>
        </leave>
      </container>
      <container desc="Specify the name and path of the list to be created." name="list" title="Select list" visibleIf="[/tmp/@reopen] != 1">
        <input xpath="@label"/>
        <container type="visibleGroup" visibleIf="[/tmp/folderId]=''">
          <input colspan="2" img="nms:rcpgroup.png" writeAccess="true" xpath="folder">
            <sysFilter>
              <condition expr="@model = 'nmsGroup'"/>
            </sysFilter>
          </input>
        </container>
        <leave>
          <if expr="[/tmp/@folderId]!=0 AND [/tmp/@folderId]!=''">
            <set expr="[/tmp/@folderId]" xpath="@folder-id"/>
          </if>
          <check expr="@label!='' and @name!='' and [@folder-id]!=0">
            <error>You must provide all the required information.</error>
          </check>
        </leave>
      </container>
      <container desc="Click 'Start' to load the file in the database." name="importFile" title="Load file">
        <container refreshPeriod="500" type="importListProgressContainer" xpathProperties="/properties">
          <enter>
            <set value="2" xpath="@type"/>
            <saveView/>
          </enter>
          <soapCall name="ImportFile" service="nms:group">
            <param exprIn="/" type="DOMElement"/>
            <param type="DOMDocument" xpathOut="."/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Organizational entity" maxLabelWidth="50" md5="8F72C9C008A682046B7E9CE4F7A7EDE6" name="localOrgUnit" namespace="nms" xpathsToLoadOpt="orderValidation/*" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/ignored/@addReminder"/>
      </enter>
      <container ref="nms:delivery:menuBuilder"/>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="general" type="iconbox">
          <container colcount="2" img="xtk:properties.png" label="General">
            <input xpath="@label"/>
            <input xpath="@name"/>
            <input xpath="@nature"/>
            <input createMode="none" xpath="parent">
              <sysFilter>
                <condition expr="@id != $(@id)"/>
              </sysFilter>
            </input>
            <container applicableIf="HasPackage('nms:centralLocal')" colcount="2" colspan="2" label="Notifications and approvals" type="frame">
              <static colspan="2" img="nms:centralCatalog.png" label="Package notifications" type="separator"/>
              <input createMode="none" noZoom="true" xpath="group">
                <sysFilter>
                  <condition expr="@type = 1"/>
                </sysFilter>
              </input>
              <static/>
              <static colspan="2" img="nms:localOrder.png" label="Order approval" type="separator"/>
              <container applicableIf="HasPackage('nms:centralLocal')" colcount="2" colspan="2" ref="nms:operation:lib/assignee" xpath="orderValidation"/>
              <static colspan="2" img="nms:operation.png" label="Campaign reviewers" type="separator"/>
              <input createMode="none" label="Group" noZoom="true" xpath="operationValidation">
                <sysFilter>
                  <condition expr="@type = 1"/>
                </sysFilter>
              </input>
              <static/>
            </container>
            <static colspan="2" label="Comment" type="separator"/>
            <input colspan="2" nolabel="true" xpath="comment"/>
          </container>
          <container colcount="2" img="nms:msgfolder.png" label="Details" name="address">
            <container colcount="2" colspan="2" label="Address" type="frame" xpath="location">
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address1"/>
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address2"/>
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address3"/>
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address4"/>
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@additionalRcp"/>
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@additionalGeo"/>
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@street"/>
              <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@special"/>
              <input xpath="@zipCode"/>
              <input xpath="@city"/>
              <input choiceButton="true" createMode="none" extraColumns="@isoA2,@isoA3" noZoom="true" xpath="../country">
                <orderBy>
                  <node expr="@label"/>
                </orderBy>
              </input>
              <static/>
            </container>
            <container colcount="2" colspan="2" label="Contacts" type="frame">
              <input xpath="@phone"/>
              <input xpath="@fax"/>
              <input xpath="@email"/>
              <input xpath="@url"/>
            </container>
          </container>
          <container img="xtk:operator.png" label="Operators">
            <input disableDefaultFilter="true" hideEditButtons="true" hideFilterBtn="true" img="xtk:operator.png" nolabel="true" toolbarCaption="Operators assigned to the organizational entity" type="linklist" xpath="operator">
              <input xpath="[.]"/>
            </input>
          </container>
          <container applicableIf="HasPackage('nms:centralLocal')" img="nms:localOrder.png" label="Orders">
            <input enumImage="@status" hideEditButtons="true" img="nms:localOrder.png" nolabel="true" toolbarCaption="Order tracking" type="linklist" xpath="localOrder">
              <input xpath="[.]"/>
              <input xpath="@status"/>
              <node xpath="operation"/>
              <input xpath="@start"/>
              <input xpath="@end"/>
            </input>
          </container>
        </container>
      </container>
      <container type="notebook">
        <container applicableIf="HasPackage('nms:centralLocal')" img="nms:localOrgUnit.png" label="Dashboard" visibleIf="[/ignored/@_isNewEntity]=false">
          <input entityRefresh="nms:localOrgUnit" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/nms/localOrgUnit.jssp?id='+@id+'&amp;standalone=1'"/>
        </container>
        <container img="xtk:form.png" label="Edit" visibleIf="@id != 0">
          <container ref="nms:localOrgUnit:lib/general"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Target mapping" md5="C332D1E141D9AE040DC52368AD0740BC" name="deliveryMapping" namespace="nms" type="iconbox" xtkschema="xtk:form">
      <enter>
        <set expr="mappingSchemaExt(@schema)" xpath="/ignored/@dummySchema"/>
        <set expr="Iif(@recipientLink!='', 1, 0)" xpath="/ignored/@longLinkToMapping"/>
      </enter>
      <container colcount="2" img="xtk:properties.png" label="General" name="tabGene">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <static colspan="2" label="Target population" type="separator"/>
        <container colspan="2">
          <input checkedValue="0" colspan="2" label="Use the targeting dimension directly" type="radioButton" xpath="/ignored/@longLinkToMapping"/>
          <input checkedValue="1" colspan="2" label="Use linked data" type="radioButton" xpath="/ignored/@longLinkToMapping"/>
          <container colspan="2" type="visibleGroup" visibleIf="[/ignored/@longLinkToMapping]">
            <input label="Filtering dimension" type="schemaEdit" xpath="@schema" xpathLink="@recipientLink"/>
            <input choiceType="xpath" label="Change dimension" nolabel="false" type="pathEdit" useTablePath="true" useUnboundPath="true" xpath="@recipientLink"/>
            <input expr="GetLinkSchema(@schema, @recipientLink)" type="expr" xpath="@targetSchema"/>
            <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="@targetSchema"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="![/ignored/@longLinkToMapping]">
            <input label="Targeting dimension" type="targetSchema" xpath="@schema" xpathLink="@recipientLink">
              <form entity-schema="xtk:schema" label="Please select a document" name="entitySchema" namespace="xtk" nothingToSave="true">
                <input monoSelection="true" notifyFolderKeyPath="" schema="xtk:schema" type="linkListChoice" xpath=".">
                  <input alias="@_cs" expr="[.]"/>
                  <input xpath="[.]"/>
                  <input xpath="@namespace"/>
                  <input xpath="@name"/>
                  <orderBy>
                    <node expr="@label"/>
                  </orderBy>
                </input>
              </form>
            </input>
          </container>
        </container>
        <static colspan="2" label="Comment" type="separator"/>
        <input colspan="2" nolabel="true" xpath="comment"/>
        <input expr="mappingSchemaExt(@schema)" type="expr" xpath="/ignored/@dummySchema"/>
      </container>
      <container label="Mapping" name="tabMapping">
        <container name="ntbk" type="notebook">
          <container label="Address" name="tabAddr">
            <static label="Delivery address" type="separator"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@email" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@sms" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@phone" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@fax" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@agency" xpathSchema="/ignored/@dummySchema"/>
            <input choiceType="xpath" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@paper" xpathSchema="/ignored/@dummySchema"/>
            <input applicableIf="HasPackage('nms:social')" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@facebook" xpathSchema="/ignored/@dummySchema"/>
            <input applicableIf="HasPackage('nms:social')" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@twitter" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@affinityGroup" xpathSchema="/ignored/@dummySchema"/>
            <container type="visibleGroup" visibleIf="@email != ''">
              <static label="Email format" type="separator"/>
              <input label="Format" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@format" xpathSchema="/ignored/@dummySchema"/>
            </container>
            <container type="visibleGroup" visibleIf="@paper != ''">
              <static label="Direct mail parameters" type="separator"/>
              <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@countryCode" xpathSchema="/ignored/@dummySchema"/>
            </container>
          </container>
          <container label="Blacklisting">
            <static label="Blacklisting indicators" type="separator"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListEmail" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListSms" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListPhone" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListFax" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListPaper" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListAgency" xpathSchema="/ignored/@dummySchema"/>
            <input applicableIf="HasPackage('nms:mobileApp')" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListIos" xpathSchema="/ignored/@dummySchema"/>
            <input applicableIf="HasPackage('nms:mobileApp')" nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@blackListAndroid" xpathSchema="/ignored/@dummySchema"/>
          </container>
          <container label="Storage" maxLabelWidth="200" xpath="storage">
            <static label="Messages to send" type="separator"/>
            <input schema="xtk:schema" type="schemaEdit" xpath="@broadLogSchema"/>
            <static label="Messages excluded" type="separator"/>
            <input checkedValue="0" label="Store exclusions and messages in the same table" type="radioButton" xpath="@exclusionType"/>
            <input checkedValue="1" label="Store messages only" type="radioButton" xpath="@exclusionType"/>
            <input checkedValue="2" label="Store exclusions and messages in separate tables" type="radioButton" xpath="@exclusionType"/>
            <container type="visibleGroup" visibleIf="@exclusionType==2">
              <input schema="xtk:schema" type="schemaEdit" xpath="@broadLogExclSchema"/>
            </container>
            <static label="Tracking logs" type="separator"/>
            <input schema="xtk:schema" type="schemaEdit" xpath="@trackingLogSchema"/>
            <input createMode="none" xpath="../defaultOrigin">
              <sysFilter>
                <condition expr="@nature='unknownSource'"/>
                <condition expr="[@mapping-id]=$(../@id)"/>
              </sysFilter>
            </input>
            <static label="Default source delivery for web tracking if no other source can be found." type="help"/>
            <static label="Additional fields" type="separator"/>
            <input label=" " type="list" xpath="extraField">
              <input hideMappedAsXml="false" type="pathedit" useUnboundPath="false" xpath="@srcExpr" xpathSchema="/ignored/@dummySchema"/>
              <input type="pathedit" xpath="@dstXPath" xpathSchema="../@broadLogSchema"/>
            </input>
            <static type="help">Specify here a list of supplemental fields to store associated with the delivery logs. These fields can permanently store information on individual members of the target (eg: [recipient/@firstName]) or additional data from the targeting process (eg: [targetData/@offerCode]).</static>
          </container>
          <container applicableIf="HasPackage('nms:social')" label="Social networks" xpath="social">
            <static type="help">The following fields enable you to store data from profiles acquired via social networks.</static>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@email" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@firstName" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@lastName" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@birthDate" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@gender" xpathSchema="/ignored/@dummySchema"/>
            <input nolabel="false" type="pathEdit" useUnboundPath="false" xpath="@locale" xpathSchema="/ignored/@dummySchema"/>
            <static label="Link from the visitor schema" type="separator"/>
            <input hideMappedAsXml="true" nolabel="false" schema="nms:visitor" showLinks="false" type="pathEdit" useLink11Path="true" useUnboundPath="false" xpath="@pathFromVisitorSchema"/>
          </container>
        </container>
      </container>
      <leave>
        <set expr="Iif(EV([storage/@exclusionType], 'other'), [storage/@broadLogExclSchema], '')" xpath="storage/@broadLogExclSchema"/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:deliveryMapping" entitySchema="xtk:form" img="nms:deliveryTarget.png" label="New target mapping" maxLabelWidth="50" md5="357D610CDA29C2A54D627D63408E1C9E" name="newDlvMapping" namespace="nms" type="wizard" xtkschema="xtk:form">
      <enter>
        <set expr="mappingSchemaExt(@schema)" xpath="/ignored/@dummySchema"/>
        <set value="0" xpath="/ignored/@longLinkToMapping"/>
      </enter>
      <container desc="Enter the label of the targeting dimension and specify the schema linked to the targeted population." title="Select targeting dimension">
        <container ref="nms:deliveryMapping:tabGene"/>
        <leave>
          <set value="nms:deliveryMapping" xpath="/ignored/queryDef/@schema"/>
          <set value="getIfExists" xpath="/ignored/queryDef/@operation"/>
          <set value="@id" xpath="/ignored/queryDef/select/node[1]/@expr"/>
          <set value="@email" xpath="/ignored/queryDef/select/node[2]/@expr"/>
          <set value="@sms" xpath="/ignored/queryDef/select/node[3]/@expr"/>
          <set value="@phone" xpath="/ignored/queryDef/select/node[4]/@expr"/>
          <set value="@fax" xpath="/ignored/queryDef/select/node[5]/@expr"/>
          <set value="@blackListEmail" xpath="/ignored/queryDef/select/node[6]/@expr"/>
          <set value="@blackListSms" xpath="/ignored/queryDef/select/node[7]/@expr"/>
          <set value="@blackListPhone" xpath="/ignored/queryDef/select/node[8]/@expr"/>
          <set value="@blackListFax" xpath="/ignored/queryDef/select/node[9]/@expr"/>
          <set value="@blackListPaper" xpath="/ignored/queryDef/select/node[10]/@expr"/>
          <set value="@blackListAgency" xpath="/ignored/queryDef/select/node[11]/@expr"/>
          <set value="[storage/@broadLogSchema]" xpath="/ignored/queryDef/select/node[12]/@expr"/>
          <set value="[storage/@exclusionType]" xpath="/ignored/queryDef/select/node[13]/@expr"/>
          <set value="[storage/@broadLogExclSchema]" xpath="/ignored/queryDef/select/node[14]/@expr"/>
          <set value="[storage/@trackingLogSchema]" xpath="/ignored/queryDef/select/node[15]/@expr"/>
          <set expr="'@schema=\''+ GetLinkSchema(@schema, @recipientLink) + '\' AND @recipientLink=\'\''" xpath="/ignored/queryDef/where/condition/@expr"/>
          <soapCall name="ExecuteQuery" service="xtk:queryDef">
            <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
            <param type="DOMDocument" xpathOut="/tmp/mainMapping"/>
          </soapCall>
          <if expr="[/tmp/mainMapping/@id]!=0">
            <set expr="Iif( substring(Lower([/tmp/mainMapping/@email]), 0, 6) = 'lower(', 'lower(' + ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath(substring([/tmp/mainMapping/@email], 6, strlen([/tmp/mainMapping/@email])-7)))) + ')', '')" xpath="@email"/>
            <set expr="ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@sms])))" xpath="@sms"/>
            <set expr="ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@phone])))" xpath="@phone"/>
            <set expr="ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@fax])))" xpath="@fax"/>
            <set expr="Iif(IndexOf([/tmp/mainMapping/@blackListEmail], '(')>=0, '', ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@blackListEmail]))))" xpath="@blackListEmail"/>
            <set expr="Iif(IndexOf([/tmp/mainMapping/@blackListSms], '(')>=0, '', ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@blackListSms]))))" xpath="@blackListSms"/>
            <set expr="Iif(IndexOf([/tmp/mainMapping/@blackListPhone], '(')>=0, '', ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@blackListPhone]))))" xpath="@blackListPhone"/>
            <set expr="Iif(IndexOf([/tmp/mainMapping/@blackListFax], '(')>=0, '', ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@blackListFax]))))" xpath="@blackListFax"/>
            <set expr="Iif(IndexOf([/tmp/mainMapping/@blackListPaper], '(')>=0, '', ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@blackListPaper]))))" xpath="@blackListPaper"/>
            <set expr="Iif(IndexOf([/tmp/mainMapping/@blackListAgency], '(')>=0, '', ExpandXPath(ConcatXPath(UnExpandXPath(@recipientLink), UnExpandXPath([/tmp/mainMapping/@blackListAgency]))))" xpath="@blackListAgency"/>
            <set expr="[/tmp/mainMapping/storage/@broadLogSchema]" xpath="storage/@broadLogSchema"/>
            <set expr="Iif([/tmp/mainMapping/storage/@exclusionType]!='', [/tmp/mainMapping/storage/@exclusionType],2)" xpath="storage/@exclusionType"/>
            <set expr="[/tmp/mainMapping/storage/@broadLogExclSchema]" xpath="storage/@broadLogExclSchema"/>
            <set expr="[/tmp/mainMapping/storage/@trackingLogSchema]" xpath="storage/@trackingLogSchema"/>
          </if>
          <if expr="[/tmp/mainMapping/@id]=0 or [/tmp/mainMapping/@id]=''">
            <set expr="DefaultNameSpace()" xpath="/tmp/targetPackage/@schemaNamespace"/>
            <set translatedExpr="'IP identifier'" xpath="/tmp/targetPackage/@publicIdLabel"/>
            <set translatedExpr="'Segment Code'" xpath="/tmp/targetPackage/@segmentCodeLabel"/>
            <if expr="FieldExists(GetLinkSchema(@schema, @recipientLink), 'broadLog')">
              <set expr="GetLinkSchema(GetLinkSchema(@schema, @recipientLink), 'broadLog')" xpath="storage/@broadLogSchema"/>
            </if>
            <if expr="FieldExists(GetLinkSchema(@schema, @recipientLink), 'excludeLog')">
              <set value="2" xpath="storage/@exclusionType"/>
              <set expr="GetLinkSchema(GetLinkSchema(@schema, @recipientLink), 'excludeLog')" xpath="storage/@broadLogExclSchema"/>
            </if>
            <if expr="FieldExists(GetLinkSchema(@schema, @recipientLink), 'excludeLog')=false">
              <set value="0" xpath="storage/@exclusionType"/>
            </if>
            <if expr="FieldExists(GetLinkSchema(@schema, @recipientLink), 'trackingLog')">
              <set expr="GetLinkSchema(GetLinkSchema(@schema, @recipientLink), 'trackingLog')" xpath="storage/@trackingLogSchema"/>
            </if>
          </if>
        </leave>
      </container>
      <container desc="For each item of information, specify the linked field in the new targeting dimension." title="Edit address forms">
        <container ref="nms:deliveryMapping:tabMapping/ntbk/tabAddr"/>
        <container type="visibleGroup" visibleIf="FieldExists(GetLinkSchema(@schema, @recipientLink), 'broadLog')">
          <static type="help">The 'broadLog' link for storing deliveries already exists, you do not need to create a new storage schema.</static>
        </container>
      </container>
      <container desc="Choose a suffix for all schemas linked to the new targeting dimension, then enter labels for the various schemas." name="storage" title="Storage" visibleIf="([/tmp/mainMapping/@id]=0 or [/tmp/mainMapping/@id]='') and FieldExists(GetLinkSchema(@schema, @recipientLink), 'broadLog')==false">
        <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="@schema"/>
        <input label="Namespace" required="true" xpath="/tmp/targetPackage/@schemaNamespace"/>
        <input label="Suffix of the extension schemas" required="true" xpath="/tmp/targetPackage/@schemaSuffix"/>
        <container type="visibleGroup" visibleIf="SchemaExists([/tmp/targetPackage/@schemaNamespace]+':broadLog' + [/tmp/targetPackage/@schemaSuffix])=true OR SchemaExists([/tmp/targetPackage/@schemaNamespace]+':trackingLog' + [/tmp/targetPackage/@schemaSuffix])=true OR SchemaExists([/tmp/targetPackage/@schemaNamespace]+':excludeLog' + [/tmp/targetPackage/@schemaSuffix])=true">
          <static type="warning">This suffix already exists: data schemas with the same suffix will be overwritten.</static>
        </container>
        <static label="Delivery logs" type="separator"/>
        <input img="xtk:parameters.png" label="Define new additional fields..." nolabel="false" type="subFormLink">
          <form label="Extension of the delivery logs schema">
            <input label="Use a 'Segment code' field" type="checkBox" xpath="/tmp/targetPackage/broadLogSchema/@useCodeSegment"/>
            <input label="Store the identifier of the delivery IP address" type="checkBox" xpath="/tmp/targetPackage/broadLogSchema/@usePublicId"/>
            <input nolabel="true" toolbarCaption="List of fields to add" type="list" xpath="/tmp/targetPackage/broadLogSchema/element/attribute">
              <input label="Label" xpath="@label"/>
              <input label="Name" xpath="@name"/>
              <input enum="xtk:srcSchema:fieldType" label="Type" type="sysenum" xpath="@type"/>
              <input label="Size" type="number" xpath="@length"/>
            </input>
          </form>
        </input>
        <static label="Exclusions" type="separator"/>
        <input checkedValue="0" label="Store exclusions and messages in the same table" type="radioButton" xpath="storage/@exclusionType"/>
        <input checkedValue="1" label="Store messages only" type="radioButton" xpath="storage/@exclusionType"/>
        <input checkedValue="2" label="Store exclusions and messages in separate tables" type="radioButton" xpath="storage/@exclusionType"/>
        <container type="visibleGroup" visibleIf="[storage/@exclusionType]=2">
          <input label="Use the same additional columns as delivery logs" type="checkbox" xpath="/tmp/targetPackage/@excludeExtension"/>
        </container>
        <static label="Tracking" type="separator"/>
        <input label="Generate a storage schema for tracking" type="checkBox" xpath="/tmp/targetPackage/@tracking"/>
        <container type="visibleGroup" visibleIf="[/tmp/targetPackage/@tracking]=true">
          <input label="Store the IP address in the tracking logs" type="checkBox" xpath="/tmp/targetPackage/trackingLogSchema/@useDeviceIp"/>
        </container>
        <leave>
          <check expr="[/tmp/targetPackage/@schemaNamespace]!=''">
            <error>Please define the namespace to be used for schema generation.</error>
          </check>
          <check expr="[/tmp/targetPackage/@schemaNamespace]!='nms' AND [/tmp/targetPackage/@schemaNamespace]!='nl' AND [/tmp/targetPackage/@schemaNamespace]!='ncm' AND [/tmp/targetPackage/@schemaNamespace]!='crm' AND [/tmp/targetPackage/@schemaNamespace]!='xtk'">
            <error>Please define a namespace that does not conflict with the out-of-the-box namespaces (nms, nl, crm, ncm, xtk).</error>
          </check>
        </leave>
      </container>
      <container desc="Choose the extensions to be taken into account." name="extension" title="Extensions" visibleIf="([/tmp/mainMapping/@id]=0 or [/tmp/mainMapping/@id]='') and FieldExists(GetLinkSchema(@schema, @recipientLink), 'broadLog')==false">
        <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="@schema"/>
        <input label="Suffix of the extension schemas" readOnly="true" xpath="/tmp/targetPackage/@schemaSuffix"/>
        <container applicableIf="HasPackage('nms:coreInteraction')" name="coreInteraction">
          <static label="Offer engine" type="separator"/>
          <input label="Generate a storage schema for propositions" type="checkBox" xpath="/tmp/targetPackage/@offer"/>
          <container type="visibleGroup" visibleIf="[/tmp/targetPackage/@offer]=true">
            <input img="xtk:parameters.png" label="Specify additional fields..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
              <form label="Extension of the propositions schema">
                <enter>
                  <if expr="[/tmp/targetPackage/propositionSchema/element/@name]=='' AND [/tmp/targetPackage/@schemaExtNamespace]!='' AND SchemaExists([/tmp/targetPackage/@schemaNamespace]+':proposition'+[/tmp/targetPackage/@schemaSuffix])">
                    <set value="xtk:srcSchema" xpath="/tmp/schemaQueryDef/@schema"/>
                    <set value="getIfExists" xpath="/tmp/schemaQueryDef/@operation"/>
                    <set value="data" xpath="/tmp/schemaQueryDef/select/node/@expr"/>
                    <set value="true" xpath="/tmp/schemaQueryDef/select/node/@anyType"/>
                    <set expr="'@name=\'proposition' + [/tmp/targetPackage/@schemaSuffix] + '\' and @namespace=\'' + [/tmp/targetPackage/@schemaExtNamespace] + '\''" xpath="/tmp/schemaQueryDef/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/tmp/schemaQueryDef]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/tmp/targetPackage/propositionSchema"/>
                    </soapCall>
                  </if>
                </enter>
                <input nolabel="true" toolbarCaption="List of fields to add" type="list" xpath="/tmp/targetPackage/propositionSchema/element/attribute">
                  <input label="Label" xpath="@label"/>
                  <input label="Name" xpath="@name"/>
                  <input enum="xtk:srcSchema:fieldType" label="Type" type="sysenum" xpath="@type"/>
                  <input label="Size" type="number" xpath="@length"/>
                </input>
                <leave>
                  <set value="true" xpath="/tmp/targetPackage/propositionSchema/@_defined"/>
                </leave>
              </form>
            </input>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:mobileApp')" name="mobileApp">
          <static label="Mobile applications" type="separator"/>
          <input label="Use mobile applications" type="checkbox" xpath="/tmp/targetPackage/@mobileApp"/>
          <container type="visibleGroup" visibleIf="[/tmp/targetPackage/@mobileApp]">
            <input img="xtk:parameters.png" label="Specify additional fields..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
              <form label="Extension of the mobile application subscription schema">
                <enter>
                  <if expr="[/tmp/targetPackage/appSubscriptionSchema/element/@name]=='' AND [/tmp/targetPackage/@schemaExtNamespace]!='' AND SchemaExists([/tmp/targetPackage/@schemaNamespace]+':appSubscription'+[/tmp/targetPackage/@schemaSuffix])">
                    <set value="xtk:srcSchema" xpath="/tmp/schemaQueryDef/@schema"/>
                    <set value="getIfExists" xpath="/tmp/schemaQueryDef/@operation"/>
                    <set value="data" xpath="/tmp/schemaQueryDef/select/node/@expr"/>
                    <set value="true" xpath="/tmp/schemaQueryDef/select/node/@anyType"/>
                    <set expr="'@name=\'appSubscription' + [/tmp/targetPackage/@schemaSuffix] + '\' and @namespace=\'' + [/tmp/targetPackage/@schemaExtNamespace] + '\''" xpath="/tmp/schemaQueryDef/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/tmp/schemaQueryDef]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/tmp/targetPackage/appSubscriptionSchema"/>
                    </soapCall>
                  </if>
                </enter>
                <input nolabel="true" toolbarCaption="List of fields to add" type="list" xpath="/tmp/targetPackage/appSubscriptionSchema/element/attribute">
                  <input label="Label" xpath="@label"/>
                  <input label="Name" xpath="@name"/>
                  <input enum="xtk:srcSchema:fieldType" label="Type" type="sysenum" xpath="@type"/>
                  <input label="Size" type="number" xpath="@length"/>
                </input>
                <leave>
                  <set value="true" xpath="/tmp/targetPackage/appSubscriptionSchema/@_defined"/>
                </leave>
              </form>
            </input>
            <input label="Schema of existing subscriber applications" type="schemaEdit" xpath="/tmp/targetPackage/@appSubSchema"/>
            <static type="help">If you leave the subscriber application schema empty, a storage schema will be generated for you based on the recipient template.</static>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:response')" name="response">
          <static label="Reaction management" type="separator"/>
          <input label="Generate a storage schema for reactions" type="checkBox" xpath="/tmp/targetPackage/@reaction"/>
          <container type="visibleGroup" visibleIf="[/tmp/targetPackage/@reaction]=true">
            <input img="xtk:parameters.png" label="Specify additional fields..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
              <form label="Extension of the reactions schema">
                <enter>
                  <if expr="[/tmp/targetPackage/reactionSchema/element/@name]=='' AND [/tmp/targetPackage/@schemaExtNamespace]!='' AND SchemaExists([/tmp/targetPackage/@schemaNamespace]+':reaction'+[/tmp/targetPackage/@schemaSuffix])">
                    <set value="xtk:srcSchema" xpath="/tmp/schemaQueryDef/@schema"/>
                    <set value="getIfExists" xpath="/tmp/schemaQueryDef/@operation"/>
                    <set value="data" xpath="/tmp/schemaQueryDef/select/node/@expr"/>
                    <set value="true" xpath="/tmp/schemaQueryDef/select/node/@anyType"/>
                    <set expr="'@name=\'remaMatch' + [/tmp/targetPackage/@schemaSuffix] + '\' and @namespace=\'' + [/tmp/targetPackage/@schemaExtNamespace] + '\''" xpath="/tmp/schemaQueryDef/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/tmp/schemaQueryDef]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/tmp/targetPackage/reactionSchema"/>
                    </soapCall>
                  </if>
                </enter>
                <input label="Transactions schema" type="schemaEdit" xpath="/tmp/targetPackage/reactionSchema/element/element/@target"/>
                <input nolabel="true" toolbarCaption="List of fields to add" type="list" xpath="/tmp/targetPackage/reactionSchema/element/attribute">
                  <input label="Label" xpath="@label"/>
                  <input label="Name" xpath="@name"/>
                  <input enum="xtk:srcSchema:fieldType" label="Type" type="sysenum" xpath="@type"/>
                  <input label="Size" type="number" xpath="@length"/>
                </input>
                <leave>
                  <set value="true" xpath="/tmp/targetPackage/reactionSchema/@_defined"/>
                  <if expr="[/tmp/targetPackage/reactionSchema/element/element/@target]=''">
                    <reset delete="true" xpath="/tmp/targetPackage/reactionSchema/element/element"/>
                  </if>
                  <if expr="[/tmp/targetPackage/reactionSchema/element/element/@target]!=''">
                    <set value="link" xpath="/tmp/targetPackage/reactionSchema/element/element/@type"/>
                    <set expr="ExtractRight([/tmp/targetPackage/reactionSchema/element/element/@target], ':')" xpath="/tmp/targetPackage/reactionSchema/element/element/@name"/>
                  </if>
                </leave>
              </form>
            </input>
          </container>
          <input expr="Iif([/tmp/targetPackage/@reaction], 1, NodeValue('/tmp/targetPackage/@offer'))" type="expr" xpath="/tmp/targetPackage/@offer"/>
        </container>
        <container applicableIf="HasPackage('nms:survey')" name="survey">
          <static label="Online surveys" type="separator"/>
          <input label="Generate a storage schema for answers to surveys" type="checkBox" xpath="/tmp/targetPackage/@survey"/>
          <container type="visibleGroup" visibleIf="[/tmp/targetPackage/@survey]">
            <input img="xtk:parameters.png" label="Specify additional fields..." nolabel="false" prebuildSubForm="false" type="subFormLink" xpath=".">
              <form label="Extension of the survey response schema">
                <enter>
                  <if expr="[/tmp/targetPackage/webAppLogSchema/element/@name]=='' AND [/tmp/targetPackage/@schemaExtNamespace]!='' AND SchemaExists([/tmp/targetPackage/@schemaNamespace]+':webAppLog'+[/tmp/targetPackage/@schemaSuffix])">
                    <set value="xtk:srcSchema" xpath="/tmp/schemaQueryDef/@schema"/>
                    <set value="getIfExists" xpath="/tmp/schemaQueryDef/@operation"/>
                    <set value="data" xpath="/tmp/schemaQueryDef/select/node/@expr"/>
                    <set value="true" xpath="/tmp/schemaQueryDef/select/node/@anyType"/>
                    <set expr="'@name=\'webAppLog' + [/tmp/targetPackage/@schemaSuffix] + '\' and @namespace=\'' + [/tmp/targetPackage/@schemaExtNamespace] + '\''" xpath="/tmp/schemaQueryDef/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/tmp/schemaQueryDef]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/tmp/targetPackage/webAppLogSchema"/>
                    </soapCall>
                  </if>
                </enter>
                <input nolabel="true" toolbarCaption="List of fields to add" type="list" xpath="/tmp/targetPackage/webAppLogSchema/element/attribute">
                  <input label="Label" xpath="@label"/>
                  <input label="Name" xpath="@name"/>
                  <input enum="xtk:srcSchema:fieldType" label="Type" type="sysenum" xpath="@type"/>
                  <input label="Size" type="number" xpath="@length"/>
                </input>
                <leave>
                  <set value="true" xpath="/tmp/targetPackage/webAppLogSchema/@_defined"/>
                </leave>
              </form>
            </input>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:centralLocal')" name="distributed">
          <static label="Distributed marketing" type="separator"/>
          <input label="Generate a storage schema for approvals" type="checkBox" xpath="/tmp/targetPackage/@valid"/>
        </container>
      </container>
      <leave>
        <check expr="[storage/@broadLogSchema]!='' OR ([/tmp/targetPackage/@schemaNamespace]!='' AND [/tmp/targetPackage/@schemaSuffix]!='')">
          <error>Please define the name space and the suffix to be used for schema generation.</error>
        </check>
        <check expr="[/tmp/targetPackage/@schemaNamespace]!='nms' AND [/tmp/targetPackage/@schemaNamespace]!='nl' AND [/tmp/targetPackage/@schemaNamespace]!='ncm' AND [/tmp/targetPackage/@schemaNamespace]!='crm' AND [/tmp/targetPackage/@schemaNamespace]!='xtk'">
          <error>Please define a namespace that does not conflict with the out-of-the-box namespaces (nms, nl, crm, ncm, xtk).</error>
        </check>
        <if expr="[storage/@broadLogSchema]=''">
          <set expr="@id" xpath="/tmp/targetPackage/@id"/>
          <set expr="@label" xpath="/tmp/targetPackage/@label"/>
          <set expr="[storage/@exclusionType]" xpath="/tmp/targetPackage/@exclusionType"/>
          <soapCall name="CreateCustomTarget" service="nms:deliveryMapping">
            <param exprIn="@schema" type="string"/>
            <param exprIn="[/tmp/targetPackage]" type="DOMDocument"/>
          </soapCall>
        </if>
        <if expr="[/tmp/mainMaping/@id]=0 or [/tmp/mainMapping/@id]=''">
          <set expr="[/tmp/targetPackage/@schemaNamespace] + ':broadLog' + [/tmp/targetPackage/@schemaSuffix]" xpath="storage/@broadLogSchema"/>
          <if expr="[storage/@exclusionType]=2">
            <set expr="[/tmp/targetPackage/@schemaNamespace] + ':excludeLog' + [/tmp/targetPackage/@schemaSuffix]" xpath="storage/@broadLogExclSchema"/>
          </if>
          <if expr="[/tmp/targetPackage/@tracking]">
            <set expr="[/tmp/targetPackage/@schemaNamespace] + ':trackingLog' + [/tmp/targetPackage/@schemaSuffix]" xpath="storage/@trackingLogSchema"/>
            <set value="nms:delivery" xpath="/ignored/defaultOriginQueryDef/@schema"/>
            <set value="getIfExists" xpath="/ignored/defaultOriginQueryDef/@operation"/>
            <set value="@id" xpath="/ignored/defaultOriginQueryDef/select/node[1]/@expr"/>
            <set expr="'@internalName = \'globalDelivery' + [/tmp/targetPackage/@schemaSuffix] + '\''" xpath="/ignored/defaultOriginQueryDef/where/condition/@expr"/>
            <soapCall name="ExecuteQuery" service="xtk:queryDef">
              <param exprIn="[/ignored/defaultOriginQueryDef]" type="DOMDocument"/>
              <param type="DOMDocument" xpathOut="/tmp/defaultOriginQueryDef"/>
            </soapCall>
            <set expr="[/tmp/defaultOriginQueryDef/@id]" xpath="@defaultOrigin-id"/>
          </if>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:none" entitySchema="xtk:form" img="nms:deliveryTarget.png" label="Create or modify campaign analysis axes" maxLabelWidth="50" md5="BF64D8C15F5E46BAB37FC669BBB1CAC2" name="dlvAnalysis" namespace="nms" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="xtk:workflow" xpath="/tmp/queryDef/@schema"/>
        <set value="select" xpath="/tmp/queryDef/@operation"/>
        <set value="@id" xpath="/tmp/queryDef/select/node/@expr"/>
        <set value="@internalName" xpath="/tmp/queryDef/select/node[2]/@expr"/>
        <set value="@label" xpath="/tmp/queryDef/select/node[3]/@expr"/>
        <set value="activities" xpath="/tmp/queryDef/select/node[4]/@expr"/>
        <set value="true" xpath="/tmp/queryDef/select/node[4]/@anyType"/>
        <set expr="'@internalName LIKE \'%dlvAggregate%\''" xpath="/tmp/queryDef/where/condition/@expr"/>
        <soapCall name="ExecuteQuery" service="xtk:queryDef">
          <param exprIn="[/tmp/queryDef]" type="DOMDocument"/>
          <param type="DOMDocument" xpathOut="/tmp/aggrWorkflow"/>
        </soapCall>
        <set value="0" xpath="/tmp/@createNewAggregate"/>
        <set value="/tmp/aggrWorkflow/workflow" xpath="/tmp/@selectedAggr"/>
      </enter>
      <container desc="Select all the analysis axes to update, or create a new one." title="Aggregates">
        <input checkedValue="0" label="Edit an existing set of campaign analysis axes" type="radioButton" xpath="/tmp/@createNewAggregate"/>
        <input checkedValue="1" label="Create a new set of campaign analysis axes" type="radioButton" xpath="/tmp/@createNewAggregate"/>
        <container type="visibleGroup" visibleIf="[/tmp/@createNewAggregate]=0">
          <input editable="false" label=" " noToolbar="true" type="list" xpath="/tmp/aggrWorkflow/workflow" xpathSelection="/tmp/@selectedAggr">
            <input label="Name" xpath="@internalName"/>
            <input label="Label" xpath="@label"/>
          </input>
        </container>
        <leave>
          <check expr="[/tmp/@createNewAggregate]=1 OR NodeValue([/tmp/@selectedAggr] + '/@internalName')!= ''">
            <error>You must select a set of analysis axes for existing campaigns.</error>
          </check>
          <set expr="DefaultNamespace()" xpath="/tmp/workflow/@schemaNamespace"/>
          <if expr="[/tmp/@createNewAggregate]=0">
            <set expr="NodeValue([/tmp/@selectedAggr] + '/@internalName')" xpath="/tmp/workflow/@internalName"/>
            <set expr="NodeValue([/tmp/@selectedAggr] + '/activities/writer/@schema')" xpath="/tmp/workflow/@aggrSchema"/>
            <set expr="Extract(SubString(Line(NodeValue([/tmp/@selectedAggr]+ '/activities/fork/initScript'), 2), 28), '\'')" xpath="/tmp/workflow/@targetSchema"/>
            <set expr="NodeValue([/tmp/@selectedAggr] + '/activities/schedule/period')" xpath="/tmp/workflow/@planning"/>
            <set expr="Extract(ExtractRight(NodeValue([/tmp/@selectedAggr] + '/activities/query[@name=\'qryExpired\']/where/condition/@expr'), '-'), ')')" xpath="/tmp/workflow/@retention"/>
            <set expr="Iif([/tmp/workflow/@retention]&lt;1, 24, [/tmp/workflow/@retention])" xpath="/tmp/workflow/@retention"/>
            <set expr="SubString(Line(NodeValue([/tmp/@selectedAggr]+ '/activities/fork/initScript'), 5), 23)" xpath="/tmp/groupBy"/>
            <if expr="[/tmp/groupBy]!=''">
              <set expr="SubString([/tmp/groupBy], 0, StrLen([/tmp/groupBy])-2)" xml="true" xpath="/tmp/workflow/select"/>
            </if>
            <set expr="SubString(Line(NodeValue([/tmp/@selectedAggr]+ '/activities/fork/initScript'), 6), 32)" xpath="/tmp/filter"/>
            <set expr="Iif([/tmp/filter]='', 0, 1)" xpath="/tmp/workflow/@reaction"/>
            <if expr="[/tmp/filter]!=''">
              <set expr="SubString([/tmp/filter], 0, StrLen([/tmp/filter])-2)" xml="true" xpath="/tmp/workflow/hypothesisFilter/where"/>
            </if>
            <if expr="SchemaExists([/tmp/workflow/@targetSchema])">
              <set expr="GetLinkSchema([/tmp/workflow/@targetSchema], 'broadLog')" xpath="/tmp/workflow/@broadLogSchema"/>
            </if>
          </if>
          <if expr="[/tmp/@createNewAggregate]=1">
            <set value="24" xpath="/tmp/workflow/@retention"/>
          </if>
        </leave>
      </container>
      <container desc="Retention and refresh period." img="xtk:massUpdate32.png" title="Update">
        <container type="visibleGroup" visibleIf="[/tmp/@createNewAggregate]=1">
          <input label="Targeting dimension" type="schemaEdit" xpath="/tmp/workflow/@targetSchema">
            <enter name="onChange">
              <set expr="GetLinkSchema([/tmp/workflow/@targetSchema], 'broadLog')" xpath="/tmp/workflow/@broadLogSchema"/>
              <set expr="SubString(ExtractRight([/tmp/workflow/@broadLogSchema], ':'),8)" xpath="/tmp/workflow/@schemaSuffix"/>
            </enter>
          </input>
          <input label="Namespace" required="true" xpath="/tmp/workflow/@schemaNamespace"/>
          <input label="Suffix" required="true" xpath="/tmp/workflow/@schemaSuffix"/>
          <input expr="Iif([/tmp/@createNewAggregate]=1, [/tmp/workflow/@schemaNamespace] + 'dlvAggregate' + [/tmp/workflow/@schemaSuffix], NodeValue('/tmp/workflow/@internalName'))" type="expr" xpath="/tmp/workflow/@internalName"/>
        </container>
        <input label="Workflow name" readOnly="true" xpath="/tmp/workflow/@internalName"/>
        <container type="visibleGroup" visibleIf="[/tmp/@createNewAggregate]=0">
          <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="/tmp/workflow/@targetSchema"/>
        </container>
        <input label="Aggregate retention in months" type="number" xpath="/tmp/workflow/@retention"/>
        <input type="scheduler" xpath="/tmp/workflow/@planning"/>
      </container>
      <container desc="Additional analysis dimension." img="xtk:filter32.png" title="Data to add">
        <container hideUnboundPath="false" name="selectCtrl" type="querySelectContainer" xpath="/tmp/workflow/select">
          <container name="vpaned" type="vpaned">
            <container name="schema">
              <static fontBold="true" label="Available fields:"/>
              <container colcount="2">
                <static img="xtk:filter.png" type="image"/>
                <input catchReturnKey="true" label="Search" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
              </container>
              <input checkDuplicates="false" hideMappedAsXml="true" name="schemaView" showLinks="false" showLinks1="true" type="SchemaView" xpath="/tmp/workflow/@broadLogSchema" xpathFilter="85" xpathHelp="/tmp/selectCtrl/itn/@help" xpathIndex="/tmp/selectCtrl/itn/@current" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathSelect="/tmp/workflow/select/node/@expr"/>
            </container>
            <container name="output" xpathsToLoad="output*">
              <static fontBold="true" label="Output columns:"/>
              <input name="columnList" nolabel="true" prebuildSubForm="false" toolbarAlign="vertical" type="columnList" xpath="/tmp/workflow/select/node" xpathCurrentLookupPath="/lookupPath/select" xpathGroupOption="/tmp/selectCtrl/out/@group" xpathHasMemoData="/tmp/selectCtrl/itn/@hasMemoData" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchema="/tmp/workflow/@broadLogSchema" xpathSelection="/tmp/outputColumn/itn/@current" zoom="false">
                <input colSize="20" label="Label" xpath="@label"/>
                <input colSize="35" label="Expression" type="pathedit" useUnboundPath="true" xpath="@expr" xpathChoiceType="/tmp/selectCtrl/in/@choiceType" xpathSchema="/tmp/workflow/@broadLogSchema"/>
                <input colSize="20" label="Alias" xpath="@alias"/>
                <form label="Column definition" name="colDetail">
                  <input xpath="@label"/>
                  <container name="extraFields"/>
                  <input noTransaction="true" type="expredit" xpath="@expr" xpathSchema="/tmp/workflow/@broadLogSchema"/>
                  <container type="visibleGroup" visibleIf="[/tmp/selectCtrl/itn/@advancedMode]">
                    <container colcount="2" cols-width="100,1">
                      <container>
                        <static fontBold="true" label="Available fields:"/>
                        <container colcount="2">
                          <static img="xtk:filter.png" type="image"/>
                          <input catchReturnKey="true" label="Search" type="edit" xpath="/tmp/selectCtrl/itn/@search"/>
                        </container>
                        <input type="schemaview" xpath="/tmp/workflow/@schema" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSearchPath="/tmp/selectCtrl/itn/@search" xpathStartPath="/tmp/selectCtrl/in/@startPath"/>
                      </container>
                      <input type="functionview" xpathExpr="@expr" xpathHelp="/tmp/selectCtrl/itn/@help"/>
                    </container>
                    <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
                  </container>
                  <input label="Advanced mode" nolabel="true" type="checkbox" xpath="/tmp/selectCtrl/itn/@advancedMode"/>
                </form>
              </input>
            </container>
          </container>
          <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:response')" desc="Choose the measurement hypotheses to be taken into account in the campaign aggregates here." img="xtk:filter32.png" title="Hypothesis selection" xpath="/tmp/workflow/hypothesisFilter">
        <enter>
          <set value="nms:remaHypothesis" xpath="@schema"/>
          <set value="1" xpath="/tmp/workflow/@reaction"/>
          <if expr="[/tmp/filter]=''">
            <set value="@includeInAggregates=1" xpath="/tmp/workflow/hypothesisFilter/where/condition/@expr"/>
          </if>
        </enter>
        <container buildQueryXPath="." ref="xtk:queryDef:where"/>
      </container>
      <leave>
        <soapCall name="UpdateCustomAggregate" service="nms:deliveryMapping">
          <param exprIn="[/tmp/workflow]" type="DOMDocument"/>
        </soapCall>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:deliveryMapping" entitySchema="xtk:form" img="nms:deliveryTarget.png" label="Modify the options of the targeting dimension" maxLabelWidth="50" md5="3F9CC8733BD47523E3E5D2BB57696B1B" name="updDlvMapping" namespace="nms" type="wizard" xpathsToLoad="storage/*" xtkschema="xtk:form">
      <enter>
        <if expr="[storage/@broadLogSchema]!=''">
          <set translatedExpr="'IP identifier'" xpath="/tmp/targetPackage/@publicIdLabel"/>
          <set translatedExpr="'Segment Code'" xpath="/tmp/targetPackage/@segmentCodeLabel"/>
          <set expr="Extract([storage/@broadLogSchema], ':')" xpath="/tmp/targetPackage/@schemaNamespace"/>
          <set expr="SubString(ExtractRight([storage/@broadLogSchema], ':'), 8)" xpath="/tmp/targetPackage/@schemaSuffix"/>
          <if expr="[storage/@trackingLogSchema]!=''">
            <set expr="FieldExists([storage/@trackingLogSchema], '@id')" xpath="/tmp/targetPackage/@tracking"/>
            <if expr="[/tmp/targetPackage/@tracking]">
              <set expr="FieldExists([storage/@trackingLogSchema], '@deviceIpAddress')" xpath="/tmp/targetPackage/trackingLogSchema/@useDeviceIp"/>
            </if>
          </if>
          <set expr="FieldExists(@schema, 'proposition') AND FieldExists([/tmp/targetPackage/@schemaNamespace]+':proposition'+[/tmp/targetPackage/@schemaSuffix], '@id')" xpath="/tmp/targetPackage/@offer"/>
          <set expr="FieldExists(@schema, 'appSubscription') AND FieldExists([/tmp/targetPackage/@schemaNamespace]+':broadLogAppSub'+[/tmp/targetPackage/@schemaSuffix], '@id')" xpath="/tmp/targetPackage/@mobileApp"/>
          <set expr="Iif(FieldExists(@schema, 'appSubscription'), GetLinkSchema(@schema, 'appSubscription'), '')" xpath="/tmp/targetPackage/@appSubSchema"/>
          <set expr="FieldExists([storage/@broadLogSchema], 'remaMatch'+[/tmp/targetPackage/@schemaSuffix]+'-broadLog')" xpath="/tmp/targetPackage/@reaction"/>
          <set expr="FieldExists('nms:delivery', 'webAppLog'+[/tmp/targetPackage/@schemaSuffix])" xpath="/tmp/targetPackage/@survey"/>
          <set expr="FieldExists(@schema, 'localValidation'+[/tmp/targetPackage/@schemaSuffix])" xpath="/tmp/targetPackage/@valid"/>
          <set expr="FieldExists('nms:delivery', 'dlvAggregate'+[/tmp/targetPackage/@schemaSuffix])" xpath="/tmp/targetPackage/@campaignAggregate"/>
          <if expr="[/tmp/targetPackage/@campaignAggregate]">
            <set value="xtk:workflow" xpath="/tmp/queryDef/@schema"/>
            <set value="getIfExists" xpath="/tmp/queryDef/@operation"/>
            <set value="activities" xpath="/tmp/queryDef/select/node/@expr"/>
            <set value="true" xpath="/tmp/queryDef/select/node/@anyType"/>
            <set expr="'@internalName=\''+ Extract([storage/@broadLogSchema], ':') + 'dlvAggregate' + [/tmp/targetPackage/@schemaSuffix] + '\''" xpath="/tmp/queryDef/where/condition/@expr"/>
            <soapCall name="ExecuteQuery" service="xtk:queryDef">
              <param exprIn="[/tmp/queryDef]" type="DOMDocument"/>
              <param type="DOMDocument" xpathOut="/tmp/aggrWorkflow"/>
            </soapCall>
            <set expr="[/tmp/aggrWorkflow/activities/schedule/period]" xpath="/tmp/targetPackage/@planning"/>
            <set expr="Extract(ExtractRight(NodeValue('/tmp/aggrWorkflow/activities/query[@name=\'qryExpired\']/where/condition/@expr'), '-'), ')')" xpath="/tmp/targetPackage/@retention"/>
            <set expr="Line([/tmp/aggrWorkflow/activities/fork/initScript], 5)" xpath="/tmp/targetPackage/groupBy"/>
            <set expr="Line([/tmp/aggrWorkflow/activities/fork/initScript],6)" xpath="/tmp/targetPackage/hypothesisFilter/where"/>
          </if>
        </if>
        <set expr="Iif([/tmp/targetPackage/@schemaNamespace]!='nms' AND [/tmp/targetPackage/@schemaNamespace]!='nl' AND [/tmp/targetPackage/@schemaNamespace]!='ncm' AND [/tmp/targetPackage/@schemaNamespace]!='crm' AND [/tmp/targetPackage/@schemaNamespace]!='xtk' , [/tmp/targetPackage/@schemaNamespace], DefaultNameSpace())" xpath="/tmp/targetPackage/@schemaExtNamespace"/>
        <copyElement xpathDst="/tmp/oldTargetPackage" xpathSrc="/tmp/targetPackage"/>
        <reset xpath="/tmp/targetPackage/groupBy"/>
        <reset xpath="/tmp/targetPackage/hypothesisFilter"/>
      </enter>
      <container desc="Select a suffix for all schemas linked to the new targeting dimension, then add labels for the various schemas." title="Storage">
        <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="@schema"/>
        <input label="Namespace" readOnly="true" xpath="/tmp/targetPackage/@schemaNamespace"/>
        <container type="visibleGroup" visibleIf="[/tmp/targetPackage/@schemaNamespace]='nl' OR [/tmp/targetPackage/@schemaNamespace]='nms' OR [/tmp/targetPackage/@schemaNamespace]='ncm' OR [/tmp/targetPackage/@schemaNamespace]='crm' OR [/tmp/targetPackage/@schemaNamespace]='xtk'">
          <input label="Extension namespace" required="true" xpath="/tmp/targetPackage/@schemaExtNamespace"/>
        </container>
        <input label="Suffix of the extension schemas" readOnly="true" required="true" xpath="/tmp/targetPackage/@schemaSuffix"/>
        <static label="Delivery logs" type="separator"/>
        <static label=" " nolabel="false" type="help">If necessary, you can add additional storage columns for targeting data.</static>
        <input img="xtk:parameters.png" label="Define new additional fields..." nolabel="false" type="subFormLink">
          <form label="Extension of the delivery logs schema">
            <enter>
              <if expr="[/tmp/targetPackage/broadLogSchema/@useCodeSegment]==''">
                <set value="xtk:srcSchema" xpath="/tmp/schemaQueryDef/@schema"/>
                <set value="getIfExists" xpath="/tmp/schemaQueryDef/@operation"/>
                <set value="data" xpath="/tmp/schemaQueryDef/select/node/@expr"/>
                <set value="true" xpath="/tmp/schemaQueryDef/select/node/@anyType"/>
                <set expr="'@name=\'broadLog' + [/tmp/targetPackage/@schemaSuffix] + '\' and @namespace=\'' + Iif([/tmp/targetPackage/@schemaExtNamespace]=='', [/tmp/targetPackage/@schemaNamespace],[/tmp/targetPackage/@schemaExtNamespace])+ '\''" xpath="/tmp/schemaQueryDef/where/condition/@expr"/>
                <soapCall name="ExecuteQuery" service="xtk:queryDef">
                  <param exprIn="[/tmp/schemaQueryDef]" type="DOMDocument"/>
                  <param type="DOMDocument" xpathOut="/tmp/targetPackage/broadLogSchema"/>
                </soapCall>
                <set expr="Iif(NodeValue('/tmp/targetPackage/broadLogSchema/element/attribute[@name=\'segmentCode\']/@name')!='', 1, 0)" xpath="/tmp/targetPackage/broadLogSchema/@useCodeSegment"/>
                <set expr="Iif(NodeValue('/tmp/targetPackage/broadLogSchema/element/attribute[@name=\'publicId\']/@name')!='', 1, 0)" xpath="/tmp/targetPackage/broadLogSchema/@usePublicId"/>
                <if expr="NodeValue('/tmp/targetPackage/broadLogSchema/element/attribute[@name=\'publicId\']/@name')!=''">
                  <reset delete="true" xpath="/tmp/targetPackage/broadLogSchema/element/attribute[@name='publicId']"/>
                </if>
                <if expr="NodeValue('/tmp/targetPackage/broadLogSchema/element/attribute[@name=\'segmentCode\']/@name')!=''">
                  <reset delete="true" xpath="/tmp/targetPackage/broadLogSchema/element/attribute[@name='segmentCode']"/>
                </if>
              </if>
              <set value="true" xpath="/tmp/targetPackage/broadLogSchema/@_defined"/>
            </enter>
            <input label="Use a 'Segment code' field" type="checkBox" xpath="/tmp/targetPackage/broadLogSchema/@useCodeSegment"/>
            <input label="Store the identifier of the delivery IP address" type="checkBox" xpath="/tmp/targetPackage/broadLogSchema/@usePublicId"/>
            <input nolabel="true" toolbarCaption="List of fields to add" type="list" xpath="/tmp/targetPackage/broadLogSchema/element/attribute">
              <input label="Label" xpath="@label"/>
              <input label="Name" xpath="@name"/>
              <input enum="xtk:srcSchema:fieldType" label="Type" type="sysenum" xpath="@type"/>
              <input label="Size" type="number" xpath="@length"/>
            </input>
          </form>
        </input>
        <static label="Exclusions" type="separator"/>
        <input checkedValue="0" label="Store exclusions and messages in the same table" type="radioButton" xpath="storage/@exclusionType"/>
        <input checkedValue="1" label="Store messages only" type="radioButton" xpath="storage/@exclusionType"/>
        <input checkedValue="2" label="Store exclusions and messages in separate tables" type="radioButton" xpath="storage/@exclusionType"/>
        <container type="visibleGroup" visibleIf="[storage/@exclusionType]=2">
          <input label="Use the same additional columns as delivery logs" nolabel="false" type="checkbox" xpath="/tmp/targetPackage/@excludeExtension"/>
        </container>
        <static label="Tracking" type="separator"/>
        <input label="Generate a storage schema for tracking" type="checkBox" xpath="/tmp/targetPackage/@tracking"/>
        <container type="visibleGroup" visibleIf="[/tmp/targetPackage/@tracking]=true">
          <input label="Store the IP address in the tracking logs" type="checkBox" xpath="/tmp/targetPackage/trackingLogSchema/@useDeviceIp"/>
        </container>
        <leave>
          <check expr="[/tmp/targetPackage/@schemaNamespace]!=''">
            <error>Please define the namespace to be used for schema generation.</error>
          </check>
          <check expr="([/tmp/targetPackage/@schemaNamespace]!='nms' AND [/tmp/targetPackage/@schemaNamespace]!='nl' AND [/tmp/targetPackage/@schemaNamespace]!='ncm' AND [/tmp/targetPackage/@schemaNamespace]!='crm' AND [/tmp/targetPackage/@schemaNamespace]!='xtk') OR [/tmp/targetPackage/@schemaExtNamespace]!=''">
            <error>Please define a namespace that does not conflict with the out-of-the-box namespaces (nms, nl, crm, ncm, xtk).</error>
          </check>
        </leave>
      </container>
      <container desc="Select the extensions to take into account." title="Extensions">
        <input label="Targeting dimension" readOnly="true" type="schemaEdit" xpath="@schema"/>
        <input label="Suffix of the extension schemas" readOnly="true" xpath="/tmp/targetPackage/@schemaSuffix"/>
        <container applicableIf="HasPackage('nms:coreInteraction')" ref="nms:newDlvMapping:extension/coreInteraction"/>
        <container applicableIf="HasPackage('nms:mobileApp')" ref="nms:newDlvMapping:extension/mobileApp"/>
        <container applicableIf="HasPackage('nms:response')" ref="nms:newDlvMapping:extension/response"/>
        <container applicableIf="HasPackage('nms:survey')" ref="nms:newDlvMapping:extension/survey"/>
        <container applicableIf="HasPackage('nms:centralLocal')" ref="nms:newDlvMapping:extension/distributed"/>
      </container>
      <leave>
        <if expr="[storage/@broadLogSchema]!=''">
          <set expr="@id" xpath="/tmp/targetPackage/@id"/>
          <set expr="@schema" xpath="/tmp/targetPackage/@schema"/>
          <set expr="@label" xpath="/tmp/targetPackage/@label"/>
          <set expr="[storage/@exclusionType]" xpath="/tmp/targetPackage/@exclusionType"/>
          <soapCall name="UpdateCustomTarget" service="nms:deliveryMapping">
            <param exprIn="[/tmp/oldTargetPackage]" type="DOMDocument"/>
            <param exprIn="[/tmp/targetPackage]" type="DOMDocument"/>
          </soapCall>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Attachment definition" md5="38C7E1C5B5A66D3E1826F346C372FA00" name="attachment" namespace="nms" type="notebook" xpathsToLoad="*" xtkschema="xtk:form">
      <enter>
        <set expr="name" xpath="/tmp/attachment/former/name"/>
        <set expr="@md5" xpath="/tmp/attachment/former/@md5"/>
        <set expr="@type" xpath="/tmp/attachment/former/@type"/>
        <set expr="@upload" xpath="/tmp/attachment/former/@upload"/>
        <set expr="FileUploaded(name, @md5)" xpath="/ignored/file/@uploadStatus"/>
        <set expr="[/delivery/deliveryProvider/@deliveryMode] = 4" xpath="/ignored/resource/@notInResTable"/>
      </enter>
      <container label="General">
        <input expr="@type" type="expr" xpath="/tmp/dummy">
          <enter>
            <if expr="@id=0 and @type='pdf'">
              <checkModified/>
            </if>
          </enter>
        </input>
        <input useDesc="true" xpath="@type"/>
        <container colcount="2" type="visibleGroup" visibleIf="EV(@type, 'pdf')">
          <container colspan="2" type="visibleGroup" visibleIf="@upload">
            <input filters="OpenOffice or Word documents (*.odt;*.doc)|*.odt;*.doc|All Files (*.*)|*.*|" label="Local file" type="fileEdit" xpath="name" xpathCopyName="@label" xpathCopySize="@size"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@upload == false">
            <input label="Server file" xpath="name"/>
          </container>
          <input xpath="@label"/>
          <input xpath="@compressMode"/>
          <container ref="xtk:importSource:sourceInfos/autoDetect/file/upload" xpath="."/>
          <container colspan="2" enabledIf="@md5 != '' or ( @upload == false and name != '' )" type="enabledGroup">
            <container name="tabPreview">
              <static label="Preview" type="separator"/>
              <input name="previewToolbar" type="toolbarCtrl"/>
              <static type="separator"/>
              <container ref="nms:delivery:lib/content/Preview/body" xpath="."/>
            </container>
          </container>
        </container>
        <container colcount="2" type="visibleGroup" visibleIf="EV(@type, 'pdf') == false">
          <input colspan="2" xpath="@label"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'normal')">
            <container colspan="2" type="visibleGroup" visibleIf="@upload">
              <input label="Local file" type="fileEdit" xpath="name" xpathCopyName="@label" xpathCopySize="@size"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="![@upload]">
              <input label="Server file" xpath="name"/>
            </container>
            <container ref="xtk:importSource:sourceInfos/autoDetect/file/upload" xpath="."/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV(@type, 'preparation')">
            <input jst="false" nolabel="true" type="jstEdit" xpath="name"/>
            <static type="help">File name is computed during delivery analysis and is the same for each recipient.</static>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="EV(@type, 'sending')">
            <input jst="false" nolabel="true" type="jstEdit" xpath="name" xpathInsert="/ignored/customizeAdvName">
              <container>
                <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeAdvName"/>
              </container>
            </input>
            <static type="help">File name can be different for each recipient; it is computed during delivery of each message.</static>
          </container>
        </container>
      </container>
      <container label="Advanced">
        <container ref="nms:delivery:menuBuilder"/>
        <input nolabel="true" useDesc="true" xpath="@filterActive"/>
        <container type="visibleGroup" visibleIf="@filterActive">
          <input jst="false" nolabel="true" type="jstEdit" xpath="filterScript" xpathInsert="/ignored/customizeAdvFilter">
            <container>
              <input menuId="deliveryMenuBuilder" options="notJst" type="customizeBtn" xpath="/ignored/customizeAdvFilter"/>
            </container>
          </input>
          <static type="help">The recipient receives the attachment if the script returns 'true'.</static>
        </container>
        <input nolabel="true" useDesc="true" xpath="@nameScriptActive"/>
        <container type="visibleGroup" visibleIf="@nameScriptActive">
          <input nolabel="true" type="jstEdit" xpath="nameScript" xpathInsert="/ignored/customizeAdvName">
            <container>
              <input menuId="deliveryMenuBuilder" type="customizeBtn" xpath="/ignored/customizeAdvName"/>
            </container>
          </input>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" md5="FF3125C601A2794028D22B65C95274B8" name="domain" namespace="nms" xtkschema="xtk:form">
      <input xpath="@domain"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:delivery" entitySchema="xtk:form" img="xtk:import32.png" label="Download files of the delivery" md5="375F3C234A4590EF364084B63530F475" name="downloadDeliveryFiles" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <soapCall name="GetFilesToDownload" service="nms:delivery">
          <param exprIn="[/delivery/@id]" type="int"/>
          <param type="DOMDocument" xpathOut="properties/filesToDownload"/>
          <param type="DOMDocument" xpathOut="properties/filesNotToDownload"/>
        </soapCall>
      </enter>
      <container desc="Select the files you want to download in the list below." name="fileList" title="Select files" visibleIf="[/tmp/@fromOperation]!=1">
        <static>Files which can be downloaded:</static>
        <input editable="false" noEditCollection="true" noToolbar="true" nolabel="true" type="list" xpath="properties/filesToDownload/file" zoom="false">
          <input colSize="7" editable="true" xpath="@active"/>
          <input colSize="20" xpath="@type"/>
          <input colSize="20" xpath="@label"/>
          <input colSize="30" editable="true" type="saveFileEdit" xpath="@originalName"/>
          <input colSize="30" xpath="@serverName"/>
          <input colSize="10" xpath="@size"/>
          <input colSize="20" xpath="@lastModified"/>
        </input>
        <static>Files that cannot be downloaded:</static>
        <input editable="false" img="xtk:noentry.png" noEditCollection="true" noToolbar="true" nolabel="true" type="list" xpath="properties/filesNotToDownload/fileImpossible" zoom="false">
          <input colSize="25" xpath="@type"/>
          <input colSize="20" xpath="@desc"/>
          <input colSize="30" xpath="@serverName"/>
          <input colSize="50" xpath="@reason"/>
        </input>
      </container>
      <container desc="Click on 'Start' to launch the file download." name="finish" title="Downloading files">
        <enter>
          <set expr="[/tmp/@fromOperation]!=1 or count([properties/filesToDownload/file]) > 0" xpath="/ignored/@showFileTransfer"/>
        </enter>
        <container type="visibleGroup" visibleIf="[/tmp/@fromOperation]=1">
          <container label="File" type="frame">
            <container type="visibleGroup" visibleIf="[/ignored/@showFileTransfer]=false">
              <static label="The extraction file cannot be accessed." type="warning"/>
            </container>
            <container type="visibleGroup" visibleIf="[/ignored/@showFileTransfer]">
              <input type="saveFileEdit" xpath="properties/filesToDownload/file[1]/@originalName"/>
              <static label="Please specify the local location of the file to recover and then click 'Download'." type="help"/>
            </container>
          </container>
        </container>
        <container type="visibleGroup" visibleIf="[/ignored/@showFileTransfer]">
          <container hideDownloadFileEdit="true" showHelp="false" showServerName="false" transferType="download" type="fileResTransfer" xpath="properties/filesToDownload/file" xpathElement="file[@active='true']"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="External account" maxLabelWidth="200" md5="202E3C0A6FCA10DDF877319A6FBD6F15" name="extAccount" namespace="nms" type="iconbox" xpathsToLoadOpt="@executionInstanceType,@isMessageCenter,@isInteraction,@executionInstanceId,@mcHistoMethod,params/oauthParams/*,params/iosParams/*,params/androidParams/*" xtkschema="xtk:form">
      <enter>
        <set expr="GetOption('WdbcOptions_TableSpaceWork_nms:extAccount:' + @name, false)" xpath="/tmp/@tblSpace"/>
        <set expr="GetOption('WdbcOptions_TableSpaceWorkIndex_nms:extAccount:' + @name, false)" xpath="/tmp/@tblSpaceIndex"/>
        <set expr="Iif([/tmp/@tblSpace]='NONE', 0, 1)" xpath="/tmp/@useTblSpace"/>
        <set expr="Iif([/tmp/@tblSpaceIndex]='NONE', 0, 1)" xpath="/tmp/@useTblSpaceIndex"/>
        <if expr="hasPackage('nms:midEmitter')">
          <set expr="Iif([@fdaExtAccount-id]!=0, 1, 0)" xpath="/tmp/@useFDAMidAccount"/>
        </if>
        <if expr="hasPackage('crm:connectors')">
          <soapCall name="GetOption" service="xtk:session">
            <param exprIn="'NmsServer_IntranetURL'" type="string"/>
            <param type="string" xpathOut="/tmp/crm/@instanceUrl"/>
            <param type="byte" xpathOut="/tmp/crm/@dataType"/>
          </soapCall>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/marketingHistory.jssp?object=Lead&amp;id=%%%Id%%%&amp;userId=%%%User id%%%&amp;crm=' +[@name]" xpath="/tmp/crm/ood/@leadHistoryUrl"/>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/marketingHistory.jssp?object=Contact&amp;id=%%%Id%%%&amp;userId=%%%User id%%%&amp;crm=' + [@name]" xpath="/tmp/crm/ood/@contactHistoryUrl"/>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/scsfdc.jssp?object=Lead&amp;id=%%%Id%%%&amp;userId=%%%User id%%%&amp;crm=' +[@name]" xpath="/tmp/crm/ood/@leadSubscriptionUrl"/>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/scsfdc.jssp?object=Contact&amp;id=%%%Id%%%&amp;userId=%%%User id%%%&amp;crm=' + [@name]" xpath="/tmp/crm/ood/@contactSubscriptionUrl"/>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/marketingHistory.jssp?object=Lead&amp;crm=' +[@name]" xpath="/tmp/crm/mscrm/@leadHistoryUrl"/>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/marketingHistory.jssp?object=Contact&amp;crm=' + [@name]" xpath="/tmp/crm/mscrm/@contactHistoryUrl"/>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/scsfdc.jssp?object=Lead&amp;crm=' +[@name]" xpath="/tmp/crm/mscrm/@leadSubscriptionUrl"/>
          <set expr="[/tmp/crm/@instanceUrl] + '/crm/scsfdc.jssp?object=Contact&amp;crm=' + [@name]" xpath="/tmp/crm/mscrm/@contactSubscriptionUrl"/>
        </if>
        <set expr="true" xpath="/tmp/@showConnector"/>
        <if expr="EV(@messageType, 'mail') AND EV(@deliveryMode, 'bulk')">
          <set expr="false" xpath="/tmp/@showConnector"/>
        </if>
        <if expr="HasPackage('nms:social')">
          <if expr="EV(@messageType, 'facebook') OR EV(@messageType, 'twitter')">
            <set expr="false" xpath="/tmp/@showConnector"/>
          </if>
          <if expr="EV(@type, 'oauthFacebook')">
            <if expr="[params/oauthParams/@callbackUrl] = ''">
              <set expr="GetOption('NmsServer_URL')+'/'" xpath="params/oauthParams/@callbackUrl"/>
            </if>
            <if expr="[params/oauthParams/@secureCallbackUrl] = ''">
              <set expr="'https://'+SubString(GetOption('NmsServer_URL'),7)+'/'" xpath="params/oauthParams/@secureCallbackUrl"/>
            </if>
          </if>
          <if expr="EV(@type, 'delivery') AND EV(@messageType, 'facebook') AND [params/oauthParams/@callbackUrl]=''">
            <set expr="GetOption('NmsServer_IntranetURL')+'/webApp/delegateToFacebookScribe?account=' + @name" xpath="params/oauthParams/@callbackUrl"/>
          </if>
          <if expr="EV(@type, 'delivery') AND EV(@messageType, 'facebook') AND [params/oauthParams/@secureCallbackUrl]=''">
            <set expr="'https://'+SubString(GetOption('NmsServer_URL'),7)+'/webApp/delegateToFacebookScribe?account=' + @name" xpath="params/oauthParams/@secureCallbackUrl"/>
          </if>
        </if>
        <if expr="HasPackage('nms:webAnalytics')">
          <set expr="@name" xpath="/tmp/webAnalytics/@oldName"/>
        </if>
        <if expr="HasPackage('nms:messageCenterControl')">
          <set expr="@mcHistoMethod" xpath="/tmp/@mcHistoMethod"/>
          <set expr="true" xpath="/tmp/@mcNoArchivingWkf"/>
          <set value="xtk:workflow" xpath="/ignored/queryDefMC/@schema"/>
          <set value="getIfExists" xpath="/ignored/queryDefMC/@operation"/>
          <set value="@id" xpath="/ignored/queryDefMC/select/node/@expr"/>
          <set expr="'@internalName=\'mcSynch_'+@name+'\''" xpath="/ignored/queryDefMC/where/condition/@expr"/>
          <soapCall name="ExecuteQuery" service="xtk:queryDef">
            <param exprIn="[/ignored/queryDefMC]" type="DOMDocument"/>
            <param type="DOMDocument" xpathOut="/ignored/mcArchivingWkf"/>
          </soapCall>
          <if expr="[/ignored/mcArchivingWkf/@id]!=''">
            <set expr="false" xpath="/tmp/@mcNoArchivingWkf"/>
          </if>
        </if>
        <if expr="HasPackage('nms:interactionControl') AND HasPackage('nms:messageCenterControl')=false">
          <set value="" xpath="/tmp/@mcHistoMethod"/>
        </if>
        <if expr="HasPackage('nms:messageCenterControl') AND HasPackage('nms:interactionControl')=false">
          <set value="1" xpath="/tmp/@isMessageCenter"/>
        </if>
        <if expr="HasPackage('nms:messageCenterControl')=false AND HasPackage('nms:interactionControl')">
          <set value="1" xpath="/tmp/@isInteraction"/>
        </if>
        <if expr="HasPackage('nms:messageCenterControl') AND HasPackage('nms:interactionControl')">
          <set expr="@isMessageCenter" xpath="/tmp/@isMessageCenter"/>
          <set expr="@isInteraction" xpath="/tmp/@isInteraction"/>
        </if>
      </enter>
      <enter name="add">
        <if expr="HasPackage('nms:messageCenterControl')">
          <set expr="true" xpath="/tmp/@mcNoArchivingWkf"/>
        </if>
      </enter>
      <container colcount="2" img="xtk:properties.png" label="General">
        <container menuId="deliveryMenuBuilder" type="deliveryMenuBuilder"/>
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input xpath="@type">
          <enter name="onChange">
            <if expr="hasPackage('nms:social') AND EV(@type, 'oauthFacebook') ">
              <set expr="GetOption('NmsServer_URL')+'/webApp/'" xpath="params/oauthParams/@callbackUrl"/>
              <set expr="'https://'+SubString(GetOption('NmsServer_URL'),7)+'/webApp/'" xpath="params/oauthParams/@secureCallbackUrl"/>
            </if>
          </enter>
        </input>
        <input label="Automatically exported in packages" xpath="@packageAutoExport"/>
        <input xpath="@active"/>
        <static/>
        <container applicableIf="HasPackage('nms:messageCenterControl') or HasPackage('nms:interactionControl')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'executionInstance')">
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@executionInstanceId!=0">
            <input readOnly="true" xpath="@executionInstanceId"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@executionInstanceId=0">
            <static label=" " nolabel="false" type="help">Execution instance ID will automatically be defined on first use or by account initialization.</static>
          </container>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'bounces')">
          <container colcount="2" colspan="2" label="Inbound emails" type="frame">
            <input xpath="@server"/>
            <input xpath="@port"/>
            <input xpath="@account"/>
            <input type="PasswordEdit" xpath="@password"/>
            <input xpath="@encryptionType"/>
            <input colspan="2" img="nms:prepare.png" label="Test the connection" nolabel="false" type="button">
              <enter onSuccess="Connection test successful">
                <soapCall name="TestAccount" service="nms:extAccount">
                  <param exprIn="@type" type="byte"/>
                  <param exprIn="@server" type="string"/>
                  <param exprIn="@account" type="string"/>
                  <param exprIn="@password" type="string"/>
                  <param exprIn="@port" type="string"/>
                  <param exprIn="''" type="string"/>
                </soapCall>
              </enter>
            </input>
            <input xpath="@EMailFunction"/>
          </container>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'delivery')">
          <container colcount="2" colspan="2" label="Routing" type="frame">
            <input xpath="@messageType">
              <enter name="onChange">
                <set expr="true" xpath="/tmp/@showConnector"/>
                <if expr="EV(@messageType, 'mail') AND EV(@deliveryMode, 'bulk')">
                  <set expr="false" xpath="/tmp/@showConnector"/>
                </if>
                <if expr="HasPackage('nms:social') AND (EV(@messageType, 'facebook') OR EV(@messageType, 'twitter'))">
                  <set expr="false" xpath="/tmp/@showConnector"/>
                </if>
                <if expr="hasPackage('nms:social') AND EV(@messageType, 'facebook') ">
                  <set value="facebookConnector.js (nms)" xpath="@connectorJs-cs"/>
                  <set value="facebookConnector.js" xpath="@connectorJs-name"/>
                  <set value="nms" xpath="@connectorJs-namespace"/>
                  <set value="publish_actions,manage_pages,read_insights" xpath="params/oauthParams/@xFacebookPerms"/>
                  <set expr="GetOption('NmsServer_URL')+'/webApp/delegateToFacebookScribe?account=' + @name" xpath="params/oauthParams/@callbackUrl"/>
                  <set expr="'https://'+SubString(GetOption('NmsServer_URL'),7)+'/webApp/delegateToFacebookScribe?account=' + @name" xpath="params/oauthParams/@secureCallbackUrl"/>
                </if>
                <if expr="hasPackage('nms:social') AND EV(@messageType, 'twitter') ">
                  <set value="twitterConnector.js (nms)" xpath="@connectorJs-cs"/>
                  <set value="twitterConnector.js" xpath="@connectorJs-name"/>
                  <set value="nms" xpath="@connectorJs-namespace"/>
                </if>
              </enter>
            </input>
            <input xpath="@deliveryMode"/>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="(EV(@messageType, 'paper') or EV(@messageType, 'fax')) and EV(@deliveryMode, 'bulk')">
              <input xpath="@account"/>
              <input xpath="@password"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="EV(@type, 'delivery') and EV(@deliveryMode,'descriptive')==false and (EV(@deliveryMode,'midSourcing')==false or NodeValue('@multiMidProvider')==false)">
              <input img="xtk:workflow.png" label="Post-processing..." nolabel="false" type="subFormLink">
                <form label="Post-processing for delivery provider">
                  <static type="help">Enter here the workflow and the activity to start once the delivery is approved. This can be used to automate the sending of the routing file to an outsourcer.</static>
                  <input createMode="none" folderFilterChoice="@model = 'xtkWorkflow'" xpath="workflow">
                    <sysFilter>
                      <condition expr="@isModel = 0"/>
                    </sysFilter>
                  </input>
                  <input xpath="@activity"/>
                </form>
              </input>
            </container>
          </container>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'ftp') or EV(@type, 'http') or EV(@type, 'sftp')">
          <container colcount="2" colspan="2" label="Connection" type="frame">
            <input xpath="@server"/>
            <input xpath="@port"/>
            <input xpath="@account"/>
            <input type="PasswordEdit" xpath="@password"/>
            <container type="visibleGroup" visibleIf="[@type] != 14">
              <input enum="nms:extAccount:encryptionType" xpath="@encryptionType"/>
            </container>
            <static/>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:macIntegration')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'mac')">
          <container colcount="2" colspan="2" label="IMS connection" type="frame">
            <input xpath="@imsServer"/>
            <input xpath="@userScope"/>
            <input xpath="@clientId"/>
            <input type="PasswordEdit" xpath="@clientSecret"/>
            <input xpath="@callbackServer"/>
            <input xpath="@imsOrgId"/>
            <input xpath="@imsRightsMask"/>
            <static/>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:macIntegration')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'mac')">
          <container colcount="2" colspan="2" label="Adobe Marketing Cloud connection" type="frame">
            <input xpath="@server"/>
            <input xpath="@tenant"/>
            <static/>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:social')" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'oauthFacebook')">
          <container label="This application is" type="frame">
            <input checkedValue="true" label="hosted by a partner" type="RadioButton" xpath="params/oauthParams/@thirdPartyApplication"/>
            <input checkedValue="false" label="hosted by this instance" type="RadioButton" xpath="params/oauthParams/@thirdPartyApplication"/>
          </container>
          <container label="Application parameters" type="frame">
            <input xpath="params/oauthParams/@consumerKey"/>
            <input reversible="true" type="passwordEdit" xpath="params/oauthParams/@consumerSecret"/>
            <container type="visibleGroup" visibleIf="[params/oauthParams/@thirdPartyApplication]=false">
              <input xpath="params/oauthParams/@callbackUrl"/>
              <input xpath="params/oauthParams/@secureCallbackUrl"/>
              <input label="Edit Facebook permissions..." type="subformlink">
                <form>
                  <container label="Editing Facebook permissions" type="frame">
                    <static type="help">This field is entered automatically based on options selected in the Facebook preloading box in the web application. You should therefore only edit it if you want to access other Facebook information.</static>
                    <input xpath="params/oauthParams/@xFacebookPerms"/>
                    <static type="help">Example: email, user_interests, user_birthday, etc.</static>
                  </container>
                </form>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="EV([params/facebookParams/@realtimeSubStatus], 'subscribed')=false ">
              <static label="You are currently not subscribed to Facebook profile update notifications"/>
              <input editable="false" label="Subscribe" type="button">
                <enter>
                  <check expr="[params/oauthParams/@consumerKey] != ''">
                    <error>Please enter the application ID</error>
                  </check>
                  <check expr="[params/oauthParams/@consumerSecret] != ''">
                    <error>Please enter the secret key</error>
                  </check>
                  <soapCall name="SubscribeToRealTimeUpdates" service="nms:extAccount">
                    <param exprIn="@name" type="string"/>
                    <param exprIn="[params/oauthParams/@consumerKey]" type="string"/>
                    <param exprIn="[params/oauthParams/@consumerSecret]" type="string"/>
                  </soapCall>
                  <set expr="EVal([params/facebookParams/@realtimeSubStatus], 'subscribed')" xpath="params/facebookParams/@realtimeSubStatus"/>
                  <saveView/>
                </enter>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="EV([params/facebookParams/@realtimeSubStatus], 'subscribed')=true">
              <static label="You are currently subscribed to Facebook profile updates notifications"/>
              <input label="Unsubscribe" type="button">
                <enter>
                  <check expr="[params/oauthParams/@consumerKey] != ''">
                    <error>Please enter the application ID</error>
                  </check>
                  <check expr="[params/oauthParams/@consumerSecret] != ''">
                    <error>Please enter the secret key</error>
                  </check>
                  <soapCall name="UnsubscribeToRealTimeUpdates" service="nms:extAccount">
                    <param exprIn="@name" type="string"/>
                    <param exprIn="[params/oauthParams/@consumerKey]" type="string"/>
                    <param exprIn="[params/oauthParams/@consumerSecret]" type="string"/>
                  </soapCall>
                  <set expr="EVal([params/facebookParams/@realtimeSubStatus], 'unsubscribed')" xpath="params/facebookParams/@realtimeSubStatus"/>
                  <saveView/>
                </enter>
              </input>
            </container>
            <container colspan="2">
              <static type="help">The subscription to update notifications enables real-time data synchronization between Facebook and Adobe Campaign</static>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:messageCenterControl') or HasPackage('nms:interactionControl')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'executionInstance')">
          <container colcount="2" colspan="2" label="Connection" type="frame">
            <input colspan="2" label="URL" xpath="@server"/>
            <input xpath="@account"/>
            <input type="PasswordEdit" xpath="@password"/>
            <input colspan="2" img="nms:prepare.png" label="Test the connection" nolabel="false" type="button">
              <enter onSuccess="Connection test successful">
                <soapCall name="TestAccount" service="nms:extAccount">
                  <param exprIn="3" type="byte"/>
                  <param exprIn="@server" type="string"/>
                  <param exprIn="@account" type="string"/>
                  <param exprIn="@password" type="string"/>
                  <param exprIn="''" type="string"/>
                  <param exprIn="''" type="string"/>
                </soapCall>
              </enter>
            </input>
            <container type="visibleGroup" visibleIf="@executionInstanceId==0">
              <input colspan="2" img="nms:prepare.png" label="Initialize connection" nolabel="false" type="button">
                <enter onSuccess="Connection initialized">
                  <saveView/>
                  <soapCall name="InitializeExecutionInstanceAccount" service="nms:extAccount">
                    <param exprIn="@id" type="int"/>
                    <param type="int" xpathOut="@executionInstanceId"/>
                  </soapCall>
                </enter>
              </input>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:messageCenterControl') AND HasPackage('nms:interactionControl')" colcount="1" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'executionInstance')">
            <container colcount="1" colspan="2" label="Nature" type="frame">
              <input label="Message Center" type="checkBox" xpath="/tmp/@isMessageCenter"/>
              <input label="Interaction" type="checkBox" xpath="/tmp/@isInteraction"/>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:messageCenterControl') or HasPackage('nms:interactionControl')" colspan="2" type="visibleGroup" visibleIf="[/tmp/@isMessageCenter] or [/tmp/@isInteraction]">
            <container colspan="2" label="Account connection method" type="frame">
              <container applicableIf="HasPackage('nms:messageCenterControl')" type="visibleGroup" visibleIf="[/tmp/@isMessageCenter]=true AND [/tmp/@isInteraction]=false">
                <input enum="nms:extAccount:mcHistoMethod" label="Method" type="sysenum" xpath="/tmp/@mcHistoMethod"/>
              </container>
              <container type="visibleGroup" visibleIf="[/tmp/@isInteraction] or [/tmp/@mcHistoMethod]=='1'">
                <input createMode="none" type="linkedit" xpath="fdaExtAccount">
                  <sysFilter>
                    <condition expr="@type=7"/>
                  </sysFilter>
                </input>
                <container type="visibleGroup" visibleIf="[/tmp/@isMessageCenter]=true AND [/tmp/@isInteraction]=false">
                  <static label=" " nolabel="false" type="help">Optimized mode, but requires direct access to the database.</static>
                </container>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:messageCenterControl')" colspan="2" type="visibleGroup" visibleIf="[/tmp/@isMessageCenter]">
            <container label="Archiving" type="frame">
              <container type="visibleGroup" visibleIf="[/tmp/@mcNoArchivingWkf]">
                <static type="warning">The archiving workflow does not seem to exist for this execution instance.</static>
                <input img="nms:prepare.png" label="Create the archiving workflow" type="button">
                  <enter onSuccess="Archiving workflow created and started">
                    <saveView/>
                    <soapCall name="UpdateMCSynchWkf" service="nms:extAccount">
                      <param exprIn="@id" type="int"/>
                    </soapCall>
                    <set expr="false" xpath="/tmp/@mcNoArchivingWkf"/>
                  </enter>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="[/tmp/@mcNoArchivingWkf]=false">
                <static fontBold="true">The archiving workflow already exists for this execution instance.</static>
              </container>
            </container>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:webAnalytics')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'webAnalytics')">
          <input xpath="webAnalyticsParams/@partner"/>
          <static/>
          <container colcount="2" colspan="2">
            <container colcount="2" colspan="2" label="Enrichment of calculation formula for tracked URLs" type="frame">
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[webAnalyticsParams/clickFormula] = ''">
                <static fontBold="true" label="The calculation formula for tracked URLs must be enriched with the settings expected by the partner." type="warning"/>
                <input label="Enrich the formula..." type="subformlink">
                  <form title="Enrichment of formula for tracked URLs" type="wizard">
                    <container title="Enrichment of calculation formula for tracked URLs">
                      <input label="Domain(s)" xpath="/tmp/webAnalyticsParams/@mask"/>
                      <static type="help">Partner integration settings will be added to the tracked URLs linked to these domains. You can enter several domains separated by commas. For example: 
we have a 'neoshop.com' domain, the delivery contains the 'http://www.neoshop.com/product.php?code=10' URL and the settings expected by the partner are cid and bid. In this case, the URL is enriched as follows: 'http://www.neoshop.com/product.php?code=10&amp;cid=abcd&amp;bid=1234'.</static>
                      <leave>
                        <soapCall name="InitAppendClickFormula" service="nms:extAccount">
                          <param exprIn="[webAnalyticsParams/@partner]" type="int"/>
                          <param exprIn="[/tmp/webAnalyticsParams/@mask]" type="string"/>
                          <param type="string" xpathOut="webAnalyticsParams/clickFormula"/>
                        </soapCall>
                      </leave>
                    </container>
                    <container title="Enrichment of calculation formula for tracked URLs">
                      <input label="Overload the formula (advanced users only)" type="checkBox" xpath="/ignored/@editFormula"/>
                      <container type="visibleGroup" visibleIf="![/ignored/@editFormula]">
                        <input nolabel="true" readOnly="true" xpath="webAnalyticsParams/clickFormula"/>
                      </container>
                      <container type="visibleGroup" visibleIf="[/ignored/@editFormula]">
                        <static type="warning">This formula can be altered to take additional application conditions into account. This configuration is reserved for advanced users: errors in the formula may block deliveries.</static>
                        <input nolabel="true" xpath="webAnalyticsParams/clickFormula"/>
                      </container>
                    </container>
                  </form>
                </input>
              </container>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[webAnalyticsParams/clickFormula] != ''">
                <static fontBold="true" img="xtk:xtkcheck.png">The tracked URL calculation formula has been successfully enriched.</static>
                <input label="Edit..." type="subformLink">
                  <form label="Enrichment of calculation formula for tracked URLs">
                    <container>
                      <input label="Overload the formula (advanced users only)" type="checkBox" xpath="/ignored/@editFormula"/>
                      <container type="visibleGroup" visibleIf="![/ignored/@editFormula]">
                        <input nolabel="true" readOnly="true" xpath="webAnalyticsParams/clickFormula"/>
                      </container>
                      <container type="visibleGroup" visibleIf="[/ignored/@editFormula]">
                        <static type="warning">Advanced users can alter this formula to take additional application conditions into account. In this case, a test delivery is required since errors in the formula will prevent delivery execution.</static>
                        <input nolabel="true" xpath="webAnalyticsParams/clickFormula"/>
                      </container>
                    </container>
                  </form>
                </input>
              </container>
            </container>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV([webAnalyticsParams/@partner], 'adobeGenesis')">
            <container colcount="2" colspan="2" label="Integration with the partner" type="frame">
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[webAnalyticsParams/integrationDetails/@integrationCode] = ''">
                <static fontBold="true" label="The systems are not connected." type="warning"/>
                <input label="Approve connection..." type="subformlink">
                  <form title="Integration with the partner" type="wizard">
                    <container title="Integration name">
                      <input xpath="@name"/>
                      <static type="help">This name must be identical to the integration name entered in the Adobe-Genesis wizard</static>
                      <leave>
                        <set expr="md5digest(GetOption('XtkDatabaseId') + @name)" xpath="webAnalyticsParams/integrationDetails/@integrationValue"/>
                      </leave>
                    </container>
                    <container title="Account ID">
                      <input readOnly="true" xpath="webAnalyticsParams/integrationDetails/@integrationValue"/>
                      <static type="help">Account ID to enter in the Adobe-Genesis wizard</static>
                      <leave>
                        <soapCall name="GetIntegrationDetails" service="nms:extAccount">
                          <param exprIn="[webAnalyticsParams/@partner]" type="int"/>
                          <param exprIn="@name" type="string"/>
                          <param exprIn="[webAnalyticsParams/integrationDetails/@integrationValue]" type="string"/>
                          <param exprIn="@account" type="string"/>
                          <param exprIn="@password" type="string"/>
                          <param type="DOMDocument" xpathOut="webAnalyticsParams/integrationDetails/"/>
                        </soapCall>
                        <setModified/>
                      </leave>
                    </container>
                    <container title="Integration details">
                      <container label="Integration summary" type="frame">
                        <value label="Name" xpath="webAnalyticsParams/integrationDetails/@integrationName"/>
                        <value xpath="webAnalyticsParams/integrationDetails/@integrationEmail"/>
                        <value xpath="webAnalyticsParams/integrationDetails/@reportSuiteId"/>
                      </container>
                      <container label="Account" type="frame">
                        <value xpath="webAnalyticsParams/integrationDetails/@integrationValue"/>
                      </container>
                      <container label="Selected segments" type="frame">
                        <input editable="false" noToolbar="true" nolabel="true" readOnly="true" type="list" xpath="webAnalyticsParams/integrationDetails/segments/segment">
                          <input editable="false" nolabel="true" xpath="@name"/>
                        </input>
                      </container>
                    </container>
                  </form>
                </input>
              </container>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[webAnalyticsParams/integrationDetails/@integrationCode] != ''">
                <container>
                  <static fontBold="true" img="xtk:xtkcheck.png" label="Integration successful"/>
                  <value xpath="webAnalyticsParams/integrationDetails/@integrationEmail"/>
                  <value xpath="webAnalyticsParams/integrationDetails/@reportSuiteId"/>
                  <value xpath="webAnalyticsParams/integrationDetails/@integrationValue"/>
                </container>
              </container>
            </container>
          </container>
          <static/>
        </container>
        <container applicableIf="HasPackage('nms:federatedDataAccess') OR HasPackage('nms:messageCenterControl') OR HasPackage('nms:interactionControl') OR HasPackage('nms:midEmitter')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'sql')">
          <container colcount="2" colspan="2" label="Connection" type="frame">
            <input xpath="@provider"/>
            <static/>
            <input colspan="2" xpath="@server"/>
            <input xpath="@account"/>
            <input type="PasswordEdit" xpath="@password"/>
            <container colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'postgresql', 'redshift', 'oracle', 'relay', 'saphana')==false">
              <input xpath="@dbName"/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'postgresql', 'redshift')">
              <input xpath="@dbName"/>
              <container colcount="2" colspan="1">
                <input required="true" xpath="@dbSchema"/>
                <container enabledIf="@dbSchema!=''" type="enabledGroup">
                  <input label="Create working schema" type="button">
                    <enter onSuccess="Working schema created">
                      <soapCall name="CreateFDASchema" service="nms:extAccount">
                        <param exprIn="@provider + ':' + @server" type="string"/>
                        <param exprIn="@account" type="string"/>
                        <param exprIn="@password" type="string"/>
                        <param exprIn="@dbName" type="string"/>
                        <param exprIn="'NChar=' + @NChar + ';unicodeData=' + @unicodeData + ';timezone=' + @timezone" type="string"/>
                        <param exprIn="@dbSchema" type="string"/>
                      </soapCall>
                    </enter>
                  </input>
                </container>
              </container>
            </container>
            <container colcount="1" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'relay')==true">
              <input label="Data source" xpath="@dbName"/>
            </container>
            <container colcount="1" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'relay', 'saphana', 'db2')==true">
              <input xpath="@options"/>
              <static label=" " nolabel="false" type="help">Options are in 'parameter=value' format, separated by a semicolon (opt1=1;opt=2;opt3).</static>
              <container colcount="1" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'relay')==true">
                <static label=" " nolabel="false" type="help">This connection supports the following options:
  - bulkBufferSizeMB: size of bulk load http data buffer
- bulkCompress: activate bulk load http data compression</static>
              </container>
              <container colcount="1" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'db2')==true">
                <static label=" " nolabel="false" type="help">This connection supports the following options:
  - optimization: optimization technique used when preparing queries</static>
              </container>
              <container colcount="1" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'saphana')==true">
                <static label=" " nolabel="false" type="help">This connection supports the following options:
  - arrayInsertRows: number of lines sent per bulk load batch</static>
              </container>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'mssql')">
              <input xpath="@prefix"/>
              <static label=" " nolabel="false" type="help">By default, the prefix used will be the name of the account</static>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'saphana')">
              <input xpath="@dbSchema"/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'odbc', 'asterdata')==true">
              <input xpath="@bulkCopyUtility"/>
              <static label=" " nolabel="false" type="help">Complete path of the mass insertion tool</static>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'infinidb')==true">
              <input label="Command line" xpath="@bulkCopyUtility"/>
              <static label=" " nolabel="false" type="help">Command line allowing remote cpimport tool execution. The $(server) variable will be replaced once executed by the name of the InfiniDB server. E.g.: buffer -s 16384 -b 1024 | ssh -C -c blowfish root@$(server)</static>
            </container>
            <container type="visibleGroup" visibleIf="EV(@provider, 'relay')==false">
              <input colspan="2" xpath="@unicodeData"/>
              <container colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'oracle', 'mssql')==true">
                <input xpath="@NChar"/>
              </container>
              <input expr="IIf([@provider]='Netezza', @unicodeData, NodeValue('@NChar'))" type="expr" xpath="@NChar"/>
              <input xpath="@timezone"/>
              <input align="right" colspan="2" img="nms:prepare.png" label="Test the connection" nolabel="false" type="button">
                <enter onSuccess="Connection test successful">
                  <soapCall name="TestAccount" service="nms:extAccount">
                    <param exprIn="@type" type="byte"/>
                    <param exprIn="@provider + ':' + @server" type="string"/>
                    <param exprIn="@account" type="string"/>
                    <param exprIn="@password" type="string"/>
                    <param exprIn="@dbName" type="string"/>
                    <param exprIn="'NChar=' + @NChar + ';unicodeData=' + @unicodeData + ';timezone=' + @timezone + ';dbSchema=' + @dbSchema" type="string"/>
                  </soapCall>
                </enter>
              </input>
              <input xpath="@httpRelayTarget"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@provider, 'relay')==true">
              <input align="right" colspan="2" img="nms:prepare.png" label="Test the connection" nolabel="false" type="button">
                <enter onSuccess="Connection test successful">
                  <soapCall name="TestAccount" service="nms:extAccount">
                    <param exprIn="@type" type="byte"/>
                    <param exprIn="@provider + ':' + @server + '|' + @dbName" type="string"/>
                    <param exprIn="@account" type="string"/>
                    <param exprIn="@password" type="string"/>
                    <param exprIn="''" type="string"/>
                    <param exprIn="''" type="string"/>
                  </soapCall>
                </enter>
              </input>
            </container>
          </container>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'pop3')">
          <container colcount="2" colspan="2" label="POP3 account" type="frame">
            <input xpath="@server"/>
            <input xpath="@port"/>
            <input xpath="@account"/>
            <input type="PasswordEdit" xpath="@password"/>
            <input xpath="@encryptionType"/>
            <input colspan="2" img="nms:prepare.png" label="Test the connection" nolabel="false" type="button">
              <enter onSuccess="Connection test successful">
                <soapCall name="TestAccount" service="nms:extAccount">
                  <param exprIn="@type" type="byte"/>
                  <param exprIn="@server" type="string"/>
                  <param exprIn="@account" type="string"/>
                  <param exprIn="@password" type="string"/>
                  <param exprIn="@port" type="string"/>
                  <param exprIn="@encryptionType" type="string"/>
                </soapCall>
              </enter>
            </input>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:aemIntegration')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'aem')">
          <container colcount="2" colspan="2" label="AEM instance" type="frame">
            <input colspan="2" xpath="@server"/>
            <input xpath="@account"/>
            <input type="PasswordEdit" xpath="@password"/>
          </container>
        </container>
        <container applicableIf="hasPackage('crm:connectors')" name="mscrm" ref="crm:extAccount:mscrm"/>
        <container applicableIf="hasPackage('crm:connectors')" name="ood" ref="crm:extAccount:ood"/>
        <container applicableIf="hasPackage('crm:connectors')" name="sfdc" ref="crm:extAccount:sfdc"/>
        <container applicableIf="hasPackage('crm:webex')" name="webex" ref="crm:extAccount:webex"/>
        <static colspan="2" label="Comment" type="separator"/>
        <input colspan="2" nolabel="true" xpath="comment"/>
      </container>
      <container applicableIf="HasPackage('nms:webAnalytics')" img="xtk:execute.png" label="Segments" visibleIf="EV(@type, 'webAnalytics') and EV([webAnalyticsParams/@partner], 'adobeGenesis')">
        <container label="List">
          <static type="help">When a segment is downloaded, it is processed by the related workflow. The delivery template can be a workflow variable.</static>
          <input hideEditButtons="true" nolabel="true" type="list" xpath="webAnalyticsParams/integrationDetails/segments/segment">
            <input editable="false" readOnly="true" xpath="@name"/>
            <input xpath="workflow">
              <sysFilter>
                <condition expr="@isModel = 0"/>
              </sysFilter>
            </input>
            <input folderFilterChoice="@model = 'nmsDeliveryModel'" xpath="deliveryTemplate">
              <sysFilter>
                <condition expr="@isModel = 1"/>
                <condition expr="[mapping/@name] LIKE 'mapWebEvent' + '%'"/>
                <condition enabledIf="HasPackage('nms:campaign')" expr="[@operation-id] = 0"/>
              </sysFilter>
            </input>
          </input>
          <input label="Update segment list..." type="subformlink">
            <form title="Integration with the partner" type="wizard">
              <container title="Integration settings">
                <input xpath="@name"/>
                <static type="help">This name must be identical to the integration name entered in the Adobe-Genesis wizard</static>
                <input readOnly="true" xpath="webAnalyticsParams/integrationDetails/@integrationValue"/>
                <static type="help">Account ID to enter in the Adobe-Genesis integration wizard</static>
                <leave>
                  <soapCall name="GetIntegrationDetails" service="nms:extAccount">
                    <param exprIn="[webAnalyticsParams/@partner]" type="int"/>
                    <param exprIn="@name" type="string"/>
                    <param exprIn="[webAnalyticsParams/integrationDetails/@integrationValue]" type="string"/>
                    <param exprIn="@account" type="string"/>
                    <param exprIn="@password" type="string"/>
                    <param type="DOMDocument" xpathOut="webAnalyticsParams/integrationDetails/"/>
                  </soapCall>
                  <setModified/>
                </leave>
              </container>
              <container title="Integration details">
                <container label="Integration summary" type="frame">
                  <value label="Name" xpath="webAnalyticsParams/integrationDetails/@integrationName"/>
                  <value xpath="webAnalyticsParams/integrationDetails/@integrationEmail"/>
                  <value xpath="webAnalyticsParams/integrationDetails/@reportSuiteId"/>
                </container>
                <container label="Account" type="frame">
                  <value xpath="webAnalyticsParams/integrationDetails/@integrationValue"/>
                </container>
                <container label="Selected segments" type="frame">
                  <input editable="false" noToolbar="true" nolabel="true" readOnly="true" type="list" xpath="webAnalyticsParams/integrationDetails/segments/segment">
                    <input editable="false" nolabel="true" xpath="@name"/>
                  </input>
                </container>
              </container>
            </form>
          </input>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:webAnalytics')" img="xtk:execute.png" label="Advanced" visibleIf="EV(@type, 'webAnalytics') and EV([webAnalyticsParams/@partner], 'adobeGenesis')">
        <container colcount="2" label="Other settings" type="frame">
          <input xpath="webAnalyticsParams/@purge"/>
          <static type="help">Purge elements with an age greater than the value of this parameter.</static>
          <input xpath="webAnalyticsParams/@persistence"/>
          <static type="help">If the number of days between two events is greater than this value, conversion will not be linked to the remarketing campaign.</static>
        </container>
      </container>
      <container applicableIf="hasPackage('crm:connectors')" name="customizeConnectors" ref="crm:extAccount:customizeConnectors"/>
      <container applicableIf="HasPackage('nms:federatedDataAccess')" colcount="2" img="nms:miniatures/mini-dbImport.png" label="Parameters" visibleIf="EV(@type, 'sql')">
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@provider, 'redshift') == false">
          <static colspan="2" label="Workspace" type="separator"/>
          <input checkedValue="1" colspan="2" label="Use a work tablespace for tables" nolabel="true" type="checkBox" unCheckedValue="0" xpath="/tmp/@useTblSpace"/>
          <container enabledIf="[/tmp/@useTblSpace]=1" type="enabledGroup">
            <input label="Tablespace of tables" xpath="/tmp/@tblSpace"/>
          </container>
          <static/>
          <input checkedValue="1" colspan="2" label="Use a work tablespace for indexes" nolabel="true" type="checkBox" unCheckedValue="0" xpath="/tmp/@useTblSpaceIndex"/>
          <container enabledIf="[/tmp/@useTblSpaceIndex]=1" type="enabledGroup">
            <input label="Tablespace of indexes" xpath="/tmp/@tblSpaceIndex"/>
          </container>
          <static/>
        </container>
        <static colspan="2" label="Functions" type="separator"/>
        <static colspan="2" type="help">In order for all Adobe Campaign Federated Data Access functionalities to be available, you need to create the Adobe Campaign SQL functions in the remote database.</static>
        <input colspan="2" img="nms:miniatures/mini-dbImport.png" label="Deploy functions" type="button">
          <enter>
            <soapCall name="DeploySQLFunctions" service="nms:extAccount">
              <param exprIn="@name" type="string"/>
            </soapCall>
            <msgBox translatedExpr="'The functions were created successfully.'"/>
          </enter>
        </input>
      </container>
      <container img="nms:mobile.png" label="Mobile" visibleIf="EV(@type, 'delivery') and EV(@messageType, 'sms') and EV(@deliveryMode, 'bulk')">
        <static label="Mobile channel (SMS/MMS/WAP Push)" type="separator"/>
        <input xpath="@mobileConnector"/>
        <container type="visibleGroup" visibleIf="EV(@mobileConnector, 'generic')">
          <container colcount="2" label="Connection settings" type="frame">
            <input xpath="@account"/>
            <input xpath="@password"/>
            <input xpath="@server"/>
            <input xpath="@port"/>
          </container>
        </container>
        <container type="visibleGroup" visibleIf="EV(@mobileConnector, 'netsize')">
          <container label="NetSize connection settings" type="notebook">
            <container colcount="2" img="nms:mobile.png" label="SMS">
              <input xpath="@account"/>
              <input xpath="@password"/>
              <input xpath="@server"/>
              <input xpath="@port"/>
              <input xpath="params/@endPointSend"/>
              <input xpath="params/@endPointNotif"/>
              <input xpath="params/@endPointReceipt"/>
              <input xpath="params/@sourceAddress"/>
            </container>
            <container colcount="2" img="nms:mobile.png" label="OTA (WAP Push)" xpath="params/wapPush">
              <input xpath="@account"/>
              <input xpath="@password"/>
              <input xpath="@server"/>
              <input xpath="@port"/>
              <input xpath="@endPointSend"/>
              <input xpath="@endPointNotif"/>
            </container>
            <container colcount="2" img="nms:mms.png" label="MMS" xpath="params/mms">
              <input xpath="@account"/>
              <input xpath="@password"/>
              <input xpath="@server"/>
              <input xpath="@port"/>
              <input xpath="@endPointSend"/>
              <input xpath="@endPointNotif"/>
              <input xpath="@endPointReceipt"/>
            </container>
          </container>
        </container>
        <container colcount="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'smppGen', 'smppSyb365', 'smppmBlox', 'smppTele2', 'smppO2')">
          <container colcount="2" colspan="2" label="SMPP connection settings" type="frame">
            <input xpath="@account"/>
            <input xpath="@password"/>
            <input xpath="@server"/>
            <input xpath="@port"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'smppmBlox')">
            <container colcount="2" colspan="2" label="Inbound messages" type="frame">
              <input xpath="params/@sourceAddress"/>
              <static/>
              <input xpath="params/@systemType"/>
              <input xpath="params/@systemTypeMO"/>
            </container>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'smppGen', 'smppTele2', 'smppO2')">
            <container colcount="2" colspan="2" label="SMPP specific settings" type="frame">
              <input xpath="params/@sourceAddress"/>
              <static/>
              <input xpath="params/@sourceNpi"/>
              <input xpath="params/@sourceTon"/>
              <input xpath="params/@destinationNpi"/>
              <input xpath="params/@destinationTon"/>
              <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'smppGen', 'smppTele2')">
                <input xpath="params/@systemType"/>
                <input xpath="params/@systemTypeMO"/>
                <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@mobileConnector, 'smppGen')">
                  <static colspan="2" label="Coding of identifiers returned by the gateway" type="separator"/>
                  <input xpath="params/@submitRespIdEncode"/>
                  <input xpath="params/@deliverIdEncode"/>
                </container>
                <static colspan="2" label="Default character coding" type="separator"/>
                <input xpath="params/@defaultMtCharset"/>
                <input xpath="params/@defaultMoCharset"/>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container colcount="2" img="xtk:execute.png" label="Connector" visibleIf="[/tmp/@showConnector]">
        <container colcount="2" colspan="2" label="Execution parameters of the delivery connector" type="Frame">
          <input colspan="2" xpath="@activationMode"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@activationMode, 'SoapCall')">
            <input colspan="2" xpath="@connectorUrl"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@activationMode, 'JavaScript')">
            <input colspan="2" xpath="connectorJs"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@activationMode, 'Workflow')">
            <input colspan="2" createMode="none" folderFilterChoice="@model = 'xtkWorkflow'" xpath="connectorWkf">
              <sysFilter>
                <condition expr="@isModel = 0"/>
              </sysFilter>
            </input>
          </container>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:social')" img="xtk:execute.png" label="Connector" visibleIf="EV(@messageType, 'facebook')">
        <container label="Synchronizing Facebook pages" type="frame">
          <input label="Folder" xpath="folderSetOfServices">
            <sysFilter>
              <condition expr="@model='nmsSetOfServices'"/>
            </sysFilter>
          </input>
          <input xpath="params/facebookParams/@filter"/>
          <static label="The filter lets you choose the pages to synchronize between Facebook and Adobe Campaign. Pages whose names match the keyword entered in the filter are kept. You can enter several keywords separated with commas: word1, word 2 for instance. " type="help"/>
        </container>
        <container img="nms:activities/facebook.png" label="Facebook application in charge of publication" type="frame">
          <input xpath="params/oauthParams/@callbackUrl"/>
          <input xpath="params/oauthParams/@secureCallbackUrl"/>
          <input xpath="params/oauthParams/@consumerKey"/>
          <input reversible="true" type="passwordEdit" xpath="params/oauthParams/@consumerSecret"/>
          <input xpath="params/facebookParams/@marketingURL"/>
        </container>
        <container label="Delegate publication" type="frame">
          <container type="visibleGroup" visibleIf="[params/facebookParams/@accessToken]=''">
            <static fontBold="true" label="Adobe Campaign is not authorized to publish on Facebook pages walls." type="warning"/>
            <input form="nms:facebookDialog" img="xtk:passwd.png" label="Request the authorization from the application..." nolabel="true" prebuildSubForm="false" type="subformLink">
              <enter name="onClick">
                <saveView/>
              </enter>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="[params/facebookParams/@accessToken]!=''">
            <static fontBold="true" img="xtk:xtkcheck.png" label="Adobe Campaign is authorized to publish on Facebook page walls."/>
            <input form="nms:facebookDialog" img="xtk:passwd.png" label="Request a new authorization from the application..." nolabel="true" prebuildSubForm="false" type="subformLink">
              <enter name="onClick">
                <saveView/>
              </enter>
            </input>
          </container>
        </container>
      </container>
      <container img="nms:tracking.png" label="Branding" propagateConstraints="false" visibleIf="EV(@type, 'delivery') and EV(@messageType, 'mail') and EV(@deliveryMode, 'external')==false and (EV(@deliveryMode,'midSourcing')==false or NodeValue('@multiMidProvider')==false)">
        <container label="Message domain branding" type="frame">
          <static type="help">These parameters are used to override the DNS alias and addresses used during message delivery. When not populated, the values of the 'NmsServer_MirrorPageUrl' and 'NmsEmail_DefaultErrorAddr' options are used.</static>
          <input xpath="@mirrorURL"/>
          <input img="nms:sendemail.png" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="errorAddress"/>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:midEmitter')" img="nms:miniatures/mini-delivery.png" label="Mid-sourcing" visibleIf="EV(@type, 'delivery') and EV(@deliveryMode, 'midSourcing')">
        <container label="Mid-sourcing platform" type="frame">
          <input useDesc="true" xpath="@multiMidProvider"/>
          <container type="visibleGroup" visibleIf="@multiMidProvider==false">
            <input label="URL of server" xpath="@server"/>
            <input xpath="@account"/>
            <input xpath="@password"/>
            <input img="nms:prepare.png" label="Test the connection" nolabel="false" type="button">
              <enter onSuccess="Connection test successful">
                <soapCall name="TestAccount" service="nms:extAccount">
                  <param exprIn="@type" type="byte"/>
                  <param exprIn="@server" type="string"/>
                  <param exprIn="@account" type="string"/>
                  <param exprIn="@password" type="string"/>
                  <param exprIn="''" type="string"/>
                  <param exprIn="''" type="string"/>
                </soapCall>
              </enter>
            </input>
            <input enum="nms:extAccount:mcHistoMethod" label="Synchronization method" type="sysenum" xpath="/tmp/@useFDAMidAccount"/>
            <container type="visibleGroup" visibleIf="[/tmp/@useFDAMidAccount]==1">
              <input createMode="none" xpath="fdaExtAccount">
                <sysFilter>
                  <condition expr="@type=7"/>
                </sysFilter>
              </input>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="@multiMidProvider">
            <input editable="false" label="Mid-sourcing accounts" prebuildSubForm="true" toolbarAlign="vertical" type="list" xpath="subProvider" zoom="true" zoomOnAdd="true">
              <input editable="true" xpath="@active"/>
              <input xpath="@label"/>
              <input xpath="@name"/>
              <form label="Mid-sourcing account for multiple routing">
                <enter>
                  <set expr="[../@messageType]" xpath="@messageType"/>
                </enter>
                <input computeStringAlias="@label" createMode="none" folderFilterChoice="@model = 'nmsExtAccount'" label="Account" noAutoComplete="true" notifyPathList="@name, @label" required="true" schema="nms:extAccount" type="linkEdit" xpath="@accountId">
                  <sysFilter>
                    <condition expr="@type = 3"/>
                    <condition expr="@messageType = $(../@messageType)"/>
                    <condition expr="@deliveryMode = 4"/>
                    <condition expr="@multiMidProvider = 0"/>
                  </sysFilter>
                </input>
                <input useDesc="true" xpath="@active"/>
                <leave>
                  <check expr="@accountId!='' and @accountId!=0">
                    <error>You must specify a mid-sourcing account.</error>
                  </check>
                </leave>
              </form>
            </input>
          </container>
        </container>
        <input img="nms:tracking.png" label="Use this platform as a proxy to access the tracking servers..." type="subFormLink">
          <form entity-schema="xtk:serverOptions" label="Configure access to tracking servers">
            <enter>
              <set expr="GetOption('NmsTracking_Instance')" xpath="/tmp/@instance"/>
              <set expr="GetOption('NmsTracking_ExtAccount')" xpath="/tmp/@trackingExtAccount"/>
            </enter>
            <container type="visibleGroup" visibleIf="[/tmp/@trackingExtAccount]!=''">
              <static img="nms:finished.png" label="The tracking information is accessed via the mid-sourcing account."/>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/@trackingExtAccount]=''">
              <static label="Access to tracking information via the mid-sourcing account has been disabled." type="warning"/>
            </container>
            <input label="Instance name" xpath="/tmp/@instance"/>
            <input img="nms:prepare.png" label="Enable the tracking instance" nolabel="false" type="button">
              <enter onSuccess="Tracking instance enabled successfully">
                <check expr="[/tmp/@instance]!=''">
                  <error>The name of instance may not be empty.</error>
                </check>
                <soapCall name="RegisterExternalInstance" service="nms:trackingUrl">
                  <param exprIn="[@name]" type="string"/>
                  <param exprIn="[/tmp/@instance]" type="string"/>
                  <param exprIn="''" type="string"/>
                  <param exprIn="true" type="boolean"/>
                </soapCall>
                <set expr="@name" xpath="/tmp/@trackingExtAccount"/>
              </enter>
            </input>
          </form>
        </input>
      </container>
      <postSave>
        <if expr="@type=7">
          <soapCall name="DeclareTableSpaces" service="nms:extAccount">
            <param exprIn="@name" type="string"/>
            <param exprIn="Iif([/tmp/@useTblSpace]=1, [/tmp/@tblSpace], 'NONE')" type="string"/>
            <param exprIn="Iif([/tmp/@useTblSpaceIndex]=1, [/tmp/@tblSpaceIndex], 'NONE')" type="string"/>
          </soapCall>
        </if>
        <if expr="HasPackage('nms:webAnalytics') and EV(@type, 'webAnalytics')">
          <if expr="EV([webAnalyticsParams/@partner], 'adobeGenesis')">
            <soapCall name="CopySegmentsInOption" service="nms:extAccount">
              <param exprIn="[/tmp/webAnalytics/@oldName]" type="string"/>
              <param exprIn="@name" type="string"/>
            </soapCall>
          </if>
        </if>
      </postSave>
      <leave>
        <if expr="HasPackage('nms:interactionControl') or HasPackage('nms:messageCenterControl')">
          <if expr="EV(@type, 'executionInstance')">
            <check expr="[/tmp/@isInteraction]=false or [@fdaExtAccount-id]!=0">
              <error>An execution instance requires an FDA connection.</error>
            </check>
            <if expr="HasPackage('nms:messageCenterControl')">
              <set expr="[/tmp/@mcHistoMethod]" xpath="@mcHistoMethod"/>
            </if>
            <if expr="[/tmp/@isMessageCenter]=false and [/tmp/@isInteraction]=false">
              <set value="0" xpath="@executionInstanceType"/>
            </if>
            <if expr="[/tmp/@isMessageCenter]=true and [/tmp/@isInteraction]=false">
              <set value="1" xpath="@executionInstanceType"/>
            </if>
            <if expr="[/tmp/@isMessageCenter]=false and [/tmp/@isInteraction]=true">
              <set value="2" xpath="@executionInstanceType"/>
            </if>
            <if expr="[/tmp/@isMessageCenter]=true and [/tmp/@isInteraction]=true">
              <set value="3" xpath="@executionInstanceType"/>
            </if>
            <if expr="[/tmp/@isInteraction]=true">
              <set value="1" xpath="@mcHistoMethod"/>
            </if>
          </if>
        </if>
        <if expr="HasPackage('nms:social') and EV(@messageType, 'facebook')">
          <check expr="[folderSetOfServices/@id] != 0">
            <error>Please select a service folder.</error>
          </check>
        </if>
        <if expr="hasPackage('nms:social') AND EV(@messageType, 'facebook') AND [@connectorJs-name] = '' ">
          <set value="facebookConnector.js (nms)" xpath="@connectorJs-cs"/>
          <set value="facebookConnector.js" xpath="@connectorJs-name"/>
          <set value="nms" xpath="@connectorJs-namespace"/>
          <set value="publish_actions,manage_pages,read_insights" xpath="params/oauthParams/@xFacebookPerms"/>
        </if>
        <if expr="hasPackage('nms:social') AND EV(@messageType, 'twitter') AND [@connectorJs-name] = '' ">
          <set value="twitterConnector.js (nms)" xpath="@connectorJs-cs"/>
          <set value="twitterConnector.js" xpath="@connectorJs-name"/>
          <set value="nms" xpath="@connectorJs-namespace"/>
        </if>
        <if expr="hasPackage('nms:mobileApp') AND EV(@messageType, 'ios')">
          <set value="20" xpath="@mobileConnector"/>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="List" md5="A2A7153197E28519BABB34E7A463E90E" name="group" namespace="nms" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/ignored/@importLead"/>
        <if expr="HasPackage('crm:lead')">
          <set expr="iif (EV(@createdFrom, 'importLead') and EV(@type, 'template', 'seg')==false, 1, 0)" xpath="/ignored/@importLead"/>
        </if>
        <if expr="HasPackage('nms:aamIntegration') and IsIMSLoggedIn()">
          <set expr="@segmentId" xpath="/tmp/@oldSegmentId"/>
          <set expr="@mappingId" xpath="/tmp/@oldMappingId"/>
          <set expr="[amcDataSource/@destinationId]" xpath="/tmp/@oldDestinationId"/>
        </if>
      </enter>
      <input expr="iif (EV(@type, 'template', 'file') or [/ignored/@importLead]=1, 1, 0)" type="expr" xpath="/ignored/@showTabs"/>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="general">
          <input xpath="@label"/>
          <input xpath="@name"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/@newSharedList]!=1">
            <input readOnly="true" xpath="@type"/>
            <input xpath="@expirationDate"/>
            <container applicableIf="HasPackage('crm:lead')=false" type="visibleGroup" visibleIf="EV(@type, 'nms', 'seg', 'template')">
              <input readOnly="true" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
            </container>
            <container applicableIf="HasPackage('crm:lead')=false" type="visibleGroup" visibleIf="EV(@type, 'file')">
              <static/>
            </container>
            <container applicableIf="HasPackage('crm:lead')" type="visibleGroup" visibleIf="EV(@createdFrom, 'importLead')=false">
              <container type="visibleGroup" visibleIf="EV(@type, 'nms', 'seg', 'template') and EV(@createdFrom, 'importLead')=false">
                <input readOnly="true" schema="xtk:schema" type="schemaEdit" xpath="@schema"/>
              </container>
              <container type="visibleGroup" visibleIf="EV(@type, 'file') AND EV(@createdFrom, 'importLead')=false">
                <static/>
              </container>
            </container>
            <container applicableIf="HasPackage('crm:lead')" type="visibleGroup" visibleIf="EV(@createdFrom, 'importLead')">
              <container readOnlyIf="EV(@type, 'template')=false" type="readOnlyGroup">
                <input createMode="none" xpath="workflow"/>
              </container>
            </container>
            <container applicableIf="HasPackage('crm:lead')" colspan="2" type="visibleGroup" visibleIf="EV(@createdFrom, 'importLead') AND EV(@type, 'template')==false">
              <static label="Origin" type="separator"/>
              <value xpath="@provider"/>
              <value xpath="@acquisitionType"/>
            </container>
            <container applicableIf="HasPackage('nms:aamIntegration') and IsIMSLoggedIn()" name="audienceManager" type="visibleGroup" visibleIf="[/tmp/@newList]!=1 and EV(@type, 'seg')">
              <static/>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:aamIntegration') and IsIMSLoggedIn()" colspan="2" name="audienceManager" type="visibleGroup" visibleIf="[/tmp/@newList]!=1 and EV(@type, 'seg')">
            <container label="Adobe Marketing Cloud audiences" type="frame">
              <container type="visibleGroup" visibleIf="@mappingId != ''">
                <input img="nms:miniatures/mini-exportToAAM.png" label="Click here to desynchronize shared audiences" prebuildSubForm="false" type="UrlButton" xpath=".">
                  <enter>
                    <set value="" xpath="@segmentId"/>
                    <setModified/>
                  </enter>
                </input>
              </container>
              <container name="audienceManagerLink" type="visibleGroup" visibleIf="@mappingId == '' and @segmentId = ''">
                <input img="nms:miniatures/mini-exportToAAM.png" label="Select a shared audience" nolabel="true" prebuildSubForm="false" type="subFormLink" xpath=".">
                  <form label="Select an 'Adobe Marketing Cloud' shared audience" nothingToEdit="true">
                    <input sessionToken="true" type="audiencePicker" urlExpr="$(serverUrl)+ '/nms/audienceSelector.jssp'" xpath="@segmentId"/>
                  </form>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="@segmentId != ''">
                <value fontBold="true" xpath="@segmentId"/>
              </container>
              <input hidden="true" xpath="@mappingId"/>
              <input hidden="true" xpath="@deleteDisabled"/>
              <input createMode="none" notifyPathList="[mapping/@schema], @destinationId" xpath="amcDataSource">
                <enter name="onChange">
                  <set expr="[amcDataSource/mapping/@schema]" xpath="@schema"/>
                </enter>
              </input>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@folderId]=0">
            <input createMode="none" label="Folder" writeAccess="true" xpath="folder">
              <sysFilter>
                <condition expr="@isView=0 and @model='nmsGroup'"/>
              </sysFilter>
            </input>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="desc"/>
        </container>
      </container>
      <container type="notebook">
        <container img="nms:rcpgroup.png" label="Dashboard" visibleIf="[/tmp/@newList]!=1 and [/tmp/@duplicated]!=1 and [/tmp/@newSharedList] !=1">
          <input entityRefresh="nms:group" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/nms/group.jssp?id='+@id+'&amp;standalone=1'"/>
        </container>
        <container img="xtk:form.png" label="Edit" visibleIf="@id != 0">
          <container type="visibleGroup" visibleIf="[/ignored/@showTabs]=0">
            <container colcount="2" ref="nms:group:lib/general"/>
          </container>
          <container type="visibleGroup" visibleIf="[/ignored/@showTabs]=1">
            <container type="iconbox">
              <container colcount="2" img="xtk:properties.png" label="General" ref="nms:group:lib/general"/>
              <container img="xtk:schema.png" label="Schema" visibleIf="EV(@type, 'template')">
                <input type="schemaview" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchemaData="extension"/>
                <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
              </container>
              <container applicableIf="HasPackage('crm:lead')" img="crm:incomingLead.png" label="Activities" ref="crm:common:activities" visibleIf="EV(@createdFrom, 'importLead') AND EV(@type, 'template', 'seg')==false"/>
              <container img="xtk:logs.png" label="Log" visibleIf="EV(@type, 'file')">
                <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Log messages of the journal" type="linkList" xpath="log">
                  <input xpath="@logDate"/>
                  <input xpath="@message"/>
                  <orderBy>
                    <node expr="@id" sortDesc="true"/>
                  </orderBy>
                </input>
              </container>
            </container>
          </container>
        </container>
        <container img="nms:miniatures/mini-group.png" label="Content" visibleIf="EV(@type, 'template')=false and @id!=0 and [/tmp/@duplicated]!=1 and [/tmp/@newSharedList] !=1">
          <container type="visibleGroup" visibleIf="@schema='nms:recipient' and EV(@type, 'nms')">
            <input choicePath="/tmp/choiceList" img="nms:recipient.png" labelFormChoice="Add recipients to the list" newEntityFormChoice="true" nolabel="true" promptDeleteLabel="Do you wish to remove the selected recipients from the list?" selectionPath="/tmp/entityList" toolbarCaption="Recipients in the list" type="linklist" xpath="rcpGrpRel" xpathChoiceTarget="recipient" xpathEditTarget="recipient" xpathRefresh="/tmp/@id" zoom="true">
              <enter name="add">
                <soapCall name="RegisterGroup" service="nms:recipient">
                  <param exprIn="/tmp/entityList" type="DOMElement"/>
                  <param exprIn="/tmp/choiceList" type="DOMElement"/>
                  <param exprIn="'true'" type="boolean"/>
                </soapCall>
              </enter>
              <enter name="remove">
                <soapCall name="RegisterGroup" service="nms:recipient">
                  <param exprIn="/tmp/entityList" type="DOMElement"/>
                  <param exprIn="/tmp/choiceList" type="DOMElement"/>
                  <param exprIn="'false'" type="boolean"/>
                </soapCall>
              </enter>
              <input xpath="recipient/@lastName"/>
              <input xpath="recipient/@firstName"/>
              <input xpath="recipient/@email"/>
              <input xpath="recipient/@phone"/>
              <orderBy>
                <node expr="[@recipient-id]"/>
              </orderBy>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="EV(@type, 'seg', 'file')">
            <container style="flat" type="notebook">
              <container label="Data" visibleIf="EV(@type, 'seg')">
                <input addButton="true" delButton="true" nolabel="true" promptDeleteLabel="Do you want to remove selected items from the list?" toolbarCaption="List content" type="tmpDataPreviewList" xpathObjectSchema="@schema" xpathSchemaData="extension">
                  <enter name="add">
                    <soapCall name="Register" service="nms:group">
                      <param exprIn="[/tmp/@selection]" type="string"/>
                      <param exprIn="/tmp/listChoice" type="DOMElement"/>
                    </soapCall>
                  </enter>
                  <enter name="remove">
                    <soapCall name="Unregister" service="nms:group">
                      <param exprIn="[/tmp/@selection]" type="string"/>
                      <param exprIn="/tmp/listChoice" type="DOMElement"/>
                    </soapCall>
                  </enter>
                </input>
              </container>
              <container label="Data" visibleIf="EV(@type, 'file')">
                <container applicableIf="HasPackage('crm:lead')" type="visibleGroup" visibleIf="EV(@createdFrom, 'importLead')">
                  <static fontBold="true" label="Column names coincide with those in the template, not the columns of the file." type="help"/>
                </container>
                <input nolabel="true" toolbarCaption="List content" type="tmpDataPreviewList" xpathObjectSchema="@schema" xpathSchemaData="extension"/>
              </container>
              <container label="Schema">
                <input type="schemaview" xpathHelp="/tmp/selectCtrl/itn/@help" xpathSchemaData="extension"/>
                <input type="help" xpath="/tmp/selectCtrl/itn/@help"/>
              </container>
            </container>
          </container>
        </container>
      </container>
      <leave>
        <if expr="[/tmp/@folderId]!=0 AND [/tmp/@folderId]!=''">
          <set expr="[/tmp/@folderId]" xpath="@folder-id"/>
        </if>
        <check expr="[@folder-id]!=0">
          <error>The folder is not specified.</error>
        </check>
        <check expr="@expirationDate = ## OR [@expirationDate]>GetDate()">
          <error>The expiration date must be after the current date</error>
        </check>
        <if expr="HasPackage('nms:aamIntegration') and IsIMSLoggedIn()">
          <if expr="[@segmentId] != [/tmp/@oldSegmentId] OR [amcDataSource/@destinationId] != [/tmp/@oldDestinationId]">
            <set value="" xpath="/tmp/@newMappingId"/>
            <set value="false" xpath="/tmp/@addMappingSuccess"/>
            <set value="false" xpath="/tmp/@deleteMappingSuccess"/>
            <if expr="[@segmentId] != '' AND [amcDataSource/@destinationId] != 0">
              <soapCall name="createAudienceMapping" service="nms:group">
                <param exprIn="[@segmentId]" type="string"/>
                <param exprIn="[amcDataSource/@destinationId]" type="long"/>
                <param type="string" xpathOut="/tmp/@newMappingId"/>
              </soapCall>
              <if expr="[/tmp/@newMappingId] != ''">
                <set value="true" xpath="/tmp/@addMappingSuccess"/>
              </if>
            </if>
            <if expr="[/tmp/@oldSegmentId] != '' AND [/tmp/@oldDestinationId] != 0 AND [/tmp/@oldMappingId] != ''">
              <soapCall name="deleteAudienceMapping" service="nms:group">
                <param exprIn="[/tmp/@oldSegmentId]" type="string"/>
                <param exprIn="[/tmp/@oldDestinationId]" type="long"/>
                <param exprIn="[/tmp/@oldMappingId]" type="string"/>
                <param type="boolean" xpathOut="/tmp/@deleteMappingSuccess"/>
              </soapCall>
            </if>
            <if expr="[/tmp/@deleteMappingSuccess] == 'true'">
              <set value="" xpath="@mappingId"/>
            </if>
            <if expr="[/tmp/@addMappingSuccess] == 'true'">
              <set expr="[/tmp/@newMappingId]" xpath="@mappingId"/>
            </if>
            <set expr="@mappingId" xpath="/tmp/@oldMappingId"/>
            <set expr="@segmentId" xpath="/tmp/@oldSegmentId"/>
            <set expr="[amcDataSource/@destinationId]" xpath="/tmp/@oldDestinationId"/>
          </if>
          <if expr="@mappingId != ''">
            <set value="true" xpath="@deleteDisabled"/>
          </if>
          <if expr="@mappingId == ''">
            <set value="false" xpath="@deleteDisabled"/>
          </if>
          <check expr="@mappingId != '' or [/tmp/@newSharedList] !=1 or @segmentId != ''">
            <error>You must enter a shared audience.</error>
          </check>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" md5="1F3B7C8A0CEC3A930CFB2E43FE28E584" name="includeView" namespace="nms" xtkschema="xtk:form">
      <enter>
        <set value="nms:recipient" xpath="/tmp/selectCtrl/in/@schema"/>
        <set value="nms:delivery" xpath="/tmp/schema/@delivery"/>
        <set value="nms:rcpGrpRel" xpath="/tmp/schema/@rcpGrpRel"/>
        <set value="nms:subscription" xpath="/tmp/schema/@subscription"/>
        <set value="1" xpath="/tmp/@isIncludeView"/>
      </enter>
      <input expr="@type" type="expr" xpath="/tmp/dummyUselessField">
        <enter>
          <if expr="EV(@type,'fullPage')=true">
            <set value="false" xpath="@visible"/>
            <set value="true" xpath="source/@dependOnFormat"/>
            <set value="false" xpath="source/@noEscaping"/>
          </if>
        </enter>
      </input>
      <input xpath="@label"/>
      <input xpath="@name"/>
      <container colcount="2" colspan="2">
        <input xpath="@contentType"/>
        <input img="xtk:properties.png" label="Advanced settings..." nolabel="true" type="subFormLink">
          <form label="Advanced parameters">
            <container type="visibleGroup" visibleIf="EV(@type,'fullPage') = false">
              <static label="The block is included in:"/>
              <input checkedValue="false" label="the body of the content" type="RadioButton" xpath="source/@noEscaping"/>
              <input checkedValue="true" label="an attachment" type="RadioButton" xpath="source/@noEscaping"/>
              <input expr="[source/@noEscaping]" type="expr" xpath="/tmp/dummyUselessField">
                <enter>
                  <if expr="[source/@noEscaping]=true">
                    <set value="false" xpath="source/@dependOnFormat"/>
                  </if>
                </enter>
              </input>
              <static label="Inclusion in an attached document requires an OpenOffice XML code. Refer to the documentation for more information." type="help"/>
            </container>
            <container colspan="2" type="visibleGroup" visibleIf="EV(@type,'fullPage') = true">
              <input xpath="@thumbnail"/>
              <static label="URL of the image (48px*48px) representing the content when selected." type="help"/>
              <input xpath="@order"/>
            </container>
          </form>
        </input>
        <container colspan="2" type="visibleGroup" visibleIf="EV(@type,'fullPage')=false">
          <input xpath="@visible"/>
          <container type="visibleGroup" visibleIf="![source/@noEscaping]">
            <input useDesc="true" xpath="source/@dependOnFormat"/>
          </container>
        </container>
      </container>
      <input expr="[source/@dependOnFormat]" type="expr" xpath="/tmp/cusBtnParam/@htmlMode"/>
      <input expr="[source/@noEscaping]" type="expr" xpath="/tmp/barcode/@isOpenDocument"/>
      <container colspan="2" isIncludeView="true" menuId="deliveryMenuBuilder" type="deliveryMenuBuilder">
        <form label="Select an option" name="selectOptDlg" nothingToSave="true">
          <container defaultColumns="@name,@dataType,desc" exprOut1="@name" schema="xtk:option" sharedUserConfig="true" type="navTreeEntityList" xpath="." xpathOut1="@name"/>
        </form>
        <form colcount="2" label="Inserting a barcode" name="insertBarcode" nothingToSave="true" xpath="/tmp/barcode/">
          <enter>
            <set value="QRCode" xpath="/tmp/barcode/@type"/>
            <set value="1" xpath="/tmp/barcode/@scale"/>
            <set value="100" xpath="/tmp/barcode/@height"/>
            <set value="100" xpath="/tmp/barcode/@width"/>
            <set value="H" xpath="/tmp/barcode/@errCorr"/>
          </enter>
          <input colspan="2" enum="nms:common:barcodeType" label="Type" type="sysenum" xpath="@type"/>
          <input colspan="2" label="Value" menuId="deliveryMenuBuilder" type="scriptEdit" xpath="@valueExpr"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type!='QRCode'">
            <input enum="nms:common:barcodeScale" label="Scale" type="sysenum" xpath="@scale"/>
            <input label="Height" type="number" xpath="@height"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type='QRCode'">
            <input colspan="2" enum="nms:common:qrcodeErrCorr" label="Error correction" type="sysenum" xpath="@errCorr"/>
            <input label="Width" type="number" xpath="@height"/>
            <input label="Height" type="number" xpath="@width"/>
          </container>
        </form>
        <form label="Selecting a personalization block" name="selectIncDlg" nothingToSave="true">
          <container defaultColumns="@label,@name" exprOut1="@name" exprOut2="@label" nodeModel="nmsIncludeView" schema="nms:includeView" sharedUserConfig="true" type="navTreeEntityList" xpath="." xpathOut1="@name" xpathOut2="@label">
            <sysFilter>
              <condition expr="@visible=1"/>
            </sysFilter>
          </container>
          <input label="Include the HTML source code of the block" type="checkBox" xpath="/ignored/customizeBtnOut/subForm/@inlineMode"/>
        </form>
      </container>
      <container colspan="2" name="code">
        <container name="triple" type="visibleGroup" visibleIf="[source/@dependOnFormat]">
          <container name="notebook" type="notebook" xpath="source">
            <container img="xtk:html.png" label="HTML content" name="htmlContentEditor" xpath="html">
              <container style="flat" type="contentEditor">
                <container label="HTML" visibleIf="EV([/includeView/@type],'fullPage') = true">
                  <input label="Edit" prebuildSubForm="false" type="subFormButton" xpath=".">
                    <form>
                      <input mode="includeView" type="digitalContentEditor" xpath="." xpathContentType="/includeView/@contentType" xpathSchema="/tmp/selectCtrl/in/@schema">
                        <form label="Resource publishing" nothingToEdit="true" nothingToSave="true">
                          <container name="localResourcesUploader" type="localResourcesUploader" xpathCurProgress="/tmp/@uploadCurrent" xpathFilesToDownload="/tmp/localResources" xpathMaxProgress="/tmp/@uploadMax">
                            <input name="JobLogsList" type="JobLogList"/>
                            <container colcount="2">
                              <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/tmp/@uploadCurrent" xpathMax="/tmp/@uploadMax"/>
                            </container>
                          </container>
                          <leave>
                            <set value="true" xpath="/tmp/@uploadImages"/>
                          </leave>
                        </form>
                      </input>
                    </form>
                  </input>
                  <container readOnlyIf="true" type="readOnlyGroup">
                    <input mode="includeView" type="digitalContentEditor" xpath="." xpathContentType="/includeView/@contentType" xpathSchema="/tmp/selectCtrl/in/@schema"/>
                  </container>
                </container>
                <container label="HTML" name="tabHtml" visibleIf="EV([/includeView/@type],'fullPage') = false">
                  <input bodyMode="true" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeHTMLWysiwyg" xpathUrl="/tmp/urlTree/@toSelect">
                    <container>
                      <input menuId="deliveryMenuBuilder" options="html" type="customizeBtn" xpath="/ignored/customizeHTMLWysiwyg"/>
                    </container>
                  </input>
                </container>
                <container ref="nms:delivery:lib/content/HTML/htmlContentEditor/notebook/tabSource"/>
              </container>
            </container>
            <container img="xtk:text.png" label="Text content" name="textContentEditor" xpath="text">
              <container style="flat" type="contentEditor">
                <container ref="nms:delivery:lib/content/Text/textContentEditor/notebook/tabText"/>
              </container>
            </container>
          </container>
        </container>
        <container type="visibleGroup" visibleIf="![source/@dependOnFormat]">
          <container ref="nms:includeView:code/triple/notebook/textContentEditor" xpath="source"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Visitor" md5="038A98064F48FB53BF9608E986021DEB" name="visitor" namespace="nms" type="iconbox" xtkschema="xtk:form">
      <enter>
        <set expr="getOption('NmsServer_URL')+'/nms/checkinMap.jssp?id='+@id" xpath="/tmp/@googleMapUrl"/>
      </enter>
      <container img="xtk:properties.png" label="General" name="general" readOnlyIf="HasPackage('nms:social') AND EV(@origin, 'facebook', 'twitter')">
        <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="EV(@origin, 'facebook', 'twitter')">
          <container colcount="3" label="Summary" type="frame">
            <container type="visibleGroup" visibleIf="@email!=''">
              <static fontBold="true" img="xtk:xtkcheck.png" label="Email"/>
            </container>
            <container type="visibleGroup" visibleIf="@email=''">
              <static fontBold="true" img="xtk:xtkcancel.png" label="Email"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@origin, 'facebook') and @accessToken!='' and @tokenExpirationDate=''">
              <static fontBold="true" img="xtk:xtkcheck.png" label="Wall address"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@origin, 'facebook') and (@accessToken='' or @tokenExpirationDate!='')">
              <static fontBold="true" img="xtk:xtkcancel.png" label="Wall address"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@origin, 'twitter') and @screenName!=''">
              <static fontBold="true" img="xtk:xtkcheck.png" label="Twitter address (Direct message)"/>
            </container>
            <container type="visibleGroup" visibleIf="EV(@origin, 'twitter') and @screenName=''">
              <static fontBold="true" img="xtk:xtkcancel.png" label="Twitter address (Direct Message)"/>
            </container>
            <container type="visibleGroup" visibleIf="@recipientId == 0 or [recipient/@created] >= @created">
              <static fontBold="true" img="xtk:xtkcheck.png" label="New contact"/>
            </container>
            <container type="visibleGroup" visibleIf="@recipientId != 0 and [recipient/@created] &lt; @created">
              <static fontBold="true" img="xtk:xtkcancel.png" label="New contact"/>
            </container>
          </container>
        </container>
        <container colcount="2">
          <input xpath="@firstName"/>
          <input xpath="@lastName"/>
          <input xpath="@origin"/>
          <input xpath="@created"/>
          <input colspan="2" img="nms:sendemail.png" xpath="@email"/>
          <container colspan="2" type="visibleGroup" visibleIf="@recipientId!=0">
            <input readOnly="true" xpath="recipient"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@referrerId!=0">
            <input readOnly="true" xpath="referrerRcp"/>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@deliveryId!=0">
            <input readOnly="true" xpath="delivery"/>
          </container>
          <container applicableIf="HasPackage('nms:social')" colspan="2">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="visitorInterestRel">
              <input xpath="interest/@label"/>
              <input xpath="interest/@category"/>
              <input xpath="interest/@origin"/>
            </input>
          </container>
          <static colspan="2" label="Comment" type="separator"/>
          <input colspan="2" nolabel="true" type="memo" xpath="comment"/>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:social')" img="nms:twitter.png" label="Twitter" visibleIf="EV(@origin, 'twitter')">
        <input label="Image" noBorder="true" type="urlViewer" urlExpr="'http://twitter.com/' + @screenName"/>
      </container>
      <container applicableIf="HasPackage('nms:social')" img="nms:facebook.png" label="Facebook" visibleIf="EV(@origin, 'facebook')">
        <input label="Image" noBorder="true" type="urlViewer" urlExpr="'http://www.facebook.com/profile.php?id=' + @externalId"/>
      </container>
      <container applicableIf="HasPackage('nms:social')" img="nms:setofservices.png" label="Subscriptions">
        <input hideEditButtons="true" img="nms:setofservices.png" nolabel="true" toolbarCaption="Visitor subscriptions" type="linklist" xpath="visitorSub">
          <input xpath="service"/>
          <input xpath="[visitor/@friendCount]"/>
        </input>
      </container>
      <container applicableIf="HasPackage('nms:social')" img="nms:visitor.png" label="Friends" visibleIf="EV(@origin, 'facebook')">
        <input hideEditButtons="true" img="nms:visitor.png" nolabel="true" toolbarCaption="Friends of this visitor" type="linklist" xpath="friend" xpathEditTarget="friend" zoom="true">
          <input xpath="friend"/>
        </input>
      </container>
      <container applicableIf="HasPackage('nms:social')" img="xtk:history.png" label="Activities" visibleIf="EV(@origin, 'facebook')">
        <container type="notebook">
          <container label="Pages">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestLiked">
              <input xpath="@publishTime"/>
              <input xpath="interest"/>
              <input xpath="interest/@category"/>
              <orderBy>
                <node expr="@publishTime" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container label="Music">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestSongListened">
              <input xpath="@startTime"/>
              <input xpath="interestSong/@label"/>
              <input xpath="interestSong/album"/>
              <input xpath="interestSong/author"/>
              <input xpath="madeBy"/>
              <orderBy>
                <node expr="@startTime" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container label="Videos">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestVideoWatched">
              <input xpath="@startTime"/>
              <input xpath="interestVideo"/>
              <input xpath="madeBy"/>
              <orderBy>
                <node expr="@startTime" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container label="Articles">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestNewsRead">
              <input xpath="@startTime"/>
              <input xpath="interestNews"/>
              <input xpath="madeBy"/>
              <orderBy>
                <node expr="@startTime" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container label="Check-ins">
            <container style="down" type="notebook">
              <container label="Locations">
                <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestLocationVisited">
                  <input xpath="@publishTime"/>
                  <input xpath="interestLocation"/>
                  <input xpath="interestLocation/@latitude"/>
                  <input xpath="interestLocation/@longitude"/>
                  <input xpath="madeBy"/>
                  <orderBy>
                    <node expr="@publishTime" sortDesc="true"/>
                  </orderBy>
                </input>
              </container>
              <container label="Card">
                <input sessionToken="true" type="urlViewer" urlExpr="[/tmp/@googleMapUrl]"/>
              </container>
            </container>
          </container>
          <container label="Installed applications">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestAppInstalled">
              <input xpath="interestApp"/>
            </input>
          </container>
          <container label="Comments on deliveries">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestCommentPosted">
              <input xpath="@publishTime"/>
              <input xpath="interestComment/@label"/>
              <input xpath="interestComment/delivery"/>
              <orderBy>
                <node expr="@publishTime" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container label="Liked deliveries">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestStatusLiked">
              <input xpath="interestStatus/delivery"/>
            </input>
          </container>
        </container>
      </container>
      <container img="nms:broadLog.png" label="Deliveries" name="delivery">
        <input enumImage="@status" hideEditButtons="true" img="nms:broadLog.png" nolabel="true" toolbarCaption="Visitor delivery logs" type="linklist" xpath="broadLog">
          <input size="14" xpath="@lastModified"/>
          <input size="20" xpath="@status"/>
          <input size="30" xpath="msg/@failureReason"/>
          <input size="25" xpath="delivery"/>
          <input xpath="msg/@text"/>
          <orderBy>
            <node expr="@lastModified" sortDesc="true"/>
          </orderBy>
          <sysFilter>
            <condition expr="[delivery/@deleteStatus] = 0"/>
          </sysFilter>
        </input>
      </container>
      <container img="nms:tracking.png" label="Tracking" name="tracking">
        <input hideEditButtons="true" img="nms:tracking.png" nolabel="true" toolbarCaption="Visitor tracking logs" type="linklist" xpath="trackingLog">
          <input xpath="@logDate"/>
          <input xpath="url/@label"/>
          <input xpath="url/@type"/>
          <input xpath="delivery"/>
          <orderBy>
            <node expr="@logDate" sortDesc="true"/>
          </orderBy>
        </input>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Recipient" md5="EEF438D1B9B958AF7B0A0449D5C4895F" name="recipient" namespace="nms" type="iconbox" xtkschema="xtk:form">
      <enter applicableIf="HasPackage('nms:coreInteraction')">
        <set value="0" xpath="/ignored/preview/@env-id"/>
        <if expr="[/ignored/preview/@maxPropositionCount]=''">
          <set value="1" xpath="/ignored/preview/@maxPropositionCount"/>
        </if>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="freeFields">
          <input nolabel="true" type="treeEdit">
            <container label="Text fields">
              <input xpath="@text1"/>
              <input xpath="@text2"/>
              <input xpath="@text3"/>
              <input xpath="@text4"/>
              <input xpath="@text5"/>
            </container>
            <container label="Boolean fields">
              <input xpath="@boolean1"/>
              <input xpath="@boolean2"/>
              <input xpath="@boolean3"/>
            </container>
          </input>
        </container>
      </container>
      <container applicableIf="hasPackage('crm:lead')" colcount="2" img="nms:recipient.png" label="Summary" name="marketingHistory">
        <input forceNavigate="true" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/crm/marketingHistoryNl.jssp?standalone=1&amp;recipientId='+ UrlEncode(AESEncrypt([@id]))"/>
      </container>
      <container applicableIf="HasPackage('crm:lead')" colcount="2" img="xtk:properties.png" label="General" name="crmGeneral" readOnly="true">
        <input xpath="@firstName"/>
        <input xpath="@lastName"/>
        <input xpath="@salutation"/>
        <input xpath="@status"/>
        <input xpath="company"/>
        <input xpath="@language"/>
        <container colcount="2" colspan="2" ref="crm:common:blacklist"/>
        <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@folderId]=0">
          <input createMode="none" label="Folder" writeAccess="true" xpath="folder">
            <sysFilter>
              <condition expr="@isView=0 and @model='nmsRecipient'"/>
            </sysFilter>
          </input>
        </container>
        <static colspan="2" label="Main parameters" type="separator"/>
        <input img="nms:sendemail.png" xpath="@email"/>
        <input xpath="@emailFormat"/>
        <input xpath="@mobilePhone"/>
        <input xpath="@fax"/>
        <input xpath="@phone"/>
        <input xpath="@homePhone"/>
        <static colspan="2" label="Comment" type="separator"/>
        <input colspan="2" nolabel="true" xpath="comment"/>
      </container>
      <container applicableIf="HasPackage('crm:lead')=false" colcount="2" img="xtk:properties.png" label="General" name="general">
        <input xpath="@firstName"/>
        <input xpath="@lastName"/>
        <input xpath="@salutation"/>
        <input xpath="@middleName"/>
        <input xpath="@account"/>
        <input xpath="@status"/>
        <input xpath="@company"/>
        <input xpath="@gender"/>
        <input xpath="@language"/>
        <input xpath="@birthDate"/>
        <input colspan="2" type="checkbox" xpath="@blackList"/>
        <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@folderId]=0">
          <input createMode="none" label="Folder" writeAccess="true" xpath="folder">
            <sysFilter>
              <condition expr="@isView=0 and @model='nmsRecipient'"/>
            </sysFilter>
          </input>
        </container>
        <static colspan="2" label="Main parameters" type="separator"/>
        <input img="nms:sendemail.png" xpath="@email"/>
        <input xpath="@emailFormat"/>
        <input xpath="@mobilePhone"/>
        <input xpath="@fax"/>
        <input xpath="@phone"/>
        <input xpath="@origin"/>
        <static colspan="2" label="Comment" type="separator"/>
        <input colspan="2" nolabel="true" xpath="comment"/>
      </container>
      <container colcount="2" img="nms:msgfolder.png" label="Contact information" maxLabelWidth="200" name="address" readOnlyIf="HasPackage('crm:lead')" xpath="location">
        <static colspan="2" label="Postal address" type="separator"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address1"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address2"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address3"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')!=1" colspan="2" xpath="@address4"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@additionalRcp"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@additionalGeo"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@street"/>
        <input applicableIf="GetOption('NmsRecipient_UseOldAddr')==1" colspan="2" xpath="@special"/>
        <input xpath="@zipCode"/>
        <input xpath="@city"/>
        <input choiceButton="true" createMode="none" extraColumns="@isoA2,@isoA3" noZoom="true" xpath="../country">
          <orderBy>
            <node expr="@label"/>
          </orderBy>
          <enter name="onChange">
            <set value="" xpath="../location/@stateCode"/>
            <reset xpath="../stateLink"/>
          </enter>
        </input>
        <input choiceButton="true" createMode="none" extraColumns="@code,@countryCode" noZoom="true" notifyPathList="country/@label|../country/@_cs,@countryCode|../location/@countryCode,country|../country" xpath="../stateLink">
          <sysFilter>
            <condition expr="@countryCode = $(../location/@countryCode)"/>
          </sysFilter>
          <orderBy>
            <node expr="@label"/>
          </orderBy>
        </input>
        <static colspan="2" label="Address quality" type="separator"/>
        <container type="visibleGroup" visibleIf="[../postalAddress/@addrDefined]">
          <static img="xtk:xtkcheck.png" label=" " nolabel="false">Address specified</static>
        </container>
        <container type="visibleGroup" visibleIf="[../postalAddress/@addrDefined]==false">
          <static img="xtk:logwarn.png" label=" " nolabel="false">Address not specified</static>
        </container>
        <input readOnly="true" xpath="../postalAddress/@addrErrorCount"/>
        <input readOnly="true" xpath="../postalAddress/@addrQuality"/>
        <input readOnly="true" xpath="../postalAddress/@addrLastCheck"/>
      </container>
      <container img="nms:others.png" label="Others" name="others" visibleIf="HasPackage('crm:lead')=false">
        <container ref="nms:recipient:lib/freeFields"/>
        <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="HasPackage('nms:social')">
          <input disableDefaultFilter="true" enumImage="@origin" hideEditButtons="true" img="nms:visitor.png" nolabel="true" toolbarCaption="Digital identities" type="linklist" xpath="visitor" zoom="true">
            <input xpath="[.]"/>
            <orderBy>
              <node expr="@name"/>
              <node expr="@lastModified" sortDesc="true"/>
            </orderBy>
            <sysFilter>
              <condition expr="@origin != 0 "/>
            </sysFilter>
          </input>
        </container>
      </container>
      <container applicableIf="HasPackage('crm:lead')" img="crm:lead.png" label="Leads" name="leads">
        <container type="notebook">
          <container label="Leads">
            <input hideEditButtons="true" img="crm:outgoingLead.png" nolabel="true" refresh="true" toolbarCaption="Leads generated on the recipient" type="linklist" xpath="outgoingLead" zoom="true">
              <input xpath="@lastActivity"/>
              <input xpath="@score"/>
              <input xpath="@rating"/>
              <input xpath="@destination"/>
              <input xpath="@progressStatus"/>
              <input xpath="@stage"/>
              <input xpath="@conversionDate"/>
              <orderBy>
                <node expr="@lastActivity" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container label="Activities">
            <input hideEditButtons="true" img="crm:incomingLead.png" name="incomingLeadRcp" nolabel="true" refresh="true" toolbarCaption="Activities related to the recipient" type="linklist" xpath="incomingLead" zoom="true">
              <input xpath="@eventDate"/>
              <input xpath="@type"/>
              <input xpath="@firstName"/>
              <input xpath="@lastName"/>
              <input xpath="@email"/>
              <input xpath="company"/>
              <input xpath="operation"/>
              <input xpath="delivery"/>
              <input xpath="landingPage"/>
              <input xpath="fileImport"/>
              <orderBy>
                <node expr="@eventDate" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
        </container>
        <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="HasPackage('nms:social')">
          <input disableDefaultFilter="true" enumImage="@origin" hideEditButtons="true" nolabel="true" toolbarCaption="Digital identities" type="linklist" xpath="visitor" zoom="true">
            <input xpath="@name"/>
            <orderBy>
              <node expr="@name"/>
              <node expr="@lastModified" sortDesc="true"/>
            </orderBy>
            <sysFilter>
              <condition expr="@origin != 0 "/>
            </sysFilter>
          </input>
        </container>
      </container>
      <container img="nms:rcpgroup.png" label="Lists" name="group">
        <input choicePath="/tmp/choiceList" filterFormChoice="@deleteStatus = 0 and @type=0 and @schema='nms:recipient'" img="nms:rcpgroup.png" labelFormChoice="Add in the lists" newEntityFormChoice="true" nolabel="true" promptDeleteLabel="Do you want to remove the recipient from the selected lists?" selectionPath="/tmp/entityList" toolbarCaption="Lists to which the recipient belongs" type="linkList" xpath="rcpGrpRel" xpathChoiceTarget="rcpGroup" xpathEditTarget="rcpGroup" zoom="true">
          <sysFilter>
            <condition expr="[rcpGroup/@deleteStatus] = 0"/>
            <condition expr="[rcpGroup/@type] = 0"/>
            <condition expr="[rcpGroup/@schema] = 'nms:recipient'"/>
          </sysFilter>
          <enter name="add">
            <soapCall name="RegisterGroup" service="nms:recipient">
              <param exprIn="/tmp/choiceList" type="DOMElement"/>
              <param exprIn="/tmp/entityList" type="DOMElement"/>
              <param exprIn="'true'" type="boolean"/>
            </soapCall>
          </enter>
          <enter name="remove">
            <soapCall name="RegisterGroup" service="nms:recipient">
              <param exprIn="/tmp/choiceList" type="DOMElement"/>
              <param exprIn="/tmp/entityList" type="DOMElement"/>
              <param exprIn="'false'" type="boolean"/>
            </soapCall>
          </enter>
          <input type="string" xpath="rcpGroup/@label"/>
        </input>
      </container>
      <container img="nms:subscribe.png" label="Subscriptions" name="subscribe">
        <container type="notebook">
          <container applicableIf="HasPackage('crm:lead')=false" label="Active subscriptions">
            <input choicePath="/tmp/choiceList" form="nms:subscription" img="nms:subscribe.png" labelFormChoice="Select the services" newEntityFormChoice="true" nolabel="true" promptDeleteLabel="Do you want to delete selected subscriptions?" selectionPath="/tmp/entityList" toolbarCaption="Subscriptions of the recipient" type="serviceList" xpath="subscription" xpathChoiceTarget="service" zoom="true">
              <enter name="add">
                <soapCall name="RecipientSubscribe" service="nms:subscription">
                  <param exprIn="/tmp/entityList" type="DOMElement"/>
                  <param exprIn="/tmp/choiceList" type="DOMElement"/>
                  <param exprIn="'true'" type="boolean"/>
                  <param exprIn="[/tmp/sendMsg]" type="DOMElement"/>
                  <param type="DOMElement" xpathOut="/tmp/sendConfirmation"/>
                </soapCall>
              </enter>
              <enter name="remove">
                <soapCall name="RecipientSubscribe" service="nms:subscription">
                  <param exprIn="/tmp/entityList" type="DOMElement"/>
                  <param exprIn="/tmp/choiceList" type="DOMElement"/>
                  <param exprIn="'false'" type="boolean"/>
                  <param exprIn="[/tmp/sendMsg]" type="DOMElement"/>
                  <param type="DOMElement" xpathOut="/tmp/sendConfirmation"/>
                </soapCall>
              </enter>
              <input xpath="service/@label"/>
              <input xpath="@address"/>
              <input xpath="@emailFormat"/>
              <input xpath="@expirationDate"/>
              <input hidden="true" xpath="[@service-id]"/>
            </input>
          </container>
          <container applicableIf="HasPackage('crm:lead')=false" label="History">
            <input hideEditButtons="true" img="nms:histo.png" nolabel="true" toolbarCaption="History" type="linklist" xpath="subHisto">
              <input xpath="@date"/>
              <input xpath="recipient"/>
              <input xpath="@action"/>
            </input>
          </container>
          <container applicableIf="HasPackage('crm:lead')" label="Active subscriptions">
            <input choicePath="/tmp/choiceList" form="nms:subscription" hideEditButtons="true" img="nms:subscribe.png" labelFormChoice="Select the services" newEntityFormChoice="true" nolabel="true" selectionPath="/tmp/entityList" toolbarCaption="Subscriptions of the recipient" type="serviceList" xpath="subscription" xpathChoiceTarget="service" zoom="true">
              <input xpath="service/@label"/>
              <input xpath="@address"/>
              <input xpath="@emailFormat"/>
              <input xpath="@expirationDate"/>
              <input hidden="true" xpath="[@service-id]"/>
            </input>
          </container>
          <container applicableIf="HasPackage('crm:lead')" label="History">
            <input hideEditButtons="true" img="nms:histo.png" name="incomingLeadSub" nolabel="true" toolbarCaption="History" type="linklist" xpath="incomingLead">
              <input xpath="@eventDate"/>
              <input xpath="@type"/>
              <input xpath="service"/>
              <input label="Landing page service" xpath="[landingPage/service]"/>
              <sysFilter>
                <condition expr="@type='subscription' OR @type='unsubscription'"/>
              </sysFilter>
              <orderBy>
                <node expr="@eventDate" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
        </container>
      </container>
      <container img="nms:broadLog.png" label="Deliveries" name="delivery">
        <container type="notebook">
          <container label="Messages">
            <input enumImage="@status" hideEditButtons="true" img="nms:broadLog.png" nolabel="true" toolbarCaption="Recipient delivery logs" type="linklist" xpath="broadLog">
              <input size="14" xpath="@lastModified"/>
              <input size="20" xpath="@status"/>
              <input size="30" xpath="msg/@failureReason"/>
              <input size="25" xpath="delivery"/>
              <input xpath="msg/@text"/>
              <orderBy>
                <node expr="@lastModified" sortDesc="true"/>
              </orderBy>
              <sysFilter>
                <condition expr="[delivery/@deleteStatus] = 0"/>
              </sysFilter>
            </input>
          </container>
          <container label="Exclusions">
            <input hideEditButtons="true" img="nms:excludeLog.png" nolabel="true" toolbarCaption="Recipient exclusion logs" type="linklist" xpath="excludeLog">
              <input xpath="@lastModified"/>
              <input xpath="@status"/>
              <input xpath="msg/@failureReason"/>
              <input xpath="@address"/>
              <input xpath="msg/@text"/>
              <input label="Modification date" xpath="@lastModified"/>
              <orderBy>
                <node expr="@lastModified" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
        </container>
      </container>
      <container img="nms:tracking.png" label="Tracking" name="tracking">
        <container type="notebook">
          <container label="Tracking logs">
            <input hideEditButtons="true" img="nms:tracking.png" nolabel="true" toolbarCaption="Recipient's tracking logs" type="linklist" xpath="trackingLog">
              <input xpath="@logDate"/>
              <input xpath="url/@label"/>
              <input xpath="url/@type"/>
              <input xpath="delivery"/>
              <orderBy>
                <node expr="@logDate" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container applicableIf="HasPackage('nms:survey')" label="Surveys">
            <input delButton="true" form="nms:webAppLog" hideEditButtons="true" img="nms:survey.png" nolabel="true" toolbarCaption="Survey responses" type="linklist" xpath="webAppLog" zoom="true">
              <input xpath="@logDate"/>
              <input xpath="webApp"/>
              <input xpath="@score"/>
              <input xpath="@origin"/>
              <orderBy>
                <node expr="@logDate" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:coreInteraction')" img="nms:proposition.png" label="Propositions" name="proposition">
        <container type="notebook">
          <container label="Propositions" name="propositionHistory">
            <input hideEditButtons="true" img="nms:proposition.png" nolabel="true" toolbarCaption="Propositions of the recipient" type="linklist" xpath="proposition">
              <input size="20" xpath="offer"/>
              <input size="15" xpath="@eventDate"/>
              <input size="15" xpath="@lastModified"/>
              <input size="20" xpath="@status"/>
              <input size="20" xpath="offerSpace"/>
              <input size="25" xpath="broadLog/delivery"/>
              <orderBy>
                <node expr="@lastModified" sortDesc="true"/>
              </orderBy>
              <sysFilter>
                <condition expr="Coalesce([broadLog/delivery/@deleteStatus], 0) = 0"/>
              </sysFilter>
            </input>
          </container>
          <container applicableIf="HasPackage('nms:interaction')" label="Preview" name="preview">
            <container colcount="2">
              <input label="Propositions" type="number" xpath="/ignored/preview/@maxPropositionCount"/>
              <input label="Themes" xpath="/ignored/preview/@themes"/>
              <input createMode="none" label="Category" schema="nms:offerCategory" type="linkEdit" xpath="/ignored/preview/category">
                <enter name="onChange">
                  <set expr="[/ignored/preview/category]" xpath="/ignored/preview/category/@id"/>
                  <if expr="[/ignored/preview/category/@id] != '' and [/ignored/preview/category/@id] != 0">
                    <set value="nms:offerCategory" xpath="/ignored/queryDef/@schema"/>
                    <set value="GetOfferEnv(@id)" xpath="/ignored/queryDef/select/node[1]/@expr"/>
                    <set value="@env-id" xpath="/ignored/queryDef/select/node[1]/@alias"/>
                    <set value="@name" xpath="/ignored/queryDef/select/node[2]/@expr"/>
                    <set value="get" xpath="/ignored/queryDef/@operation"/>
                    <set expr="'@id='+[/ignored/preview/category/@id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                    <soapCall name="ExecuteQuery" service="xtk:queryDef">
                      <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                      <param type="DOMDocument" xpathOut="/ignored/cat"/>
                    </soapCall>
                    <set expr="[/ignored/cat/@env-id]" xpath="/ignored/preview/@env-id"/>
                  </if>
                  <if expr="[/ignored/preview/category/@id] = '' or [/ignored/preview/category/@id] = 0">
                    <set expr="0" xpath="/ignored/preview/@env-id"/>
                  </if>
                </enter>
                <sysFilter>
                  <condition expr="@model like 'nmsOfferCategory%' or @model like 'nmsOfferEnv%'"/>
                </sysFilter>
              </input>
              <input label="Space" schema="nms:offerSpace" type="linkEdit" xpath="/ignored/preview/@space-id">
                <sysFilter>
                  <condition enabledIf="$(/ignored/preview/@env-id) != '' and $(/ignored/preview/@env-id) != 0" expr="[@env-id] = $(/ignored/preview/@env-id)"/>
                </sysFilter>
              </input>
            </container>
            <input alwaysActive="true" forceNavigate="true" sessionToken="true" type="urlViewer" urlExpr="Iif([/ignored/preview/@space-id] != '', $(serverUrl) + '/webApp/interactionPreview?_decorate=0&amp;standalone=1&amp;space=' + [/ignored/preview/@space-id] + '&amp;target=' + @id + '&amp;count=' + [/ignored/preview/@maxPropositionCount] + '&amp;categories=' + [/ignored/cat/@name] + '&amp;themes=' + [/ignored/preview/@themes], '')"/>
          </container>
        </container>
      </container>
      <leave>
        <if expr="[/tmp/@folderId]!=0 AND [/tmp/@folderId]!=''">
          <set expr="[/tmp/@folderId]" xpath="@folder-id"/>
        </if>
        <check expr="[@folder-id]!=0">
          <error>The folder is not specified.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="nms:rcpgroup32.png" label="Recipients and Lists Wizard" md5="282F62106C3A4F05A2C8026E146F319A" name="recipientGroup" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="nms:registerSummary" xpath="@form"/>
        <set value="nms:recipientGroup" xpath="@editForm"/>
        <set value="registerGroup" xpath="@type"/>
        <set value="" xpath="@folder-id"/>
        <set translatedExpr="'Record in a list'" xpath="@label"/>
      </enter>
      <container desc="Please select the list in which recipients should be placed." title="Select list">
        <input dblClickAction="wizNext" folderFilterChoice="@model = 'nmsGroup'" monoSelection="true" newEntityFormChoice="true" schema="nms:group" selectionPath="userArgs/group/selection" setOnClick="true" type="linkListChoice" xpath="/group" xpathOut="/tmp">
          <input xpath="[/]"/>
          <sysFilter>
            <condition expr="@type = 0 and @schema='nms:recipient'"/>
          </sysFilter>
        </input>
        <leave>
          <check expr="[/tmp/group/@id] != ''">
            <error>You must specify a list.</error>
          </check>
        </leave>
      </container>
      <container desc="Click 'Start' to launch the job." maxLabelWidth="30" name="finish" title="Record in a list">
        <enter>
          <set value="0" xpath="properties/progress/@current"/>
          <set value="1" xpath="properties/progress/@max"/>
        </enter>
        <value fontBold="true" label="Record in a list" xpath="/tmp/group/@_cs"/>
        <input label="Recreate the list (optimized mode, but loses the previous content of the list)" nolabel="true" type="checkBox" xpath="userArgs/clearGroup"/>
        <input nolabel="true" useDesc="true" xpath="@doNotPersist"/>
        <container type="visibleGroup" visibleIf="!@doNotPersist">
          <input xpath="folderProcess">
            <sysFilter>
              <condition expr="@model = 'xtkJobInstance'"/>
            </sysFilter>
          </input>
        </container>
        <container type="jobProgressContainer">
          <soapCall name="RegisterGroup2" service="nms:recipient">
            <param exprIn="[/userArgs/group/selection]" type="DOMElement"/>
            <param exprIn="[/userArgs/recipients]" type="DOMElement"/>
            <param exprIn="[/userArgs/clearGroup]" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <leave>
        <check expr="[/tmp/@inProcess] = false">
          <error>Job in progress. Please cancel before you can quit.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="nms:service.png" label="Service subscription wizard" maxLabelWidth="60" md5="9685AAFF68B4412478BBDB844A30F643" name="recipientService" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="nms:registerSummary" xpath="@form"/>
        <set value="nms:recipientService" xpath="@editForm"/>
        <set value="registerService" xpath="@type"/>
        <set value="" xpath="@folder-id"/>
        <set translatedExpr="'Subscription on services'" xpath="@label"/>
      </enter>
      <container desc="Select the service to subscribe recipients to." title="Service choice">
        <input dblClickAction="wizNext" folderFilterChoice="@model = 'nmsSetOfServices'" monoSelection="true" newEntityFormChoice="true" schema="nms:service" selectionPath="userArgs/service/selection" setOnClick="true" type="linkListChoice" xpath="/service" xpathOut="/tmp">
          <input xpath="[/]"/>
        </input>
        <static label="Confirmation message" type="separator"/>
        <input label="Send a confirmation message" nolabel="true" type="checkbox" xpath="userArgs/sendMsg"/>
        <static label="Use this option to notify new service registrants with a confirmation message." type="help"/>
        <leave>
          <check expr="[/tmp/service/@id] != ''">
            <error>You must specify an information service.</error>
          </check>
        </leave>
      </container>
      <container desc="Click 'Start' to launch the job." name="finish" title="Service subscription">
        <enter>
          <set value="0" xpath="properties/progress/@current"/>
          <set value="1" xpath="properties/progress/@max"/>
        </enter>
        <value fontBold="true" label="Subscription to service" xpath="/tmp/service/@_cs"/>
        <input nolabel="true" useDesc="true" xpath="@doNotPersist"/>
        <container type="visibleGroup" visibleIf="!@doNotPersist">
          <input xpath="folderProcess">
            <sysFilter>
              <condition expr="@model = 'xtkJobInstance'"/>
            </sysFilter>
          </input>
        </container>
        <container type="jobProgressContainer">
          <soapCall name="RecipientSubscribe" service="nms:subscription">
            <param exprIn="[/userArgs/recipients]" type="DOMElement"/>
            <param exprIn="[/userArgs/service/selection]" type="DOMElement"/>
            <param exprIn="true" type="boolean"/>
            <param exprIn="[/userArgs/sendMsg]" type="DOMElement"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <leave>
        <check expr="[/tmp/@inProcess] = false">
          <error>Job in progress. Please cancel before you can quit.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:delivery" entitySchema="xtk:form" img="nms:pictotools.png" label="Update indicators" md5="1C0827487FBF009E64F368031742E5FD" name="recomputeStats" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="1" xpath="/tmp/@tr"/>
        <set value="new" xpath="/tmp/@trType"/>
        <set value="1" xpath="/tmp/@msg"/>
      </enter>
      <container desc="Please specify which indicators should be recomputed, and press 'Next' to start the update." title="Parameters">
        <container label="Action description" type="frame">
          <value xpath="@label"/>
          <value xpath="@deliveryCode"/>
          <input noZoom="true" readOnly="true" xpath="deliveryProvider"/>
          <input label="Folder" readOnly="true" xpath="folder"/>
          <value xpath="scheduling/@contactDate"/>
          <value xpath="scheduling/@validityDate"/>
        </container>
        <container label="Update" type="frame">
          <input label="Tracking indicators" type="checkbox" xpath="/tmp/@tr"/>
          <container enabledIf="[/tmp/@tr]" type="enabledGroup">
            <input checkedValue="new" label="Only take into account new tracking logs" type="radioButton" xpath="/tmp/@trType"/>
            <input checkedValue="all" label="Recompute all from the elementary tracking logs" type="radioButton" xpath="/tmp/@trType"/>
          </container>
          <input label="Message delivery indicators" type="checkbox" xpath="/tmp/@msg"/>
        </container>
        <static type="help">Click on 'Next' to start the update.</static>
        <leave>
          <set value="0" xpath="/tmp/@dirty"/>
          <if expr="[/tmp/@tr]">
            <set value="1" xpath="/tmp/@dirty"/>
            <if expr="[/tmp/@trType]='all'">
              <set expr="[/tmp/@dirty]+3" xpath="/tmp/@dirty"/>
            </if>
          </if>
          <if expr="[/tmp/@msg]">
            <set expr="[/tmp/@dirty]+8" xpath="/tmp/@dirty"/>
          </if>
          <soapCall name="RecomputeStats" service="nms:delivery">
            <param exprIn="@id" type="int"/>
            <param exprIn="[/tmp/@dirty]" type="byte"/>
          </soapCall>
        </leave>
      </container>
      <container desc="Update completed" title="End">
        <value xpath="@label"/>
        <value xpath="@deliveryCode"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="xtk:form.png" md5="5C01DBB82AC971DE08AF93E70C14BA7F" name="registerSummary" namespace="nms" xtkschema="xtk:form">
      <input xpath="@label"/>
      <value fontBold="true" xpath="@jobType"/>
      <input readOnly="true" xpath="@status"/>
      <value xpath="@startDate"/>
      <value xpath="@duration"/>
      <value xpath="@endDate"/>
      <value colspan="2" xpath="desc"/>
      <value colspan="2" type="ProgressBar" xpathCur="properties/progress/@current" xpathMax="properties/progress/@max"/>
      <input colspan="2" hideEditButtons="true" nolabel="true" toolbarCaption="Messages" type="linkList" xpath="log">
        <input xpath="@logDate"/>
        <input xpath="@message"/>
        <orderBy>
          <node expr="@logDate"/>
        </orderBy>
      </input>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="xtk:none" entitySchema="xtk:form" img="xtk:form.png" label="Reports" md5="D5B696B1B4746EFE3DC574707856D470" name="report" namespace="nms" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <input sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/xtk/report.jssp?_context=selection&amp;_schema='+[/ignored/@schema]+'&amp;_selection='+[/ignored/@id]"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entitySchema="xtk:form" img="xtk:form.png" md5="87F5E1C4BD19CD96588DFCEEB869B3E2" name="ruleSet" namespace="nms" xtkschema="xtk:form">
      <input xpath="@label"/>
      <input xpath="@name"/>
      <input xpath="@mode"/>
      <input xpath="@active"/>
      <container colspan="2" type="visibleGroup" visibleIf="@mode &lt; Eval(@mode, 'domain')">
        <input img="xtk:calculate.png" nolabel="true" toolbarCaption="Rules" type="list" xpath="rule" zoom="true">
          <input xpath="@name"/>
          <input xpath="@failureReason"/>
          <input xpath="@failureType"/>
          <form colcount="2" label="Rule detail">
            <input xpath="@name"/>
            <input xpath="@active"/>
            <input xpath="@failureReason"/>
            <input xpath="@failureType"/>
            <container colspan="2">
              <static label="Forward inbound email" type="separator"/>
              <input xpath="@forward"/>
              <container type="visibleGroup" visibleIf="@forward">
                <input xpath="@forwardAddress"/>
              </container>
              <static type="help">When this rule applies, you can request the message to be sent to a specific mailbox. \nBy default, if you do not define a specific forward address, the message will be forwarded to the forward address defined in the delivery action originating the non-deliverable.</static>
            </container>
            <container colspan="2">
              <static label="Rule code" type="separator"/>
              <input nolabel="true" type="jstEdit" xpath="text"/>
            </container>
          </form>
        </input>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="EV(@mode, 'domain')">
        <input img="xtk:calculate.png" nolabel="true" toolbarCaption="Rules" type="list" xpath="domainRule" zoom="true">
          <input xpath="@mask"/>
          <input xpath="@senderID"/>
          <input xpath="@domainKeys"/>
          <input xpath="@dkim"/>
          <input xpath="@smime"/>
          <input xpath="@relayAddress"/>
          <input xpath="@relayPort"/>
          <form label="Domain rule detail">
            <input xpath="@mask"/>
            <input nolabel="true" type="treeEdit">
              <container label="SMTP parameters">
                <input xpath="@senderID"/>
                <input xpath="@domainKeys"/>
                <input xpath="@dkim"/>
                <input xpath="@smime"/>
                <input xpath="@relayAddress"/>
                <input xpath="@relayPort"/>
              </container>
            </input>
          </form>
        </input>
        <static type="warning">The MTA must be restarted for changes to be taken into account.</static>
      </container>
      <container colspan="2" type="visibleGroup" visibleIf="EV(@mode, 'mx')">
        <input img="xtk:calculate.png" label="Rules" nolabel="true" toolbarCaption="Rules" type="list" xpath="MXRule" zoom="true">
          <input xpath="@mask"/>
          <input xpath="@publicIds"/>
          <input xpath="@shared"/>
          <input xpath="@maxConnections"/>
          <input xpath="@maxMessages"/>
          <input xpath="@maxMessagesPerHour"/>
          <form label="Detail of the MX rule" maxLabelWidth="50">
            <input xpath="@mask"/>
            <input xpath="@publicIds"/>
            <container label="Throttling">
              <input xpath="@shared"/>
              <input xpath="@maxConnections"/>
              <input xpath="@maxMessages"/>
              <input xpath="@maxMessagesPerHour"/>
            </container>
            <container label="SMTP parameters">
              <input xpath="@connectionTimeout"/>
              <input xpath="@dataTimeout"/>
              <input xpath="@timeout"/>
            </container>
          </form>
        </input>
        <static type="warning">The statistics server must be restarted for changes to be taken into account.</static>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Service" md5="C6F17D836082D21C3AC2F75E916DE00C" name="service" namespace="nms" xpathsToLoadOpt="mobileAppsTargetMapping,mobileAppsTargetMapping/@id,mobileAppsTargetMapping/@schema,mobileAppsTargetMapping/@targetSchema,mobileAppsTargetMapping/storage/@trackingLogSchema,mobileAppsTargetMapping/storage/@broadLogSchema" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/ignored/@socialMessage"/>
        <if expr="HasPackage('nms:social')">
          <set expr="iif (EV(@type, 'facebook', 'twitter'), 1, 0)" xpath="/ignored/@socialMessage"/>
        </if>
        <set value="0" xpath="/ignored/@mobileApp"/>
        <if expr="HasPackage('nms:mobileApp')">
          <copyElement xpathDst="/tmp/targetMappingSelected" xpathSrc="mobileAppsTargetMapping"/>
          <set expr="iif(EV(@type, 'mobileApp'), 1, 0)" xpath="/ignored/@mobileApp"/>
        </if>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container colcount="2" name="properties">
          <input xpath="@label"/>
          <input xpath="@name"/>
          <input xpath="@type">
            <enter name="onChange">
              <if expr="HasPackage('nms:social')">
                <set expr="iif (EV(@type, 'facebook', 'twitter'), 1, 0)" xpath="/ignored/@socialMessage"/>
              </if>
              <if expr="HasPackage('nms:mobileApp')">
                <set expr="iif(EV(@type, 'mobileApp'), 1, 0)" xpath="/ignored/@mobileApp"/>
                <if expr="[/ignored/@mobileApp]=1">
                  <reset xpath="/ignored/queryDef"/>
                  <set value="nms:deliveryMapping" xpath="/ignored/queryDef/@schema"/>
                  <set value="@name='mapAppSubscriptionRcp'" xpath="/ignored/queryDef/where/condition/@expr"/>
                  <set value="getIfExists" xpath="/ignored/queryDef/@operation"/>
                  <set value="@id" xpath="/ignored/queryDef/select/node[1]/@expr"/>
                  <set value="[.]" xpath="/ignored/queryDef/select/node[2]/@expr"/>
                  <set value="@schema" xpath="/ignored/queryDef/select/node[3]/@expr"/>
                  <set value="@targetSchema" xpath="/ignored/queryDef/select/node[4]/@expr"/>
                  <set value="[storage/@broadLogSchema]" xpath="/ignored/queryDef/select/node[5]/@expr"/>
                  <set value="[storage/@trackingLogSchema]" xpath="/ignored/queryDef/select/node[6]/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="mobileAppsTargetMapping"/>
                  </soapCall>
                  <set expr="[mobileAppsTargetMapping/@id]" xpath="@mobileAppsTargetMapping-id"/>
                  <copyElement xpathDst="/tmp/targetMappingSelected" xpathSrc="mobileAppsTargetMapping"/>
                </if>
              </if>
            </enter>
          </input>
          <container applicableIf="HasPackage('nms:mobileApp')" type="visibleGroup" visibleIf="[/ignored/@mobileApp]=1">
            <input computeStringAlias="@_cs" createMode="none" label="Target mapping" notifyPathList="@_cs|@_cs,@schema|@schema,@id|@id,@targetSchema,storage/@broadLogSchema,storage/@trackingLogSchema" schema="nms:deliveryMapping" type="linkEdit" xpath="/tmp/targetMappingSelected">
              <enter name="onChange">
                <if expr="[/tmp/targetMappingSelected/@id] != [mobileAppsTargetMapping/@id]">
                  <msgBox focusOn="no" translatedExpr="'Are you sure you want to change the targeting dimension? All additional settings of mobile application subscription web services will be reset'" type="yesno" xpathOut="/tmp/@resMsgBoxChangeTargetMapping"/>
                  <if expr="[/tmp/@resMsgBoxChangeTargetMapping]='yes'">
                    <soapCall name="resetServiceMobileAppsCustomHook" service="nms:mobileApp">
                      <param exprIn="[/service/]" type="DOMElement"/>
                      <param type="DOMElement" xpathOut="/service"/>
                    </soapCall>
                    <copyElement xpathDst="mobileAppsTargetMapping" xpathSrc="/tmp/targetMappingSelected"/>
                    <set expr="[/tmp/targetMappingSelected/@id]" xpath="@mobileAppsTargetMapping-id"/>
                  </if>
                  <if expr="[/tmp/@resMsgBoxChangeTargetMapping]='no'">
                    <copyElement xpathDst="/tmp/targetMappingSelected" xpathSrc="mobileAppsTargetMapping"/>
                  </if>
                </if>
              </enter>
            </input>
          </container>
          <container type="visibleGroup" visibleIf="@type=0">
            <input xpath="@mode"/>
          </container>
          <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="@type=25">
            <input xpath="social/@syncSubscription"/>
          </container>
          <container type="visibleGroup" visibleIf="@type!=0 and @type!=25 and [/ignored/@mobileApp]!=1">
            <static/>
          </container>
          <container applicableIf="HasPackage('nms:social')" colspan="2" type="visibleGroup" visibleIf="@type=25 and [social/@syncSubscription]=true">
            <input xpath="visitorFolder">
              <sysFilter>
                <condition expr="@isView=0 and  @model='nmsVisitor'"/>
              </sysFilter>
            </input>
            <static label=" " nolabel="false" type="help">Subscribers will be synchronized in this folder</static>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="[/tmp/@folderId]=0">
            <input createMode="none" label="Folder" xpath="folder">
              <sysFilter>
                <condition expr="@isView = 0 and  @model = 'nmsSetOfServices'"/>
              </sysFilter>
            </input>
          </container>
          <container applicableIf="HasPackage('crm:lead')" colspan="2" type="visibleGroup" visibleIf="[/ignored/@socialMessage]!=1 AND [/ignored/@mobileApp]!=1">
            <static label="Subscription management" type="separator"/>
            <input xpath="@isPublic"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@mode=0 and @type!=20 AND @type!=25 AND [/ignored/@mobileApp]!=1">
            <static colspan="2" label="Subscriptions with an expiration date" type="separator"/>
            <input xpath="@unlimited"/>
            <container type="visibleGroup" visibleIf="!@unlimited">
              <input xpath="@validityDuration"/>
            </container>
            <container type="visibleGroup" visibleIf="@unlimited">
              <static/>
            </container>
            <container colspan="2" label="Confirmation messages" type="frame">
              <input choiceButton="true" folderFilterChoice="@model = 'nmsDeliveryModel'" label="Subscription" newEntityFormChoice="true" xpath="subScenario">
                <sysFilter>
                  <condition expr="@isModel = 1"/>
                  <condition expr="[mapping/@schema] = 'nms:subscription'"/>
                </sysFilter>
                <orderBy>
                  <node expr="@label"/>
                </orderBy>
              </input>
              <input choiceButton="true" folderFilterChoice="@model = 'nmsDeliveryModel'" label="Unsubscription" newEntityFormChoice="true" xpath="unsubScenario">
                <sysFilter>
                  <condition expr="@isModel = 1"/>
                  <condition expr="[mapping/@schema] = 'nms:subscription'"/>
                </sysFilter>
                <orderBy>
                  <node expr="@label"/>
                </orderBy>
              </input>
            </container>
          </container>
          <container colspan="2" type="visibleGroup" visibleIf="@mode=1 and [/ignored/@socialMessage]!=1 AND [/ignored/@mobileApp]!=1">
            <static label="Messages to deliver to the referee" type="separator"/>
            <input choiceButton="true" createMode="none" folderFilterChoice="@model = 'nmsDeliveryModel'" label="Delivery template" xpath="subScenario">
              <sysFilter>
                <condition expr="@isModel = 1"/>
                <condition expr="[mapping/@schema] = 'nms:subscription'"/>
              </sysFilter>
              <orderBy>
                <node expr="@label"/>
              </orderBy>
            </input>
          </container>
          <container applicableIf="HasPackage('nms:social')" colcount="2" colspan="2" type="visibleGroup" visibleIf="EV(@type, 'twitter')">
            <container colcount="2" colspan="2" label="Application parameters" type="frame">
              <value label="Account name" xpath="@name"/>
              <static type="help">Enter the internal name to change this value</static>
              <input label="Consumer key" xpath="social/@consumerKey"/>
              <static type="help">oauth_consumer_key</static>
              <input label="Consumer secret" reversible="true" type="passwordEdit" xpath="social/@consumerSecret"/>
              <static type="help">oauth_consumer_secret</static>
              <input xpath="social/@accessToken"/>
              <static type="help">oauth_token</static>
              <input reversible="true" type="passwordEdit" xpath="social/@accessTokenSecret"/>
              <static type="help">oauth_token_secret</static>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:mobileApp')" colcount="2" colspan="2" margin-right="3" type="visibleGroup" visibleIf="[/ignored/@mobileApp]=1">
            <static colspan="2" label="List of the mobile applications that use the service" type="separator"/>
            <input colspan="2" editable="false" enumImage="@pushPlatform" formOnAdd="nms:newMobileApp" nolabel="true" type="list" xpath="mobileApp" zoom="true" zoomOnAdd="true">
              <input xpath="[.]"/>
              <input xpath="@pushPlatform"/>
              <form label="Application parameters" xpath="." xpathsToLoad="@id,@certificate,@sandbox,callbackRegisterInfos/additionalNodesAssociation/*,callbackRegisterInfos/@advancedMode,notificationCustomFields/*,notificationSounds/*,certificateFile/*">
                <enter>
                  <set expr="[callbackRegisterInfos/@advancedMode]" xpath="/tmp/newMobileApp/@advancedMode"/>
                  <reset xpath="/tmp/newMobileApp/additionalRegisterFields"/>
                  <copyElement xpathDst="/tmp/newMobileApp/additionalRegisterFields" xpathSrc="callbackRegisterInfos/additionalNodesAssociation"/>
                  <reset xpath="/tmp/newMobileApp/notificationCustomFields"/>
                  <copyElement xpathDst="/tmp/newMobileApp/notificationCustomFields" xpathSrc="notificationCustomFields"/>
                  <reset xpath="/tmp/newMobileApp/notificationSounds"/>
                  <copyElement xpathDst="/tmp/newMobileApp/notificationSounds" xpathSrc="notificationSounds"/>
                  <set value="0" xpath="/tmp/newMobileApp/@fromWizard"/>
                </enter>
                <container type="notebook">
                  <container ref="nms:newMobileApp:lib/information" xpath="."/>
                  <container ref="nms:newMobileApp:lib/registrationParams" xpath="."/>
                  <container ref="nms:newMobileApp:lib/sounds" xpath="."/>
                  <container ref="nms:newMobileApp:lib/certificateMgt" visibleIf="EV(@pushPlatform, 'apns')" xpath="."/>
                </container>
                <leave ref="nms:newMobileApp:lib/leaveInfo"/>
              </form>
            </input>
            <static colspan="2" label="To subscribe to a service, users install the applications detailed above on their mobiles." type="help"/>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="desc"/>
        </container>
      </container>
      <input expr="iif(@type=40, 1, 0)" type="expr" xpath="/ignored/@mobileApp"/>
      <input expr="iif(@type=20 OR @type=25, 1, 0)" type="expr" xpath="/ignored/@socialMessage"/>
      <container type="visibleGroup" visibleIf="[/tmp/@newService]=1">
        <container ref="nms:service:lib/properties"/>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@newService]!=1">
        <container type="notebook">
          <container img="nms:setofservices.png" label="Dashboard">
            <input addSelectionInPost="true" entityRefresh="nms:service" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/nms/service.jssp?id='+@id+'&amp;standalone=1'"/>
          </container>
          <container img="xtk:form.png" label="Edit" visibleIf="@id!=0">
            <container type="visibleGroup" visibleIf="[/ignored/@socialMessage]!=1 AND [/ignored/@mobileApp]!=1">
              <container ref="nms:service:lib/properties"/>
            </container>
            <container applicableIf="HasPackage('nms:social') OR HasPackage('nms:mobileApp')" type="visibleGroup" visibleIf="[/ignored/@socialMessage]=1 OR [/ignored/@mobileApp]=1">
              <container type="iconbox">
                <container img="xtk:properties.png" label="General" ref="nms:service:lib/properties"/>
                <container applicableIf="HasPackage('nms:social')" img="nms:broadLog.png" label="Deliveries" visibleIf="[/ignored/@socialMessage]=1">
                  <input enumImage="@status" hideEditButtons="true" img="nms:broadLog.png" nolabel="true" toolbarCaption="Delivery logs" type="linklist" xpath="broadLogSvc">
                    <input size="14" xpath="@lastModified"/>
                    <input size="20" xpath="@status"/>
                    <input size="30" xpath="msg/@failureReason"/>
                    <input size="25" xpath="delivery"/>
                    <input xpath="msg/@text"/>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                    <sysFilter>
                      <condition expr="[delivery/@deleteStatus] = 0"/>
                    </sysFilter>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:mobileApp')" img="nms:broadLog.png" label="Deliveries" visibleIf="[/ignored/@mobileApp]=1">
                  <input enumImage="@status" hideEditButtons="true" img="nms:broadLog.png" name="broadLogAppSub" nolabel="true" refresh="true" toolbarCaption="Delivery logs" type="dynamicLinkList" xpath="." xpathObjectSchema="/tmp/targetMappingSelected/@targetSchema" xpathSchema="/tmp/targetMappingSelected/storage/@broadLogSchema">
                    <input xpath="@lastModified"/>
                    <input xpath="@status"/>
                    <input xpath="msg/@failureReason"/>
                    <input xpath="delivery"/>
                    <input xpath="msg/@text"/>
                    <input xpathObjectSchema="/tmp/targetMappingSelected/@targetSchema"/>
                    <input xpath="[appSubscription/mobileApp]"/>
                    <orderBy>
                      <node expr="@lastModified" sortDesc="true"/>
                    </orderBy>
                    <sysFilter>
                      <condition expr="[delivery/@deleteStatus] = 0"/>
                    </sysFilter>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:social')" img="nms:tracking.png" label="Tracking" visibleIf="[/ignored/@socialMessage]=1">
                  <input hideEditButtons="true" img="nms:tracking.png" nolabel="true" toolbarCaption="Tracking logs" type="linklist" xpath="trackingLogSvc">
                    <input xpath="@logDate"/>
                    <input xpath="url/@label"/>
                    <input xpath="url/@type"/>
                    <input xpath="delivery"/>
                    <orderBy>
                      <node expr="@logDate" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:mobileApp')" img="nms:tracking.png" label="Tracking" visibleIf="[/ignored/@mobileApp]=1">
                  <input hideEditButtons="true" img="nms:tracking.png" name="trackingLogAppSub" nolabel="true" toolbarCaption="Tracking logs" type="dynamicLinkList" xpath="." xpathObjectSchema="/tmp/targetMappingSelected/@targetSchema" xpathSchema="/tmp/targetMappingSelected/storage/@trackingLogSchema">
                    <input xpath="@logDate"/>
                    <input xpath="url/@label"/>
                    <input xpath="url/@type"/>
                    <input xpath="delivery"/>
                    <input xpath="[appSubscription/mobileApp]"/>
                    <input xpathObjectSchema="/tmp/targetMappingSelected/@targetSchema"/>
                    <orderBy>
                      <node expr="@logDate" sortDesc="true"/>
                    </orderBy>
                    <sysFilter>
                      <condition expr="[broadLog/@service-id]=$(@id)"/>
                    </sysFilter>
                  </input>
                </container>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:social')" img="nms:twitter.png" label="Twitter page" visibleIf="EV(@type, 'twitter')">
            <input label="Image" noBorder="true" type="urlViewer" urlExpr="'http://twitter.com/' + @name"/>
          </container>
          <container applicableIf="HasPackage('nms:social')" img="nms:facebook.png" label="Facebook page" visibleIf="EV(@type, 'facebook')">
            <input label="Image" noBorder="true" type="urlViewer" urlExpr="[social/@externalUrl]"/>
          </container>
          <container img="nms:subscribe.png" label="Subscriptions" name="subscribe" visibleIf="[/ignored/@socialMessage]!=1 and @id!=0 AND [/ignored/@mobileApp]!=1">
            <container style="flat" type="notebook">
              <container label="Active subscriptions">
                <input choicePath="/tmp/choiceList" form="nms:subscription" img="nms:subscribe.png" labelFormChoice="Select recipients" nolabel="true" promptDeleteLabel="Do you want to delete selected subscriptions?" selectionPath="/tmp/entityList" type="serviceList" xpath="subscription" xpathChoiceTarget="recipient" xpathColumns="@account, @firstName, @lastName, @email, @mobilePhone" zoom="true">
                  <enter name="add">
                    <soapCall name="RecipientSubscribe" service="nms:subscription">
                      <param exprIn="/tmp/choiceList" type="DOMElement"/>
                      <param exprIn="/tmp/entityList" type="DOMElement"/>
                      <param exprIn="'true'" type="boolean"/>
                      <param exprIn="[/tmp/sendMsg]" type="DOMElement"/>
                      <param type="DOMElement" xpathOut="/tmp/sendConfirmation"/>
                    </soapCall>
                  </enter>
                  <enter name="remove">
                    <soapCall name="RecipientSubscribe" service="nms:subscription">
                      <param exprIn="/tmp/choiceList" type="DOMElement"/>
                      <param exprIn="/tmp/entityList" type="DOMElement"/>
                      <param exprIn="'false'" type="boolean"/>
                      <param exprIn="[/tmp/sendMsg]" type="DOMElement"/>
                      <param type="DOMElement" xpathOut="/tmp/sendConfirmation"/>
                    </soapCall>
                  </enter>
                  <input xpath="@created"/>
                  <input xpath="recipient/@firstName"/>
                  <input xpath="recipient/@lastName"/>
                  <input xpath="@address"/>
                  <input xpath="@emailFormat"/>
                  <input xpath="@expirationDate"/>
                </input>
              </container>
              <container label="History">
                <input hideEditButtons="true" img="nms:histo.png" nolabel="true" toolbarCaption="History of service subscription" type="linklist" xpath="subHisto">
                  <input xpath="@date"/>
                  <input xpath="recipient"/>
                  <input xpath="@action"/>
                </input>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:social')" img="nms:subscribe.png" label="Subscriptions" visibleIf="[/ignored/@socialMessage]=1 and @id!=0 AND [/ignored/@mobileApp]!=1">
            <input hideEditButtons="true" img="nms:subscribe.png" nolabel="true" toolbarCaption="Visitor subscriptions" type="linklist" xpath="visitorSub" xpathEditTarget="visitor" zoom="true">
              <input xpath="visitor"/>
              <input xpath="[visitor/@friendCount]"/>
            </input>
          </container>
          <container applicableIf="HasPackage('nms:mobileApp')" img="nms:subscribe.png" label="Subscriptions" visibleIf="[/ignored/@mobileApp]=1 AND @id!=0 AND [/ignored/@socialMessage]!=1">
            <input enumImage="@type" hideEditButtons="true" img="nms:subscribe.png" nolabel="true" toolbarCaption="Applications subscribed to the service" type="dynamicLinkList" xpath="." xpathSchema="/tmp/targetMappingSelected/@schema">
              <input xpath="mobileApp"/>
              <input label="Terminal name" xpath="device/@deviceName"/>
              <input xpath="@registrationDate"/>
              <input xpath="@registrationToken"/>
              <input xpath="@userKey"/>
              <input xpath="@disabled"/>
              <input xpath="@disabledDate"/>
            </input>
          </container>
          <container applicableIf="HasPackage('nms:social')" img="xtk:comment.png" label="Comments" visibleIf="EV(@type, 'facebook')">
            <input hideEditButtons="true" nolabel="true" type="linklist" xpath="interestComment">
              <input xpath="interestCommentPosted/@publishTime"/>
              <input xpath="interestCommentPosted/visitor"/>
              <input xpath="@label"/>
              <input xpath="delivery"/>
            </input>
          </container>
        </container>
      </container>
      <leave>
        <if expr="[/tmp/@folderId]!=0 AND [/tmp/@folderId]!=''">
          <set expr="[/tmp/@folderId]" xpath="@folder-id"/>
        </if>
        <check expr="[@folder-id]!=0">
          <error>The folder is not specified.</error>
        </check>
        <set value="0" xpath="/tmp/@newService"/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form editionMode="dialog" entitySchema="xtk:form" img="xtk:form.png" label="Subscription" md5="991EA64CD66C3665DADC08D4454BDEB2" name="subscription" namespace="nms" xtkschema="xtk:form">
      <container label="Subscription" type="frame">
        <input readOnly="true" xpath="service"/>
        <input readOnly="true" xpath="recipient"/>
        <input xpath="@addressSpecific"/>
        <container type="visibleGroup" visibleIf="EV([service/@type], 'mail')">
          <input xpath="@emailFormat"/>
        </container>
        <input xpath="@expirationDate"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Tracking URLs" md5="6131EF45DC19B16EEF61683A6288959F" name="trackingUrl" namespace="nms" type="notebook" xtkschema="xtk:form">
      <container colcount="2" img="xtk:properties.png" label="General">
        <container colcount="2" colspan="2">
          <input colspan="2" xpath="@label"/>
          <input xpath="@type"/>
          <input readOnly="true" xpath="@tagId"/>
          <input colspan="2" readOnly="true" xpath="@source"/>
          <input colspan="2" readOnly="true" xpath="delivery"/>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[@folder-id]!=0">
            <input colspan="2" readOnly="true" xpath="folder"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Web application" md5="D490911C3F51C0B619BBA8FB2E6EA954" name="webApp" namespace="nms" xpathsToLoad="@entitySchema,rendering/**,operator,operator/@name,folderProcess,folder" xpathsToLoadOpt="deliveryMapping,deliveryMapping/@id,@targetSchema,defaultOrigin,defaultOrigin/@id,socialAccount,socialAccount/@id,socialAccount/params/oauthParams/@xFacebookPerms,defaultDictionary" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/ignored/@hasSurvey"/>
        <set value="0" xpath="/ignored/@hasPurl"/>
        <set value="0" xpath="/ignored/@hasLead"/>
        <set value="0" xpath="/ignored/@hasSocial"/>
        <set value="" xpath="/ignored/@archivedFieldSchemaEdit"/>
        <if expr="HasPackage('crm:lead')">
          <set expr="[/webApp/facet/@lead]" xpath="/ignored/@hasLead"/>
        </if>
        <if expr="HasPackage('nms:survey')">
          <set expr="[/webApp/facet/@survey]" xpath="/ignored/@hasSurvey"/>
        </if>
        <if expr="HasPackage('nms:purl')">
          <set expr="[/webApp/facet/@purl]" xpath="/ignored/@hasPurl"/>
          <set value="1" xpath="/tmp/@hideMicrositeInPURLFilter"/>
        </if>
        <if expr="HasPackage('nms:social')">
          <set expr="[facet/@social]" xpath="/ignored/@hasSocial"/>
        </if>
        <reset xpath="/ignored/translationStats"/>
        <soapCall name="GetUsedLanguagesEnum" service="nms:webApp">
          <param exprIn="@designLanguage" type="string"/>
          <param exprIn="@defaultLanguage" type="string"/>
          <param exprIn="additionalLanguages" type="DOMElement"/>
          <param type="DOMElement" xpathOut="/ignored/langs"/>
        </soapCall>
        <set expr="[/webApp/@id]" xpath="/tmp/ctxForm/keys/key/@value"/>
        <set value="web" xpath="/ignored/source/@target"/>
        <reset xpath="/ignored/source/@version"/>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <form label="Page" maxLabelWidth="50" name="htmlPage">
          <container style="flat" type="notebook">
            <container label="Editor">
              <input mode="webApp" toolbar="true" type="digitalContentEditor" xpath="content" xpathSchema="/webApp/@schema" xpathTransitions="transitions">
                <form label="Publishing resources" nothingToEdit="true" nothingToSave="true">
                  <container name="localResourcesUploader" type="localResourcesUploader" xpathCurProgress="/tmp/@uploadCurrent" xpathFilesToDownload="/tmp/localResources" xpathMaxProgress="/tmp/@uploadMax">
                    <input name="JobLogsList" type="JobLogList"/>
                    <container colcount="2">
                      <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/tmp/@uploadCurrent" xpathMax="/tmp/@uploadMax"/>
                    </container>
                  </container>
                  <leave>
                    <set value="true" xpath="/tmp/@uploadImages"/>
                  </leave>
                </form>
              </input>
            </container>
            <container label="Source">
              <input fullToolbar="true" nolabel="true" type="htmlSource" xpath="content"/>
            </container>
            <container label="Properties">
              <input xpath="@label"/>
              <static label="Outbound transitions" type="separator"/>
              <input label="Enable outbound transitions" xpath="transitions/next/@enabled"/>
              <container type="visibleGroup" visibleIf="[transitions/next/@enabled]">
                <input editable="true" label=" " type="list" xpath="transitions/next">
                  <input xpath="@name"/>
                  <input xpath="@label"/>
                </input>
              </container>
              <static label="Tracking tags" type="separator"/>
              <input label=" " type="list" xpath="tracker">
                <input xpath="@label"/>
                <input required="true" xpath="@name"/>
                <input required="true" xpath="@goal"/>
                <input required="true" xpath="@step"/>
              </input>
            </container>
          </container>
        </form>
        <form label="Access control" maxLabelWidth="50" name="accessControl">
          <container type="notebook">
            <container label="Behavior">
              <input xpath="@label"/>
              <static label="Access Management" type="separator"/>
              <input label="Selection mode" xpath="@authorization"/>
              <container type="visibleGroup" visibleIf="EV(@authorization, 'list')">
                <input createMode="none" img="nms:rcpgroup.png" xpath="controlList">
                  <sysFilter>
                    <condition expr="@schema=$(../../@schema)"/>
                  </sysFilter>
                </input>
                <input checkedValue="false" label="Only authorize contacts from this list" type="radiobutton" xpath="@exclusion"/>
                <input checkedValue="true" label="Exclude contacts from this list" type="radiobutton" xpath="@exclusion"/>
              </container>
              <static label="Browsing" type="separator"/>
              <input label="Disallow returning to the previous page" xpath="@disablePreviousButton"/>
              <input label="Enable the guest to skip this step" xpath="transitions/anonymous/@enabled"/>
            </container>
            <container label="View">
              <input label="Page title" xpath="@label"/>
              <container colspan="2" style="flat" type="notebook">
                <container label="Page header and footer">
                  <static label="Header" type="separator"/>
                  <input nolabel="true" type="dhtml" xpath="header"/>
                  <static label="Page footer" type="separator"/>
                  <input nolabel="true" type="dhtml" xpath="footer"/>
                </container>
                <container label="Texts">
                  <input editable="true" nolabel="true" type="list" xpath="strings/string">
                    <input xpath="@id"/>
                    <input label="Text" xpath="@value"/>
                  </input>
                  <static type="help">Text created here can be used in the HTML by using the following syntax &lt;%= $(IDENTIFIANT) %&gt;.</static>
                </container>
              </container>
            </container>
          </container>
        </form>
        <form label="Access control" maxLabelWidth="50" name="accessControlSocial">
          <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="true">
            <input xpath="@label"/>
            <input createMode="none" img="nms:miniatures/mini-accessControl.png" type="linkedit" xpath="../../socialAccount">
              <sysFilter>
                <condition expr="@type = 9"/>
              </sysFilter>
            </input>
          </container>
        </form>
        <form label="Facebook acquisition" maxLabelWidth="50" name="facebookAcquisition">
          <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="true">
            <input xpath="@label"/>
          </container>
        </form>
        <container name="palette">
          <container img="nms:dedit.png" label="Common" name="base">
            <input img="xtk:miniatures/mini-start.png" xpath="start"/>
            <input img="nms:miniatures/mini-prefill.png" xpath="prefill"/>
            <input img="nms:miniatures/mini-survey.png" xpath="htmlPage"/>
            <input img="xtk:miniatures/mini-condition.png" xpath="test"/>
            <input img="nms:miniatures/mini-writer.png" xpath="writer"/>
            <input img="xtk:miniatures/mini-end.png" xpath="end"/>
            <input applicableIf="HasPackage('nms:purl') and HasPackage('nms:social')" img="nms:miniatures/mini-accessControl.png" visibleIf="[facet/@purl]" xpath="accessControl"/>
            <input applicableIf="HasPackage('nms:purl') and HasPackage('nms:social')" img="nms:miniatures/mini-accessControl.png" visibleIf="[facet/@social] and ([facet/@purl]=false or [facet/@purl]=0)" xpath="accessControlSocial"/>
            <input applicableIf="HasPackage('nms:purl') and HasPackage('nms:social') = false" img="nms:miniatures/mini-accessControl.png" visibleIf="[facet/@purl]" xpath="accessControl"/>
            <input applicableIf="HasPackage('nms:social') and HasPackage('nms:purl') = false" img="nms:miniatures/mini-accessControl.png" visibleIf="[facet/@social]" xpath="accessControlSocial"/>
            <input applicableIf="HasPackage('nms:social')" img="nms:miniatures/mini-fbdata.png" visibleIf="[facet/@social]" xpath="facebookAcquisition"/>
          </container>
          <container img="xtk:workflow16x16.png" label="Advanced" name="advanced">
            <input img="nms:miniatures/mini-page.png" xpath="page"/>
            <input img="nms:miniatures/mini-query.png" visibleIf="[facet/@advanced]" xpath="query"/>
            <input img="xtk:miniatures/mini-script.png" xpath="script"/>
            <input img="nms:miniatures/mini-jump.png" xpath="jump"/>
          </container>
        </container>
        <container name="subforms" xpath=".">
          <form name="start" ref="xtk:formlib:subforms/start"/>
          <form name="next" ref="xtk:formlib:subforms/next"/>
          <form name="page" ref="xtk:formlib:subforms/page"/>
          <form name="htmlPage" ref="nms:webApp:lib/htmlPage"/>
          <form name="test" ref="xtk:formlib:subforms/test"/>
          <form name="script" ref="xtk:formlib:subforms/script"/>
          <form name="prefill" ref="xtk:formlib:subforms/prefill"/>
          <form name="writer" ref="xtk:formlib:subforms/writer"/>
          <form name="jump" ref="xtk:formlib:subforms/jump"/>
          <form name="end" ref="xtk:formlib:subforms/end"/>
          <form name="query" ref="xtk:formlib:subforms/query"/>
          <form name="accessControl" ref="nms:webApp:lib/accessControl"/>
          <form name="accessControlSocial" ref="nms:webApp:lib/accessControlSocial"/>
          <form name="facebookAcquisition" ref="nms:webApp:lib/facebookAcquisition"/>
          <form name="authenticated" ref="xtk:formlib:subforms/next"/>
          <form name="anonymous" ref="xtk:formlib:subforms/next"/>
          <form name="condition" ref="xtk:formlib:subforms/next"/>
          <form name="default" ref="xtk:formlib:subforms/next"/>
        </container>
      </container>
      <input type="formContext"/>
      <input enabledIf="[/ignored/@hasSurvey]" type="archivedFieldObserver"/>
      <container type="visibleGroup" visibleIf="@isModel and [/ignored/@hasPurl] = false">
        <container ref="xtk:formlib:design"/>
      </container>
      <container type="visibleGroup" visibleIf="!@isModel or [/ignored/@hasPurl]">
        <container type="notebook">
          <container img="nms:webApp.png" label="Dashboard">
            <input entityRefresh="nms:webApp" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/nms/webApp.jssp?id='+@id + '&amp;standalone=1'"/>
          </container>
          <container img="xtk:form.png" label="Edit" visibleIf="@id!=0">
            <container type="iconbox">
              <container colcount="2" firstActivatedIf="true" img="xtk:properties.png" label="General" visibleIf="[/ignored/@hasPurl] or [/ignored/@hasSurvey]">
                <input xpath="@label"/>
                <input xpath="@internalName"/>
                <input xpath="@nature"/>
                <input readOnly="true" xpath="@appState"/>
                <container colspan="2" type="visibleGroup" visibleIf="![/ignored/@hasLead]">
                  <input colspan="2" label="Document type" schema="xtk:schema" type="schemaEdit" xpath="@schema" xpathStartPath="@startPath">
                    <enter name="onChange">
                      <set value="nms:deliveryMapping" xpath="/ignored/queryDefMap/@schema"/>
                      <set value="getIfExists" xpath="/ignored/queryDefMap/@operation"/>
                      <set value="@id" xpath="/ignored/queryDefMap/select/node[1]/@expr"/>
                      <set value="[.]" xpath="/ignored/queryDefMap/select/node[2]/@expr"/>
                      <set value="@_cs" xpath="/ignored/queryDefMap/select/node[2]/@alias"/>
                      <set expr="'@schema=\''+@schema + '\''" xpath="/ignored/queryDefMap/where/condition/@expr"/>
                      <soapCall name="ExecuteQuery" service="xtk:queryDef">
                        <param exprIn="[/ignored/queryDefMap]" type="DOMDocument"/>
                        <param type="DOMDocument" xpathOut="deliveryMapping"/>
                      </soapCall>
                      <set expr="iif([deliveryMapping/@id] != '', [deliveryMapping/@id], 0)" xpath="@deliveryMapping-id"/>
                    </enter>
                  </input>
                  <static/>
                  <container applicableIf="HasPackage('nms:survey')" colspan="2" type="visibleGroup" visibleIf="@trackingEnabled">
                    <input label="Library" schema="xtk:schema" type="schemaEdit" xpath="@library"/>
                  </container>
                </container>
                <static colspan="2" img="xtk:scheduledtasks.png" label="Schedule" type="separator"/>
                <input label="Start" xpath="@startDate"/>
                <input label="End" xpath="@endDate"/>
                <input colspan="2" label="Description" type="separator"/>
                <input colspan="2" nolabel="true" xpath="desc"/>
              </container>
              <container img="nms:detailview.png" label="Edit">
                <container ref="xtk:formlib:design"/>
              </container>
              <container applicableIf="HasPackage('crm:lead')" img="crm:lead.png" label="Leads" ref="crm:common:leads" visibleIf="[/ignored/@hasLead]=true"/>
              <container applicableIf="HasPackage('nms:purl')" img="nms:purl.png" label="pURL" name="purl" visibleIf="[/ignored/@hasPurl]">
                <input disableDefaultFilter="true" hideEditButtons="true" img="nms:purl.png" name="purl" nolabel="true" type="linkList" xpath="purl" zoom="true">
                  <input xpath="@label"/>
                  <input xpath="@url"/>
                  <input xpath="@urlTemplate"/>
                </input>
              </container>
              <container img="nms:webtracking.png" label="Responses" name="log" visibleIf="@isModel=false and @trackingEnabled=true">
                <container type="visibleGroup" visibleIf="NodeCount(archivedFieldsSchema)>0">
                  <input delButton="true" form="nms:webAppLog" img="nms:webtracking.png" nolabel="true" promptDeleteLabel="Do you want to delete the selected responses?" showAdvancedMemo="false" showAll="true" showMemo="true" showXml="false" toolbarCaption="Form responses" type="tmpDataPreviewList" xpathSchemaData="archivedFieldsSchema" xpathSchemaForm="/webApp/@library">
                    <input colSize="30" xpathExpr="ExtractRight(@library, ':')+ '/@logDate'"/>
                    <input colSize="50" xpathExpr="ExtractRight(@library, ':')+ '/' + FindLink(@library, @schema)"/>
                    <input xpathExpr="ExtractRight(@library, ':')+ '/@origin'"/>
                    <input colSize="5" xpathExpr="ExtractRight(@library, ':')+ '/@score'"/>
                    <input hidden="true" xpath="@webAppLog-id"/>
                    <enter name="remove">
                      <soapCall name="RemoveLog" service="nms:webApp">
                        <param exprIn="[/tmp/@selection]" type="string"/>
                        <param exprIn="/tmp/listChoice" type="DOMElement"/>
                      </soapCall>
                    </enter>
                  </input>
                </container>
                <container type="visibleGroup" visibleIf="NodeCount(archivedFieldsSchema)=0 and @library='nms:webAppLogRcp'">
                  <input delButton="true" form="nms:webAppLog" hideEditButtons="true" img="nms:webtracking.png" nolabel="true" refresh="true" toolbarCaption="Form responses" type="linklist" xpath="webAppLogRcp" zoom="true">
                    <input colSize="30" xpath="@logDate"/>
                    <input colSize="50" xpath="recipient"/>
                    <input xpath="@origin"/>
                    <orderBy>
                      <node expr="@logDate" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container applicableIf="HasPackage('crm:lead')" type="visibleGroup" visibleIf="NodeCount(archivedFieldsSchema)=0 and @library='crm:webAppLogLead'">
                  <input delButton="true" form="nms:webAppLog" hideEditButtons="true" img="nms:webtracking.png" nolabel="true" refresh="true" toolbarCaption="Form responses" type="linklist" xpath="webAppLogLead" zoom="false">
                    <input colSize="30" xpath="@logDate"/>
                    <input colSize="50" xpath="incomingLead"/>
                    <input xpath="@origin"/>
                    <orderBy>
                      <node expr="@logDate" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
              </container>
              <container img="xtk:logs.png" label="Audit">
                <input addButton="false" delButton="true" enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Messages in the journal" type="linklist" xpath="log" zoom="false">
                  <input colSize="30" xpath="@logDate"/>
                  <input colSize="30" xpath="@message"/>
                  <orderBy>
                    <node expr="@id" sortDesc="true"/>
                  </orderBy>
                </input>
              </container>
            </container>
          </container>
          <container img="xtk:preview.png" label="Preview" ref="xtk:formlib:preview" visibleIf="@isModel=false and @id!=0"/>
        </container>
      </container>
      <leave>
        <check expr="@endDate='' OR (@startDate &lt;= @endDate)">
          <error>The end date must be later than the start date.</error>
        </check>
        <soapCall name="RemoveUnusedField" service="nms:webApp">
          <param exprIn="." type="DOMElement"/>
          <param type="DOMElement" xpathOut="."/>
        </soapCall>
        <set expr="NodeCount([activities/htmlPage])!=0" xpath="@hasHtmlPage"/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:webApp" entitySchema="xtk:form" img="xtk:form.png" label="New Web application" md5="3D18242F72BCA2D57CCF80077255B0C5" name="newWebApp" namespace="nms" noNewInstance="true" xpathsToLoad="@isModel" xtkschema="xtk:form">
      <enter>
        <set value="0" xpath="/tmp/@purl"/>
        <set value="0" xpath="/tmp/@social"/>
        <set value="0" xpath="/tmp/@lead"/>
      </enter>
      <container type="visibleGroup" visibleIf="@isModel=false and [/tmp/@newFromModel]=false and [/tmp/@showFolder]!=1 and [/tmp/@duplicated]!=true">
        <static img="nms:circle-one.png">Select a Web application template</static>
        <input boldLineExpr="@builtIn = 1" choiceButton="true" createMode="none" defaultModelSearchExpr="Iif([@_instanceModelId]!=0 and [@_instanceModelId]!='', '@id='+[@_instanceModelId], iif ([/tmp/@purl]=1,'@internalName=\'newMicrosite\'',            iif([/tmp/@social]=1,'@internalName=\'newSocialWebApp\'',             iif([/tmp/@lead]=1,'@internalName=\'eventRegLandingPage\'', '@internalName=\'newLandingPage\''))))" folderFilterChoice="@model = 'nmsWebAppModel'" form="nms:webApp" fullLoad="true" img="nms:webApp.png" label="Template" newFromModelOnChange="true" noZoom="true" schema="nms:webApp" selectionPath="/tmp/model" type="linkEdit" xpath="/tmp/@model">
          <sysFilter>
            <condition enabledIf="HasPackage('nms:purl') and $(/tmp/@purl)=1" expr="[facet/@purl]=1"/>
            <condition enabledIf="HasPackage('nms:social') and $(/tmp/@social)=1" expr="[facet/@social]=1"/>
            <condition enabledIf="HasPackage('crm:lead') and $(/tmp/@lead)=1" expr="[facet/@lead]=1"/>
          </sysFilter>
          <orderBy>
            <node expr="@builtIn" sortDesc="true"/>
            <node expr="@label"/>
          </orderBy>
          <enter name="onChange">
            <if expr="HasPackage('nms:campaign') and [/tmp/@operationId]!='' and [/tmp/@operationId]!=0">
              <set expr="[/tmp/@operationId]" xpath="@operation-id"/>
              <if expr="[/tmp/@isModel]!='' and [/tmp/@isModel]">
                <set value="1" xpath="@isModel"/>
                <set expr="[@folder-id]" xpath="@folderProcess-id"/>
                <set expr="FolderFromName('nmsWebAppModelOp')" xpath="@folder-id"/>
                <reset xpath="folderProcess"/>
                <reset xpath="folder"/>
                <reset xpath="/ignored/queryDef"/>
                <set value="xtk:folder" xpath="/ignored/queryDef/@schema"/>
                <set value="getIfExists" xpath="/ignored/queryDef/@operation"/>
                <set value="@label" xpath="/ignored/queryDef/select/node/@expr"/>
                <if expr="[@folder-id]!=0">
                  <set expr="'@id='+[@folder-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/tmp/queryDef"/>
                  </soapCall>
                  <set expr="[/tmp/queryDef/@label]" xpath="folder/@_cs"/>
                </if>
                <if expr="[@folderProcess-id]!=0">
                  <set expr="'@id='+[@folderProcess-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/tmp/queryDef"/>
                  </soapCall>
                  <set expr="[/tmp/queryDef/@label]" xpath="folderProcess/@_cs"/>
                </if>
              </if>
            </if>
          </enter>
        </input>
        <static img="nms:circle-two.png">Complete or modify parameters</static>
      </container>
      <input xpath="@label"/>
      <container applicableIf="HasPackage('nms:social')" type="visibleGroup" visibleIf="[facet/@social]">
        <input img="nms:miniatures/mini-accessControl.png" required="true" type="linkedit" xpath="socialAccount">
          <sysFilter>
            <condition expr="@type = 9"/>
          </sysFilter>
        </input>
      </container>
      <container type="visibleGroup" visibleIf="@isModel and [/tmp/@saveAsModel]==''" xpath="facet">
        <static label="Select the options you want to enable" type="separator"/>
        <input applicableIf="HasPackage('nms:survey')" xpath="@survey"/>
        <input applicableIf="HasPackage('nms:purl')" xpath="@purl"/>
        <input xpath="@advanced"/>
        <input applicableIf="HasPackage('crm:lead')" xpath="@lead"/>
      </container>
      <container type="visibleGroup" visibleIf="@isModel and [/tmp/@saveAsModel]==''">
        <input xpath="@nature"/>
      </container>
      <container type="visibleGroup" visibleIf="@isModel and ([/tmp/@saveAsModel]=='' or [/tmp/@showFolder]==1)">
        <input img="nms:webApp.png" label="Instances folder" xpath="folderProcess">
          <sysFilter>
            <condition expr="@model = 'nmsWebApp'"/>
          </sysFilter>
        </input>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@saveAsModel]==true or (@isModel and [/tmp/@showFolder]==1)">
        <input img="nms:webAppModel.png" label="Folder" writeAccess="true" xpath="folder">
          <sysFilter>
            <condition expr="@model = 'nmsWebAppModel'"/>
          </sysFilter>
        </input>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@newFromModel]==true or (@isModel=false and ([/tmp/@showFolder]==1 or [/tmp/@folderFromView]=0))">
        <input img="nms:webApp.png" label="Folder" writeAccess="true" xpath="folder">
          <sysFilter>
            <condition expr="@model = 'nmsWebApp'"/>
          </sysFilter>
        </input>
      </container>
      <input xpath="desc"/>
      <leave>
        <check expr="[/tmp/@showFolder]!=1 or [@folder-id]!=0">
          <error>You must specify the Web application folder.</error>
        </check>
        <if expr="HasPackage('nms:social')">
          <check expr="[facet/@social]!=1 or [@socialAccount-id]!=0">
            <error>Please select an application.</error>
          </check>
        </if>
        <if expr="@isModel=false and [/tmp/@showFolder]!=1">
          <check expr="[/tmp/@duplicated]==true or [/tmp/@newFromModel]==true or ([/tmp/model/key/@value]!=0 and [/tmp/model/key/@value]!='')">
            <error>Please select a template.</error>
          </check>
          <if expr="[/tmp/@folder-id]!='' AND [/tmp/@folder-id]!=0 AND [/tmp/@showFolder]!=1">
            <set expr="[/tmp/@folder-id]" xpath="@folder-id"/>
          </if>
        </if>
        <if expr="[/tmp/@folderFromView]!='' and [/tmp/@folderFromView]!=0">
          <set expr="[/tmp/@folderFromView]" xpath="@folder-id"/>
        </if>
        <if expr="@isModel and [/tmp/@saveAsModel] and [/tmp/@folder-id]!=0 AND [/tmp/@folder-id]!=''">
          <set expr="[/tmp/@folder-id]" xpath="@folderProcess-id"/>
        </if>
        <if expr="!@isModel and HasPackage('nms:campaign') and [/tmp/@operationId]!='' and [/tmp/@operationId]!=0 and [/tmp/@isModel]!='' and [/tmp/@isModel]">
          <set value="true" xpath="@isModel"/>
        </if>
        <if expr="HasPackage('nms:purl')">
          <if expr="[facet/@purl]">
            <set value="nms:deliveryMapping" xpath="/ignored/queryDefMap/@schema"/>
            <set value="getIfExists" xpath="/ignored/queryDefMap/@operation"/>
            <set value="@id" xpath="/ignored/queryDefMap/select/node[1]/@expr"/>
            <set value="[.]" xpath="/ignored/queryDefMap/select/node[2]/@expr"/>
            <set value="@_cs" xpath="/ignored/queryDefMap/select/node[2]/@alias"/>
            <set expr="'@schema=\''+@schema + '\''" xpath="/ignored/queryDefMap/where/condition/@expr"/>
            <soapCall name="ExecuteQuery" service="xtk:queryDef">
              <param exprIn="[/ignored/queryDefMap]" type="DOMDocument"/>
              <param type="DOMDocument" xpathOut="deliveryMapping"/>
            </soapCall>
            <set expr="iif([deliveryMapping/@id] != '', [deliveryMapping/@id], 0)" xpath="@deliveryMapping-id"/>
            <if expr="[/tmp/@saveAsModel]">
              <reset xpath="purl[*]"/>
            </if>
          </if>
        </if>
        <if expr="HasPackage('crm:lead') and @isModel and [/tmp/@saveAsModel]">
          <set expr="[facet/@lead]" xpath="/ignored/@hasLead"/>
          <if expr="[facet/@lead]">
            <set value="crm:webAppLogLead" xpath="@library"/>
            <set value="crm:incomingLead" xpath="@schema"/>
          </if>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="nms:webApp32.png" label="Collect new strings" md5="1FAACC45666980F73FAC156A0209E8F5" name="webAppDictionaryCheck" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container desc="Click 'Start' to run the collecting process." name="dictionaryCheckJob" title="Collecting strings to be translated">
        <container refreshPeriod="1500" type="jobProgressContainer">
          <soapCall name="DictionaryCheck" service="nms:webApp">
            <param type="DOMElement" xpath="/tmp/ctxForm/keys/where"/>
            <param type="DOMElement" xpathOut="/tmp/translationStats"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="nms:webApp32.png" label="Import translated strings" md5="86B90CE90F55BC089C33853B43649384" name="webAppDictionaryImport" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
        <set value="import" xpath="@jobType"/>
      </enter>
      <container desc="Select the file which contains the translated strings" title="File selection">
        <input filters="CSV or XLIFF files (*.csv;*.xlf)|*.csv;*.xlf|" label="Local file to import" type="fileEdit" xpath="/tmp/dictionaryImport/@name" xpathType="/tmp/dictionaryImport/@format"/>
        <container exprTransferType="true" keyIsMd5="true" methodName="NONE" noJobSubmit="true" notResTable="true" type="resourceTransferContainer" xpathFile="/tmp/dictionaryImport/@name" xpathNotResTable="/ignored/resource/@notInResTable" xpathOutList="@md5,/tmp/dictionaryImport/@serverName">
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/execution/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/execution/@remaining"/>
          </container>
          <container colcount="2" enabledIf="[/ignored/@performedUpload] == ''" type="enabledGroup">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathElapsed="/tmp/timing/@elapsed" xpathRemaining="/tmp/timing/@remaining"/>
            <input img="xtk:upload.png" label="&amp;Upload" name="JobSubmitButton" type="flatbutton"/>
          </container>
          <leave>
            <soapCall name="DictionaryImport" service="nms:webApp">
              <param exprIn="[/tmp/dictionaryImport/@serverName]" type="string"/>
            </soapCall>
          </leave>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:dataTransfer" entitySchema="xtk:form" img="nms:webApp32.png" label="Export strings for translation" md5="D0FD75DB1B5D6A5BD2AAEFCE80AA672C" name="webAppDictionaryExport" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
        <set value="export" xpath="@jobType"/>
        <set value="batch" xpath="@exportType"/>
        <set value="2" xpath="/tmp/dictionaryExport/@exportOption"/>
        <set value="CSV" xpath="/tmp/dictionaryExport/@fileFormat"/>
      </enter>
      <container colcount="2" desc="Once you've selected the export options, click 'Start' to export the strings to translate." name="export" title="Export strings for translation">
        <input colspan="2" enum="xtk:abstractForm:dictionaryExportOptions" label="Export strategy" type="sysEnum" xpath="/tmp/dictionaryExport/@exportOption"/>
        <input colspan="2" dlgType="savedir" label="Target folder" required="true" type="fileedit" xpath="/tmp/dictionaryExport/@containingFolder"/>
        <container colspan="2" label="File format" type="frame">
          <container colcount="2">
            <input checkedValue="CSV" label="CSV (Excel)" type="radioButton" xpath="/tmp/dictionaryExport/@fileFormat"/>
            <container enabledIf="[/tmp/dictionaryExport/@exportOption] != 1 and [/tmp/dictionaryExport/@exportOption] != 3" type="enabledGroup">
              <input checkedValue="XLIFF" label="XLIFF" type="radioButton" xpath="/tmp/dictionaryExport/@fileFormat"/>
            </container>
          </container>
        </container>
        <container colspan="2" getFileNameFromProp="true" type="dataTransferSubmitContainer" xpathDestName="properties/filesToDownload">
          <enter>
            <set expr="[/tmp/dictionaryExport/@containingFolder]" xpath="dataTransferStep/destination/@outputDirectory"/>
          </enter>
          <soapCall name="DictionaryExport" service="nms:webApp">
            <param type="DOMElement" xpath="/tmp/ctxForm/keys/where"/>
            <param type="short" xpath="/tmp/dictionaryExport/@exportOption"/>
            <param type="string" xpath="/tmp/dictionaryExport/@fileFormat"/>
            <param type="DOMElement" xpathOut="properties/filesToDownload"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:none" entitySchema="xtk:form" img="xtk:form.png" label="Generated code" md5="98619F76454A458A79DC7C735A49511C" name="webAppSourceCode" namespace="nms" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <enter>
        <set value="web" xpath="/ignored/source/@target"/>
        <reset xpath="/ignored/source/@version"/>
        <reset xpath="/ignored/source/@compiled"/>
        <soapCall name="GetSource" service="nms:webApp">
          <param exprIn="[/tmp/ctxForm/keys/key/@value]" type="string"/>
          <param exprIn="[/ignored/source/@target]" type="string"/>
          <param exprIn="[/ignored/source/@compiled]" type="boolean"/>
          <param exprIn="[/ignored/source/@version]" type="string"/>
          <param type="CDATA" xpathOut="/tmp/source/content"/>
          <param type="DOMElement" xpathOut="/tmp/source/logs"/>
        </soapCall>
      </enter>
      <container colcount="2" name="code">
        <input img="xtk:refresh.png" label="Refresh the generated code" type="urlButton">
          <enter>
            <soapCall name="GetSource" service="nms:webApp">
              <param exprIn="[/tmp/ctxForm/keys/key/@value]" type="string"/>
              <param exprIn="[/ignored/source/@target]" type="string"/>
              <param exprIn="[/ignored/source/@compiled]" type="boolean"/>
              <param exprIn="[/ignored/source/@version]" type="string"/>
              <param type="CDATA" xpathOut="/tmp/source/content"/>
              <param type="DOMElement" xpathOut="/tmp/source/logs"/>
            </soapCall>
          </enter>
        </input>
        <input checkedValue="1" label="Recover the compiled source code (JS)" type="checkBox" unCheckedValue="0" xpath="/ignored/source/@compiled"/>
        <input colspan="2" contentType="JavaScript" nolabel="true" readOnly="true" type="CodeEdit" xpath="/tmp/source/content"/>
        <container colspan="2" type="visibleGroup" visibleIf="NodeCount([/tmp/source/logs/log]) > 0">
          <input lineCount="5" type="DocViewer" xpath="/tmp/source/logs" xslt="xtk:form/rendererLogs.xsl"/>
        </container>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="v4 Web form" maxLabelWidth="120" md5="D87EAAF3D7567B2CB1BE73A8C2667BC0" name="webForm" namespace="nms" type="iconbox" xtkschema="xtk:form">
      <container name="hidden" visibleIf="false">
        <container name="customizeBtn">
          <input menuId="webFormMenuBuilder" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
        </container>
        <container name="commonPage">
          <container colcount="2" label="Message" type="frame">
            <input xpath="@pageTitle"/>
            <input xpath="@style"/>
            <container colspan="2" img="xtk:html.png" label="HTML" name="htmlContentEditor" xpath="html">
              <container style="flat" type="contentEditor">
                <container label="HTML" name="tabHtml">
                  <input bodyMode="true" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                    <container ref="nms:webForm:hidden/customizeBtn"/>
                  </input>
                </container>
                <container label="Source" name="tabSource">
                  <input fullToolbar="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathUrl="/tmp/urlTree/@toSelect">
                    <container ref="nms:webForm:hidden/customizeBtn"/>
                  </input>
                </container>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container addSchemaMenu="nms:recipient" menuId="webFormMenuBuilder" type="customMenuBuilder"/>
      <container colcount="2" img="xtk:properties.png" label="General">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input xpath="parameters/form/@type"/>
        <input xpath="parameters/form/@authentication"/>
        <input colspan="2" xpath="@enableAllServices"/>
        <container colspan="2" type="visibleGroup" visibleIf="[parameters/form/@type]>0 and [parameters/form/@type]&lt;3 and @enableAllServices=false">
          <input choiceButton="true" xpath="service">
            <sysFilter>
              <condition expr="@mode=0"/>
            </sysFilter>
          </input>
        </container>
        <container colspan="2" type="visibleGroup" visibleIf="[parameters/form/@type]=3">
          <input choiceButton="true" xpath="service">
            <sysFilter>
              <condition expr="@mode=1"/>
            </sysFilter>
          </input>
        </container>
        <input colspan="2" img="nms:rcpFolder.png" label="Search folder" noZoom="true" xpath="searchFolder">
          <sysFilter>
            <condition expr="@model like 'nmsRecipient%'"/>
          </sysFilter>
        </input>
        <container colspan="2" type="visibleGroup" visibleIf="[parameters/form/@type]==3 or ([parameters/form/recipientFields/@create] and [parameters/form/@type]!=2)">
          <input img="nms:rcpFolder.png" noZoom="true" xpath="creationFolder">
            <sysFilter>
              <condition expr="@model like 'nmsRecipient%'"/>
            </sysFilter>
          </input>
        </container>
        <input colspan="2" xpath="parameters/@noDecoration"/>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="![parameters/@noDecoration]">
          <static colspan="2" label="Appearance" type="separator"/>
          <container colcount="2" colspan="2" xpath="parameters">
            <input form="ncm:xslt" xpath="../xsltWeb"/>
            <input xpath="@cssUrl"/>
            <input colspan="2" xpath="@pageTitle"/>
            <input xpath="@pageWidth"/>
            <input xpath="@pageStyle"/>
          </container>
          <static colspan="2" label="Form header" type="separator"/>
          <container colcount="2" colspan="2" xpath="parameters">
            <input xpath="form/labels/@pageTitle"/>
            <input label="Title style" xpath="form/labels/@style"/>
            <input colspan="2" xpath="@logoUrl"/>
            <input colspan="2" xpath="@logoLink"/>
          </container>
        </container>
        <input colspan="2" xpath="comment"/>
      </container>
      <container img="xtk:form.png" label="Form" visibleIf="[parameters/form/@type]=3" xpath="parameters/form">
        <container colcount="2">
          <input xpath="@method"/>
          <static/>
        </container>
        <container type="visibleGroup" visibleIf="@method == 'GET'">
          <static label="Parameters are sent to the server encoded in the form submission URL." type="help"/>
        </container>
        <container type="visibleGroup" visibleIf="@method == 'POST'">
          <static label="Parameters are contained in the HTTP request body sent to the server." type="help"/>
        </container>
        <container type="notebook">
          <container label="Editable fields for profiles of referees">
            <container colcount="2">
              <input xpath="recipientFields/@align"/>
              <input xpath="recipientFields/@labelStyle"/>
              <input label="Number of referees" xpath="viral/@sponsoredCount"/>
              <input xpath="recipientFields/@fieldStyle"/>
            </container>
            <input noSerialize="true" nolabel="true" toolbarCaption="Fields to edit" type="list" xpath="recipientFields/field" xpathChoiceTarget="@xpath" xpathIndex="/tmp/recipientFields/@current">
              <input choiceType="xpath" hideCalculated="true" schema="nms:recipient" type="pathEdit" xpath="@xpath" xpathLabel="@label" xpathType="@type"/>
              <input xpath="@label"/>
              <input xpath="@type"/>
              <input xpath="@mandatory"/>
              <input xpath="@key"/>
              <input xpath="@alias"/>
            </input>
            <container type="collectionItemGroup" xpath="recipientFields/field" xpathIndex="/tmp/recipientFields/@current">
              <container type="visibleGroup" visibleIf="@type='combo' or @type='radio'">
                <static label="Values:"/>
                <input nolabel="true" schema="nms:recipient" type="enumList" xpath="value">
                  <input xpath="@label"/>
                  <input xpath="@value"/>
                  <input xpath="@selected"/>
                </input>
              </container>
              <container type="visibleGroup" visibleIf="@type='edit'">
                <container label="String properties" type="frame">
                  <container colcount="2" type="visibleGroup" visibleIf="@type='edit' and @multiLine=false">
                    <input xpath="@multiLine"/>
                    <input xpath="@size"/>
                    <static/>
                    <input xpath="@maxsize"/>
                  </container>
                  <container colcount="2" type="visibleGroup" visibleIf="@type='edit' and @multiLine">
                    <input xpath="@multiLine"/>
                    <input xpath="@colNumber"/>
                    <static/>
                    <input xpath="@lineNumber"/>
                  </container>
                </container>
              </container>
            </container>
          </container>
          <container label="Constants for profiles of referees">
            <input delButton="true" nolabel="true" ordered="false" schema="nms:recipient" toolbarCaption="Constants or default values for the form" type="updateList" xpath="constList/constant">
              <input choiceType="xpath" colSize="35" hideCalculated="true" label="Field" schema="nms:recipient" type="pathedit" xpath="@expr" xpathChoiceTarget="@expr"/>
              <input label="Value" xpath="@value"/>
              <input xpath="@nullDestValue"/>
            </input>
          </container>
          <container colcount="2" label="Referrer" xpath="viral/senderField">
            <static/>
            <input label="Email properties" xpath="@emailLabel"/>
            <input xpath="@displayFirstName"/>
            <container enabledIf="@displayFirstName" type="enabledGroup">
              <input xpath="@firstNameLabel"/>
            </container>
            <input xpath="@displayLastName"/>
            <container enabledIf="@displayLastName" type="enabledGroup">
              <input xpath="@lastNameLabel"/>
            </container>
            <container colcount="2" colspan="2" label="XPaths of the referrer data" type="frame">
              <input choiceType="xpath" nolabel="false" schema="nms:recipient" type="pathEdit" xpath="@xpathObject"/>
              <input choiceType="xpath" nolabel="false" schema="nms:recipient" type="pathEdit" xpath="@xpathLastName"/>
              <input choiceType="xpath" nolabel="false" schema="nms:recipient" type="pathEdit" xpath="@xpathEmail"/>
              <input choiceType="xpath" nolabel="false" schema="nms:recipient" type="pathEdit" xpath="@xpathFirstName"/>
              <input choiceType="xpath" nolabel="false" schema="nms:recipient" type="pathEdit" xpath="@xpathRecipient"/>
              <input choiceType="xpath" nolabel="false" schema="nms:recipient" type="pathEdit" xpath="@xpathDelivery"/>
            </container>
            <input xpath="@labelStyle"/>
            <static/>
            <input xpath="@fieldStyle"/>
            <static/>
          </container>
          <container colcount="2" label="Texts">
            <container type="notebook">
              <container colcount="2" label="General">
                <static colspan="2" label="Labels" type="separator"/>
                <input colspan="2" label="Label style" xpath="viral/@style"/>
                <input colspan="2" xpath="viral/@recipient"/>
                <input colspan="2" xpath="viral/@sender"/>
                <input colspan="2" xpath="viral/@message"/>
                <input xpath="labels/@submit"/>
                <input xpath="labels/@submitStyle"/>
                <static colspan="2" label="You can set an URL to an image to display an image instead of the button." type="help"/>
                <input xpath="labels/@mandatory"/>
                <input xpath="labels/@mandatoryStyle"/>
                <static colspan="2" label="Edit dates" type="separator"/>
                <input xpath="labels/@dayLabel"/>
                <input xpath="labels/@startYear"/>
                <input xpath="labels/@monthLabel"/>
                <input xpath="labels/@endYear"/>
                <input xpath="labels/@yearLabel"/>
                <static/>
              </container>
              <container label="Introduction">
                <static label="You can specify an HTML content used at the beginning of the form." type="help"/>
                <container img="xtk:html.png" label="HTML" name="htmlContentEditor" xpath="labels/html">
                  <container style="flat" type="contentEditor">
                    <container label="HTML" name="tabHtml">
                      <input bodyMode="true" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                        <container ref="nms:webForm:hidden/customizeBtn"/>
                      </input>
                    </container>
                    <container label="Source" name="tabSource">
                      <input fullToolbar="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathUrl="/tmp/urlTree/@toSelect">
                        <container ref="nms:webForm:hidden/customizeBtn"/>
                      </input>
                    </container>
                  </container>
                </container>
              </container>
              <container label="End of page">
                <static label="You can specify an HTML content used at the end of the form." type="help"/>
                <container img="xtk:html.png" label="HTML" name="htmlContentEditor" xpath="labels/footer">
                  <container style="flat" type="contentEditor">
                    <container label="HTML" name="tabHtml">
                      <input bodyMode="true" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                        <container ref="nms:webForm:hidden/customizeBtn"/>
                      </input>
                    </container>
                    <container label="Source" name="tabSource">
                      <input fullToolbar="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathUrl="/tmp/urlTree/@toSelect">
                        <container ref="nms:webForm:hidden/customizeBtn"/>
                      </input>
                    </container>
                  </container>
                </container>
              </container>
            </container>
          </container>
          <container label="Approval" xpath="validation">
            <static label="JavaScript code used to approve the form." type="help"/>
            <input nolabel="true" toolbar="true" type="ContentResEdit" typeJSTMenu="jstMenuSchema" wrap="false" xpath="javascript" xpathJSTMenu="@schema"/>
            <input xpath="@function"/>
            <static label="Please specify how the validation function is called (ex: MyFunction(this))." type="help"/>
          </container>
        </container>
      </container>
      <container img="xtk:form.png" label="Form" visibleIf="[parameters/form/@type]!=3" xpath="parameters/form">
        <container colcount="2">
          <input xpath="@method"/>
          <static/>
        </container>
        <container type="visibleGroup" visibleIf="@method == 'GET'">
          <static label="Parameters are sent to the server encoded in the form submission URL." type="help"/>
        </container>
        <container type="visibleGroup" visibleIf="@method == 'POST'">
          <static label="Parameters are contained in the HTTP request body sent to the server." type="help"/>
        </container>
        <container type="notebook">
          <container label="Editable fields">
            <container colcount="2" type="visibleGroup" visibleIf="@type!=2">
              <input xpath="recipientFields/@align"/>
              <input xpath="recipientFields/@labelStyle"/>
              <input nolabel="true" xpath="recipientFields/@create"/>
              <input xpath="recipientFields/@fieldStyle"/>
            </container>
            <container colcount="2" type="visibleGroup" visibleIf="@type=2">
              <input xpath="recipientFields/@align"/>
              <input xpath="recipientFields/@labelStyle"/>
              <input nolabel="true" xpath="recipientFields/@mainKey"/>
              <input xpath="recipientFields/@fieldStyle"/>
            </container>
            <container colcount="2" type="visibleGroup" visibleIf="@type!=2 and [recipientFields/@create]==false">
              <input nolabel="true" xpath="recipientFields/@mainKey"/>
            </container>
            <container type="visibleGroup" visibleIf="![recipientFields/@mainKey] or [recipientFields/@create]">
              <input noSerialize="true" nolabel="true" toolbarCaption="Fields to edit" type="list" xpath="recipientFields/field" xpathChoiceTarget="@xpath" xpathIndex="/tmp/recipientFields/@current">
                <input choiceType="xpath" hideCalculated="true" schema="nms:recipient" type="pathEdit" xpath="@xpath" xpathLabel="@label" xpathType="@type"/>
                <input xpath="@label"/>
                <input xpath="@type"/>
                <input xpath="@mandatory"/>
                <input xpath="@key"/>
                <input xpath="@alias"/>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="[recipientFields/@mainKey] and [recipientFields/@create]==false">
              <input noSerialize="true" nolabel="true" toolbarCaption="Fields to edit" type="list" xpath="recipientFields/field" xpathChoiceTarget="@xpath" xpathIndex="/tmp/recipientFields/@current">
                <input hideCalculated="true" schema="nms:recipient" type="pathEdit" xpath="@xpath" xpathLabel="@label" xpathType="@type"/>
                <input xpath="@label"/>
                <input xpath="@type"/>
                <input xpath="@mandatory"/>
                <input xpath="@alias"/>
              </input>
            </container>
            <container type="collectionItemGroup" xpath="recipientFields/field" xpathIndex="/tmp/recipientFields/@current">
              <container type="visibleGroup" visibleIf="@type='combo' or @type='radio'">
                <static label="Values:"/>
                <input nolabel="true" schema="nms:recipient" type="enumList" xpath="value">
                  <input xpath="@label"/>
                  <input xpath="@value"/>
                  <input xpath="@selected"/>
                </input>
                <container colcount="2" type="visibleGroup" visibleIf="@type='radio'">
                  <input xpath="@vAlign"/>
                  <static/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@type='edit'">
                <container label="String properties" type="frame">
                  <container colcount="2" type="visibleGroup" visibleIf="@type='edit' and @multiLine=false">
                    <input xpath="@multiLine"/>
                    <input xpath="@size"/>
                    <static/>
                    <input xpath="@maxsize"/>
                  </container>
                  <container colcount="2" type="visibleGroup" visibleIf="@type='edit' and @multiLine">
                    <input xpath="@multiLine"/>
                    <input xpath="@colNumber"/>
                    <static/>
                    <input xpath="@lineNumber"/>
                  </container>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@type='separator'">
                <container colcount="2" label="Separator properties" type="frame">
                  <input xpath="@widthPercent"/>
                  <static/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@type='labelSep'">
                <container colcount="2" label="Label properties" type="frame">
                  <input xpath="@style"/>
                  <static/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@type='checkbox'">
                <container colcount="2" label="Label properties" type="frame">
                  <input xpath="@leftAlign"/>
                  <static/>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="@type='password'">
                <container colcount="2" label="Password properties" type="frame">
                  <input xpath="@encoding"/>
                  <static/>
                </container>
              </container>
            </container>
          </container>
          <container label="Constants">
            <input delButton="true" nolabel="true" ordered="false" schema="nms:recipient" toolbarCaption="Constants or default values for the form" type="updateList" xpath="constList/constant" xpathChoiceTarget="@expr">
              <input choiceType="xpath" colSize="35" hideCalculated="true" label="Field" schema="nms:recipient" type="pathedit" xpath="@expr"/>
              <input label="Value" xpath="@value"/>
              <input xpath="@nullDestValue"/>
            </input>
          </container>
          <container label="Data loading" xpath="findList">
            <input nolabel="true" xpath="@loadData"/>
            <container type="visibleGroup" visibleIf="![../recipientFields/@mainKey] or [../recipientFields/@create]">
              <static label="Fields used to lookup for the recipient" type="separator"/>
              <input nolabel="true" xpath="@mainKey"/>
              <container type="visibleGroup" visibleIf="!@mainKey">
                <input noSerialize="true" nolabel="true" toolbarCaption="List of identification free fields" type="list" xpath="find" xpathChoiceTarget="@xpath">
                  <input choiceType="xpath" hideCalculated="true" hideMappedAsXml="true" schema="nms:recipient" type="pathEdit" xpath="@xpath"/>
                  <input xpath="@alias"/>
                </input>
                <static label="The fields specified are used as reconciliation key for the recipient if the data entry form is not used." type="help"/>
              </container>
            </container>
          </container>
          <container colcount="2" label="Subscription management" visibleIf="@type=0" xpath="serviceList">
            <input xpath="@title"/>
            <input xpath="@style"/>
            <input xpath="@align"/>
            <input xpath="@styleList"/>
            <input colspan="2" img="nms:subscribe.png" nolabel="true" toolbarCaption="Please select the list of services the recipient can subscribe to" type="list" xpath="subscribe" xpathChoiceTarget="@name">
              <input label="Service" newEntityFormChoice="true" noZoom="true" notifyPathList="@name, @label" schema="nms:service" type="linkedit" xpath="@name"/>
              <input xpath="@label"/>
              <input xpath="@selected"/>
              <input xpath="@mandatory"/>
            </input>
          </container>
          <container label="Texts">
            <container colcount="2" type="visibleGroup" visibleIf="@type=1 or @type=2">
              <input xpath="unsubscription/@interPage"/>
              <static/>
            </container>
            <container type="visibleGroup" visibleIf="[unsubscription/@interPage] or (@type!=2 and @type!=1)">
              <container type="notebook">
                <container colcount="2" label="General">
                  <static colspan="2" label="Labels" type="separator"/>
                  <input xpath="labels/@submit"/>
                  <input xpath="labels/@submitAlign"/>
                  <static label="You can set an URL to an image to display an image instead of the button." type="help"/>
                  <input xpath="labels/@submitStyle"/>
                  <input xpath="labels/@mandatory"/>
                  <input xpath="labels/@mandatoryAlign"/>
                  <static/>
                  <input xpath="labels/@mandatoryStyle"/>
                  <static colspan="2" label="Edit dates" type="separator"/>
                  <input xpath="labels/@dayLabel"/>
                  <input xpath="labels/@startYear"/>
                  <input xpath="labels/@monthLabel"/>
                  <input xpath="labels/@endYear"/>
                  <input xpath="labels/@yearLabel"/>
                  <static/>
                </container>
                <container label="Introduction">
                  <static label="You can specify an HTML content used at the beginning of the form." type="help"/>
                  <container img="xtk:html.png" label="HTML" name="htmlContentEditor" xpath="labels/html">
                    <container style="flat" type="contentEditor">
                      <container label="HTML" name="tabHtml">
                        <input bodyMode="true" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                          <container ref="nms:webForm:hidden/customizeBtn"/>
                        </input>
                      </container>
                      <container label="Source" name="tabSource">
                        <input fullToolbar="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathUrl="/tmp/urlTree/@toSelect">
                          <container ref="nms:webForm:hidden/customizeBtn"/>
                        </input>
                      </container>
                    </container>
                  </container>
                </container>
                <container label="End of page">
                  <static label="You can specify an HTML content used at the end of the form." type="help"/>
                  <container img="xtk:html.png" label="HTML" name="htmlContentEditor" xpath="labels/footer">
                    <container style="flat" type="contentEditor">
                      <container label="HTML" name="tabHtml">
                        <input bodyMode="true" fullToolbar="true" name="ctWysiwyg" nolabel="true" type="dhtml" viewSourceBtn="false" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                          <container ref="nms:webForm:hidden/customizeBtn"/>
                        </input>
                      </container>
                      <container label="Source" name="tabSource">
                        <input fullToolbar="true" name="ctSource" nolabel="true" type="htmlSource" xpath="." xpathInsert="/ignored/customizeBtnOut" xpathSelectCode="/tmp/htmlDiagnostics/@toSelect" xpathUrl="/tmp/urlTree/@toSelect">
                          <container ref="nms:webForm:hidden/customizeBtn"/>
                        </input>
                      </container>
                    </container>
                  </container>
                </container>
              </container>
            </container>
          </container>
          <container label="Approval" xpath="validation">
            <static label="JavaScript code used to approve the form." type="help"/>
            <input nolabel="true" toolbar="true" type="ContentResEdit" typeJSTMenu="jstMenuSchema" wrap="false" xpath="javascript" xpathJSTMenu="@schema"/>
            <input xpath="@function"/>
            <static label="Please specify how the validation function is called (ex: MyFunction(this))." type="help"/>
          </container>
        </container>
      </container>
      <container img="nms:email.png" label="Confirmation">
        <container type="notebook">
          <container label="Success page" xpath="parameters/confirm/successPage">
            <container colcount="2">
              <input xpath="@external"/>
              <static/>
            </container>
            <container type="visibleGroup" visibleIf="@external">
              <container>
                <input label="URL" xpath="@url"/>
                <input noSerialize="true" nolabel="true" toolbarCaption="Parameters to include in the URL of the external confirmation page" type="list" xpath="parameter" xpathChoiceTarget="@xpath">
                  <input choiceType="xpath" hideCalculated="true" hideMappedAsXml="true" schema="nms:recipient" type="pathEdit" xpath="@xpath"/>
                  <input xpath="@alias"/>
                </input>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="!@external">
              <container ref="nms:webForm:hidden/commonPage"/>
            </container>
          </container>
          <container label="Error page" xpath="parameters/confirm/errorPage">
            <container colcount="2">
              <input xpath="@external"/>
              <static/>
            </container>
            <container type="visibleGroup" visibleIf="@external">
              <container>
                <input label="URL" xpath="@url"/>
                <input noSerialize="true" nolabel="true" toolbarCaption="Parameters to include in the URL of the external confirmation page" type="list" xpath="parameter" xpathChoiceTarget="@xpath">
                  <input choiceType="xpath" hideCalculated="true" hideMappedAsXml="true" schema="nms:recipient" type="pathEdit" xpath="@xpath"/>
                  <input xpath="@alias"/>
                </input>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="!@external">
              <container colcount="2">
                <input xpath="@interPage"/>
                <static/>
              </container>
              <container type="visibleGroup" visibleIf="@interPage">
                <container ref="nms:webForm:hidden/commonPage"/>
              </container>
            </container>
          </container>
        </container>
      </container>
      <container img="xtk:preview.png" label="Preview">
        <static label="Save modifications of your form before refreshing the preview." type="help"/>
        <input alwaysActive="true" expr="getOption('NmsServer_URL')+'/nms/jsp/webForm.jsp?fo='+@name" type="expr" xpath="/tmp/@displayUrl"/>
        <input label="Form URL" readOnly="true" type="edit" xpath="/tmp/@displayUrl"/>
        <input type="urlViewer" urlExpr="Iif(@lastModified=='' or ([parameters/form/unsubscription/@interPage]=='false' and [parameters/form/@type]='2'), 'about:blank', getOption('NmsServer_URL')+'/nms/jsp/webForm.jsp?fo='+@name+'&amp;_d='+@lastModified)"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="nms:webAppLogRcp" entitySchema="xtk:form" img="xtk:form.png" label="Form responses" md5="600354E82FE45CE79AF353B13C173970" name="webAppLog" namespace="nms" xpathsToLoad="webApp/@internalName,webApp/@uuid,webApp/@appState" xtkschema="xtk:form">
      <enter>
        <set expr="$(serverUrl) + '/webApp/' + [webApp/@internalName] + '?_uuid=' + [webApp/@uuid] + '&amp;_logId=' + [@id] + '&amp;origin=offline' + iif([webApp/@appState] = 0, '&amp;_preview=true','')" xpath="/ignore/@url"/>
      </enter>
      <input img="xtk:form/link.png" nolabel="true" type="edit" xpath="/ignore/@url"/>
      <input type="urlViewer" urlExpr="[/ignore/@url]"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="nms:trackingUrl" entitySchema="xtk:form" img="xtk:form.png" md5="FEE8AA627429581256026EBE96096D44" name="webTrackingUrl" namespace="nms" xtkschema="xtk:form">
      <input xpath="@label"/>
      <input required="true" type="computeNameEdit" xpath="@tagId" xpathRef="@label"/>
      <input enum="nms:trackingUrlInfo:tagType" xpath="@type"/>
      <input xpath="@validity"/>
      <input colspan="2" type="edit" xpath="@source"/>
      <static colspan="2" label="Tag" type="separator"/>
      <container colcount="2" colspan="2">
        <input img="xtk:html.png" label="&amp;Generate HTML code" nolabel="false" type="flatButton">
          <enter>
            <soapCall name="GenerateTag" service="nms:trackingUrl">
              <param exprIn="/trackingUrl" type="DOMElement"/>
              <param type="string" xpathOut="/tmp/@tag"/>
            </soapCall>
          </enter>
        </input>
        <static>... and then copy the generated code and paste it in the Web page calling the tag.</static>
        <input colspan="2" nolabel="true" type="jstEdit" xpath="/tmp/@tag"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Message" md5="E3A3EA04CD5D5ADDB697BC725C02A168" name="broadLogMsg" namespace="nms" type="iconbox" xtkschema="xtk:form">
      <container colcount="2" img="xtk:properties.png" label="General">
        <input xpath="@failureReason"/>
        <input xpath="@failureType"/>
        <input xpath="@count"/>
        <input xpath="@md5"/>
        <input xpath="@qualifStatus"/>
        <input readOnly="true" xpath="@lastModified"/>
        <input colspan="2" xpath="@text"/>
      </container>
      <container colcount="2" img="xtk:logs.png" label="Audit">
        <input readOnly="true" xpath="@created"/>
        <input readOnly="true" xpath="@lastModified"/>
        <input colspan="2" xpath="@firstText"/>
        <input colspan="2" xpath="@firstAddress"/>
      </container>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form colcount="2" entity-schema="nms:delivery" entitySchema="xtk:form" img="xtk:form.png" label="Extraction file" maxLabelWidth="50" md5="881F47F76887B5868CE193FB95DC51FD" name="extraction" namespace="nms" nothingToEdit="true" nothingToSave="true" xtkschema="xtk:form">
      <enter>
        <set value="200" xpath="/tmp/@nbLines"/>
      </enter>
      <input expr="[/tmp/@type]" type="expr">
        <enter>
          <if expr="[/tmp/@curType]=''">
            <set expr="[/tmp/@type]" xpath="/tmp/@curType"/>
          </if>
          <if expr="[/tmp/@curType]=1">
            <soapCall name="PreviewDelivery" service="nms:operation">
              <param exprIn="@id" type="int"/>
              <param exprIn="[/tmp/@nbLines]" type="int"/>
              <param type="string" xpathOut="/tmp/content"/>
            </soapCall>
          </if>
          <if expr="[/tmp/@curType]=0">
            <soapCall name="PreviewExtraction" service="nms:delivery">
              <param exprIn="[properties/@outputFile]" type="string"/>
              <param exprIn="[/tmp/@nbLines]" type="int"/>
              <param type="string" xpathOut="/tmp/content"/>
            </soapCall>
          </if>
        </enter>
      </input>
      <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/@type]=0">
        <input label="Location on the server" readOnly="true" xpath="properties/@outputFile"/>
        <input label="Number of lines" readOnly="true" xpath="properties/@toDeliver"/>
      </container>
      <container colcount="2" colspan="2" setOriginalAsDefault="true">
        <input img="xtk:preview.png" label="Restart data preview" name="launchButton" type="urlButton">
          <enter>
            <set expr="iif ([/tmp/@type]=0, 1, 0)" xpath="/tmp/@type"/>
          </enter>
        </input>
        <input align="right" label="Lines to display" type="number" xpath="/tmp/@nbLines"/>
      </container>
      <input colspan="2" contentType="txt" nolabel="true" readOnly="true" toolbar="false" type="codeEdit" xpath="/tmp/content"/>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Marketing offers environment" maxLabelWidth="50" md5="D12D61E9C8C6E216708D7AA466A87314" name="offerEnv" namespace="nms" xpathsToLoad="sampleCallData/*,filter/*,prodEnv/@name" xtkschema="xtk:form">
      <enter>
        <set expr="@live" xpath="/ignored/@prodEnv"/>
        <set expr="'nms:offerContext'" xpath="/ignored/@offerContextSchema"/>
        <if expr="hasPackage('nms:interactionControl')">
          <if expr="NodeCount(executionInstance) == 0">
            <set value="0" xpath="/tmp/@stateInstance"/>
          </if>
          <if expr="NodeCount(executionInstance) == 1">
            <set value="1" xpath="/tmp/@stateInstance"/>
          </if>
          <if expr="NodeCount(executionInstance) > 1">
            <set value="2" xpath="/tmp/@stateInstance"/>
          </if>
          <set expr="[executionInstance/@extAccount-id]" xpath="executionInstance/@extAccount-id"/>
          <set expr="[executionInstance/@extAccount-id]" xpath="/tmp/executionInstance/@extAccount-id"/>
          <set expr="[executionInstance/@extAccount-cs]" xpath="/tmp/executionInstance/@extAccount-cs"/>
          <set expr="[executionInstance/@updateInterval]" xpath="/tmp/executionInstance/@updateInterval"/>
          <set expr="[executionInstance/@active]" xpath="/tmp/executionInstance/@active"/>
          <set expr="[executionInstance/@filterExpr]" xpath="/tmp/executionInstance/@filterExpr"/>
        </if>
      </enter>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container name="general">
          <container colcount="2">
            <input xpath="@label"/>
            <input xpath="@name"/>
          </container>
          <container label="Type of environment" type="frame">
            <container type="visibleGroup" visibleIf="@live">
              <input checkedValue="0" label="Design (changes not recommended)" type="radioButton" xpath="@live"/>
              <input checkedValue="1" label="Live" type="radioButton" xpath="@live"/>
            </container>
            <container type="visibleGroup" visibleIf="!@live">
              <input checkedValue="0" label="Design" type="radioButton" xpath="@live"/>
              <input checkedValue="1" label="Live (changes not recommended)" type="radioButton" xpath="@live"/>
            </container>
            <static label=" " nolabel="false" type="help">A live environment is a version used for inbound and outbound interactions (read only)</static>
            <container type="visibleGroup" visibleIf="!@live">
              <input label="Linked live environment" xpath="prodEnv">
                <sysFilter>
                  <condition expr="@model = 'nmsOfferEnv'"/>
                  <condition expr="@id != $(@id)"/>
                </sysFilter>
              </input>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:interactionControl')" type="visibleGroup" visibleIf="@live=0">
            <container label="Execution instances" type="frame">
              <input checkedValue="0" label="No instance" type="radioButton" xpath="/tmp/@stateInstance"/>
              <input checkedValue="1" label="One instance" type="radioButton" xpath="/tmp/@stateInstance"/>
              <input checkedValue="2" label="Multiple instances" type="radioButton" xpath="/tmp/@stateInstance"/>
              <container type="visibleGroup" visibleIf="[/tmp/@stateInstance] != 0">
                <container type="visibleGroup" visibleIf="[/tmp/@stateInstance]=1">
                  <input computeStringAlias="/tmp/executionInstance/@extAccount-cs" label="External account" schema="nms:extAccount" type="linkedit" xpath="/tmp/executionInstance/@extAccount-id">
                    <sysFilter>
                      <condition expr="@active=true"/>
                      <condition expr="@type=11"/>
                      <condition expr="@isInteraction=true"/>
                    </sysFilter>
                  </input>
                  <input label="Frequency of updates" type="timespan" xpath="/tmp/executionInstance/@updateInterval"/>
                  <input label="Proposition filtering" nolabel="false" schemaExpr="Iif(@anonymous, 'nms:visitor', [filter/@schema])" type="pathEdit" xpath="/tmp/executionInstance/@filterExpr"/>
                </container>
                <input expr="[/tmp/@stateInstance]" type="expr" xpath="">
                  <enter>
                    <if expr="[/tmp/@stateInstance]=2">
                      <set expr="[/tmp/executionInstance/@extAccount-id]" xpath="executionInstance/@extAccount-id"/>
                      <set expr="[/tmp/executionInstance/@extAccount-cs]" xpath="executionInstance/@extAccount-cs"/>
                      <set expr="[/tmp/executionInstance/@updateInterval]" xpath="executionInstance/@updateInterval"/>
                      <set expr="[/tmp/executionInstance/@filterExpr]" xpath="executionInstance/@filterExpr"/>
                    </if>
                    <if expr="[/tmp/@stateInstance]!=2">
                      <set expr="[executionInstance/@extAccount-id]" xpath="/tmp/executionInstance/@extAccount-id"/>
                      <set expr="[executionInstance/@extAccount-cs]" xpath="/tmp/executionInstance/@extAccount-cs"/>
                      <set expr="[executionInstance/@updateInterval]" xpath="/tmp/executionInstance/@updateInterval"/>
                      <set expr="[executionInstance/@filterExpr]" xpath="/tmp/executionInstance/@filterExpr"/>
                    </if>
                  </enter>
                </input>
                <container type="visibleGroup" visibleIf="[/tmp/@stateInstance]=2">
                  <input lineCount="5" nolabel="true" type="list" xpath="executionInstance">
                    <input xpath="extAccount">
                      <sysFilter>
                        <condition epxr="@active=true"/>
                        <condition expr="@type=11"/>
                        <condition expr="@isInteraction=true"/>
                      </sysFilter>
                    </input>
                    <input xpath="@updateInterval"/>
                    <input label="Proposition filtering" schemaExpr="Iif([../@anonymous], 'nms:visitor', [../filter/@schema])" type="pathEdit" xpath="@filterExpr"/>
                    <input xpath="@active"/>
                  </input>
                </container>
              </container>
              <container type="visibleGroup" visibleIf="[/tmp/@stateInstance] != 0">
                <static type="help">Proposition filtering must be performed on contact criteria. It must allow you to define exclusive segments with an architect.</static>
              </container>
            </container>
          </container>
          <container applicableIf="HasPackage('nms:interaction')">
            <input useDesc="true" xpath="@anonymous"/>
            <input expr="@anonymous" type="expr" xpath="/tmp/@anonymous">
              <enter>
                <if expr="@anonymous=1">
                  <set value="nms:visitor" xpath="filter/@schema"/>
                  <set value="nms:propositionVisitor" xpath="@propositionSchema"/>
                </if>
              </enter>
            </input>
            <container type="visibleGroup" visibleIf="!@anonymous">
              <container label="Individuals targeted by the offers in this environment" type="frame">
                <input type="schemaEdit" xpath="filter/@schema"/>
              </container>
            </container>
            <container type="visibleGroup" visibleIf="@anonymous">
              <container label="Visitors targeted by the offers in this environment" type="frame">
                <input readOnly="true" type="schemaEdit" xpath="filter/@schema"/>
                <input xpath="visitorFolder"/>
              </container>
            </container>
            <container label="Storage of generated propositions" type="frame">
              <container type="visibleGroup" visibleIf="!@anonymous">
                <input type="schemaEdit" xpath="@propositionSchema"/>
              </container>
              <container type="visibleGroup" visibleIf="@anonymous">
                <input readOnly="true" type="schemaEdit" xpath="@propositionSchema"/>
              </container>
              <input type="schemaEdit" xpath="@inputSchema"/>
            </container>
            <static label="Implicit identification of individuals (if the function is enabled in the space)" type="separator"/>
            <input createMode="none" xpath="deliveryMapping"/>
          </container>
          <container applicableIf="HasPackage('nms:interaction')=false">
            <static label="Individuals targeted by the offers in this environment" type="separator"/>
            <input type="schemaEdit" xpath="filter/@schema"/>
            <static label="Storage of generated propositions" type="separator"/>
            <input type="schemaEdit" xpath="@propositionSchema"/>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="comment"/>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:interaction')">
        <container type="notebook">
          <container img="xtk:properties.png" label="General" ref="nms:offerEnv:lib/general"/>
          <container img="nms:rcpgroup.png" label="Eligibility" maxLabelWidth="200" name="constraints">
            <static img="nms:typorule.png" label="Presentation rules" type="separator"/>
            <input createMode="none" xpath="typology">
              <sysFilter>
                <condition enabledIf="$(@prodEnv-id) != 0" expr="[folder/@name] != ('nmsTypology' + $(prodEnv/@name))"/>
              </sysFilter>
            </input>
            <static img="nms:miniatures/mini-query.png" label="Filters on the target" type="separator"/>
            <input label="Edit query..." prebuildSubForm="false" type="subFormLink" xpath="filter">
              <form label="Select targeting filtering conditions" type="wizard">
                <container desc="Select a target restriction filter." firstActivatedIf="NodeCount(where) == 0" name="filter" title="Select the population">
                  <container name="filterList">
                    <static label="List of restriction filters" type="separator"/>
                    <input dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="@schema" xpathWhere="where"/>
                  </container>
                </container>
                <container desc="Specify the filtering conditions used to select the records" enabledButtonLabelIf="[/ignored/@currentFilterStack] == true" img="nms:pictoprofile.png" name="targetPage" nextButtonLabel="Refine the target>" nextPage="filter" title="Population item">
                  <container name="targetPageFocus" style="flat" type="notebook">
                    <container label="Criteria">
                      <static label="Filter settings" type="separator"/>
                      <input type="filterView" xpath="." xpathFilter="/ignored/@filterName" xpathQueryLabel="humanCond" xpathSchema="@schema"/>
                    </container>
                    <container label="Preview">
                      <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="/ignored/previewList" xpathSchema="@schema" xpathTargetPart="."/>
                    </container>
                  </container>
                  <leave>
                    <set value="1" xpath="/ignored/@addFilter"/>
                    <set value="" xpath="/ignored/@filterName"/>
                  </leave>
                </container>
              </form>
            </input>
            <input fontBold="true" noBorder="true" nolabel="true" readOnlyExpr="true" xpath="filter/humanCond"/>
          </container>
          <container img="nms:offerContext.png" label="Offer weight">
            <input colspan="2" hideEditButtons="true" img="nms:offerContext.png" nolabel="true" toolbarCaption="Weight management for the offers in the environment" type="dynamicLinkList" xpath="context" xpathSchema="/ignored/@offerContextSchema" zoom="true">
              <input xpath="offer"/>
              <input xpath="offer/category"/>
              <input xpath="@label"/>
              <input xpath="@weightExpr"/>
              <input xpath="@startDate"/>
              <input xpath="@endDate"/>
              <input label="Filter" xpath="filter/humanCond"/>
              <sysFilter>
                <condition expr="[offer/category/@env-id]=$(@id)"/>
              </sysFilter>
              <orderBy>
                <node expr="[@offer-id]"/>
              </orderBy>
            </input>
          </container>
          <container img="xtk:preview.png" label="Example of call data">
            <input name="editSampleCallData" nolabel="true" prebuildSubForm="false" type="list" xpath="sampleCallData" zoom="true" zoomOnAdd="true">
              <input xpath="@label"/>
              <input xpath="@name"/>
              <form label="Definition of a call data example">
                <enter>
                  <if expr="NodeExists(callData)=false">
                    <set value=" " xpath="callData"/>
                  </if>
                </enter>
                <container colcount="2">
                  <input xpath="@label"/>
                  <input xpath="@name"/>
                </container>
                <container img="xtk:help.png" label="Help" type="frame">
                  <static>Please insert here the data in XML format to be used as call data examples during the preview.
    E.g.:
    &lt;callData&gt;
      &lt;elem1&gt;value1&lt;/elem1&gt;
      &lt;elem2 attr1="value1" attr2="value2"/&gt;
    &lt;callData&gt;</static>
                </container>
                <input nolabel="true" type="SourceEdit" xpath="callData"/>
              </form>
            </input>
          </container>
        </container>
      </container>
      <container type="visibleGroup" visibleIf="HasPackage('nms:interaction')=false">
        <container ref="nms:offerEnv:lib/general"/>
      </container>
      <leave>
        <if expr="[/tmp/@stateInstance]=0">
          <forEach xpath="executionInstance">
            <reset delete="true" xpath="../executionInstance[1]"/>
          </forEach>
        </if>
        <if expr="[/tmp/@stateInstance]=1">
          <if expr="![/tmp/executionInstance/@extAccount-id]">
            <reset delete="true" xpath="executionInstance[1]"/>
          </if>
          <if expr="[/tmp/executionInstance/@extAccount-id]">
            <set expr="[/tmp/executionInstance/@extAccount-id]" xpath="executionInstance/@extAccount-id"/>
            <set expr="[/tmp/executionInstance/@extAccount-cs]" xpath="executionInstance/@extAccount-cs"/>
            <set expr="[/tmp/executionInstance/@updateInterval]" xpath="executionInstance/@updateInterval"/>
            <set expr="[/tmp/executionInstance/@filterExpr]" xpath="executionInstance/@filterExpr"/>
            <set value="1" xpath="executionInstance/@active"/>
          </if>
          <forEach xpath="executionInstance">
            <if expr="[@extAccount-id]!=[../executionInstance[1]/@extAccount-id]">
              <reset delete="true" xpath="../executionInstance[2]"/>
            </if>
          </forEach>
        </if>
        <forEach xpath="executionInstance">
          <check expr="[@extAccount-id]">
            <error>You must specify an external account.</error>
          </check>
        </forEach>
        <check expr="[/ignored/@prodEnv]=0 OR @live=false">
          <error>You may not make changes to an environment in production.</error>
        </check>
        <set expr="@live" xpath="/ignored/@prodEnv"/>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Marketing offer category" maxLabelWidth="50" md5="F3246D0AEBF105A367D2092320F31764" name="offerCategory" namespace="nms" type="notebook" xpathsToLoad="@fullName,@env-id,filter/@schema,filter/*,env/@inputSchema,env/@live" xtkschema="xtk:form">
      <enter>
        <set expr="extendWithInteraction([filter/@schema],[env/@inputSchema])" xpath="/ignored/@extSchema"/>
        <set expr="'nms:offerContext'" xpath="/ignored/@offerContextSchema"/>
      </enter>
      <container colcount="2" img="xtk:properties.png" label="General" name="properties">
        <input xpath="@label"/>
        <input xpath="@name"/>
        <input readOnly="true" xpath="env"/>
        <container type="visibleGroup" visibleIf="!@edition and [env/@live]=false">
          <value fontBold="true" xpath="@productionDate"/>
        </container>
        <container type="visibleGroup" visibleIf="@productionDate='' or [env/@live]">
          <container type="visibleGroup" visibleIf="[env/@live]">
            <static/>
          </container>
          <container type="visibleGroup" visibleIf="[env/@live]=false">
            <static label="The category hasn't been deployed yet." type="warning"/>
          </container>
        </container>
        <container type="visibleGroup" visibleIf="@productionDate!='' and @edition and [env/@live]=false">
          <value fontBold="true" xpath="@productionDate"/>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@productionDate!='' and @edition and [env/@live]=false">
          <static label=" " nolabel="false" type="warning">The category was modified since its last deployment.</static>
          <input img="nms:prepare.png" label="Deploy" nolabel="true" prebuildSubForm="false" type="subFormButton">
            <form entity-schema="xtk:job" label="Go live">
              <enter>
                <set value="1" xpath="@doNotPersist"/>
              </enter>
              <container refreshPeriod="1500" serverTimeNotStable="true" type="jobProgressContainer">
                <soapCall name="GoLive" service="nms:offerCategory">
                  <param type="int" xpath="/offerCategory/@id"/>
                </soapCall>
                <static label="Click 'Start' to deploy the category." type="help"/>
                <input name="JobLogsList" type="JobLogList"/>
                <container colcount="2">
                  <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
                  <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
                </container>
                <container colcount="2">
                  <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/tmp/properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="/tmp/properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
                  <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
                </container>
              </container>
              <leave>
                <check expr="[/tmp/@inProcess] = false">
                  <error>Execution in progress, please cancel before closing.</error>
                </check>
              </leave>
            </form>
          </input>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="HasPackage('nms:interaction')=false">
          <static colspan="2" label="Application themes (propagated to the child categories)" type="separator"/>
          <input colspan="2" xpath="@offerThemes"/>
          <static colspan="2" label=" " nolabel="false" type="help">List of offer themes separated by commas</static>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="comment"/>
        </container>
        <container colcount="2" colspan="2" type="visibleGroup" visibleIf="HasPackage('nms:interaction')">
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="comment"/>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:interaction')" colcount="2" img="nms:rcpgroup.png" label="Eligibility" name="constraints">
        <input xpath="@active"/>
        <static label="Disabling a category disables all its offers and child category offers." type="help"/>
        <static colspan="2" img="nms:week.png" label="Default eligibility dates" type="separator"/>
        <input xpath="@startDate"/>
        <input xpath="@endDate"/>
        <static colspan="2" label="Application themes (propagated to the child categories)" type="separator"/>
        <input colspan="2" xpath="@offerThemes"/>
        <static colspan="2" label=" " nolabel="false" type="help">List of themes separated by commas</static>
        <static colspan="2" label="Default categories" type="separator"/>
        <input colspan="2" label="Always include this category in the recommendations" xpath="@alwaysEligible"/>
        <static colspan="2" label="Multiplier factor applicable to offer weights in this category" type="separator"/>
        <container colcount="2" colspan="2">
          <input xpath="@weight"/>
          <input xpath="@weightStartDate"/>
          <static/>
          <input xpath="@weightEndDate"/>
        </container>
        <static colspan="2" img="nms:miniatures/mini-query.png" label="Filters on the target" type="separator"/>
        <input colspan="2" label="Edit query..." prebuildSubForm="false" type="subFormLink" xpath="filter">
          <form label="Select targeting filtering conditions" type="wizard">
            <container desc="Select a target restriction filter." firstActivatedIf="NodeCount(where) == 0" name="filter" title="Select the population">
              <container name="filterList">
                <static label="List of restriction filters" type="separator"/>
                <input dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="@schema" xpathWhere="where"/>
              </container>
            </container>
            <container desc="Specify the filtering conditions used to select the records" enabledButtonLabelIf="[/ignored/@currentFilterStack] == true" img="nms:pictoprofile.png" name="targetPage" nextButtonLabel="Refine the target>" nextPage="filter" title="Population item">
              <container name="targetPageFocus" style="flat" type="notebook">
                <container label="Criteria">
                  <static label="Filter settings" type="separator"/>
                  <input type="filterView" xpath="." xpathFilter="/ignored/@filterName" xpathQueryLabel="humanCond" xpathSchema="@schema"/>
                </container>
                <container label="Preview">
                  <static label="The preview only takes into account the rules specified in this window. It does not take rules defined elsewhere into account (parent categories, start or end dates, etc.)." type="warning"/>
                  <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="/ignored/previewList" xpathSchema="@schema" xpathTargetPart="."/>
                </container>
              </container>
              <leave>
                <set value="1" xpath="/ignored/@addFilter"/>
                <set value="" xpath="/ignored/@filterName"/>
              </leave>
            </container>
          </form>
        </input>
        <input colspan="2" fontBold="true" noBorder="true" nolabel="true" readOnly="true" xpath="filter/humanCond"/>
      </container>
      <container applicableIf="HasPackage('nms:interaction')" img="nms:offerContext.png" label="Offer weight">
        <input colspan="2" hideEditButtons="true" img="nms:offerContext.png" nolabel="true" toolbarCaption="Weight management for the offers in the category" type="dynamicLinkList" xpath="context" xpathSchema="/ignored/@offerContextSchema" zoom="true">
          <input xpath="offer/category"/>
          <input xpath="offer"/>
          <input xpath="@label"/>
          <input xpath="@weightExpr"/>
          <input xpath="@startDate"/>
          <input xpath="@endDate"/>
          <input xpath="filter/humanCond"/>
          <sysFilter>
            <condition expr="[offer/category/@fullName] like $(@fullName) + '%'"/>
          </sysFilter>
          <orderBy>
            <node expr="[offer/@category-id]"/>
          </orderBy>
        </input>
      </container>
      <leave>
        <check expr="![env/@live]">
          <error>You may not make changes to a category in production.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Offer spaces" md5="24746AD524EDF74FE5E4B1132A7FDB71" name="offerSpace" namespace="nms" type="iconbox" xpathsToLoad="env/@propositionSchema,env/@inputSchema,env/filter/@schema,env/@name" xpathsToLoadOpt="env/@deliveryMapping-id,env/@anonymous" xtkschema="xtk:form">
      <enter>
        <if expr="[@env-id]=0 or [env/filter/@schema]=''">
          <set value="nms:offerEnv" xpath="/ignored/queryDef/@schema"/>
          <set value="@id" xpath="/ignored/queryDef/select/node[1]/@expr"/>
          <set value="[filter/@schema]" xpath="/ignored/queryDef/select/node[2]/@expr"/>
          <set value="@schema" xpath="/ignored/queryDef/select/node[2]/@alias"/>
          <set value="[@propositionSchema]" xpath="/ignored/queryDef/select/node[3]/@expr"/>
          <set value="[.]" xpath="/ignored/queryDef/select/node[4]/@expr"/>
          <set value="@fullName" xpath="/ignored/queryDef/select/node[5]/@expr"/>
          <set value="@name" xpath="/ignored/queryDef/select/node[6]/@expr"/>
          <if expr="HasPackage('nms:interaction')">
            <set value="[deliveryMapping/@targetSchema]" xpath="/ignored/queryDef/select/node[7]/@expr"/>
            <set value="[@deliveryMapping-id]" xpath="/ignored/queryDef/select/node[8]/@expr"/>
          </if>
          <set value="get" xpath="/ignored/queryDef/@operation"/>
          <set expr="'@id=GetOfferEnv('+[@folder-id]+')'" xpath="/ignored/queryDef/where/condition/@expr"/>
          <soapCall name="ExecuteQuery" service="xtk:queryDef">
            <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
            <param type="DOMDocument" xpathOut="/ignored/env"/>
          </soapCall>
          <set expr="[/ignored/env/@id]" xpath="@env-id"/>
          <set expr="[/ignored/env/@id]" xpath="env/@id"/>
          <set expr="[/ignored/env/@schema]" xpath="env/filter/@schema"/>
          <set expr="[/ignored/env/@propositionSchema]" xpath="env/@propositionSchema"/>
          <set expr="[/ignored/env/@_cs]" xpath="env/@_cs"/>
          <set expr="[/ignored/env/@fullName]" xpath="env/@fullName"/>
          <set expr="[/ignored/env/@name]" xpath="env/@name"/>
          <if expr="HasPackage('nms:interaction')">
            <if expr="[/ignored/env/@deliveryMapping-id]!=0">
              <set expr="[/ignored/env/deliveryMapping/@targetSchema]" xpath="env/deliveryMapping/@targetSchema"/>
              <set expr="[/ignored/env/@deliveryMapping-id]" xpath="env/@deliveryMapping-id"/>
              <set expr="[/ignored/env/@deliveryMapping-id]" xpath="env/deliveryMapping/@id"/>
            </if>
          </if>
        </if>
        <soapCall name="GetUrls" service="nms:offerSpace">
          <param exprIn="@id" type="int"/>
          <param type="string" xpathOut="/ignored/@offerSpaceUrl"/>
        </soapCall>
        <set expr="extendWithInteraction([env/filter/@schema],[env/@inputSchema])" xpath="/ignored/@extSchema"/>
        <if expr="[/ignored/preview/@maxPropositionCount]=''">
          <set value="1" xpath="/ignored/preview/@maxPropositionCount"/>
        </if>
        <if expr="HasPackage('nms:interaction')">
          <if expr="[env/@deliveryMapping-id]!=0">
            <if expr="[env/@anonymous]">
              <set value="nms:deliveryMapping" xpath="/ignored/queryDef2/@schema"/>
              <set value="@targetSchema" xpath="/ignored/queryDef2/select/node[1]/@expr"/>
              <set value="get" xpath="/ignored/queryDef2/@operation"/>
              <set expr="'@id='+[env/@deliveryMapping-id]" xpath="/ignored/queryDef2/where/condition/@expr"/>
              <soapCall name="ExecuteQuery" service="xtk:queryDef">
                <param exprIn="[/ignored/queryDef2]" type="DOMDocument"/>
                <param type="DOMDocument" xpathOut="/ignored/env/deliveryMapping"/>
              </soapCall>
              <set expr="[/ignored/env/deliveryMapping/@targetSchema]" xpath="env/deliveryMapping/@targetSchema"/>
            </if>
            <if expr="@implicitIdentification">
              <set expr="extendSchema([env/filter/@schema],[env/deliveryMapping/@targetSchema], @implicitIdentification)" xpath="/ignored/@extSchema"/>
            </if>
          </if>
        </if>
        <set value="" xpath="/tmp/@generatedCode"/>
        <set value="0" xpath="/tmp/@generatedCalled"/>
      </enter>
      <input translatedExpr="'Proposition being processed'" type="expr" xpath="/ignored/@currentPropositionLabel"/>
      <input expr="Iif( NodeValue('env/@propositionSchema')!='', 'currentProposition,' + [/ignored/@currentPropositionLabel] + ',' + NodeValue('env/@propositionSchema'), '')" type="expr" xpath="/ignored/@additionalLinks"/>
      <container img="xtk:properties.png" label="Properties" maxLabelWidth="200">
        <container colcount="2">
          <input xpath="@label"/>
          <input xpath="@name"/>
          <input xpath="@channel">
            <enter name="onChange">
              <if expr="HasPackage('nms:interaction')">
                <set expr="@channel>=50" xpath="@unitary"/>
              </if>
            </enter>
          </input>
          <input readOnly="true" xpath="env"/>
          <container applicableIf="HasPackage('nms:interaction')" colcount="2" colspan="2">
            <input createMode="none" img="nms:offerCategory.png" xpath="defaultCategory">
              <sysFilter>
                <condition expr="[@env-id]=$(env/@id) OR @id=$(env/@id)"/>
              </sysFilter>
            </input>
            <input xpath="@defaultThemes"/>
            <input xpath="@unitary"/>
          </container>
          <input applicableIf="HasPackage('nms:interaction')" img="xtk:properties.png" label="Advanced parameters..." nolabel="true" prebuildSubForm="true" type="subFormLink">
            <form label="Advanced parameters" type="notebook">
              <container label="Target identification">
                <input label="Search keys" nolabel="true" type="list" xpath="targetKey">
                  <input choiceType="xpath" type="pathEdit" xpath="@xpath" xpathSchema="../env/filter/@schema"/>
                </input>
              </container>
              <container label="Scripts in unitary mode">
                <container style="flat" type="notebook">
                  <container label="Target loading">
                    <input nolabel="true" xpath="extension/@useTargetScript"/>
                    <container enabledIf="[extension/@useTargetScript]" type="enabledGroup">
                      <input contentType="JavaScript" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="extension/target"/>
                    </container>
                  </container>
                  <container label="Proposition post-processing">
                    <input contentType="JavaScript" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="extension/postBuildPropositions"/>
                  </container>
                </container>
              </container>
            </form>
          </input>
          <container type="visibleGroup" visibleIf="@deploymentDate!='' and @edition=false and [env/@live]=false">
            <value fontBold="true" xpath="@deploymentDate"/>
          </container>
          <container type="visibleGroup" visibleIf="@deploymentDate='' or [env/@live]">
            <container type="visibleGroup" visibleIf="[env/@live]">
              <static/>
            </container>
            <container type="visibleGroup" visibleIf="[env/@live]=false">
              <static label="The offer space hasn't been deployed yet." type="warning"/>
            </container>
          </container>
          <container type="visibleGroup" visibleIf="@deploymentDate!='' and @edition and [env/@live]=false">
            <value fontBold="true" xpath="@deploymentDate"/>
            <static label="The space was modified since its last deployment." type="warning"/>
          </container>
        </container>
        <container>
          <static label="Fields of the offer content used for this offer space" type="separator"/>
          <input label=" " lineCount="7" name="editRepresentationFields" type="list" xpath="representationFields">
            <input choiceType="export" schema="nms:offer" type="pathEdit" xpath="@xpath"/>
            <input xpath="@isMandatory"/>
          </input>
          <static label="Rendering functions" type="separator"/>
          <input label="Edit functions..." nolabel="true" type="subFormLink" xpath=".">
            <form type="notebook">
              <container label="XML rendering">
                <input nolabel="true" xpath="rendering/@useXmlFunction"/>
                <static type="warning">The XML rendering function can only be used in unitary mode.</static>
                <container enabledIf="[rendering/@useXmlFunction]" type="enabledGroup">
                  <input contentType="JavaScript" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="rendering/xmlFunction"/>
                </container>
              </container>
              <container label="HTML rendering">
                <input nolabel="true" xpath="rendering/@useHtmlFunction"/>
                <container enabledIf="[rendering/@useHtmlFunction]" type="enabledGroup">
                  <input contentType="JavaScript" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="rendering/htmlFunction"/>
                </container>
              </container>
              <container label="Text rendering">
                <input nolabel="true" xpath="rendering/@useTextFunction"/>
                <static type="warning">The text rendering function can only be used in batch mode.</static>
                <container enabledIf="[rendering/@useTextFunction]" type="enabledGroup">
                  <input contentType="JavaScript" nolabel="true" toolbar="true" type="ContentResEdit" wrap="false" xpath="rendering/textFunction"/>
                </container>
              </container>
            </form>
          </input>
          <input expr="[rendering/@useXmlFunction]+[rendering/@useHtmlFunction]+[rendering/@useTextFunction]" type="expr" xpath="/tmp/function">
            <enter>
              <reset xpath="/tmp/functionDesc"/>
              <if expr="[rendering/@useHtmlFunction]">
                <if expr="IndexOf([rendering/htmlFunction], 'function') != -1 and IndexOf([rendering/htmlFunction], '{') != -1">
                  <set expr="SubString([rendering/htmlFunction], IndexOf([rendering/htmlFunction], 'function'), IndexOf([rendering/htmlFunction], '{') - IndexOf([rendering/htmlFunction], 'function'))" xpath="/tmp/function"/>
                </if>
                <set translatedExpr="'HTML rendering: '+[/tmp/function]+'\n'" xpath="/tmp/functionDesc"/>
              </if>
              <if expr="[rendering/@useXmlFunction]">
                <if expr="IndexOf([rendering/xmlFunction], 'function') != -1 and IndexOf([rendering/xmlFunction], '{') != -1">
                  <set expr="SubString([rendering/xmlFunction], IndexOf([rendering/xmlFunction], 'function'), IndexOf([rendering/xmlFunction], '{') - IndexOf([rendering/xmlFunction], 'function'))" xpath="/tmp/function"/>
                </if>
                <set translatedExpr="[/tmp/functionDesc]+'XML rendering: '+[/tmp/function]+'\n'" xpath="/tmp/functionDesc"/>
              </if>
              <if expr="[rendering/@useTextFunction]">
                <if expr="IndexOf([rendering/textFunction], 'function') != -1 and IndexOf([rendering/textFunction], '{') != -1">
                  <set expr="SubString([rendering/textFunction], IndexOf([rendering/textFunction], 'function'), IndexOf([rendering/textFunction], '{') - IndexOf([rendering/textFunction], 'function'))" xpath="/tmp/function"/>
                </if>
                <set translatedExpr="[/tmp/functionDesc]+'Text rendering : '+[/tmp/function]" xpath="/tmp/functionDesc"/>
              </if>
            </enter>
          </input>
          <container type="visibleGroup" visibleIf="[rendering/@useXmlFunction] or [rendering/@useHtmlFunction] or [rendering/@useTextFunction]">
            <input label=" " lineCount="3" noBorder="true" readOnly="true" type="edit" xpath="/tmp/functionDesc"/>
            <static label=" " nolabel="false" type="help">Please check that function signature is still compatible.</static>
          </container>
          <static label="Unitary calls" type="separator"/>
          <input label="URL" readOnly="true" type="edit" xpath="/ignored/@offerSpaceUrl"/>
          <static label=" " nolabel="false" type="help">URL for accessing the real time web service.</static>
          <container applicableIf="HasPackage('nms:interaction')">
            <container type="visibleGroup" visibleIf="![env/@anonymous]">
              <input label="Implicitly identify the individual based on their browser history (warning: may affect performance)" xpath="@implicitIdentification"/>
            </container>
            <container type="visibleGroup" visibleIf="[env/@anonymous]">
              <input label="Link an individual recognized implicitly based on their browser history (warning: may affect performance)" xpath="@implicitIdentification"/>
            </container>
            <input expr="@implicitIdentification" type="expr" xpath="/tmp/@implicitIdentification">
              <enter>
                <if expr="[env/@deliveryMapping-id]!=0">
                  <set expr="extendSchema([env/filter/@schema],[env/deliveryMapping/@targetSchema], @implicitIdentification)" xpath="/ignored/@extSchema"/>
                </if>
              </enter>
            </input>
            <container type="visibleGroup" visibleIf="![env/@anonymous]">
              <input useDesc="true" xpath="@anonymousFallback"/>
            </container>
            <container type="visibleGroup" visibleIf="@anonymousFallback">
              <static label=" " nolabel="false">Linked anonymous space:</static>
              <input createMode="none" label=" " xpath="fallbackOfferSpace">
                <sysFilter>
                  <condition expr="[env/@anonymous]=1"/>
                  <condition expr="[env/@live]=false"/>
                </sysFilter>
              </input>
            </container>
          </container>
          <static label="Description" type="separator"/>
          <input nolabel="true" xpath="desc"/>
        </container>
      </container>
      <container colcount="2" img="xtk:database.png" label="Storage">
        <static colspan="2" label="Proposition insertion" type="separator"/>
        <input colspan="2" xpath="@disablePropositionStorage"/>
        <static colspan="2" label="On proposition" type="separator"/>
        <input label="Status" xpath="@defaultStatus"/>
        <static label="Default value for the proposition status." type="help"/>
        <input colspan="2" name="editFormulas" nolabel="true" type="list" xpath="propositionFormula">
          <input hideMappedAsXml="false" label="Storage path" type="pathedit" xpath="@xpath" xpathSchema="../env/@propositionSchema"/>
          <input hideMappedAsXml="false" label="Expression" type="pathEdit" xpath="@expr" xpathAdditionalLinks="/ignored/@additionalLinks" xpathSchema="../env/filter/@schema"/>
        </input>
        <static colspan="2" type="help">Define here the formulas used to calculate the values that will be set and stored with the propositions when generated.</static>
        <static colspan="2" label="On acceptance" type="separator"/>
        <input label="Status" xpath="@defaultUpdateStatus"/>
        <static label="Default value of the proposition status when accepted." type="help"/>
        <input colspan="2" name="editAcceptanceFormulas" nolabel="true" type="list" xpath="acceptanceFormula">
          <input hideMappedAsXml="false" label="Storage path" type="pathedit" xpath="@xpath" xpathSchema="../env/@propositionSchema"/>
          <input hideMappedAsXml="false" label="Expression" type="pathEdit" xpath="@expr" xpathSchema="../env/filter/@schema"/>
        </input>
        <static colspan="2" type="help">Define here the formulas used to calculate the values that will be set and stored with the propositions when accepted or rejected.</static>
      </container>
      <container img="nms:proposition.png" label="Propositions" name="propositions">
        <container img="nms:proposition.png" label="Propositions" name="propositions">
          <input hideEditButtons="true" img="nms:proposition.png" nolabel="true" refresh="true" toolbarCaption="Propositions made using this space" type="dynamicLinkList" xpath="." xpathSchema="env/@propositionSchema">
            <input xpath="@eventDate"/>
            <input xpath="offer"/>
            <input xpath="@rank"/>
            <input xpath="@weight"/>
            <input xpath="@status"/>
            <orderBy>
              <node expr="@eventDate" sortDesc="true"/>
            </orderBy>
          </input>
        </container>
      </container>
      <container applicableIf="HasPackage('nms:interaction')" img="xtk:preview.png" label="Preview" name="preview">
        <container colcount="2">
          <input createMode="none" label="Target" type="linkEdit" xpath="/ignored/preview/@recipient-id" xpathSchema="/offerSpace/env/filter/@schema"/>
          <input label="Propositions" type="number" xpath="/ignored/preview/@maxPropositionCount"/>
          <input createMode="none" label="Category" schema="nms:offerCategory" type="linkEdit" xpath="/ignored/preview/category">
            <enter name="onChange">
              <if expr="[/ignored/preview/category]=''">
                <set value="" xpath="/ignored/preview/category/@name"/>
              </if>
              <if expr="[/ignored/preview/category]!=''">
                <set value="nms:offerCategory" xpath="/ignored/queryDef3/@schema"/>
                <set value="@name" xpath="/ignored/queryDef3/select/node[1]/@expr"/>
                <set value="get" xpath="/ignored/queryDef3/@operation"/>
                <set expr="'@id='+[/ignored/preview/category]" xpath="/ignored/queryDef3/where/condition/@expr"/>
                <soapCall name="ExecuteQuery" service="xtk:queryDef">
                  <param exprIn="[/ignored/queryDef3]" type="DOMDocument"/>
                  <param type="DOMDocument" xpathOut="/ignored/preview/category"/>
                </soapCall>
              </if>
            </enter>
            <sysFilter>
              <condition expr="@fullName like $(env/@fullName) + '%'"/>
              <condition expr="@model like 'nmsOfferCategory%'"/>
            </sysFilter>
          </input>
          <input label="Themes" xpath="/ignored/preview/@themes"/>
        </container>
        <input alwaysActive="true" forceNavigate="true" sessionToken="true" type="urlViewer" urlExpr="Iif([/ignored/preview/@maxPropositionCount]>0, $(serverUrl) + '/webApp/interactionPreview?_decorate=0&amp;standalone=1&amp;space=' + @id + '&amp;target=' + [/ignored/preview/@recipient-id] + '&amp;count=' + [/ignored/preview/@maxPropositionCount] + '&amp;categories=' + [/ignored/preview/category/@name] + '&amp;themes=' + [/ignored/preview/@themes], '')"/>
      </container>
      <container img="xtk:logs.png" label="Audit" name="log">
        <container type="notebook">
          <container label="Log">
            <input enumImage="@logType" hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Technical log messages" type="linkList" xpath="log">
              <input xpath="@logDate"/>
              <input xpath="@message"/>
              <orderBy>
                <node expr="@id" sortDesc="true"/>
              </orderBy>
            </input>
          </container>
          <container label="Code" name="generatedCode">
            <input img="xtk:refresh.png" label="Refresh the generated code" type="urlButton">
              <enter>
                <soapCall name="GetGeneratedCode" service="nms:offerSpace">
                  <param exprIn="/offerSpace" type="DOMElement"/>
                  <param type="string" xpathOut="/tmp/@generatedCode"/>
                </soapCall>
                <set value="1" xpath="/tmp/@generatedCalled"/>
              </enter>
            </input>
            <container type="visibleGroup" visibleIf="[/tmp/@generatedCode] != ''">
              <input contentType="JavaScript" nolabel="true" readOnly="true" type="CodeEdit" xpath="/tmp/@generatedCode"/>
            </container>
            <container type="visibleGroup" visibleIf="[/tmp/@generatedCode] = '' and [/tmp/@generatedCalled]">
              <input label="To show the preview, please publish the offer space." type="help"/>
            </container>
          </container>
        </container>
      </container>
      <leave>
        <check expr="![env/@live]">
          <error>You may not make changes to an offer space in production.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entitySchema="xtk:form" img="xtk:form.png" label="Offer" maxLabelWidth="50" md5="DA4B9C2D82641BEAF5E29B5091A1118C" name="offer" namespace="nms" xpathsToLoad="category/@env-id,category/env/@propositionSchema,category/env/@inputSchema,filter/*,@contentStatus,@eligibilityStatus" xpathsToLoadOpt="hypothesis/*,category/env/@deliveryMapping-id,eligibilityValidation/*,contentValidation/*" xtkschema="xtk:form">
      <enter name="add">
        <set value="nms:offer" xpath="/ignored/@schema"/>
        <set value="0" xpath="/ignored/@addReminder"/>
        <if expr="!@isModel and [filter/@schema]='' and [@category-id]!=0">
          <set value="nms:offerCategory" xpath="/ignored/queryDef/@schema"/>
          <set value="get" xpath="/ignored/queryDef/@operation"/>
          <set value="[env/filter/@schema]" xpath="/ignored/queryDef/select/node/@expr"/>
          <set value="[env/@propositionSchema]" xpath="/ignored/queryDef/select/node[2]/@expr"/>
          <set value="[@env-id]" xpath="/ignored/queryDef/select/node[3]/@expr"/>
          <set expr="'@id='+[@category-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
          <soapCall name="ExecuteQuery" service="xtk:queryDef">
            <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
            <param type="DOMDocument" xpathOut="/ignored/offerCategory"/>
          </soapCall>
          <set expr="[/ignored/offerCategory/env/filter/@schema]" xpath="filter/@schema"/>
          <set expr="[/ignored/offerCategory/@env-id]" xpath="category/@env-id"/>
          <set expr="[@category-id]" xpath="category/@id"/>
          <set expr="[/ignored/offerCategory/@env-id]" xpath="category/env/@id"/>
          <set expr="[/ignored/offerCategory/env/@propositionSchema]" xpath="category/env/@propositionSchema"/>
          <set value="1" xpath="/tmp/@dupOffer"/>
        </if>
        <if expr="[/ignored/offerCategory/env/filter/@schema]=''">
          <set value="''" xpath="/ignored/offerCategory/env/filter/@schema"/>
        </if>
        <if expr="HasPackage('nms:interaction')">
          <set value="1" xpath="/ignored/@currentOfferId"/>
          <if expr="[category/env/@deliveryMapping-id] != 0">
            <if expr="[category/env/@deliveryMapping-id]!='0'">
              <set value="nms:deliveryMapping" xpath="/ignored/queryDef2/@schema"/>
              <set value="@targetSchema" xpath="/ignored/queryDef2/select/node[1]/@expr"/>
              <set value="get" xpath="/ignored/queryDef2/@operation"/>
              <set expr="'@id='+[category/env/@deliveryMapping-id]" xpath="/ignored/queryDef2/where/condition/@expr"/>
              <soapCall name="ExecuteQuery" service="xtk:queryDef">
                <param exprIn="[/ignored/queryDef2]" type="DOMDocument"/>
                <param type="DOMDocument" xpathOut="/ignored/deliveryMapping"/>
              </soapCall>
              <set expr="[/ignored/deliveryMapping/@targetSchema]" xpath="category/env/deliveryMapping/@targetSchema"/>
            </if>
          </if>
        </if>
        <if expr="@isModel">
          <set expr="[filter/@targetSchema]" xpath="filter/@schema"/>
        </if>
        <set expr="@isModel" xpath="/ignored/@isModel"/>
      </enter>
      <input expr="extendWithInteraction([/offer/filter/@schema],[category/env/@inputSchema])" type="expr" xpath="/ignored/@extSchema"/>
      <input expr="@id" type="expr" xpath="/ignored/preview/ctx/@currentOfferId"/>
      <container name="menuBuilder" visibleIf="0">
        <container menuId="viewMenuBuilder" name="viewMenuBuilder" type="deliveryMenuBuilder">
          <form label="Selection of a field of the target" name="selectTargetDlg" nothingToSave="true">
            <enter>
              <set expr="[/offer/filter/@schema]" xpath="/tmp/customSelect/@schema"/>
            </enter>
            <container showCollections="true" type="customizeSelect" xpath="/tmp/customSelect/@schema" xpathName="/ignored/customizeBtnOut/subForm/@label" xpathOut="/ignored/customizeBtnOut/subForm/@cmd"/>
          </form>
          <form label="Select a field of the recipient" name="selectRecipientDlg" nothingToSave="true">
            <container showCollections="true" type="customizeSelect" xpath="/tmp/schema/@recipient" xpathName="/ignored/customizeBtnOut/subForm/@label" xpathOut="/ignored/customizeBtnOut/subForm/@cmd"/>
          </form>
          <form label="Option selection" name="selectOptDlg" nothingToSave="true">
            <container defaultColumns="@name,@dataType,desc" exprOut1="@name" schema="xtk:option" sharedUserConfig="true" type="navTreeEntityList" xpath="." xpathOut1="@name"/>
          </form>
          <form colcount="2" label="Insert a barcode" name="insertBarcode" nothingToSave="true" xpath="/tmp/barcode/">
            <enter>
              <set value="QRCode" xpath="/tmp/barcode/@type"/>
              <set value="1" xpath="/tmp/barcode/@scale"/>
              <set value="100" xpath="/tmp/barcode/@height"/>
              <set value="100" xpath="/tmp/barcode/@width"/>
              <set value="H" xpath="/tmp/barcode/@errCorr"/>
            </enter>
            <input colspan="2" enum="nms:common:barcodeType" label="Type" type="sysenum" xpath="@type"/>
            <input colspan="2" label="Value" menuId="viewMenuBuilder" type="scriptEdit" xpath="@valueExpr"/>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type!='QRCode'">
              <input enum="nms:common:barcodeScale" label="Scale" type="sysenum" xpath="@scale"/>
              <input label="Height" type="number" xpath="@height"/>
            </container>
            <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@type='QRCode'">
              <input colspan="2" enum="nms:common:qrcodeErrCorr" label="Error correction" type="sysenum" xpath="@errCorr"/>
              <input label="Width" type="number" xpath="@height"/>
              <input label="Height" type="number" xpath="@width"/>
            </container>
          </form>
          <form label="Select a personalization block" name="selectIncDlg" nothingToSave="true">
            <container defaultColumns="@label,@name" exprOut1="@name" exprOut2="@label" nodeModel="nmsIncludeView" schema="nms:includeView" sharedUserConfig="true" type="navTreeEntityList" xpath="." xpathOut1="@name" xpathOut2="@label">
              <sysFilter>
                <condition expr="@visible=1"/>
              </sysFilter>
            </container>
            <input label="Include the HTML source code of the block" type="checkBox" xpath="/ignored/customizeBtnOut/subForm/@inlineMode"/>
          </form>
        </container>
      </container>
      <container colcount="2" type="visibleGroup" visibleIf="[/tmp/@newOffer]=1">
        <static colspan="2" img="nms:circle-one.png">Select an offer template</static>
        <input boldLineExpr="@builtIn=1" choiceButton="true" colspan="2" defaultModelSearchExpr="Iif([/ignored/offerCategory/env/filter/@schema]== 'nms:recipient', '@name=\'emptyOffer\'','')" folderFilterChoice="@model='nmsOfferModel'" fullLoad="true" img="nms:offer.png" label="Offer template" newFromModelOnChange="true" noZoom="true" schema="nms:offer" selectionPath="/tmp/model" type="linkEdit" xpath="/tmp/@model" zoom="false">
          <sysFilter>
            <condition expr="@isModel = 1"/>
            <condition enabledIf="$(/tmp/@folderId)!=0" expr="[filter/@targetSchema] = $(/ignored/offerCategory/env/filter/@schema)"/>
          </sysFilter>
          <orderBy>
            <node expr="@builtIn" sortDesc="true"/>
            <node expr="@label"/>
          </orderBy>
          <enter name="onChange">
            <if expr="HasPackage('nms:interaction') == false">
              <set expr="EVal(@eligibilityStatus, 'validated')" xpath="@eligibilityStatus"/>
            </if>
          </enter>
        </input>
        <static colspan="2" img="nms:circle-two.png">Complete or modify parameters</static>
        <container colcount="2" colspan="2" ref="nms:offer:lib/general"/>
      </container>
      <container name="lib" type="visibleGroup" visibleIf="false">
        <container colcount="2" name="general">
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/@newOffer]!=1">
            <input xpath="@label"/>
            <input xpath="@name"/>
          </container>
          <container colspan="2" padding-right="6" type="visibleGroup" visibleIf="[/tmp/@newOffer]=1">
            <input xpath="@label"/>
            <input xpath="@code"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="@isModel">
            <input required="true" type="schemaEdit" xpath="filter/@targetSchema"/>
            <input xpath="@code"/>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="!@isModel and [/tmp/@newOffer]!=1 and [category/env/@live]=false">
            <input readOnly="true" xpath="@status"/>
            <input createMode="none" noZoom="true" xpath="owner">
              <orderBy>
                <node expr="@type"/>
              </orderBy>
              <sysFilter>
                <condition expr="@type != 2"/>
              </sysFilter>
            </input>
          </container>
          <container colcount="2" colspan="2" type="visibleGroup" visibleIf="[/tmp/@newOffer]!=1">
            <input xpath="@code"/>
            <container applicableIf="HasPackage('nms:campaign')" type="visibleGroup" visibleIf="![category/env/@live] and HasPackage('nms:campaign')">
              <input img="xtk:properties.png" label="Advanced settings..." nolabel="false" type="subFormLink">
                <form label="Advanced parameters">
                  <container label="Eligibility approval" type="frame">
                    <container colcount="2" ref="nms:operation:lib/assignee" xpath="eligibilityValidation"/>
                  </container>
                  <container label="Content approval" type="frame">
                    <container colcount="2" ref="nms:operation:lib/assignee" xpath="contentValidation"/>
                  </container>
                </form>
              </input>
            </container>
            <container type="visibleGroup" visibleIf="[category/env/@live] or HasPackage('nms:campaign')=false">
              <static/>
            </container>
          </container>
          <container colspan="2" padding-right="6" type="visibleGroup" visibleIf="[/tmp/@folderId]=0">
            <input img="nms:offerCategory.png" label="Category" writeAccess="true" xpath="category">
              <sysFilter>
                <condition expr="@model='nmsOfferCategory'"/>
              </sysFilter>
              <enter name="onChange">
                <reset xpath="/ignored/offerCategory"/>
                <set value="nms:offerCategory" xpath="/ignored/queryDef/@schema"/>
                <set value="get" xpath="/ignored/queryDef/@operation"/>
                <set value="[env/filter/@schema]" xpath="/ignored/queryDef/select/node/@expr"/>
                <set value="[env/@propositionSchema]" xpath="/ignored/queryDef/select/node[2]/@expr"/>
                <set value="[@env-id]" xpath="/ignored/queryDef/select/node[3]/@expr"/>
                <set expr="'@id='+[@category-id]" xpath="/ignored/queryDef/where/condition/@expr"/>
                <soapCall name="ExecuteQuery" service="xtk:queryDef">
                  <param exprIn="[/ignored/queryDef]" type="DOMDocument"/>
                  <param type="DOMDocument" xpathOut="/ignored/offerCategory"/>
                </soapCall>
                <set expr="[/ignored/offerCategory/env/filter/@schema]" xpath="filter/@schema"/>
                <set expr="[/ignored/offerCategory/@env-id]" xpath="category/@env-id"/>
                <set expr="[@category-id]" xpath="category/@id"/>
                <set expr="[/ignored/offerCategory/@env-id]" xpath="category/env/@id"/>
                <set expr="[/ignored/offerCategory/env/@propositionSchema]" xpath="category/env/@propositionSchema"/>
                <if expr="[/ignored/offerCategory/env/filter/@schema]=''">
                  <set value="''" xpath="/ignored/offerCategory/env/filter/@schema"/>
                </if>
                <if expr="HasPackage('nms:interaction')">
                  <set value="nms:deliveryMapping" xpath="/ignored/queryDef2/@schema"/>
                  <set value="@targetSchema" xpath="/ignored/queryDef2/select/node[1]/@expr"/>
                  <set value="get" xpath="/ignored/queryDef2/@operation"/>
                  <set expr="'@id='+[category/env/@deliveryMapping-id]" xpath="/ignored/queryDef2/where/condition/@expr"/>
                  <soapCall name="ExecuteQuery" service="xtk:queryDef">
                    <param exprIn="[/ignored/queryDef2]" type="DOMDocument"/>
                    <param type="DOMDocument" xpathOut="/ignored/deliveryMapping"/>
                  </soapCall>
                  <set expr="[/ignored/deliveryMapping/@targetSchema]" xpath="category/env/deliveryMapping/@targetSchema"/>
                </if>
              </enter>
            </input>
          </container>
          <static colspan="2" label="Description" type="separator"/>
          <input colspan="2" nolabel="true" xpath="desc"/>
        </container>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@newOffer]!=1 and [/tmp/@dupOffer]=1">
        <container colcount="2" ref="nms:offer:lib/general"/>
      </container>
      <container type="visibleGroup" visibleIf="[/tmp/@newOffer]!=1 and [/tmp/@dupOffer]!=1">
        <container type="notebook">
          <container firstActivatedIf="true" img="nms:offer.png" label="Dashboard" visibleIf="!@isModel">
            <input entityRefresh="nms:offer" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/nms/offer.jssp?id='+@id+'&amp;action='+[/ignored/@action]+'&amp;standalone=1'"/>
          </container>
          <container img="xtk:form.png" label="Edit" visibleIf="@id!=0">
            <container type="iconbox">
              <container colcount="2" img="xtk:properties.png" label="General" ref="nms:offer:lib/general"/>
              <container applicableIf="HasPackage('nms:interaction')" img="nms:rcpgroup.png" label="Eligibility" name="constraints">
                <container type="visibleGroup" visibleIf="EV(@eligibilityStatus, 'validationPending', 'inProcess', 'validated') and [category/env/@live]=false"></container>
                <static colspan="2" img="nms:week.png" label="Eligibility dates (offer and parent category eligibility period intersections will be taken into account)" type="separator"/>
                <container colcount="2">
                  <input xpath="@startDate"/>
                  <input xpath="@endDate"/>
                </container>
                <static img="nms:miniatures/mini-query.png" label="Filters on the target" type="separator"/>
                <input label="Edit query..." prebuildSubForm="false" propagateXPathToCtx="/ignored/@currentOfferId|/@currentOfferId" type="subFormLink" xpath="filter">
                  <form label="Select targeting filtering conditions" type="wizard">
                    <enter>
                      <if expr="[../@isModel] and @targetSchema!=''">
                        <set expr="@targetSchema" xpath="@schema"/>
                      </if>
                    </enter>
                    <container desc="Select a target restriction filter." firstActivatedIf="NodeCount(where) == 0" name="filter" title="Select the population">
                      <container name="filterList">
                        <static label="List of restriction filters" type="separator"/>
                        <input dblClickAction="wizNext" img="xtk:filter.png" noEditCollection="true" noToolbar="true" nolabel="true" type="filterList" xpath="/tmp/filterList" xpathFilter="/ignored/@filterName" xpathSchema="@schema" xpathWhere="where"/>
                      </container>
                    </container>
                    <container desc="Specify the filtering conditions used to select the records" enabledButtonLabelIf="[/ignored/@currentFilterStack] == true" img="nms:pictoprofile.png" name="targetPage" nextButtonLabel="Refine the target>" nextPage="filter" title="Population item">
                      <container name="targetPageFocus" style="flat" type="notebook">
                        <container label="Criteria">
                          <static label="Filter settings" type="separator"/>
                          <input propagateXPathToCtx="/ignored/@currentOfferId|/@currentOfferId" type="filterView" xpath="." xpathFilter="/ignored/@filterName" xpathQueryLabel="humanCond" xpathSchema="@schema"/>
                        </container>
                        <container label="Preview">
                          <static label="The preview only takes into account the rules specified in this window. It does not take rules defined elsewhere into account (category, start or end dates, etc.)." type="warning"/>
                          <input hideEditButtons="true" name="targetPreviewQuery" noToolbar="true" nolabel="true" type="filterPreviewList" xpath="/ignored/previewList" xpathPreviewCtx="/ignored/preview/ctx" xpathSchema="@schema" xpathTargetPart="."/>
                        </container>
                      </container>
                      <leave>
                        <set value="1" xpath="/ignored/@addFilter"/>
                        <set value="" xpath="/ignored/@filterName"/>
                      </leave>
                    </container>
                  </form>
                </input>
                <input fontBold="true" lineCount="5" noBorder="true" nolabel="true" readOnly="true" xpath="filter/humanCond"/>
                <input img="nms:offerContext.png" nolabel="true" propagateXPathToCtx="@category-id,@isModel" propagateXPathToCtxOnAdd="@category-id,@isModel,filter/@targetSchema" toolbarCaption="Managing offer weight" type="linklist" xpath="context" zoom="true">
                  <input xpath="@weightExpr"/>
                  <input expr="@label"/>
                  <input xpath="@startDate"/>
                  <input xpath="@endDate"/>
                  <input label="Filter" xpath="filter/humanCond"/>
                </input>
              </container>
              <container img="nms:offerView.png" label="Content" visibleIf="@id!=0" xpath="view">
                <container type="visibleGroup" visibleIf="EV([/offer/@contentStatus], 'validationPending', 'inProcess', 'validated') and [/offer/category/env/@live]=false"></container>
                <container colcount="2" nolabel="true" type="frame">
                  <input label="Title" margin-right="5" prebuildSubForm="false" type="subFormLink" xpath="shortContent_jst">
                    <form label="Editing title" name="editForm" nothingToSave="true">
                      <input nolabel="true" toolbarAlign="horizontal" type="jstEdit" xpath="." xpathInsert="/ignored/customizeShortContent">
                        <container>
                          <input menuId="viewMenuBuilder" options="inbound" type="customizeBtn" xpath="/ignored/customizeShortContent"/>
                        </container>
                      </input>
                    </form>
                  </input>
                  <input nolabel="true" type="edit" xpath="shortContent_jst"/>
                  <input label="Destination URL" margin-right="5" prebuildSubForm="false" type="subFormLink" xpath="trackedUrls/url_jst">
                    <form label="Editing the destination URL" name="editForm" nothingToSave="true">
                      <input nolabel="true" toolbarAlign="horizontal" type="jstEdit" xpath="." xpathInsert="/ignored/customizeDestURL">
                        <container>
                          <input menuId="viewMenuBuilder" options="inbound" type="customizeBtn" xpath="/ignored/customizeDestURL"/>
                        </container>
                      </input>
                    </form>
                  </input>
                  <input nolabel="true" type="edit" xpath="trackedUrls/url_jst"/>
                  <input label="Image URL" margin-right="5" prebuildSubForm="false" type="subFormLink" xpath="imageUrl_jst">
                    <form label="Editing the image URL" name="editForm" nothingToSave="true">
                      <input nolabel="true" toolbarAlign="horizontal" type="jstEdit" xpath="." xpathInsert="/ignored/customizeImageURL">
                        <container>
                          <input menuId="viewMenuBuilder" options="inbound" type="customizeBtn" xpath="/ignored/customizeImageURL"/>
                        </container>
                      </input>
                    </form>
                  </input>
                  <container colcount="3">
                    <input nolabel="true" type="edit" xpath="imageUrl_jst"/>
                    <input img="xtk:image.png" label="Select an image..." prebuildSubForm="false" type="flatSubFormButton">
                      <form label="Select an image" nothingToSave="true">
                        <input monoSelection="true" notifyPathList="@useMd5AsFilename,@name,@md5" schema="xtk:fileRes" toolbarCaption="List of available images" type="linkListChoice" xpath="." xpathOut="/tmp/image">
                          <input xpath="[.]"/>
                        </input>
                        <leave>
                          <soapCall name="GetPublicFileResURL" service="xtk:fileRes">
                            <param type="string" xpathOut="/tmp/imageUrl"/>
                          </soapCall>
                          <set value="xtk:fileRes" xpath="/ignored/image/queryDef/@schema"/>
                          <set value="get" xpath="/ignored/image/queryDef/@operation"/>
                          <set value="@useMd5AsFilename" xpath="/ignored/image/queryDef/select/node/@expr"/>
                          <set value="@name" xpath="/ignored/image/queryDef/select/node[2]/@expr"/>
                          <set value="@md5" xpath="/ignored/image/queryDef/select/node[3]/@expr"/>
                          <set expr="'@id='+[/tmp/image/fileRes/@id]" xpath="/ignored/image/queryDef/where/condition/@expr"/>
                          <soapCall name="ExecuteQuery" service="xtk:queryDef">
                            <param exprIn="[/ignored/image/queryDef]" type="DOMDocument"/>
                            <param type="DOMDocument" xpathOut="/tmp/image"/>
                          </soapCall>
                          <set expr="[/tmp/imageUrl] + iif([/tmp/image/@useMd5AsFilename], [/tmp/image/@md5] + '.' + FileExt([/tmp/image/@name]),[/tmp/image/@name])" xpath="/offer/view/imageUrl_jst"/>
                        </leave>
                      </form>
                    </input>
                    <container enabledIf="[imageUrl_jst]!=''" type="enabledGroup">
                      <input img="xtk:preview.png" label="Image preview" prebuildSubForm="false" type="flatSubFormButton">
                        <form label="Image preview" readOnlyExpr="true">
                          <input label="Image URL" type="edit" xpath="/offer/view/imageUrl_jst"/>
                          <input forceNavigate="true" type="urlViewer" urlExpr="[/offer/view/imageUrl_jst]"/>
                        </form>
                      </input>
                    </container>
                  </container>
                  <input label="Define the acceptance URL..." margin-right="5" prebuildSubForm="true" type="subFormLink" xpath="/offer/view/unitaryUpdateStatusUrl_jst">
                    <form label="Acceptance URL in unitary mode" name="editForm">
                      <static label="The acceptance URL is used in unitary mode." type="help"/>
                      <input nolabel="true" toolbarAlign="horizontal" type="jstEdit" xpath="." xpathInsert="/ignored/customizeUpdateStatusURL">
                        <container>
                          <input menuId="viewMenuBuilder" options="inbound" type="customizeBtn" xpath="/ignored/customizeUpdateStatusURL"/>
                        </container>
                      </input>
                    </form>
                  </input>
                  <input align="right" img="xtk:help.png" label="Content definitions" prebuildSubForm="false" type="subFormLink">
                    <form label="Content definitions" nothingToEdit="true">
                      <input alwaysActive="true" forceNavigate="true" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl)+'/nms/offerContentHelper.jssp?id='+@id"/>
                    </form>
                  </input>
                </container>
                <container type="notebook">
                  <container label="HTML content">
                    <input fullToolbar="true" name="ctSourceHtml" nolabel="true" type="htmlSource" uploadImages="true" xpath="htmlSource_jst" xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                      <form label="Resource publishing" nothingToEdit="true" nothingToSave="true">
                        <container name="localResourcesUploader" type="localResourcesUploader" xpathCurProgress="/tmp/@uploadCurrent" xpathFilesToDownload="/tmp/localResources" xpathMaxProgress="/tmp/@uploadMax">
                          <input name="JobLogsList" type="JobLogList"/>
                          <container colcount="2">
                            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="/tmp/@uploadCurrent" xpathMax="/tmp/@uploadMax"/>
                            <input hidden="true" label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
                          </container>
                        </container>
                      </form>
                      <container>
                        <input menuId="viewMenuBuilder" options="html,inbound" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                      </container>
                    </input>
                  </container>
                  <container label="Text content">
                    <input fullToolbar="true" htmlMode="false" name="ctSourceText" nolabel="true" type="htmlSource" xpath="textSource_jst" xpathInsert="/ignored/customizeBtnOut" xpathUrl="/tmp/urlTree/@toSelect">
                      <container>
                        <input menuId="viewMenuBuilder" options="inbound" type="customizeBtn" xpath="/ignored/customizeBtnOut"/>
                      </container>
                    </input>
                  </container>
                </container>
              </container>
              <container img="nms:response.png" label="Measure">
                <container ref="nms:delivery:lib/measureROI" xpath="forecast"/>
                <container applicableIf="HasPackage('nms:response')" type="visibleGroup" visibleIf="!@isModel">
                  <static label="Calculation of effective ROI" type="separator"/>
                  <container ref="nms:operation:lib/hypothesis"/>
                </container>
              </container>
              <container img="nms:proposition.png" label="Propositions" visibleIf="@isModel=false and [category/env/@live]">
                <container applicableIf="HasPackage('nms:interaction')=false">
                  <input hideEditButtons="true" img="nms:proposition.png" nolabel="true" refresh="true" toolbarCaption="Propositions made for this offer" type="dynamicLinkList" xpath="." xpathObjectSchema="filter/@schema" xpathSchema="category/env/@propositionSchema">
                    <input xpath="@eventDate"/>
                    <input xpath="offerSpace"/>
                    <input xpathObjectSchema="filter/@schema"/>
                    <input xpath="@rank"/>
                    <input xpath="@status"/>
                    <orderBy>
                      <node expr="@eventDate" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="![category/env/@anonymous]">
                  <input hideEditButtons="true" img="nms:proposition.png" nolabel="true" refresh="true" toolbarCaption="Propositions made for this offer" type="dynamicLinkList" xpath="." xpathObjectSchema="filter/@schema" xpathSchema="category/env/@propositionSchema">
                    <input xpath="@eventDate"/>
                    <input xpath="offerSpace"/>
                    <input xpathObjectSchema="filter/@schema"/>
                    <input xpath="@rank"/>
                    <input xpath="@status"/>
                    <orderBy>
                      <node expr="@eventDate" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
                <container applicableIf="HasPackage('nms:interaction')" type="visibleGroup" visibleIf="[category/env/@anonymous]">
                  <input hideEditButtons="true" img="nms:proposition.png" nolabel="true" refresh="true" toolbarCaption="Propositions made for this offer" type="linkList" xpath="propositionVisitor">
                    <input xpath="@eventDate"/>
                    <input xpath="offerSpace"/>
                    <input xpath="@rank"/>
                    <input xpath="@status"/>
                    <orderBy>
                      <node expr="@eventDate" sortDesc="true"/>
                    </orderBy>
                  </input>
                </container>
              </container>
              <container img="xtk:logs.png" label="Audit" visibleIf="!@isModel">
                <container type="notebook">
                  <container label="Log">
                    <input hideEditButtons="true" img="xtk:logs.png" nolabel="true" refresh="true" toolbarCaption="Technical log messages" type="linkList" xpath="log">
                      <input xpath="@logDate"/>
                      <input xpath="@message"/>
                      <orderBy>
                        <node expr="@id" sortDesc="true"/>
                      </orderBy>
                    </input>
                  </container>
                  <container applicableIf="HasPackage('nms:campaign')" label="Approvals" visibleIf="![category/env/@live]">
                    <container colspan="2" type="visibleGroup" visibleIf="EV(@eligibilityStatus, 'inProcess', 'refused') or EV(@contentStatus, 'inProcess', 'refused')">
                      <static img="nl:smallcalendar.png" label="Processing schedule" type="separator"/>
                      <container colspan="2" readOnlyIf="HasNamedRight('approvalAdministration')=false" type="readOnlyGroup">
                        <input lineCount="4" nolabel="true" notitle="true" type="treeEdit">
                          <container label="Schedule">
                            <input img="nl:smallcalendar.png" label="Eligibility approval deadline" visibleIf="EV(@eligibilityStatus, 'inProcess', 'refused') and @expectedEligibility!=''" xpath="@expectedEligibility"/>
                            <input img="nms:alarmon.png" label="Eligibility reminder" visibleIf="@reminderEligibility!=''" xpath="@reminderEligibility"/>
                            <input img="nl:smallcalendar.png" label="Content approval deadline" visibleIf="EV(@contentStatus, 'inProcess', 'refused') and @expectedContent!=''" xpath="@expectedContent"/>
                            <input img="nms:alarmon.png" label="Content reminder" visibleIf="@reminderContent!=''" xpath="@reminderContent"/>
                          </container>
                        </input>
                      </container>
                    </container>
                    <input enumImage="@action" hideEditButtons="true" img="nms:validation.png" nolabel="true" refresh="true" toolbarCaption="Approvals log" type="linklist" xpath="validationLog" zoom="true">
                      <input xpath="@date"/>
                      <input xpath="@action"/>
                      <input xpath="@type"/>
                      <input xpath="validatedBy"/>
                      <input xpath="comment"/>
                      <orderBy>
                        <node expr="@date" sortDesc="true"/>
                      </orderBy>
                    </input>
                  </container>
                  <container label="Representations">
                    <input delButton="true" enumImage="space/@channel" hideEditButtons="true" img="nms:offerView.png" nolabel="true" refresh="true" toolbarCaption="Offer representations" type="linklist" xpath="offerView" zoom="false">
                      <input xpath="space/@label"/>
                      <input xpath="@status"/>
                    </input>
                  </container>
                </container>
              </container>
            </container>
          </container>
          <container img="xtk:preview.png" label="Preview" name="preview" visibleIf="@id!=0 and [@isModel]=false">
            <input alwaysActive="true" forceNavigate="true" sessionToken="true" type="urlViewer" urlExpr="$(serverUrl) + '/webApp/offerValidation?previewMode=1&amp;validationType=12'+'&amp;offerId=' + @id+'&amp;standalone=1'"/>
          </container>
        </container>
      </container>
      <leave>
        <check expr="![category/env/@live]">
          <error>You may not make changes to an offer in production.</error>
        </check>
        <check expr="EV(@status, 'productionPending')=false">
          <error>You may not make changes to an offer that is pending to go live. To change this offer, please reinitialize its approval process.</error>
        </check>
        <if expr="[/tmp/@folderId]!=0 AND [/tmp/@folderId]!=''">
          <set expr="[/tmp/@folderId]" xpath="@category-id"/>
        </if>
        <check expr="[@category-id]!=0">
          <error>The parent category is not specified.</error>
        </check>
        <if expr="[/tmp/@newOffer]=1">
          <soapCall name="Complete" noRefresh="true" service="nms:offer">
            <param exprIn="." type="DOMElement"/>
            <param type="DOMElement" xpathOut="."/>
          </soapCall>
        </if>
        <if expr="@isModel">
          <set value="0" xpath="@owner-id"/>
        </if>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="nms:packages/interaction.png" label="Offer space deployment" md5="E78832AC4DAA81EE0FBE6D5600236A59" name="offerSpaceDeployment" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container desc="Please select the destination environment." title="Deployment settings">
        <input dblClickAction="wizNext" label="Environment" monoSelection="true" schema="nms:offerEnv" setOnClick="true" type="linkListChoice" xpath="." xpathOut="/tmp">
          <input xpath="[.]"/>
          <sysFilter>
            <condition boolOperator="AND" expr="@model like 'nmsOfferEnv%'"/>
            <condition boolOperator="AND" expr="space" setOperator="NOT EXISTS">
              <condition expr="$noescaping(/job/userArgs/spaces/where/condition/@expr)"/>
            </condition>
          </sysFilter>
        </input>
      </container>
      <container desc="Click 'Start' to run deployment for the selected environment." name="finish" title="Deployment">
        <value fontBold="true" label="Environment" xpath="/tmp/offerEnv/@_cs"/>
        <container refreshPeriod="1500" serverTimeNotStable="true" type="jobProgressContainer">
          <soapCall name="Deploy" service="nms:offerSpace">
            <param type="DOMElement" xpath="/job/userArgs/spaces/where"/>
            <param type="int" xpath="/tmp/offerEnv/@id"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <leave>
        <check expr="[/tmp/@inProcess] = false">
          <error>Execution in progress, please cancel before closing.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:form">
    <form entity-schema="xtk:job" entitySchema="xtk:form" img="nms:packages/interaction.png" label="Offer deployment" md5="53B593488DF7ABB5302E93BC6E0BE355" name="offerDeployment" namespace="nms" nothingToEdit="true" nothingToSave="true" type="wizard" xtkschema="xtk:form">
      <enter>
        <set value="true" xpath="@doNotPersist"/>
      </enter>
      <container desc="Please select the destination environment." img="nms:packages/interaction.png" title="Deployment settings">
        <input dblClickAction="wizNext" monoSelection="true" schema="nms:offerEnv" setOnClick="true" type="linkListChoice" xpath="." xpathOut="/tmp">
          <input xpath="[.]"/>
          <sysFilter>
            <condition boolOperator="AND" expr="@model like 'nmsOfferEnv%'"/>
            <condition boolOperator="AND" expr="offerCategory" setOperator="NOT EXISTS">
              <condition expr="offer" setOperator="EXISTS">
                <condition expr="$noescaping(/job/userArgs/offers/where/condition/@expr)"/>
              </condition>
            </condition>
          </sysFilter>
        </input>
      </container>
      <container desc="Click 'Start' to run deployment for the selected environment." img="nms:packages/interaction.png" name="finish" title="Deployment">
        <value fontBold="true" label="Environment" xpath="/tmp/offerEnv/@_cs"/>
        <container refreshPeriod="1500" serverTimeNotStable="true" type="jobProgressContainer">
          <soapCall name="Deploy" service="nms:offer">
            <param type="DOMElement" xpath="/job/userArgs/offers/where"/>
            <param type="int" xpath="/tmp/offerEnv/@id"/>
          </soapCall>
          <input name="JobLogsList" type="JobLogList"/>
          <container colcount="2">
            <value dataType="timespan" label="Elapsed" xpath="/tmp/timing/@elapsed"/>
            <value dataType="timespan" label="Estimated left" xpath="/tmp/timing/@remaining"/>
          </container>
          <container colcount="2">
            <value name="JobProgressBar" type="ProgressBar" valign="center" xpathCur="properties/progress/@current" xpathElapsed="/tmp/timing/@elapsed" xpathMax="properties/progress/@max" xpathRemaining="/tmp/timing/@remaining"/>
            <input label="&amp;Start" name="JobSubmitButton" type="flatbutton"/>
          </container>
        </container>
      </container>
      <leave>
        <check expr="[/tmp/@inProcess] = false">
          <error>Execution in progress, please cancel before closing.</error>
        </check>
      </leave>
    </form>
  </entities>
  <entities schema="xtk:specFile">
    <specFile img="xtk:installedPackage.png" includeDefaultValues="false" includeInstallScript="false" includeSpec="true" label="data backup" name="localData" namespace="ami" type="0">
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,serverOptions" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:serverOptions">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='serverOptions'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,session" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:session">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='session'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,sessionInfo" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:sessionInfo">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='sessionInfo'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,specFile" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:specFile">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='specFile'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,sql" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:sql">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='sql'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,sqlSchema" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:sqlSchema">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='sqlSchema'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,srcSchema" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:srcSchema">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='srcSchema'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,strings" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:strings">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='strings'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,workflow" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:workflow">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflow'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,workflowEvent" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:workflowEvent">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowEvent'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,workflowJob" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:workflowJob">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowJob'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,workflowLog" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:workflowLog">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowLog'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,workflowLogin" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:workflowLogin">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowLogin'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,workflowTask" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:workflowTask">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowTask'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,xslt" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:xslt">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='xslt'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,country" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:country">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='country'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,state" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:state">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='state'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nl,monitoring" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nl:monitoring">
          <condition expr="@namespace='nl'" internalId="1"/>
          <condition expr="@name='monitoring'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nl,serverConf" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nl:serverConf">
          <condition expr="@namespace='nl'" internalId="1"/>
          <condition expr="@name='serverConf'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,address" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:address">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='address'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,billing" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:billing">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='billing'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,broadLog" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:broadLog">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='broadLog'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,broadLogRcp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:broadLogRcp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='broadLogRcp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,broadLogVisitor" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:broadLogVisitor">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='broadLogVisitor'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,fileRes" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:fileRes">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fileRes'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,fileResData" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:fileResData">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fileResData'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,fileResHistory" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:fileResHistory">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fileResHistory'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,folder" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:folder">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='folder'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,form" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:form">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='form'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,formRendering" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:formRendering">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='formRendering'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,funcList" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:funcList">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='funcList'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,fusion" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:fusion">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fusion'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,group" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:group">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='group'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,image" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:image">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='image'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,javascript" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:javascript">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='javascript'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,job" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:job">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='job'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,jobLog" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:jobLog">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='jobLog'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,jssp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:jssp">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='jssp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,jst" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:jst">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='jst'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,navtree" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:navtree">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='navtree'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,none" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:none">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='none'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,olapAggregate" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:olapAggregate">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapAggregate'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,olapCube" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:olapCube">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapCube'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,olapDimension" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:olapDimension">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapDimension'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,olapMeasure" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:olapMeasure">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapMeasure'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,operator" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:operator">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='operator'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,operatorGroup" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:operatorGroup">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='operatorGroup'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,opsecurity" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:opsecurity">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='opsecurity'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,option" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:option">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='option'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,package" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:package">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='package'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,packageInstall" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:packageInstall">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='packageInstall'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,pkgInstRel" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:pkgInstRel">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='pkgInstRel'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,queryDef" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:queryDef">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='queryDef'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,queryFilter" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:queryFilter">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='queryFilter'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,report" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:report">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='report'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,reportHistory" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:reportHistory">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='reportHistory'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,reportRights" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:reportRights">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='reportRights'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,resourceMenu" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:resourceMenu">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='resourceMenu'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,rights" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:rights">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='rights'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,schema" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:schema">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='schema'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,scriptContext" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:scriptContext">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='scriptContext'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,serverConf" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:serverConf">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='serverConf'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,abstractForm" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:abstractForm">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='abstractForm'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,builder" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:builder">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='builder'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,common" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:common">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='common'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,conflict" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:conflict">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='conflict'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,connections" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:connections">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='connections'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,counter" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:counter">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='counter'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,dashboard" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:dashboard">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dashboard'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,dataTransfer" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:dataTransfer">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dataTransfer'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,dbInit" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:dbInit">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dbInit'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,dictionaryString" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:dictionaryString">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dictionaryString'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,entity" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:entity">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='entity'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,entityBackupNew" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:entityBackupNew">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='entityBackupNew'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,entityBackupOriginal" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:entityBackupOriginal">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='entityBackupOriginal'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,entityOriginal" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:entityOriginal">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='entityOriginal'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,enum" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:enum">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='enum'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,enumAlias" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:enumAlias">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='enumAlias'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,xtk,enumValue" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="xtk:enumValue">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='enumValue'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,excludeLogRcp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:excludeLogRcp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='excludeLogRcp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,broadLogOp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:broadLogOp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='broadLogOp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,broadLogMsg" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:broadLogMsg">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='broadLogMsg'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,providerMsgId" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:providerMsgId">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='providerMsgId'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,calendar" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:calendar">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='calendar'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,typology" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:typology">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='typology'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,typologyRule" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:typologyRule">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='typologyRule'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,typologyRuleRel" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:typologyRuleRel">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='typologyRuleRel'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,common" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:common">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='common'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,dataTransfer" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:dataTransfer">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='dataTransfer'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,delivery" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:delivery">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='delivery'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,seedMember" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:seedMember">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='seedMember'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,deliveryMapping" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:deliveryMapping">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='deliveryMapping'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,deliveryPart" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:deliveryPart">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='deliveryPart'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,deliveryStat" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:deliveryStat">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='deliveryStat'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,deliveryLogStats" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:deliveryLogStats">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='deliveryLogStats'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,dlvExclusion" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:dlvExclusion">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='dlvExclusion'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,domain" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:domain">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='domain'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,extAccount" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:extAccount">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='extAccount'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,group" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:group">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='group'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,includeView" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:includeView">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='includeView'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,mirrorPageInfo" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:mirrorPageInfo">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='mirrorPageInfo'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,mirrorPageSearch" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:mirrorPageSearch">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='mirrorPageSearch'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,rcpGrpRel" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:rcpGrpRel">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='rcpGrpRel'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,recipient" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:recipient">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='recipient'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,visitor" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:visitor">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='visitor'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,remoteTracking" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:remoteTracking">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='remoteTracking'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,ruleSet" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:ruleSet">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='ruleSet'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,serverConf" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:serverConf">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='serverConf'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,serverOptions" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:serverOptions">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='serverOptions'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,service" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:service">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='service'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,subHisto" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:subHisto">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='subHisto'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,subscription" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:subscription">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='subscription'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,tmpBroadcast" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:tmpBroadcast">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='tmpBroadcast'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,tmpBroadcastExclusion" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:tmpBroadcastExclusion">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='tmpBroadcastExclusion'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,tmpBroadcastMessageId" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:tmpBroadcastMessageId">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='tmpBroadcastMessageId'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,tmpMarketingPressure" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:tmpMarketingPressure">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='tmpMarketingPressure'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,trackingLog" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:trackingLog">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='trackingLog'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,trackingLogRcp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:trackingLogRcp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='trackingLogRcp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,trackingLogVisitor" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:trackingLogVisitor">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='trackingLogVisitor'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,trackingStats" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:trackingStats">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='trackingStats'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,trackingUrl" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:trackingUrl">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='trackingUrl'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,trackingUrlInfo" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:trackingUrlInfo">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='trackingUrlInfo'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,userAgent" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:userAgent">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='userAgent'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,userAgentReject" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:userAgentReject">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='userAgentReject'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,userAgentStats" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:userAgentStats">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='userAgentStats'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,webApp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:webApp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webApp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,webForm" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:webForm">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webForm'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,webTrackingLog" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:webTrackingLog">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webTrackingLog'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,workflow" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:workflow">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='workflow'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,webAppLog" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:webAppLog">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webAppLog'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,webAppLogRcp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:webAppLogRcp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webAppLogRcp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,emailError" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:emailError">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='emailError'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,emailErrorStat" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:emailErrorStat">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='emailErrorStat'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,mxDomain" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:mxDomain">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='mxDomain'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,mxOwner" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:mxOwner">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='mxOwner'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,localOrgUnit" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:localOrgUnit">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='localOrgUnit'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,dlvAggregate" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:dlvAggregate">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='dlvAggregate'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,pipelineOffset" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:pipelineOffset">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='pipelineOffset'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,pipelineDiscard" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:pipelineDiscard">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='pipelineDiscard'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,offerEnv" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:offerEnv">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerEnv'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,offerCategory" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:offerCategory">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerCategory'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,offerSpace" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:offerSpace">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerSpace'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,offer" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:offer">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offer'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,proposition" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:proposition">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='proposition'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,propositionRcp" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:propositionRcp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='propositionRcp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,propositionVisitor" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:propositionVisitor">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='propositionVisitor'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,offerView" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:offerView">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerView'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,interaction" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:interaction">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='interaction'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:srcSchema,nms,rights" lineCountMax="5000" schema="xtk:srcSchema">
        <where displayFilter="nms:rights">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='rights'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,addInPackage" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:addInPackage">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='addInPackage'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,addInstance" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:addInstance">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='addInstance'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,aliasCleansing" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:aliasCleansing">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='aliasCleansing'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,changePassword" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:changePassword">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='changePassword'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,changeWorkflowLogin" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:changeWorkflowLogin">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='changeWorkflowLogin'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,conflict" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:conflict">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='conflict'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,connections" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:connections">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='connections'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,counter" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:counter">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='counter'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,createdb" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:createdb">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='createdb'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,dashboard" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:dashboard">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dashboard'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,dataTransfer" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:dataTransfer">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dataTransfer'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,dbExtension" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:dbExtension">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dbExtension'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,descriptiveAnalysis" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:descriptiveAnalysis">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='descriptiveAnalysis'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,dictionary" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:dictionary">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dictionary'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,dictionaryGlobal" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:dictionaryGlobal">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='dictionaryGlobal'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,downloadDataTransferFiles" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:downloadDataTransferFiles">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='downloadDataTransferFiles'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,enum" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:enum">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='enum'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,enumAlias" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:enumAlias">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='enumAlias'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,enumValue" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:enumValue">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='enumValue'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,export" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:export">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='export'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,exportList" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:exportList">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='exportList'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,exportSource" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:exportSource">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='exportSource'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,exprChoice" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:exprChoice">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='exprChoice'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,expreditor" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:expreditor">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='expreditor'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,fieldProp" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:fieldProp">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fieldProp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,fileRes" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:fileRes">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fileRes'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,fileResDownload" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:fileResDownload">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fileResDownload'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,fileResUpload" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:fileResUpload">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fileResUpload'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,folder" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:folder">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='folder'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,form" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:form">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='form'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,formRendering" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:formRendering">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='formRendering'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,formlib" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:formlib">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='formlib'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,fusion" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:fusion">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='fusion'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,generatePackage" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:generatePackage">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='generatePackage'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,group" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:group">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='group'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,image" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:image">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='image'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,import" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:import">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='import'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,importRetry" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:importRetry">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='importRetry'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,importSource" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:importSource">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='importSource'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,javascript" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:javascript">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='javascript'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,job" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:job">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='job'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,jssp" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:jssp">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='jssp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,jst" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:jst">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='jst'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,massUpdate" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:massUpdate">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='massUpdate'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,navtree" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:navtree">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='navtree'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,newReport" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:newReport">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='newReport'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,newWorkflow" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:newWorkflow">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='newWorkflow'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,newWorkflowAgg" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:newWorkflowAgg">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='newWorkflowAgg'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,olapAggregate" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:olapAggregate">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapAggregate'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,olapCube" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:olapCube">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapCube'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,olapDimension" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:olapDimension">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapDimension'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,olapMeasure" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:olapMeasure">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='olapMeasure'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,operator" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:operator">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='operator'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,option" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:option">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='option'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,package" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:package">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='package'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,packageExport" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:packageExport">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='packageExport'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,packageImport" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:packageImport">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='packageImport'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,packageInstall" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:packageInstall">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='packageInstall'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,queryDef" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:queryDef">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='queryDef'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,queryFilter" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:queryFilter">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='queryFilter'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,rejectExport" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:rejectExport">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='rejectExport'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,report" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:report">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='report'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,reportDictionaryCheck" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:reportDictionaryCheck">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='reportDictionaryCheck'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,reportHistory" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:reportHistory">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='reportHistory'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,reportProperties" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:reportProperties">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='reportProperties'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,reportPublishing" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:reportPublishing">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='reportPublishing'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,reportSourceCode" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:reportSourceCode">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='reportSourceCode'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,requester" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:requester">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='requester'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,right" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:right">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='right'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,schema" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:schema">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='schema'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,schemaExtension" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:schemaExtension">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='schemaExtension'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,schemaView" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:schemaView">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='schemaView'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,specFile" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:specFile">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='specFile'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,sql" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:sql">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='sql'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,srcSchema" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:srcSchema">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='srcSchema'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,srcSchemaDiscovery" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:srcSchemaDiscovery">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='srcSchemaDiscovery'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,srcSchemaWizard" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:srcSchemaWizard">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='srcSchemaWizard'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,strings" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:strings">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='strings'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,switchValuesAndAliases" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:switchValuesAndAliases">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='switchValuesAndAliases'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,taskWizard" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:taskWizard">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='taskWizard'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,updatedb" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:updatedb">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='updatedb'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,valueStats" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:valueStats">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='valueStats'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,whereFilter" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:whereFilter">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='whereFilter'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,wkfAggregate" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:wkfAggregate">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='wkfAggregate'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,workflow" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:workflow">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflow'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,workflowEvent" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:workflowEvent">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowEvent'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,workflowJob" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:workflowJob">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowJob'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,workflowTask" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:workflowTask">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='workflowTask'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,xtk,xslt" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="xtk:xslt">
          <condition expr="@namespace='xtk'" internalId="1"/>
          <condition expr="@name='xslt'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nl,monitoring" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nl:monitoring">
          <condition expr="@namespace='nl'" internalId="1"/>
          <condition expr="@name='monitoring'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nl,navtree" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nl:navtree">
          <condition expr="@namespace='nl'" internalId="1"/>
          <condition expr="@name='navtree'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nl,serverOptions" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nl:serverOptions">
          <condition expr="@namespace='nl'" internalId="1"/>
          <condition expr="@name='serverOptions'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,address" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:address">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='address'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,calendar" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:calendar">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='calendar'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,typology" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:typology">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='typology'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,typologyRule" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:typologyRule">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='typologyRule'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,clearGroup" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:clearGroup">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='clearGroup'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,clearRcpFolder" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:clearRcpFolder">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='clearRcpFolder'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,delivery" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:delivery">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='delivery'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,deliveryDet" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:deliveryDet">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='deliveryDet'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,newDelivery" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:newDelivery">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='newDelivery'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,seedMember" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:seedMember">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='seedMember'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,importList" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:importList">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='importList'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,localOrgUnit" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:localOrgUnit">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='localOrgUnit'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,deliveryMapping" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:deliveryMapping">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='deliveryMapping'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,newDlvMapping" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:newDlvMapping">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='newDlvMapping'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,dlvAnalysis" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:dlvAnalysis">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='dlvAnalysis'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,updDlvMapping" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:updDlvMapping">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='updDlvMapping'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,attachment" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:attachment">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='attachment'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,domain" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:domain">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='domain'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,downloadDeliveryFiles" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:downloadDeliveryFiles">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='downloadDeliveryFiles'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,extAccount" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:extAccount">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='extAccount'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,group" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:group">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='group'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,includeView" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:includeView">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='includeView'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,visitor" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:visitor">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='visitor'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,recipient" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:recipient">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='recipient'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,recipientGroup" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:recipientGroup">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='recipientGroup'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,recipientService" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:recipientService">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='recipientService'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,recomputeStats" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:recomputeStats">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='recomputeStats'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,registerSummary" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:registerSummary">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='registerSummary'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,report" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:report">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='report'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,ruleSet" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:ruleSet">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='ruleSet'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,service" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:service">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='service'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,subscription" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:subscription">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='subscription'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,trackingUrl" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:trackingUrl">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='trackingUrl'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webApp" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webApp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webApp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,newWebApp" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:newWebApp">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='newWebApp'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webAppDictionaryCheck" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webAppDictionaryCheck">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webAppDictionaryCheck'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webAppDictionaryImport" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webAppDictionaryImport">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webAppDictionaryImport'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webAppDictionaryExport" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webAppDictionaryExport">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webAppDictionaryExport'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webAppSourceCode" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webAppSourceCode">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webAppSourceCode'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webForm" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webForm">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webForm'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webAppLog" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webAppLog">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webAppLog'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,webTrackingUrl" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:webTrackingUrl">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='webTrackingUrl'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,broadLogMsg" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:broadLogMsg">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='broadLogMsg'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,extraction" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:extraction">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='extraction'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,offerEnv" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:offerEnv">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerEnv'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,offerCategory" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:offerCategory">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerCategory'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,offerSpace" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:offerSpace">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerSpace'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,offer" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:offer">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offer'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,offerSpaceDeployment" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:offerSpaceDeployment">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerSpaceDeployment'" internalId="2"/>
        </where>
      </definition>
      <definition automaticDefinition="false" id="xtk:form,nms,offerDeployment" lineCountMax="5000" schema="xtk:form">
        <where displayFilter="nms:offerDeployment">
          <condition expr="@namespace='nms'" internalId="1"/>
          <condition expr="@name='offerDeployment'" internalId="2"/>
        </where>
      </definition>
    </specFile>
  </entities>
</package>